
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>蓝队手册 - klsfct Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../js/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="deep-orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#0" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="klsfct Docs" class="md-header__button md-logo" aria-label="klsfct Docs" data-md-component="logo">
      
  <img src="../../images/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            klsfct Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              蓝队手册
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      主页
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E7%9B%AE%E5%BD%95/" class="md-tabs__link">
        安全wiki
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../实战相关/目录.md" class="md-tabs__link">
        实战相关
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/" class="md-tabs__link">
        红队
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/" class="md-tabs__link">
        蓝队
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/" class="md-tabs__link">
        挖洞相关
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/aboutme/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="klsfct Docs" class="md-nav__button md-logo" aria-label="klsfct Docs" data-md-component="logo">
      
  <img src="../../images/logo.jpg" alt="logo">

    </a>
    klsfct Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        主页
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          安全wiki
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="安全wiki" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          安全wiki
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E7%9B%AE%E5%BD%95/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        安全基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/" class="md-nav__link">
        web安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/" class="md-nav__link">
        数据安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/CMS%E5%AE%89%E5%85%A8/" class="md-nav__link">
        cms安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" class="md-nav__link">
        流量分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/" class="md-nav__link">
        服务器、中间件安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="md-nav__link">
        应急响应
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        渗透测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/" class="md-nav__link">
        安全测试项目梳理
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          实战相关
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="实战相关" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          实战相关
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../实战相关/目录.md" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        漏洞测试
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/" class="md-nav__link">
        内部渗透比赛
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          红队
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="红队" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          红队
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" class="md-nav__link">
        信息收集
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/" class="md-nav__link">
        漏洞库
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/" class="md-nav__link">
        溯源分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E9%92%93%E9%B1%BC/" class="md-nav__link">
        钓鱼
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/" class="md-nav__link">
        代理转发与隧道
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/提取系列.md" class="md-nav__link">
        提权系列
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/域渗透测试一条龙.md" class="md-nav__link">
        域渗透
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          蓝队
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="蓝队" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          蓝队
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="md-nav__link">
        应急响应
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" class="md-nav__link">
        日志分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../window实战.md" class="md-nav__link">
        window实战
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/linux实战.md" class="md-nav__link">
        linux实战
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/web实战.md" class="md-nav__link">
        web实战
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" data-md-state="indeterminate" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          挖洞相关
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="挖洞相关" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          挖洞相关
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/" class="md-nav__link">
        众测项目
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/" class="md-nav__link">
        思路方法
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/aboutme/" class="md-nav__link">
        about me
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0" class="md-nav__link">
    0. ) 准备工作
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. ) 简单安全评估
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. ) 安全加固
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-visibility" class="md-nav__link">
    3. ) 检测（Visibility）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. ) 响应（取证）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-tips-tricks" class="md-nav__link">
    5. ) 常用技巧（TIPS &amp; TRICKS）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    文档维护
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>蓝队手册</h1>

<h2 id="0">0. ) 准备工作<a class="headerlink" href="#0" title="Permanent link">&para;</a></h2>
<p>1 ) 组织结构图 
2 ) 全网拓扑图 
3 ) 各系统逻辑结构图 
4 ) 各系统之间的调用关系 
5 ) 数据流关系 
6 ) 核心资产清单 
7 ) 应急响应计划 
8 ) 业务连续性计划 
9 ) 灾难恢复计划</p>
<h2 id="1">1. ) 简单安全评估<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p><strong>1.1 ) 端口扫描和漏洞检测</strong></p>
<blockquote>
<p><strong>主机发现（Ping探测）：</strong> 
# nmap -sn -PE IP地址或地址段</p>
<p><strong>端口扫描：</strong> 
# nmap –open IP地址或地址段</p>
<p><strong>服务版本检测：</strong> 
# nmap -sV IP地址或地址段</p>
<p><strong>扫描多个端口：</strong> 
# nmap -p 80,443 IP地址或地址段</p>
<p><strong>UDP端口扫描：</strong> 
# nmap -sU -p 53 IP地址或地址段</p>
<p><strong>TCP/UDP端口扫描（-Pn 跳过主机发现）：</strong> 
# nmap -v -Pn -SU -ST -p U:53,111,137,T:21- 
25,80,139,8080 IP地址或地址段</p>
<p><strong>Nessus漏洞检测：</strong> 
# nessus -q -x -T html 服务器IP 服务器端口 管理员帐号 密码 目标.txt 输出报告.html</p>
<p><strong>OPENVAS漏洞检测：</strong> 
# apt -y install pcregrep 
# wget <a href="https://goo.gl/TYbLwE">https://goo.gl/TYbLwE</a> 
# chmod +x openvas-automate.sh &amp;&amp; ./openvas-automate.sh 目标IP</p>
</blockquote>
<p><strong>1.2 ) WINDOWS系统篇</strong></p>
<p>1.2.1 网络发现</p>
<blockquote>
<p><strong>基本网络发现</strong> 
# C:&gt; net view /all 
# C:&gt; net view \主机名</p>
<p><strong>Ping探测</strong> 
# C:&gt; for /L %I in (1,1,254) do ping -w 30 -n 1 192.168.1.%I | find “回复” &gt;&gt; 输出.txt</p>
</blockquote>
<p>1.2.2 DHCP</p>
<blockquote>
<p><strong>启用DHCP服务器日志功能：</strong> 
# C:&gt; reg add HKLM\System\CurrentControlSet\Services\DhcpServer\Parameters /v ActivityLogFlag /t REG_DWORD /d 1 
默认日志文件路径： 
C:&gt; %windir%\System32\Dhcp</p>
</blockquote>
<p>1.2.3 DNS</p>
<blockquote>
<p><strong>启用DNS服务器日志功能：</strong> 
# C:&gt; DNSCmd DNS服务器名 /config /logLevel 0x8100F331 
# 配置日志文件路径: 
C:&gt; DNSCmd DNS服务器名 /config /LogFilePath C:\dns.log 
# 配置日志文件大小: 
C:&gt; DNSCmd DNS服务器名 /config /logfilemaxsize 0xffffffff</p>
</blockquote>
<p>1.2.4 哈希值</p>
<blockquote>
<p><strong>文件校验和完整性验证（FCIV）：</strong> 
Ref：<a href="http://support2.microsoft.com/kb/841290">http://support2.microsoft.com/kb/841290</a> 
# 计算单个文件hash值: 
C:&gt; fciv.exe 文件名 
# 计算C盘所有文件的哈市值并把结果保存到文件中: 
C:&gt; fciv.exe c: -r -sha1 -xml 结果.xml 
# 列出所有hash值: 
C:&gt; fciv.exe -list -sha1 -xml 结果.xml 
# <strong>certutil &amp; PowerShell方法</strong> 
# certutil -hashfile 文件名 SHA1 
# PS C:&gt; Get-FileHash 文件名 | Format-List 
# PS C:&gt; Get-FileHash -algorithm md5 文件名</p>
</blockquote>
<p>1.2.5 NETBIOS</p>
<blockquote>
<p><strong>nbtstat 扫描</strong> 
# C:&gt; nbtstat -A 目标IP地址 
<strong>NetBIOS缓存</strong> 
# C:&gt; nbtstat -c 
<strong>批量扫描</strong> 
# C:&gt; for /L %I in (1,1,254) do nbtstat -An 192.168.1.%I</p>
</blockquote>
<p>1.2.6 微软基线安全分析器(MBSA)</p>
<blockquote>
<p><strong>扫描单个IP</strong> 
# C:&gt; mbsacli.exe /target IP地址 /n os+iis+sql+password 
<strong>扫描IP地址段</strong> 
# C:&gt; mbsacli.exe /r IP地址段 /n os+iis+sql+password</p>
</blockquote>
<p><strong>1.3 ) LINUX系统篇</strong></p>
<p>1.3.1 网络发现</p>
<blockquote>
<p><strong>查看开放的SMB共享</strong> 
# smbclient -L 目标主机名</p>
<p><strong>Ping探测</strong> 
<code>\# for ip in $(seq 1 254); do ping -c1 -w2 192.168.1.$ip&gt;/dev/null; [ $? -eq 0 ] &amp;&amp; echo "192.168.1.$ip UP" || : ; done</code></p>
</blockquote>
<p>1.3.2 DHCP</p>
<blockquote>
<p><strong>DHCP日志查询</strong> 
RHEL/CentOS 
# cat /var/lib/dhcpd/dhcpd. leases 
Debian/Ubuntu 
# grep -Ei ‘dhcp’ /var/log/syslog.1</p>
</blockquote>
<p>1.3.3 DNS</p>
<blockquote>
<p><strong>DNS日志查询</strong> 
# rndc querylog &amp;&amp; tail -f /var/log/messages | grep named</p>
</blockquote>
<p>1.3.4 哈希值</p>
<blockquote>
<p><strong>计算/sbin目录下所有可执行文件的HASH值</strong> 
# find /sbin -type f -exec md5sum {} &gt;&gt; md5sums.txt \; 
# md5deep -rs /sbin &gt; md5sums.txt</p>
</blockquote>
<p>1.3.5 NETBIOS</p>
<blockquote>
<p><strong>nbtstat 扫描</strong> 
# nbtscan 目标IP地址或IP地址段 
举例：nbtscan 192.168.1.2-100</p>
</blockquote>
<h2 id="2">2. ) 安全加固<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p><strong>2.1 ) WINDOWS系统篇</strong></p>
<blockquote>
<p><strong>2.1.1 禁用/停止服务</strong> 
# C:&gt; sc query 
# C:&gt; sc config “服务名” start= disabled 
# C:&gt; sc stop “服务名” 
# C:&gt; wmic service where name=”服务名” call ChangeStartmode Disabled</p>
<p><strong>2.1.2 防火墙管理</strong> 
# 列出所有规则: 
# C:&gt; netsh advfirewall firewall show rule name=all 
# 启用或禁用防火墙: 
C:&gt; netsh advfirewall set currentprofile state on 
C:&gt; netsh advfirewall set currentprofile firewallpolicy blockinboundalways,allowoutbound 
C:&gt; netsh advfirewall set publicprofile state on 
C:&gt; netsh advfirewall set privateprofile state on 
C:&gt; netsh advfirewall set domainprofile state on 
C:&gt; netsh advfirewall set allprofile state on 
C:&gt; netsh advfirewall set allprof ile state off 
# 配置举例： 
<code>netsh advfirewall firewall add rule name="开放TCP:80端口" dir=in action=allow protocol=TCP localport=80 netsh advfirewall firewall add rule name="开放TCP:443端口" dir=in action=allow protocol=TCP localport=443 netsh advfirewall firewall add rule name="屏蔽TCP:445端口" dir=in action=block protocol=TCP localport=445 netsh advfirewall firewall add rule name="允许MyApp" dir=in action=allow program="C:\MyApp\MyApp.exe" enable=yes</code></p>
<p><strong>2.1.3 清除DNS缓存和Netios缓存</strong> 
# C:&gt; ipconfig /flushdns 
# C:&gt; nbtstat -R</p>
<p><strong>2.1.4 应用控制</strong> 
# AppLocker配置 
<code>\# 导入Applocker模块 PS C:\&gt; import-module Applocker \# 查看system32目录下所有exe文件的Applocker信息 PS C:\&gt; Get-ApplockerFileinformation -Directory C:\Windows\System32\ -Recurse -FileType Exe \# 增加一条针对system32目录下所有的exe文件的允许规则 PS C:\&gt; Get-Childitem C:\Windows\System32\*,exe | Get-ApplockerFileinformation | New-ApplockerPolicy -RuleType Publisher, Hash -User Everyone -RuleNamePrefix System32</code></p>
<p><strong>2.1.5 IPSEC</strong> 
# 1.）使用预共享密钥的方式新建一条IPSEC本地安全策略，应用到所有连接和协议 
<code>C:\&gt; netsh ipsec static add filter filterlist=MyIPsecFilter srcaddr=Any dstaddr=Any protocol=ANY C:\&gt; netsh ipsec static add filteraction name=MyIPsecAction action=negotiate C:\&gt; netsh ipsec static add policy name=MyIPsecPolicy assign=yes C:\&gt; netsh ipsec static add rule name=MyIPsecRule policy=MyIPsecPolicy filterlist=MyIPsecFilter filteraction=MyIPsecAction conntype=all activate=yes psk=密码</code>
# 2.）新建一条允许访问外网TCP 80和443端口的IPSEC策略 
<code>C:\&gt; netsh ipsec static add filteraction name=Allow action=permit C:\&gt; netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=80 C:\&gt; netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=443 C:\&gt; netsh ipsec static add rule name=WebAllow policy=MyIPsecPolicy filterlist=WebFilter filteraction=Allow conntype=all activate=yes psk=密码</code>
# 3.）查看和禁用某条IPSEC本地安全策略 
<code>C:\&gt; netsh ipsec static show policy name=MyIPsecPolicy C:\&gt; netsh ipsec static set policy name=MyIPsecPolicy assign=no</code>
# 新建一条IPSEC对应的防火墙规则，源地址和目的地址为any 
<code>C:\&gt; netsh advfirewall consec add rule name="IPSEC" endpointl=any endpoint2=any action=requireinrequireout qmsecmethods=default</code>
# 新建一条IPSEC对应的防火墙规则，所有出站请求必须提供预共享密钥 
<code>C:\&gt; netsh advfirewall firewall add rule name="IPSEC_Out" dir=out action=allow enable=yes profile=any localip=any remoteip=any protocol=any interfacetype=any security=authenticate</code></p>
<p><strong>2.1.6 其他安全策略</strong> 
# 禁用远程桌面连接 
<code>C:\&gt; reg add "HKLM\SYSTEM\CurrentControlSet\Control\TerminalServer" /f /v fDenyTSConnections /t REG_DWORD /d 1</code>
# 只发送NTLMv2响应（防止“永恒之蓝”漏洞攻击） 
<code>C:\&gt; reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ /v lmcompatibilitylevel /t REG_DWORD /d 5 /f</code>
# 禁用IPV6 
<code>C:\&gt; reg add HKLM\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters /v DisabledComponents /t REG_DWORD /d 255 /f</code>
# 禁用sticky键 
<code>C:\&gt; reg add "HKCU\ControlPanel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d 506 /f</code>
# 禁用管理共享（Servers/Workstations） 
<code>C:\&gt; reg add HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters /f /v AutoShareServer /t REG_DWORD /d 0 C:\&gt; reg add HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters /f /v AutoShareWks /t REG_DWORD /d 0</code>
# 禁用注册表编辑器和CMD命令提示符 
<code>C:\&gt; reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System /v DisableRegistryTools /t REG_DWORD /d 1 /f C:\&gt; reg add HKCU\Software\Policies\Microsoft\Windows\System /v DisableCMD /t REG_DWORD /d 1 /f</code>
# 启用UAC 
<code>C:\&gt; reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 1 /f</code>
# 启用防火墙日志功能 
<code>C:\&gt; netsh firewall set logging droppedpackets = enable C:\&gt; netsh firewall set logging connections = enable</code></p>
</blockquote>
<p><strong>2.2 ) LINUX系统篇</strong></p>
<blockquote>
<p><strong>2.2.1 服务管理</strong> 
# 查看服务状态 
<code>service --status-all ps -ef OR ps -aux initctl list systemctl list-unit-files</code>
# 启动，停止和禁用服务 
<code>\# For Upstart services: /etc/init.d/apache2 start | stop | status service apache2 start | stop | status update-rc.d apache2 disable \# For Systemd services: systemctl start | stop | status ntp.service systemctl disable sshd.service</code>
<strong>2.2.2 防火墙管理</strong> 
# iptables 常用操作： 
<code>iptables-save &gt; filewall_rules.bak \# 导出当前规则 iptables -vnL --line \# 列出所有规则 iptables -S \# 同上 iptables -P INPUT DROP \# 默认策略，禁止所有连接 iptables -A INPUT -s 10.10.10.10 -j DROP \# 禁止单个IP iptables -A INPUT -s 10,10.10.0/24 -j DROP \# 禁止一个网段 iptables -A INPUT -p tcp --dport ssh -s 10.10.10.10 -j DROP \# 禁止某IP访问本机SSH服务 iptables -A INPUT -p tcp --dport ssh -j DROP \# 禁止访问本机SSH服务 iptables -I INPUT 5 -m limit --limit 5/min -j LOG --log-prefix "iptables denied: " --log-level 7 \# 启用日志记录 iptables -F \# 清除当前已加载的规则</code>
<strong>2.2.3 DNS缓存</strong> 
# Unix/Linux系统没有系统级别DNS缓存</p>
<p><strong>2.2.4 配置IPSEC</strong> 
# 在两台服务器之间建立IPSEC通道 
<code>\# 1.）添加防火墙规则允许IPSEC协议 iptables -A INPUT -p esp -j ACCEPT iptables -A INPUT -p ah -j ACCEPT iptables -A INPUT -p udp --dport 500 -j ACCEPT iptables -A INPUT -p udp --dport 4500 -j ACCEPT \# 安装Racoon apt -y install racoon \# 2.）编辑配置文件：/etc/ipsec-tools.conf flush; spdflush; spdadd 主机A的IP地址 主机B的IP地址 any -P out ipsec esp/transport//require; spdadd 主机B的IP地址 主机A的IP地址 any -P in ipsec esp/transport//require; \# 3.）编辑配置文件：/etc/racoon/racoon.conf log notify; path pre_shared_key "/etc/racoon/psk.txt"; path certificate "/etc/racoon/certs"; remote anonymous { exchange_mode main,aggressive; proposal { encryption_algorithm aes_256; hash_algorithm sha256; authentication_method pre_shared_key; dh_group modp1024; } generate_policy off; } sainfo anonymous{ pfs_group 2; encryption_algorithm aes_256; authentication_algorithm hmac_sha256; compression_algorithm deflate; } \# 4.）添加预共享密钥 主机A：echo 主机B 123 &gt;&gt; /etc/racoon/psk.txt 主机B：echo 主机A 123 &gt;&gt; /etc/racoon/psk.txt \# 5.）重启服务，检查协商及配置策略 service setkey restart setkey -D setkey -DP</code></p>
</blockquote>
<h2 id="3-visibility">3. ) 检测（Visibility）<a class="headerlink" href="#3-visibility" title="Permanent link">&para;</a></h2>
<p><strong>3.1 ) 网络安全监控</strong></p>
<blockquote>
<p><strong>3.1.1 数据包捕捉与分析</strong> 
<code>1.）TCPDUMP tcpdump -tttt -n -vv \# 打印时戳，禁用名称解析并以verbose方式显示 tcpdump -nn -c 1000 | awk '{print $3}' | cut -d. -f1-4 | sort -n | uniq -c | sort -nr \# 捕捉1000个数据包，找出Top talkers tcpdump -w target.pcap -i any dst targetIP and port 80 \# 在所有接口上捕捉目标IP为：targetIP且端口为80的数据包并写入target.pcap文件 tcpdump host 10.0.0.1 &amp;&amp; host 10.0.0.2 \# 捕捉两个主机之间的数据包 tcpdump not net 10.10 &amp;&amp; not host 192.168.1.2 \#捕捉非10.10网段及非192.168.1.2主机的数据包tcpdump host 10.10.10.10 &amp;&amp; \(10.10.10.20 or 10.10.10.30\) \# 捕捉主机A与主机B或C的数据包tcpdump -n -s0 -C 100 -w 001.pcap \# 轮询，文件大小超过100M后自动创建新文件 tcpdump -w - | ssh ServerIP -p 50005 "cat - &gt; /tmp/remotecapture.pcap" \# 通过SSH保存数据包到远程服务器上的/tmp/remotecapture.pcap文件 tcpdump -n -A -s0 port http or port ftp or port smtp or port imap or port pop3 | egrep -i 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|P asswd=|password=|pass:|user:|username:|password:|login:|pass|user' --color=auto --line-buffered -B20 \# 抓取明文密码 tcpdump -s 1500 -A '(tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2)+5:1] = 0x01) and (tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):1] = 0x16)' \#查找自签名证书 2.）TSHARK tshark -nr 001.pcap -Y "ssl.handshake.ciphersuites" -Vx | grep "ServerName:" | sort | uniq -c | sort -r \# 提取证书Server Name字段 tshark -D \# 列出所有可用接口 tshark -i eth0 -i eth1 \# 监听多个接口 tshark -nn -w 001.pcap \# 禁用名称解析并保存到文件 tshark arp or icmp \# 捕捉arp或者icmp tshark "host 主机A &amp;&amp; host 主机B" \# 捕捉两个主机之间的数据包 tshark -r 001.pcap \# 读取数据包 tshark -n -e ip.src -e ip.dst -T fields -E separator=, -2 -R ip -r 001.pcap \# 提取源/目的IP地址 tshark -n -e ip.src -e dns,qry.name -E separator=';' -T fields port 53 \# 提取DNS查询的源IP及DNS查询的域名 tshark -2 -R http.request -T fields -E separator=';' -e http.host -e http.request.uri -r 001.pcap \# 提取HTTP请求中的host参数和请求uri tshark -n -c 150 I awk '{print $4}' I sort -n | uniq -c | sort -nr \# 提取top talkers tshark -q -z io,phs -r 001.pcap \# 协议统计 tshark -n -c 100 -e ip.src -Y "dns.flags.response eq 1" -T fields port 53 \# 提取DNS响应数据包的DNS服务器地址 tshark -n -e http.request.uri -Y http.request -T fields | grep exe \# 提取通过http请求方式下载exe可执行文件的数据包 3.）SNORT snort -T -c /etc/snort/snort.conf \# 配置文件测试 snort -dv -r 001.log \# 读取数据包 snort -dvr 001.log icmp \# 提取icmp数据包 snort -K ascii -l 001 \# 以ASCII格式显示 snort -q -A console -i eth0 -c /etc/snort/snort.conf \# 在终端上显示snort events echo 'log tcp 192.168.1.0/24 any -&gt; 192.168.1.95 22 ( msg: "ssh access" ; sid:1618008; )' &gt; 001.rule &amp;&amp; snort -T -c 001.rule \# 规则测试 mkdir logs &amp;&amp; snort -vd -c 001.rule -r 001.pcap -A console -l logs \# 执行规则 4.）Bro NSM 安装及下载相关软件包和数据包 apt -y install bro bro-aux pip install bro-pkg bro-pkg install bro/hosom/file-extraction wget https://www.malware-traffic-analysis.net/2018/01/12/2018-01-12-NanoCore-RAT-traffic.pcap.zip wget https://www.bro.org/static/exchange-2013/faf-exercise.pcap bro -r 2018-01-12-NanoCore-RAT-traffic.pcap \# 从pcap文件中读取并创建相关日志文件 bro -r faf-exercise.pcap /root/.bro-pkg/scratch/file-extraction/scripts/plugins/extract-pe.bro &amp;&amp; ls -lhct ./extract_files/ \# 提取出exe文件bro -r faf-exercise.pcap /usr/share/bro/policy/frameworks/files/extract-all-files.bro \# 提取多个类型的文件 bro -C -r faf-exercise.pcap &amp;&amp; cat ssl.log | bro-cut server_name , subject , issuer \# 提取证书中的server_name,issuer和subjects字段 cat conn.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , proto , conn_state \# 提取源IP，源端口，目的IP，目的端口，协议类型，tcp标记 cat dns.log | bro-cut query | sort -u \# 提取DNS查询name cat http.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , host , uri , referrer \# 提取源IP，源端口，目的IP，目的端口，host，uri，referrer字段 cat http.log | bro-cut user_agent | sort -u \# 提取user_agent字段 5.）EDITCAP editcap -F pcap -c 1000 orignal.pcap out_split.pcap \# 以1000为单位进行分割 editcap -F pcap -t+3600 orignal.pcap out_split.pcap \# 以1小时为单位进行分割 6.）MERGECAP mergecap -w merged_cap.pcap capl.pcap cap2.pcap cap3.pcap \# 合并多个文件 7.）PacketTotal https://www.packettotal.com/app/analysis?id=c8c11b792272ac19a49299a3687466be&amp;name=files 8.）NetworkMiner http://netres.ec/?b=173588E</code>
<strong>3.2 ) 蜜罐技术</strong> 
<strong>3.2.1 WINDOWS系统篇</strong> 
<code>1.） 端口蜜罐 \# 原理：监听端口，当客户端成功建立TCP（3次握手）连接后，记录访问日志，然后添加防火墙规则封禁此IP PS C:\&gt; certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Pwdrkeg/honeyport/master/honeyport.ps1 PS C:\&gt; .\honeyport.ps1 -Ports 4444,22,21,23 -WhiteList 192.168.10.1,192.168.10.2 -Block $true -Verbose PS C:\&gt; Get-EventLog HoneyPort \# 查看日志记录信息 PS C:\&gt; stop-job -name HoneyPort \# 停止任务 PS C:\&gt; remove-job -name HoneyPort \# 移除任务</code></p>
<p><strong>3.2.2 LINUX系统篇</strong> 
<code>1.） 端口蜜罐 \# 原理同上 wget https://raw.githubusercontent.com/gchetrick/honeyports/master/honeyports-0.5.py python honeyports-0.5.py -p 1234 -h 192.168.1.100 -D</code>
<strong>3.3 ) (PASSIVE)监控DNS解析</strong> 
<code>apt -y install dnstop dnstop -l 3 eth0 dnstop -l 3 001.pcap | out.txt</code>
<strong>3.4 ) 日志审计</strong> 
<code>1.）WINDOWS \# 增加日志文件大小进行日志审计 C:\&gt; reg add HKLM\Software\Policies\Microsoft\Windows\Eventlog\Application /v MaxSize /t REG_DWORD /d 0x19000 C:\&gt; reg add HKLM\Software\Policies\Microsoft\Windows\Eventlog\Security /v MaxSize /t REG_DWORD /d 0x64000 C:\&gt; reg add HKLM\Software\Policies\Microsoft\Windows\EventLog\System /v MaxSize /t REG_DWORD /d 0x19000 \# 查看Windows事件日志-安全日志的配置 C:\&gt; wevtutil gl Security \# 检查审核策略 auditpol /get /category:* \# 对所有项启用成功和失败的审核策略 C:\&gt; auditpol /set /category:* /success:enable /failure:enable \# 查看已配置的事件日志的概要信息 PS C:\&gt; Get-Eventlog -list \# 取最近5条应用程序日志 PS C:\&gt; Get-Eventlog -newest 5 -logname application | Format-List \# 取Eent ID：4672的所有日志 PS C:\&gt; Get-Eventlog Security | ? { $_.Eventid -eq 4672} \# 登录与注销事件 PS C:\&gt; Get-Eventlog Security 4625,4634,4647,4624,4625,4648,4675,6272,6273,6274,6275,6276,6277,6278,6279,6280,4649,4778,4779,4800,4801,4802,4803,5378,5632,5633,4964 -after ((get-date).addDays(-1)) \# DPAPI行为，进程终止，RPC事件 PS C:\&gt; Get-EventLog Security 4692,4693,4694,4695,4689,5712 -after ((get-date).addDays(-1)) \# 文件共享，文件系统，SAM，注册表，证书时间 PS C:\ Get-EventLog Security 4671,4691,4698,4699,4700,4701,4702,5148,5149,5888,5889,5890,4657,5039,4659,4660,4661,4663,4656,4658,4690,4874,4875,4880,4881,4882,4884,4885,4888,4890,4891,4892,4895,4896,4898,5145,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,4664,4985,5152,5153,5031,5140,5150,5151,5154,5155,5156,5157,5158,5159 -after ((get-date).addDays(-1)) \# 查看Eent ID：4672的详细信息 Get-Eventlog Security | ? { $_.Eventid -eq 4672} | Format-List 2.）LINUX \# 认证日志 tail /var/log/auth. log grep -i "fail" /var/log/auth. log tail /var/log/secure grep -i "fail" /var/log/secure \# samba，cron,sudo相关日志 grep -i samba /var/log/syslog grep -i samba /var/log/messages grep -i cron /var/log/syslog grep -i sudo /var/log/auth. log grep -i sudo /var/log/secure \# Apache 404错误日志 grep 404 apache.log | grep -v -E "favicon.ico|robots.txt" \# 监控新文件，5分钟刷新一次 watch -n 300 -d ls -lR /web_root</code></p>
</blockquote>
<h2 id="4">4. ) 响应（取证）<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p><strong>4.1 ) LIVE TRIAGE（收集运行时系统信息）</strong></p>
<blockquote>
<p><strong>4.1.1 WINDOWS系统篇</strong> 
<code>1.）系统信息 C:\&gt; echo %DATE% %TIME% C:\&gt; hostname C:\&gt; systeminfo C:\&gt; systeminfo | findstr /B /C:"OS Name" /C:"OS Version" C:\&gt; wmic csproduct get name C:\&gt; wmic bios get serialnumber C:\&gt; wmic computersystem list brief C:\&gt; psinfo -accepteula -s -h -d 2.）用户信息 C:\&gt; whoami C:\&gt; net users C:\&gt; net localgroup administrators C:\&gt; net group administrators C:\&gt; wmic rdtoggle list C:\&gt; wmic useraccount list C:\&gt; wmic group list C:\&gt; wmic netlogin get name,lastlogon,badpasswordcount C:\&gt; wmic netclient list brief C:\&gt; doskey /history &gt; history.txt 3.）网络信息 C:\&gt; netstat -e C:\&gt; netstat -naob C:\&gt; netstat -nr C:\&gt; netstat -vb C:\&gt; nbtstat -s C:\&gt; route print C:\&gt; arp -a C:\&gt; ipconfig /displaydns C:\&gt; netsh winhttp show proxy C:\&gt; ipconfig /allcompartments /all C:\&gt; netsh wlan show interfaces C:\&gt; netsh wlan show all C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\WinHttpSettings" C:\&gt; type %SYSTEMROOT%\system32\drivers\etc\hosts C:\&gt; wmic nicconfig get descriptions,IPaddress,MACaddress C:\&gt; wmic netuse get name,username,connectiontype, localname 4.）服务信息 C:\&gt; at C:\&gt; tasklist C:\&gt; tasklist /svc C:\&gt; tasklist /SVC /fi "imagename eq svchost.exe" C:\&gt; tasklist /SVC /fi "imagename eq svchost.exe" C:\&gt; schtasks C:\&gt; net start C:\&gt; sc query C:\&gt; wmic service list brief | findstr "Running" C:\&gt; wmic service list conf ig C:\&gt; wmic process list brief C:\&gt; wmic process list status C:\&gt; wmic process list memory C:\&gt; wmic job list brief PS C:\&gt; Get-Service | Where-Object { $_.Status -eq "running" } 5.）策略、补丁、环境变量信息 C:\&gt; set C:\&gt; gpresult /r C:\&gt; gpresult /z &gt; output.txt C:\&gt; gpresult /H report.html /F C:\&gt; wmic qfe 6.）自启动信息 C:\&gt; wmic startup list full C:\&gt; wmic ntdomain list brief 6.1）检查自启动文件目录 C:\&gt; dir "%SystemDrive%\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup" C:\&gt; dir "%SystemDrive%\Documents and Settings\All Users\Start Menu\Programs\Startup"C:\&gt; dir %userprofile%\Start Menu\Programs\Startup C:\&gt; %ProgramFiles%\Startup\ C:\&gt; dir C:\Windows\Start Menu\Programs\startup C:\&gt; dir "C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup" C:\&gt; dir "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup" C:\&gt; dir "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup" C:\&gt; dir "%ALLUSERSPROFILE%\Microsoft\Windows\Start Menu\Programs\Startup" C:\&gt; dir "%ALLUSERSPROFILE%\Start Menu\Programs\Startup" C:\&gt; type C:\Windows\winstart.bat C:\&gt; type %windir%\wininit.ini C:\&gt; type %windir%\win.ini C:\&gt; type C:\Autoexec.bat" 6.2）使用autoruns C:\&gt; autorunsc -accepteula -m 6.3）自启动注册表位置 HKEY_CLASSES_ROOT: C:\&gt; reg query HKCR\Comfile\Shell\Open\Command C:\&gt; reg query HKCR\Batfile\Shell\Open\Command C:\&gt; reg query HKCR\htafile\Shell\Open\Command C:\&gt; reg query HKCR\Exefile\Shell\Open\Command C:\&gt; reg query HKCR\Exefiles\Shell\Open\Command C:\&gt; reg query HKCR\piffile\shell\open\command HKEY_CURRENT_USERS: C:\&gt; reg query "HKCU\Control Panel\Desktop" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Runonce" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnceEx" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\RunServices" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Windows\Run" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Windows\Load" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Windows\Scripts" C:\&gt; reg query "HKCU\Software\Microsoft\WindowsNT\CurrentVersion\Windows" /f run C:\&gt; reg query "HKCU\Software\Microsoft\WindowsNT\CurrentVersion\Windows" /f load C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedMRU" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComD1g32\OpenSaveMRU" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU"C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComD1g32\OpenSavePidlMRU" /sC:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" C:\&gt; reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\RegEdit" /v LastKey C:\&gt; reg query "HKCU\Software\Microsoft\InternetExplorer\" TypedURLs C:\&gt; reg query "HKCU\Software\Policies\Microsoft\Windows\ControlPanel\Desktop" HKEY_LOCAL_MACHINE: C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components" /s C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\User Shell Folders" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\Shell Folders" C:\&gt; reg query "HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects" /s C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServicesOnce" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Winlogon\Userinit" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\shellServiceObjectDelayLoad" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Schedule\TaskCache\Tasks" /s C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Windows" C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Windows" /f Appinit_DLLs C:\&gt; reg query "HKLM\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Winlogon" /f Shell C:\&gt; reg query "HKLM\SOFTWARE\Mic rosoft\WindowsNT\CurrentVersion\Winlogon" /f Userinit C:\&gt; reg query "HKLM\SOFTWARE\Policies\Microsoft\Windows\Systern\Scripts" C:\&gt; reg query "HKLM\SOFTWARE\Classes\batfile\shell\open\cornrnand" C:\&gt; reg query "HKLM\SOFTWARE\Classes\cornfile\shell\open\cornrnand" C:\&gt; reg query "HKLM\SOFTWARE\Classes\exefile\shell\open\command" C:\&gt; reg query "HKLM\SOFTWARE\Classes\htafile\Shell\Open\Command" C:\&gt; reg query "HKLM\SOFTWARE\Classes\piffile\shell\open\command" C:\&gt; reg query "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects" /s C:\&gt; reg query "HKLM\SYSTEM\CurrentControlSet\Control\SessionManager" C:\&gt; reg query "HKLM\SYSTEM\CurrentControlSet\Control\SessionManager\KnownDLLs" C:\&gt; reg query "HKLM\SYSTEM\ControlSet001\Control\SessionManager\KnownDLLs" 7.）取日志文件 C:\&gt; wevtutil epl Security C:\bak\Security-logs.evtx C:\&gt; wevtutil epl System C:\bak\System-logs.evtx C:\&gt; wevtutil epl Application C:\bak\Application-logs.evtx 8.）文件、目录、共享信息 C:\&gt; net use \\目标IP C:\&gt; net share C:\&gt; net session C:\&gt; wmic volume list brief C:\&gt; wmic logicaldisk get description,filesystem,name,size C:\&gt; wmic share get name,path \# 查找多个类型的文件或某个文件 C:\&gt; dir /A /S /T:A *.exe *.dll *.bat *.PS1 *.zip C:\&gt; dir /A /S /T:A evil.exe \# 查找2017/1/1之后创建的文件 C:\&gt; forfiles /p C:\ /M *.exe /S /D +2017/1/1 /C "cmd /c echo @fdate @ftime @path" C:\&gt; for %G in (.exe, .dll, .bat, .ps) do forfiles -p "C:" -m *%G -s -d +2017/1/1 -c "cmd /c echo @fdate @ftime @path" \# 查找文件大小&gt;20MB的文件 forfiles /S /M * /C "cmd /c if @fsize GEQ 2097152 echo @path @fsize" \# 在Alternate Data Streams中查找文件 C:\&gt; streams -s 文件或目录 \# 检查数字签名，vt扫描 C:\&gt; sigcheck -e -u -vr -s C:\ C:\&gt; listdlls.exe -u \# 扫描病毒 C:\&gt; "C:\Program Files\Windows Defender\MpCmdRun.exe" -SignatureUpdate C:\&gt; "C:\Program Files\Windows Defender\MpCmdRun.exe" -Scan</code></p>
</blockquote>
<p><strong>4.2 ) LIVE TRIAGE（收集运行时系统信息）</strong></p>
<blockquote>
<p><strong>4.2.1 LINUX篇</strong> 
<code>1.）系统信息 uname -a uptime timedatectl mount 2.）用户信息 w lastlog last faillog -a cat /etc/passwd cat /etc/shadow cat /etc/group cat /etc/sudoers \# 查找UID为0的用户 awk -F: '($3 == "0") {print}' /etc/passwd egrep ':0+' /etc/passwd cat /root/.ssh/authorized_keys lsof -u root cat /root/.bash_history 3.）网络信息 \# 查看网络接口 ifconfig OR ip a l \# 查看监听端口 netstat -tupnl \# 查看网络连接 netstat -tupnla netstat -tupnlax \# 路由信息 route OR netstat -r OR ip r l \# ARP表 arp -ne \# 监听端口的进程 lsof -i 4.）服务信息 \# 列出所有进程 ps aux OR ps -ef \# 已加载内核模块 lsmod \# 打开的文件 lsof lsof -c sshd lsof -p PID lsof -nPi | cut -f1 -d" " | uniq | tail -n +2 \# 监控日志 less +F /var/log/messages tail -F /var/log/messages journalctl -u ssh.service -f \# 列出所有服务 chkconfig --list systemctl list-units 5.）策略、补丁、环境变量信息 \# 检查pam.d目录相关文件 cat /etc/pam.d/common* \# 自启动信息 - 计划任务 crontab -l crontab -u root -l cat /etc/crontab ls /etc/cron,* 6.）命令历史 cat /root/.*history 7.）文件、目录、共享信息 df -ah ls -lhcta /etc/init.d/ stat -x filename file filename \# 特殊属性文件 lsattr -R / | grep "\-i-" \# 全局可写文件 find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print \# 某时间点之后新建的文件 find / -newermt 2018-01-22q \# 打印文件的所有属性信息 find /labs -printf "%m;%Ax;%AT;%Tx;%TT;%Cx;%CT;%U;%G;%s;%p\n" \# 查看文件的元数据 stat 文件名 8.) 简单基线检查 wget https://raw.githubusercontent.com/pentestmonkey/unix-privesc-check/1_x/unix-privesc-check &amp;&amp; ./unix-privesc-check &gt; output.txt 9.) 检测rootkit chkrootkit rkhunter --update &amp;&amp; rkhunter -check tiger &amp;&amp; less /var/log/tiger/security.report.* lynis &amp;&amp; lynis audit system &amp;&amp; more /var/logs/lynis. log 10.) Fastir Collector Linux，收集artefacts，包括：内核版本、内核模块、网卡、系统版本、主机名、登录、网络连接、SSH know_host、日志文件、进程数据、自启动等信息 wget https://raw.githubusercontent.com/SekoiaLab/Fastir_Collector_Linux/master/fastIR_collector_linux.pypython fastIR_collector_linux.py --debug --output_dir output 11.) Sysdig and Sysdig Falco 行为监控 \# 观察root用户查看过的目录 sysdig -p"%evt.arg.path" "evt.type=chdir and user.name=root" \# 观察SSHD行为 sysdig -A -c echo_fds fd.name=/dev/ptmx and proc.name=sshd \# id为5459的登录shell执行过的所有命令 sysdig -r trace.scap.gz -c spy_users proc.loginshellid=5459 \# 安装，启动falco curl -s https://s3.amazonaws.com/download.draios.com/DRAIOS-GPG-KEY.public | apt-key add - curl -s -o /etc/apt/sources.list.d/draios.list http://download.draios.com/stable/deb/draios.list sudo apt update apt -y install falco modprobe sysdig-probe service falco start falco</code></p>
</blockquote>
<p><strong>4.3 ) 病毒样本分析</strong> 
<code>\# 静态分析 \# 挂载Sysinternals工具集 \\live.sysinternals.com\tools \# 检查数字签名 C:\&gt; sigcheck.exe -u -e C:\malware C:\&gt; sigcheck.exe -vt malware.exe \# 16机制和ASCII方式查看PE文件 hexdump -C -n 500 malware.exe od -x mailware.exe xxd malware.exe strings -a malware.exe | more \# 内存镜像分析 python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -p PID -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pslist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pstree python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlllist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlldump -D /output \# HASH分析 curl -v --request POST --url https://www.virustotal.com/vtapi/v2/file/report' -d apikey=VT API KEY -d 'resource=样本文件hash' curl -v -F 'file=malware.exe' -F apikey=VT API KEY&gt;https://www.virustotal.com/vtapi/v2/file/scan whois -h hash,cymru.com 样本文件hash \# 获取磁盘和内存镜像 \# WINDOWS C:\&gt; psexec.exe \\IP -u &lt;DOMAIN&gt;\administrator -p 123 -c mdd_l.3.exe --o C:\memory.dmp C:\&gt; dc3dd.exe if=\\.\c: of=d:\diskiamge.dd hash=md5 log=d:\output.log \# LINUX dd if=/dev/fmem of=/tmp/mem_dump.dd \# 使用LiME get https://github.com/504ensicslabs/LiME/archive/master.zip unzip master.zip cd LiME-master/src make cp lime-*.ko /media/USB/ insmod lime-3.13.0-79-generic.ko "path=/media/USB/mem_dump.lime format= raw" \# 从内存中拷贝PE文件 cp /proc/进程ID/exe /output \# 创建进程core dump gcore 进程ID strings -a gcore.* | more dd if=/dev/sda of=/root/sda.dd dd if=/dev/sda | ssh root@RemoteIP "dd of=/root/sda.dd" \# 通过netcat传送接收镜像文件 bzip2 -c /dev/sda | nc 8.8.8.8 53 nc -p 53 -l | bzip2 -d | dd of=/root/sda.dd</code></p>
<h2 id="5-tips-tricks">5. ) 常用技巧（TIPS &amp; TRICKS）<a class="headerlink" href="#5-tips-tricks" title="Permanent link">&para;</a></h2>
<p><strong>5.1 ) 技巧</strong></p>
<blockquote>
<p><strong>5.1.1 WINDOWS系统篇</strong> 
<code>\# 将命令结果通过管道输出到粘帖板，然后将粘帖板的内容重定向到文件 C:\&gt; some_command.exe | clip PS C:\&gt; Get-Clipboard &gt; clip.txt \# 检查注册表某路径是否存在 PS C:\&gt; Test-Path "HKCU:\Software\Microsoft\123" \# 可靠文件复制 robocopy c:\src \\目标计算机\dst /E \# 检查某目录是否存在ps1,vbs扩展的文件 PS C:\&gt; Test-Path C:\Scripts\Archive\* -include *.ps1, *.vbs \# 合并多个文件 C:\&gt; type 1.txt 2.txt &gt; output.txt \# 多个桌面窗口（Desktops） C:\&gt;"%ProgramFiles%\Internet Explorer\iexplore.exe" https://live.sysinternals.com/desktops.exe \# 在远程计算机执行命令 C:\&gt; psexec.exe \\远程计算机 -u admin -p 123 /c c:\123.exe PS C:\&gt; Invoke-Command -远程计算机 { ls } \# 比较两个文件的差异 PS C:\&gt; Compare-Object (-Content 1.log) -DifferenceObject (Get-Content 2.log) \# 进制转换与编码 C:\&gt; set /a 0xff PS C:\&gt; 0xff C:\&gt; certutil -decode BASE64编码文件 output.file \# 解码XOR，搜索关键字：http C:\&gt; xorsearch.exe -i -s input.file http</code></p>
<p><strong>5.1.2 LINUX系统篇</strong> 
<code>\# 通过ssh在远程服务器上抓包 ssh root@8.8.8.8 tcpdump -i any -U -s 0 -w - 'not port 22'</code></p>
</blockquote>
<p><strong>5.2 ) SNORT</strong> 
# SNORT规则检测Meterpreter 
<code>\# Snort rules by Didier Stevens (http://DidierStevens.com) alert tcp $HOME_NET any -&gt; $EXTERNAL_NET $HTTP_PORTS (msg:"Metasploit Meterpreter"; flow:to_server,established; content:"RECV"; http_client_body; depth:4; fast_pattern; isdataat:!0,relative; urilen:23&lt;&gt;24,norm; content:"POST"; pcre:"/^\/[a-z0-9]{4,5}_[a-z0-9]{16}\/$/Ui"; classtype:trojan-activity; reference:url,blog.didierstevens.com/2015/05/11/detecting-network-traffic-from-metasploits-meterpreter-reverse-http-module/; sid:1618008; rev:1;) https://didierstevens.com/files/software/snort-rules-V0_0_1.zip \# SNORT规则检测PSEXEC alert tcp $HOME_NET any -&gt; $HOME_NET [139,445] (msg:"POLICY-OTHER use of psexec remote administration tool"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:"|5C 00|p|00|s|00|e|00|x|00|e|00|c|00|s|00|v|00|c"; nocase; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:24008; rev:1;) alert tcp $HOME_NET any -&gt; $HOME_NET [139,445] (msg:"POLICY-OTHER use of psexec remote administration tool SMBv2"; flow:to_server,established; content:"|FE|SMB"; depth:8; nocase; content:"|05 00|"; within:2; distance:8; content:"P|00|S||E|00|X|00|E|00|S|00|V|00|C|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:1;)</code>
<strong>5.3 ) Bro NSM</strong> 
# 检测横向渗透 
<code>wget https://raw.githubusercontent.com/richiercyrus/Bro-Scripts/master/detect-mal-smb-files.bro bro -r faf-exercise.pcap detect-mal-smb-files.bro less notice.log \# 检测勒索软件 wget https://raw.githubusercontent.com/fox-it/bro-scripts/master/smb-ransomware/smb-ransomware.bro bro -r faf-exercise.pcap smb-ransomware.bro</code></p>
<p><strong>5.4 ) 检测DOS/DDOS</strong> 
# 检测攻击类型SYN Flood，ICMP Flood，UDP Flood 
<code>tshark -r 001.pcap -q -z io,phs tshark -c 1000 - -z io,phs tcpdump -tnr $ | awk -F '.' '{print $1"."$2"."$3"."$4}' | sort | uniq -c | sort -n | tail tcpdump -qnn "tcp[tcpflags] &amp; (tcp-syn) != 0" netstat -s tcpdump -nn not arp and not icmp and not udp netstat -n | awk '{print $6}' | sort | uniq -c | sort -nr | head \# 应用层 tshark -c 10000 -T fields -e http.host | sort | uniq -c | sort -r | head -n 10 tshark -r capture6 -T fields -e http.request.full\_uri | sort | uniq -c | sort -r | head -n 10c tcpdump -n 'tcp[32:4] = 0x47455420' | cut -f 7- -d":" \# 查找http请求中包含：GIF,ZIP,JPEG,PDF,PNG扩展的数据包 tshark -Y "http contains "ff:d8"" || "http contains "GIF89a"" || "http contains "\x50\x4B\x03\x04"" || "http contains "\xff\xd8"" || "http contains "%PDF"" || "http contains "\x89\x50\x4E\x47"" 取'user-agent'和refer字段 tcpdump -c 1000 -Ann I grep -Ei 'user-agent' | sort | uniq -c | sort -nr | head -10 tcpdump -i en0 -A -s 500 | grep -i refer \# 第二层攻击 tcpdump 'arp or icmp' tcpdump -tnr 001.pcap ARP | awk -F '.' '{print $1"."$2"."$3"."$4}' | sort | uniq -c | sort -n | tail tshark -r 001.pcap -q -z io,phs | grep arp.duplicate-address-detected</code></p>
<p><strong>5.5 ) 蓝队兵器谱</strong> 
<code>6.4.1） KALI 渗透测试发行版 https://www.kali.org 6.4.2）SIFT SANS 取证工具箱 http://sift.readthedocs.org/ 6.4.3）REMNUX 软件逆向和病毒分析发行版 https://remnux.org 6.4.4）OPENVAS http://www.openvas.org 6.4.5）Security Onion 入侵检测、网络安全监控、日志分析发行版 https://securityonion.net 6.4.6）OSSEC 开源主机入侵检测系统 http://ossec.github.io</code></p>
<h2 id="_1">文档维护<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>项目地址：<a href="https://github.com/Zer0d0y/BTFM">https://github.com/Zer0d0y/BTFM</a>，欢迎有经验的朋友一起维护！</p>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2022-02-22 23:38:31</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            回到页面顶部
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2017 - 2022
    </div>
  
  <a >keep learning ，stay foolish ，continue thinking</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/klsfct" target="_blank" rel="noopener" title="圆周 on github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "header.autohide"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.960e086b.min.js"></script>
      
        <script src="../../js/google-tongji.js"></script>
      
    
  </body>
</html>