



### 勒索病毒发展

勒索病毒的诞生 1989年 “AIDS” 189美元

虚拟货币与勒索病毒

#### 勒索病毒的类型

文件加密类勒索病毒
数据窃取类勒索病毒
系统锁定类勒索病毒
掩盖真相类勒索病毒

#### 勒索病毒的攻击流程

侦查跟踪
武器构建
载荷投递
漏洞利用
安装植入
命令与控制
目标达成

#### 勒索病毒的投递方式

弱口令攻击
利用系统与软件漏洞
钓鱼邮件
网站挂马攻击
破解软件与激活工具
U盘感染

#### 勒索病毒趋势

加密速度越来越快
工作过程越来越隐蔽
加密方式越来越复杂
勒索金额越来越高
形成产业链



### 二、勒索病毒的工作机制与原理

#### WannaCry

改名
释放恶意程序
连接到黑客服务器
遍历目录，茶轴啊文件
生成密钥，加密密钥
加密文件，删除源文件
启动解密器，显示勒索
修改注册表，自启动

#### 加密学

对称加密 代表算法：DES、AES
特点：计算快，但是密钥泄露会导致加密失效
加密和解密使用同一把密钥
非对称加密 代表算法：RSA
生成一对密钥，公钥加密，私钥解密
特点：解决了密钥传输过程中泄露的问题，计算
更慢
混合加密
用对称加密密钥加密文件
用公钥加密对称加密密钥

#### 代码实现 实现思路

1、查找关键文件
2、对称加密算法AES加密，非对称加密算法
RSA加密密钥
3、对文件进行加密
4、删除原文件
5、把加密后的密钥和私钥发送邮件给黑客（或
者把加密后的密钥添加到文件尾部，只发送MAC
地址和私钥给黑客）
6、弹出界面或者生成文件，告知受害者勒索信
息

### 三、中了勒索病毒怎么办？



#### 特征

桌面壁纸
弹窗
后缀
多余文件

#### 已经感染后的处理

隔离感染主机
排查其他主机
切断传播途径
查找攻击源
查杀病毒 数据恢复

#### 数据恢复

全盘扫描杀毒、全盘格式化、重装系统
使用文件备份恢复数据
专用恢复工具
https://edr.sangfor.com.cn/#/information/
ransom_search
https://www.nomoreransom.org/cryptosheriff.php?lang=zh
数据恢复公司



四、如何防御勒索病毒

1、定期进行安全培训
a.安装杀毒软件
b.从正规渠道下载安装软件
c.不要点击和运行未知软件
d.及时更新操作系统，安装补丁
e.数据备份

2、加强口令管理
3、盘点网络资产，关闭非必要服务和端口
4、培养安全人才
5、部署安全产品
6、数据备份